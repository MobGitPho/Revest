"use strict";(self["webpackChunkbreeze"]=self["webpackChunkbreeze"]||[]).push([[348],{39494:function(e,t,i){i.d(t,{Z:function(){return c}});var a=i(82234);function l(e,t,i,l,s,o){return(0,a.openBlock)(),(0,a.createElementBlock)("button",{onClick:t[0]||(t[0]=(...e)=>l.copy&&l.copy(...e))},[(0,a.renderSlot)(e.$slots,"default")])}var s=i(76109),o=i.n(s),n={name:"Copy",props:{toCopy:{type:String,default:""}},emits:["copy"],setup(e,t){const{toClipboard:i}=o()(),a=async()=>{try{await i(e.toCopy),t.emit("copy",e.toCopy,!0)}catch(a){console.error(a),t.emit("copy",e.toCopy,!1)}};return{copy:a}}},r=i(83744);const d=(0,r.Z)(n,[["render",l]]);var c=d},71561:function(e,t,i){i.d(t,{Z:function(){return C}});var a=i(89948),l=i(82234),s=i(75979);const o=e=>((0,l.pushScopeId)("data-v-725fb0c0"),e=e(),(0,l.popScopeId)(),e),n={class:"picker-container"},r={class:"picker-content"},d={key:0},c={class:"cropper-container"},h={class:"vertical-buttons"},m=o((()=>(0,l.createElementVNode)("br",null,null,-1))),u={class:"preview-container"},p={key:1,class:"text-center"},g={class:"picker-action"},f={class:"dialog-footer"},v={name:"ImageEditor",inheritAttrs:!1};var y=Object.assign(v,{props:{cropperAutoZoom:{type:Boolean,default:!0},cropperScalable:{type:Boolean,default:!1},cropperMovable:{type:Boolean,default:!1},cropperRatio:{type:Number,default:null},roundPreview:{type:Boolean,default:!1},previewWidth:{type:Number,default:null},previewHeight:{type:Number,default:120},src:{type:String,default:null}},emits:["croppedFileChange","save","cancel"],setup(e,{emit:t}){const i=e,{t:o}=(0,a.useI18n)(),v=(0,l.ref)(null),y=(0,l.ref)({coordinates:null,image:null}),V=(0,l.computed)((()=>i.previewWidth?i.previewWidth:y.value&&y.value.coordinates?y.value.coordinates.width/y.value.coordinates.height*i.previewHeight:i.previewHeight)),w=({coordinates:e,image:i})=>{y.value={coordinates:e,image:i};const{canvas:a}=v.value.getResult();t("croppedFileChange",y.value,a.toDataURL())},C=(e,t)=>{v.value.customImageTransforms.rotate%180!==0?v.value.flip(!e,!t):v.value.flip(e,t)},k=e=>{v.value.rotate(e)},N=()=>{const{canvas:e}=v.value.getResult();t("save",y.value,e.toDataURL())};return(e,a)=>{const M=(0,l.resolveComponent)("font-awesome-icon"),E=(0,l.resolveComponent)("n-alert"),x=(0,l.resolveComponent)("n-button");return(0,l.openBlock)(),(0,l.createElementBlock)("div",n,[(0,l.createElementVNode)("div",r,[i.src?((0,l.openBlock)(),(0,l.createElementBlock)("div",d,[(0,l.createElementVNode)("div",c,[(0,l.createVNode)((0,l.unref)(s.Cropper),{ref_key:"cropper",ref:v,class:"cropper",src:i.src,"auto-zoom":i.cropperAutoZoom,"stencil-props":{movable:i.cropperMovable,scalable:i.cropperScalable,aspectRatio:i.cropperRatio,previewClass:i.roundPreview?"circle-stencil-preview":""},"image-restriction":"stencil","background-class":"cropper-background","stencil-component":i.roundPreview?(0,l.unref)(s.CircleStencil):(0,l.unref)(s.RectangleStencil),onChange:w},null,8,["src","auto-zoom","stencil-props","stencil-component"]),(0,l.createElementVNode)("div",h,[(0,l.createElementVNode)("div",{class:"square-button",title:"Flip Horizontal",onClick:a[0]||(a[0]=e=>C(!0,!1))},[(0,l.createVNode)(M,{icon:["fas","arrows-alt-h"],size:"1x",style:{color:"white"}})]),(0,l.createElementVNode)("div",{class:"square-button",title:"Flip Vertical",onClick:a[1]||(a[1]=e=>C(!1,!0))},[(0,l.createVNode)(M,{icon:["fas","arrows-alt-v"],size:"1x",style:{color:"white"}})]),(0,l.createElementVNode)("div",{class:"square-button",title:"Rotate Clockwise",onClick:a[2]||(a[2]=e=>k(90))},[(0,l.createVNode)(M,{icon:["fas","redo"],size:"1x",style:{color:"white"}})]),(0,l.createElementVNode)("div",{class:"square-button",title:"Rotate Counter-Clockwise",onClick:a[3]||(a[3]=e=>k(-90))},[(0,l.createVNode)(M,{icon:["fas","undo"],size:"1x",style:{color:"white"}})])])]),m,(0,l.createElementVNode)("div",u,[(0,l.createVNode)((0,l.unref)(s.Preview),{ref:"preview",class:(0,l.normalizeClass)(["preview",{round:i.roundPreview}]),image:(0,l.unref)(y).image,width:(0,l.unref)(V),height:i.previewHeight,coordinates:(0,l.unref)(y).coordinates},null,8,["image","width","height","class","coordinates"])])])):((0,l.openBlock)(),(0,l.createElementBlock)("div",p,[(0,l.createVNode)(E,{title:(0,l.unref)(o)("noSrcFileWarning"),type:"warning","show-icon":""},null,8,["title"])])),(0,l.createElementVNode)("div",g,[(0,l.createElementVNode)("span",f,[(0,l.createVNode)(x,{onClick:a[4]||(a[4]=e=>t("cancel"))},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)((0,l.unref)(o)("close")),1)])),_:1}),i.src?((0,l.openBlock)(),(0,l.createBlock)(x,{key:0,type:"primary",onClick:a[5]||(a[5]=e=>N())},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)((0,l.unref)(o)("save")),1)])),_:1})):(0,l.createCommentVNode)("",!0)])])])])}}}),V=i(83744);const w=(0,V.Z)(y,[["__scopeId","data-v-725fb0c0"]]);var C=w},97200:function(e,t,i){i.d(t,{Z:function(){return d}});var a=i(82234);const l=(0,a.createElementVNode)("div",null,"Sticky Top",-1);function s(e,t,i,s,o,n){return(0,a.openBlock)(),(0,a.createElementBlock)("div",{style:(0,a.normalizeStyle)({height:o.height+"px",zIndex:i.zIndex})},[(0,a.createElementVNode)("div",{class:(0,a.normalizeClass)(i.className),style:(0,a.normalizeStyle)({top:o.isSticky?i.top+"px":"",zIndex:i.zIndex,position:o.position,width:o.width,height:o.height+"px"})},[(0,a.renderSlot)(e.$slots,"default",{},(()=>[l]))],6)],4)}var o={name:"Sticky",props:{top:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated(){this.handleScroll()},unmounted(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset(){this.active&&this.reset()},reset(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll(){const e=this.$el.getBoundingClientRect().width;this.width=e||"auto";const t=this.$el.getBoundingClientRect().top;t<this.top?this.sticky():this.handleReset()},handleResize(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},n=i(83744);const r=(0,n.Z)(o,[["render",s]]);var d=r},49795:function(e,t,i){i.r(t),i.d(t,{default:function(){return M}});var a=i(82234);const l={style:{"line-height":"36px","font-size":"18px"}},s={key:0,class:"text-right"},o={class:"mr-10"},n={class:"mr-5"},r={key:0,class:"mb-10"},d={key:0,class:"text-left"},c={class:"text-right"},h={class:"el-upload__text mt-10"};function m(e,t,i,m,u,p){const g=(0,a.resolveComponent)("el-col"),f=(0,a.resolveComponent)("el-switch"),v=(0,a.resolveComponent)("el-button"),y=(0,a.resolveComponent)("el-row"),V=(0,a.resolveComponent)("el-card"),w=(0,a.resolveComponent)("el-progress"),C=(0,a.resolveComponent)("UploadFilled"),k=(0,a.resolveComponent)("el-icon"),N=(0,a.resolveComponent)("el-upload");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createVNode)(V,{class:"mb-10 header-card",shadow:"never"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(y,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{span:8},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("b",l,(0,a.toDisplayString)(e.$t("addUrMedias")),1)])),_:1}),(0,a.createVNode)(g,{span:16},{default:(0,a.withCtx)((()=>[u.fileList&&u.fileList.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",s,[(0,a.createElementVNode)("span",o,[(0,a.createElementVNode)("b",n,[(0,a.createElementVNode)("small",null,(0,a.toDisplayString)(e.$t("overwriteDuplicateFiles")),1)]),(0,a.createVNode)(f,{modelValue:u.overwrite,"onUpdate:modelValue":t[0]||(t[0]=e=>u.overwrite=e),"active-color":e.appPrimaryColor,size:"default"},null,8,["modelValue","active-color"])]),(0,a.createVNode)(v,{size:"default",icon:"close",disabled:u.isUploading,class:"ml-10",onClick:t[1]||(t[1]=e=>p.clearFileList())},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("clearList")),1)])),_:1},8,["disabled"]),(0,a.createVNode)(v,{size:"default",type:"primary",icon:"upload",disabled:u.isUploading,onClick:t[2]||(t[2]=e=>p.send())},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("send")+" ("+u.fileList.length+")"),1)])),_:1},8,["disabled"])])):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(V,{shadow:"never"},{default:(0,a.withCtx)((()=>[u.isUploading?((0,a.openBlock)(),(0,a.createElementBlock)("div",r,[(0,a.createVNode)(y,{gutter:10,class:"mb-10"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{span:12},{default:(0,a.withCtx)((()=>[u.uploadedFileName?((0,a.openBlock)(),(0,a.createElementBlock)("div",d,(0,a.toDisplayString)(e.$t("sendingInProgress")+": "+u.uploadedFileName),1)):(0,a.createCommentVNode)("",!0)])),_:1}),(0,a.createVNode)(g,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",c,(0,a.toDisplayString)(u.uploadedList.length+u.failedList.length+" / "+u.fileList.length),1)])),_:1})])),_:1}),(0,a.createVNode)(w,{percentage:u.percentage,format:p.format},null,8,["percentage","format"])])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(N,{ref:"upload",class:"upload-box","auto-upload":!1,"file-list":u.fileList,"on-change":p.handleChange,"on-remove":p.handleChange,action:u.STORAGE_API_BASE_URL,headers:u.API_REQUEST_HEADERS,multiple:"",drag:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(k,{class:"upload-icon",size:64},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(C)])),_:1}),(0,a.createElementVNode)("div",h,(0,a.toDisplayString)(e.$t("uploadFilesOrClickToSend")),1)])),_:1},8,["file-list","on-change","on-remove","action","headers"])])),_:1})],64)}i(57658);var u=i(11165),p=i(14340),g=i(92829),f=i(31567),v=i(98761),y=i(38855),V=i(64713),w=i(21101),C={mixins:[y.Z,f.Z,v.Z],data(){return{fileList:[],percentage:0,failedList:[],uploadedList:[],folder:"medias",overwrite:!0,isUploading:!1,uploadedFileName:"",maxUploadSize:256,STORAGE_API_BASE_URL:u.STORAGE_API_BASE_URL,API_REQUEST_HEADERS:u.API_REQUEST_HEADERS}},methods:{...(0,w.mapActions)("media",["generateThumbnail"]),format(e){return 100===e?this.$t("completed"):`${e}%`},handleChange(e,t){this.fileList=t},getFileTypeByName(e){const t=["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],i=["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],a=["JPEG","JPG","PNG","GIF","WEBP","SVG"],l=["MP3","WAV","M4A","WMA","AAC","FLAC"],s=e.split(".").pop();if(s){if(t.includes(s.toUpperCase()))return p.Tr.DOCUMENT.value;if(i.includes(s.toUpperCase()))return p.Tr.VIDEO.value;if(a.includes(s.toUpperCase()))return p.Tr.IMAGE.value;if(l.includes(s.toUpperCase()))return p.Tr.AUDIO.value}return p.Tr.OTHERS.value},async send(){let e=!0;for(let a=0;a<this.fileList.length;a++){const t=this.fileList[a].size/1024/1024<this.maxUploadSize;t||(e=!1,this.$message.error(this.$t("uploadFileSizeWarning",[this.fileList[a].name,this.maxUploadSize])))}if(e){this.isUploading=!0;for(let e=0;e<this.fileList.length;e++){const a=this.fileList[e].name;var t=this.fileList[e].raw;this.compressImages&&(t=await(0,g.hv)(t,{maxSizeMB:this.compressThreshold}));const l=new FormData;l.append("folder",this.folder),l.append("overwrite",this.overwrite),l.append("file",t,a);try{this.percentage=0,this.uploadedFileName=this.fileList[e].name;const i=await this.axios.post(u.STORAGE_API_BASE_URL,l,{headers:u.API_REQUEST_HEADERS,onUploadProgress:e=>{null!==e.total&&(this.percentage=Math.round(100*e.loaded/e.total))}});i.data&&"success"==i.data["status"]?(this.uploadedList.push(this.fileList[e].name),await this.addItemInDB({context:V.R,data:{name:a,link:"root/"+this.folder+"/"+a,type:this.getFileTypeByName(a),size:t.size||0,mime:t.type||"",sender:this.userData.id}}),this.getFileTypeByName(a)==p.Tr.IMAGE.value&&await this.generateThumbnail({autoWidth:this.thumbnailsFormat==p.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==p.vh.AUTOHEIGHT.value,folder:this.folder,file:a,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))})):i.data&&"exists"==i.data["status"]?(this.failedList.push(this.fileList[e].name),this.$message({type:"error",duration:5e3,showClose:!0,message:this.$t("fileExistsError",[this.fileList[e].name])})):(this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name])))}catch(i){this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name]))}this.uploadedFileName=""}setTimeout((()=>{this.$message({showClose:!0,duration:5e3,message:this.$t("sendingCompleted",[this.uploadedList.length,this.failedList.length])}),this.clearFileList(),this.isUploading=!1}),1e3)}},clearFileList(){this.fileList=[],this.failedList=[],this.uploadedList=[]}}},k=i(83744);const N=(0,k.Z)(C,[["render",m],["__scopeId","data-v-c6338392"]]);var M=N},99470:function(e,t,i){i.r(t),i.d(t,{default:function(){return F}});var a=i(97200),l=i(82234);const s={class:"text-left"},o={style:{"margin-right":"25px"}},n={key:0,style:{"line-height":"2.2"}},r={key:1,style:{"line-height":"2.2"}},d={key:0,class:"mt-5 text-center"},c={key:0,class:"item-selector"},h={class:"item-actions"},m={class:"image-slot"},u={key:2,class:"item-doc"},p={class:"item-doc-center"},g={class:"item-doc-footer"},f={key:3,class:"item-aud"},v={class:"item-aud-center"},y={class:"item-aud-footer"},V={key:4,class:"item-vid"},w={class:"item-vid-center"},C={class:"item-vid-footer"},k={key:5,class:"item-oth"},N={class:"item-oth-center"},M={class:"item-oth-footer"},E={key:1,class:"no-medias-container mt-5"},x={class:"text-center"},D={class:"dialog-footer"};function b(e,t,i,b,S,T){const $=(0,l.resolveComponent)("el-option"),B=(0,l.resolveComponent)("el-select"),I=(0,l.resolveComponent)("el-input"),_=(0,l.resolveComponent)("el-checkbox"),A=(0,l.resolveComponent)("el-col"),L=(0,l.resolveComponent)("el-row"),U=(0,l.resolveComponent)("el-card"),z=(0,l.resolveComponent)("el-button"),P=a.Z,F=(0,l.resolveComponent)("loading"),R=(0,l.resolveComponent)("el-icon"),O=(0,l.resolveComponent)("font-awesome-icon"),G=(0,l.resolveComponent)("Picture"),H=(0,l.resolveComponent)("el-image"),W=(0,l.resolveComponent)("el-table-column"),Z=(0,l.resolveComponent)("el-table"),Y=(0,l.resolveComponent)("el-dialog");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createVNode)(U,{shadow:"never",class:"mb-10 header-card"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(L,{align:"middle"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(A,{span:24},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",s,[(0,l.createElementVNode)("b",o,(0,l.toDisplayString)(e.$t("deletedMedia")),1),(0,l.createVNode)(B,{modelValue:S.mediaType,"onUpdate:modelValue":t[0]||(t[0]=e=>S.mediaType=e),placeholder:e.$t("mediaType"),style:{width:"165px"},class:"mr-10"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)($,{label:e.$t("allMedias"),value:0},null,8,["label"]),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(S.mediaTypes,(e=>((0,l.openBlock)(),(0,l.createBlock)($,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder"]),(0,l.createVNode)(I,{modelValue:S.mediaSearch,"onUpdate:modelValue":t[1]||(t[1]=e=>S.mediaSearch=e),placeholder:e.$t("search"),style:{width:"185px","margin-right":"25px"}},null,8,["modelValue","placeholder"]),(0,l.createVNode)(_,{modelValue:S.enableMultiselect,"onUpdate:modelValue":t[2]||(t[2]=e=>S.enableMultiselect=e),border:"",class:"multiselectToggler",disabled:!T.filteredMedias.length,label:e.$t("groupedSelection"),onChange:t[3]||(t[3]=e=>S.selectedMedias=[])},null,8,["modelValue","disabled","label"])])])),_:1})])),_:1})])),_:1}),(0,l.createElementVNode)("div",{style:(0,l.normalizeStyle)(S.enableMultiselect&&T.filteredMedias.length?"height: 60px":"height: 0")},[(0,l.createVNode)(l.Transition,{class:"el-fade-in-linear"},{default:(0,l.withCtx)((()=>[S.enableMultiselect&&T.filteredMedias.length?((0,l.openBlock)(),(0,l.createBlock)(P,{key:0,"z-index":1e3,top:50,class:"mb-10"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(U,{shadow:"never",class:"multiselect-card"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(L,{gutter:10},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(A,{span:8,class:"text-left"},{default:(0,l.withCtx)((()=>[S.selectedMedias.length?((0,l.openBlock)(),(0,l.createElementBlock)("small",n,(0,l.toDisplayString)(e.$t("xSelectedItems",[S.selectedMedias.length])),1)):((0,l.openBlock)(),(0,l.createElementBlock)("small",r,(0,l.toDisplayString)(e.$t("noItemSelected")),1))])),_:1}),(0,l.createVNode)(A,{span:16,class:"text-right",style:{display:"flex","justify-content":"right","align-items":"center"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(_,{border:"",size:"small",class:"mr-5",indeterminate:S.isSelectAllIndeterminate,"model-value":S.selectedMedias.length==T.filteredMedias.length,label:e.$t("selectAll"),onChange:T.handleSelectAll},null,8,["indeterminate","model-value","label","onChange"]),(0,l.createVNode)(z,{size:"default",type:"success",icon:"top",disabled:!S.selectedMedias.length,onClick:t[4]||(t[4]=e=>T.restoreMultipleItems())},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("restore")),1)])),_:1},8,["disabled"]),(0,l.createVNode)(z,{size:"default",type:"danger",icon:"delete",disabled:!S.selectedMedias.length,onClick:t[5]||(t[5]=e=>T.deleteMultipleItems())},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("deletePermanently")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1})):(0,l.createCommentVNode)("",!0)])),_:1})],4),(0,l.createVNode)(U,{shadow:"never"},{default:(0,l.withCtx)((()=>[S.isLoading?((0,l.openBlock)(),(0,l.createElementBlock)("div",d,[(0,l.createVNode)(R,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(F)])),_:1},8,["color"])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[T.filteredMedias&&T.filteredMedias.length>0?((0,l.openBlock)(),(0,l.createBlock)(L,{key:0,gutter:10,class:"mt-5"},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(T.filteredMedias,((t,i)=>((0,l.openBlock)(),(0,l.createBlock)(A,{key:i,span:4,class:"mb-10 item-container",onMouseover:e=>t.display=!0,onMouseleave:e=>t.display=!1},{default:(0,l.withCtx)((()=>[S.enableMultiselect?((0,l.openBlock)(),(0,l.createElementBlock)("div",c,[(0,l.createVNode)(_,{size:"default","model-value":S.selectedMedias.findIndex((e=>e.id==t.id))>-1,onChange:e=>T.updateSelectedMedias(t,i)},null,8,["model-value","onChange"])])):(0,l.createCommentVNode)("",!0),(0,l.createVNode)(l.Transition,{name:"el-fade-in"},{default:(0,l.withCtx)((()=>[(0,l.withDirectives)((0,l.createElementVNode)("div",h,[(0,l.createVNode)(O,{icon:"trash-restore",class:"item-actions-btn",onClick:e=>T.restore(t,i)},null,8,["onClick"]),(0,l.createVNode)(O,{icon:"info-circle",class:"item-actions-btn",onClick:e=>T.showDetails(t,i)},null,8,["onClick"]),(0,l.createVNode)(O,{icon:"trash",class:"item-actions-btn",onClick:e=>T.deleteItem(t,i)},null,8,["onClick"])],512),[[l.vShow,t.display||!1]])])),_:2},1024),t.type==S.MediaTypes.IMAGE.value?((0,l.openBlock)(),(0,l.createBlock)(H,{key:1,class:"item-img",src:e.resolveMediaLink(t.link)+"?rd="+e.$uuidv4(),fit:"cover"},{error:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",m,[(0,l.createVNode)(R,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(G)])),_:1})])])),_:2},1032,["src"])):t.type==S.MediaTypes.DOCUMENT.value?((0,l.openBlock)(),(0,l.createElementBlock)("div",u,[(0,l.createElementVNode)("div",p,[(0,l.createVNode)(O,{icon:"file",class:"item-doc-icon",size:"4x"}),(0,l.createElementVNode)("b",null,(0,l.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,l.createElementVNode)("div",g,[(0,l.createElementVNode)("small",null,(0,l.toDisplayString)(t.name),1)])])):t.type==S.MediaTypes.AUDIO.value?((0,l.openBlock)(),(0,l.createElementBlock)("div",f,[(0,l.createElementVNode)("div",v,[(0,l.createVNode)(O,{icon:"music",class:"item-aud-icon",size:"4x"}),(0,l.createElementVNode)("b",null,(0,l.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,l.createElementVNode)("div",y,[(0,l.createElementVNode)("small",null,(0,l.toDisplayString)(t.name),1)])])):t.type==S.MediaTypes.VIDEO.value?((0,l.openBlock)(),(0,l.createElementBlock)("div",V,[(0,l.createElementVNode)("div",w,[(0,l.createVNode)(O,{icon:"video",class:"item-vid-icon",size:"4x"}),(0,l.createElementVNode)("b",null,(0,l.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,l.createElementVNode)("div",C,[(0,l.createElementVNode)("small",null,(0,l.toDisplayString)(t.name),1)])])):((0,l.openBlock)(),(0,l.createElementBlock)("div",k,[(0,l.createElementVNode)("div",N,[(0,l.createVNode)(O,{icon:"question-circle",class:"item-oth-icon",size:"4x"}),(0,l.createElementVNode)("b",null,(0,l.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,l.createElementVNode)("div",M,[(0,l.createElementVNode)("small",null,(0,l.toDisplayString)(t.name),1)])]))])),_:2},1032,["onMouseover","onMouseleave"])))),128))])),_:1})):((0,l.openBlock)(),(0,l.createElementBlock)("div",E,[(0,l.createElementVNode)("div",x,[(0,l.createElementVNode)("span",null,(0,l.toDisplayString)(e.$t("noMediaFound")),1)])]))],64))])),_:1}),(0,l.createVNode)(Y,{modelValue:S.showDetailsDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>S.showDetailsDialog=e),width:"35%",title:e.$t("mediaDetails"),top:"3vh"},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",D,[(0,l.createVNode)(z,{type:"primary",onClick:t[6]||(t[6]=e=>S.showDetailsDialog=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("close")),1)])),_:1})])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(Z,{data:e.detailsData,"show-header":!1,stripe:"",size:"small",style:{width:"100%"}},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(W,{prop:"name",label:"",width:"100"}),(0,l.createVNode)(W,{prop:"value",label:""})])),_:1},8,["data"])])),_:1},8,["modelValue","title"])],64)}i(57658);var S=i(39355),T=i(14340),$=i(92829),B=i(31567),I=i(98761),_=i(38855),A=i(64713),L=i(21101),U={name:"Trash",mixins:[_.Z,B.Z,I.Z],data(){return{MediaTypes:T.Tr,mediaType:0,mediaTypes:[],mediaSearch:"",isLoading:!0,selectAll:!1,currentItem:null,selectedMedias:[],currentItemIndex:0,showDetailsDialog:!1,enableMultiselect:!1,isSelectAllIndeterminate:!1,folder:"medias",folderMedias:[],dbMedias:[],medias:[]}},computed:{filteredMedias(){let e=[];const t=this.medias.filter((e=>0==this.mediaType||e.type==this.mediaType));return e=this.mediaSearch?t.filter((e=>e.name.toLowerCase().includes(this.mediaSearch.toLowerCase()))):t,e}},created(){this.init(),this.$_.forIn(T.Tr,((e,t)=>{this.mediaTypes.push(e)}))},methods:{...(0,L.mapActions)("media",["getFolderMedias","deleteMediaFile","generateThumbnail"]),async init(){const e=await this.getAllItemsFromDB({context:A.R});e.success&&e.data&&(this.dbMedias=e.data);const t=await this.getFolderMedias({folder:this.folder});t.success&&t.data&&(this.folderMedias=t.data),this.folderMedias.forEach((e=>{const t=-1===this.dbMedias.findIndex((t=>t.name==e.name));t&&this.medias.push({id:this.$uuidv4(),name:e.name,size:e.size,mime:e.mime,sender:this.userData.id,type:this.getFileTypeByName(e.name),link:"/root/"+this.folder+"/"+e.name,insert_datetime:(0,S.p6)(new Date,{outPattern:"YYYY-MM-DD hh:mm:ss",locale:this.$i18n.locale})})})),this.isLoading&&(this.isLoading=!1)},getFileTypeByName(e){const t=["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],i=["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],a=["JPEG","JPG","PNG","GIF","WEBP","SVG"],l=["MP3","WAV","M4A","WMA","AAC","FLAC"],s=e.split(".").pop();if(s){if(t.includes(s.toUpperCase()))return T.Tr.DOCUMENT.value;if(i.includes(s.toUpperCase()))return T.Tr.VIDEO.value;if(a.includes(s.toUpperCase()))return T.Tr.IMAGE.value;if(l.includes(s.toUpperCase()))return T.Tr.AUDIO.value}return T.Tr.OTHERS.value},showDetails(e,t){this.currentItem=e,this.currentItemIndex=t;const i=this.mediaTypes.find((t=>t.value==e.type));if(this.detailsData=[{name:this.$t("name"),value:e.name},{name:this.$t("url"),value:this.resolveMediaLink(e.link)},{name:this.$t("type"),value:i?i.label:""},{name:this.$t("size"),value:(0,$.gB)(e.size,!0)},{name:this.$t("mimeType"),value:e.mime}],e.type==T.Tr.IMAGE.value){var a=new Image;a.onload=()=>{const e=a.naturalHeight,t=a.naturalWidth;t&&e&&this.detailsData.push({name:this.$t("dimensions"),value:t+" x "+e})},a.src=this.resolveMediaLink(e.link)}this.showDetailsDialog=!0},deleteItem(e,t){this.$confirm(this.$t("deleteMediaPermanentlyQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const t=await this.deleteMediaFile({folder:this.folder,file:e.name});t.success?(this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},deleteMultipleItems(){this.$confirm(1===this.selectedMedias.length?this.$t("deleteMediaPermanentlyQuestion"):this.$t("deleteMultipleItems",[this.selectedMedias.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.selectedMedias.length;t++)await this.deleteMediaFile({folder:this.folder,file:this.selectedMedias[t].name});e.close(),this.$message.success(this.$t("success")),this.reset()})).catch((()=>{}))},restore(e,t){this.$confirm(this.$t("restoreMediaQuestion"),this.$t("restore"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const t=await this.addItemInDB({context:A.R,data:{name:e.name,link:e.link,type:e.type,size:e.size,mime:e.mime,sender:this.userData.id}});t.success?(this.getFileTypeByName(e.name)==T.Tr.IMAGE.value&&await this.generateThumbnail({autoWidth:this.thumbnailsFormat==T.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==T.vh.AUTOHEIGHT.value,folder:this.folder,file:e.name,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))}),this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},restoreMultipleItems(){this.$confirm(1===this.selectedMedias.length?this.$t("restoreMediaQuestion"):this.$t("restoreMultipleItems",[this.selectedMedias.length]),this.$t("restore"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.selectedMedias.length;t++)await this.addItemInDB({context:A.R,data:{name:this.selectedMedias[t].name,link:this.selectedMedias[t].link,type:this.selectedMedias[t].type,size:this.selectedMedias[t].size,mime:this.selectedMedias[t].mime,sender:this.userData.id}}),this.getFileTypeByName(this.selectedMedias[t].name)==T.Tr.IMAGE.value&&await this.generateThumbnail({autoWidth:this.thumbnailsFormat==T.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==T.vh.AUTOHEIGHT.value,folder:this.folder,file:this.selectedMedias[t].name,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))});e.close(),this.$message.success(this.$t("success")),this.reset()})).catch((()=>{}))},updateSelectedMedias(e,t){const i=this.selectedMedias.findIndex((t=>t.id===e.id));i>-1?(this.selectedMedias.length==this.filteredMedias.length&&(this.isSelectAllIndeterminate=!0),this.selectedMedias.splice(i,1)):this.selectedMedias.push(e)},handleSelectAll(){this.filteredMedias.length>this.selectedMedias.length?this.selectedMedias=this.$_.cloneDeep(this.filteredMedias):this.selectedMedias=[],this.isSelectAllIndeterminate=!1},async reset(){this.isLoading=!0,this.medias=[],this.selectedMedias=[],await this.init()}}},z=i(83744);const P=(0,z.Z)(U,[["render",b],["__scopeId","data-v-037ec64d"]]);var F=P},50051:function(e,t,i){i.r(t),i.d(t,{default:function(){return Q}});var a=i(71561),l=i(39494),s=i(97200),o=(i(57658),i(82234));const n={class:"text-left"},r={class:"text-right"},d={key:0,style:{"line-height":"2.2"}},c={key:1,style:{"line-height":"2.2"}},h={key:0,class:"mt-5 text-center"},m={key:0,class:"item-selector"},u={class:"item-actions"},p={class:"image-slot"},g={key:2,class:"item-doc"},f={class:"item-doc-center"},v={class:"item-doc-footer"},y={key:3,class:"item-aud"},V={class:"item-aud-center"},w={class:"item-aud-footer"},C={key:4,class:"item-vid"},k={class:"item-vid-center"},N={class:"item-vid-footer"},M={key:5,class:"item-oth"},E={class:"item-oth-center"},x={class:"item-oth-footer"},D={class:"text-center"},b={key:1,class:"no-medias-container mt-5"},S={class:"text-center"},T={class:"dialog-footer"},$={id:"music",preload:"all",autoplay:"",controls:"",style:{width:"100%"}},B=["src"],I={id:"video",autoplay:"",controls:"",style:{width:"100%"}},_=["src"],A={class:"dialog-footer"};function L(e,t,i,L,U,z){const P=(0,o.resolveComponent)("el-option"),F=(0,o.resolveComponent)("el-select"),R=(0,o.resolveComponent)("el-input"),O=(0,o.resolveComponent)("el-checkbox"),G=(0,o.resolveComponent)("el-col"),H=(0,o.resolveComponent)("el-button"),W=(0,o.resolveComponent)("el-row"),Z=(0,o.resolveComponent)("el-card"),Y=s.Z,X=(0,o.resolveComponent)("loading"),Q=(0,o.resolveComponent)("el-icon"),K=(0,o.resolveComponent)("font-awesome-icon"),q=l.Z,j=(0,o.resolveComponent)("Picture"),J=(0,o.resolveComponent)("el-image"),ee=(0,o.resolveComponent)("infinite-loading"),te=(0,o.resolveComponent)("el-image-viewer"),ie=(0,o.resolveComponent)("el-table-column"),ae=(0,o.resolveComponent)("el-table"),le=(0,o.resolveComponent)("el-dialog"),se=a.Z;return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(Z,{shadow:"never",class:"mb-10 header-card"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(W,{align:"middle"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(G,{span:21},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,[(0,o.createCommentVNode)("",!0),(0,o.createVNode)(F,{modelValue:U.mediaType,"onUpdate:modelValue":t[0]||(t[0]=e=>U.mediaType=e),placeholder:e.$t("mediaType"),style:{width:"165px"},class:"mr-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(P,{label:e.$t("allMedias"),value:0},null,8,["label"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(U.mediaTypes,(e=>((0,o.openBlock)(),(0,o.createBlock)(P,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder"]),(0,o.createVNode)(F,{modelValue:U.mediaDate,"onUpdate:modelValue":t[1]||(t[1]=e=>U.mediaDate=e),style:{width:"165px"},class:"mr-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(P,{label:e.$t("allDates"),value:0},null,8,["label"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(U.mediaDates,(e=>((0,o.openBlock)(),(0,o.createBlock)(P,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,o.createVNode)(R,{modelValue:U.mediaSearch,"onUpdate:modelValue":t[2]||(t[2]=e=>U.mediaSearch=e),class:"mr-10",style:{width:"185px"},placeholder:e.$t("search")},null,8,["modelValue","placeholder"]),(0,o.createVNode)(O,{modelValue:U.enableMultiselect,"onUpdate:modelValue":t[3]||(t[3]=e=>U.enableMultiselect=e),border:"",class:"multiselectToggler",disabled:!z.filteredMedias.length,label:e.$t("groupedSelection"),onChange:t[4]||(t[4]=e=>U.selectedMedias=[])},null,8,["modelValue","disabled","label"])])])),_:1}),(0,o.createVNode)(G,{span:3},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(H,{size:"default",type:"primary",icon:"plus",onClick:t[5]||(t[5]=t=>e.$router.push(U.Routes.MEDIAS.PATH+"/add"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1})])])),_:1})])),_:1})])),_:1}),(0,o.createElementVNode)("div",{style:(0,o.normalizeStyle)(U.enableMultiselect&&z.filteredMedias.length?"height: 60px":"height: 0")},[(0,o.createVNode)(o.Transition,{class:"el-fade-in-linear"},{default:(0,o.withCtx)((()=>[U.enableMultiselect&&z.filteredMedias.length?((0,o.openBlock)(),(0,o.createBlock)(Y,{key:0,"z-index":1e3,top:50,class:"mb-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(Z,{shadow:"never",class:"multiselect-card"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(W,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(G,{span:8,class:"text-left"},{default:(0,o.withCtx)((()=>[U.selectedMedias.length?((0,o.openBlock)(),(0,o.createElementBlock)("small",d,(0,o.toDisplayString)(e.$t("xSelectedItems",[U.selectedMedias.length])),1)):((0,o.openBlock)(),(0,o.createElementBlock)("small",c,(0,o.toDisplayString)(e.$t("noItemSelected")),1))])),_:1}),(0,o.createVNode)(G,{span:16,class:"text-right",style:{display:"flex","justify-content":"right","align-items":"center"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(O,{border:"",size:"small",class:"mr-5",indeterminate:U.isSelectAllIndeterminate,"model-value":U.selectedMedias.length==z.filteredMedias.length,label:e.$t("selectAll"),onChange:z.handleSelectAll},null,8,["indeterminate","model-value","label","onChange"]),(0,o.createVNode)(H,{size:"default",type:"danger",icon:"delete",disabled:!U.selectedMedias.length,onClick:t[6]||(t[6]=e=>z.deleteMultipleItems())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("delete")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1})],4),(0,o.createVNode)(Z,{shadow:"never"},{default:(0,o.withCtx)((()=>[U.isLoading?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createVNode)(Q,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(X)])),_:1},8,["color"])])):((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[z.filteredMedias&&z.filteredMedias.length>0?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(W,{gutter:10,class:"mt-5"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(z.filteredMedias,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)(G,{key:i,span:4,class:"mb-10 item-container",onMouseover:e=>t.display=!0,onMouseleave:e=>t.display=!1},{default:(0,o.withCtx)((()=>[U.enableMultiselect?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createVNode)(O,{size:"default","model-value":U.selectedMedias.findIndex((e=>e.id==t.id))>-1,onChange:e=>z.updateSelectedMedias(t,i)},null,8,["model-value","onChange"])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(o.Transition,{name:"el-fade-in"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",u,[t.type==U.MediaTypes.AUDIO.value||t.type==U.MediaTypes.VIDEO.value?((0,o.openBlock)(),(0,o.createBlock)(K,{key:0,icon:"play",class:"item-actions-btn",onClick:e=>z.showPreview(t,i)},null,8,["onClick"])):((0,o.openBlock)(),(0,o.createBlock)(K,{key:1,icon:"eye",class:"item-actions-btn",onClick:e=>z.showPreview(t,i)},null,8,["onClick"])),(0,o.createVNode)(K,{icon:"info-circle",class:"item-actions-btn",onClick:e=>z.showDetails(t,i)},null,8,["onClick"]),(0,o.createVNode)(q,{"to-copy":e.resolveMediaLink(t.link),class:"link-copy-btn",onCopy:z.copyLink},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(K,{icon:"link",class:"item-actions-btn"})])),_:2},1032,["to-copy","onCopy"]),t.type==U.MediaTypes.IMAGE.value?((0,o.openBlock)(),(0,o.createBlock)(K,{key:2,icon:"edit",class:"item-actions-btn",onClick:e=>z.editImage(t,i)},null,8,["onClick"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(K,{icon:"trash",class:"item-actions-btn",onClick:e=>z.deleteItem(t,i)},null,8,["onClick"])],512),[[o.vShow,t.display||!1]])])),_:2},1024),t.type==U.MediaTypes.IMAGE.value?((0,o.openBlock)(),(0,o.createBlock)(J,{key:1,class:"item-img",src:e.resolveMediaLink(t.link),fit:"cover"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(Q,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(j)])),_:1})])])),_:2},1032,["src"])):t.type==U.MediaTypes.DOCUMENT.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createElementVNode)("div",f,[(0,o.createVNode)(K,{icon:"file",class:"item-doc-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])])):t.type==U.MediaTypes.AUDIO.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",y,[(0,o.createElementVNode)("div",V,[(0,o.createVNode)(K,{icon:"music",class:"item-aud-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])])):t.type==U.MediaTypes.VIDEO.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",C,[(0,o.createElementVNode)("div",k,[(0,o.createVNode)(K,{icon:"video",class:"item-vid-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",N,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",M,[(0,o.createElementVNode)("div",E,[(0,o.createVNode)(K,{icon:"question-circle",class:"item-oth-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",x,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])]))])),_:2},1032,["onMouseover","onMouseleave"])))),128))])),_:1}),(0,o.createVNode)(ee,{onInfinite:z.infiniteHandler},{"no-more":(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("noOtherMediaFound")),1)])),"no-results":(0,o.withCtx)((()=>[(0,o.createTextVNode)(".")])),spinner:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",D,[(0,o.createVNode)(Q,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(X)])),_:1},8,["color"])])])),error:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("somethingWrong"))+". ",1),(0,o.createElementVNode)("a",{href:"javascript:;",onClick:t[7]||(t[7]=t=>e.location.reload())},(0,o.toDisplayString)(e.$t("retry")),1)])),_:1},8,["onInfinite"])],64)):((0,o.openBlock)(),(0,o.createElementBlock)("div",b,[(0,o.createElementVNode)("div",S,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.$t("noMediaFound")),1)])]))],64))])),_:1}),U.showViewer?((0,o.openBlock)(),(0,o.createBlock)(te,{key:0,infinite:!1,"hide-on-click-modal":!0,"url-list":z.filteredMediaLinks,"initial-index":U.currentItemIndex,onClose:t[8]||(t[8]=e=>U.showViewer=!1)},null,8,["url-list","initial-index"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(le,{modelValue:U.showDetailsDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>U.showDetailsDialog=e),width:"35%",title:e.$t("mediaDetails"),top:"3vh"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",T,[(0,o.createVNode)(H,{type:"primary",onClick:t[9]||(t[9]=e=>U.showDetailsDialog=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("close")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(ae,{data:U.detailsData,"show-header":!1,stripe:"",size:"small",style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(ie,{prop:"name",label:"",width:"100"}),(0,o.createVNode)(ie,{prop:"value",label:""})])),_:1},8,["data"])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(le,{modelValue:U.showAudioReaderDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>U.showAudioReaderDialog=e),width:"35%","show-close":"","destroy-on-close":"",title:U.currentItem?U.currentItem.name:"",top:"30vh"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("audio",$,[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(U.currentItem.link)},null,8,B)])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(le,{modelValue:U.showVideoReaderDialog,"onUpdate:modelValue":t[12]||(t[12]=e=>U.showVideoReaderDialog=e),width:"45%","show-close":"","destroy-on-close":"",title:U.currentItem?U.currentItem.name:"",top:"10vh"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("video",I,[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(U.currentItem.link)},null,8,_)])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(le,{modelValue:U.imageEditorVisible,"onUpdate:modelValue":t[18]||(t[18]=e=>U.imageEditorVisible=e),"destroy-on-close":"",top:"1vh"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(se,{"cropper-ratio":null,"round-preview":!1,src:U.currentItem?e.resolveMediaLink(U.currentItem.link):null,onCancel:t[13]||(t[13]=e=>U.imageEditorVisible=!1),onSave:z.storeEditedPicture},null,8,["src","onSave"]),(0,o.createVNode)(le,{modelValue:U.imageEditorConfirmVisible,"onUpdate:modelValue":t[17]||(t[17]=e=>U.imageEditorConfirmVisible=e),width:"50%",title:e.$t("confirmation"),"append-to-body":""},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",A,[(0,o.createVNode)(H,{size:"default",onClick:t[14]||(t[14]=e=>U.imageEditorConfirmVisible=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(H,{type:"primary",size:"default",onClick:t[15]||(t[15]=e=>z.saveEditedPicture(!1))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("saveNewFile")),1)])),_:1}),(0,o.createVNode)(H,{type:"danger",size:"default",onClick:t[16]||(t[16]=e=>z.saveEditedPicture(!0))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("overwriteExistingFile")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("whatDoYouWantToDo"))+" ",1)])),_:1},8,["modelValue","title"])])),_:1},8,["modelValue"])],64)}var U=i(39355),z=i(11165),P=i(14340),F=i(92829),R=i(31567),O=i(98761),G=i(38855),H=i(64713),W=i(21101),Z={name:"Medias",mixins:[G.Z,R.Z,O.Z],data(){return{MediaTypes:P.Tr,Routes:P.Z5,users:[],medias:[],mediaDate:0,mediaType:0,mediaTypes:[],mediaDates:[],detailsData:[],mediaSearch:"",folder:"medias",isLoading:!0,selectAll:!1,showViewer:!1,currentItem:null,lastMediaRowId:0,selectedMedias:[],currentItemIndex:0,showDetailsDialog:!1,enableMultiselect:!1,imageEditorVisible:!1,currentEditorDataUrl:null,showAudioReaderDialog:!1,showVideoReaderDialog:!1,isSelectAllIndeterminate:!1,imageEditorConfirmVisible:!1}},computed:{filteredMedias(){let e=[];const t=this.medias.filter((e=>0==this.mediaType||e.type==this.mediaType));e=this.mediaSearch?t.filter((e=>e.name.toLowerCase().includes(this.mediaSearch.toLowerCase()))):t;const i=e.filter((e=>0==this.mediaDate||this.extractDatetimeMonthYear(e.insert_datetime)==this.mediaDate));return i},filteredMediaLinks(){const e=[];return this.filteredMedias.forEach((t=>{t.type==P.Tr.IMAGE.value&&e.push(this.resolveMediaLink(t.link))})),e}},watch:{medias:{handler(e,t){this.loadMediaDates()},deep:!0}},created(){this.init(),this.$_.forIn(P.Tr,((e,t)=>{this.mediaTypes.push(e)}))},methods:{...(0,W.mapActions)("media",["getMediasPage","deleteMedia","generateThumbnail"]),...(0,W.mapActions)("user",["getAllUsers"]),async init(){const e=await this.getAllUsers();e.success&&e.data&&(this.users=e.data);let t=null;const i=await this.getMediasPage({offset:this.lastMediaRowId,limit:12});return i.success&&i.data?(t=i.data,this.lastMediaRowId+=t.length,this.medias.push(...t)):this.$message.error(this.$t("anErrorOccured")),this.isLoading&&(this.isLoading=!1),t?t.length:0},async infiniteHandler(e){const t=await this.init();t>0?e.loaded():e.complete()},loadMediaDates(){this.mediaDates=[],this.medias.forEach((e=>{const t=this.extractDatetimeMonthYear(e.insert_datetime);this.mediaDates.includes(t)||this.mediaDates.push(t)}))},extractDatetimeMonthYear(e){if(!e)return"";let t=(0,U.bK)(e.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale});return t=t.split(" "),(0,F.fm)(t[1])+" "+t[2]},showPreview(e,t){this.currentItem=e,this.currentItemIndex=t,e.type==P.Tr.IMAGE.value&&(this.showViewer=!0),e.type==P.Tr.DOCUMENT.value&&window.open(this.resolveMediaLink(e.link)),e.type==P.Tr.AUDIO.value&&(this.showAudioReaderDialog=!0),e.type==P.Tr.VIDEO.value&&(this.showVideoReaderDialog=!0),e.type==P.Tr.OTHERS.value&&this.$message.warning(this.$t("cannotOpenThisFile"))},showDetails(e,t){this.currentItem=e,this.currentItemIndex=t;const i=this.mediaTypes.find((t=>t.value==e.type)),a=(0,U.bK)(e.insert_datetime.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale}),l=this.users.find((t=>t.id==e.sender));if(this.detailsData=[{name:this.$t("name"),value:e.name},{name:this.$t("url"),value:this.resolveMediaLink(e.link)},{name:this.$t("type"),value:i?i.label:""},{name:this.$t("size"),value:(0,F.gB)(e.size,!0)},{name:this.$t("mimeType"),value:e.mime},{name:this.$t("sentBy"),value:l?l.name:""},{name:this.$t("date"),value:a}],e.type==P.Tr.IMAGE.value){var s=new Image;s.onload=()=>{const e=s.naturalHeight,t=s.naturalWidth;t&&e&&self.detailsData.length&&self.detailsData.push({name:self.$t("dimensions"),value:t+" x "+e})},s.src=this.resolveMediaLink(e.link)}this.showDetailsDialog=!0},copyLink(e,t){t&&this.$message.success(this.$t("mediaLinkCopied"))},deleteItem(e,t){this.$confirm(this.$t("deleteMediaQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const t=await this.deleteMedia({id:e.id});t.success?(this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},deleteMultipleItems(){this.$confirm(1===this.selectedMedias.length?this.$t("deleteMediaQuestion"):this.$t("deleteMultipleItems",[this.selectedMedias.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.selectedMedias.length;t++)await this.deleteMedia({id:this.selectedMedias[t].id});e.close(),this.$message.success(this.$t("success")),this.reset()})).catch((()=>{}))},async reset(){this.isLoading=!0,this.medias=[],this.selectedMedias=[],this.lastMediaRowId=0,await this.init()},updateSelectedMedias(e,t){const i=this.selectedMedias.findIndex((t=>t.id===e.id));i>-1?(this.selectedMedias.length==this.filteredMedias.length&&(this.isSelectAllIndeterminate=!0),this.selectedMedias.splice(i,1)):this.selectedMedias.push(e)},handleSelectAll(){this.filteredMedias.length>this.selectedMedias.length?this.selectedMedias=this.$_.cloneDeep(this.filteredMedias):this.selectedMedias=[],this.isSelectAllIndeterminate=!1},editImage(e,t){this.currentItem=e,this.currentItemIndex=t,this.imageEditorVisible=!0},storeEditedPicture(e,t){this.currentEditorDataUrl=t,this.imageEditorConfirmVisible=!0},async saveEditedPicture(e){if(this.currentEditorDataUrl){var t=(0,F.Bo)(this.currentEditorDataUrl,{filename:this.$uuidv4()+".png",type:"image/png"});this.compressImages&&(t=await(0,F.hv)(t,{maxSizeMB:this.compressThreshold}));const a=e?this.currentItem.name:t.name,l=new FormData;l.append("folder",this.folder),l.append("overwrite",e),l.append("file",t,a);try{const i=await this.axios.post(z.STORAGE_API_BASE_URL,l,{headers:z.API_REQUEST_HEADERS});i.data&&"success"==i.data["status"]?(e&&await this.deleteMedia({id:this.currentItem.id}),await this.addItemInDB({context:H.R,data:{name:a,link:"root/"+this.folder+"/"+a,type:P.Tr.IMAGE.value,size:t.size||0,mime:t.type||"",sender:this.userData.id}}),await this.generateThumbnail({autoWidth:this.thumbnailsFormat==P.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==P.vh.AUTOHEIGHT.value,folder:this.folder,file:a,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))}),this.imageEditorConfirmVisible=!1,this.imageEditorVisible=!1,await this.reset()):this.$message.error(this.$t("anErrorOccured"))}catch(i){this.$message.error(this.$t("anErrorOccured"))}}}}},Y=i(83744);const X=(0,Y.Z)(Z,[["render",L],["__scopeId","data-v-0a5b2850"]]);var Q=X},31567:function(e,t,i){var a=i(14340),l=i(21101);t["Z"]={created(){const e=-1===this.restrictedScopes.findIndex((e=>this.$route.name.includes(e.value)));e||this.$router.replace(a.Z5.LOGIN.PATH)},computed:{...(0,l.mapState)({userData:e=>e.session.userData,accessList:e=>e.access.accessList}),...(0,l.mapGetters)({userScopes:"access/getUserScopes",restrictedScopes:"access/getUserRestrictedScopes",disabledModuleScopes:"access/getDisabledModuleScopes",userPageScopes:"access/getUserPageScopes",userActionScopes:"access/getUserActionScopes",userSectionScopes:"access/getUserSectionScopes",userPageScope:"access/getUserPageScope",userActionScope:"access/getUserActionScope",userSectionScope:"access/getUserSectionScope"})},methods:{...(0,l.mapActions)("access",["getAllAccess"]),getAccessName(e){const t=this.accessList.find((t=>t.id==e));return t?t.name:""}}}},38855:function(e,t,i){i(57658);var a=i(39355),l=i(14340),s=i(20747),o=i(21101);t["Z"]={data(){return{Routes:l.Z5,Currencies:l.Kt,WebsiteInfo:l.a,currencies:[]}},async created(){this.$_.forIn(l.Kt,((e,t)=>{this.currencies.push(e)})),this.$store.commit("global/updateCurrentPanelPath",this.$route.path,{root:!0});const e=await this.getItemFromDB({context:s.A,id:this.userData?.id});e.success&&e.data&&e.data.status==l.dp.DISABLED&&(this.destroySession(),this.$router.replace(l.Z5.LOGIN.PATH))},computed:{...(0,o.mapState)({userData:e=>e.session.userData}),...(0,o.mapGetters)({isUserConnected:"session/isUserConnected",getSettingValue:"setting/getSettingValue"})},methods:{formatDate:a.p6,reformatDate:a.bK,...(0,o.mapMutations)({destroySession:"session/destroySession"})}}}}]);
//# sourceMappingURL=group-medias.abdfe94b.js.map