(self["webpackChunkbreeze"]=self["webpackChunkbreeze"]||[]).push([[876],{99726:function(){!function(e){const t=e.fr=e.fr||{};t.dictionary=Object.assign(t.dictionary||{},{"%0 of %1":"%0 sur %1",Aquamarine:"Bleu vert",Black:"Noir","Block quote":"Citation",Blue:"Bleu",Bold:"Gras","Break text":"","Bulleted List":"Liste à puces",Cancel:"Annuler","Cannot upload file:":"Envoi du fichier échoué :","Centered image":"Image centrée","Change image text alternative":"Changer le texte alternatif à l’image","Choose heading":"Choisir l'en-tête",Column:"Colonne","Could not insert image at the current position.":"Impossible d'insérer l'image à la position courante.","Could not obtain resized image URL.":"Impossible d'obtenir l'image redimensionnée","Decrease indent":"Diminuer le retrait","Delete column":"Supprimer la colonne","Delete row":"Supprimer la ligne","Dim grey":"Gris pâle",Downloadable:"Fichier téléchargeable","Dropdown toolbar":"Barre d'outils dans un menu déroulant","Edit block":"Modifier le bloc","Edit link":"Modifier le lien","Editor toolbar":"Barre d'outils de l'éditeur","Enter image caption":"Saisir la légende de l’image","Full size image":"Image taille réelle",Green:"Vert",Grey:"Gris","Header column":"Colonne d'entête","Header row":"Ligne d'entête",Heading:"En-tête","Heading 1":"Titre 1","Heading 2":"Titre 2","Heading 3":"Titre 3","Heading 4":"Titre 4","Heading 5":"Titre 5","Heading 6":"Titre 6","Image toolbar":"Barre d'outils des images","image widget":"Objet image","In line":"","Increase indent":"Augmenter le retrait","Insert column left":"Insérer une colonne à gauche","Insert column right":"Insérer une colonne à droite","Insert image":"Insérer une image","Insert image or file":"Insérer une image ou un fichier","Insert media":"Insérer un média","Insert paragraph after block":"Insérer du texte après ce bloc","Insert paragraph before block":"Insérer du texte avant ce bloc","Insert row above":"Insérer une ligne au-dessus","Insert row below":"Insérer une ligne en-dessous","Insert table":"Insérer un tableau","Inserting image failed":"L'insertion d'image a échoué.",Italic:"Italique","Left aligned image":"Image alignée à gauche","Light blue":"Bleu clair","Light green":"Vert clair","Light grey":"Gris clair",Link:"Lien","Link URL":"URL du lien","Media URL":"URL de média","media widget":"Widget média","Merge cell down":"Fusionner la cellule en-dessous","Merge cell left":"Fusionner la cellule à gauche","Merge cell right":"Fusionner la cellule à droite","Merge cell up":"Fusionner la cellule au-dessus","Merge cells":"Fusionner les cellules",Next:"Suivant","Numbered List":"Liste numérotée","Open in a new tab":"Ouvrir dans un nouvel onglet","Open link in new tab":"Ouvrir le lien dans un nouvel onglet",Orange:"Orange",Paragraph:"Paragraphe","Paste the media URL in the input.":"Coller l'URL du média",Previous:"Précedent",Purple:"Violet",Red:"Rouge",Redo:"Restaurer","Rich Text Editor":"Éditeur de texte enrichi","Rich Text Editor, %0":"Éditeur de texte enrichi, %0","Right aligned image":"Image alignée à droite",Row:"Ligne",Save:"Enregistrer","Select all":"Sélectionner tout","Select column":"Sélectionner la colonne","Select row":"Sélectionner la ligne","Selecting resized image failed":"La sélection de l'image redimensionnée a échoué.","Show more items":"Montrer plus d'éléments","Side image":"Image latérale","Split cell horizontally":"Scinder la cellule horizontalement","Split cell vertically":"Scinder la cellule verticalement","Table toolbar":"Barre d'outils des tableaux","Text alternative":"Texte alternatif","The URL must not be empty.":"L'URL ne doit pas être vide.","This link has no URL":"Ce lien n'a pas d'URL","This media URL is not supported.":"Cette URL de média n'est pas supportée.","Tip: Paste the URL into the content to embed faster.":"Astuce : Copier l'URL du média dans le contenu pour l'insérer plus rapidement","Toggle caption off":"","Toggle caption on":"",Turquoise:"Turquoise",Undo:"Annuler",Unlink:"Supprimer le lien","Upload failed":"Échec de l'envoi","Upload in progress":"Téléchargement en cours",White:"Blanc","Widget toolbar":"Barre d'outils du widget","Wrap text":"",Yellow:"Jaune"}),t.getPluralForm=function(e){return e>1}}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={}))},39494:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var n=i(82234);function s(e,t,i,s,o,r){return(0,n.openBlock)(),(0,n.createElementBlock)("button",{onClick:t[0]||(t[0]=(...e)=>s.copy&&s.copy(...e))},[(0,n.renderSlot)(e.$slots,"default")])}var o=i(76109),r=i.n(o),a={name:"Copy",props:{toCopy:{type:String,default:""}},emits:["copy"],setup(e,t){const{toClipboard:i}=r()(),n=async()=>{try{await i(e.toCopy),t.emit("copy",e.toCopy,!0)}catch(n){console.error(n),t.emit("copy",e.toCopy,!1)}};return{copy:n}}},l=i(83744);const c=(0,l.Z)(a,[["render",s]]);var d=c},31377:function(e,t,i){"use strict";i.d(t,{Z:function(){return sT}});var n=i(68716),s=i(82234);function o(e,t,i,o,r,a){const l=(0,s.resolveComponent)("ckeditor"),c=n.Z,d=(0,s.resolveComponent)("el-dialog");return(0,s.openBlock)(),(0,s.createElementBlock)("section",null,[(0,s.createVNode)(l,{editor:r.editor,"tag-name":i.tagName,disabled:i.disabled,config:r.editorConfig,"model-value":i.modelValue?.replace(new RegExp(r.BASE_URL_MUSTACHE,"g"),r.STORAGE_API_BASE_URL),class:"page-content-editor",onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t?.replace(new RegExp(r.STORAGE_API_BASE_URL,"g"),r.BASE_URL_MUSTACHE))),onDestroy:t[1]||(t[1]=t=>e.$emit("destroy",t)),onReady:t[2]||(t[2]=t=>e.$emit("ready",t)),onFocus:t[3]||(t[3]=t=>e.$emit("focus",t)),onBlur:t[4]||(t[4]=t=>e.$emit("blur",t))},null,8,["editor","tag-name","disabled","config","model-value"]),(0,s.createVNode)(d,{modelValue:r.mediaPickerVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>r.mediaPickerVisible=e),title:e.$t("add"),"destroy-on-close":"",fullscreen:""},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(c,{multiple:!0,"display-videos":!0,"display-audios":!0,"display-images":!0,"display-documents":!0,"display-other-types":!0,"enable-add-from-an-url":!1,"enable-selection-details":!0,onSelected:a.onMediasSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])])}var r=i(75010),a=i(41371),l=i(45642),c='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M7 19L12 14L13.88 15.88C13.33 16.79 13 17.86 13 19H7M10 10.5C10 9.67 9.33 9 8.5 9S7 9.67 7 10.5 7.67 12 8.5 12 10 11.33 10 10.5M13.09 20H6V4H13V9H18V13.09C18.33 13.04 18.66 13 19 13C19.34 13 19.67 13.04 20 13.09V8L14 2H6C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H13.81C13.46 21.39 13.21 20.72 13.09 20M18 15V18H15V20H18V23H20V20H23V18H20V15H18Z" /></svg>';const{t:d}=r.Z.global;class h extends a.Z{init(){const e=this.editor;e.ui.componentFactory.add("addBreezeMedias",(e=>{const t=new l.Z(e);return t.set({label:d("add"),icon:c,withText:!1,tooltip:!0}),t.on("execute",(()=>{const e=new Event("add-breeze-medias");document.dispatchEvent(e)})),t}))}}var u='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z" /></svg>',m='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z" /></svg>';const{t:g}=r.Z.global;class p extends a.Z{init(){const e=this.editor;e.ui.componentFactory.add("fullScreen",(t=>{const i=new l.Z(t);let n=0;return i.set({label:g("fullscreen"),icon:m,withText:!1,tooltip:!0}),i.on("execute",(()=>{1==n?(e.sourceElement.nextElementSibling.removeAttribute("id"),document.body.removeAttribute("id"),i.set({label:g("fullscreen"),icon:m,withText:!1,tooltip:!0}),n=0):(e.sourceElement.nextElementSibling.setAttribute("id","fullscreeneditor"),document.body.setAttribute("id","fullscreenoverlay"),i.set({label:g("normalSize"),icon:u,withText:!1,tooltip:!0}),n=1)})),i}))}}var f=i(11165),w=i(14340),b=i(7397);i(57658);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class v extends b.Z{constructor(e){super(e),this._childCommands=[]}refresh(){}execute(...e){const t=this._getFirstEnabledCommand();return null!=t&&t.execute(e)}registerChildCommand(e){this._childCommands.push(e),e.on("change:isEnabled",(()=>this._checkEnabled())),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find((e=>e.isEnabled))}}var _=i(37514),y=i(24612),C=i(18533);function k(e){return(0,C.Z)(e)&&1===e.nodeType&&!(0,_.Z)(e)}var x=k;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class A{constructor(e,t){this._config={},t&&this.define(E(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){const i=!0;this._setToTarget(this._config,e,t,i)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,i,n=!1){if((0,_.Z)(t))return void this._setObjectToTarget(e,t,n);const s=t.split(".");t=s.pop();for(const o of s)(0,_.Z)(e[o])||(e[o]={}),e=e[o];if((0,_.Z)(i))return(0,_.Z)(e[t])||(e[t]={}),e=e[t],void this._setObjectToTarget(e,i,n);n&&"undefined"!=typeof e[t]||(e[t]=i)}_getFromSource(e,t){const i=t.split(".");t=i.pop();for(const n of i){if(!(0,_.Z)(e[n])){e=null;break}e=e[n]}return e?E(e[t]):void 0}_setObjectToTarget(e,t,i){Object.keys(t).forEach((n=>{this._setToTarget(e,n,t[n],i)}))}}function E(e){return(0,y.Z)(e,T)}function T(e){return x(e)?e:void 0}var P=i(32364),S=i(13117),V=i(3026),I=i(61409);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class N{constructor(e,t=[],i=[]){this._context=e,this._plugins=new Map,this._availablePlugins=new Map;for(const n of t)n.pluginName&&this._availablePlugins.set(n.pluginName,n);this._contextPlugins=new Map;for(const[n,s]of i)this._contextPlugins.set(n,s),this._contextPlugins.set(s,n),n.pluginName&&this._availablePlugins.set(n.pluginName,n)}*[Symbol.iterator](){for(const e of this._plugins)"function"==typeof e[0]&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let t=e;throw"function"==typeof e&&(t=e.pluginName||e.name),new S.ZP("plugincollection-plugin-not-loaded",this._context,{plugin:t})}return t}has(e){return this._plugins.has(e)}init(e,t=[],i=[]){const n=this,s=this._context;u(e),g(e);const o=e.filter((e=>!d(e,t))),r=[...m(o)];_(r,i);const a=b(r);return v(a,"init").then((()=>v(a,"afterInit"))).then((()=>a));function l(e){return"function"===typeof e}function c(e){return l(e)&&e.isContextPlugin}function d(e,t){return t.some((t=>t===e||(h(e)===t||h(t)===e)))}function h(e){return l(e)?e.pluginName||e.name:e}function u(e,t=new Set){e.forEach((e=>{l(e)&&(t.has(e)||(t.add(e),e.pluginName&&!n._availablePlugins.has(e.pluginName)&&n._availablePlugins.set(e.pluginName,e),e.requires&&u(e.requires,t)))}))}function m(e,t=new Set){return e.map((e=>l(e)?e:n._availablePlugins.get(e))).reduce(((e,i)=>t.has(i)?e:(t.add(i),i.requires&&(g(i.requires,i),m(i.requires,t).forEach((t=>e.add(t)))),e.add(i))),new Set)}function g(e,t=null){e.map((e=>l(e)?e:n._availablePlugins.get(e)||e)).forEach((e=>{p(e,t),f(e,t),w(e,t)}))}function p(e,t){if(!l(e)){if(t)throw new S.ZP("plugincollection-soft-required",s,{missingPlugin:e,requiredBy:h(t)});throw new S.ZP("plugincollection-plugin-not-found",s,{plugin:e})}}function f(e,t){if(c(t)&&!c(e))throw new S.ZP("plugincollection-context-required",s,{plugin:h(e),requiredBy:h(t)})}function w(e,i){if(i&&d(e,t))throw new S.ZP("plugincollection-required",s,{plugin:h(e),requiredBy:h(i)})}function b(e){return e.map((e=>{const t=n._contextPlugins.get(e)||new e(s);return n._add(e,t),t}))}function v(e,t){return e.reduce(((e,i)=>i[t]?n._contextPlugins.has(i)?e:e.then(i[t].bind(i)):e),Promise.resolve())}function _(e,t){for(const i of t){if("function"!=typeof i)throw new S.ZP("plugincollection-replace-plugin-invalid-type",null,{pluginItem:i});const t=i.pluginName;if(!t)throw new S.ZP("plugincollection-replace-plugin-missing-name",null,{pluginItem:i});if(i.requires&&i.requires.length)throw new S.ZP("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:t});const s=n._availablePlugins.get(t);if(!s)throw new S.ZP("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:t});const o=e.indexOf(s);if(-1===o){if(n._contextPlugins.has(s))return;throw new S.ZP("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:t})}if(s.requires&&s.requires.length)throw new S.ZP("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:t});e.splice(o,1,i),n._availablePlugins.set(t,i)}}}destroy(){const e=[];for(const[,t]of this)"function"!=typeof t.destroy||this._contextPlugins.has(t)||e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const i=e.pluginName;if(i){if(this._plugins.has(i))throw new S.ZP("plugincollection-plugin-name-conflict",null,{pluginName:i,plugin1:this._plugins.get(i).constructor,plugin2:e});this._plugins.set(i,t)}}}(0,I.Z)(N,V.ZP);var R=i(77125);function D(e,t,i=1){if("number"!==typeof i)throw new S.ZP("translation-service-quantity-not-a-number",null,{quantity:i});const n=M();1===n&&(e=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const s=t.id||t.string;if(0===n||!B(e,s))return 1!==i?t.plural:t.string;const o=window.CKEDITOR_TRANSLATIONS[e].dictionary,r=window.CKEDITOR_TRANSLATIONS[e].getPluralForm||(e=>1===e?0:1);if("string"===typeof o[s])return o[s];const a=Number(r(i));return o[s][a]}function B(e,t){return!!window.CKEDITOR_TRANSLATIONS[e]&&!!window.CKEDITOR_TRANSLATIONS[e].dictionary[t]}function M(){return Object.keys(window.CKEDITOR_TRANSLATIONS).length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const O=["ar","ara","fa","per","fas","he","heb","ku","kur","ug","uig"];function L(e){return O.includes(e)?"rtl":"ltr"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class F{constructor(e={}){this.uiLanguage=e.uiLanguage||"en",this.contentLanguage=e.contentLanguage||this.uiLanguage,this.uiLanguageDirection=L(this.uiLanguage),this.contentLanguageDirection=L(this.contentLanguage),this.t=(e,t)=>this._t(e,t)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=(0,R.Z)(t),"string"===typeof e&&(e={string:e});const i=!!e.plural,n=i?t[0]:1,s=D(this.uiLanguage,e,n);return z(s,t)}}function z(e,t){return e.replace(/%(\d+)/g,((e,i)=>i<t.length?t[i]:e))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ${constructor(e){this.config=new A(e,this.constructor.defaultConfig);const t=this.constructor.builtinPlugins;this.config.define("plugins",t),this.plugins=new N(this,t);const i=this.config.get("language")||{};this.locale=new F({uiLanguage:"string"===typeof i?i:i.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new P.Z,this._contextOwner=null}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const i of e.concat(t)){if("function"!=typeof i)throw new S.ZP("context-initplugins-constructor-only",null,{Plugin:i});if(!0!==i.isContextPlugin)throw new S.ZP("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,(e=>e.destroy()))).then((()=>this.plugins.destroy()))}_addEditor(e,t){if(this._contextOwner)throw new S.ZP("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise((t=>{const i=new this(e);t(i.initPlugins().then((()=>i)))}))}}var Z=i(75880);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class H{constructor(e){this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}(0,I.Z)(H,Z.Z);i(30541);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function U(e,t){const i=Math.min(e.length,t.length);for(let n=0;n<i;n++)if(e[n]!=t[n])return n;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}var W=i(92346);i(92310);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class q{constructor(e){this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new S.ZP("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;while(e.parent)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;while(t.parent)e.unshift(t.index),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}getCommonAncestor(e,t={}){const i=this.getAncestors(t),n=e.getAncestors(t);let s=0;while(i[s]==n[s]&&i[s])s++;return 0===s?null:i[s-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),i=e.getPath(),n=U(t,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<i[n]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire("change:"+e,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=(0,W.Z)(this);return delete e.parent,e}is(e){return"node"===e||"view:node"===e}}(0,I.Z)(q,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class G extends q{constructor(e,t){super(e),this._textData=t}is(e){return"$text"===e||"view:$text"===e||"text"===e||"view:text"===e||"node"===e||"view:node"===e}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof G&&(this===e||this.data===e.data)}_clone(){return new G(this.document,this.data)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class j{constructor(e,t,i){if(this.textNode=e,t<0||t>e.data.length)throw new S.ZP("view-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.data.length)throw new S.ZP("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return"$textProxy"===e||"view:$textProxy"===e||"textProxy"===e||"view:textProxy"===e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this.textNode:this.parent;while(null!==i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function K(e){const t=new Map;for(const i in e)t.set(i,e[i]);return t}var J=i(34665);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Y(e){return(0,J.Z)(e)?new Map(e):K(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Q{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)("string"==typeof t||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const e of this._patterns){const i=X(t,e);if(i)return{element:t,pattern:e,match:i}}return null}matchAll(...e){const t=[];for(const i of e)for(const e of this._patterns){const n=X(i,e);n&&t.push({element:i,pattern:e,match:n})}return t.length>0?t:null}getElementName(){if(1!==this._patterns.length)return null;const e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t}}function X(e,t){if("function"==typeof t)return t(e);const i={};return t.name&&(i.name=ee(t.name,e.name),!i.name)||t.attributes&&(i.attributes=oe(t.attributes,e),!i.attributes)?null:!(t.classes&&(i.classes=re(t.classes,e),!i.classes))&&(!(t.styles&&(i.styles=ae(t.styles,e),!i.styles))&&i)}function ee(e,t){return e instanceof RegExp?!!t.match(e):e===t}function te(e,t,i){const n=ie(e),s=Array.from(t),o=[];return n.forEach((([e,t])=>{s.forEach((n=>{ne(e,n)&&se(t,n,i)&&o.push(n)}))})),!n.length||o.length<n.length?null:o}function ie(e){return Array.isArray(e)?e.map((e=>(0,_.Z)(e)?(void 0!==e.key&&void 0!==e.value||(0,S.KE)("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0])):(0,_.Z)(e)?Object.entries(e):[[e,!0]]}function ne(e,t){return!0===e||e===t||e instanceof RegExp&&t.match(e)}function se(e,t,i){if(!0===e)return!0;const n=i(t);return e===n||e instanceof RegExp&&!!String(n).match(e)}function oe(e,t){const i=new Set(t.getAttributeKeys());return(0,_.Z)(e)?(void 0!==e.style&&(0,S.KE)("matcher-pattern-deprecated-attributes-style-key",e),void 0!==e.class&&(0,S.KE)("matcher-pattern-deprecated-attributes-class-key",e)):(i.delete("style"),i.delete("class")),te(e,i,(e=>t.getAttribute(e)))}function re(e,t){return te(e,t.getClassNames())}function ae(e,t){return te(e,t.getStyleNames(!0),(e=>t.getStyle(e)))}var le=i(77226),ce=i(22823);function de(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var he=de,ue=i(13317);function me(e,t,i){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),i=i>s?s:i,i<0&&(i+=s),s=t>i?0:i-t>>>0,t>>>=0;var o=Array(s);while(++n<s)o[n]=e[n+t];return o}var ge=me;function pe(e,t){return t.length<2?e:(0,ue.Z)(e,ge(t,0,-1))}var fe=pe,we=i(62281);function be(e,t){return t=(0,ce.Z)(t,e),e=fe(e,t),null==e||delete e[(0,we.Z)(he(t))]}var ve=be;function _e(e,t){return null==e||ve(e,t)}var ye=_e,Ce=i(16423),ke=i(40987),xe=i(48707);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ae{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){const e=Object.entries(this._styles),t=Array.from(e);return!t.length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=Array.from(Te(e).entries());for(const[i,n]of t)this._styleProcessor.toNormalizedForm(i,n,this._styles)}has(e){if(this.isEmpty)return!1;const t=this._styleProcessor.getReducedForm(e,this._styles),i=t.find((([t])=>t===e));return Array.isArray(i)}set(e,t){if((0,le.Z)(e))for(const[i,n]of Object.entries(e))this._styleProcessor.toNormalizedForm(i,n,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t=Pe(e);ye(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map((e=>e.join(":"))).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!(0,le.Z)(this._styles[e]))return this._styles[e];const t=this._styleProcessor.getReducedForm(e,this._styles),i=t.find((([t])=>t===e));return Array.isArray(i)?i[1]:void 0}getStyleNames(e=!1){if(this.isEmpty)return[];if(e)return this._styleProcessor.getStyleNames(this._styles);const t=this._getStylesEntries();return t.map((([e])=>e))}clear(){this._styles={}}_getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const i of t)e.push(...this._styleProcessor.getReducedForm(i,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split("."),i=t.length>1;if(!i)return;const n=t.splice(0,t.length-1).join("."),s=(0,Ce.Z)(this._styles,n);if(!s)return;const o=!Array.from(Object.keys(s)).length;o&&this.remove(n)}}class Ee{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,i){if((0,le.Z)(t))Se(i,Pe(e),t);else if(this._normalizers.has(e)){const n=this._normalizers.get(e),{path:s,value:o}=n(t);Se(i,s,o)}else Se(i,e,t)}getNormalized(e,t){if(!e)return(0,ke.Z)({},t);if(void 0!==t[e])return t[e];if(this._extractors.has(e)){const i=this._extractors.get(e);if("string"===typeof i)return(0,Ce.Z)(t,i);const n=i(e,t);if(n)return n}return(0,Ce.Z)(t,Pe(e))}getReducedForm(e,t){const i=this.getNormalized(e,t);if(void 0===i)return[];if(this._reducers.has(e)){const t=this._reducers.get(e);return t(i)}return[[e,i]]}getStyleNames(e){const t=Array.from(this._consumables.keys()).filter((t=>{const i=this.getNormalized(t,e);return i&&"object"==typeof i?Object.keys(i).length:i})),i=new Set([...t,...Object.keys(e)]);return Array.from(i.values())}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const i of t)this._mapStyleNames(i,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function Te(e){let t=null,i=0,n=0,s=null;const o=new Map;if(""===e)return o;";"!=e.charAt(e.length-1)&&(e+=";");for(let r=0;r<e.length;r++){const a=e.charAt(r);if(null===t)switch(a){case":":s||(s=e.substr(i,r-i),n=r+1);break;case'"':case"'":t=a;break;case";":{const t=e.substr(n,r-n);s&&o.set(s.trim(),t.trim()),s=null,i=r+1;break}}else a===t&&(t=null)}return o}function Pe(e){return e.replace("-",".")}function Se(e,t,i){let n=i;(0,le.Z)(i)&&(n=(0,ke.Z)({},(0,Ce.Z)(e,t),i)),(0,xe.Z)(e,t,n)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ve extends q{constructor(e,t,i,n){if(super(e),this.name=t,this._attrs=Ie(i),this._children=[],n&&this._insertChild(0,n),this._classes=new Set,this._attrs.has("class")){const e=this._attrs.get("class");Ne(this._classes,e),this._attrs.delete("class")}this._styles=new Ae(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map,this._isAllowedInsideAttributeElement=!1,this._unsafeAttributesToRender=[]}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}get isAllowedInsideAttributeElement(){return this._isAllowedInsideAttributeElement}is(e,t=null){return t?t===this.name&&("element"===e||"view:element"===e):"element"===e||"view:element"===e||"node"===e||"view:node"===e}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if("class"==e)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==e){const e=this._styles.toString();return""==e?void 0:e}return this._attrs.get(e)}hasAttribute(e){return"class"==e?this._classes.size>0:"style"==e?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof Ve))return!1;if(this===e)return!0;if(this.name!=e.name)return!1;if(this.isAllowedInsideAttributeElement!=e.isAllowedInsideAttributeElement)return!1;if(this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,i]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==i)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const t of this._styles.getStyleNames())if(!e._styles.has(t)||e._styles.getAsString(t)!==this._styles.getAsString(t))return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e=!1){return this._styles.getStyleNames(e)}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new Q(...e);let i=this.parent;while(i){if(t.match(i))return i;i=i.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=this._styles.toString(),i=Array.from(this._attrs).map((e=>`${e[0]}="${e[1]}"`)).sort().join(" ");return this.name+(""==e?"":` class="${e}"`)+(t?` style="${t}"`:"")+(""==i?"":` ${i}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const t=[];if(e)for(const n of this.getChildren())t.push(n._clone(e));const i=new this.constructor(this.document,this.name,this._attrs,t);return i._classes=new Set(this._classes),i._styles.set(this._styles.getNormalized()),i._customProperties=new Map(this._customProperties),i.getFillerOffset=this.getFillerOffset,i._isAllowedInsideAttributeElement=this.isAllowedInsideAttributeElement,i}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let i=0;const n=Re(this.document,t);for(const s of n)null!==s.parent&&s._remove(),s.parent=this,s.document=this.document,this._children.splice(e,0,s),e++,i++;return i}_removeChildren(e,t=1){this._fireChange("children",this);for(let i=e;i<e+t;i++)this._children[i].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){t=String(t),this._fireChange("attributes",this),"class"==e?Ne(this._classes,t):"style"==e?this._styles.setTo(t):this._attrs.set(e,t)}_removeAttribute(e){return this._fireChange("attributes",this),"class"==e?this._classes.size>0&&(this._classes.clear(),!0):"style"==e?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const t of(0,R.Z)(e))this._classes.add(t)}_removeClass(e){this._fireChange("attributes",this);for(const t of(0,R.Z)(e))this._classes.delete(t)}_setStyle(e,t){this._fireChange("attributes",this),this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this);for(const t of(0,R.Z)(e))this._styles.remove(t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}function Ie(e){e=Y(e);for(const[t,i]of e)null===i?e.delete(t):"string"!=typeof i&&e.set(t,String(i));return e}function Ne(e,t){const i=t.split(/\s+/);e.clear(),i.forEach((t=>e.add(t)))}function Re(e,t){return"string"==typeof t?[new G(e,t)]:((0,J.Z)(t)||(t=[t]),Array.from(t).map((t=>"string"==typeof t?new G(e,t):t instanceof j?new G(e,t.data):t)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class De extends Ve{constructor(e,t,i,n){super(e,t,i,n),this.getFillerOffset=Be}is(e,t=null){return t?t===this.name&&("containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}}function Be(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const i of e)if(!i.is("uiElement"))return null;return this.childCount}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Me extends De{constructor(e,t,i,n){super(e,t,i,n),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",(t=>t&&e.selection.editableElement==this)),this.listenTo(e.selection,"change",(()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this}))}is(e,t=null){return t?t===this.name&&("editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}destroy(){this.stopListening()}}(0,I.Z)(Me,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Oe=Symbol("rootName");class Le extends Me{constructor(e,t){super(e,t),this.rootName="main"}is(e,t=null){return t?t===this.name&&("rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}get rootName(){return this.getCustomProperty(Oe)}set rootName(e){this._setCustomProperty(Oe,e)}set _name(e){this.name=e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fe{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new S.ZP("view-tree-walker-no-start-position",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new S.ZP("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=ze._createAt(e.startPosition):this.position=ze._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(e){let t,i,n;do{n=this.position,({done:t,value:i}=this.next())}while(!t&&e(i));t||(this.position=n)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,i=e.parent;if(null===i.parent&&e.offset===i.childCount)return{done:!0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};let n;if(i instanceof G){if(e.isAtEnd)return this.position=ze._createAfter(i),this._next();n=i.data[e.offset]}else n=i.getChild(e.offset);if(n instanceof Ve)return this.shallow?e.offset++:e=new ze(n,0),this.position=e,this._formatReturnValue("elementStart",n,t,e,1);if(n instanceof G){if(this.singleCharacters)return e=new ze(n,0),this.position=e,this._next();{let i,s=n.data.length;return n==this._boundaryEndParent?(s=this.boundaries.end.offset,i=new j(n,0,s),e=ze._createAfter(i)):(i=new j(n,0,n.data.length),e.offset++),this.position=e,this._formatReturnValue("text",i,t,e,s)}}if("string"==typeof n){let n;if(this.singleCharacters)n=1;else{const t=i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length;n=t-e.offset}const s=new j(i,e.offset,n);return e.offset+=n,this.position=e,this._formatReturnValue("text",s,t,e,n)}return e=ze._createAfter(i),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,t,e)}_previous(){let e=this.position.clone();const t=this.position,i=e.parent;if(null===i.parent&&0===e.offset)return{done:!0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};let n;if(i instanceof G){if(e.isAtStart)return this.position=ze._createBefore(i),this._previous();n=i.data[e.offset-1]}else n=i.getChild(e.offset-1);if(n instanceof Ve)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",n,t,e,1)):(e=new ze(n,n.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",n,t,e));if(n instanceof G){if(this.singleCharacters)return e=new ze(n,n.data.length),this.position=e,this._previous();{let i,s=n.data.length;if(n==this._boundaryStartParent){const t=this.boundaries.start.offset;i=new j(n,t,n.data.length-t),s=i.data.length,e=ze._createBefore(i)}else i=new j(n,0,n.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",i,t,e,s)}}if("string"==typeof n){let n;if(this.singleCharacters)n=1;else{const t=i===this._boundaryStartParent?this.boundaries.start.offset:0;n=e.offset-t}e.offset-=n;const s=new j(i,e.offset,n);return this.position=e,this._formatReturnValue("text",s,t,e,n)}return e=ze._createBefore(i),this.position=e,this._formatReturnValue("elementStart",i,t,e,1)}_formatReturnValue(e,t,i,n,s){return t instanceof j&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?i=ze._createAfter(t.textNode):(n=ze._createAfter(t.textNode),this.position=n)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?i=ze._createBefore(t.textNode):(n=ze._createBefore(t.textNode),this.position=n))),{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:n,length:s}}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ze{constructor(e,t){this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;while(!(e instanceof Me)){if(!e.parent)return null;e=e.parent}return e}getShiftedBy(e){const t=ze._createAt(this),i=t.offset+e;return t.offset=i<0?0:i,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const i=new Fe(t);return i.skip(e),i.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),i=e.getAncestors();let n=0;while(t[n]==i[n]&&t[n])n++;return 0===n?null:t[n-1]}is(e){return"position"===e||"view:position"===e}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return"before"==this.compareWith(e)}isAfter(e){return"after"==this.compareWith(e)}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],i=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),i.push(e.offset);const n=U(t,i);switch(n){case"prefix":return"before";case"extension":return"after";default:return t[n]<i[n]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Fe(e)}clone(){return new ze(this.parent,this.offset)}static _createAt(e,t){if(e instanceof ze)return new this(e.parent,e.offset);{const i=e;if("end"==t)t=i.is("$text")?i.data.length:i.childCount;else{if("before"==t)return this._createBefore(i);if("after"==t)return this._createAfter(i);if(0!==t&&!t)throw new S.ZP("view-createpositionat-offset-required",i)}return new ze(i,t)}}static _createAfter(e){if(e.is("$textProxy"))return new ze(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new S.ZP("view-position-after-root",e,{root:e});return new ze(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new ze(e.textNode,e.offsetInText);if(!e.parent)throw new S.ZP("view-position-before-root",e,{root:e});return new ze(e.parent,e.index)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $e{constructor(e,t=null){this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new Fe({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Ze,{direction:"backward"}),t=this.end.getLastMatchingPosition(Ze);return e.parent.is("$text")&&e.isAtStart&&(e=ze._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=ze._createAfter(t.parent)),new $e(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(Ze);if(e.isAfter(this.end)||e.isEqual(this.end))return new $e(e,e);let t=this.end.getLastMatchingPosition(Ze,{direction:"backward"});const i=e.nodeAfter,n=t.nodeBefore;return i&&i.is("$text")&&(e=new ze(i,0)),n&&n.is("$text")&&(t=new ze(n,n.data.length)),new $e(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&n}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new $e(this.start,e.start)),this.containsPosition(e.end)&&t.push(new $e(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,i=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(i=e.end),new $e(t,i)}return null}getWalker(e={}){return e.boundaries=this,new Fe(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new $e(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Fe(e);for(const i of t)yield i.item}*getPositions(e={}){e.boundaries=this;const t=new Fe(e);yield t.position;for(const i of t)yield i.nextPosition}is(e){return"range"===e||"view:range"===e}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,i,n){return new this(new ze(e,t),new ze(i,n))}static _createFromPositionAndShift(e,t){const i=e,n=e.getShiftedBy(t);return t>0?new this(i,n):new this(n,i)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(ze._createBefore(e),t)}}function Ze(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function He(e){let t=0;for(const i of e)t++;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ue{constructor(e=null,t,i){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,t,i)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1],t=this._lastRangeBackward?e.end:e.start;return t.clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1],t=this._lastRangeBackward?e.start:e.end;return t.clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel)return!1;if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let i=!1;for(const n of e._ranges)if(t.isEqual(n)){i=!0;break}if(!i)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=He(this.getRanges()),i=He(e.getRanges());if(t!=i)return!1;if(0==t)return!0;for(let n of this.getRanges()){n=n.getTrimmed();let t=!1;for(let i of e.getRanges())if(i=i.getTrimmed(),n.start.isEqual(i.start)&&n.end.isEqual(i.end)){t=!0;break}if(!t)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(e,t,i){if(null===e)this._setRanges([]),this._setFakeOptions(t);else if(e instanceof Ue||e instanceof We)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof $e)this._setRanges([e],t&&t.backward),this._setFakeOptions(t);else if(e instanceof ze)this._setRanges([new $e(e)]),this._setFakeOptions(t);else if(e instanceof q){const n=!!i&&!!i.backward;let s;if(void 0===t)throw new S.ZP("view-selection-setto-required-second-parameter",this);s="in"==t?$e._createIn(e):"on"==t?$e._createOn(e):new $e(ze._createAt(e,t)),this._setRanges([s],n),this._setFakeOptions(i)}else{if(!(0,J.Z)(e))throw new S.ZP("view-selection-setto-not-selectable",this);this._setRanges(e,t&&t.backward),this._setFakeOptions(t)}this.fire("change")}setFocus(e,t){if(null===this.anchor)throw new S.ZP("view-selection-setfocus-no-ranges",this);const i=ze._createAt(e,t);if("same"==i.compareWith(this.focus))return;const n=this.anchor;this._ranges.pop(),"before"==i.compareWith(n)?this._addRange(new $e(i,n),!0):this._addRange(new $e(n,i)),this.fire("change")}is(e){return"selection"===e||"view:selection"===e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const i of e)this._addRange(i);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof $e))throw new S.ZP("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new S.ZP("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new $e(e.start,e.end))}}(0,I.Z)(Ue,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class We{constructor(e=null,t,i){this._selection=new Ue,this._selection.delegate("change").to(this),this._selection.setTo(e,t,i)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}is(e){return"selection"===e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e}_setTo(e,t,i){this._selection.setTo(e,t,i)}_setFocus(e,t){this._selection.setFocus(e,t)}}(0,I.Z)(We,V.ZP);var qe=i(48810);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ge extends qe.Z{constructor(e,t,i){super(e,t),this.startRange=i,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const je=Symbol("bubbling contexts"),Ke={fire(e,...t){try{const i=e instanceof qe.Z?e:new qe.Z(this,e),n=et(this);if(!n.size)return;if(Ye(i,"capturing",this),Qe(n,"$capture",i,...t))return i.return;const s=i.startRange||this.selection.getFirstRange(),o=s?s.getContainedElement():null,r=!!o&&Boolean(Xe(n,o));let a=o||tt(s);if(Ye(i,"atTarget",a),!r){if(Qe(n,"$text",i,...t))return i.return;Ye(i,"bubbling",a)}while(a){if(a.is("rootElement")){if(Qe(n,"$root",i,...t))return i.return}else if(a.is("element")&&Qe(n,a.name,i,...t))return i.return;if(Qe(n,a,i,...t))return i.return;a=a.parent,Ye(i,"bubbling",a)}return Ye(i,"bubbling",this),Qe(n,"$document",i,...t),i.return}catch(i){S.ZP.rethrowUnexpectedError(i,this)}},_addEventListener(e,t,i){const n=(0,R.Z)(i.context||"$document"),s=et(this);for(const o of n){let n=s.get(o);n||(n=Object.create(V.ZP),s.set(o,n)),this.listenTo(n,e,t,i)}},_removeEventListener(e,t){const i=et(this);for(const n of i.values())this.stopListening(n,e,t)}};var Je=Ke;function Ye(e,t,i){e instanceof Ge&&(e._eventPhase=t,e._currentTarget=i)}function Qe(e,t,i,...n){const s="string"==typeof t?e.get(t):Xe(e,t);return!!s&&(s.fire(i,...n),i.stop.called)}function Xe(e,t){for(const[i,n]of e)if("function"==typeof i&&i(t))return n;return null}function et(e){return e[je]||(e[je]=new Map),e[je]}function tt(e){if(!e)return null;const t=e.start.parent,i=e.end.parent,n=t.getPath(),s=i.getPath();return n.length>s.length?t:i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class it{constructor(e){this.selection=new We,this.roots=new P.Z({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map((e=>e.destroy())),this.stopListening()}_callPostFixers(e){let t=!1;do{for(const i of this._postFixers)if(t=i(e),t)break}while(t)}}(0,I.Z)(it,Je),(0,I.Z)(it,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const nt=10;class st extends Ve{constructor(e,t,i,n){super(e,t,i,n),this.getFillerOffset=ot,this._priority=nt,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new S.ZP("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}is(e,t=null){return t?t===this.name&&("attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e):"attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}function ot(){if(rt(this))return null;let e=this.parent;while(e&&e.is("attributeElement")){if(rt(e)>1)return null;e=e.parent}return!e||rt(e)>1?null:this.childCount}function rt(e){return Array.from(e.getChildren()).filter((e=>!e.is("uiElement"))).length}st.DEFAULT_PRIORITY=nt;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class at extends Ve{constructor(e,t,i,n){super(e,t,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=lt}is(e,t=null){return t?t===this.name&&("emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e):"emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new S.ZP("view-emptyelement-cannot-add",[this,t])}}function lt(){return null}var ct=i(41700);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dt extends Ve{constructor(e,t,i,n){super(e,t,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=ut}is(e,t=null){return t?t===this.name&&("uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e):"uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new S.ZP("view-uielement-cannot-add",this)}render(e){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const i of this.getAttributeKeys())t.setAttribute(i,this.getAttribute(i));return t}}function ht(e){e.document.on("arrowKey",((t,i)=>mt(t,i,e.domConverter)),{priority:"low"})}function ut(){return null}function mt(e,t,i){if(t.keyCode==ct.Do.arrowright){const e=t.domTarget.ownerDocument.defaultView.getSelection(),n=1==e.rangeCount&&e.getRangeAt(0).collapsed;if(n||t.shiftKey){const t=e.focusNode,s=e.focusOffset,o=i.domPositionToView(t,s);if(null===o)return;let r=!1;const a=o.getLastMatchingPosition((e=>(e.item.is("uiElement")&&(r=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement")))));if(r){const t=i.viewPositionToDom(a);n?e.collapse(t.parent,t.offset):e.extend(t.parent,t.offset)}}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gt extends Ve{constructor(e,t,i,n){super(e,t,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=pt}is(e,t=null){return t?t===this.name&&("rawElement"===e||"view:rawElement"===e||"element"===e||"view:element"===e):"rawElement"===e||"view:rawElement"===e||e===this.name||e==="view:"+this.name||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new S.ZP("view-rawelement-cannot-add",[this,t])}}function pt(){return null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ft{constructor(e,t){this.document=e,this._children=[],t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"view:documentFragment"===e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let i=0;const n=wt(this.document,t);for(const s of n)null!==s.parent&&s._remove(),s.parent=this,this._children.splice(e,0,s),e++,i++;return i}_removeChildren(e,t=1){this._fireChange("children",this);for(let i=e;i<e+t;i++)this._children[i].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}}function wt(e,t){return"string"==typeof t?[new G(e,t)]:((0,J.Z)(t)||(t=[t]),Array.from(t).map((t=>"string"==typeof t?new G(e,t):t instanceof j?new G(e,t.data):t)))}(0,I.Z)(ft,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bt{constructor(e){this.document=e,this._cloneGroups=new Map}setSelection(e,t,i){this.document.selection._setTo(e,t,i)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new ft(this.document,e)}createText(e){return new G(this.document,e)}createAttributeElement(e,t,i={}){const n=new st(this.document,e,t);return"number"===typeof i.priority&&(n._priority=i.priority),i.id&&(n._id=i.id),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createContainerElement(e,t,i={}){const n=new De(this.document,e,t);return void 0!==i.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createEditableElement(e,t,i={}){const n=new Me(this.document,e,t);return n._document=this.document,i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createEmptyElement(e,t,i={}){const n=new at(this.document,e,t);return void 0!==i.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createUIElement(e,t,i,n={}){const s=new dt(this.document,e,t);return i&&(s.render=i),void 0!==n.isAllowedInsideAttributeElement&&(s._isAllowedInsideAttributeElement=n.isAllowedInsideAttributeElement),s}createRawElement(e,t,i,n={}){const s=new gt(this.document,e,t);return s.render=i||(()=>{}),void 0!==n.isAllowedInsideAttributeElement&&(s._isAllowedInsideAttributeElement=n.isAllowedInsideAttributeElement),n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){(0,_.Z)(e)&&void 0===i&&(i=t),i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof ze?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new S.ZP("view-writer-break-non-container-element",this.document);if(!t.parent)throw new S.ZP("view-writer-break-root",this.document);if(e.isAtStart)return ze._createBefore(t);if(!e.isAtEnd){const i=t._clone(!1);this.insert(ze._createAfter(t),i);const n=new $e(e,ze._createAt(t,"end")),s=new ze(i,0);this.move(n,s)}return ze._createAfter(t)}mergeAttributes(e){const t=e.offset,i=e.parent;if(i.is("$text"))return e;if(i.is("attributeElement")&&0===i.childCount){const e=i.parent,t=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new ze(e,t))}const n=i.getChild(t-1),s=i.getChild(t);if(!n||!s)return e;if(n.is("$text")&&s.is("$text"))return xt(n,s);if(n.is("attributeElement")&&s.is("attributeElement")&&n.isSimilar(s)){const e=n.childCount;return n._appendChild(s.getChildren()),s._remove(),this._removeFromClonedElementsGroup(s),this.mergeAttributes(new ze(n,e))}return e}mergeContainers(e){const t=e.nodeBefore,i=e.nodeAfter;if(!t||!i||!t.is("containerElement")||!i.is("containerElement"))throw new S.ZP("view-writer-merge-containers-invalid-position",this.document);const n=t.getChild(t.childCount-1),s=n instanceof G?ze._createAt(n,"end"):ze._createAt(t,"end");return this.move($e._createIn(i),ze._createAt(t,"end")),this.remove($e._createOn(i)),s}insert(e,t){t=(0,J.Z)(t)?[...t]:[t],At(t,this.document);const i=t.reduce(((e,t)=>{const i=e[e.length-1],n=!(t.is("uiElement")&&t.isAllowedInsideAttributeElement);return i&&i.breakAttributes==n?i.nodes.push(t):e.push({breakAttributes:n,nodes:[t]}),e}),[]);let n=null,s=e;for(const{nodes:o,breakAttributes:r}of i){const e=this._insertNodes(s,o,r);n||(n=e.start),s=e.end}return n?new $e(n,s):new $e(e)}remove(e){const t=e instanceof $e?e:$e._createOn(e);if(Pt(t,this.document),t.isCollapsed)return new ft(this.document);const{start:i,end:n}=this._breakAttributesRange(t,!0),s=i.parent,o=n.offset-i.offset,r=s._removeChildren(i.offset,o);for(const l of r)this._removeFromClonedElementsGroup(l);const a=this.mergeAttributes(i);return t.start=a,t.end=a.clone(),new ft(this.document,r)}clear(e,t){Pt(e,this.document);const i=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const n of i){const i=n.item;let s;if(i.is("element")&&t.isSimilar(i))s=$e._createOn(i);else if(!n.nextPosition.isAfter(e.start)&&i.is("$textProxy")){const e=i.getAncestors().find((e=>e.is("element")&&t.isSimilar(e)));e&&(s=$e._createIn(e))}s&&(s.end.isAfter(e.end)&&(s.end=e.end),s.start.isBefore(e.start)&&(s.start=e.start),this.remove(s))}}move(e,t){let i;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const n=t.parent,s=n.childCount;e=this._breakAttributesRange(e,!0),i=this.remove(e),t.offset+=n.childCount-s}else i=this.remove(e);return this.insert(t,i)}wrap(e,t){if(!(t instanceof st))throw new S.ZP("view-writer-wrap-invalid-attribute",this.document);if(Pt(e,this.document),e.isCollapsed){let i=e.start;i.parent.is("element")&&!vt(i.parent)&&(i=i.getLastMatchingPosition((e=>e.item.is("uiElement")))),i=this._wrapPosition(i,t);const n=this.document.selection;return n.isCollapsed&&n.getFirstPosition().isEqual(e.start)&&this.setSelection(i),new $e(i)}return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof st))throw new S.ZP("view-writer-unwrap-invalid-attribute",this.document);if(Pt(e,this.document),e.isCollapsed)return e;const{start:i,end:n}=this._breakAttributesRange(e,!0),s=i.parent,o=this._unwrapChildren(s,i.offset,n.offset,t),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new $e(r,a)}rename(e,t){const i=new De(this.document,e,t.getAttributes());return this.insert(ze._createAfter(t),i),this.move($e._createIn(t),ze._createAt(i,0)),this.remove($e._createOn(t)),i}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return ze._createAt(e,t)}createPositionAfter(e){return ze._createAfter(e)}createPositionBefore(e){return ze._createBefore(e)}createRange(e,t){return new $e(e,t)}createRangeOn(e){return $e._createOn(e)}createRangeIn(e){return $e._createIn(e)}createSelection(e,t,i){return new Ue(e,t,i)}_insertNodes(e,t,i){let n,s;if(n=i?_t(e):e.parent.is("$text")?e.parent.parent:e.parent,!n)throw new S.ZP("view-writer-invalid-position-container",this.document);s=i?this._breakAttributes(e,!0):e.parent.is("$text")?kt(e):e;const o=n._insertChild(s.offset,t);for(const c of t)this._addToClonedElementsGroup(c);const r=s.getShiftedBy(o),a=this.mergeAttributes(s);a.isEqual(s)||r.offset--;const l=this.mergeAttributes(r);return new $e(a,l)}_wrapChildren(e,t,i,n){let s=t;const o=[];while(s<i){const t=e.getChild(s),i=t.is("$text"),r=t.is("attributeElement"),a=t.isAllowedInsideAttributeElement;if(r&&this._wrapAttributeElement(n,t))o.push(new ze(e,s));else if(i||a||r&&yt(n,t)){const i=n._clone();t._remove(),i._appendChild(t),e._insertChild(s,i),this._addToClonedElementsGroup(i),o.push(new ze(e,s))}else r&&this._wrapChildren(t,0,t.childCount,n);s++}let r=0;for(const a of o){if(a.offset-=r,a.offset==t)continue;const e=this.mergeAttributes(a);e.isEqual(a)||(r++,i--)}return $e._createFromParentsAndOffsets(e,t,e,i)}_unwrapChildren(e,t,i,n){let s=t;const o=[];while(s<i){const t=e.getChild(s);if(t.is("attributeElement"))if(t.isSimilar(n)){const n=t.getChildren(),r=t.childCount;t._remove(),e._insertChild(s,n),this._removeFromClonedElementsGroup(t),o.push(new ze(e,s),new ze(e,s+r)),s+=r,i+=r-1}else this._unwrapAttributeElement(n,t)?(o.push(new ze(e,s),new ze(e,s+1)),s++):(this._unwrapChildren(t,0,t.childCount,n),s++);else s++}let r=0;for(const a of o){if(a.offset-=r,a.offset==t||a.offset==i)continue;const e=this.mergeAttributes(a);e.isEqual(a)||(r++,i--)}return $e._createFromParentsAndOffsets(e,t,e,i)}_wrapRange(e,t){const{start:i,end:n}=this._breakAttributesRange(e,!0),s=i.parent,o=this._wrapChildren(s,i.offset,n.offset,t),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new $e(r,a)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return Ct(e.clone());e.parent.is("$text")&&(e=kt(e));const i=this.createAttributeElement();i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,e.parent._insertChild(e.offset,i);const n=new $e(e,e.getShiftedBy(1));this.wrap(n,t);const s=new ze(i.parent,i.index);i._remove();const o=s.nodeBefore,r=s.nodeAfter;return o instanceof G&&r instanceof G?xt(o,r):Ct(s)}_wrapAttributeElement(e,t){if(!St(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if("class"!==i&&"style"!==i&&t.hasAttribute(i)&&t.getAttribute(i)!==e.getAttribute(i))return!1;for(const i of e.getStyleNames())if(t.hasStyle(i)&&t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())"class"!==i&&"style"!==i&&(t.hasAttribute(i)||this.setAttribute(i,e.getAttribute(i),t));for(const i of e.getStyleNames())t.hasStyle(i)||this.setStyle(i,e.getStyle(i),t);for(const i of e.getClassNames())t.hasClass(i)||this.addClass(i,t);return!0}_unwrapAttributeElement(e,t){if(!St(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if("class"!==i&&"style"!==i&&(!t.hasAttribute(i)||t.getAttribute(i)!==e.getAttribute(i)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const i of e.getStyleNames())if(!t.hasStyle(i)||t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())"class"!==i&&"style"!==i&&this.removeAttribute(i,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const i=e.start,n=e.end;if(Pt(e,this.document),e.isCollapsed){const i=this._breakAttributes(e.start,t);return new $e(i,i)}const s=this._breakAttributes(n,t),o=s.parent.childCount,r=this._breakAttributes(i,t);return s.offset+=s.parent.childCount-o,new $e(r,s)}_breakAttributes(e,t=!1){const i=e.offset,n=e.parent;if(e.parent.is("emptyElement"))throw new S.ZP("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new S.ZP("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new S.ZP("view-writer-cannot-break-raw-element",this.document);if(!t&&n.is("$text")&&Tt(n.parent))return e.clone();if(Tt(n))return e.clone();if(n.is("$text"))return this._breakAttributes(kt(e),t);const s=n.childCount;if(i==s){const e=new ze(n.parent,n.index+1);return this._breakAttributes(e,t)}if(0===i){const e=new ze(n.parent,n.index);return this._breakAttributes(e,t)}{const e=n.index+1,s=n._clone();n.parent._insertChild(e,s),this._addToClonedElementsGroup(s);const o=n.childCount-i,r=n._removeChildren(i,o);s._appendChild(r);const a=new ze(n.parent,e);return this._breakAttributes(a,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const n of e.getChildren())this._addToClonedElementsGroup(n);const t=e.id;if(!t)return;let i=this._cloneGroups.get(t);i||(i=new Set,this._cloneGroups.set(t,i)),i.add(e),e._clonesGroup=i}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const n of e.getChildren())this._removeFromClonedElementsGroup(n);const t=e.id;if(!t)return;const i=this._cloneGroups.get(t);i&&i.delete(e)}}function vt(e){return Array.from(e.getChildren()).some((e=>!e.is("uiElement")))}function _t(e){let t=e.parent;while(!Tt(t)){if(!t)return;t=t.parent}return t}function yt(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity()}function Ct(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new ze(t,t.data.length);const i=e.nodeAfter;return i&&i.is("$text")?new ze(i,0):e}function kt(e){if(e.offset==e.parent.data.length)return new ze(e.parent.parent,e.parent.index+1);if(0===e.offset)return new ze(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new G(e.root.document,t)),new ze(e.parent.parent,e.parent.index+1)}function xt(e,t){const i=e.data.length;return e._data+=t.data,t._remove(),new ze(e,i)}function At(e,t){for(const i of e){if(!Et.some((e=>i instanceof e)))throw new S.ZP("view-writer-insert-invalid-node-type",t);i.is("$text")||At(i.getChildren(),t)}}const Et=[G,st,De,at,gt,dt];function Tt(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function Pt(e,t){const i=_t(e.start),n=_t(e.end);if(!i||!n||i!==n)throw new S.ZP("view-writer-invalid-range-container",t)}function St(e,t){return null===e.id&&null===t.id}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Vt(e){return"[object Text]"==Object.prototype.toString.call(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const It=e=>e.createTextNode(" "),Nt=e=>{const t=e.createElement("span");return t.dataset.ckeFiller=!0,t.innerHTML=" ",t},Rt=e=>{const t=e.createElement("br");return t.dataset.ckeFiller=!0,t},Dt=7,Bt="⁠".repeat(Dt);function Mt(e){return Vt(e)&&e.data.substr(0,Dt)===Bt}function Ot(e){return e.data.length==Dt&&Mt(e)}function Lt(e){return Mt(e)?e.data.slice(Dt):e.data}function Ft(e){e.document.on("arrowKey",zt,{priority:"low"})}function zt(e,t){if(t.keyCode==ct.Do.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(1==e.rangeCount&&e.getRangeAt(0).collapsed){const t=e.getRangeAt(0).startContainer,i=e.getRangeAt(0).startOffset;Mt(t)&&i<=Dt&&e.collapse(t,0)}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $t(e,t,i,n=!1){i=i||function(e,t){return e===t},Array.isArray(e)||(e=Array.prototype.slice.call(e)),Array.isArray(t)||(t=Array.prototype.slice.call(t));const s=Zt(e,t,i);return n?qt(s,t.length):Wt(t,s)}function Zt(e,t,i){const n=Ht(e,t,i);if(-1===n)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=Ut(e,n),o=Ut(t,n),r=Ht(s,o,i),a=e.length-r,l=t.length-r;return{firstIndex:n,lastIndexOld:a,lastIndexNew:l}}function Ht(e,t,i){for(let n=0;n<Math.max(e.length,t.length);n++)if(void 0===e[n]||void 0===t[n]||!i(e[n],t[n]))return n;return-1}function Ut(e,t){return e.slice(t).reverse()}function Wt(e,t){const i=[],{firstIndex:n,lastIndexOld:s,lastIndexNew:o}=t;return o-n>0&&i.push({index:n,type:"insert",values:e.slice(n,o)}),s-n>0&&i.push({index:n+(o-n),type:"delete",howMany:s-n}),i}function qt(e,t){const{firstIndex:i,lastIndexOld:n,lastIndexNew:s}=e;if(-1===i)return Array(t).fill("equal");let o=[];return i>0&&(o=o.concat(Array(i).fill("equal"))),s-i>0&&(o=o.concat(Array(s-i).fill("insert"))),n-i>0&&(o=o.concat(Array(n-i).fill("delete"))),s<t&&(o=o.concat(Array(t-s).fill("equal"))),o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gt(e,t,i){i=i||function(e,t){return e===t};const n=e.length,s=t.length;if(n>200||s>200||n+s>300)return Gt.fastDiff(e,t,i,!0);let o,r;if(s<n){const i=e;e=t,t=i,o="delete",r="insert"}else o="insert",r="delete";const a=e.length,l=t.length,c=l-a,d={},h={};function u(n){const s=(void 0!==h[n-1]?h[n-1]:-1)+1,c=void 0!==h[n+1]?h[n+1]:-1,u=s>c?-1:1;d[n+u]&&(d[n]=d[n+u].slice(0)),d[n]||(d[n]=[]),d[n].push(s>c?o:r);let m=Math.max(s,c),g=m-n;while(g<a&&m<l&&i(e[g],t[m]))g++,m++,d[n].push("equal");return m}let m,g=0;do{for(m=-g;m<c;m++)h[m]=u(m);for(m=c+g;m>c;m--)h[m]=u(m);h[c]=u(c),g++}while(h[c]!==l);return d[c].slice(1)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jt(e,t,i){e.insertBefore(i,e.childNodes[t]||null)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Kt(e){const t=e.parentNode;t&&t.removeChild(e)}Gt.fastDiff=$t;var Jt=i(4817),Yt=i(91704);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qt{constructor(e,t){this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),Yt.ZP.isBlink&&!Yt.ZP.isAndroid&&this.on("change:isSelecting",(()=>{this.isSelecting||this.render()})),this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new S.ZP("view-renderer-unknown-type",this);this.markedChildren.add(t)}}}render(){let e;const t=!(Yt.ZP.isBlink&&!Yt.ZP.isAndroid)||!this.isSelecting;for(const i of this.markedChildren)this._updateChildrenMappings(i);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller));for(const i of this.markedAttributes)this._updateAttrs(i);for(const i of this.markedChildren)this._updateChildren(i,{inlineFillerPosition:e});for(const i of this.markedTexts)!this.markedChildren.has(i.parent)&&this.domConverter.mapViewToDom(i.parent)&&this._updateText(i,{inlineFillerPosition:e});if(t)if(e){const t=this.domConverter.viewPositionToDom(e),i=t.parent.ownerDocument;Mt(t.parent)?this._inlineFiller=t.parent:this._inlineFiller=ei(i,t.parent,t.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(this.domConverter.mapViewToDom(e).childNodes),n=Array.from(this.domConverter.viewChildrenToDom(e,t.ownerDocument,{withChildren:!1})),s=this._diffNodeLists(i,n),o=this._findReplaceActions(s,i,n);if(-1!==o.indexOf("replace")){const t={equal:0,insert:0,delete:0};for(const s of o)if("replace"===s){const s=t.equal+t.insert,o=t.equal+t.delete,r=e.getChild(s);!r||r.is("uiElement")||r.is("rawElement")||this._updateElementMappings(r,i[o]),Kt(n[s]),t.equal++}else t[s]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?ze._createBefore(this.selection.getFirstPosition().parent):e}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&Vt(t.parent)&&Mt(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Mt(e))throw new S.ZP("view-renderer-filler-was-lost",this);Ot(e)?e.remove():e.data=e.data.substr(Dt),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,i=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!Xt(t))return!1;if(i===t.getFillerOffset())return!1;const n=e.nodeBefore,s=e.nodeAfter;return!(n instanceof G||s instanceof G)}_updateText(e,t){const i=this.domConverter.findCorrespondingDomText(e),n=this.domConverter.viewToDom(e,i.ownerDocument),s=i.data;let o=n.data;const r=t.inlineFillerPosition;if(r&&r.parent==e.parent&&r.offset==e.index&&(o=Bt+o),s!=o){const e=$t(s,o);for(const t of e)"insert"===t.type?i.insertData(t.index,t.values.join("")):i.deleteData(t.index,t.howMany)}}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(t.attributes).map((e=>e.name)),n=e.getAttributeKeys();for(const s of n)this.domConverter.setDomElementAttribute(t,s,e.getAttribute(s),e);for(const s of i)e.hasAttribute(s)||this.domConverter.removeDomElementAttribute(t,s)}_updateChildren(e,t){const i=this.domConverter.mapViewToDom(e);if(!i)return;const n=t.inlineFillerPosition,s=this.domConverter.mapViewToDom(e).childNodes,o=Array.from(this.domConverter.viewChildrenToDom(e,i.ownerDocument,{bind:!0}));n&&n.parent===e&&ei(i.ownerDocument,o,n.offset);const r=this._diffNodeLists(s,o);let a=0;const l=new Set;for(const c of r)"delete"===c?(l.add(s[a]),Kt(s[a])):"equal"===c&&a++;a=0;for(const c of r)"insert"===c?(jt(i,a,o[a]),a++):"equal"===c&&(this._markDescendantTextToSync(this.domConverter.domToView(o[a])),a++);for(const c of l)c.parentNode||this.domConverter.unbindDomElement(c)}_diffNodeLists(e,t){return e=si(e,this._fakeSelectionContainer),Gt(e,t,ii.bind(null,this.domConverter))}_findReplaceActions(e,t,i){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;let n=[],s=[],o=[];const r={equal:0,insert:0,delete:0};for(const a of e)"insert"===a?o.push(i[r.equal+r.insert]):"delete"===a?s.push(t[r.equal+r.delete]):(n=n.concat(Gt(s,o,ti).map((e=>"equal"===e?"replace":e))),n.push("equal"),s=[],o=[]),r[a]++;return n.concat(Gt(s,o,ti).map((e=>"equal"===e?"replace":e)))}_markDescendantTextToSync(e){if(e)if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}_updateSelection(){if(Yt.ZP.isBlink&&!Yt.ZP.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e&&(this.selection.isFake?this._updateFakeSelection(e):(this._removeFakeSelection(),this._updateDomSelection(e)))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=oi(t));const i=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(i,this.selection),!this._fakeSelectionNeedsUpdate(e))return;i.parentElement&&i.parentElement==e||e.appendChild(i),i.textContent=this.selection.fakeSelectionLabel||" ";const n=t.getSelection(),s=t.createRange();n.removeAllRanges(),s.selectNodeContents(i),n.addRange(s)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const i=this.domConverter.viewPositionToDom(this.selection.anchor),n=this.domConverter.viewPositionToDom(this.selection.focus);t.collapse(i.parent,i.offset),t.extend(n.parent,n.offset),Yt.ZP.isGecko&&ni(n,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return(!t||!this.selection.isEqual(t))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,i=e.ownerDocument.getSelection();return!t||t.parentElement!==e||(i.anchorNode!==t&&!t.contains(i.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel)}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const t=e.activeElement,i=this.domConverter.mapDomToView(t);t&&i&&e.getSelection().removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function Xt(e){if("false"==e.getAttribute("contenteditable"))return!1;const t=e.findAncestor((e=>e.hasAttribute("contenteditable")));return!t||"true"==t.getAttribute("contenteditable")}function ei(e,t,i){const n=t instanceof Array?t:t.childNodes,s=n[i];if(Vt(s))return s.data=Bt+s.data,s;{const s=e.createTextNode(Bt);return Array.isArray(t)?n.splice(i,0,s):jt(t,i,s),s}}function ti(e,t){return(0,Jt.Z)(e)&&(0,Jt.Z)(t)&&!Vt(e)&&!Vt(t)&&e.nodeType!==Node.COMMENT_NODE&&t.nodeType!==Node.COMMENT_NODE&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function ii(e,t,i){return t===i||(Vt(t)&&Vt(i)?t.data===i.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(i)))}function ni(e,t){const i=e.parent;if(i.nodeType!=Node.ELEMENT_NODE||e.offset!=i.childNodes.length-1)return;const n=i.childNodes[e.offset];n&&"BR"==n.tagName&&t.addRange(t.getRangeAt(0))}function si(e,t){const i=Array.from(e);if(0==i.length||!t)return i;const n=i[i.length-1];return n==t&&i.pop(),i}function oi(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}(0,I.Z)(Qt,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */var ri={window:window,document:document};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ai(e){let t=0;while(e.previousSibling)e=e.previousSibling,t++;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function li(e){const t=[];while(e&&e.nodeType!=Node.DOCUMENT_NODE)t.unshift(e),e=e.parentNode;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ci=Rt(document),di=It(document),hi=Nt(document),ui="data-ck-unsafe-attribute-",mi="data-ck-unsafe-element";class gi{constructor(e,t={}){this.document=e,this.renderingMode=t.renderingMode||"editing",this.blockFillerMode=t.blockFillerMode||("editing"===this.renderingMode?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new Q,this._encounteredRawContentDomNodes=new WeakSet}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Ue(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const t of e.childNodes)this.unbindDomElement(t)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,i){return"data"===this.renderingMode||(e=e.toLowerCase(),!e.startsWith("on")&&(("srcdoc"!==e||!t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i))&&("img"===i&&("src"===e||"srcset"===e)||("source"===i&&"srcset"===e||!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i)))))}setContentOf(e,t){if("data"===this.renderingMode)return void(e.innerHTML=t);const i=(new DOMParser).parseFromString(t,"text/html"),n=i.createDocumentFragment(),s=i.body.childNodes;while(s.length>0)n.appendChild(s[0]);const o=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT),r=[];let a;while(a=o.nextNode())r.push(a);for(const l of r){for(const t of l.getAttributeNames())this.setDomElementAttribute(l,t,l.getAttribute(t));const e=l.tagName.toLowerCase();this._shouldRenameElement(e)&&((0,S.KE)("domconverter-unsafe-element-detected",{unsafeElement:l}),l.replaceWith(this._createReplacementDomElement(e,l)))}while(e.firstChild)e.firstChild.remove();e.append(n)}viewToDom(e,t,i={}){if(e.is("$text")){const i=this._processDataFromViewText(e);return t.createTextNode(i)}{if(this.mapViewToDom(e))return this.mapViewToDom(e);let n;if(e.is("documentFragment"))n=t.createDocumentFragment(),i.bind&&this.bindDocumentFragments(n,e);else{if(e.is("uiElement"))return n="$comment"===e.name?t.createComment(e.getCustomProperty("$rawContent")):e.render(t,this),i.bind&&this.bindElements(n,e),n;this._shouldRenameElement(e.name)?((0,S.KE)("domconverter-unsafe-element-detected",{unsafeElement:e}),n=this._createReplacementDomElement(e.name)):n=e.hasAttribute("xmlns")?t.createElementNS(e.getAttribute("xmlns"),e.name):t.createElement(e.name),e.is("rawElement")&&e.render(n,this),i.bind&&this.bindElements(n,e);for(const t of e.getAttributeKeys())this.setDomElementAttribute(n,t,e.getAttribute(t),e)}if(!1!==i.withChildren)for(const s of this.viewChildrenToDom(e,t,i))n.appendChild(s);return n}}setDomElementAttribute(e,t,i,n=null){const s=this.shouldRenderAttribute(t,i,e.tagName.toLowerCase())||n&&n.shouldRenderUnsafeAttribute(t);s||(0,S.KE)("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:i}),e.hasAttribute(t)&&!s?e.removeAttribute(t):e.hasAttribute(ui+t)&&s&&e.removeAttribute(ui+t),e.setAttribute(s?t:ui+t,i)}removeDomElementAttribute(e,t){t!=mi&&(e.removeAttribute(t),e.removeAttribute(ui+t))}*viewChildrenToDom(e,t,i={}){const n=e.getFillerOffset&&e.getFillerOffset();let s=0;for(const o of e.getChildren())n===s&&(yield this._getBlockFiller(t)),yield this.viewToDom(o,t,i),s++;n===s&&(yield this._getBlockFiller(t))}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),i=this.viewPositionToDom(e.end),n=document.createRange();return n.setStart(t.parent,t.offset),n.setEnd(i.parent,i.offset),n}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const i=this.findCorrespondingDomText(t);if(!i)return null;let n=e.offset;return Mt(i)&&(n+=Dt),{parent:i,offset:n}}{let i,n,s;if(0===e.offset){if(i=this.mapViewToDom(t),!i)return null;s=i.childNodes[0]}else{const t=e.nodeBefore;if(n=t.is("$text")?this.findCorrespondingDomText(t):this.mapViewToDom(e.nodeBefore),!n)return null;i=n.parentNode,s=n.nextSibling}if(Vt(s)&&Mt(s))return{parent:s,offset:Dt};const o=n?ai(n)+1:0;return{parent:i,offset:o}}}domToView(e,t={}){if(this.isBlockFiller(e))return null;const i=this.getHostViewElement(e);if(i)return i;if(this.isComment(e)&&t.skipComments)return null;if(Vt(e)){if(Ot(e))return null;{const t=this._processDataFromDomText(e);return""===t?null:new G(this.document,t)}}{if(this.mapDomToView(e))return this.mapDomToView(e);let i;if(this.isDocumentFragment(e))i=new ft(this.document),t.bind&&this.bindDocumentFragments(e,i);else{i=this._createViewElement(e,t),t.bind&&this.bindElements(e,i);const n=e.attributes;if(n)for(let e=n.length-1;e>=0;e--)i._setAttribute(n[e].name,n[e].value);if(this._isViewElementWithRawContent(i,t)||this.isComment(e)){const t=this.isComment(e)?e.data:e.innerHTML;return i._setCustomProperty("$rawContent",t),this._encounteredRawContentDomNodes.add(e),i}}if(!1!==t.withChildren)for(const n of this.domChildrenToView(e,t))i._appendChild(n);return i}}*domChildrenToView(e,t={}){for(let i=0;i<e.childNodes.length;i++){const n=e.childNodes[i],s=this.domToView(n,t);null!==s&&(yield s)}}domSelectionToView(e){if(1===e.rangeCount){let t=e.getRangeAt(0).startContainer;Vt(t)&&(t=t.parentNode);const i=this.fakeSelectionToView(t);if(i)return i}const t=this.isDomSelectionBackward(e),i=[];for(let n=0;n<e.rangeCount;n++){const t=e.getRangeAt(n),s=this.domRangeToView(t);s&&i.push(s)}return new Ue(i,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),i=this.domPositionToView(e.endContainer,e.endOffset);return t&&i?new $e(t,i):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,ai(e));const i=this.mapDomToView(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return ze._createBefore(i);if(Vt(e)){if(Ot(e))return this.domPositionToView(e.parentNode,ai(e));const i=this.findCorrespondingViewText(e);let n=t;return i?(Mt(e)&&(n-=Dt,n=n<0?0:n),new ze(i,n)):null}if(0===t){const t=this.mapDomToView(e);if(t)return new ze(t,0)}else{const i=e.childNodes[t-1],n=Vt(i)?this.findCorrespondingViewText(i):this.mapDomToView(i);if(n&&n.parent)return new ze(n.parent,n.index+1)}return null}mapDomToView(e){const t=this.getHostViewElement(e);return t||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(Ot(e))return null;const t=this.getHostViewElement(e);if(t)return t;const i=e.previousSibling;if(i){if(!this.isElement(i))return null;const e=this.mapDomToView(i);if(e){const t=e.nextSibling;return t instanceof G?e.nextSibling:null}}else{const t=this.mapDomToView(e.parentNode);if(t){const e=t.getChild(0);return e instanceof G?e:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:e,scrollY:i}=ri.window,n=[];fi(t,(e=>{const{scrollLeft:t,scrollTop:i}=e;n.push([t,i])})),t.focus(),fi(t,(e=>{const[t,i]=n.shift();e.scrollLeft=t,e.scrollTop=i})),ri.window.scrollTo(e,i)}}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(e){return e&&e.nodeType==Node.COMMENT_NODE}isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(ci):!("BR"!==e.tagName||!bi(e,this.blockElements)||1!==e.parentNode.childNodes.length)||(e.isEqualNode(hi)||wi(e,this.blockElements))}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=document.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);const i=t.collapsed;return t.detach(),i}getHostViewElement(e){const t=li(e);t.pop();while(t.length){const e=t.pop(),i=this._domToViewMapping.get(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return i}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}_getBlockFiller(e){switch(this.blockFillerMode){case"nbsp":return It(e);case"markedNbsp":return Nt(e);case"br":return Rt(e)}}_isDomSelectionPositionCorrect(e,t){if(Vt(e)&&Mt(e)&&t<Dt)return!1;if(this.isElement(e)&&Mt(e.childNodes[t]))return!1;const i=this.mapDomToView(e);return!i||!i.is("uiElement")&&!i.is("rawElement")}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return t;if(" "==t.charAt(0)){const i=this._getTouchingInlineViewNode(e,!1),n=i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i);!n&&i||(t=" "+t.substr(1))}if(" "==t.charAt(t.length-1)){const i=this._getTouchingInlineViewNode(e,!0),n=i&&i.is("$textProxy")&&" "==i.data.charAt(0);" "!=t.charAt(t.length-2)&&i&&!n||(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return!1;const t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1)}_processDataFromDomText(e){let t=e.data;if(pi(e,this.preElements))return Lt(e);t=t.replace(/[ \n\t\r]{1,}/g," ");const i=this._getTouchingInlineDomNode(e,!1),n=this._getTouchingInlineDomNode(e,!0),s=this._checkShouldLeftTrimDomText(e,i),o=this._checkShouldRightTrimDomText(e,n);s&&(t=t.replace(/^ /,"")),o&&(t=t.replace(/ $/,"")),t=Lt(new Text(t)),t=t.replace(/ \u00A0/g,"  ");const r=n&&this.isElement(n)&&"BR"!=n.tagName,a=n&&Vt(n)&&" "==n.data.charAt(0);return(/( |\u00A0)\u00A0$/.test(t)||!n||r||a)&&(t=t.replace(/\u00A0$/," ")),(s||i&&this.isElement(i)&&"BR"!=i.tagName)&&(t=t.replace(/^\u00A0/," ")),t}_checkShouldLeftTrimDomText(e,t){return!t||(this.isElement(t)?"BR"===t.tagName:!this._encounteredRawContentDomNodes.has(e.previousSibling)&&/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(e,t){return!t&&!Mt(e)}_getTouchingInlineViewNode(e,t){const i=new Fe({startPosition:t?ze._createAfter(e):ze._createBefore(e),direction:t?"forward":"backward"});for(const n of i){if(n.item.is("element")&&this.inlineObjectElements.includes(n.item.name))return n.item;if(n.item.is("containerElement"))return null;if(n.item.is("element","br"))return null;if(n.item.is("$textProxy"))return n.item}return null}_getTouchingInlineDomNode(e,t){if(!e.parentNode)return null;const i=t?"firstChild":"lastChild",n=t?"nextSibling":"previousSibling";let s=!0;do{if(!s&&e[i]?e=e[i]:e[n]?(e=e[n],s=!1):(e=e.parentNode,s=!0),!e||this._isBlockElement(e))return null}while(!Vt(e)&&"BR"!=e.tagName&&!this._isInlineObjectElement(e));return e}_isBlockElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isInlineObjectElement(e){return this.isElement(e)&&this.inlineObjectElements.includes(e.tagName.toLowerCase())}_createViewElement(e,t){if(this.isComment(e))return new dt(this.document,"$comment");const i=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Ve(this.document,i)}_isViewElementWithRawContent(e,t){return!1!==t.withChildren&&this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){return"editing"==this.renderingMode&&"script"==e.toLowerCase()}_createReplacementDomElement(e,t=null){const i=document.createElement("span");if(i.setAttribute(mi,e),t){while(t.firstChild)i.appendChild(t.firstChild);for(const e of t.getAttributeNames())i.setAttribute(e,t.getAttribute(e))}return i}}function pi(e,t){const i=li(e);return i.some((e=>e.tagName&&t.includes(e.tagName.toLowerCase())))}function fi(e,t){while(e&&e!=ri.document)t(e),e=e.parentNode}function wi(e,t){const i=e.isEqualNode(di);return i&&bi(e,t)&&1===e.parentNode.childNodes.length}function bi(e,t){const i=e.parentNode;return i&&i.tagName&&t.includes(i.tagName.toLowerCase())}var vi=i(49981);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _i{constructor(e){this.view=e,this.document=e.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&3===e.nodeType&&(e=e.parentNode),!(!e||1!==e.nodeType)&&e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}(0,I.Z)(_i,vi.Z);var yi=i(2674);function Ci(e,t,i){i="function"==typeof i?i:void 0;var n=i?i(e,t):void 0;return void 0===n?(0,yi.Z)(e,t,void 0,i):!!n}var ki=Ci;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xi extends _i{constructor(e){super(e),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.push(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(0===e.length)return;const t=this.domConverter,i=new Map,n=new Set;for(const l of e)if("childList"===l.type){const e=t.mapDomToView(l.target);if(e&&(e.is("uiElement")||e.is("rawElement")))continue;e&&!this._isBogusBrMutation(l)&&n.add(e)}for(const l of e){const e=t.mapDomToView(l.target);if((!e||!e.is("uiElement")&&!e.is("rawElement"))&&"characterData"===l.type){const e=t.findCorrespondingViewText(l.target);e&&!n.has(e.parent)?i.set(e,{type:"text",oldText:e.data,newText:Lt(l.target),node:e}):!e&&Mt(l.target)&&n.add(t.mapDomToView(l.target.parentNode))}}const s=[];for(const l of i.values())this.renderer.markToSync("text",l.node),s.push(l);for(const l of n){const e=t.mapViewToDom(l),i=Array.from(l.getChildren()),n=Array.from(t.domChildrenToView(e,{withChildren:!1}));ki(i,n,a)||(this.renderer.markToSync("children",l),s.push({type:"children",oldChildren:i,newChildren:n,node:l}))}const o=e[0].target.ownerDocument.getSelection();let r=null;if(o&&o.anchorNode){const e=t.domPositionToView(o.anchorNode,o.anchorOffset),i=t.domPositionToView(o.focusNode,o.focusOffset);e&&i&&(r=new Ue(e),r.setFocus(i))}function a(e,t){if(!Array.isArray(e))return e===t||!(!e.is("$text")||!t.is("$text"))&&e.data===t.data}s.length&&(this.document.fire("mutations",s,r),this.view.forceRender())}_isBogusBrMutation(e){let t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}var Ai=i(80207);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ei{constructor(e,t,i){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,(0,Ai.Z)(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ti extends _i{constructor(e){super(e),this.useCapture=!1}observe(e){const t="string"==typeof this.domEventType?[this.domEventType]:this.domEventType;t.forEach((t=>{this.listenTo(e,t,((e,t)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(t.target)&&this.onDomEvent(t)}),{useCapture:this.useCapture})}))}fire(e,t,i){this.isEnabled&&this.document.fire(e,new Ei(this.view,t,i))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pi extends Ti{constructor(e){super(e),this.domEventType=["keydown","keyup"]}onDomEvent(e){this.fire(e.type,e,{keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return(0,ct.Cq)(this)}})}}var Si=i(8891);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vi extends _i{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=(0,Si.Z)((e=>this.document.fire("selectionChangeDone",e)),200)}observe(){const e=this.document;e.on("arrowKey",((t,i)=>{const n=e.selection;n.isFake&&this.isEnabled&&i.preventDefault()}),{context:"$capture"}),e.on("arrowKey",((t,i)=>{const n=e.selection;n.isFake&&this.isEnabled&&this._handleSelectionMove(i.keyCode)}),{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,i=new Ue(t.getRanges(),{backward:t.isBackward,fake:!1});e!=ct.Do.arrowleft&&e!=ct.Do.arrowup||i.setTo(i.getFirstPosition()),e!=ct.Do.arrowright&&e!=ct.Do.arrowdown||i.setTo(i.getLastPosition());const n={oldSelection:t,newSelection:i,domSelection:null};this.document.fire("selectionChange",n),this._fireSelectionChangeDoneDebounced(n)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ii extends _i{constructor(e){super(e),this.mutationObserver=e.getObserver(xi),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=(0,Si.Z)((e=>this.document.fire("selectionChangeDone",e)),200),this._clearInfiniteLoopInterval=setInterval((()=>this._clearInfiniteLoop()),1e3),this._documentIsSelectingInactivityTimeoutDebounced=(0,Si.Z)((()=>this.document.isSelecting=!1),5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,i=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},n=()=>{this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel()};this.listenTo(e,"selectstart",i,{priority:"highest"}),this.listenTo(e,"keydown",n,{priority:"highest"}),this.listenTo(e,"keyup",n,{priority:"highest"}),this._documents.has(t)||(this.listenTo(t,"mouseup",n,{priority:"highest"}),this.listenTo(t,"selectionchange",((e,i)=>{this._handleSelectionChange(i,t),this._documentIsSelectingInactivityTimeoutDebounced()})),this._documents.add(t))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_handleSelectionChange(e,t){if(!this.isEnabled)return;const i=t.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(i.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(i);if(0!=n.rangeCount){if(this.view.hasDomSelection=!0,(!this.selection.isEqual(n)||!this.domConverter.isDomSelectionCorrect(i))&&!(++this._loopbackCounter>60))if(this.selection.isSimilar(n))this.view.forceRender();else{const e={oldSelection:this.selection,newSelection:n,domSelection:i};this.document.fire("selectionChange",e),this._fireSelectionChangeDoneDebounced(e)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ni extends Ti{constructor(e){super(e),this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",(()=>{t.isFocused=!0,this._renderTimeoutId=setTimeout((()=>e.change((()=>{}))),50)})),t.on("blur",((i,n)=>{const s=t.selection.editableElement;null!==s&&s!==n.target||(t.isFocused=!1,e.change((()=>{})))}))}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ri extends Ti{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",(()=>{t.isComposing=!0})),t.on("compositionend",(()=>{t.isComposing=!1}))}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
class Di extends Ti{constructor(e){super(e),this.domEventType=["beforeinput"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bi{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach((({element:e,newElement:t})=>{e.style.display="",t&&t.remove()})),this._replacedElements=[]}}var Mi=i(93589),Oi=i(27771),Li="[object String]";function Fi(e){return"string"==typeof e||!(0,Oi.Z)(e)&&(0,C.Z)(e)&&(0,Mi.Z)(e)==Li}var zi=Fi;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $i(e,t,i={},n=[]){const s=i&&i.xmlns,o=s?e.createElementNS(s,t):e.createElement(t);for(const r in i)o.setAttribute(r,i[r]);!zi(n)&&(0,J.Z)(n)||(n=[n]);for(let r of n)zi(r)&&(r=e.createTextNode(r)),o.appendChild(r);return o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zi(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Hi(e){return"[object Range]"==Object.prototype.toString.apply(e)}var Ui=i(56272);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Wi(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const qi=["top","right","bottom","left","width","height"];class Gi{constructor(e){const t=Hi(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),x(e)||t)if(t){const t=Gi.getDomRangeRects(e);ji(this,Gi.getBoundingRect(t))}else ji(this,e.getBoundingClientRect());else if((0,Ui.Z)(e)){const{innerWidth:t,innerHeight:i}=e;ji(this,{top:0,right:t,bottom:i,left:0,width:t,height:i})}else ji(this,e)}clone(){return new Gi(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0?null:new Gi(t)}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(!Ki(e)){let i=e.parentNode||e.commonAncestorContainer;while(i&&!Ki(i)){const e=new Gi(i),n=t.getIntersection(e);if(!n)return null;n.getArea()<t.getArea()&&(t=n),i=i.parentNode}}return t}isEqual(e){for(const t of qi)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!(!t||!t.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let t,i,n;if((0,Ui.Z)(e))t=e.innerWidth-e.document.documentElement.clientWidth,i=e.innerHeight-e.document.documentElement.clientHeight,n=e.getComputedStyle(e.document.documentElement).direction;else{const s=Wi(this._source);t=e.offsetWidth-e.clientWidth-s.left-s.right,i=e.offsetHeight-e.clientHeight-s.top-s.bottom,n=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=s.left,this.top+=s.top,this.right-=s.right,this.bottom-=s.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,"ltr"===n?this.right-=t:this.left+=t,this.height-=i,this.bottom-=i,this}static getDomRangeRects(e){const t=[],i=Array.from(e.getClientRects());if(i.length)for(const n of i)t.push(new Gi(n));else{let i=e.startContainer;Vt(i)&&(i=i.parentNode);const n=new Gi(i.getBoundingClientRect());n.right=n.left,n.width=0,t.push(n)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY};let i=0;for(const n of e)i++,t.left=Math.min(t.left,n.left),t.top=Math.min(t.top,n.top),t.right=Math.max(t.right,n.right),t.bottom=Math.max(t.bottom,n.bottom);return 0==i?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new Gi(t))}}function ji(e,t){for(const i of qi)e[i]=t[i]}function Ki(e){return!!x(e)&&e===e.ownerDocument.body}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ji=100;class Yi{constructor(e,t){Yi._observerInstance||Yi._createObserver(),this._element=e,this._callback=t,Yi._addElementCallback(e,t),Yi._observerInstance.observe(e)}destroy(){Yi._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){Yi._elementCallbacks||(Yi._elementCallbacks=new Map);let i=Yi._elementCallbacks.get(e);i||(i=new Set,Yi._elementCallbacks.set(e,i)),i.add(t)}static _deleteElementCallback(e,t){const i=Yi._getElementCallbacks(e);i&&(i.delete(t),i.size||(Yi._elementCallbacks.delete(e),Yi._observerInstance.unobserve(e))),Yi._elementCallbacks&&!Yi._elementCallbacks.size&&(Yi._observerInstance=null,Yi._elementCallbacks=null)}static _getElementCallbacks(e){return Yi._elementCallbacks?Yi._elementCallbacks.get(e):null}static _createObserver(){let e;e="function"===typeof ri.window.ResizeObserver?ri.window.ResizeObserver:Qi,Yi._observerInstance=new e((e=>{for(const t of e){const e=Yi._getElementCallbacks(t.target);if(e)for(const i of e)i(t)}}))}}Yi._observerInstance=null,Yi._elementCallbacks=null;class Qi{constructor(e){this._callback=e,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(e){this._elements.add(e),this._checkElementRectsAndExecuteCallback(),1===this._elements.size&&this._startPeriodicCheck()}unobserve(e){this._elements.delete(e),this._previousRects.delete(e),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const e=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(e,Ji)};this.listenTo(ri.window,"resize",(()=>{this._checkElementRectsAndExecuteCallback()})),this._periodicCheckTimeout=setTimeout(e,Ji)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const e=[];for(const t of this._elements)this._hasRectChanged(t)&&e.push({target:t,contentRect:this._previousRects.get(t)});e.length&&this._callback(e)}_hasRectChanged(e){if(!e.ownerDocument.body.contains(e))return!1;const t=new Gi(e),i=this._previousRects.get(e),n=!i||!i.isEqual(t);return this._previousRects.set(e,t),n}}(0,I.Z)(Qi,vi.Z);var Xi=i(81759);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class en{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(e){if(this._elements.has(e))throw new S.ZP("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",(()=>this._focus(e)),{useCapture:!0}),this.listenTo(e,"blur",(()=>this._blur()),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(e),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout((()=>{this.focusedElement=null,this.isFocused=!1}),0)}}(0,I.Z)(en,vi.Z),(0,I.Z)(en,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tn{constructor(){this._listener=Object.create(vi.Z)}listenTo(e){this._listener.listenTo(e,"keydown",((e,t)=>{this._listener.fire("_keydown:"+(0,ct.Cq)(t),t)}))}set(e,t,i={}){const n=(0,ct.Zz)(e),s=i.priority;this._listener.listenTo(this._listener,"_keydown:"+n,((e,i)=>{t(i,(()=>{i.preventDefault(),i.stopPropagation(),e.stop()})),e.return=!0}),{priority:s})}press(e){return!!this._listener.fire("_keydown:"+(0,ct.Cq)(e),e)}destroy(){this._listener.stopListening()}}var nn=i(13719),sn=i(18481);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class on extends _i{constructor(e){super(e),this.document.on("keydown",((e,t)=>{if(this.isEnabled&&(0,ct.dj)(t.keyCode)){const i=new Ge(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(i,t),i.stop.called&&e.stop()}}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const rn={};function an({target:e,viewportOffset:t=0}){const i=pn(e);let n=i,s=null;while(n){let o;o=fn(n==i?e:s),dn(o,(()=>wn(e,n)));const r=wn(e,n);if(cn(n,r,t),n.parent!=n){if(s=n.frameElement,n=n.parent,!s)return}else n=null}}function ln(e){const t=fn(e);dn(t,(()=>new Gi(e)))}function cn(e,t,i){const n=t.clone().moveBy(0,i),s=t.clone().moveBy(0,-i),o=new Gi(e).excludeScrollbarsAndBorders(),r=[s,n];if(!r.every((e=>o.contains(e)))){let{scrollX:r,scrollY:a}=e;un(s,o)?a-=o.top-t.top+i:hn(n,o)&&(a+=t.bottom-o.bottom+i),mn(t,o)?r-=o.left-t.left+i:gn(t,o)&&(r+=t.right-o.right+i),e.scrollTo(r,a)}}function dn(e,t){const i=pn(e);let n,s;while(e!=i.document.body)s=t(),n=new Gi(e).excludeScrollbarsAndBorders(),n.contains(s)||(un(s,n)?e.scrollTop-=n.top-s.top:hn(s,n)&&(e.scrollTop+=s.bottom-n.bottom),mn(s,n)?e.scrollLeft-=n.left-s.left:gn(s,n)&&(e.scrollLeft+=s.right-n.right)),e=e.parentNode}function hn(e,t){return e.bottom>t.bottom}function un(e,t){return e.top<t.top}function mn(e,t){return e.left<t.left}function gn(e,t){return e.right>t.right}function pn(e){return Hi(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function fn(e){if(Hi(e)){let t=e.commonAncestorContainer;return Vt(t)&&(t=t.parentNode),t}return e.parentNode}function wn(e,t){const i=pn(e),n=new Gi(e);if(i===t)return n;{let e=i;while(e!=t){const t=e.frameElement,i=new Gi(t).excludeScrollbarsAndBorders();n.moveBy(i.left,i.top),e=e.parent}}return n}Object.assign(rn,{scrollViewportToShowTarget:an,scrollAncestorsToShowTarget:ln});
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bn{constructor(e){this.document=new it(e),this.domConverter=new gi(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Qt(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new bt(this.document),this.addObserver(xi),this.addObserver(Ii),this.addObserver(Ni),this.addObserver(Pi),this.addObserver(Vi),this.addObserver(Ri),this.addObserver(on),Yt.ZP.isAndroid&&this.addObserver(Di),Ft(this),ht(this),this.on("render",(()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1})),this.listenTo(this.document.selection,"change",(()=>{this._hasChangedSinceTheLastRendering=!0})),this.listenTo(this.document,"change:isFocused",(()=>{this._hasChangedSinceTheLastRendering=!0}))}attachDomRoot(e,t="main"){const i=this.document.getRoot(t);i._name=e.tagName.toLowerCase();const n={};for(const{name:o,value:r}of Array.from(e.attributes))n[o]=r,"class"===o?this._writer.addClass(r.split(" "),i):this._writer.setAttribute(o,r,i);this._initialDomRootAttributes.set(e,n);const s=()=>{this._writer.setAttribute("contenteditable",!i.isReadOnly,i),i.isReadOnly?this._writer.addClass("ck-read-only",i):this._writer.removeClass("ck-read-only",i)};s(),this.domRoots.set(t,e),this.domConverter.bindElements(e,i),this._renderer.markToSync("children",i),this._renderer.markToSync("attributes",i),this._renderer.domDocuments.add(e.ownerDocument),i.on("change:children",((e,t)=>this._renderer.markToSync("children",t))),i.on("change:attributes",((e,t)=>this._renderer.markToSync("attributes",t))),i.on("change:text",((e,t)=>this._renderer.markToSync("text",t))),i.on("change:isReadOnly",(()=>this.change(s))),i.on("change",(()=>{this._hasChangedSinceTheLastRendering=!0}));for(const o of this._observers.values())o.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach((({name:e})=>t.removeAttribute(e)));const i=this._initialDomRootAttributes.get(t);for(const n in i)t.setAttribute(n,i[n]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[i,n]of this.domRoots)t.observe(n,i);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection(){const e=this.document.selection.getFirstRange();e&&an({target:this.domConverter.viewRangeToDom(e),viewportOffset:20})}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new S.ZP("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){S.ZP.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change((()=>{}))}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return ze._createAt(e,t)}createPositionAfter(e){return ze._createAfter(e)}createPositionBefore(e){return ze._createBefore(e)}createRange(e,t){return new $e(e,t)}createRangeOn(e){return $e._createOn(e)}createRangeIn(e){return $e._createIn(e)}createSelection(e,t,i){return new Ue(e,t,i)}_disableRendering(e){this._renderingDisabled=e,0==e&&this.change((()=>{}))}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}(0,I.Z)(bn,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vn{constructor(e){this.parent=null,this._attrs=Y(e)}get index(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildIndex(this)))throw new S.ZP("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildStartOffset(this)))throw new S.ZP("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;while(e.parent)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;while(t.parent)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}getCommonAncestor(e,t={}){const i=this.getAncestors(t),n=e.getAncestors(t);let s=0;while(i[s]==n[s]&&i[s])s++;return 0===s?null:i[s-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),i=e.getPath(),n=U(t,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<i[n]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce(((e,t)=>(e[t[0]]=t[1],e)),{})),e}is(e){return"node"===e||"model:node"===e}_clone(){return new vn(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=Y(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _n extends vn{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}is(e){return"$text"===e||"model:$text"===e||"text"===e||"model:text"===e||"node"===e||"model:node"===e}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new _n(this.data,this.getAttributes())}static fromJSON(e){return new _n(e.data,e.attributes)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yn{constructor(e,t,i){if(this.textNode=e,t<0||t>e.offsetSize)throw new S.ZP("model-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.offsetSize)throw new S.ZP("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(e){return"$textProxy"===e||"model:$textProxy"===e||"textProxy"===e||"model:textProxy"===e}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cn{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce(((e,t)=>e+t.offsetSize),0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return-1==t?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return null===t?null:this._nodes.slice(0,t).reduce(((e,t)=>e+t.offsetSize),0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new S.ZP("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const i of this._nodes){if(e>=t&&e<t+i.offsetSize)return this.getNodeIndex(i);t+=i.offsetSize}if(t!=e)throw new S.ZP("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const i of t)if(!(i instanceof vn))throw new S.ZP("model-nodelist-insertnodes-not-node",this);this._nodes.splice(e,0,...t)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map((e=>e.toJSON()))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kn extends vn{constructor(e,t,i){super(t),this.name=e,this._children=new Cn,i&&this._insertChild(0,i)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(e,t=null){return t?t===this.name&&("element"===e||"model:element"===e):"element"===e||"model:element"===e||"node"===e||"model:node"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const i of e)t=t.getChild(t.offsetToIndex(i));return t}findAncestor(e,t={includeSelf:!1}){let i=t.includeSelf?this:this.parent;while(i){if(i.name===e)return i;i=i.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map((e=>e._clone(!0))):null;return new kn(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const i=xn(t);for(const n of i)null!==n.parent&&n._remove(),n.parent=this;this._children._insertNodes(e,i)}_removeChildren(e,t=1){const i=this._children._removeNodes(e,t);for(const n of i)n.parent=null;return i}static fromJSON(e){let t=null;if(e.children){t=[];for(const i of e.children)i.name?t.push(kn.fromJSON(i)):t.push(_n.fromJSON(i))}return new kn(e.name,e.attributes,t)}}function xn(e){return"string"==typeof e?[new _n(e)]:((0,J.Z)(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new _n(e):e instanceof yn?new _n(e.data,e.getAttributes()):e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class An{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new S.ZP("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new S.ZP("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=Tn._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(e){let t,i,n,s;do{n=this.position,s=this._visitedParent,({done:t,value:i}=this.next())}while(!t&&e(i));t||(this.position=n,this._visitedParent=s)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&t.offset===i.maxOffset)return{done:!0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};const n=t.parent,s=Pn(t,n),o=s||Sn(t,n,s);if(o instanceof kn)return this.shallow?t.offset++:(t.path.push(0),this._visitedParent=o),this.position=t,En("elementStart",o,e,t,1);if(o instanceof _n){let n;if(this.singleCharacters)n=1;else{let e=o.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<e&&(e=this.boundaries.end.offset),n=e-t.offset}const s=t.offset-o.startOffset,r=new yn(o,s,n);return t.offset+=n,this.position=t,En("text",r,e,t,n)}return t.path.pop(),t.offset++,this.position=t,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():En("elementEnd",i,e,t)}_previous(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&0===t.offset)return{done:!0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};const n=t.parent,s=Pn(t,n),o=s||Vn(t,n,s);if(o instanceof kn)return t.offset--,this.shallow?(this.position=t,En("elementStart",o,e,t,1)):(t.path.push(o.maxOffset),this.position=t,this._visitedParent=o,this.ignoreElementEnd?this._previous():En("elementEnd",o,e,t));if(o instanceof _n){let n;if(this.singleCharacters)n=1;else{let e=o.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>e&&(e=this.boundaries.start.offset),n=t.offset-e}const s=t.offset-o.startOffset,r=new yn(o,s-n,n);return t.offset-=n,this.position=t,En("text",r,e,t,n)}return t.path.pop(),this.position=t,this._visitedParent=i.parent,En("elementStart",i,e,t,1)}}function En(e,t,i,n,s){return{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:n,length:s}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tn{constructor(e,t,i="toNone"){if(!e.is("element")&&!e.is("documentFragment"))throw new S.ZP("model-position-root-invalid",e);if(!(t instanceof Array)||0===t.length)throw new S.ZP("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=i}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new S.ZP("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new S.ZP("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Pn(this,this.parent)}get nodeAfter(){const e=this.parent;return Sn(this,e,Pn(this,e))}get nodeBefore(){const e=this.parent;return Vn(this,e,Pn(this,e))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=U(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const i=new An(t);return i.skip(e),i.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=U(this.path,e.path),i="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,i)}getCommonAncestor(e){const t=this.getAncestors(),i=e.getAncestors();let n=0;while(t[n]==i[n]&&t[n])n++;return 0===n?null:t[n-1]}getShiftedBy(e){const t=this.clone(),i=t.offset+e;return t.offset=i<0?0:i,t}isAfter(e){return"after"==this.compareWith(e)}isBefore(e){return"before"==this.compareWith(e)}isEqual(e){return"same"==this.compareWith(e)}isTouching(e){let t=null,i=null;const n=this.compareWith(e);switch(n){case"same":return!0;case"before":t=Tn._createAt(this),i=Tn._createAt(e);break;case"after":t=Tn._createAt(e),i=Tn._createAt(this);break;default:return!1}let s=t.parent;while(t.path.length+i.path.length){if(t.isEqual(i))return!0;if(t.path.length>i.path.length){if(t.offset!==s.maxOffset)return!1;t.path=t.path.slice(0,-1),s=s.parent,t.offset++}else{if(0!==i.offset)return!1;i.path=i.path.slice(0,-1)}}}is(e){return"position"===e||"model:position"===e}hasSameParentAs(e){if(this.root!==e.root)return!1;const t=this.getParentPath(),i=e.getParentPath();return"same"==U(t,i)}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=Tn._createAt(this);break}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange,i=t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness;return i?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange,i=t.containsPosition(this)||t.start.isEqual(this);let n;return i?(n=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(n=n._getTransformedByDeletion(e.deletionPosition,1))):n=this.isEqual(e.deletionPosition)?Tn._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),n}_getTransformedByDeletion(e,t){const i=Tn._createAt(this);if(this.root!=e.root)return i;if("same"==U(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;i.offset-=t}}else if("prefix"==U(e.getParentPath(),this.getParentPath())){const n=e.path.length-1;if(e.offset<=this.path[n]){if(e.offset+t>this.path[n])return null;i.path[n]-=t}}return i}_getTransformedByInsertion(e,t){const i=Tn._createAt(this);if(this.root!=e.root)return i;if("same"==U(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(i.offset+=t);else if("prefix"==U(e.getParentPath(),this.getParentPath())){const n=e.path.length-1;e.offset<=this.path[n]&&(i.path[n]+=t)}return i}_getTransformedByMove(e,t,i){if(t=t._getTransformedByDeletion(e,i),e.isEqual(t))return Tn._createAt(this);const n=this._getTransformedByDeletion(e,i),s=null===n||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(i).isEqual(this)&&"toPrevious"==this.stickiness;return s?this._getCombined(e,t):n._getTransformedByInsertion(t,i)}_getCombined(e,t){const i=e.path.length-1,n=Tn._createAt(t);return n.stickiness=this.stickiness,n.offset=n.offset+this.path[i]-e.offset,n.path=[...n.path,...this.path.slice(i+1)],n}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,i="toNone"){if(e instanceof Tn)return new Tn(e.root,e.path,e.stickiness);{const n=e;if("end"==t)t=n.maxOffset;else{if("before"==t)return this._createBefore(n,i);if("after"==t)return this._createAfter(n,i);if(0!==t&&!t)throw new S.ZP("model-createpositionat-offset-required",[this,e])}if(!n.is("element")&&!n.is("documentFragment"))throw new S.ZP("model-position-parent-incorrect",[this,e]);const s=n.getPath();return s.push(t),new this(n.root,s,i)}}static _createAfter(e,t){if(!e.parent)throw new S.ZP("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new S.ZP("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if("$graveyard"===e.root){const i=new Tn(t.graveyard,e.path);return i.stickiness=e.stickiness,i}if(!t.getRoot(e.root))throw new S.ZP("model-position-fromjson-no-root",t,{rootName:e.root});return new Tn(t.getRoot(e.root),e.path,e.stickiness)}}function Pn(e,t){const i=t.getChild(t.offsetToIndex(e.offset));return i&&i.is("$text")&&i.startOffset<e.offset?i:null}function Sn(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset))}function Vn(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset)-1)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class In{constructor(e,t=null){this.start=Tn._createAt(e),this.end=t?Tn._createAt(t):Tn._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new An({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),t=this.end.getParentPath();return"same"==U(e,t)}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&n}containsItem(e){const t=Tn._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}is(e){return"range"===e||"model:range"===e}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new In(this.start,e.start)),this.containsPosition(e.end)&&t.push(new In(e.end,this.end))):t.push(new In(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,i=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(i=e.end),new In(t,i)}return null}getJoined(e,t=!1){let i=this.isIntersecting(e);if(i||(i=this.start.isBefore(e.start)?t?this.end.isTouching(e.start):this.end.isEqual(e.start):t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!i)return null;let n=this.start,s=this.end;return e.start.isBefore(n)&&(n=e.start),e.end.isAfter(s)&&(s=e.end),new In(n,s)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,i=Tn._createAt(this.start);let n=i.parent;while(i.path.length>t+1){const t=n.maxOffset-i.offset;0!==t&&e.push(new In(i,i.getShiftedBy(t))),i.path=i.path.slice(0,-1),i.offset++,n=n.parent}while(i.path.length<=this.end.path.length){const t=this.end.path[i.path.length-1],n=t-i.offset;0!==n&&e.push(new In(i,i.getShiftedBy(n))),i.offset=t,i.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new An(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new An(e);for(const i of t)yield i.item}*getPositions(e={}){e.boundaries=this;const t=new An(e);yield t.position;for(const i of t)yield i.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new In(this.start,this.end)]}getTransformedByOperations(e){const t=[new In(this.start,this.end)];for(const i of e)for(let e=0;e<t.length;e++){const n=t[e].getTransformedByOperation(i);t.splice(e,1,...n),e+=n.length-1}for(let i=0;i<t.length;i++){const e=t[i];for(let n=i+1;n<t.length;n++){const i=t[n];(e.containsRange(i)||i.containsRange(e)||e.isEqual(i))&&t.splice(n,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const i=e.sourcePosition,n=e.howMany,s=e.targetPosition;return this._getTransformedByMove(i,s,n,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let i=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(i=this.end.getShiftedBy(1)),t.root!=i.root&&(i=this.end.getShiftedBy(-1)),new In(t,i)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new In(this.start);let t=this.start._getTransformedByMergeOperation(e),i=this.end._getTransformedByMergeOperation(e);return t.root!=i.root&&(i=this.end.getShiftedBy(-1)),t.isAfter(i)?(e.sourcePosition.isBefore(e.targetPosition)?(t=Tn._createAt(i),t.offset=0):(e.deletionPosition.isEqual(t)||(i=e.deletionPosition),t=e.targetPosition),new In(t,i)):new In(t,i)}_getTransformedByInsertion(e,t,i=!1){if(i&&this.containsPosition(e))return[new In(this.start,e),new In(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const i=new In(this.start,this.end);return i.start=i.start._getTransformedByInsertion(e,t),i.end=i.end._getTransformedByInsertion(e,t),[i]}}_getTransformedByMove(e,t,i,n=!1){if(this.isCollapsed){const n=this.start._getTransformedByMove(e,t,i);return[new In(n)]}const s=In._createFromPositionAndShift(e,i),o=t._getTransformedByDeletion(e,i);if(this.containsPosition(t)&&!n&&(s.containsPosition(this.start)||s.containsPosition(this.end))){const n=this.start._getTransformedByMove(e,t,i),s=this.end._getTransformedByMove(e,t,i);return[new In(n,s)]}let r;const a=this.getDifference(s);let l=null;const c=this.getIntersection(s);if(1==a.length?l=new In(a[0].start._getTransformedByDeletion(e,i),a[0].end._getTransformedByDeletion(e,i)):2==a.length&&(l=new In(this.start,this.end._getTransformedByDeletion(e,i))),r=l?l._getTransformedByInsertion(o,i,null!==c||n):[],c){const e=new In(c.start._getCombined(s.start,o),c.end._getCombined(s.start,o));2==r.length?r.splice(1,0,e):r.push(e)}return r}_getTransformedByDeletion(e,t){let i=this.start._getTransformedByDeletion(e,t),n=this.end._getTransformedByDeletion(e,t);return null==i&&null==n?null:(null==i&&(i=e),null==n&&(n=e),new In(i,n))}static _createFromPositionAndShift(e,t){const i=e,n=e.getShiftedBy(t);return t>0?new this(i,n):new this(n,i)}static _createIn(e){return new this(Tn._createAt(e,0),Tn._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(Tn._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(0===e.length)throw new S.ZP("range-create-from-ranges-empty-array",null);if(1==e.length)return e[0].clone();const t=e[0];e.sort(((e,t)=>e.start.isAfter(t.start)?1:-1));const i=e.indexOf(t),n=new this(t.start,t.end);if(i>0)for(let s=i-1;1;s++){if(!e[s].end.isEqual(n.start))break;n.start=Tn._createAt(e[s].start)}for(let s=i+1;s<e.length;s++){if(!e[s].start.isEqual(n.end))break;n.end=Tn._createAt(e[s].end)}return n}static fromJSON(e,t){return new this(Tn.fromJSON(e.start,t),Tn.fromJSON(e.end,t))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nn{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",((e,t)=>{if(t.viewPosition)return;const i=this._modelToViewMapping.get(t.modelPosition.parent);t.viewPosition=this.findPositionIn(i,t.modelPosition.offset)}),{priority:"low"}),this.on("viewToModelPosition",((e,t)=>{if(t.modelPosition)return;const i=this.findMappedViewAncestor(t.viewPosition),n=this._viewToModelMapping.get(i),s=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,i);t.modelPosition=Tn._createAt(n,s)}),{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e){const t=this.toModelElement(e);if(this._viewToModelMapping.delete(e),this._elementToMarkerNames.has(e))for(const i of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(i);this._modelToViewMapping.get(t)==e&&this._modelToViewMapping.delete(t)}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const i=this._markerNameToElements.get(t)||new Set;i.add(e);const n=this._elementToMarkerNames.get(e)||new Set;n.add(t),this._markerNameToElements.set(t,i),this._elementToMarkerNames.set(e,n)}unbindElementFromMarkerName(e,t){const i=this._markerNameToElements.get(t);i&&(i.delete(e),0==i.size&&this._markerNameToElements.delete(t));const n=this._elementToMarkerNames.get(e);n&&(n.delete(t),0==n.size&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new In(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new $e(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={isPhantom:!1}){const i={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",i),i.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const i=new Set;for(const n of t)if(n.is("attributeElement"))for(const e of n.getElementsWithSameId())i.add(e);else i.add(n);return i}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;while(!this._viewToModelMapping.has(t))t=t.parent;return t}_toModelOffset(e,t,i){if(i!=e){const n=this._toModelOffset(e.parent,e.index,i),s=this._toModelOffset(e,t,e);return n+s}if(e.is("$text"))return t;let n=0;for(let s=0;s<t;s++)n+=this.getModelLength(e.getChild(s));return n}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name)){const t=this._viewToModelLengthCallbacks.get(e.name);return t(e)}if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const i of e.getChildren())t+=this.getModelLength(i);return t}}findPositionIn(e,t){let i,n=0,s=0,o=0;if(e.is("$text"))return new ze(e,t);while(s<t)i=e.getChild(o),n=this.getModelLength(i),s+=n,o++;return s==t?this._moveViewPositionToTextNode(new ze(e,o)):this.findPositionIn(i,t-(s-n))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,i=e.nodeAfter;return t instanceof G?new ze(t,t.data.length):i instanceof G?new ze(i,0):e}}(0,I.Z)(Nn,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rn{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=Dn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=Dn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0)}test(e,t){t=Dn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e));const i=this._consumable.get(e);if(void 0===i)return null;const n=i.get(t);return void 0===n?null:n}revert(e,t){t=Dn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e));const i=this.test(e,t);return!1===i?(this._consumable.get(e).set(t,!0),!0):!0!==i&&null}_getSymbolForTextProxy(e){let t=null;const i=this._textProxyRegistry.get(e.startOffset);if(i){const n=i.get(e.endOffset);n&&(t=n.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e.startOffset,e.endOffset,e.parent)),t}_addSymbolForTextProxy(e,t,i){const n=Symbol("textProxySymbol");let s,o;return s=this._textProxyRegistry.get(e),s||(s=new Map,this._textProxyRegistry.set(e,s)),o=s.get(t),o||(o=new Map,s.set(t,o)),o.set(i,n),n}}function Dn(e){const t=e.split(":");return"addMarker"==t[0]||"removeMarker"==t[0]?e:t.length>1?t[0]+":"+t[1]:t[0]}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bn{constructor(e){this.conversionApi=Object.assign({dispatcher:this},e),this._reconversionEventsMapping=new Map}convertChanges(e,t,i){for(const s of e.getMarkersToRemove())this.convertMarkerRemove(s.name,s.range,i);const n=this._mapChangesWithAutomaticReconversion(e);for(const s of n)"insert"===s.type?this.convertInsert(In._createFromPositionAndShift(s.position,s.length),i):"remove"===s.type?this.convertRemove(s.position,s.length,s.name,i):"reconvert"===s.type?this.reconvertElement(s.element,i):this.convertAttribute(s.range,s.attributeKey,s.attributeOldValue,s.attributeNewValue,i);for(const s of this.conversionApi.mapper.flushUnboundMarkerNames()){const e=t.get(s).getRange();this.convertMarkerRemove(s,e,i),this.convertMarkerAdd(s,e,i)}for(const s of e.getMarkersToAdd())this.convertMarkerAdd(s.name,s.range,i)}convertInsert(e,t){this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(e);for(const i of Array.from(e).map(Ln))this._convertInsertWithAttributes(i);this._clearConversionApi()}convertRemove(e,t,i,n){this.conversionApi.writer=n,this.fire("remove:"+i,{position:e,length:t},this.conversionApi),this._clearConversionApi()}convertAttribute(e,t,i,n,s){this.conversionApi.writer=s,this.conversionApi.consumable=this._createConsumableForRange(e,`attribute:${t}`);for(const o of e){const e=o.item,s=In._createFromPositionAndShift(o.previousPosition,o.length),r={item:e,range:s,attributeKey:t,attributeOldValue:i,attributeNewValue:n};this._testAndFire(`attribute:${t}`,r)}this._clearConversionApi()}reconvertElement(e,t){const i=In._createOn(e);this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(i);const n=this.conversionApi.mapper,s=n.toViewElement(e);t.remove(s),this._convertInsertWithAttributes({item:e,range:i});const o=n.toViewElement(e);for(const r of In._createIn(e)){const{item:e}=r,i=Fn(e,n);i?i.root!==o.root&&t.move(t.createRangeOn(i),n.toViewPosition(Tn._createBefore(e))):this._convertInsertWithAttributes(Ln(r))}n.unbindViewElement(s),this._clearConversionApi()}convertSelection(e,t,i){const n=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this.conversionApi.writer=i,this.conversionApi.consumable=this._createSelectionConsumable(e,n),this.fire("selection",{selection:e},this.conversionApi),e.isCollapsed){for(const t of n){const i=t.getRange();if(!Mn(e.getFirstPosition(),t,this.conversionApi.mapper))continue;const n={item:e,markerName:t.name,markerRange:i};this.conversionApi.consumable.test(e,"addMarker:"+t.name)&&this.fire("addMarker:"+t.name,n,this.conversionApi)}for(const t of e.getAttributeKeys()){const i={item:e,range:e.getFirstRange(),attributeKey:t,attributeOldValue:null,attributeNewValue:e.getAttribute(t)};this.conversionApi.consumable.test(e,"attribute:"+i.attributeKey)&&this.fire("attribute:"+i.attributeKey+":$text",i,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerAdd(e,t,i){if("$graveyard"==t.root.rootName)return;this.conversionApi.writer=i;const n="addMarker:"+e,s=new Rn;if(s.add(t,n),this.conversionApi.consumable=s,this.fire(n,{markerName:e,markerRange:t},this.conversionApi),s.test(t,n)){this.conversionApi.consumable=this._createConsumableForRange(t,n);for(const i of t.getItems()){if(!this.conversionApi.consumable.test(i,n))continue;const s={item:i,range:In._createOn(i),markerName:e,markerRange:t};this.fire(n,s,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerRemove(e,t,i){"$graveyard"!=t.root.rootName&&(this.conversionApi.writer=i,this.fire("removeMarker:"+e,{markerName:e,markerRange:t},this.conversionApi),this._clearConversionApi())}_mapReconversionTriggerEvent(e,t){this._reconversionEventsMapping.set(t,e)}_createInsertConsumable(e){const t=new Rn;for(const i of e){const e=i.item;t.add(e,"insert");for(const i of e.getAttributeKeys())t.add(e,"attribute:"+i)}return t}_createConsumableForRange(e,t){const i=new Rn;for(const n of e.getItems())i.add(n,t);return i}_createSelectionConsumable(e,t){const i=new Rn;i.add(e,"selection");for(const n of t)i.add(e,"addMarker:"+n.name);for(const n of e.getAttributeKeys())i.add(e,"attribute:"+n);return i}_testAndFire(e,t){this.conversionApi.consumable.test(t.item,e)&&this.fire(On(e,t),t,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}_convertInsertWithAttributes(e){this._testAndFire("insert",e);for(const t of e.item.getAttributeKeys())e.attributeKey=t,e.attributeOldValue=null,e.attributeNewValue=e.item.getAttribute(t),this._testAndFire(`attribute:${t}`,e)}_mapChangesWithAutomaticReconversion(e){const t=new Set,i=[];for(const n of e.getChanges()){const e=n.position||n.range.start,s=e.parent,o=Pn(e,s);if(o){i.push(n);continue}const r="attribute"===n.type?Sn(e,s,null):s;if(r.is("$text")){i.push(n);continue}let a;if(a="attribute"===n.type?`attribute:${n.attributeKey}:${r.name}`:`${n.type}:${n.name}`,this._isReconvertTriggerEvent(a,r.name)){if(t.has(r))continue;t.add(r),i.push({type:"reconvert",element:r})}else i.push(n)}return i}_isReconvertTriggerEvent(e,t){return this._reconversionEventsMapping.get(e)===t}}function Mn(e,t,i){const n=t.getRange(),s=Array.from(e.getAncestors());s.shift(),s.reverse();const o=s.some((e=>{if(n.containsItem(e)){const t=i.toViewElement(e);return!!t.getCustomProperty("addHighlight")}}));return!o}function On(e,t){const i=t.item.name||"$text";return`${e}:${i}`}function Ln(e){const t=e.item,i=In._createFromPositionAndShift(e.previousPosition,e.length);return{item:t,range:i}}function Fn(e,t){if(e.is("textProxy")){const i=t.toViewPosition(Tn._createBefore(e)),n=i.parent;return n.is("$text")?n:null}return t.toViewElement(e)}(0,I.Z)(Bn,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zn{constructor(e,t,i){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,e&&this.setTo(e,t,i)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){const e=this._ranges.length;return 1===e&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let i=!1;for(const n of e._ranges)if(t.isEqual(n)){i=!0;break}if(!i)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new In(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?new In(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?new In(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(e,t,i){if(null===e)this._setRanges([]);else if(e instanceof zn)this._setRanges(e.getRanges(),e.isBackward);else if(e&&"function"==typeof e.getRanges)this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof In)this._setRanges([e],!!t&&!!t.backward);else if(e instanceof Tn)this._setRanges([new In(e)]);else if(e instanceof vn){const n=!!i&&!!i.backward;let s;if("in"==t)s=In._createIn(e);else if("on"==t)s=In._createOn(e);else{if(void 0===t)throw new S.ZP("model-selection-setto-required-second-parameter",[this,e]);s=new In(Tn._createAt(e,t))}this._setRanges([s],n)}else{if(!(0,J.Z)(e))throw new S.ZP("model-selection-setto-not-selectable",[this,e]);this._setRanges(e,t&&!!t.backward)}}_setRanges(e,t=!1){e=Array.from(e);const i=e.some((t=>{if(!(t instanceof In))throw new S.ZP("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every((e=>!e.isEqual(t)))}));if(e.length!==this._ranges.length||i){this._removeAllRanges();for(const t of e)this._pushRange(t);this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0})}}setFocus(e,t){if(null===this.anchor)throw new S.ZP("model-selection-setfocus-no-ranges",[this,e]);const i=Tn._createAt(e,t);if("same"==i.compareWith(this.focus))return;const n=this.anchor;this._ranges.length&&this._popRange(),"before"==i.compareWith(n)?(this._pushRange(new In(i,n)),this._lastRangeBackward=!0):(this._pushRange(new In(n,i)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}is(e){return"selection"===e||"model:selection"===e}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const i=Hn(t.start,e);i&&Un(i,t)&&(yield i);for(const s of t.getWalker()){const i=s.item;"elementEnd"==s.type&&Zn(i,e,t)&&(yield i)}const n=Hn(t.end,e);n&&!t.end.isTouching(Tn._createAt(n,0))&&Un(n,t)&&(yield n)}}containsEntireContent(e=this.anchor.root){const t=Tn._createAt(e,0),i=Tn._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&i.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new In(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new S.ZP("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_removeAllRanges(){while(this._ranges.length>0)this._popRange()}_popRange(){this._ranges.pop()}}function $n(e,t){return!t.has(e)&&(t.add(e),e.root.document.model.schema.isBlock(e)&&e.parent)}function Zn(e,t,i){return $n(e,t)&&Un(e,i)}function Hn(e,t){const i=e.parent,n=i.root.document.model.schema,s=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const r=s.find((e=>!o&&(o=n.isLimit(e),!o&&$n(e,t))));return s.forEach((e=>t.add(e))),r}function Un(e,t){const i=Wn(e);if(!i)return!0;const n=t.containsRange(In._createOn(i),!0);return!n}function Wn(e){const t=e.root.document.model.schema;let i=e.parent;while(i){if(t.isBlock(i))return i;i=i.parent}}(0,I.Z)(zn,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qn extends In{constructor(e,t){super(e,t),Gn.call(this)}detach(){this.stopListening()}is(e){return"liveRange"===e||"model:liveRange"===e||"range"==e||"model:range"===e}toRange(){return new In(this.start,this.end)}static fromRange(e){return new qn(e.start,e.end)}}function Gn(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&jn.call(this,i)}),{priority:"low"})}function jn(e){const t=this.getTransformedByOperation(e),i=In._createFromRanges(t),n=!i.isEqual(this),s=Kn(this,e);let o=null;if(n){"$graveyard"==i.root.rootName&&(o="remove"==e.type?e.sourcePosition:e.deletionPosition);const t=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",t,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}function Kn(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}(0,I.Z)(qn,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Jn="selection:";class Yn{constructor(e){this._selection=new Qn(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}is(e){return"selection"===e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(e,t,i){this._selection.setTo(e,t,i)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return Jn+e}static _isStoreAttributeKey(e){return e.startsWith(Jn)}}(0,I.Z)(Yn,V.ZP);class Qn extends zn{constructor(e){super(),this.markers=new P.Z({idProperty:"name"}),this._model=e.model,this._document=e,this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this.listenTo(this._model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&"marker"!=i.type&&"rename"!=i.type&&"noop"!=i.type&&(0==this._ranges.length&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))}),{priority:"lowest"}),this.on("change:range",(()=>{for(const e of this.getRanges())if(!this._document._validateSelectionRange(e))throw new S.ZP("document-selection-wrong-position",this,{range:e})})),this.listenTo(this._model.markers,"update",((e,t,i,n)=>{this._updateMarker(t,n)})),this.listenTo(this._document,"change",((e,t)=>{es(this._model,t)}))}get isCollapsed(){const e=this._ranges.length;return 0===e?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(e,t,i){super.setTo(e,t,i),this._updateAttributes(!0),this._updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this._updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=(0,sn.Z)();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new S.ZP("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this._updateMarkers()}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=qn.fromRange(e);return t.on("change:range",((e,i,n)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=n.deletionPosition;const e=this._ranges.indexOf(t);this._ranges.splice(e,1),t.detach()}})),t}_updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const n of this._model.markers){const t=n.name.split(":",1)[0];if(!this._observedMarkers.has(t))continue;const i=n.getRange();for(const s of this.getRanges())i.containsRange(s,!s.isCollapsed)&&e.push(n)}const i=Array.from(this.markers);for(const n of e)this.markers.has(n)||(this.markers.add(n),t=!0);for(const n of Array.from(this.markers))e.includes(n)||(this.markers.remove(n),t=!0);t&&this.fire("change:marker",{oldMarkers:i,directChange:!1})}_updateMarker(e,t){const i=e.name.split(":",1)[0];if(!this._observedMarkers.has(i))return;let n=!1;const s=Array.from(this.markers),o=this.markers.has(e);if(t){let i=!1;for(const e of this.getRanges())if(t.containsRange(e,!e.isCollapsed)){i=!0;break}i&&!o?(this.markers.add(e),n=!0):!i&&o&&(this.markers.remove(e),n=!0)}else o&&(this.markers.remove(e),n=!0);n&&this.fire("change:marker",{oldMarkers:s,directChange:!1})}_updateAttributes(e){const t=Y(this._getSurroundingAttributes()),i=Y(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[s,o]of this._attributePriority)"low"==o&&(this._attrs.delete(s),this._attributePriority.delete(s));this._setAttributesTo(t);const n=[];for(const[s,o]of this.getAttributes())i.has(s)&&i.get(s)===o||n.push(s);for(const[s]of i)this.hasAttribute(s)||n.push(s);n.length>0&&this.fire("change:attribute",{attributeKeys:n,directChange:!1})}_setAttribute(e,t,i=!0){const n=i?"normal":"low";if("low"==n&&"normal"==this._attributePriority.get(e))return!1;const s=super.getAttribute(e);return s!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,n),!0)}_removeAttribute(e,t=!0){const i=t?"normal":"low";return("low"!=i||"normal"!=this._attributePriority.get(e))&&(this._attributePriority.set(e,i),!!super.hasAttribute(e)&&(this._attrs.delete(e),!0))}_setAttributesTo(e){const t=new Set;for(const[i,n]of this.getAttributes())e.get(i)!==n&&this._removeAttribute(i,!1);for(const[i,n]of e){const e=this._setAttribute(i,n,!1);e&&t.add(i)}return t}*_getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())if(t.startsWith(Jn)){const i=t.substr(Jn.length);yield[i,e.getAttribute(t)]}}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;let i=null;if(this.isCollapsed){const n=e.textNode?e.textNode:e.nodeBefore,s=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(i=Xn(n)),i||(i=Xn(s)),!this.isGravityOverridden&&!i){let e=n;while(e&&!t.isInline(e)&&!i)e=e.previousSibling,i=Xn(e)}if(!i){let e=s;while(e&&!t.isInline(e)&&!i)e=e.nextSibling,i=Xn(e)}i||(i=this._getStoredAttributes())}else{const e=this.getFirstRange();for(const n of e){if(n.item.is("element")&&t.isObject(n.item))break;if("text"==n.type){i=n.item.getAttributes();break}}}return i}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function Xn(e){return e instanceof yn||e instanceof _n?e.getAttributes():null}function es(e,t){const i=e.document.differ;for(const n of i.getChanges()){if("insert"!=n.type)continue;const i=n.position.parent,s=n.length===i.maxOffset;s&&e.enqueueChange(t,(e=>{const t=Array.from(i.getAttributeKeys()).filter((e=>e.startsWith(Jn)));for(const n of t)e.removeAttribute(n,i)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ts{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}var is=i(68652);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ns extends ts{elementToElement(e){return this.add(ks(e))}attributeToElement(e){return this.add(xs(e))}attributeToAttribute(e){return this.add(As(e))}markerToElement(e){return this.add(Es(e))}markerToHighlight(e){return this.add(Ps(e))}markerToData(e){return this.add(Ts(e))}}function ss(){return(e,t,i)=>{if(!i.consumable.consume(t.item,"insert"))return;const n=i.writer,s=i.mapper.toViewPosition(t.range.start),o=n.createText(t.item.data);n.insert(s,o)}}function os(){return(e,t,i)=>{const n=i.mapper.toViewPosition(t.position),s=t.position.getShiftedBy(t.length),o=i.mapper.toViewPosition(s,{isPhantom:!0}),r=i.writer.createRange(n,o),a=i.writer.remove(r.getTrimmed());for(const l of i.writer.createRangeIn(a).getItems())i.mapper.unbindViewElement(l)}}function rs(e,t){const i=e.createAttributeElement("span",t.attributes);return t.classes&&i._addClass(t.classes),"number"===typeof t.priority&&(i._priority=t.priority),i._id=t.id,i}function as(){return(e,t,i)=>{const n=t.selection;if(n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;const s=[];for(const o of n.getRanges()){const e=i.mapper.toViewRange(o);s.push(e)}i.writer.setSelection(s,{backward:n.isBackward})}}function ls(){return(e,t,i)=>{const n=t.selection;if(!n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;const s=i.writer,o=n.getFirstPosition(),r=i.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a)}}function cs(){return(e,t,i)=>{const n=i.writer,s=n.document.selection;for(const o of s.getRanges())o.isCollapsed&&o.end.parent.isAttached()&&i.writer.mergeAttributes(o.start);n.setSelection(null)}}function ds(e){return(t,i,n)=>{const s=e(i.attributeOldValue,n),o=e(i.attributeNewValue,n);if(!s&&!o)return;if(!n.consumable.consume(i.item,t.name))return;const r=n.writer,a=r.document.selection;if(i.item instanceof zn||i.item instanceof Yn)r.wrap(a.getFirstRange(),o);else{let e=n.mapper.toViewRange(i.range);null!==i.attributeOldValue&&s&&(e=r.unwrap(e,s)),null!==i.attributeNewValue&&o&&r.wrap(e,o)}}}function hs(e){return(t,i,n)=>{const s=e(i.item,n);if(!s)return;if(!n.consumable.consume(i.item,"insert"))return;const o=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(i.item,s),n.writer.insert(o,s)}}function us(e){return(t,i,n)=>{i.isOpening=!0;const s=e(i,n);i.isOpening=!1;const o=e(i,n);if(!s||!o)return;const r=i.markerRange;if(r.isCollapsed&&!n.consumable.consume(r,t.name))return;for(const e of r)if(!n.consumable.consume(e.item,t.name))return;const a=n.mapper,l=n.writer;l.insert(a.toViewPosition(r.start),s),n.mapper.bindElementToMarker(s,i.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),o),n.mapper.bindElementToMarker(o,i.markerName)),t.stop()}}function ms(){return(e,t,i)=>{const n=i.mapper.markerNameToElements(t.markerName);if(n){for(const e of n)i.mapper.unbindElementFromMarkerName(e,t.markerName),i.writer.clear(i.writer.createRangeOn(e),e);i.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function gs(e){return(t,i,n)=>{const s=e(i.markerName,n);if(!s)return;const o=i.markerRange;n.consumable.consume(o,t.name)&&(ps(o,!1,n,i,s),ps(o,!0,n,i,s),t.stop())}}function ps(e,t,i,n,s){const o=t?e.start:e.end,r=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,a=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(r||a){let e,o;t&&r||!t&&!a?(e=r,o=!0):(e=a,o=!1);const l=i.mapper.toViewElement(e);if(l)return void fs(l,t,o,i,n,s)}const l=i.mapper.toViewPosition(o);ws(l,t,i,n,s)}function fs(e,t,i,n,s,o){const r=`data-${o.group}-${t?"start":"end"}-${i?"before":"after"}`,a=e.hasAttribute(r)?e.getAttribute(r).split(","):[];a.unshift(o.name),n.writer.setAttribute(r,a.join(","),e),n.mapper.bindElementToMarker(e,s.markerName)}function ws(e,t,i,n,s){const o=`${s.group}-${t?"start":"end"}`,r=s.name?{name:s.name}:null,a=i.writer.createUIElement(o,r);i.writer.insert(e,a),i.mapper.bindElementToMarker(a,n.markerName)}function bs(e){return(t,i,n)=>{const s=e(i.markerName,n);if(!s)return;const o=n.mapper.markerNameToElements(i.markerName);if(o){for(const e of o)n.mapper.unbindElementFromMarkerName(e,i.markerName),e.is("containerElement")?(r(`data-${s.group}-start-before`,e),r(`data-${s.group}-start-after`,e),r(`data-${s.group}-end-before`,e),r(`data-${s.group}-end-after`,e)):n.writer.clear(n.writer.createRangeOn(e),e);n.writer.clearClonedElementsGroup(i.markerName),t.stop()}function r(e,t){if(t.hasAttribute(e)){const i=new Set(t.getAttribute(e).split(","));i.delete(s.name),0==i.size?n.writer.removeAttribute(e,t):n.writer.setAttribute(e,Array.from(i).join(","),t)}}}}function vs(e){return(t,i,n)=>{const s=e(i.attributeOldValue,n),o=e(i.attributeNewValue,n);if(!s&&!o)return;if(!n.consumable.consume(i.item,t.name))return;const r=n.mapper.toViewElement(i.item),a=n.writer;if(!r)throw new S.ZP("conversion-attribute-to-attribute-on-text",[i,n]);if(null!==i.attributeOldValue&&s)if("class"==s.key){const e=(0,R.Z)(s.value);for(const t of e)a.removeClass(t,r)}else if("style"==s.key){const e=Object.keys(s.value);for(const t of e)a.removeStyle(t,r)}else a.removeAttribute(s.key,r);if(null!==i.attributeNewValue&&o)if("class"==o.key){const e=(0,R.Z)(o.value);for(const t of e)a.addClass(t,r)}else if("style"==o.key){const e=Object.keys(o.value);for(const t of e)a.setStyle(t,o.value[t],r)}else a.setAttribute(o.key,o.value,r)}}function _s(e){return(t,i,n)=>{if(!i.item)return;if(!(i.item instanceof zn||i.item instanceof Yn)&&!i.item.is("$textProxy"))return;const s=Rs(e,i,n);if(!s)return;if(!n.consumable.consume(i.item,t.name))return;const o=n.writer,r=rs(o,s),a=o.document.selection;if(i.item instanceof zn||i.item instanceof Yn)o.wrap(a.getFirstRange(),r,a);else{const e=n.mapper.toViewRange(i.range),t=o.wrap(e,r);for(const s of t.getItems())if(s.is("attributeElement")&&s.isSimilar(r)){n.mapper.bindElementToMarker(s,i.markerName);break}}}}function ys(e){return(t,i,n)=>{if(!i.item)return;if(!(i.item instanceof kn))return;const s=Rs(e,i,n);if(!s)return;if(!n.consumable.test(i.item,t.name))return;const o=n.mapper.toViewElement(i.item);if(o&&o.getCustomProperty("addHighlight")){n.consumable.consume(i.item,t.name);for(const e of In._createIn(i.item))n.consumable.consume(e.item,t.name);o.getCustomProperty("addHighlight")(o,s,n.writer),n.mapper.bindElementToMarker(o,i.markerName)}}}function Cs(e){return(t,i,n)=>{if(i.markerRange.isCollapsed)return;const s=Rs(e,i,n);if(!s)return;const o=rs(n.writer,s),r=n.mapper.markerNameToElements(i.markerName);if(r){for(const e of r)n.mapper.unbindElementFromMarkerName(e,i.markerName),e.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(e),o):e.getCustomProperty("removeHighlight")(e,s.id,n.writer);n.writer.clearClonedElementsGroup(i.markerName),t.stop()}}}function ks(e){return e=(0,is.Z)(e),e.view=Ss(e.view,"container"),t=>{if(t.on("insert:"+e.model,hs(e.view),{priority:e.converterPriority||"normal"}),e.triggerBy){if(e.triggerBy.attributes)for(const i of e.triggerBy.attributes)t._mapReconversionTriggerEvent(e.model,`attribute:${i}:${e.model}`);if(e.triggerBy.children)for(const i of e.triggerBy.children)t._mapReconversionTriggerEvent(e.model,`insert:${i}`),t._mapReconversionTriggerEvent(e.model,`remove:${i}`)}}}function xs(e){e=(0,is.Z)(e);const t=e.model.key?e.model.key:e.model;let i="attribute:"+t;if(e.model.name&&(i+=":"+e.model.name),e.model.values)for(const s of e.model.values)e.view[s]=Ss(e.view[s],"attribute");else e.view=Ss(e.view,"attribute");const n=Is(e);return t=>{t.on(i,ds(n),{priority:e.converterPriority||"normal"})}}function As(e){e=(0,is.Z)(e);const t=e.model.key?e.model.key:e.model;let i="attribute:"+t;if(e.model.name&&(i+=":"+e.model.name),e.model.values)for(const s of e.model.values)e.view[s]=Ns(e.view[s]);else e.view=Ns(e.view);const n=Is(e);return t=>{t.on(i,vs(n),{priority:e.converterPriority||"normal"})}}function Es(e){return e=(0,is.Z)(e),e.view=Ss(e.view,"ui"),t=>{t.on("addMarker:"+e.model,us(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,ms(e.view),{priority:e.converterPriority||"normal"})}}function Ts(e){e=(0,is.Z)(e);const t=e.model;return e.view||(e.view=i=>({group:t,name:i.substr(e.model.length+1)})),i=>{i.on("addMarker:"+t,gs(e.view),{priority:e.converterPriority||"normal"}),i.on("removeMarker:"+t,bs(e.view),{priority:e.converterPriority||"normal"})}}function Ps(e){return t=>{t.on("addMarker:"+e.model,_s(e.view),{priority:e.converterPriority||"normal"}),t.on("addMarker:"+e.model,ys(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,Cs(e.view),{priority:e.converterPriority||"normal"})}}function Ss(e,t){return"function"==typeof e?e:(i,n)=>Vs(e,n,t)}function Vs(e,t,i){let n;"string"==typeof e&&(e={name:e});const s=t.writer,o=Object.assign({},e.attributes);if("container"==i)n=s.createContainerElement(e.name,o);else if("attribute"==i){const t={priority:e.priority||st.DEFAULT_PRIORITY};n=s.createAttributeElement(e.name,o,t)}else n=s.createUIElement(e.name,o);if(e.styles){const t=Object.keys(e.styles);for(const i of t)s.setStyle(i,e.styles[i],n)}if(e.classes){const t=e.classes;if("string"==typeof t)s.addClass(t,n);else for(const e of t)s.addClass(e,n)}return n}function Is(e){return e.model.values?(t,i)=>{const n=e.view[t];return n?n(t,i):null}:e.view}function Ns(e){return"string"==typeof e?t=>({key:e,value:t}):"object"==typeof e?e.value?()=>e:t=>({key:e.key,value:t}):e}function Rs(e,t,i){const n="function"==typeof e?e(t,i):e;return n?(n.priority||(n.priority=10),n.id||(n.id=t.markerName),n):null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ds(e){const{schema:t,document:i}=e.model;for(const n of i.getRootNames()){const s=i.getRoot(n);if(s.isEmpty&&!t.checkChild(s,"$text")&&t.checkChild(s,"paragraph"))return e.insertElement("paragraph",s),!0}return!1}function Bs(e,t,i){const n=i.createContext(e);return!!i.checkChild(n,"paragraph")&&!!i.checkChild(n.push("paragraph"),t)}function Ms(e,t){const i=t.createElement("paragraph");return t.insert(i,e),t.createPositionAt(i,0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Os extends ts{elementToElement(e){return this.add($s(e))}elementToAttribute(e){return this.add(Zs(e))}attributeToAttribute(e){return this.add(Hs(e))}elementToMarker(e){return this.add(Us(e))}dataToMarker(e){return this.add(Ws(e))}}function Ls(){return(e,t,i)=>{if(!t.modelRange&&i.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:n}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=n}}}function Fs(){return(e,t,{schema:i,consumable:n,writer:s})=>{let o=t.modelCursor;if(!n.test(t.viewItem))return;if(!i.checkChild(o,"$text")){if(!Bs(o,"$text",i))return;o=Ms(o,s)}n.consume(t.viewItem);const r=s.createText(t.viewItem.data);s.insert(r,o),t.modelRange=s.createRange(o,o.getShiftedBy(r.offsetSize)),t.modelCursor=t.modelRange.end}}function zs(e,t){return(i,n)=>{const s=n.newSelection,o=[];for(const e of s.getRanges())o.push(t.toModelRange(e));const r=e.createSelection(o,{backward:s.isBackward});r.isEqual(e.document.selection)||e.change((e=>{e.setSelection(r)}))}}function $s(e){e=(0,is.Z)(e);const t=js(e),i=Gs(e.view),n=i?"element:"+i:"element";return i=>{i.on(n,t,{priority:e.converterPriority||"normal"})}}function Zs(e){e=(0,is.Z)(e),Ys(e);const t=Qs(e,!1),i=Gs(e.view),n=i?"element:"+i:"element";return i=>{i.on(n,t,{priority:e.converterPriority||"low"})}}function Hs(e){e=(0,is.Z)(e);let t=null;("string"==typeof e.view||e.view.key)&&(t=Js(e)),Ys(e,t);const i=Qs(e,!0);return t=>{t.on("element",i,{priority:e.converterPriority||"low"})}}function Us(e){return e=(0,is.Z)(e),to(e),$s(e)}function Ws(e){e=(0,is.Z)(e),e.model||(e.model=t=>t?e.view+":"+t:e.view);const t=js(io(e,"start")),i=js(io(e,"end"));return n=>{n.on("element:"+e.view+"-start",t,{priority:e.converterPriority||"normal"}),n.on("element:"+e.view+"-end",i,{priority:e.converterPriority||"normal"});const s=nn.Z.get("low"),o=nn.Z.get("highest"),r=nn.Z.get(e.converterPriority)/o;n.on("element",qs(e),{priority:s+r})}}function qs(e){return(t,i,n)=>{const s=`data-${e.view}`;function o(t,s){for(const o of s){const s=e.model(o,n),r=n.writer.createElement("$marker",{"data-name":s});n.writer.insert(r,t),i.modelCursor.isEqual(t)?i.modelCursor=i.modelCursor.getShiftedBy(1):i.modelCursor=i.modelCursor._getTransformedByInsertion(t,1),i.modelRange=i.modelRange._getTransformedByInsertion(t,1)[0]}}(n.consumable.test(i.viewItem,{attributes:s+"-end-after"})||n.consumable.test(i.viewItem,{attributes:s+"-start-after"})||n.consumable.test(i.viewItem,{attributes:s+"-end-before"})||n.consumable.test(i.viewItem,{attributes:s+"-start-before"}))&&(i.modelRange||Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor)),n.consumable.consume(i.viewItem,{attributes:s+"-end-after"})&&o(i.modelRange.end,i.viewItem.getAttribute(s+"-end-after").split(",")),n.consumable.consume(i.viewItem,{attributes:s+"-start-after"})&&o(i.modelRange.end,i.viewItem.getAttribute(s+"-start-after").split(",")),n.consumable.consume(i.viewItem,{attributes:s+"-end-before"})&&o(i.modelRange.start,i.viewItem.getAttribute(s+"-end-before").split(",")),n.consumable.consume(i.viewItem,{attributes:s+"-start-before"})&&o(i.modelRange.start,i.viewItem.getAttribute(s+"-start-before").split(",")))}}function Gs(e){return"string"==typeof e?e:"object"==typeof e&&"string"==typeof e.name?e.name:null}function js(e){const t=new Q(e.view);return(i,n,s)=>{const o=t.match(n.viewItem);if(!o)return;const r=o.match;if(r.name=!0,!s.consumable.test(n.viewItem,r))return;const a=Ks(e.model,n.viewItem,s);a&&s.safeInsert(a,n.modelCursor)&&(s.consumable.consume(n.viewItem,r),s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n))}}function Ks(e,t,i){return e instanceof Function?e(t,i):i.writer.createElement(e)}function Js(e){"string"==typeof e.view&&(e.view={key:e.view});const t=e.view.key;let i;if("class"==t||"style"==t){const n="class"==t?"classes":"styles";i={[n]:e.view.value}}else{const n="undefined"==typeof e.view.value?/[\s\S]*/:e.view.value;i={attributes:{[t]:n}}}return e.view.name&&(i.name=e.view.name),e.view=i,t}function Ys(e,t=null){const i=null===t||(e=>e.getAttribute(t)),n="object"!=typeof e.model?e.model:e.model.key,s="object"!=typeof e.model||"undefined"==typeof e.model.value?i:e.model.value;e.model={key:n,value:s}}function Qs(e,t){const i=new Q(e.view);return(n,s,o)=>{const r=i.match(s.viewItem);if(!r)return;if(Xs(e.view,s.viewItem)?r.match.name=!0:delete r.match.name,!o.consumable.test(s.viewItem,r.match))return;const a=e.model.key,l="function"==typeof e.model.value?e.model.value(s.viewItem,o):e.model.value;if(null===l)return;s.modelRange||Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor));const c=eo(s.modelRange,{key:a,value:l},t,o);c&&o.consumable.consume(s.viewItem,r.match)}}function Xs(e,t){const i="function"==typeof e?e(t):e;return!("object"==typeof i&&!Gs(i))&&(!i.classes&&!i.attributes&&!i.styles)}function eo(e,t,i,n){let s=!1;for(const o of Array.from(e.getItems({shallow:i})))n.schema.checkAttribute(o,t.key)&&(s=!0,o.hasAttribute(t.key)||n.writer.setAttribute(t.key,t.value,o));return s}function to(e){const t=e.model;e.model=(e,i)=>{const n="string"==typeof t?t:t(e,i);return i.writer.createElement("$marker",{"data-name":n})}}function io(e,t){const i={};return i.view=e.view+"-"+t,i.model=(t,i)=>{const n=t.getAttribute("name"),s=e.model(n,i);return i.writer.createElement("$marker",{"data-name":s})},i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class no{constructor(e,t){this.model=e,this.view=new bn(t),this.mapper=new Nn,this.downcastDispatcher=new Bn({mapper:this.mapper,schema:e.schema});const i=this.model.document,n=i.selection,s=this.model.markers;this.listenTo(this.model,"_beforeChanges",(()=>{this.view._disableRendering(!0)}),{priority:"highest"}),this.listenTo(this.model,"_afterChanges",(()=>{this.view._disableRendering(!1)}),{priority:"lowest"}),this.listenTo(i,"change",(()=>{this.view.change((e=>{this.downcastDispatcher.convertChanges(i.differ,s,e),this.downcastDispatcher.convertSelection(n,s,e)}))}),{priority:"low"}),this.listenTo(this.view.document,"selectionChange",zs(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",ss(),{priority:"lowest"}),this.downcastDispatcher.on("remove",os(),{priority:"low"}),this.downcastDispatcher.on("selection",cs(),{priority:"high"}),this.downcastDispatcher.on("selection",as(),{priority:"low"}),this.downcastDispatcher.on("selection",ls(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using((e=>{if("$graveyard"==e.rootName)return null;const t=new Le(this.view.document,e.name);return t.rootName=e.rootName,this.mapper.bindElements(e,t),t}))}destroy(){this.view.destroy(),this.stopListening()}}(0,I.Z)(no,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class so{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const i=this.get(e);if(!i)throw new S.ZP("commandcollection-command-not-found",this,{commandName:e});return i.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class oo{constructor(){this._consumables=new Map}add(e,t){let i;e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?i=this._consumables.get(e):(i=new ro(e),this._consumables.set(e,i)),i.add(t))}test(e,t){const i=this._consumables.get(e);return void 0===i?null:e.is("$text")||e.is("documentFragment")?i:i.test(t)}consume(e,t){return!!this.test(e,t)&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0)}revert(e,t){const i=this._consumables.get(e);void 0!==i&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):i.revert(t))}static consumablesFromElement(e){const t={element:e,name:!0,attributes:[],classes:[],styles:[]},i=e.getAttributeKeys();for(const o of i)"style"!=o&&"class"!=o&&t.attributes.push(o);const n=e.getClassNames();for(const o of n)t.classes.push(o);const s=e.getStyleNames();for(const o of s)t.styles.push(o);return t}static createFrom(e,t){if(t||(t=new oo(e)),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,oo.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const i of e.getChildren())t=oo.createFrom(i,t);return t}}class ro{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t in this._consumables)if(t in e){const i=this._test(t,e[t]);if(!0!==i)return i}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t in this._consumables)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._revert(t,e[t])}_add(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const s of i){if("attributes"===e&&("class"===s||"style"===s))throw new S.ZP("viewconsumable-invalid-attribute",this);if(n.set(s,!0),"styles"===e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(s))n.set(e,!0)}}_test(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const s of i)if("attributes"!==e||"class"!==s&&"style"!==s){const e=n.get(s);if(void 0===e)return null;if(!e)return!1}else{const e="class"==s?"classes":"styles",t=this._test(e,[...this._consumables[e].keys()]);if(!0!==t)return t}return!0}_consume(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const s of i)if("attributes"!==e||"class"!==s&&"style"!==s){if(n.set(s,!1),"styles"==e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(s))n.set(e,!1)}else{const e="class"==s?"classes":"styles";this._consume(e,[...this._consumables[e].keys()])}}_revert(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const s of i)if("attributes"!==e||"class"!==s&&"style"!==s){const e=n.get(s);!1===e&&n.set(s,!0)}else{const e="class"==s?"classes":"styles";this._revert(e,[...this._consumables[e].keys()])}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ao{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",((e,t)=>{t[0]=new lo(t[0])}),{priority:"highest"}),this.on("checkChild",((e,t)=>{t[0]=new lo(t[0]),t[1]=this.getDefinition(t[1])}),{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new S.ZP("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new S.ZP("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return t="string"==typeof e?e:e.is&&(e.is("$text")||e.is("$textProxy"))?"$text":e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!(!t||!t.isBlock)}isLimit(e){const t=this.getDefinition(e);return!!t&&!(!t.isLimit&&!t.isObject)}isObject(e){const t=this.getDefinition(e);return!!t&&!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent)}isInline(e){const t=this.getDefinition(e);return!(!t||!t.isInline)}isSelectable(e){const t=this.getDefinition(e);return!!t&&!(!t.isSelectable&&!t.isObject)}isContent(e){const t=this.getDefinition(e);return!!t&&!(!t.isContent&&!t.isObject)}checkChild(e,t){return!!t&&this._checkContextMatch(t,e)}checkAttribute(e,t){const i=this.getDefinition(e.last);return!!i&&i.allowAttributes.includes(t)}checkMerge(e,t=null){if(e instanceof Tn){const t=e.nodeBefore,i=e.nodeAfter;if(!(t instanceof kn))throw new S.ZP("schema-check-merge-no-element-before",this);if(!(i instanceof kn))throw new S.ZP("schema-check-merge-no-element-after",this);return this.checkMerge(t,i)}for(const i of t.getChildren())if(!this.checkChild(e,i))return!1;return!0}addChildCheck(e){this.on("checkChild",((t,[i,n])=>{if(!n)return;const s=e(i,n);"boolean"==typeof s&&(t.stop(),t.return=s)}),{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",((t,[i,n])=>{const s=e(i,n);"boolean"==typeof s&&(t.stop(),t.return=s)}),{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;if(e instanceof Tn)t=e.parent;else{const i=e instanceof In?[e]:Array.from(e.getRanges());t=i.reduce(((e,t)=>{const i=t.getCommonAncestor();return e?e.getCommonAncestor(i,{includeSelf:!0}):i}),null)}while(!this.isLimit(t)){if(!t.parent)break;t=t.parent}return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const i=e.getFirstPosition(),n=[...i.getAncestors(),new _n("",e.getAttributes())];return this.checkAttribute(n,t)}{const i=e.getRanges();for(const e of i)for(const i of e)if(this.checkAttribute(i.item,t))return!0}return!1}*getValidRanges(e,t){e=Eo(e);for(const i of e)yield*this._getValidRangesForRange(i,t)}getNearestSelectionRange(e,t="both"){if(this.checkChild(e,"$text"))return new In(e);let i,n;const s=e.getAncestors().reverse().find((e=>this.isLimit(e)))||e.root;"both"!=t&&"backward"!=t||(i=new An({boundaries:In._createIn(s),startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(n=new An({boundaries:In._createIn(s),startPosition:e}));for(const o of Ao(i,n)){const e=o.walker==i?"elementEnd":"elementStart",t=o.value;if(t.type==e&&this.isObject(t.item))return In._createOn(t.item);if(this.checkChild(t.nextPosition,"$text"))return new In(t.nextPosition)}return null}findAllowedParent(e,t){let i=e.parent;while(i){if(this.checkChild(i,t))return i;if(this.isLimit(i))return null;i=i.parent}return null}removeDisallowedAttributes(e,t){for(const i of e)if(i.is("$text"))To(this,i,t);else{const e=In._createIn(i),n=e.getPositions();for(const i of n){const e=i.nodeBefore||i.parent;To(this,e,t)}}}createContext(e){return new lo(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,i=Object.keys(t);for(const n of i)e[n]=co(t[n],n);for(const n of i)ho(e,n);for(const n of i)uo(e,n);for(const n of i)mo(e,n);for(const n of i)go(e,n),po(e,n);for(const n of i)fo(e,n),wo(e,n),bo(e,n);this._compiledDefinitions=e}_checkContextMatch(e,t,i=t.length-1){const n=t.getItem(i);if(e.allowIn.includes(n.name)){if(0==i)return!0;{const e=this.getDefinition(n);return this._checkContextMatch(e,t,i-1)}}return!1}*_getValidRangesForRange(e,t){let i=e.start,n=e.start;for(const s of e.getItems({shallow:!0}))s.is("element")&&(yield*this._getValidRangesForRange(In._createIn(s),t)),this.checkAttribute(s,t)||(i.isEqual(n)||(yield new In(i,n)),i=Tn._createAfter(s)),n=Tn._createAfter(s);i.isEqual(n)||(yield new In(i,n))}}(0,I.Z)(ao,Z.Z);class lo{constructor(e){if(e instanceof lo)return e;"string"==typeof e?e=[e]:Array.isArray(e)||(e=e.getAncestors({includeSelf:!0})),this._items=e.map(xo)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new lo([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map((e=>e.name))}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function co(e,t){const i={name:t,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return vo(e,i),_o(e,i,"allowIn"),_o(e,i,"allowContentOf"),_o(e,i,"allowWhere"),_o(e,i,"allowAttributes"),_o(e,i,"allowAttributesOf"),_o(e,i,"allowChildren"),_o(e,i,"inheritTypesFrom"),yo(e,i),i}function ho(e,t){const i=e[t];for(const n of i.allowChildren){const i=e[n];i&&i.allowIn.push(t)}i.allowChildren.length=0}function uo(e,t){for(const i of e[t].allowContentOf)if(e[i]){const n=Co(e,i);n.forEach((e=>{e.allowIn.push(t)}))}delete e[t].allowContentOf}function mo(e,t){for(const i of e[t].allowWhere){const n=e[i];if(n){const i=n.allowIn;e[t].allowIn.push(...i)}}delete e[t].allowWhere}function go(e,t){for(const i of e[t].allowAttributesOf){const n=e[i];if(n){const i=n.allowAttributes;e[t].allowAttributes.push(...i)}}delete e[t].allowAttributesOf}function po(e,t){const i=e[t];for(const n of i.inheritTypesFrom){const t=e[n];if(t){const e=Object.keys(t).filter((e=>e.startsWith("is")));for(const n of e)n in i||(i[n]=t[n])}}delete i.inheritTypesFrom}function fo(e,t){const i=e[t],n=i.allowIn.filter((t=>e[t]));i.allowIn=Array.from(new Set(n))}function wo(e,t){const i=e[t];for(const n of i.allowIn){const i=e[n];i.allowChildren.push(t)}}function bo(e,t){const i=e[t];i.allowAttributes=Array.from(new Set(i.allowAttributes))}function vo(e,t){for(const i of e){const e=Object.keys(i).filter((e=>e.startsWith("is")));for(const n of e)t[n]=i[n]}}function _o(e,t,i){for(const n of e)"string"==typeof n[i]?t[i].push(n[i]):Array.isArray(n[i])&&t[i].push(...n[i])}function yo(e,t){for(const i of e){const e=i.inheritAllFrom;e&&(t.allowContentOf.push(e),t.allowWhere.push(e),t.allowAttributesOf.push(e),t.inheritTypesFrom.push(e))}}function Co(e,t){const i=e[t];return ko(e).filter((e=>e.allowIn.includes(i.name)))}function ko(e){return Object.keys(e).map((t=>e[t]))}function xo(e){return"string"==typeof e||e.is("documentFragment")?{name:"string"==typeof e?e:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute(t){return e.getAttribute(t)}}}function*Ao(e,t){let i=!1;while(!i){if(i=!0,e){const t=e.next();t.done||(i=!1,yield{walker:e,value:t.value})}if(t){const e=t.next();e.done||(i=!1,yield{walker:t,value:e.value})}}}function*Eo(e){for(const t of e)yield*t.getMinimalFlatRanges()}function To(e,t,i){for(const n of t.getAttributeKeys())e.checkAttribute(t,n)||i.removeAttribute(n,t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Po{constructor(e={}){this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.safeInsert=this._safeInsert.bind(this),this.conversionApi.updateConversionResult=this._updateConversionResult.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(e,t,i=["$root"]){this.fire("viewCleanup",e),this._modelCursor=Vo(i,t),this.conversionApi.writer=t,this.conversionApi.consumable=oo.createFrom(e),this.conversionApi.store={};const{modelRange:n}=this._convertItem(e,this._modelCursor),s=t.createDocumentFragment();if(n){this._removeEmptyElements();for(const e of Array.from(this._modelCursor.parent.getChildren()))t.append(e,s);s.markers=So(s,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,s}_convertItem(e,t){const i=Object.assign({viewItem:e,modelCursor:t,modelRange:null});if(e.is("element")?this.fire("element:"+e.name,i,this.conversionApi):e.is("$text")?this.fire("text",i,this.conversionApi):this.fire("documentFragment",i,this.conversionApi),i.modelRange&&!(i.modelRange instanceof In))throw new S.ZP("view-conversion-dispatcher-incorrect-result",this);return{modelRange:i.modelRange,modelCursor:i.modelCursor}}_convertChildren(e,t){let i=t.is("position")?t:Tn._createAt(t,0);const n=new In(i);for(const s of Array.from(e.getChildren())){const e=this._convertItem(s,i);e.modelRange instanceof In&&(n.end=e.modelRange.end,i=e.modelCursor)}return{modelRange:n,modelCursor:i}}_safeInsert(e,t){const i=this._splitToAllowedParent(e,t);return!!i&&(this.conversionApi.writer.insert(e,i.position),!0)}_updateConversionResult(e,t){const i=this._getSplitParts(e),n=this.conversionApi.writer;t.modelRange||(t.modelRange=n.createRange(n.createPositionBefore(e),n.createPositionAfter(i[i.length-1])));const s=this._cursorParents.get(e);t.modelCursor=s?n.createPositionAt(s,0):t.modelRange.end}_splitToAllowedParent(e,t){const{schema:i,writer:n}=this.conversionApi;let s=i.findAllowedParent(t,e);if(s){if(s===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(s)&&(s=null)}if(!s)return Bs(t,e,i)?{position:Ms(t,n)}:null;const o=this.conversionApi.writer.split(t,s),r=[];for(const l of o.range.getWalker())if("elementEnd"==l.type)r.push(l.item);else{const e=r.pop(),t=l.item;this._registerSplitPair(e,t)}const a=o.range.end.parent;return this._cursorParents.set(e,a),{position:o.position,cursorParent:a}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const i=this._splitParts.get(e);this._splitParts.set(t,i),i.push(t)}_getSplitParts(e){let t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}function So(e,t){const i=new Set,n=new Map,s=In._createIn(e).getItems();for(const o of s)"$marker"==o.name&&i.add(o);for(const o of i){const e=o.getAttribute("data-name"),i=t.createPositionBefore(o);n.has(e)?n.get(e).end=i.clone():n.set(e,new In(i.clone())),t.remove(o)}return n}function Vo(e,t){let i;for(const n of new lo(e)){const e={};for(const t of n.getAttributeKeys())e[t]=n.getAttribute(t);const s=t.createElement(n.name,e);i&&t.append(s,i),i=Tn._createAt(s,0)}return i}(0,I.Z)(Po,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Io{getHtml(e){const t=document.implementation.createHTMLDocument(""),i=t.createElement("div");return i.appendChild(e),i.innerHTML}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class No{constructor(e){this.domParser=new DOMParser,this.domConverter=new gi(e,{renderingMode:"data"}),this.htmlWriter=new Io}toData(e){const t=this.domConverter.viewToDom(e,document);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t)}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode="marked"==e?"markedNbsp":"nbsp"}_toDom(e){const t=this.domParser.parseFromString(e,"text/html"),i=t.createDocumentFragment();let n=t.firstChild;while(!n.isSameNode(t.documentElement)){const e=n;n=n.nextSibling,e.nodeType==Node.COMMENT_NODE&&i.appendChild(e)}const s=t.body.childNodes;while(s.length>0)i.appendChild(s[0]);return i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ro{constructor(e,t){this.model=e,this.mapper=new Nn,this.downcastDispatcher=new Bn({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",ss(),{priority:"lowest"}),this.upcastDispatcher=new Po({schema:e.schema}),this.viewDocument=new it(t),this.stylesProcessor=t,this.htmlProcessor=new No(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new bt(this.viewDocument),this.upcastDispatcher.on("text",Fs(),{priority:"lowest"}),this.upcastDispatcher.on("element",Ls(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",Ls(),{priority:"lowest"}),this.decorate("init"),this.decorate("set"),this.decorate("get"),this.on("init",(()=>{this.fire("ready")}),{priority:"lowest"}),this.on("ready",(()=>{this.model.enqueueChange("transparent",Ds)}),{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:i="empty"}=e;if(!this._checkIfRootsExists([t]))throw new S.ZP("datacontroller-get-non-existent-root",this);const n=this.model.document.getRoot(t);return"empty"!==i||this.model.hasContent(n,{ignoreWhitespaces:!0})?this.stringify(n,e):""}stringify(e,t={}){const i=this.toView(e,t);return this.processor.toData(i)}toView(e,t={}){const i=this.viewDocument,n=this._viewWriter;this.mapper.clearBindings();const s=In._createIn(e),o=new ft(i);this.mapper.bindElements(e,o),this.downcastDispatcher.conversionApi.options=t,this.downcastDispatcher.convertInsert(s,n);const r=e.is("documentFragment")?Array.from(e.markers):Do(e);for(const[a,l]of r)this.downcastDispatcher.convertMarkerAdd(a,l,n);return delete this.downcastDispatcher.conversionApi.options,o}init(e){if(this.model.document.version)throw new S.ZP("datacontroller-init-document-not-empty",this);let t={};if("string"===typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new S.ZP("datacontroller-init-non-existent-root",this);return this.model.enqueueChange("transparent",(e=>{for(const i of Object.keys(t)){const n=this.model.document.getRoot(i);e.insert(this.parse(t[i],n),n,0)}})),Promise.resolve()}set(e,t={}){let i={};if("string"===typeof e?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new S.ZP("datacontroller-set-non-existent-root",this);const n=t.batchType||"default";this.model.enqueueChange(n,(e=>{e.setSelection(null),e.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const t of Object.keys(i)){const n=this.model.document.getRoot(t);e.remove(e.createRangeIn(n)),e.insert(this.parse(i[t],n),n,0)}}))}parse(e,t="$root"){const i=this.processor.toView(e);return this.toModel(i,t)}toModel(e,t="$root"){return this.model.change((i=>this.upcastDispatcher.convert(e,i,t)))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRootNames().includes(t))return!1;return!0}}function Do(e){const t=[],i=e.root.document;if(!i)return[];const n=In._createIn(e);for(const s of i.model.markers){const e=s.getRange(),i=e.isCollapsed,o=e.start.isEqual(n.start)||e.end.isEqual(n.end);if(i&&o)t.push([s.name,e]);else{const i=n.getIntersection(e);i&&t.push([s.name,i])}}return t.sort((([e,t],[i,n])=>{if("after"!==t.end.compareWith(n.start))return 1;if("before"!==t.start.compareWith(n.end))return-1;switch(t.start.compareWith(n.start)){case"before":return 1;case"after":return-1;default:switch(t.end.compareWith(n.end)){case"before":return 1;case"after":return-1;default:return i.localeCompare(e)}}}))}(0,I.Z)(Ro,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bo{constructor(e,t){this._helpers=new Map,this._downcast=(0,R.Z)(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=(0,R.Z)(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const i=this._downcast.includes(t),n=this._upcast.includes(t);if(!n&&!i)throw new S.ZP("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:i})}for(e){if(!this._helpers.has(e))throw new S.ZP("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:i}of Mo(e))this.for("upcast").elementToElement({model:t,view:i,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:i}of Mo(e))this.for("upcast").elementToAttribute({view:i,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:i}of Mo(e))this.for("upcast").attributeToAttribute({view:i,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:i}){if(this._helpers.has(e))throw new S.ZP("conversion-group-exists",this);const n=i?new ns(t):new Os(t);this._helpers.set(e,n)}}function*Mo(e){if(e.model.values)for(const t of e.model.values){const i={key:e.model.key,value:t},n=e.view[t],s=e.upcastAlso?e.upcastAlso[t]:void 0;yield*Oo(i,n,s)}else yield*Oo(e.model,e.view,e.upcastAlso)}function*Oo(e,t,i){if(yield{model:e,view:t},i)for(const n of(0,R.Z)(i))yield{model:e,view:n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lo{constructor(e="default"){this.operations=[],this.type=e}get baseVersion(){for(const e of this.operations)if(null!==e.baseVersion)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fo{constructor(e){this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e){return new this(e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zo{constructor(e){this.markers=new Map,this._children=new Cn,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"model:documentFragment"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const i of e)t=t.getChild(t.offsetToIndex(i));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const i of e)i.name?t.push(kn.fromJSON(i)):t.push(_n.fromJSON(i));return new zo(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const i=$o(t);for(const n of i)null!==n.parent&&n._remove(),n.parent=this;this._children._insertNodes(e,i)}_removeChildren(e,t=1){const i=this._children._removeNodes(e,t);for(const n of i)n.parent=null;return i}}function $o(e){return"string"==typeof e?[new _n(e)]:((0,J.Z)(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new _n(e):e instanceof yn?new _n(e.data,e.getAttributes()):e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zo(e,t){t=qo(t);const i=t.reduce(((e,t)=>e+t.offsetSize),0),n=e.parent;jo(e);const s=e.index;return n._insertChild(s,t),Go(n,s+t.length),Go(n,s),new In(e,e.getShiftedBy(i))}function Ho(e){if(!e.isFlat)throw new S.ZP("operation-utils-remove-range-not-flat",this);const t=e.start.parent;jo(e.start),jo(e.end);const i=t._removeChildren(e.start.index,e.end.index-e.start.index);return Go(t,e.start.index),i}function Uo(e,t){if(!e.isFlat)throw new S.ZP("operation-utils-move-range-not-flat",this);const i=Ho(e);return t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),Zo(t,i)}function Wo(e,t,i){jo(e.start),jo(e.end);for(const n of e.getItems({shallow:!0})){const e=n.is("$textProxy")?n.textNode:n;null!==i?e._setAttribute(t,i):e._removeAttribute(t),Go(e.parent,e.index)}Go(e.end.parent,e.end.index)}function qo(e){const t=[];e instanceof Array||(e=[e]);for(let i=0;i<e.length;i++)if("string"==typeof e[i])t.push(new _n(e[i]));else if(e[i]instanceof yn)t.push(new _n(e[i].data,e[i].getAttributes()));else if(e[i]instanceof zo||e[i]instanceof Cn)for(const n of e[i])t.push(n);else e[i]instanceof vn&&t.push(e[i]);for(let i=1;i<t.length;i++){const e=t[i],n=t[i-1];e instanceof _n&&n instanceof _n&&Ko(e,n)&&(t.splice(i-1,2,new _n(n.data+e.data,n.getAttributes())),i--)}return t}function Go(e,t){const i=e.getChild(t-1),n=e.getChild(t);if(i&&n&&i.is("$text")&&n.is("$text")&&Ko(i,n)){const s=new _n(i.data+n.data,i.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,s)}}function jo(e){const t=e.textNode,i=e.parent;if(t){const n=e.offset-t.startOffset,s=t.index;i._removeChildren(s,1);const o=new _n(t.data.substr(0,n),t.getAttributes()),r=new _n(t.data.substr(n),t.getAttributes());i._insertChild(s,[o,r])}}function Ko(e,t){const i=e.getAttributes(),n=t.getAttributes();for(const s of i){if(s[1]!==t.getAttribute(s[0]))return!1;n.next()}return n.next().done}var Jo=i(50576);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yo extends Fo{constructor(e,t,i,n,s){super(s),this.range=e.clone(),this.key=t,this.oldValue=void 0===i?null:i,this.newValue=void 0===n?null:n}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new Yo(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Yo(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new S.ZP("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!(0,Jo.Z)(e.getAttribute(this.key),this.oldValue))throw new S.ZP("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&e.hasAttribute(this.key))throw new S.ZP("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){(0,Jo.Z)(this.oldValue,this.newValue)||Wo(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new Yo(In.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qo extends Fo{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new S.ZP("detach-operation-on-document-node",this)}_execute(){Ho(In._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xo extends Fo{constructor(e,t,i,n){super(n),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,i=this.sourcePosition.offset,n=this.targetPosition.offset;if(i+this.howMany>e.maxOffset)throw new S.ZP("move-operation-nodes-do-not-exist",this);if(e===t&&i<n&&n<i+this.howMany)throw new S.ZP("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==U(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const e=this.sourcePosition.path.length-1;if(this.targetPosition.path[e]>=i&&this.targetPosition.path[e]<i+this.howMany)throw new S.ZP("move-operation-node-into-itself",this)}}_execute(){Uo(In._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const i=Tn.fromJSON(e.sourcePosition,t),n=Tn.fromJSON(e.targetPosition,t);return new this(i,e.howMany,n,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class er extends Fo{constructor(e,t,i){super(i),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Cn(qo(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const e=new Cn([...this.nodes].map((e=>e._clone(!0)))),t=new er(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new Tn(e,[0]);return new Xo(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new S.ZP("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Cn([...e].map((e=>e._clone(!0)))),Zo(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const i=[];for(const s of e.nodes)s.name?i.push(kn.fromJSON(s)):i.push(_n.fromJSON(s));const n=new er(Tn.fromJSON(e.position,t),i,e.baseVersion);return n.shouldReceiveAttributes=e.shouldReceiveAttributes,n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tr extends Fo{constructor(e,t,i,n,s,o){super(o),this.name=e,this.oldRange=t?t.clone():null,this.newRange=i?i.clone():null,this.affectsData=s,this._markers=n}get type(){return"marker"}clone(){return new tr(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new tr(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const e=this.newRange?"_set":"_remove";this._markers[e](this.name,this.newRange,!0,this.affectsData)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new tr(e.name,e.oldRange?In.fromJSON(e.oldRange,t):null,e.newRange?In.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ir extends Fo{constructor(e,t,i,n){super(n),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=i}get type(){return"rename"}clone(){return new ir(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new ir(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(!(e instanceof kn))throw new S.ZP("rename-operation-wrong-position",this);if(e.name!==this.oldName)throw new S.ZP("rename-operation-wrong-name",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new ir(Tn.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nr extends Fo{constructor(e,t,i,n,s){super(s),this.root=e,this.key=t,this.oldValue=i,this.newValue=n}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new nr(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new nr(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new S.ZP("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new S.ZP("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new S.ZP("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new S.ZP("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new nr(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sr extends Fo{constructor(e,t,i,n,s){super(s),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=n.clone()}get type(){return"merge"}get deletionPosition(){return new Tn(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new In(this.sourcePosition,e)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),i=new Tn(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new or(e,this.howMany,i,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new S.ZP("merge-operation-source-position-invalid",this);if(!t.parent)throw new S.ZP("merge-operation-target-position-invalid",this);if(this.howMany!=e.maxOffset)throw new S.ZP("merge-operation-how-many-invalid",this)}_execute(){const e=this.sourcePosition.parent,t=In._createIn(e);Uo(t,this.targetPosition),Uo(In._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const i=Tn.fromJSON(e.sourcePosition,t),n=Tn.fromJSON(e.targetPosition,t),s=Tn.fromJSON(e.graveyardPosition,t);return new this(i,e.howMany,n,s,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class or extends Fo{constructor(e,t,i,n,s){super(s),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=i,this.graveyardPosition=n?n.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new Tn(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new In(this.splitPosition,e)}clone(){return new this.constructor(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new Tn(e,[0]);return new sr(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new S.ZP("split-operation-position-invalid",this);if(!e.parent)throw new S.ZP("split-operation-split-in-root",this);if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new S.ZP("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new S.ZP("split-operation-graveyard-position-invalid",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)Uo(In._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const t=e._clone();Zo(this.insertionPosition,t)}const t=new In(Tn._createAt(e,this.splitPosition.offset),Tn._createAt(e,e.maxOffset));Uo(t,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new Tn(e.root,t,"toPrevious")}static fromJSON(e,t){const i=Tn.fromJSON(e.splitPosition,t),n=Tn.fromJSON(e.insertionPosition,t),s=e.graveyardPosition?Tn.fromJSON(e.graveyardPosition,t):null;return new this(i,e.howMany,n,s,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rr extends kn{constructor(e,t,i="main"){super(t),this._document=e,this.rootName=i}get document(){return this._document}is(e,t){return t?t===this.name&&("rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e):"rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e||"node"===e||"model:node"===e}toJSON(){return this.rootName}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ar{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new _n(e,t)}createElement(e,t){return new kn(e,t)}createDocumentFragment(){return new zo}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,i=0){if(this._assertWriterUsedCorrectly(),e instanceof _n&&""==e.data)return;const n=Tn._createAt(t,i);if(e.parent){if(ur(e.root,n.root))return void this.move(In._createOn(e),n);if(e.root.document)throw new S.ZP("model-writer-insert-forbidden-move",this);this.remove(e)}const s=n.root.document?n.root.document.version:null,o=new er(n,e,s);if(e instanceof _n&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),e instanceof zo)for(const[r,a]of e.markers){const e=Tn._createAt(a.root,0),t=new In(a.start._getCombined(e,n),a.end._getCombined(e,n)),i={range:t,usingOperation:!0,affectsData:!0};this.model.markers.has(r)?this.updateMarker(r,i):this.addMarker(r,i)}}insertText(e,t,i,n){t instanceof zo||t instanceof kn||t instanceof Tn?this.insert(this.createText(e),t,i):this.insert(this.createText(e,t),i,n)}insertElement(e,t,i,n){t instanceof zo||t instanceof kn||t instanceof Tn?this.insert(this.createElement(e),t,i):this.insert(this.createElement(e,t),i,n)}append(e,t){this.insert(e,t,"end")}appendText(e,t,i){t instanceof zo||t instanceof kn?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),i,"end")}appendElement(e,t,i){t instanceof zo||t instanceof kn?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),i,"end")}setAttribute(e,t,i){if(this._assertWriterUsedCorrectly(),i instanceof In){const n=i.getMinimalFlatRanges();for(const i of n)lr(this,e,t,i)}else cr(this,e,t,i)}setAttributes(e,t){for(const[i,n]of Y(e))this.setAttribute(i,n,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof In){const i=t.getMinimalFlatRanges();for(const t of i)lr(this,e,null,t)}else cr(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=e=>{for(const t of e.getAttributeKeys())this.removeAttribute(t,e)};if(e instanceof In)for(const i of e.getItems())t(i);else t(e)}move(e,t,i){if(this._assertWriterUsedCorrectly(),!(e instanceof In))throw new S.ZP("writer-move-invalid-range",this);if(!e.isFlat)throw new S.ZP("writer-move-range-not-flat",this);const n=Tn._createAt(t,i);if(n.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!ur(e.root,n.root))throw new S.ZP("writer-move-different-document",this);const s=e.root.document?e.root.document.version:null,o=new Xo(e.start,e.end.offset-e.start.offset,n,s);this.batch.addOperation(o),this.model.applyOperation(o)}remove(e){this._assertWriterUsedCorrectly();const t=e instanceof In?e:In._createOn(e),i=t.getMinimalFlatRanges().reverse();for(const n of i)this._addOperationForAffectedMarkers("move",n),hr(n.start,n.end.offset-n.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,i=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof kn))throw new S.ZP("writer-merge-no-element-before",this);if(!(i instanceof kn))throw new S.ZP("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,i){return this.model.createPositionFromPath(e,t,i)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(e,t,i){return this.model.createSelection(e,t,i)}_mergeDetached(e){const t=e.nodeBefore,i=e.nodeAfter;this.move(In._createIn(i),Tn._createAt(t,"end")),this.remove(i)}_merge(e){const t=Tn._createAt(e.nodeBefore,"end"),i=Tn._createAt(e.nodeAfter,0),n=e.root.document.graveyard,s=new Tn(n,[0]),o=e.root.document.version,r=new sr(i,e.nodeAfter.maxOffset,t,s,o);this.batch.addOperation(r),this.model.applyOperation(r)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof kn))throw new S.ZP("writer-rename-not-element-instance",this);const i=e.root.document?e.root.document.version:null,n=new ir(Tn._createBefore(e),e.name,t,i);this.batch.addOperation(n),this.model.applyOperation(n)}split(e,t){this._assertWriterUsedCorrectly();let i,n,s=e.parent;if(!s.parent)throw new S.ZP("writer-split-element-no-parent",this);if(t||(t=s.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new S.ZP("writer-split-invalid-limit-element",this);do{const t=s.root.document?s.root.document.version:null,o=s.maxOffset-e.offset,r=or.getInsertionPosition(e),a=new or(e,o,r,null,t);this.batch.addOperation(a),this.model.applyOperation(a),i||n||(i=s,n=e.parent.nextSibling),e=this.createPositionAfter(e.parent),s=e.parent}while(s!==t);return{position:e,range:new In(Tn._createAt(i,"end"),Tn._createAt(n,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new S.ZP("writer-wrap-range-not-flat",this);const i=t instanceof kn?t:new kn(t);if(i.childCount>0)throw new S.ZP("writer-wrap-element-not-empty",this);if(null!==i.parent)throw new S.ZP("writer-wrap-element-attached",this);this.insert(i,e.start);const n=new In(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(n,Tn._createAt(i,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new S.ZP("writer-unwrap-element-no-parent",this);this.move(In._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new S.ZP("writer-addmarker-no-usingoperation",this);const i=t.usingOperation,n=t.range,s=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new S.ZP("writer-addmarker-marker-exists",this);if(!n)throw new S.ZP("writer-addmarker-no-range",this);return i?(dr(this,e,null,n,s),this.model.markers.get(e)):this.model.markers._set(e,n,i,s)}updateMarker(e,t){this._assertWriterUsedCorrectly();const i="string"==typeof e?e:e.name,n=this.model.markers.get(i);if(!n)throw new S.ZP("writer-updatemarker-marker-not-exists",this);if(!t)return void this.model.markers._refresh(n);const s="boolean"==typeof t.usingOperation,o="boolean"==typeof t.affectsData,r=o?t.affectsData:n.affectsData;if(!s&&!t.range&&!o)throw new S.ZP("writer-updatemarker-wrong-options",this);const a=n.getRange(),l=t.range?t.range:a;s&&t.usingOperation!==n.managedUsingOperations?t.usingOperation?dr(this,i,null,l,r):(dr(this,i,a,null,r),this.model.markers._set(i,l,void 0,r)):n.managedUsingOperations?dr(this,i,a,l,r):this.model.markers._set(i,l,void 0,r)}removeMarker(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new S.ZP("writer-removemarker-no-marker",this);const i=this.model.markers.get(t);if(!i.managedUsingOperations)return void this.model.markers._remove(t);const n=i.getRange();dr(this,t,n,null,i.affectsData)}setSelection(e,t,i){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(e,t,i)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"===typeof e)this._setSelectionAttribute(e,t);else for(const[i,n]of Y(e))this._setSelectionAttribute(i,n)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"===typeof e)this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const n=Yn._getStoreAttributeKey(e);this.setAttribute(n,t,i.anchor.parent)}i._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const i=Yn._getStoreAttributeKey(e);this.removeAttribute(i,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new S.ZP("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const n=i.getRange();let s=!1;if("move"===e)s=t.containsPosition(n.start)||t.start.isEqual(n.start)||t.containsPosition(n.end)||t.end.isEqual(n.end);else{const e=t.nodeBefore,i=t.nodeAfter,o=n.start.parent==e&&n.start.isAtEnd,r=n.end.parent==i&&0==n.end.offset,a=n.end.nodeAfter==i,l=n.start.nodeAfter==i;s=o||r||a||l}s&&this.updateMarker(i.name,{range:n})}}}function lr(e,t,i,n){const s=e.model,o=s.document;let r,a,l,c=n.start;for(const h of n.getWalker({shallow:!0}))l=h.item.getAttribute(t),r&&a!=l&&(a!=i&&d(),c=r),r=h.nextPosition,a=l;function d(){const n=new In(c,r),l=n.root.document?o.version:null,d=new Yo(n,t,a,i,l);e.batch.addOperation(d),s.applyOperation(d)}r instanceof Tn&&r!=c&&a!=i&&d()}function cr(e,t,i,n){const s=e.model,o=s.document,r=n.getAttribute(t);let a,l;if(r!=i){const c=n.root===n;if(c){const e=n.document?o.version:null;l=new nr(n,t,r,i,e)}else{a=new In(Tn._createBefore(n),e.createPositionAfter(n));const s=a.root.document?o.version:null;l=new Yo(a,t,r,i,s)}e.batch.addOperation(l),s.applyOperation(l)}}function dr(e,t,i,n,s){const o=e.model,r=o.document,a=new tr(t,i,n,o.markers,s,r.version);e.batch.addOperation(a),o.applyOperation(a)}function hr(e,t,i,n){let s;if(e.root.document){const i=n.document,o=new Tn(i.graveyard,[0]);s=new Xo(e,t,o,i.version)}else s=new Qo(e,t);i.addOperation(s),n.applyOperation(s)}function ur(e,t){return e===t||e instanceof rr&&t instanceof rr}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mr{constructor(e){this._markerCollection=e,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize);const t=In._createOn(e);for(const i of this._markerCollection.getMarkersIntersectingRange(t)){const e=i.getRange();this.bufferMarkerChange(i.name,e,e,i.affectsData)}this._cachedChanges=null}bufferOperation(e){switch(e.type){case"insert":if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const t of e.range.getItems({shallow:!0}))this._isInInsertedElement(t.parent)||this._markAttribute(t);break;case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const t=this._isInInsertedElement(e.sourcePosition.parent),i=this._isInInsertedElement(e.targetPosition.parent);t||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),i||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const t=In._createFromPositionAndShift(e.position,1);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}break}case"split":{const t=e.splitPosition.parent;this._isInInsertedElement(t)||this._markRemove(t,e.splitPosition.offset,e.howMany),this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1);break}case"merge":{const t=e.sourcePosition.parent;this._isInInsertedElement(t.parent)||this._markRemove(t.parent,t.startOffset,1);const i=e.graveyardPosition.parent;this._markInsert(i,e.graveyardPosition.offset,1);const n=e.targetPosition.parent;this._isInInsertedElement(n)||this._markInsert(n,e.targetPosition.offset,t.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(e,t,i,n){const s=this._changedMarkers.get(e);s?(s.newRange=i,s.affectsData=n,null==s.oldRange&&null==s.newRange&&this._changedMarkers.delete(e)):this._changedMarkers.set(e,{oldRange:t,newRange:i,affectsData:n})}getMarkersToRemove(){const e=[];for(const[t,i]of this._changedMarkers)null!=i.oldRange&&e.push({name:t,range:i.oldRange});return e}getMarkersToAdd(){const e=[];for(const[t,i]of this._changedMarkers)null!=i.newRange&&e.push({name:t,range:i.newRange});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map((e=>({name:e[0],data:{oldRange:e[1].oldRange,newRange:e[1].newRange}})))}hasDataChanges(){for(const[,e]of this._changedMarkers)if(e.affectsData)return!0;return this._changesInElement.size>0}getChanges(e={includeChangesInGraveyard:!1}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const i of this._changesInElement.keys()){const e=this._changesInElement.get(i).sort(((e,t)=>e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1)),n=this._elementSnapshots.get(i),s=gr(i.getChildren()),o=pr(n.length,e);let r=0,a=0;for(const l of o)if("i"===l)t.push(this._getInsertDiff(i,r,s[r].name)),r++;else if("r"===l)t.push(this._getRemoveDiff(i,r,n[a].name)),a++;else if("a"===l){const e=s[r].attributes,o=n[a].attributes;let l;if("$text"==s[r].name)l=new In(Tn._createAt(i,r),Tn._createAt(i,r+1));else{const e=i.offsetToIndex(r);l=new In(Tn._createAt(i,r),Tn._createAt(i.getChild(e),0))}t.push(...this._getAttributesDiff(l,o,e)),r++,a++}else r++,a++}t.sort(((e,t)=>e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1));for(let i=1,n=0;i<t.length;i++){const e=t[n],s=t[i],o="remove"==e.type&&"remove"==s.type&&"$text"==e.name&&"$text"==s.name&&e.position.isEqual(s.position),r="insert"==e.type&&"insert"==s.type&&"$text"==e.name&&"$text"==s.name&&e.position.parent==s.position.parent&&e.position.offset+e.length==s.position.offset,a="attribute"==e.type&&"attribute"==s.type&&e.position.parent==s.position.parent&&e.range.isFlat&&s.range.isFlat&&e.position.offset+e.length==s.position.offset&&e.attributeKey==s.attributeKey&&e.attributeOldValue==s.attributeOldValue&&e.attributeNewValue==s.attributeNewValue;o||r||a?(e.length++,a&&(e.range.end=e.range.end.getShiftedBy(1)),t[i]=null):n=i}t=t.filter((e=>e));for(const i of t)delete i.changeCount,"attribute"==i.type&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t.slice(),this._cachedChanges=t.filter(fr),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(e,t,i){const n={type:"insert",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,n)}_markRemove(e,t,i){const n={type:"remove",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,n),this._removeAllNestedChanges(e,t,i)}_markAttribute(e){const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const i=this._getChangesForElement(e);this._handleChange(t,i),i.push(t);for(let n=0;n<i.length;n++)i[n].howMany<1&&(i.splice(n,1),n--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,gr(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const i of t){const n=e.offset+e.howMany,s=i.offset+i.howMany;if("insert"==e.type&&("insert"==i.type&&(e.offset<=i.offset?i.offset+=e.howMany:e.offset<s&&(i.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==i.type&&e.offset<i.offset&&(i.offset+=e.howMany),"attribute"==i.type))if(e.offset<=i.offset)i.offset+=e.howMany;else if(e.offset<s){const s=i.howMany;i.howMany=e.offset-i.offset,t.unshift({type:"attribute",offset:n,howMany:s-i.howMany,count:this._changeCount++})}if("remove"==e.type){if("insert"==i.type)if(n<=i.offset)i.offset-=e.howMany;else if(n<=s)if(e.offset<i.offset){const t=n-i.offset;i.offset=e.offset,i.howMany-=t,e.nodesToHandle-=t}else i.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=i.offset)e.nodesToHandle-=i.howMany,i.howMany=0;else if(e.offset<s){const t=s-e.offset;i.howMany-=t,e.nodesToHandle-=t}if("remove"==i.type&&(n<=i.offset?i.offset-=e.howMany:e.offset<i.offset&&(e.nodesToHandle+=i.howMany,i.howMany=0)),"attribute"==i.type)if(n<=i.offset)i.offset-=e.howMany;else if(e.offset<i.offset){const t=n-i.offset;i.offset=e.offset,i.howMany-=t}else if(e.offset<s)if(n<=s){const n=i.howMany;i.howMany=e.offset-i.offset;const s=n-i.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:s,count:this._changeCount++})}else i.howMany-=s-e.offset}if("attribute"==e.type){if("insert"==i.type)if(e.offset<i.offset&&n>i.offset){if(n>s){const e={type:"attribute",offset:s,howMany:n-s,count:this._changeCount++};this._handleChange(e,t),t.push(e)}e.nodesToHandle=i.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=i.offset&&e.offset<s&&(n>s?(e.nodesToHandle=n-s,e.offset=s):e.nodesToHandle=0);if("remove"==i.type&&e.offset<i.offset&&n>i.offset){const s={type:"attribute",offset:i.offset,howMany:n-i.offset,count:this._changeCount++};this._handleChange(s,t),t.push(s),e.nodesToHandle=i.offset-e.offset,e.howMany=e.nodesToHandle}"attribute"==i.type&&(e.offset>=i.offset&&n<=s?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=i.offset&&n>=s&&(i.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,i){return{type:"insert",position:Tn._createAt(e,t),name:i,length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,t,i){return{type:"remove",position:Tn._createAt(e,t),name:i,length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,i){const n=[];i=new Map(i);for(const[s,o]of t){const t=i.has(s)?i.get(s):null;t!==o&&n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:s,attributeOldValue:o,attributeNewValue:t,changeCount:this._changeCount++}),i.delete(s)}for(const[s,o]of i)n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:s,attributeOldValue:null,attributeNewValue:o,changeCount:this._changeCount++});return n}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const i=this._changesInElement.get(t),n=e.startOffset;if(i)for(const s of i)if("insert"==s.type&&n>=s.offset&&n<s.offset+s.howMany)return!0;return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,i){const n=new In(Tn._createAt(e,t),Tn._createAt(e,t+i));for(const s of n.getItems({shallow:!0}))s.is("element")&&(this._elementSnapshots.delete(s),this._changesInElement.delete(s),this._removeAllNestedChanges(s,0,s.maxOffset))}}function gr(e){const t=[];for(const i of e)if(i.is("$text"))for(let e=0;e<i.data.length;e++)t.push({name:"$text",attributes:new Map(i.getAttributes())});else t.push({name:i.name,attributes:new Map(i.getAttributes())});return t}function pr(e,t){const i=[];let n=0,s=0;for(const o of t){if(o.offset>n){for(let e=0;e<o.offset-n;e++)i.push("e");s+=o.offset-n}if("insert"==o.type){for(let e=0;e<o.howMany;e++)i.push("i");n=o.offset+o.howMany}else if("remove"==o.type){for(let e=0;e<o.howMany;e++)i.push("r");n=o.offset,s+=o.howMany}else i.push(..."a".repeat(o.howMany).split("")),n=o.offset+o.howMany,s+=o.howMany}if(s<e)for(let o=0;o<e-s-n;o++)i.push("e");return i}function fr(e){const t=e.position&&"$graveyard"==e.position.root.rootName,i=e.range&&"$graveyard"==e.range.root.rootName;return!t&&!i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wr{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(e){this._operations.includes(e)||this._operations.push(e)}getOperations(e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY){const i=[];for(const n of this._operations)n.baseVersion>=e&&n.baseVersion<t&&i.push(n);return i}getOperation(e){for(const t of this._operations)if(t.baseVersion==e)return t}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function br(e){return!!e&&1==e.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(e)}function vr(e){return!!e&&1==e.length&&/[\ud800-\udbff]/.test(e)}function _r(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e)}function yr(e,t){return vr(e.charAt(t-1))&&_r(e.charAt(t))}function Cr(e,t){return br(e.charAt(t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const kr="$graveyard";class xr{constructor(e){this.model=e,this.version=0,this.history=new wr(this),this.selection=new Yn(this),this.roots=new P.Z({idProperty:"rootName"}),this.differ=new mr(e.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",kr),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];if(i.isDocumentOperation&&i.baseVersion!==this.version)throw new S.ZP("model-document-applyoperation-wrong-version",this,{operation:i})}),{priority:"highest"}),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&this.differ.bufferOperation(i)}),{priority:"high"}),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&(this.version++,this.history.addOperation(i))}),{priority:"low"}),this.listenTo(this.selection,"change",(()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0})),this.listenTo(e.markers,"update",((e,t,i,n)=>{this.differ.bufferMarkerChange(t.name,i,n,t.affectsData),null===i&&t.on("change",((e,i)=>{this.differ.bufferMarkerChange(t.name,i,t.getRange(),t.affectsData)}))}))}get graveyard(){return this.getRoot(kr)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new S.ZP("model-document-createroot-name-exists",this,{name:t});const i=new rr(this,e,t);return this.roots.add(i),i}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(){return Array.from(this.roots,(e=>e.rootName)).filter((e=>e!=kr))}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=(0,W.Z)(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const e of this.roots)if(e!==this.graveyard)return e;return this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,i=t.schema,n=t.createPositionFromPath(e,[0]),s=i.getNearestSelectionRange(n);return s||t.createRange(n)}_validateSelectionRange(e){return Ar(e.start)&&Ar(e.end)}_callPostFixers(e){let t=!1;do{for(const i of this._postFixers)if(this.selection.refresh(),t=i(e),t)break}while(t)}}function Ar(e){const t=e.textNode;if(t){const i=t.data,n=e.offset-t.startOffset;return!yr(i,n)&&!Cr(i,n)}return!0}(0,I.Z)(xr,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Er{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof Tr?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,i=!1,n=!1){const s=e instanceof Tr?e.name:e;if(s.includes(","))throw new S.ZP("markercollection-incorrect-marker-name",this);const o=this._markers.get(s);if(o){const e=o.getRange();let r=!1;return e.isEqual(t)||(o._attachLiveRange(qn.fromRange(t)),r=!0),i!=o.managedUsingOperations&&(o._managedUsingOperations=i,r=!0),"boolean"===typeof n&&n!=o.affectsData&&(o._affectsData=n,r=!0),r&&this.fire("update:"+s,o,e,t),o}const r=qn.fromRange(t),a=new Tr(s,r,i,n);return this._markers.set(s,a),this.fire("update:"+s,a,null,t),a}_remove(e){const t=e instanceof Tr?e.name:e,i=this._markers.get(t);return!!i&&(this._markers.delete(t),this.fire("update:"+t,i,i.getRange(),null),this._destroyMarker(i),!0)}_refresh(e){const t=e instanceof Tr?e.name:e,i=this._markers.get(t);if(!i)throw new S.ZP("markercollection-refresh-marker-not-exists",this);const n=i.getRange();this.fire("update:"+t,i,n,n,i.managedUsingOperations,i.affectsData)}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)null!==t.getRange().getIntersection(e)&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}(0,I.Z)(Er,V.ZP);class Tr{constructor(e,t,i,n){this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=i,this._affectsData=n}get managedUsingOperations(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._affectsData}getStart(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._liveRange.toRange()}is(e){return"marker"===e||"model:marker"===e}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}(0,I.Z)(Tr,V.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pr extends Fo{get type(){return"noop"}clone(){return new Pr(this.baseVersion)}getReversed(){return new Pr(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Sr={};Sr[Yo.className]=Yo,Sr[er.className]=er,Sr[tr.className]=tr,Sr[Xo.className]=Xo,Sr[Pr.className]=Pr,Sr[Fo.className]=Fo,Sr[ir.className]=ir,Sr[nr.className]=nr,Sr[or.className]=or,Sr[sr.className]=sr;class Vr{static fromJSON(e,t){return Sr[e.__className].fromJSON(e,t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ir extends Tn{constructor(e,t,i="toNone"){if(super(e,t,i),!this.root.is("rootElement"))throw new S.ZP("model-liveposition-root-not-rootelement",e);Nr.call(this)}detach(){this.stopListening()}is(e){return"livePosition"===e||"model:livePosition"===e||"position"==e||"model:position"===e}toPosition(){return new Tn(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}function Nr(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&Rr.call(this,i)}),{priority:"low"})}function Rr(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dr(e,t,i,n){return e.change((s=>{let o;o=i?i instanceof zn||i instanceof Yn?i:s.createSelection(i,n):e.document.selection,o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0});const r=new Br(e,s,o.anchor);let a;a=t.is("documentFragment")?t.getChildren():[t],r.handleNodes(a);const l=r.getSelectionRange();l&&(o instanceof Yn?s.setSelection(l):o.setTo(l));const c=r.getAffectedRange()||e.createRange(o.anchor);return r.destroy(),c}))}(0,I.Z)(Ir,V.ZP);class Br{constructor(e,t,i){this.model=e,this.writer=t,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0),this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(e);if(i.isAfter(t)){if(this._lastNode=e,this.position.parent!=e||!this.position.isAtEnd)throw new S.ZP("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this.nodeToSelect?In._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new In(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(this.schema.isObject(e))return void this._handleObject(e);let t=this._checkAndAutoParagraphToAllowedPosition(e);t||(t=this._checkAndSplitToAllowedPosition(e),t)?(this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e):this._handleDisallowedNode(e)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=Ir.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleObject(e){this._checkAndSplitToAllowedPosition(e)?this._appendToFragment(e):this._tryAutoparagraphing(e)}_handleDisallowedNode(e){e.is("element")?this.handleNodes(e.getChildren()):this._tryAutoparagraphing(e)}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new S.ZP("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=e:this.nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=Ir.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Ir.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof kn))return;if(!this._canMergeLeft(e))return;const t=Ir._createBefore(e);t.stickiness="toNext";const i=Ir.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=Ir._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=Ir._createAt(t.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof kn))return;if(!this._canMergeRight(e))return;const t=Ir._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new S.ZP("insertcontent-invalid-insertion-position",this);this.position=Tn._createAt(t.nodeBefore,"end");const i=Ir.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=Ir._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=Ir._createAt(t.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof kn&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof kn&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_tryAutoparagraphing(e){const t=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,t)&&this.schema.checkChild(t,e)&&(t._appendChild(e),this._handleNode(t))}_checkAndAutoParagraphToAllowedPosition(e){if(this.schema.checkChild(this.position.parent,e))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",e))return!1;this._insertPartialFragment();const t=this.writer.createElement("paragraph");return this.writer.insert(t,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=t,this.position=this.writer.createPositionAt(t,0),!0}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;t!=this.position.parent&&this._insertPartialFragment();while(t!=this.position.parent)if(this.position.isAtStart){const e=this.position.parent;this.position=this.writer.createPositionBefore(e),e.isEmpty&&e.parent===t&&this.writer.remove(e)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const e=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=e,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Mr(e,t,i={}){if(t.isCollapsed)return;const n=t.getFirstRange();if("$graveyard"==n.root.rootName)return;const s=e.schema;e.change((e=>{if(!i.doNotResetEntireContent&&Kr(s,t))return void jr(e,t,s);const[o,r]=Or(n);o.isTouching(r)||e.remove(e.createRange(o,r)),i.leaveUnmerged||(Fr(e,o,r),s.removeDisallowedAttributes(o.parent.getChildren(),e)),Jr(e,t,o),!i.doNotAutoparagraph&&Wr(s,o)&&Gr(e,o,t),o.detach(),r.detach()}))}function Or(e){const t=e.root.document.model,i=e.start;let n=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const i=Lr(n);if(i&&n.isTouching(t.createPositionAt(i,0))){const i=t.createSelection(e);t.modifySelection(i,{direction:"backward"});const s=i.getLastPosition(),o=t.createRange(s,n);t.hasContent(o,{ignoreMarkers:!0})||(n=s)}}return[Ir.fromPosition(i,"toPrevious"),Ir.fromPosition(n,"toNext")]}function Lr(e){const t=e.parent,i=t.root.document.model.schema,n=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const s of n){if(i.isLimit(s))return null;if(i.isBlock(s))return s}}function Fr(e,t,i){const n=e.model;if(!Hr(e.model.schema,t,i))return;const[s,o]=Ur(t,i);s&&o&&(!n.hasContent(s,{ignoreMarkers:!0})&&n.hasContent(o,{ignoreMarkers:!0})?$r(e,t,i,s.parent):zr(e,t,i,s.parent))}function zr(e,t,i,n){const s=t.parent,o=i.parent;if(s!=n&&o!=n){t=e.createPositionAfter(s),i=e.createPositionBefore(o),i.isEqual(t)||e.insert(o,t),e.merge(t);while(i.parent.isEmpty){const t=i.parent;i=e.createPositionBefore(t),e.remove(t)}Hr(e.model.schema,t,i)&&zr(e,t,i,n)}}function $r(e,t,i,n){const s=t.parent,o=i.parent;if(s!=n&&o!=n){t=e.createPositionAfter(s),i=e.createPositionBefore(o),i.isEqual(t)||e.insert(s,i);while(t.parent.isEmpty){const i=t.parent;t=e.createPositionBefore(i),e.remove(i)}i=e.createPositionBefore(o),Zr(e,i),Hr(e.model.schema,t,i)&&$r(e,t,i,n)}}function Zr(e,t){const i=t.nodeBefore,n=t.nodeAfter;i.name!=n.name&&e.rename(i,n.name),e.clearAttributes(i),e.setAttributes(Object.fromEntries(n.getAttributes()),i),e.merge(t)}function Hr(e,t,i){const n=t.parent,s=i.parent;return n!=s&&(!e.isLimit(n)&&!e.isLimit(s)&&qr(t,i,e))}function Ur(e,t){const i=e.getAncestors(),n=t.getAncestors();let s=0;while(i[s]&&i[s]==n[s])s++;return[i[s],n[s]]}function Wr(e,t){const i=e.checkChild(t,"$text"),n=e.checkChild(t,"paragraph");return!i&&n}function qr(e,t,i){const n=new In(e,t);for(const s of n.getWalker())if(i.isLimit(s.item))return!1;return!0}function Gr(e,t,i){const n=e.createElement("paragraph");e.insert(n,t),Jr(e,i,e.createPositionAt(n,0))}function jr(e,t){const i=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(i)),Gr(e,e.createPositionAt(i,0),t)}function Kr(e,t){const i=e.getLimitElement(t);if(!t.containsEntireContent(i))return!1;const n=t.getFirstRange();return n.start.parent!=n.end.parent&&e.checkChild(i,"paragraph")}function Jr(e,t,i){t instanceof Yn?e.setSelection(i):t.setTo(i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yr=' ,.?!:;"-()';function Qr(e,t,i={}){const n=e.schema,s="backward"!=i.direction,o=i.unit?i.unit:"character",r=t.focus,a=new An({boundaries:ia(r,s),singleCharacters:!0,direction:s?"forward":"backward"}),l={walker:a,schema:n,isForward:s,unit:o};let c;while(c=a.next()){if(c.done)return;const i=Xr(l,c.value);if(i)return void(t instanceof Yn?e.change((e=>{e.setSelectionFocus(i)})):t.setFocus(i))}}function Xr(e,t){const{isForward:i,walker:n,unit:s,schema:o}=e,{type:r,item:a,nextPosition:l}=t;if("text"==r)return"word"===e.unit?ta(n,i):ea(n,s,i);if(r==(i?"elementStart":"elementEnd")){if(o.isSelectable(a))return Tn._createAt(a,i?"after":"before");if(o.checkChild(l,"$text"))return l}else{if(o.isLimit(a))return void n.skip((()=>!0));if(o.checkChild(l,"$text"))return l}}function ea(e,t){const i=e.position.textNode;if(i){const n=i.data;let s=e.position.offset-i.startOffset;while(yr(n,s)||"character"==t&&Cr(n,s))e.next(),s=e.position.offset-i.startOffset}return e.position}function ta(e,t){let i=e.position.textNode;if(i){let n=e.position.offset-i.startOffset;while(!na(i.data,n,t)&&!sa(i,n,t)){e.next();const s=t?e.position.nodeAfter:e.position.nodeBefore;if(s&&s.is("$text")){const n=s.data.charAt(t?0:s.data.length-1);Yr.includes(n)||(e.next(),i=e.position.textNode)}n=e.position.offset-i.startOffset}}return e.position}function ia(e,t){const i=e.root,n=Tn._createAt(i,t?"end":0);return t?new In(e,n):new In(n,e)}function na(e,t,i){const n=t+(i?0:-1);return Yr.includes(e.charAt(n))}function sa(e,t,i){return t===(i?e.endOffset:0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function oa(e,t){return e.change((e=>{const i=e.createDocumentFragment(),n=t.getFirstRange();if(!n||n.isCollapsed)return i;const s=n.start.root,o=n.start.getCommonPath(n.end),r=s.getNodeByPath(o);let a;a=n.start.parent==n.end.parent?n:e.createRange(e.createPositionAt(r,n.start.path[o.length]),e.createPositionAt(r,n.end.path[o.length]+1));const l=a.end.offset-a.start.offset;for(const t of a.getItems({shallow:!0}))t.is("$textProxy")?e.appendText(t.data,t.getAttributes(),i):e.append(e.cloneElement(t,!0),i);if(a!=n){const t=n._getTransformedByMove(a.start,e.createPositionAt(i,0),l)[0],s=e.createRange(e.createPositionAt(i,0),t.start),o=e.createRange(t.end,e.createPositionAt(i,"end"));ra(o,e),ra(s,e)}return i}))}function ra(e,t){const i=[];Array.from(e.getItems({direction:"backward"})).map((e=>t.createRangeOn(e))).filter((t=>{const i=(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end));return i})).forEach((e=>{i.push(e.start.parent),t.remove(e)})),i.forEach((e=>{let i=e;while(i.parent&&i.isEmpty){const e=t.createRangeOn(i);i=i.parent,t.remove(e)}}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function aa(e){e.document.registerPostFixer((t=>la(t,e)))}function la(e,t){const i=t.document.selection,n=t.schema,s=[];let o=!1;for(const r of i.getRanges()){const e=ca(r,n);e&&!e.isEqual(r)?(s.push(e),o=!0):s.push(r)}o&&e.setSelection(ga(s),{backward:i.isBackward})}function ca(e,t){return e.isCollapsed?da(e,t):ha(e,t)}function da(e,t){const i=e.start,n=t.getNearestSelectionRange(i);if(!n){const e=i.getAncestors().reverse().find((e=>t.isObject(e)));return e?In._createOn(e):null}if(!n.isCollapsed)return n;const s=n.start;return i.isEqual(s)?null:new In(s)}function ha(e,t){const{start:i,end:n}=e,s=t.checkChild(i,"$text"),o=t.checkChild(n,"$text"),r=t.getLimitElement(i),a=t.getLimitElement(n);if(r===a){if(s&&o)return null;if(ma(i,n,t)){const e=i.nodeAfter&&t.isSelectable(i.nodeAfter),s=e?null:t.getNearestSelectionRange(i,"forward"),o=n.nodeBefore&&t.isSelectable(n.nodeBefore),r=o?null:t.getNearestSelectionRange(n,"backward"),a=s?s.start:i,l=r?r.end:n;return new In(a,l)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const e=i.nodeAfter&&n.nodeBefore&&i.nodeAfter.parent===n.nodeBefore.parent,s=l&&(!e||!pa(i.nodeAfter,t)),o=c&&(!e||!pa(n.nodeBefore,t));let d=i,h=n;return s&&(d=Tn._createBefore(ua(r,t))),o&&(h=Tn._createAfter(ua(a,t))),new In(d,h)}return null}function ua(e,t){let i=e,n=i;while(t.isLimit(n)&&n.parent)i=n,n=n.parent;return i}function ma(e,t,i){const n=e.nodeAfter&&!i.isLimit(e.nodeAfter)||i.checkChild(e,"$text"),s=t.nodeBefore&&!i.isLimit(t.nodeBefore)||i.checkChild(t,"$text");return n||s}function ga(e){const t=[...e],i=new Set;let n=1;while(n<t.length){const e=t[n],s=t.slice(0,n);for(const[o,r]of s.entries())if(!i.has(o))if(e.isEqual(r))i.add(o);else if(e.isIntersecting(r)){i.add(o),i.add(n);const s=e.getJoined(r);t.push(s)}n++}const s=t.filter(((e,t)=>!i.has(t)));return s}function pa(e,t){return e&&t.isSelectable(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fa{constructor(){this.markers=new Er,this.document=new xr(this),this.schema=new ao,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach((e=>this.decorate(e))),this.on("applyOperation",((e,t)=>{const i=t[0];i._validate()}),{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(((e,t)=>{if("$marker"===t.name)return!0})),aa(this),this.document.registerPostFixer(Ds)}change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new Lo,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){S.ZP.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{"string"===typeof e?e=new Lo(e):"function"==typeof e&&(t=e,e=new Lo),this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(i){S.ZP.rethrowUnexpectedError(i,this)}}applyOperation(e){e._execute()}insertContent(e,t,i){return Dr(this,e,t,i)}deleteContent(e,t){Mr(this,e,t)}modifySelection(e,t){Qr(this,e,t)}getSelectedContent(e){return oa(this,e)}hasContent(e,t={}){const i=e instanceof kn?In._createIn(e):e;if(i.isCollapsed)return!1;const{ignoreWhitespaces:n=!1,ignoreMarkers:s=!1}=t;if(!s)for(const o of this.markers.getMarkersIntersectingRange(i))if(o.affectsData)return!0;for(const o of i.getItems())if(this.schema.isContent(o)){if(!o.is("$textProxy"))return!0;if(!n)return!0;if(-1!==o.data.search(/\S/))return!0}return!1}createPositionFromPath(e,t,i){return new Tn(e,t,i)}createPositionAt(e,t){return Tn._createAt(e,t)}createPositionAfter(e){return Tn._createAfter(e)}createPositionBefore(e){return Tn._createBefore(e)}createRange(e,t){return new In(e,t)}createRangeIn(e){return In._createIn(e)}createRangeOn(e){return In._createOn(e)}createSelection(e,t,i){return new zn(e,t,i)}createBatch(e){return new Lo(e)}createOperationFromJSON(e){return Vr.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");while(this._pendingChanges.length){const t=this._pendingChanges[0].batch;this._currentWriter=new ar(this,t);const i=this._pendingChanges[0].callback(this._currentWriter);e.push(i),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),e}}(0,I.Z)(fa,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wa extends tn{constructor(e){super(),this.editor=e}set(e,t,i={}){if("string"==typeof t){const e=t;t=(t,i)=>{this.editor.execute(e),i()}}super.set(e,t,i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ba{constructor(e={}){const t=e.language||this.constructor.defaultConfig&&this.constructor.defaultConfig.language;this._context=e.context||new $({language:t}),this._context._addEditor(this,!e.context);const i=Array.from(this.constructor.builtinPlugins||[]);this.config=new A(e,this.constructor.defaultConfig),this.config.define("plugins",i),this.config.define(this._context._getEditorConfig()),this.plugins=new N(this,i,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new so,this.set("state","initializing"),this.once("ready",(()=>this.state="ready"),{priority:"high"}),this.once("destroy",(()=>this.state="destroyed"),{priority:"high"}),this.set("isReadOnly",!1),this.model=new fa;const n=new Ee;this.data=new Ro(this.model,n),this.editing=new no(this.model,n),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Bo([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new wa(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const e=this.config,t=e.get("plugins"),i=e.get("removePlugins")||[],n=e.get("extraPlugins")||[],s=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(n),i,s)}destroy(){let e=Promise.resolve();return"initializing"==this.state&&(e=new Promise((e=>this.once("ready",e)))),e.then((()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()})).then((()=>this.plugins.destroy())).then((()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()})).then((()=>this._context._removeEditor(this)))}execute(...e){try{return this.commands.execute(...e)}catch(t){S.ZP.rethrowUnexpectedError(t,this)}}focus(){this.editing.view.focus()}}(0,I.Z)(ba,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class va{constructor(e){this.editor=e,this._components=new Map}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(_a(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new S.ZP("componentfactory-item-missing",this,{name:e});return this._components.get(_a(e)).callback(this.editor.locale)}has(e){return this._components.has(_a(e))}}function _a(e){return String(e).toLowerCase()}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ya{constructor(e){this.editor=e,this.componentFactory=new va(e),this.focusTracker=new en,this.set("viewportOffset",this._readViewportOffsetFromConfig()),this._editableElementsMap=new Map,this.listenTo(e.editing.view.document,"layoutChanged",(()=>this.update()))}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const i=e.config.get("toolbar.viewportTopOffset");return i?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:i}):{top:0}}}(0,I.Z)(ya,Z.Z);var Ca=i(73234);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ka(e){if(!(0,Ca.Z)(e.updateSourceElement))throw new S.ZP("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(t&&"textarea"===t.tagName.toLowerCase()&&t.form){let i;const n=t.form,s=()=>e.updateSourceElement();(0,Ca.Z)(n.submit)&&(i=n.submit,n.submit=()=>{s(),i.apply(n)}),n.addEventListener("submit",s),e.on("destroy",(()=>{n.removeEventListener("submit",s),i&&(n.submit=i)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xa={setData(e){this.data.set(e)},getData(e){return this.data.get(e)}};var Aa=xa;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ea(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ta={updateSourceElement(){if(!this.sourceElement)throw new S.ZP("editor-missing-sourceelement",this);Ea(this.sourceElement,this.data.get())}};var Pa=Ta;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sa extends H{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new P.Z({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if("string"!==typeof e)throw new S.ZP("pendingactions-add-invalid-message",this);const t=Object.create(Z.Z);return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var Va='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',Ia='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',Na='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',Ra='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',Da='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',Ba='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',Ma='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',Oa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',La='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',Fa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',za='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',$a='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',Za='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',Ha='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',Ua='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Wa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',qa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',Ga='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',ja='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ka='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ja='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',Ya='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',Qa='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',Xa='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',el='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',tl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',il='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',nl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',sl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ol={cancel:Va,caption:Ia,check:Na,cog:Ra,eraser:Da,lowVision:Ba,image:Ma,alignBottom:Oa,alignMiddle:La,alignTop:Fa,alignLeft:za,alignCenter:$a,alignRight:Za,alignJustify:Ha,objectLeft:Ka,objectCenter:Wa,objectRight:Ja,objectFullWidth:Ga,objectInline:ja,objectBlockLeft:Ua,objectBlockRight:qa,objectSizeFull:Ya,objectSizeLarge:Qa,objectSizeSmall:Xa,objectSizeMedium:el,pencil:tl,pilcrow:il,quote:nl,threeVerticalDots:sl};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rl{constructor(){const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=e=>{this.loaded=e.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise(((i,n)=>{t.onload=()=>{const e=t.result;this._data=e,i(e)},t.onerror=()=>{n("error")},t.onabort=()=>{n("aborted")},this._reader.readAsDataURL(e)}))}abort(){this._reader.abort()}}(0,I.Z)(rl,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class al extends a.Z{static get pluginName(){return"FileRepository"}static get requires(){return[Sa]}init(){this.loaders=new P.Z,this.loaders.on("add",(()=>this._updatePendingAction())),this.loaders.on("remove",(()=>this._updatePendingAction())),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0))}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return(0,S.KE)("filerepository-no-upload-adapter"),null;const t=new ll(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then((e=>{this._loadersMap.set(e,t)})).catch((()=>{})),t.on("change:uploaded",(()=>{let e=0;for(const t of this.loaders)e+=t.uploaded;this.uploaded=e})),t.on("change:uploadTotal",(()=>{let e=0;for(const t of this.loaders)t.uploadTotal&&(e+=t.uploadTotal);this.uploadTotal=e})),t}destroyLoader(e){const t=e instanceof ll?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach(((e,i)=>{e===t&&this._loadersMap.delete(i)}))}_updatePendingAction(){const e=this.editor.plugins.get(Sa);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,i=e=>`${t("Upload in progress")} ${parseInt(e)}%.`;this._pendingAction=e.add(i(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",i)}}else e.remove(this._pendingAction),this._pendingAction=null}}(0,I.Z)(al,Z.Z);class ll{constructor(e,t){this.id=(0,sn.Z)(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new rl,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0)),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then((e=>this._filePromiseWrapper?e:null)):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new S.ZP("filerepository-read-wrong-status",this);return this.status="reading",this.file.then((e=>this._reader.read(e))).then((e=>{if("reading"!==this.status)throw this.status;return this.status="idle",e})).catch((e=>{if("aborted"===e)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:e}))}upload(){if("idle"!=this.status)throw new S.ZP("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then((()=>this._adapter.upload())).then((e=>(this.uploadResponse=e,this.status="idle",e))).catch((e=>{if("aborted"===this.status)throw"aborted";throw this.status="error",e}))}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==e?this._reader.abort():"uploading"==e&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch((()=>{})),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise(((i,n)=>{t.rejecter=n,t.isFulfilled=!1,e.then((e=>{t.isFulfilled=!0,i(e)})).catch((e=>{t.isFulfilled=!0,n(e)}))})),t}}(0,I.Z)(ll,Z.Z);var cl=i(52612);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dl extends cl.Z{constructor(e){super(e),this.buttonView=new l.Z(e),this._fileInputView=new hl(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",(()=>{this._fileInputView.open()}))}focus(){this.buttonView.focus()}}class hl extends cl.Z{constructor(e){super(e),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to((()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""}))}})}open(){this.element.click()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
i(23767),i(8585),i(68696);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ul="ckCsrfToken",ml=40,gl="abcdefghijklmnopqrstuvwxyz0123456789";function pl(){let e=fl(ul);return e&&e.length==ml||(e=bl(ml),wl(ul,e)),e}function fl(e){e=e.toLowerCase();const t=document.cookie.split(";");for(const i of t){const t=i.split("="),n=decodeURIComponent(t[0].trim().toLowerCase());if(n===e)return decodeURIComponent(t[1])}return null}function wl(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"}function bl(e){let t="";const i=new Uint8Array(e);window.crypto.getRandomValues(i);for(let n=0;n<i.length;n++){const e=gl.charAt(i[n]%gl.length);t+=Math.random()>.5?e.toUpperCase():e}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vl extends a.Z{static get requires(){return[al]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(al).createUploadAdapter=t=>new _l(t,e,this.editor.t))}}class _l{constructor(e,t,i){this.loader=e,this.url=t,this.t=i}upload(){return this.loader.file.then((e=>new Promise(((t,i)=>{this._initRequest(),this._initListeners(t,i,e),this._sendRequest(e)}))))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.url,!0),e.responseType="json"}_initListeners(e,t,i){const n=this.xhr,s=this.loader,o=this.t,r=o("Cannot upload file:")+` ${i.name}.`;n.addEventListener("error",(()=>t(r))),n.addEventListener("abort",(()=>t())),n.addEventListener("load",(()=>{const i=n.response;if(!i||!i.uploaded)return t(i&&i.error&&i.error.message?i.error.message:r);e({default:i.url})})),n.upload&&n.upload.addEventListener("progress",(e=>{e.lengthComputable&&(s.uploadTotal=e.total,s.uploaded=e.loaded)}))}_sendRequest(e){const t=new FormData;t.append("upload",e),t.append("ckCsrfToken",pl()),this.xhr.send(t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const yl=["left","right","center","justify"];function Cl(e){return yl.includes(e)}function kl(e,t){return"rtl"==t.contentLanguageDirection?"right"===e:"left"===e}function xl(e){const t=e.map((e=>{let t;return t="string"==typeof e?{name:e}:e,t})).filter((e=>{const t=!!yl.includes(e.name);return t||(0,S.KE)("alignment-config-name-not-recognized",{option:e}),t})),i=t.filter((e=>!!e.className)).length;if(i&&i<t.length)throw new S.ZP("alignment-config-classnames-are-missing",{configuredOptions:e});return t.forEach(((t,i,n)=>{const s=n.slice(i+1),o=s.some((e=>e.name==t.name));if(o)throw new S.ZP("alignment-config-name-already-defined",{option:t,configuredOptions:e});if(t.className){const i=s.some((e=>e.className==t.className));if(i)throw new S.ZP("alignment-config-classname-already-defined",{option:t,configuredOptions:e})}})),t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Al="alignment";class El extends b.Z{refresh(){const e=this.editor,t=e.locale,i=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!i&&this._canBeAligned(i),this.isEnabled&&i.hasAttribute("alignment")?this.value=i.getAttribute("alignment"):this.value="rtl"===t.contentLanguageDirection?"right":"left"}execute(e={}){const t=this.editor,i=t.locale,n=t.model,s=n.document,o=e.value;n.change((e=>{const t=Array.from(s.selection.getSelectedBlocks()).filter((e=>this._canBeAligned(e))),n=t[0].getAttribute("alignment"),r=kl(o,i)||n===o||!o;r?Tl(t,e):Pl(t,e,o)}))}_canBeAligned(e){return this.editor.model.schema.checkAttribute(e,Al)}}function Tl(e,t){for(const i of e)t.removeAttribute(Al,i)}function Pl(e,t,i){for(const n of e)t.setAttribute(Al,i,n)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sl extends a.Z{static get pluginName(){return"AlignmentEditing"}constructor(e){super(e),e.config.define("alignment",{options:[...yl.map((e=>({name:e})))]})}init(){const e=this.editor,t=e.locale,i=e.model.schema,n=xl(e.config.get("alignment.options")),s=n.filter((e=>Cl(e.name)&&!kl(e.name,t))),o=s.some((e=>!!e.className));i.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),o?e.conversion.attributeToAttribute(Rl(s)):e.conversion.for("downcast").attributeToAttribute(Vl(s));const r=Il(s);for(const l of r)e.conversion.for("upcast").attributeToAttribute(l);const a=Nl(s);for(const l of a)e.conversion.for("upcast").attributeToAttribute(l);e.commands.add("alignment",new El(e))}}function Vl(e){const t={model:{key:"alignment",values:e.map((e=>e.name))},view:{}};for(const{name:i}of e)t.view[i]={key:"style",value:{"text-align":i}};return t}function Il(e){const t=[];for(const{name:i}of e)t.push({view:{key:"style",value:{"text-align":i}},model:{key:"alignment",value:i}});return t}function Nl(e){const t=[];for(const{name:i}of e)t.push({view:{key:"align",value:i},model:{key:"alignment",value:i}});return t}function Rl(e){const t={model:{key:"alignment",values:e.map((e=>e.name))},view:{}};for(const i of e)t.view[i.name]={key:"class",value:i.className};return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dl({emitter:e,activator:t,callback:i,contextElements:n}){e.listenTo(document,"mousedown",((e,s)=>{if(!t())return;const o="function"==typeof s.composedPath?s.composedPath():[];for(const t of n)if(t.contains(s.target)||o.includes(t))return;i()}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bl(e){e.set("_isCssTransitionsDisabled",!1),e.disableCssTransitions=()=>{e._isCssTransitionsDisabled=!0},e.enableCssTransitions=()=>{e._isCssTransitionsDisabled=!1},e.extendTemplate({attributes:{class:[e.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ml({view:e}){e.listenTo(e.element,"submit",((t,i)=>{i.preventDefault(),e.fire("submit")}),{useCapture:!0})}var Ol=i(4167),Ll=i(70575);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fl extends Ll.Z{constructor(e,t=[]){super(t),this.locale=e}attachToDom(){this._bodyCollectionContainer=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=$i(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&0==e.childElementCount&&e.remove()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zl extends l.Z{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new cl.Z;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $l(e,t){const i=e.t,n={Black:i("Black"),"Dim grey":i("Dim grey"),Grey:i("Grey"),"Light grey":i("Light grey"),White:i("White"),Red:i("Red"),Orange:i("Orange"),Yellow:i("Yellow"),"Light green":i("Light green"),Green:i("Green"),Aquamarine:i("Aquamarine"),Turquoise:i("Turquoise"),"Light blue":i("Light blue"),Blue:i("Blue"),Purple:i("Purple")};return t.map((e=>{const t=n[e.label];return t&&t!=e.label&&(e.label=t),e}))}function Zl(e){return e.map(Hl).filter((e=>!!e))}function Hl(e){return"string"===typeof e?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:void 0!==e.hasBorder&&e.hasBorder,view:{name:"span",styles:{color:`${e.color}`}}}}var Ul='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wl extends l.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("color"),this.set("hasBorder"),this.icon=Ul,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color")},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-table__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ql{constructor(e){if(Object.assign(this,e),e.actions&&e.keystrokeHandler)for(const t in e.actions){let i=e.actions[t];"string"==typeof i&&(i=[i]);for(const n of i)e.keystrokeHandler.set(n,((e,i)=>{this[t](),i()}))}}get first(){return this.focusables.find(Gl)||null}get last(){return this.focusables.filter(Gl).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(((t,i)=>{const n=t.element===this.focusTracker.focusedElement;return n&&(e=i),n})),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const t=this.current,i=this.focusables.length;if(!i)return null;if(null===t)return this[1===e?"first":"last"];let n=(t+i+e)%i;do{const t=this.focusables.get(n);if(Gl(t))return t;n=(n+i+e)%i}while(n!==t);return null}}function Gl(e){return!(!e.focus||"none"==ri.window.getComputedStyle(e.element).display)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jl extends cl.Z{constructor(e,t){super(e);const i=t&&t.colorDefinitions||[],n={};t&&t.columns&&(n.gridTemplateColumns=`repeat( ${t.columns}, 1fr)`),this.set("selectedColor"),this.items=this.createCollection(),this.focusTracker=new en,this.keystrokes=new tn,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.items.on("add",((e,t)=>{t.isOn=t.color===this.selectedColor})),i.forEach((e=>{const t=new Wl;t.set({color:e.color,label:e.label,tooltip:!0,hasBorder:e.options.hasBorder}),t.on("execute",(()=>{this.fire("execute",{value:e.color,hasBorder:e.options.hasBorder,label:e.label})})),this.items.add(t)})),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:n}}),this.on("change:selectedColor",((e,t,i)=>{for(const n of this.items)n.isOn=n.color===i}))}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}var Kl='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>',Jl=i(92926);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yl extends l.Z{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Jl.Z;return e.content=Kl,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ql extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("class"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new tn,this.focusTracker=new en,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",t.to("class"),t.if("isVisible","ck-hidden",(e=>!e)),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",((e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())})),this.keystrokes.set("arrowleft",((e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(){const e=new l.Z;return e.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),e.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),e.delegate("execute").to(this),e}_createArrowView(){const e=new l.Z,t=e.bindTemplate;return e.icon=Kl,e.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":t.to("isOn",(e=>String(e)))}}),e.bind("isEnabled").to(this),e.delegate("execute").to(this,"open"),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xl extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",(e=>`ck-dropdown__panel_${e}`)),t.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:t.to((e=>e.preventDefault()))}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const e=this.children.last;"function"===typeof e.focusLast?e.focusLast():e.focus()}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ec(e){return e&&e.parentNode?e.offsetParent===ri.document.body?null:e.offsetParent:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function tc({element:e,target:t,positions:i,limiter:n,fitInViewport:s,viewportOffsetConfig:o}){(0,Ca.Z)(t)&&(t=t()),(0,Ca.Z)(n)&&(n=n());const r=ec(e),a=new Gi(e),l=new Gi(t);let c;const d={targetRect:l,elementRect:a,positionedElementAncestor:r};if(n||s){const e=n&&new Gi(n).getVisible(),t=s&&ic(o);Object.assign(d,{limiterRect:e,viewportRect:t}),c=nc(i,d)||new rc(i[0],d)}else c=new rc(i[0],d);return c}function ic(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);const t=new Gi(ri.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t}function nc(e,t){const{elementRect:i}=t,n=i.getArea(),s=e.map((e=>new rc(e,t))).filter((e=>!!e.name));let o=0,r=null;for(const a of s){const{_limiterIntersectionArea:e,_viewportIntersectionArea:t}=a;if(e===n)return a;const i=t**2+e**2;i>o&&(o=i,r=a)}return r}function sc(e,t){const i=oc(new Gi(t)),n=Wi(t);let s=0,o=0;s-=i.left,o-=i.top,s+=t.scrollLeft,o+=t.scrollTop,s-=n.left,o-=n.top,e.moveBy(s,o)}function oc(e){const{scrollX:t,scrollY:i}=ri.window;return e.clone().moveBy(t,i)}class rc{constructor(e,t){const i=e(t.targetRect,t.elementRect,t.viewportRect);if(!i)return;const{left:n,top:s,name:o,config:r}=i;Object.assign(this,{name:o,config:r}),this._positioningFunctionCorrdinates={left:n,top:s},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get _limiterIntersectionArea(){const e=this._options.limiterRect;if(e){const t=this._options.viewportRect;if(!t)return e.getIntersectionArea(this._rect);{const i=e.getIntersection(t);if(i)return i.getIntersectionArea(this._rect)}}return 0}get _viewportIntersectionArea(){const e=this._options.viewportRect;return e?e.getIntersectionArea(this._rect):0}get _rect(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCorrdinates.left,this._positioningFunctionCorrdinates.top)),this._cachedRect}get _absoluteRect(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=oc(this._rect),this._options.positionedElementAncestor&&sc(this._cachedAbsoluteRect,this._options.positionedElementAncestor)),this._cachedAbsoluteRect}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ac extends cl.Z{constructor(e,t,i){super(e);const n=this.bindTemplate;this.buttonView=t,this.panelView=i,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new tn,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",n.to("class"),n.if("isEnabled","ck-disabled",(e=>!e))],id:n.to("id"),"aria-describedby":n.to("ariaDescribedById")},children:[t,i]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",(()=>{this.isOpen=!this.isOpen})),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",(()=>{this.isOpen&&("auto"===this.panelPosition?this.panelView.position=ac._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)})),this.keystrokes.listenTo(this.element);const e=(e,t)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,t())};this.keystrokes.set("arrowdown",((e,t)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,t())})),this.keystrokes.set("arrowright",((e,t)=>{this.isOpen&&t()})),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:i,southWest:n,northEast:s,northWest:o,southMiddleEast:r,southMiddleWest:a,northMiddleEast:l,northMiddleWest:c}=ac.defaultPanelPositions;return"rtl"!==this.locale.uiLanguageDirection?[i,n,r,a,e,s,o,l,c,t]:[n,i,a,r,e,o,s,c,l,t]}}ac.defaultPanelPositions={south:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),southMiddleEast:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"}),southMiddleWest:(e,t)=>({top:e.bottom,left:e.left-3*(t.width-e.width)/4,name:"smw"}),north:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),northMiddleEast:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"}),northMiddleWest:(e,t)=>({top:e.top-t.height,left:e.left-3*(t.width-e.width)/4,name:"nmw"})},ac._getOptimalPosition=tc;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function dc(e){return e.bindTemplate.to((t=>{t.target===e.element&&t.preventDefault()}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function hc(e){return Array.isArray(e)?{items:e,removeItems:[]}:e?Object.assign({items:[],removeItems:[]},e):{items:[],removeItems:[]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uc extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate,n=this.t;this.options=t||{},this.set("ariaLabel",n("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new en,this.keystrokes=new tn,this.set("class"),this.set("isCompact",!1),this.itemsView=new mc(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const s="rtl"===e.uiLanguageDirection;this._focusCycler=new ql({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[s?"arrowright":"arrowleft","arrowup"],focusNext:[s?"arrowleft":"arrowright","arrowdown"]}});const o=["ck","ck-toolbar",i.to("class"),i.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&o.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:o,role:"toolbar","aria-label":i.to("ariaLabel"),style:{maxWidth:i.to("maxWidth")}},children:this.children,on:{mousedown:dc(this)}}),this._behavior=this.options.shouldGroupWhenFull?new pc(this):new gc(this)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t){const i=hc(e),n=i.items.filter(((e,n,s)=>"|"===e||-1===i.removeItems.indexOf(e)&&("-"===e?!this.options.shouldGroupWhenFull||((0,S.KE)("toolbarview-line-break-ignored-when-grouping-items",s),!1):!!t.has(e)||((0,S.KE)("toolbarview-item-unavailable",{name:e}),!1)))),s=this._cleanSeparators(n).map((e=>"|"===e?new lc:"-"===e?new cc:t.create(e)));this.items.addMany(s)}_cleanSeparators(e){const t=e=>"-"!==e&&"|"!==e,i=e.length,n=e.findIndex(t),s=i-e.slice().reverse().findIndex(t);return e.slice(n,s).filter(((e,i,n)=>{if(t(e))return!0;const s=i>0&&n[i-1]===e;return!s}))}}class mc extends cl.Z{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class gc{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using((e=>e)),e.focusables.bindTo(e.items).using((e=>e)),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class pc{constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,e.itemsView.children.bindTo(this.ungroupedItems).using((e=>e)),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),e.children.on("add",this._updateFocusCycleableItems.bind(this)),e.children.on("remove",this._updateFocusCycleableItems.bind(this)),e.items.on("change",((e,t)=>{const i=t.index;for(const n of t.removed)i>=this.ungroupedItems.length?this.groupedItems.remove(n):this.ungroupedItems.remove(n);for(let n=i;n<i+t.added.length;n++){const e=t.added[n-i];n>this.ungroupedItems.length?this.groupedItems.add(e,n-this.ungroupedItems.length):this.ungroupedItems.add(e,n)}this._updateGrouping()})),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);const e=this.groupedItems.length;let t;while(this._areItemsOverflowing)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){while(this.groupedItems.length&&!this._areItemsOverflowing)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,i=new Gi(e.lastChild),n=new Gi(e);if(!this.cachedPadding){const i=ri.window.getComputedStyle(e),n="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(i[n])}return"ltr"===t?i.right>n.right-this.cachedPadding:i.left<n.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new Yi(this.viewElement,(t=>{e&&e===t.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)})),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",(()=>{this._updateGrouping()}))}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new lc),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,i=vc(e);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",_c(i,[]),i.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:"rtl"===e.uiLanguageDirection?"se":"sw",icon:sl}),i.toolbarView.items.bindTo(this.groupedItems).using((e=>e)),i}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map((e=>{this.viewFocusables.add(e)})),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fc extends cl.Z{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new en,this.keystrokes=new tn,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wc extends cl.Z{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function vc(e,t=Yl){const i=new t(e),n=new Xl(e),s=new ac(e,i,n);return i.bind("isEnabled").to(s),i instanceof Yl?i.bind("isOn").to(s,"isOpen"):i.arrowView.bind("isOn").to(s,"isOpen"),Cc(s),s}function _c(e,t){const i=e.locale,n=i.t,s=e.toolbarView=new uc(i);s.set("ariaLabel",n("Dropdown toolbar")),e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),t.map((e=>s.items.add(e))),e.panelView.children.add(s),s.items.delegate("execute").to(e)}function yc(e,t){const i=e.locale,n=e.listView=new fc(i);n.items.bindTo(t).using((({type:e,model:t})=>{if("separator"===e)return new bc(i);if("button"===e||"switchbutton"===e){const n=new wc(i);let s;return s="button"===e?new l.Z(i):new zl(i),s.bind(...Object.keys(t)).to(t),s.delegate("execute").to(n),n.children.add(s),n}})),e.panelView.children.add(n),n.items.delegate("execute").to(e)}function Cc(e){kc(e),xc(e),Ac(e)}function kc(e){e.on("render",(()=>{Dl({emitter:e,activator:()=>e.isOpen,callback:()=>{e.isOpen=!1},contextElements:[e.element]})}))}function xc(e){e.on("execute",(t=>{t.source instanceof zl||(e.isOpen=!1)}))}function Ac(e){e.keystrokes.set("arrowdown",((t,i)=>{e.isOpen&&(e.panelView.focus(),i())})),e.keystrokes.set("arrowup",((t,i)=>{e.isOpen&&(e.panelView.focusLast(),i())}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ec extends cl.Z{constructor(e){super(e),this.body=new Fl(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tc extends cl.Z{constructor(e){super(e),this.set("text"),this.set("for"),this.id=`ck-editor__label_${(0,sn.Z)()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pc extends Ec{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new Tc;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sc extends cl.Z{constructor(e,t,i){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=i,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",(()=>this._updateIsFocusedClasses())),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const e=this._editingView;function t(t){e.change((i=>{const n=e.document.getRoot(t.name);i.addClass(t.isFocused?"ck-focused":"ck-blurred",n),i.removeClass(t.isFocused?"ck-blurred":"ck-focused",n)}))}function i(n){e.once("change:isRenderingInProgress",((e,s,o)=>{o?i(n):t(n)}))}e.isRenderingInProgress?i(this):t(this)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vc extends Sc{constructor(e,t,i){super(e,t,i),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView,t=this.t;e.change((i=>{const n=e.document.getRoot(this.name);i.setAttribute("aria-label",t("Rich Text Editor, %0",this.name),n)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ic extends cl.Z{constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",i.to("class")]},children:this.children});const n=new cl.Z(e);n.setTemplate({tag:"span",attributes:{class:["ck","ck-form__header__label"]},children:[{text:i.to("label")}]}),this.children.add(n)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nc extends cl.Z{constructor(e){super(e),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new en,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById")},on:{input:t.to(((...e)=>{this.fire("input",...e),this._updateIsEmpty()})),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",((e,t,i)=>{this._setDomElementValue(i),this._updateIsEmpty()}))}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=Rc(this.element)}_setDomElementValue(e){this.element.value=e||0===e?e:""}}function Rc(e){return!e.value}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Dc extends cl.Z{constructor(e,t){super(e);const i=`ck-labeled-field-view-${(0,sn.Z)()}`,n=`ck-labeled-field-view-status-${(0,sn.Z)()}`;this.fieldView=t(this,i,n),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(i),this.statusView=this._createStatusView(n),this.bind("_statusText").to(this,"errorText",this,"infoText",((e,t)=>e||t));const s=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",s.to("class"),s.if("isEnabled","ck-disabled",(e=>!e)),s.if("isEmpty","ck-labeled-field-view_empty"),s.if("isFocused","ck-labeled-field-view_focused"),s.if("placeholder","ck-labeled-field-view_placeholder"),s.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(e){const t=new Tc(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new cl.Z(this.locale),i=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",i.if("errorText","ck-labeled-field-view__status_error"),i.if("_statusText","ck-hidden",(e=>!e))],id:e,role:i.if("errorText","alert")},children:[{text:i.to("_statusText")}]}),t}focus(){this.fieldView.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bc(e,t,i){const n=new Nc(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isReadOnly").to(e,"isEnabled",(e=>!e)),n.bind("hasError").to(e,"errorText",(e=>!!e)),n.on("input",(()=>{e.errorText=null})),e.bind("isEmpty","isFocused","placeholder").to(n),n}function Mc(e,t,i){const n=vc(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isEnabled").to(e),n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Oc extends H{static get pluginName(){return"Notification"}init(){this.on("show:warning",((e,t)=>{window.alert(t.message)}),{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t=`show:${e.type}`+(e.namespace?`:${e.namespace}`:"");this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lc{constructor(e,t){t&&(0,Ai.Z)(this,t),e&&this.set(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Fc(e){return t=>t+e}(0,I.Z)(Lc,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
const zc=Fc("px"),$c=ri.document.body;class Zc extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",(e=>`ck-balloon-panel_${e}`)),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",zc),left:t.to("left",zc)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=Zc.defaultPositions,i=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthMiddleWest,t.southArrowNorthMiddleEast,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthMiddleWest,t.northArrowSouthMiddleEast,t.northArrowSouthWest,t.northArrowSouthEast,t.viewportStickyNorth],limiter:$c,fitInViewport:!0},e),n=Zc._getOptimalPosition(i),s=parseInt(n.left),o=parseInt(n.top),{name:r,config:a={}}=n,{withArrow:l=!0}=a;Object.assign(this,{top:o,left:s,position:r,withArrow:l})}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=Hc(e.target),i=e.limiter?Hc(e.limiter):$c;this.listenTo(ri.document,"scroll",((n,s)=>{const o=s.target,r=t&&o.contains(t),a=i&&o.contains(i);!r&&!a&&t&&i||this.attachTo(e)}),{useCapture:!0}),this.listenTo(ri.window,"resize",(()=>{this.attachTo(e)}))}_stopPinning(){this.stopListening(ri.document,"scroll"),this.stopListening(ri.window,"resize")}}function Hc(e){return x(e)?e:Hi(e)?e.commonAncestorContainer:"function"==typeof e?Hc(e()):null}function Uc({horizontalOffset:e=Zc.arrowHorizontalOffset,verticalOffset:t=Zc.arrowVerticalOffset,stickyVerticalOffset:i=Zc.stickyVerticalOffset,config:n}={}){return{northWestArrowSouthWest:(t,i)=>({top:s(t,i),left:t.left-e,name:"arrow_sw",...n&&{config:n}}),northWestArrowSouthMiddleWest:(t,i)=>({top:s(t,i),left:t.left-.25*i.width-e,name:"arrow_smw",...n&&{config:n}}),northWestArrowSouth:(e,t)=>({top:s(e,t),left:e.left-t.width/2,name:"arrow_s",...n&&{config:n}}),northWestArrowSouthMiddleEast:(t,i)=>({top:s(t,i),left:t.left-.75*i.width+e,name:"arrow_sme",...n&&{config:n}}),northWestArrowSouthEast:(t,i)=>({top:s(t,i),left:t.left-i.width+e,name:"arrow_se",...n&&{config:n}}),northArrowSouthWest:(t,i)=>({top:s(t,i),left:t.left+t.width/2-e,name:"arrow_sw",...n&&{config:n}}),northArrowSouthMiddleWest:(t,i)=>({top:s(t,i),left:t.left+t.width/2-.25*i.width-e,name:"arrow_smw",...n&&{config:n}}),northArrowSouth:(e,t)=>({top:s(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s",...n&&{config:n}}),northArrowSouthMiddleEast:(t,i)=>({top:s(t,i),left:t.left+t.width/2-.75*i.width+e,name:"arrow_sme",...n&&{config:n}}),northArrowSouthEast:(t,i)=>({top:s(t,i),left:t.left+t.width/2-i.width+e,name:"arrow_se",...n&&{config:n}}),northEastArrowSouthWest:(t,i)=>({top:s(t,i),left:t.right-e,name:"arrow_sw",...n&&{config:n}}),northEastArrowSouthMiddleWest:(t,i)=>({top:s(t,i),left:t.right-.25*i.width-e,name:"arrow_smw",...n&&{config:n}}),northEastArrowSouth:(e,t)=>({top:s(e,t),left:e.right-t.width/2,name:"arrow_s",...n&&{config:n}}),northEastArrowSouthMiddleEast:(t,i)=>({top:s(t,i),left:t.right-.75*i.width+e,name:"arrow_sme",...n&&{config:n}}),northEastArrowSouthEast:(t,i)=>({top:s(t,i),left:t.right-i.width+e,name:"arrow_se",...n&&{config:n}}),southWestArrowNorthWest:(t,i)=>({top:o(t,i),left:t.left-e,name:"arrow_nw",...n&&{config:n}}),southWestArrowNorthMiddleWest:(t,i)=>({top:o(t,i),left:t.left-.25*i.width-e,name:"arrow_nmw",...n&&{config:n}}),southWestArrowNorth:(e,t)=>({top:o(e,t),left:e.left-t.width/2,name:"arrow_n",...n&&{config:n}}),southWestArrowNorthMiddleEast:(t,i)=>({top:o(t,i),left:t.left-.75*i.width+e,name:"arrow_nme",...n&&{config:n}}),southWestArrowNorthEast:(t,i)=>({top:o(t,i),left:t.left-i.width+e,name:"arrow_ne",...n&&{config:n}}),southArrowNorthWest:(t,i)=>({top:o(t,i),left:t.left+t.width/2-e,name:"arrow_nw",...n&&{config:n}}),southArrowNorthMiddleWest:(t,i)=>({top:o(t,i),left:t.left+t.width/2-.25*i.width-e,name:"arrow_nmw",...n&&{config:n}}),southArrowNorth:(e,t)=>({top:o(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_n",...n&&{config:n}}),southArrowNorthMiddleEast:(t,i)=>({top:o(t,i),left:t.left+t.width/2-.75*i.width+e,name:"arrow_nme",...n&&{config:n}}),southArrowNorthEast:(t,i)=>({top:o(t,i),left:t.left+t.width/2-i.width+e,name:"arrow_ne",...n&&{config:n}}),southEastArrowNorthWest:(t,i)=>({top:o(t,i),left:t.right-e,name:"arrow_nw",...n&&{config:n}}),southEastArrowNorthMiddleWest:(t,i)=>({top:o(t,i),left:t.right-.25*i.width-e,name:"arrow_nmw",...n&&{config:n}}),southEastArrowNorth:(e,t)=>({top:o(e,t),left:e.right-t.width/2,name:"arrow_n",...n&&{config:n}}),southEastArrowNorthMiddleEast:(t,i)=>({top:o(t,i),left:t.right-.75*i.width+e,name:"arrow_nme",...n&&{config:n}}),southEastArrowNorthEast:(t,i)=>({top:o(t,i),left:t.right-i.width+e,name:"arrow_ne",...n&&{config:n}}),viewportStickyNorth:(e,t,s)=>e.getIntersection(s)?{top:s.top+i,left:e.left+e.width/2-t.width/2,name:"arrowless",config:{withArrow:!1,...n}}:null};function s(e,i){return e.top-i.height-t}function o(e){return e.bottom+t}}Zc.arrowHorizontalOffset=25,Zc.arrowVerticalOffset=10,Zc.stickyVerticalOffset=20,Zc._getOptimalPosition=tc,Zc.defaultPositions=Uc();var Wc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',qc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Gc=Fc("px");class jc extends a.Z{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this.positionLimiter=()=>{const e=this.editor.editing.view,t=e.document,i=t.selection.editableElement;return i?e.domConverter.mapViewToDom(i.root):null},this.set("visibleView",null),this.view=new Zc(e.locale),e.ui.view.body.add(this.view),e.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}destroy(){super.destroy(),this.view.destroy(),this._rotatorView.destroy(),this._fakePanelsView.destroy()}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this.hasView(e.view))throw new S.ZP("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t))return this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!e.singleViewMode||this.showStack(t));const i=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),i.set(e.view,e),this._viewToStack.set(e.view,i),i===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new S.ZP("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(1===t.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),1===t.size?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new S.ZP("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){const t=Array.from(this._idToStack.entries()).find((t=>t[1]===e));return t[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new Kc(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>!t&&e>1)),e.on("change:isNavigationVisible",(()=>this.updatePosition()),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",((e,i)=>{if(i<2)return"";const n=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[n,i])})),e.buttonNextView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()})),e.buttonPrevView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()})),e}_createFakePanelsView(){const e=new Jc(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>{const i=!t&&e>=2;return i?Math.min(e-1,2):0})),e.listenTo(this.view,"change:top",(()=>e.updatePosition())),e.listenTo(this.view,"change:left",(()=>e.updatePosition())),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:i=!0,singleViewMode:n=!1}){this.view.class=t,this.view.withArrow=i,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),n&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class Kc extends cl.Z{constructor(e){super(e);const t=e.t,i=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new en,this.buttonPrevView=this._createButtonView(t("Previous"),Wc),this.buttonNextView=this._createButtonView(t("Next"),qc),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",i.to("isNavigationVisible",(e=>e?"":"ck-hidden"))]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:i.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const i=new l.Z(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i}}class Jc extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",i.to("numberOfPanels",(e=>e?"":"ck-hidden"))],style:{top:i.to("top",Gc),left:i.to("left",Gc),width:i.to("width",Gc),height:i.to("height",Gc)}},children:this.content}),this.on("change:numberOfPanels",((e,t,i,n)=>{i>n?this._addPanels(i-n):this._removePanels(n-i),this.updatePosition()}))}_addPanels(e){while(e--){const e=new cl.Z;e.setTemplate({tag:"div"}),this.content.add(e),this.registerChild(e)}}_removePanels(e){while(e--){const e=this.content.last;this.content.remove(e),this.deregisterChild(e),e.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:i,height:n}=new Gi(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:i,height:n})}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yc=Fc("px");class Qc extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",(e=>e?"block":"none")),height:t.to("isSticky",(e=>e?Yc(this._panelRect.height):null))}}}).render(),this._contentPanel=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",(e=>e?Yc(this._contentPanelPlaceholder.getBoundingClientRect().width):null)),top:t.to("_hasViewportTopOffset",(e=>e?Yc(this.viewportTopOffset):null)),bottom:t.to("_isStickyToTheLimiter",(e=>e?Yc(this.limiterBottomOffset):null)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(ri.window,"scroll",(()=>{this._checkIfShouldBeSticky()})),this.listenTo(this,"change:isActive",(()=>{this._checkIfShouldBeSticky()}))}_checkIfShouldBeSticky(){const e=this._panelRect=this._contentPanel.getBoundingClientRect();let t;this.limiterElement?(t=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&t.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<t.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=t.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:Yc(-ri.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}var Xc=i(71174);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ed({origin:e,originKeystrokeHandler:t,originFocusTracker:i,toolbar:n,beforeFocus:s,afterBlur:o}){i.add(n.element),t.set("Alt+F10",((e,t)=>{i.isFocused&&!n.focusTracker.isFocused&&(s&&s(),n.focus(),t())})),n.keystrokes.set("Esc",((t,i)=>{n.focusTracker.isFocused&&(e.focus(),o&&o(),i())}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
Fc("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
Fc("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
Fc("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const td=new Map([["left",ol.alignLeft],["right",ol.alignRight],["center",ol.alignCenter],["justify",ol.alignJustify]]);class id extends a.Z{get localizedOptionTitles(){const e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const e=this.editor,t=e.ui.componentFactory,i=e.t,n=xl(e.config.get("alignment.options"));n.map((e=>e.name)).filter(Cl).forEach((e=>this._addButton(e))),t.add("alignment",(e=>{const s=vc(e),o=n.map((e=>t.create(`alignment:${e.name}`)));_c(s,o),s.buttonView.set({label:i("Text alignment"),tooltip:!0}),s.toolbarView.isVertical=!0,s.toolbarView.ariaLabel=i("Text alignment toolbar"),s.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const r="rtl"===e.contentLanguageDirection?td.get("right"):td.get("left");return s.buttonView.bind("icon").toMany(o,"isOn",((...e)=>{const t=e.findIndex((e=>e));return t<0?r:o[t].icon})),s.bind("isEnabled").toMany(o,"isEnabled",((...e)=>e.some((e=>e)))),s}))}_addButton(e){const t=this.editor;t.ui.componentFactory.add(`alignment:${e}`,(i=>{const n=t.commands.get("alignment"),s=new l.Z(i);return s.set({label:this.localizedOptionTitles[e],icon:td.get(e),tooltip:!0,isToggleable:!0}),s.bind("isEnabled").to(n),s.bind("isOn").to(n,"value",(t=>t===e)),this.listenTo(s,"execute",(()=>{t.execute("alignment",{value:e}),t.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nd extends a.Z{static get requires(){return[Sl,id]}static get pluginName(){return"Alignment"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sd{constructor(e,t=20){this.model=e,this.size=0,this.limit=t,this.isLocked=!1,this._changeCallback=(e,t)=>{"transparent"!=t.type&&t!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(e){this.size+=e,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e){this.isLocked&&!e||(this._batch=null,this.size=0)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class od extends b.Z{constructor(e,t){super(e),this._buffer=new sd(e.model,t),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,i=t.document,n=e.text||"",s=n.length,o=e.range?t.createSelection(e.range):i.selection,r=e.resultRange;t.enqueueChange(this._buffer.batch,(e=>{this._buffer.lock(),this._batches.add(this._buffer.batch),t.deleteContent(o),n&&t.insertContent(e.createText(n,i.selection.getAttributes()),o),r?e.setSelection(r):o.is("documentSelection")||e.setSelection(o),this._buffer.unlock(),this._buffer.input(s)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function rd(e,t){const i=[];let n,s=0;return e.forEach((e=>{"equal"==e?(o(),s++):"insert"==e?(r("insert")?n.values.push(t[s]):(o(),n={type:"insert",index:s,values:[t[s]]}),s++):r("delete")?n.howMany++:(o(),n={type:"delete",index:s,howMany:1})})),o(),i;function o(){n&&(i.push(n),n=null)}function r(e){return n&&n.type==e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ad(e){if(0==e.length)return!1;for(const t of e)if("children"===t.type&&!ld(t))return!0;return!1}function ld(e){if(e.newChildren.length-e.oldChildren.length!=1)return;const t=Gt(e.oldChildren,e.newChildren,cd),i=rd(t,e.newChildren);if(i.length>1)return;const n=i[0];return n.values[0]&&n.values[0].is("$text")?n:void 0}function cd(e,t){return e&&e.is("$text")&&t&&t.is("$text")?e.data===t.data:e===t}function dd(e,t){const i=t.selection,n=e.shiftKey&&e.keyCode===ct.Do["delete"],s=!i.isCollapsed;return n&&s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function hd(e){let t=null;const i=e.model,n=e.editing.view,s=e.commands.get("input");function o(e){if(Yt.ZP.isWindows&&dd(e,n.document))return;const o=i.document,r=n.document.isComposing,l=t&&t.isEqual(o.selection);t=null,s.isEnabled&&(md(e)||o.selection.isCollapsed||r&&229===e.keyCode||!r&&229===e.keyCode&&l||a())}function r(){const e=i.document,t=1!==e.selection.rangeCount||e.selection.getFirstRange().isFlat;e.selection.isCollapsed||t||a()}function a(){const e=s.buffer;e.lock();const t=e.batch;s._batches.add(t),i.enqueueChange(t,(()=>{i.deleteContent(i.document.selection)})),e.unlock()}Yt.ZP.isAndroid?n.document.on("beforeinput",((e,t)=>o(t)),{priority:"lowest"}):n.document.on("keydown",((e,t)=>o(t)),{priority:"lowest"}),n.document.on("compositionstart",r,{priority:"lowest"}),n.document.on("compositionend",(()=>{t=i.createSelection(i.document.selection)}),{priority:"lowest"})}const ud=[(0,ct.Cq)("arrowUp"),(0,ct.Cq)("arrowRight"),(0,ct.Cq)("arrowDown"),(0,ct.Cq)("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let oT=112;oT<=135;oT++)ud.push(oT);function md(e){return!(!e.ctrlKey&&!e.metaKey)||ud.includes(e.keyCode)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function gd(e){e.editing.view.document.on("mutations",((t,i,n)=>{new pd(e).handle(i,n)}))}class pd{constructor(e){this.editor=e,this.editing=this.editor.editing}handle(e,t){if(ad(e))this._handleContainerChildrenMutations(e,t);else for(const i of e)this._handleTextMutation(i,t),this._handleTextNodeInsertion(i)}_handleContainerChildrenMutations(e,t){const i=fd(e);if(!i)return;const n=this.editor.editing.view.domConverter,s=n.mapViewToDom(i),o=new gi(this.editor.editing.view.document),r=this.editor.data.toModel(o.domToView(s)).getChild(0),a=this.editor.editing.mapper.toModelElement(i);if(!a)return;const l=Array.from(r.getChildren()),c=Array.from(a.getChildren()),d=l[l.length-1],h=c[c.length-1],u=d&&d.is("element","softBreak"),m=h&&!h.is("element","softBreak");u&&m&&l.pop();const g=this.editor.model.schema;if(!wd(l,g)||!wd(c,g))return;const p=l.map((e=>e.is("$text")?e.data:"@")).join("").replace(/\u00A0/g," "),f=c.map((e=>e.is("$text")?e.data:"@")).join("").replace(/\u00A0/g," ");if(f===p)return;const w=Gt(f,p),{firstChangeAt:b,insertions:v,deletions:_}=bd(w);let y=null;t&&(y=this.editing.mapper.toModelRange(t.getFirstRange()));const C=p.substr(b,v),k=this.editor.model.createRange(this.editor.model.createPositionAt(a,b),this.editor.model.createPositionAt(a,b+_));this.editor.execute("input",{text:C,range:k,resultRange:y})}_handleTextMutation(e,t){if("text"!=e.type)return;const i=e.newText.replace(/\u00A0/g," "),n=e.oldText.replace(/\u00A0/g," ");if(n===i)return;const s=Gt(n,i),{firstChangeAt:o,insertions:r,deletions:a}=bd(s);let l=null;t&&(l=this.editing.mapper.toModelRange(t.getFirstRange()));const c=this.editing.view.createPositionAt(e.node,o),d=this.editing.mapper.toModelPosition(c),h=this.editor.model.createRange(d,d.getShiftedBy(a)),u=i.substr(o,r);this.editor.execute("input",{text:u,range:h,resultRange:l})}_handleTextNodeInsertion(e){if("children"!=e.type)return;const t=ld(e),i=this.editing.view.createPositionAt(e.node,t.index),n=this.editing.mapper.toModelPosition(i),s=t.values[0].data;this.editor.execute("input",{text:s.replace(/\u00A0/g," "),range:this.editor.model.createRange(n)})}}function fd(e){const t=e.map((e=>e.node)).reduce(((e,t)=>e.getCommonAncestor(t,{includeSelf:!0})));if(t)return t.getAncestors({includeSelf:!0,parentFirst:!0}).find((e=>e.is("containerElement")||e.is("rootElement")))}function wd(e,t){return e.every((e=>t.isInline(e)))}function bd(e){let t=null,i=null;for(let o=0;o<e.length;o++){const n=e[o];"equal"!=n&&(t=null===t?o:t,i=o)}let n=0,s=0;for(let o=t;o<=i;o++)"insert"!=e[o]&&n++,"delete"!=e[o]&&s++;return{insertions:s,deletions:n,firstChangeAt:t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vd extends a.Z{static get pluginName(){return"Input"}init(){const e=this.editor,t=new od(e,e.config.get("typing.undoStep")||20);e.commands.add("input",t),hd(e),gd(e)}isInput(e){const t=this.editor.commands.get("input");return t._batches.has(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _d extends b.Z{constructor(e,t){super(e),this.direction=t,this._buffer=new sd(e.model,e.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,i=t.document;t.enqueueChange(this._buffer.batch,(n=>{this._buffer.lock();const s=n.createSelection(e.selection||i.selection),o=e.sequence||1,r=s.isCollapsed;if(s.isCollapsed&&t.modifySelection(s,{direction:this.direction,unit:e.unit}),this._shouldEntireContentBeReplacedWithParagraph(o))return void this._replaceEntireContentWithParagraph(n);if(this._shouldReplaceFirstBlockWithParagraph(s,o))return void this.editor.execute("paragraph",{selection:s});if(s.isCollapsed)return;let a=0;s.getFirstRange().getMinimalFlatRanges().forEach((e=>{a+=He(e.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))})),t.deleteContent(s,{doNotResetEntireContent:r,direction:this.direction}),this._buffer.input(a),n.setSelection(s),this._buffer.unlock()}))}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,i=t.document,n=i.selection,s=t.schema.getLimitElement(n),o=n.isCollapsed&&n.containsEntireContent(s);if(!o)return!1;if(!t.schema.checkChild(s,"paragraph"))return!1;const r=s.getChild(0);return!r||"paragraph"!==r.name}_replaceEntireContentWithParagraph(e){const t=this.editor.model,i=t.document,n=i.selection,s=t.schema.getLimitElement(n),o=e.createElement("paragraph");e.remove(e.createRangeIn(s)),e.insert(o,s),e.setSelection(o,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const i=this.editor.model;if(t>1||"backward"!=this.direction)return!1;if(!e.isCollapsed)return!1;const n=e.getFirstPosition(),s=i.schema.getLimitElement(n),o=s.getChild(0);return n.parent==o&&(!!e.containsEntireContent(o)&&(!!i.schema.checkChild(s,"paragraph")&&"paragraph"!=o.name))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yd extends _i{constructor(e){super(e);const t=e.document;let i=0;function n(e,i,n){const s=new Ge(t,"delete",t.selection.getFirstRange());t.fire(s,new Ei(t,i,n)),s.stop.called&&e.stop()}t.on("keyup",((e,t)=>{t.keyCode!=ct.Do["delete"]&&t.keyCode!=ct.Do.backspace||(i=0)})),t.on("keydown",((e,s)=>{if(Yt.ZP.isWindows&&dd(s,t))return;const o={};if(s.keyCode==ct.Do["delete"])o.direction="forward",o.unit="character";else{if(s.keyCode!=ct.Do.backspace)return;o.direction="backward",o.unit="codePoint"}const r=Yt.ZP.isMac?s.altKey:s.ctrlKey;o.unit=r?"word":o.unit,o.sequence=++i,n(e,s.domEvent,o)})),Yt.ZP.isAndroid&&t.on("beforeinput",((t,i)=>{if("deleteContentBackward"!=i.domEvent.inputType)return;const s={unit:"codepoint",direction:"backward",sequence:1},o=i.domTarget.ownerDocument.defaultView.getSelection();o.anchorNode==o.focusNode&&o.anchorOffset+1!=o.focusOffset&&(s.selectionToRemove=e.domConverter.domSelectionToView(o)),n(t,i.domEvent,s)}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cd extends a.Z{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,i=t.document,n=e.model.document;t.addObserver(yd),this._undoOnBackspace=!1;const s=new _d(e,"forward");if(e.commands.add("deleteForward",s),e.commands.add("forwardDelete",s),e.commands.add("delete",new _d(e,"backward")),this.listenTo(i,"delete",((i,n)=>{const s={unit:n.unit,sequence:n.sequence};if(n.selectionToRemove){const t=e.model.createSelection(),i=[];for(const s of n.selectionToRemove.getRanges())i.push(e.editing.mapper.toModelRange(s));t.setTo(i),s.selection=t}e.execute("forward"==n.direction?"deleteForward":"delete",s),n.preventDefault(),t.scrollToTheSelection()}),{priority:"low"}),Yt.ZP.isAndroid){let e=null;this.listenTo(i,"delete",((t,i)=>{const n=i.domTarget.ownerDocument.defaultView.getSelection();e={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}),{priority:"lowest"}),this.listenTo(i,"keyup",((t,i)=>{if(e){const t=i.domTarget.ownerDocument.defaultView.getSelection();t.collapse(e.anchorNode,e.anchorOffset),t.extend(e.focusNode,e.focusOffset),e=null}}))}this.editor.plugins.has("UndoEditing")&&(this.listenTo(i,"delete",((t,i)=>{this._undoOnBackspace&&"backward"==i.direction&&1==i.sequence&&"codePoint"==i.unit&&(this._undoOnBackspace=!1,e.execute("undo"),i.preventDefault(),t.stop())}),{context:"$capture"}),this.listenTo(n,"change",(()=>{this._undoOnBackspace=!1})))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kd extends a.Z{static get requires(){return[vd,Cd]}static get pluginName(){return"Typing"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function xd(e,t){let i=e.start;const n=Array.from(e.getItems()).reduce(((e,n)=>n.is("$text")||n.is("$textProxy")?e+n.data:(i=t.createPositionAfter(n),"")),"");return{text:n,range:t.createRange(i,e.end)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ad{constructor(e,t){this.model=e,this.testCallback=t,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",(()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))})),this._startListening()}_startListening(){const e=this.model,t=e.document;this.listenTo(t.selection,"change:range",((e,{directChange:i})=>{i&&(t.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))})),this.listenTo(t,"change:data",((e,t)=>{"transparent"!=t.type&&this._evaluateTextBeforeSelection("data",{batch:t})}))}_evaluateTextBeforeSelection(e,t={}){const i=this.model,n=i.document,s=n.selection,o=i.createRange(i.createPositionAt(s.focus.parent,0),s.focus),{text:r,range:a}=xd(o,i),l=this.testCallback(r);if(!l&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!l,l){const i=Object.assign(t,{text:r,range:a});"object"==typeof l&&Object.assign(i,l),this.fire(`matched:${e}`,i)}}}(0,I.Z)(Ad,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ed extends a.Z{static get pluginName(){return"TwoStepCaretMovement"}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,i=e.editing.view,n=e.locale,s=t.document.selection;this.listenTo(i.document,"arrowKey",((e,t)=>{if(!s.isCollapsed)return;if(t.shiftKey||t.altKey||t.ctrlKey)return;const i=t.keyCode==ct.Do.arrowright,o=t.keyCode==ct.Do.arrowleft;if(!i&&!o)return;const r=n.contentLanguageDirection;let a=!1;a="ltr"===r&&i||"rtl"===r&&o?this._handleForwardMovement(t):this._handleBackwardMovement(t),!0===a&&e.stop()}),{context:"$text",priority:"highest"}),this._isNextGravityRestorationSkipped=!1,this.listenTo(s,"change:range",((e,t)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!t.directChange&&Id(s.getFirstPosition(),this.attributes)||this._restoreGravity())}))}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,i=this.editor.model,n=i.document.selection,s=n.getFirstPosition();return!this._isGravityOverridden&&((!s.isAtStart||!Td(n,t))&&(Id(s,t)?(Sd(e),this._overrideGravity(),!0):void 0))}_handleBackwardMovement(e){const t=this.attributes,i=this.editor.model,n=i.document.selection,s=n.getFirstPosition();return this._isGravityOverridden?(Sd(e),this._restoreGravity(),Pd(i,t,s),!0):s.isAtStart?!!Td(n,t)&&(Sd(e),Pd(i,t,s),!0):Vd(s,t)?s.isAtEnd&&!Td(n,t)&&Id(s,t)?(Sd(e),Pd(i,t,s),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):void 0}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change((e=>e.overrideSelectionGravity()))}_restoreGravity(){this.editor.model.change((e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null}))}}function Td(e,t){for(const i of t)if(e.hasAttribute(i))return!0;return!1}function Pd(e,t,i){const n=i.nodeBefore;e.change((e=>{n?e.setSelectionAttribute(n.getAttributes()):e.removeSelectionAttribute(t)}))}function Sd(e){e.preventDefault()}function Vd(e,t){const i=e.getShiftedBy(-1);return Id(i,t)}function Id(e,t){const{nodeBefore:i,nodeAfter:n}=e;for(const s of t){const e=i?i.getAttribute(s):void 0,t=n?n.getAttribute(s):void 0;if(t!==e)return!0}return!1}var Nd=i(50751),Rd=/[\\^$.*+?()[\]{}|]/g,Dd=RegExp(Rd.source);function Bd(e){return e=(0,Nd.Z)(e),e&&Dd.test(e)?e.replace(Rd,"\\$&"):e}var Md=Bd;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Od={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:Ud('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:Ud("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:Ud("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:Ud('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:Ud('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:Ud("'"),to:[null,"‚",null,"’"]}},Ld={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},Fd=["symbols","mathematical","typography","quotes"];class zd extends a.Z{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(e){super(e),e.config.define("typing",{transformations:{include:Fd}})}init(){const e=this.editor.model,t=e.document.selection;t.on("change:range",(()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")})),this._enableTransformationWatchers()}_enableTransformationWatchers(){const e=this.editor,t=e.model,i=e.plugins.get("Input"),n=e.plugins.get("Delete"),s=Wd(e.config.get("typing.transformations")),o=e=>{for(const t of s){const i=t.from,n=i.test(e);if(n)return{normalizedTransformation:t}}},r=(e,s)=>{if(!i.isInput(s.batch))return;const{from:o,to:r}=s.normalizedTransformation,a=o.exec(s.text),l=r(a.slice(1)),c=s.range;let d=a.index;t.enqueueChange((e=>{for(let i=1;i<a.length;i++){const n=a[i],s=l[i-1];if(null==s){d+=n.length;continue}const o=c.start.getShiftedBy(d),r=t.createRange(o,o.getShiftedBy(n.length)),h=Hd(o);t.insertContent(e.createText(s,h),r),d+=s.length}t.enqueueChange((()=>{n.requestUndoOnBackspace()}))}))},a=new Ad(e.model,o);a.on("matched:data",r),a.bind("isEnabled").to(this)}}function $d(e){return"string"==typeof e?new RegExp(`(${Md(e)})$`):e}function Zd(e){return"string"==typeof e?()=>[e]:e instanceof Array?()=>e:e}function Hd(e){const t=e.textNode?e.textNode:e.nodeAfter;return t.getAttributes()}function Ud(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}function Wd(e){const t=e.extra||[],i=e.remove||[],n=e=>!i.includes(e),s=e.include.concat(t).filter(n);return qd(s).filter(n).map((e=>Od[e]||e)).map((e=>({from:$d(e.from),to:Zd(e.to)})))}function qd(e){const t=new Set;for(const i of e)if(Ld[i])for(const e of Ld[i])t.add(e);else t.add(i);return Array.from(t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gd(e,t,i,n){return n.createRange(jd(e,t,i,!0,n),jd(e,t,i,!1,n))}function jd(e,t,i,n,s){let o=e.textNode||(n?e.nodeBefore:e.nodeAfter),r=null;while(o&&o.getAttribute(t)==i)r=o,o=n?o.previousSibling:o.nextSibling;return r?s.createPositionAt(r,n?"before":"after"):e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Kd(e,t,i,n){const s=e.editing.view,o=new Set;s.document.registerPostFixer((s=>{const r=e.model.document.selection;let a=!1;if(r.hasAttribute(t)){const l=Gd(r.getFirstPosition(),t,r.getAttribute(t),e.model),c=e.editing.mapper.toViewRange(l);for(const e of c.getItems())e.is("element",i)&&!e.hasClass(n)&&(s.addClass(n,e),o.add(e),a=!0)}return a})),e.conversion.for("editingDowncast").add((e=>{function t(){s.change((e=>{for(const t of o.values())e.removeClass(n,t),o.delete(t)}))}e.on("insert",t,{priority:"highest"}),e.on("remove",t,{priority:"highest"}),e.on("attribute",t,{priority:"highest"}),e.on("selection",t,{priority:"highest"})}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Jd=new WeakMap;function Yd(e){const{view:t,element:i,text:n,isDirectHost:s=!0,keepOnFocus:o=!1}=e,r=t.document;Jd.has(r)||(Jd.set(r,new Map),r.registerPostFixer((e=>th(r,e)))),Jd.get(r).set(i,{text:n,isDirectHost:s,keepOnFocus:o,hostElement:s?i:null}),t.change((e=>th(r,e)))}function Qd(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0)}function Xd(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0)}function eh(e,t){if(!e.isAttached())return!1;const i=Array.from(e.getChildren()).some((e=>!e.is("uiElement")));if(i)return!1;if(t)return!0;const n=e.document;if(!n.isFocused)return!0;const s=n.selection,o=s.anchor;return o&&o.parent!==e}function th(e,t){const i=Jd.get(e),n=[];let s=!1;for(const[o,r]of i)r.isDirectHost&&(n.push(o),ih(t,o,r)&&(s=!0));for(const[o,r]of i){if(r.isDirectHost)continue;const e=nh(o);e&&(n.includes(e)||(r.hostElement=e,ih(t,o,r)&&(s=!0)))}return s}function ih(e,t,i){const{text:n,isDirectHost:s,hostElement:o}=i;let r=!1;o.getAttribute("data-placeholder")!==n&&(e.setAttribute("data-placeholder",n,o),r=!0);const a=s||1==t.childCount;return a&&eh(o,i.keepOnFocus)?Qd(e,o)&&(r=!0):Xd(e,o)&&(r=!0),r}function nh(e){if(e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement"))return t}return null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sh=new Map;function oh(e,t,i){let n=sh.get(e);n||(n=new Map,sh.set(e,n)),n.set(t,i)}function rh(e,t){const i=sh.get(e);return i&&i.has(t)?i.get(t):ah}function ah(e){return[e]}function lh(e,t,i={}){const n=rh(e.constructor,t.constructor);try{return e=e.clone(),n(e,t,i)}catch(s){throw s}}function ch(e,t,i){e=e.slice(),t=t.slice();const n=new dh(i.document,i.useRelations,i.forceWeakRemove);n.setOriginalOperations(e),n.setOriginalOperations(t);const s=n.originalOperations;if(0==e.length||0==t.length)return{operationsA:e,operationsB:t,originalOperations:s};const o=new WeakMap;for(const l of e)o.set(l,0);const r={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let a=0;while(a<e.length){const i=e[a],s=o.get(i);if(s==t.length){a++;continue}const r=t[s],l=lh(i,r,n.getContext(i,r,!0)),c=lh(r,i,n.getContext(r,i,!1));n.updateRelation(i,r),n.setOriginalOperations(l,i),n.setOriginalOperations(c,r);for(const e of l)o.set(e,s+c.length);e.splice(a,1,...l),t.splice(s,1,...c)}if(i.padWithNoOps){const i=e.length-r.originalOperationsACount,n=t.length-r.originalOperationsBCount;uh(e,n-i),uh(t,i-n)}return hh(e,r.nextBaseVersionB),hh(t,r.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:s}}class dh{constructor(e,t,i=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(e,t=null){const i=t?this.originalOperations.get(t):null;for(const n of e)this.originalOperations.set(n,i||n)}updateRelation(e,t){switch(e.constructor){case Xo:switch(t.constructor){case sr:e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter");break;case Xo:e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter");break}break;case or:switch(t.constructor){case sr:e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");break;case Xo:if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const i=In._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.splitPosition)){const n=i.end.offset-e.splitPosition.offset,s=e.splitPosition.offset-i.start.offset;this._setRelation(e,t,{howMany:n,offset:s})}}}break;case sr:switch(t.constructor){case sr:e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement");break;case or:e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource")}break;case tr:{const i=e.newRange;if(!i)return;switch(t.constructor){case Xo:{const n=In._createFromPositionAndShift(t.sourcePosition,t.howMany),s=n.containsPosition(i.start)||n.start.isEqual(i.start),o=n.containsPosition(i.end)||n.end.isEqual(i.end);!s&&!o||n.containsRange(i)||this._setRelation(e,t,{side:s?"left":"right",path:s?i.start.path.slice():i.end.path.slice()});break}case sr:{const n=i.start.isEqual(t.targetPosition),s=i.start.isEqual(t.deletionPosition),o=i.end.isEqual(t.deletionPosition),r=i.end.isEqual(t.sourcePosition);(n||s||o||r)&&this._setRelation(e,t,{wasInLeftElement:n,wasStartBeforeMergedElement:s,wasEndBeforeMergedElement:o,wasInRightElement:r});break}}break}}}getContext(e,t,i){return{aIsStrong:i,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const i=this.originalOperations.get(t),n=this._history.getUndoneOperation(i);if(!n)return null;const s=this.originalOperations.get(e),o=this._relations.get(s);return o&&o.get(n)||null}_setRelation(e,t,i){const n=this.originalOperations.get(e),s=this.originalOperations.get(t);let o=this._relations.get(n);o||(o=new Map,this._relations.set(n,o)),o.set(s,i)}}function hh(e,t){for(const i of e)i.baseVersion=t++}function uh(e,t){for(let i=0;i<t;i++)e.push(new Pr(0))}function mh(e,t,i){const n=e.nodes,s=n.getNode(0).getAttribute(t);if(s==i)return null;const o=new In(e.position,e.position.getShiftedBy(e.howMany));return new Yo(o,t,s,i,0)}function gh(e,t){const i=In._createFromPositionAndShift(t.sourcePosition,t.howMany);let n=null,s=[];i.containsRange(e,!0)?n=e:e.start.hasSameParentAs(i.start)?(s=e.getDifference(i),n=e.getIntersection(i)):s=[e];const o=[];for(let r of s){r=r._getTransformedByDeletion(t.sourcePosition,t.howMany);const e=t.getMovedRangeStart(),i=r.start.hasSameParentAs(e);r=r._getTransformedByInsertion(e,t.howMany,i),o.push(...r)}return n&&o.push(n._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),o}function ph(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)}function fh(e,t){const i=[];for(let n=0;n<e.length;n++){const s=e[n],o=new Xo(s.start,s.end.offset-s.start.offset,t,0);i.push(o);for(let t=n+1;t<e.length;t++)e[t]=e[t]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];t=t._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return i}oh(Yo,Yo,((e,t,i)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const n=e.range.getDifference(t.range).map((t=>new Yo(t,e.key,e.oldValue,e.newValue,0))),s=e.range.getIntersection(t.range);return s&&i.aIsStrong&&n.push(new Yo(s,t.key,t.newValue,e.newValue,0)),0==n.length?[new Pr(0)]:n}return[e]})),oh(Yo,er,((e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const i=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes),n=i.map((t=>new Yo(t,e.key,e.oldValue,e.newValue,e.baseVersion)));if(t.shouldReceiveAttributes){const i=mh(t,e.key,e.oldValue);i&&n.unshift(i)}return n}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]})),oh(Yo,sr,((e,t)=>{const i=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&i.push(In._createFromPositionAndShift(t.graveyardPosition,1));const n=e.range._getTransformedByMergeOperation(t);return n.isCollapsed||i.push(n),i.map((t=>new Yo(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),oh(Yo,Xo,((e,t)=>{const i=gh(e.range,t);return i.map((t=>new Yo(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),oh(Yo,or,((e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const i=e.clone();return i.range=new In(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,i]}return e.range=e.range._getTransformedBySplitOperation(t),[e]})),oh(er,Yo,((e,t)=>{const i=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const n=mh(e,t.key,t.newValue);n&&i.push(n)}return i})),oh(er,er,((e,t,i)=>(e.position.isEqual(t.position)&&i.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e]))),oh(er,Xo,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),oh(er,or,((e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e]))),oh(er,sr,((e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e]))),oh(tr,er,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e]))),oh(tr,tr,((e,t,i)=>{if(e.name==t.name){if(!i.aIsStrong)return[new Pr(0)];e.oldRange=t.newRange?t.newRange.clone():null}return[e]})),oh(tr,sr,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e]))),oh(tr,Xo,((e,t,i)=>{if(e.oldRange&&(e.oldRange=In._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){if(i.abRelation){const n=In._createFromRanges(e.newRange._getTransformedByMoveOperation(t));if("left"==i.abRelation.side&&t.targetPosition.isEqual(e.newRange.start))return e.newRange.start.path=i.abRelation.path,e.newRange.end=n.end,[e];if("right"==i.abRelation.side&&t.targetPosition.isEqual(e.newRange.end))return e.newRange.start=n.start,e.newRange.end.path=i.abRelation.path,[e]}e.newRange=In._createFromRanges(e.newRange._getTransformedByMoveOperation(t))}return[e]})),oh(tr,or,((e,t,i)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(i.abRelation){const n=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?e.newRange.start=Tn._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!i.abRelation.wasInLeftElement&&(e.newRange.start=Tn._createAt(t.moveTargetPosition)),e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasInRightElement?e.newRange.end=Tn._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?e.newRange.end=Tn._createAt(t.insertionPosition):e.newRange.end=n.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]})),oh(sr,er,((e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e]))),oh(sr,sr,((e,t,i)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(i.bWasUndone){const i=t.graveyardPosition.path.slice();return i.push(0),e.sourcePosition=new Tn(t.graveyardPosition.root,i),e.howMany=0,[e]}return[new Pr(0)]}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!i.bWasUndone&&"splitAtSource"!=i.abRelation){const n="$graveyard"==e.targetPosition.root.rootName,s="$graveyard"==t.targetPosition.root.rootName,o=n&&!s,r=s&&!n,a=r||!o&&i.aIsStrong;if(a){const i=t.targetPosition._getTransformedByMergeOperation(t),n=e.targetPosition._getTransformedByMergeOperation(t);return[new Xo(i,e.howMany,n,0)]}return[new Pr(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&i.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),oh(sr,Xo,((e,t,i)=>{const n=In._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!i.bWasUndone&&!i.forceWeakRemove&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.sourcePosition)?[new Pr(0)]:(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])})),oh(sr,or,((e,t,i)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){const n=0!=t.howMany,s=t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition);if(n||s||"mergeTargetNotMoved"==i.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e]}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==i.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==i.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]})),oh(Xo,er,((e,t)=>{const i=In._createFromPositionAndShift(e.sourcePosition,e.howMany),n=i._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=n.start,e.howMany=n.end.offset-n.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]})),oh(Xo,Xo,((e,t,i)=>{const n=In._createFromPositionAndShift(e.sourcePosition,e.howMany),s=In._createFromPositionAndShift(t.sourcePosition,t.howMany);let o,r=i.aIsStrong,a=!i.aIsStrong;if("insertBefore"==i.abRelation||"insertAfter"==i.baRelation?a=!0:"insertAfter"!=i.abRelation&&"insertBefore"!=i.baRelation||(a=!1),o=e.targetPosition.isEqual(t.targetPosition)&&a?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),ph(e,t)&&ph(t,e))return[t.getReversed()];const l=n.containsPosition(t.targetPosition);if(l&&n.containsRange(s,!0))return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),fh([n],o);const c=s.containsPosition(e.targetPosition);if(c&&s.containsRange(n,!0))return n.start=n.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),n.end=n.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),fh([n],o);const d=U(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==d||"extension"==d)return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),fh([n],o);"remove"!=e.type||"remove"==t.type||i.aWasUndone||i.forceWeakRemove?"remove"==e.type||"remove"!=t.type||i.bWasUndone||i.forceWeakRemove||(r=!1):r=!0;const h=[],u=n.getDifference(s);for(const g of u){g.start=g.start._getTransformedByDeletion(t.sourcePosition,t.howMany),g.end=g.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const e="same"==U(g.start.getParentPath(),t.getMovedRangeStart().getParentPath()),i=g._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,e);h.push(...i)}const m=n.getIntersection(s);return null!==m&&r&&(m.start=m.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.end=m.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===h.length?h.push(m):1==h.length?s.start.isBefore(n.start)||s.start.isEqual(n.start)?h.unshift(m):h.push(m):h.splice(1,0,m)),0===h.length?[new Pr(e.baseVersion)]:fh(h,o)})),oh(Xo,or,((e,t,i)=>{let n=e.targetPosition.clone();e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=i.abRelation||(n=e.targetPosition._getTransformedBySplitOperation(t));const s=In._createFromPositionAndShift(e.sourcePosition,e.howMany);if(s.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=n,[e];if(s.start.hasSameParentAs(t.splitPosition)&&s.containsPosition(t.splitPosition)){let e=new In(t.splitPosition,s.end);e=e._getTransformedBySplitOperation(t);const i=[new In(s.start,t.splitPosition),e];return fh(i,n)}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==i.abRelation&&(n=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==i.abRelation&&(n=e.targetPosition);const o=s._getTransformedBySplitOperation(t),r=[o];if(t.graveyardPosition){const n=s.start.isEqual(t.graveyardPosition)||s.containsPosition(t.graveyardPosition);e.howMany>1&&n&&!i.aWasUndone&&r.push(In._createFromPositionAndShift(t.insertionPosition,1))}return fh(r,n)})),oh(Xo,sr,((e,t,i)=>{const n=In._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.sourcePosition))if("remove"!=e.type||i.forceWeakRemove){if(1==e.howMany)return i.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new Pr(0)]}else if(!i.aWasUndone){const i=[];let n=t.graveyardPosition.clone(),s=t.targetPosition._getTransformedByMergeOperation(t);e.howMany>1&&(i.push(new Xo(e.sourcePosition,e.howMany-1,e.targetPosition,0)),n=n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1),s=s._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1));const o=t.deletionPosition._getCombined(e.sourcePosition,e.targetPosition),r=new Xo(n,1,o,0),a=r.getMovedRangeStart().path.slice();a.push(0);const l=new Tn(r.targetPosition.root,a);s=s._getTransformedByMove(n,o,1);const c=new Xo(s,t.howMany,l,0);return i.push(r),i.push(c),i}const s=In._createFromPositionAndShift(e.sourcePosition,e.howMany),o=s._getTransformedByMergeOperation(t);return e.sourcePosition=o.start,e.howMany=o.end.offset-o.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]})),oh(ir,er,((e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e]))),oh(ir,sr,((e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e]))),oh(ir,Xo,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),oh(ir,ir,((e,t,i)=>{if(e.position.isEqual(t.position)){if(!i.aIsStrong)return[new Pr(0)];e.oldName=t.newName}return[e]})),oh(ir,or,((e,t)=>{const i=e.position.path,n=t.splitPosition.getParentPath();if("same"==U(i,n)&&!t.graveyardPosition){const t=new ir(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,t]}return e.position=e.position._getTransformedBySplitOperation(t),[e]})),oh(nr,nr,((e,t,i)=>{if(e.root===t.root&&e.key===t.key){if(!i.aIsStrong||e.newValue===t.newValue)return[new Pr(0)];e.oldValue=t.newValue}return[e]})),oh(or,er,((e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e]))),oh(or,sr,((e,t,i)=>{if(!e.graveyardPosition&&!i.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const i=t.graveyardPosition.path.slice();i.push(0);const n=new Tn(t.graveyardPosition.root,i),s=or.getInsertionPosition(new Tn(t.graveyardPosition.root,i)),o=new or(n,0,s,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=or.getInsertionPosition(e.splitPosition),e.graveyardPosition=o.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[o,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=or.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),oh(or,Xo,((e,t,i)=>{const n=In._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const s=n.start.isEqual(e.graveyardPosition)||n.containsPosition(e.graveyardPosition);if(!i.bWasUndone&&s){const i=e.splitPosition._getTransformedByMoveOperation(t),n=e.graveyardPosition._getTransformedByMoveOperation(t),s=n.path.slice();s.push(0);const o=new Tn(n.root,s),r=new Xo(i,e.howMany,o,0);return[r]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}const s=e.splitPosition.isEqual(t.targetPosition);if(s&&("insertAtSource"==i.baRelation||"splitBefore"==i.abRelation))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=or.getInsertionPosition(e.splitPosition),[e];if(s&&i.abRelation&&i.abRelation.howMany){const{howMany:t,offset:n}=i.abRelation;return e.howMany+=t,e.splitPosition=e.splitPosition.getShiftedBy(n),[e]}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){const i=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=i,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=or.getInsertionPosition(e.splitPosition),[e]}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=or.getInsertionPosition(e.splitPosition),[e]})),oh(or,or,((e,t,i)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new Pr(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new Pr(0)];if("splitBefore"==i.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const n="$graveyard"==e.splitPosition.root.rootName,s="$graveyard"==t.splitPosition.root.rootName,o=n&&!s,r=s&&!n,a=r||!o&&i.aIsStrong;if(a){const i=[];return t.howMany&&i.push(new Xo(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&i.push(new Xo(e.splitPosition,e.howMany,e.moveTargetPosition,0)),i}return[new Pr(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==i.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==i.baRelation){const i=t.insertionPosition.path.slice();i.push(0);const n=new Tn(t.insertionPosition.root,i),s=new Xo(e.insertionPosition,1,n,0);return[e,s]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=or.getInsertionPosition(e.splitPosition),[e]}));
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wh extends Ti{constructor(e){super(e),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bh extends Ti{constructor(e){super(e),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vh{constructor(e){this.document=e}createDocumentFragment(e){return new ft(this.document,e)}createElement(e,t,i){return new Ve(this.document,e,t,i)}createText(e){return new G(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,i){return i._insertChild(e,t)}removeChildren(e,t,i){return i._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const i=e.parent;if(i){const n=i.getChildIndex(e);return this.removeChildren(n,1,i),this.insertChild(n,t,i),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const i=t.getChildIndex(e);this.remove(e),this.insertChild(i,e.getChildren(),t)}}rename(e,t){const i=new Ve(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,i)?i:null}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){(0,_.Z)(e)&&void 0===i&&(i=t),i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return ze._createAt(e,t)}createPositionAfter(e){return ze._createAfter(e)}createPositionBefore(e){return ze._createBefore(e)}createRange(e,t){return new $e(e,t)}createRangeOn(e){return $e._createOn(e)}createRangeIn(e){return $e._createIn(e)}createSelection(e,t,i){return new Ue(e,t,i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const _h=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,yh=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,Ch=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,kh=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,xh=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Ah=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function Eh(e){return e.startsWith("#")?_h.test(e):e.startsWith("rgb")?yh.test(e)||Ch.test(e):e.startsWith("hsl")?kh.test(e)||xh.test(e):Ah.has(e.toLowerCase())}const Th=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function Ph(e){return Th.includes(e)}const Sh=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Vh(e){return Sh.test(e)}const Ih=/^[+-]?[0-9]*([.][0-9]+)?%$/;function Nh(e){return Ih.test(e)}const Rh=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function Dh(e){return Rh.includes(e)}const Bh=["center","top","bottom","left","right"];function Mh(e){return Bh.includes(e)}const Oh=["fixed","scroll","local"];function Lh(e){return Oh.includes(e)}const Fh=/^url\(/;function zh(e){return Fh.test(e)}function $h(e=""){if(""===e)return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=Wh(e),i=t[0],n=t[2]||i,s=t[1]||i,o=t[3]||s;return{top:i,bottom:n,right:s,left:o}}function Zh(e){return t=>{const{top:i,right:n,bottom:s,left:o}=t,r=[];return[i,n,o,s].every((e=>!!e))?r.push([e,Hh(t)]):(i&&r.push([e+"-top",i]),n&&r.push([e+"-right",n]),s&&r.push([e+"-bottom",s]),o&&r.push([e+"-left",o])),r}}function Hh({top:e,right:t,bottom:i,left:n}){const s=[];return n!==t?s.push(e,t,i,n):i!==e?s.push(e,t,i):t!==e?s.push(e,t):s.push(e),s.join(" ")}function Uh(e){return t=>({path:e,value:$h(t)})}function Wh(e){return e.replace(/, /g,",").split(" ").map((e=>e.replace(/,/g,", ")))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function qh(e){e.setNormalizer("background",Gh),e.setNormalizer("background-color",(e=>({path:"background.color",value:e}))),e.setReducer("background",(e=>{const t=[];return t.push(["background-color",e.color]),t})),e.setStyleRelation("background",["background-color"])}function Gh(e){const t={},i=Wh(e);for(const n of i)Dh(n)?(t.repeat=t.repeat||[],t.repeat.push(n)):Mh(n)?(t.position=t.position||[],t.position.push(n)):Lh(n)?t.attachment=n:Eh(n)?t.color=n:zh(n)&&(t.image=n);return{path:"background",value:t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jh(e){e.setNormalizer("border",Kh),e.setNormalizer("border-top",Jh("top")),e.setNormalizer("border-right",Jh("right")),e.setNormalizer("border-bottom",Jh("bottom")),e.setNormalizer("border-left",Jh("left")),e.setNormalizer("border-color",Yh("color")),e.setNormalizer("border-width",Yh("width")),e.setNormalizer("border-style",Yh("style")),e.setNormalizer("border-top-color",Xh("color","top")),e.setNormalizer("border-top-style",Xh("style","top")),e.setNormalizer("border-top-width",Xh("width","top")),e.setNormalizer("border-right-color",Xh("color","right")),e.setNormalizer("border-right-style",Xh("style","right")),e.setNormalizer("border-right-width",Xh("width","right")),e.setNormalizer("border-bottom-color",Xh("color","bottom")),e.setNormalizer("border-bottom-style",Xh("style","bottom")),e.setNormalizer("border-bottom-width",Xh("width","bottom")),e.setNormalizer("border-left-color",Xh("color","left")),e.setNormalizer("border-left-style",Xh("style","left")),e.setNormalizer("border-left-width",Xh("width","left")),e.setExtractor("border-top",eu("top")),e.setExtractor("border-right",eu("right")),e.setExtractor("border-bottom",eu("bottom")),e.setExtractor("border-left",eu("left")),e.setExtractor("border-top-color","border.color.top"),e.setExtractor("border-right-color","border.color.right"),e.setExtractor("border-bottom-color","border.color.bottom"),e.setExtractor("border-left-color","border.color.left"),e.setExtractor("border-top-width","border.width.top"),e.setExtractor("border-right-width","border.width.right"),e.setExtractor("border-bottom-width","border.width.bottom"),e.setExtractor("border-left-width","border.width.left"),e.setExtractor("border-top-style","border.style.top"),e.setExtractor("border-right-style","border.style.right"),e.setExtractor("border-bottom-style","border.style.bottom"),e.setExtractor("border-left-style","border.style.left"),e.setReducer("border-color",Zh("border-color")),e.setReducer("border-style",Zh("border-style")),e.setReducer("border-width",Zh("border-width")),e.setReducer("border-top",su("top")),e.setReducer("border-right",su("right")),e.setReducer("border-bottom",su("bottom")),e.setReducer("border-left",su("left")),e.setReducer("border",nu()),e.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),e.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),e.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),e.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),e.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),e.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function Kh(e){const{color:t,style:i,width:n}=iu(e);return{path:"border",value:{color:$h(t),style:$h(i),width:$h(n)}}}function Jh(e){return t=>{const{color:i,style:n,width:s}=iu(t),o={};return void 0!==i&&(o.color={[e]:i}),void 0!==n&&(o.style={[e]:n}),void 0!==s&&(o.width={[e]:s}),{path:"border",value:o}}}function Yh(e){return t=>({path:"border",value:Qh(t,e)})}function Qh(e,t){return{[t]:$h(e)}}function Xh(e,t){return i=>({path:"border",value:{[e]:{[t]:i}}})}function eu(e){return(t,i)=>{if(i.border)return tu(i.border,e)}}function tu(e,t){const i={};return e.width&&e.width[t]&&(i.width=e.width[t]),e.style&&e.style[t]&&(i.style=e.style[t]),e.color&&e.color[t]&&(i.color=e.color[t]),i}function iu(e){const t={},i=Wh(e);for(const n of i)Vh(n)||/thin|medium|thick/.test(n)?t.width=n:Ph(n)?t.style=n:t.color=n;return t}function nu(){return t=>{const i=tu(t,"top"),n=tu(t,"right"),s=tu(t,"bottom"),o=tu(t,"left"),r=[i,n,s,o],a={width:e(r,"width"),style:e(r,"style"),color:e(r,"color")},l=ou(a,"all");if(l.length)return l;const c=Object.entries(a).reduce(((e,[t,i])=>(i&&(e.push([`border-${t}`,i]),r.forEach((e=>e[t]=null))),e)),[]);return[...c,...ou(i,"top"),...ou(n,"right"),...ou(s,"bottom"),...ou(o,"left")]};function e(e,t){return e.map((e=>e[t])).reduce(((e,t)=>e==t?e:null))}}function su(e){return t=>ou(t,e)}function ou(e,t){const i=[];if(e&&e.width&&i.push("width"),e&&e.style&&i.push("style"),e&&e.color&&i.push("color"),3==i.length){const n=i.map((t=>e[t])).join(" ");return["all"==t?["border",n]:[`border-${t}`,n]]}return"all"==t?[]:i.map((i=>[`border-${t}-${i}`,e[i]]))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ru(e){e.setNormalizer("padding",Uh("padding")),e.setNormalizer("padding-top",(e=>({path:"padding.top",value:e}))),e.setNormalizer("padding-right",(e=>({path:"padding.right",value:e}))),e.setNormalizer("padding-bottom",(e=>({path:"padding.bottom",value:e}))),e.setNormalizer("padding-left",(e=>({path:"padding.left",value:e}))),e.setReducer("padding",Zh("padding")),e.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function au(e,t,i,n){let s,o=null;"function"==typeof n?s=n:(o=e.commands.get(n),s=()=>{e.execute(n)}),e.model.document.on("change:data",((r,a)=>{if(o&&!o.isEnabled||!t.isEnabled)return;const l=(0,Xi.Z)(e.model.document.selection.getRanges());if(!l.isCollapsed)return;if("transparent"==a.type)return;const c=Array.from(e.model.document.differ.getChanges()),d=c[0];if(1!=c.length||"insert"!==d.type||"$text"!=d.name||1!=d.length)return;const h=d.position.parent;if(h.is("element","codeBlock"))return;if(h.is("element","listItem")&&"function"!==typeof n&&!["numberedList","bulletedList","todoList"].includes(n))return;if(o&&!0===o.value)return;const u=h.getChild(0),m=e.model.createRangeOn(u);if(!m.containsRange(l)&&!l.end.isEqual(m.end))return;const g=i.exec(u.data.substr(0,l.end.offset));g&&e.model.enqueueChange((t=>{const i=t.createPositionAt(h,0),n=t.createPositionAt(h,g[0].length),o=new qn(i,n),r=s({match:g});if(!1!==r){t.remove(o);const i=e.model.document.selection.getFirstRange(),n=t.createRangeIn(h);!h.isEmpty||n.isEqual(i)||n.containsRange(i,!0)||t.remove(h)}o.detach(),e.model.enqueueChange((()=>{e.plugins.get("Delete").requestUndoOnBackspace()}))}))}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function lu(e,t,i,n){let s,o;i instanceof RegExp?s=i:o=i,o=o||(e=>{let t;const i=[],n=[];while(null!==(t=s.exec(e))){if(t&&t.length<4)break;let{index:e,1:s,2:o,3:r}=t;const a=s+o+r;e+=t[0].length-a.length;const l=[e,e+s.length],c=[e+s.length+o.length,e+s.length+o.length+r.length];i.push(l),i.push(c),n.push([e+s.length,e+s.length+o.length])}return{remove:i,format:n}}),e.model.document.on("change:data",((i,s)=>{if("transparent"==s.type||!t.isEnabled)return;const r=e.model,a=r.document.selection;if(!a.isCollapsed)return;const l=Array.from(r.document.differ.getChanges()),c=l[0];if(1!=l.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;const d=a.focus,h=d.parent,{text:u,range:m}=du(r.createRange(r.createPositionAt(h,0),d),r),g=o(u),p=cu(m.start,g.format,r),f=cu(m.start,g.remove,r);p.length&&f.length&&r.enqueueChange((t=>{const i=n(t,p);if(!1!==i){for(const e of f.reverse())t.remove(e);r.enqueueChange((()=>{e.plugins.get("Delete").requestUndoOnBackspace()}))}}))}))}function cu(e,t,i){return t.filter((e=>void 0!==e[0]&&void 0!==e[1])).map((t=>i.createRange(e.getShiftedBy(t[0]),e.getShiftedBy(t[1]))))}function du(e,t){let i=e.start;const n=Array.from(e.getItems()).reduce(((e,n)=>!n.is("$text")&&!n.is("$textProxy")||n.getAttribute("code")?(i=t.createPositionAfter(n),""):e+n.data),"");return{text:n,range:t.createRange(i,e.end)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hu extends a.Z{static get requires(){return[Cd]}static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&au(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&au(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&au(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&au(this.editor,this,/^\[\s?x\s?\]\s$/,(()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")}))}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const e=uu(this.editor,"bold");lu(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,e),lu(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,e)}if(e.get("italic")){const e=uu(this.editor,"italic");lu(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,e),lu(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,e)}if(e.get("code")){const e=uu(this.editor,"code");lu(this.editor,this,/(`)([^`]+)(`)$/g,e)}if(e.get("strikethrough")){const e=uu(this.editor,"strikethrough");lu(this.editor,this,/(~~)([^~]+)(~~)$/g,e)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter((e=>e.match(/^heading[1-6]$/))).forEach((t=>{const i=t[7],n=new RegExp(`^(#{${i}})\\s$`);au(this.editor,this,n,(()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})}))}))}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&au(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&au(e,this,/^```$/,(()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})}))}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&au(this.editor,this,/^---$/,"horizontalLine")}}function uu(e,t){return(i,n)=>{const s=e.commands.get(t);if(!s.isEnabled)return!1;const o=e.model.schema.getValidRanges(n,t);for(const e of o)i.setAttribute(t,!0,e);i.removeSelectionAttribute(t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mu extends b.Z{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document,n=i.selection,s=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(n.isCollapsed)s?e.setSelectionAttribute(this.attributeKey,!0):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const t of i)s?e.setAttribute(this.attributeKey,s,t):e.removeAttribute(this.attributeKey,t)}}))}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,i=e.document.selection;if(i.isCollapsed)return i.hasAttribute(this.attributeKey);for(const n of i.getRanges())for(const e of n.getItems())if(t.checkAttribute(e,this.attributeKey))return e.hasAttribute(this.attributeKey);return!1}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const gu="bold";class pu extends a.Z{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:gu}),e.model.schema.setAttributeProperties(gu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:gu,view:"strong",upcastAlso:["b",e=>{const t=e.getStyle("font-weight");return t?"bold"==t||Number(t)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),e.commands.add(gu,new mu(e,gu)),e.keystrokes.set("CTRL+B",gu)}}var fu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const wu="bold";class bu extends a.Z{static get pluginName(){return"BoldUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(wu,(i=>{const n=e.commands.get(wu),s=new l.Z(i);return s.set({label:t("Bold"),icon:fu,keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(wu),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vu extends a.Z{static get requires(){return[pu,bu]}static get pluginName(){return"Bold"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const _u="code",yu="ck-code_selected";class Cu extends a.Z{static get pluginName(){return"CodeEditing"}static get requires(){return[Ed]}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:_u}),e.model.schema.setAttributeProperties(_u,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:_u,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),e.commands.add(_u,new mu(e,_u)),e.plugins.get(Ed).registerAttribute(_u),Kd(e,_u,"code",yu)}}var ku='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xu="code";class Au extends a.Z{static get pluginName(){return"CodeUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(xu,(i=>{const n=e.commands.get(xu),s=new l.Z(i);return s.set({label:t("Code"),icon:ku,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(xu),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Eu extends a.Z{static get requires(){return[Cu,Au]}static get pluginName(){return"Code"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Tu="italic";class Pu extends a.Z{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Tu}),e.model.schema.setAttributeProperties(Tu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Tu,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Tu,new mu(e,Tu)),e.keystrokes.set("CTRL+I",Tu)}}var Su='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Vu="italic";class Iu extends a.Z{static get pluginName(){return"ItalicUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Vu,(i=>{const n=e.commands.get(Vu),s=new l.Z(i);return s.set({label:t("Italic"),icon:Su,keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(Vu),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nu extends a.Z{static get requires(){return[Pu,Iu]}static get pluginName(){return"Italic"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ru="strikethrough";class Du extends a.Z{static get pluginName(){return"StrikethroughEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Ru}),e.model.schema.setAttributeProperties(Ru,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Ru,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Ru,new mu(e,Ru)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}var Bu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Mu="strikethrough";class Ou extends a.Z{static get pluginName(){return"StrikethroughUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Mu,(i=>{const n=e.commands.get(Mu),s=new l.Z(i);return s.set({label:t("Strikethrough"),icon:Bu,keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(Mu),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lu extends a.Z{static get requires(){return[Du,Ou]}static get pluginName(){return"Strikethrough"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Fu="subscript";class zu extends a.Z{static get pluginName(){return"SubscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Fu}),e.model.schema.setAttributeProperties(Fu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Fu,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),e.commands.add(Fu,new mu(e,Fu))}}var $u='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.03 10.349 3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Zu="subscript";class Hu extends a.Z{static get pluginName(){return"SubscriptUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Zu,(i=>{const n=e.commands.get(Zu),s=new l.Z(i);return s.set({label:t("Subscript"),icon:$u,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(Zu),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Uu extends a.Z{static get requires(){return[zu,Hu]}static get pluginName(){return"Subscript"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Wu="superscript";class qu extends a.Z{static get pluginName(){return"SuperscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Wu}),e.model.schema.setAttributeProperties(Wu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Wu,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),e.commands.add(Wu,new mu(e,Wu))}}var Gu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ju="superscript";class Ku extends a.Z{static get pluginName(){return"SuperscriptUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(ju,(i=>{const n=e.commands.get(ju),s=new l.Z(i);return s.set({label:t("Superscript"),icon:Gu,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(ju),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ju extends a.Z{static get requires(){return[qu,Ku]}static get pluginName(){return"Superscript"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yu="underline";class Qu extends a.Z{static get pluginName(){return"UnderlineEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Yu}),e.model.schema.setAttributeProperties(Yu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Yu,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Yu,new mu(e,Yu)),e.keystrokes.set("CTRL+U","underline")}}var Xu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const em="underline";class tm extends a.Z{static get pluginName(){return"UnderlineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(em,(i=>{const n=e.commands.get(em),s=new l.Z(i);return s.set({label:t("Underline"),icon:Xu,keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(em),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class im extends a.Z{static get requires(){return[Qu,tm]}static get pluginName(){return"Underline"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function*nm(e,t){for(const i of t)i&&e.getAttributeProperties(i[0]).copyOnEnter&&(yield i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sm extends b.Z{execute(){const e=this.editor.model,t=e.document;e.change((i=>{om(this.editor.model,i,t.selection,e.schema),this.fire("afterExecute",{writer:i})}))}}function om(e,t,i,n){const s=i.isCollapsed,o=i.getFirstRange(),r=o.start.parent,a=o.end.parent;if(n.isLimit(r)||n.isLimit(a))s||r!=a||e.deleteContent(i);else if(s){const e=nm(t.model.schema,i.getAttributes());rm(t,o.start),t.setSelectionAttribute(e)}else{const n=!(o.start.isAtStart&&o.end.isAtEnd),s=r==a;e.deleteContent(i,{leaveUnmerged:n}),n&&(s?rm(t,i.focus):t.setSelection(a,0))}}function rm(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class am extends _i{constructor(e){super(e);const t=this.document;t.on("keydown",((e,i)=>{if(this.isEnabled&&i.keyCode==ct.Do.enter){const n=new Ge(t,"enter",t.selection.getFirstRange());t.fire(n,new Ei(t,i.domEvent,{isSoft:i.shiftKey})),n.stop.called&&e.stop()}}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lm extends a.Z{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,i=t.document;t.addObserver(am),e.commands.add("enter",new sm(e)),this.listenTo(i,"enter",((i,n)=>{n.preventDefault(),n.isSoft||(e.execute("enter"),t.scrollToTheSelection())}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cm extends b.Z{execute(){const e=this.editor.model,t=e.document;e.change((i=>{hm(e,i,t.selection),this.fire("afterExecute",{writer:i})}))}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=dm(e.schema,t.selection)}}function dm(e,t){if(t.rangeCount>1)return!1;const i=t.anchor;if(!i||!e.checkChild(i,"softBreak"))return!1;const n=t.getFirstRange(),s=n.start.parent,o=n.end.parent;return!mm(s,e)&&!mm(o,e)||s===o}function hm(e,t,i){const n=i.isCollapsed,s=i.getFirstRange(),o=s.start.parent,r=s.end.parent,a=o==r;if(n){const n=nm(e.schema,i.getAttributes());um(e,t,s.end),t.removeSelectionAttribute(i.getAttributeKeys()),t.setSelectionAttribute(n)}else{const n=!(s.start.isAtStart&&s.end.isAtEnd);e.deleteContent(i,{leaveUnmerged:n}),a?um(e,t,i.focus):n&&t.setSelection(r,0)}}function um(e,t,i){const n=t.createElement("softBreak");e.insertContent(n,i),t.setSelection(n,"after")}function mm(e,t){return!e.is("rootElement")&&(t.isLimit(e)||mm(e.parent,t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gm extends a.Z{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,i=e.conversion,n=e.editing.view,s=n.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),i.for("upcast").elementToElement({model:"softBreak",view:"br"}),i.for("downcast").elementToElement({model:"softBreak",view:(e,{writer:t})=>t.createEmptyElement("br")}),n.addObserver(am),e.commands.add("shiftEnter",new cm(e)),this.listenTo(s,"enter",((t,i)=>{i.preventDefault(),i.isSoft&&(e.execute("shiftEnter"),n.scrollToTheSelection())}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pm extends b.Z{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.schema,n=t.document.selection,s=Array.from(n.getSelectedBlocks()),o=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(o){const t=s.filter((e=>fm(e)||bm(i,e)));this._applyQuote(e,t)}else this._removeQuote(e,s.filter(fm))}))}_getValue(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getSelectedBlocks());return!(!t||!fm(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&bm(t,i)}_removeQuote(e,t){wm(e,t).reverse().forEach((t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const i=e.createPositionBefore(t.start.parent);return void e.move(t,i)}t.end.isAtEnd||e.split(t.end);const i=e.createPositionAfter(t.end.parent);e.move(t,i)}))}_applyQuote(e,t){const i=[];wm(e,t).reverse().forEach((t=>{let n=fm(t.start);n||(n=e.createElement("blockQuote"),e.wrap(t,n)),i.push(n)})),i.reverse().reduce(((t,i)=>t.nextSibling==i?(e.merge(e.createPositionAfter(t)),t):i))}}function fm(e){return"blockQuote"==e.parent.name?e.parent:null}function wm(e,t){let i,n=0;const s=[];while(n<t.length){const o=t[n],r=t[n+1];i||(i=e.createPositionBefore(o)),r&&o.nextSibling==r||(s.push(e.createRange(i,e.createPositionAfter(o))),i=null),n++}return s}function bm(e,t){const i=e.checkChild(t.parent,"blockQuote"),n=e.checkChild(["$root","blockQuote"],t);return i&&n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vm extends a.Z{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[lm,Cd]}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new pm(e)),t.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer((i=>{const n=e.model.document.differ.getChanges();for(const e of n)if("insert"==e.type){const n=e.position.nodeAfter;if(!n)continue;if(n.is("element","blockQuote")&&n.isEmpty)return i.remove(n),!0;if(n.is("element","blockQuote")&&!t.checkChild(e.position,n))return i.unwrap(n),!0;if(n.is("element")){const e=i.createRangeIn(n);for(const n of e.getItems())if(n.is("element","blockQuote")&&!t.checkChild(i.createPositionBefore(n),n))return i.unwrap(n),!0}}else if("remove"==e.type){const t=e.position.parent;if(t.is("element","blockQuote")&&t.isEmpty)return i.remove(t),!0}return!1}));const i=this.editor.editing.view.document,n=e.model.document.selection,s=e.commands.get("blockQuote");this.listenTo(i,"enter",((t,i)=>{if(!n.isCollapsed||!s.value)return;const o=n.getLastPosition().parent;o.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop())}),{context:"blockquote"}),this.listenTo(i,"delete",((t,i)=>{if("backward"!=i.direction||!n.isCollapsed||!s.value)return;const o=n.getLastPosition().parent;o.isEmpty&&!o.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop())}),{context:"blockquote"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _m extends a.Z{static get pluginName(){return"BlockQuoteUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("blockQuote",(i=>{const n=e.commands.get("blockQuote"),s=new l.Z(i);return s.set({label:t("Block quote"),icon:ol.quote,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute("blockQuote"),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ym extends a.Z{static get requires(){return[vm,_m]}static get pluginName(){return"BlockQuote"}}i(99726);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Cm(e){const t=e.t,i=e.config.get("codeBlock.languages");for(const n of i)"Plain text"===n.label&&(n.label=t("Plain text")),void 0===n.class&&(n.class=`language-${n.language}`);return i}function km(e,t,i){const n={};for(const s of e)"class"===t?n[s[t].split(" ").shift()]=s[i]:n[s[t]]=s[i];return n}function xm(e){return e.data.match(/^(\s*)/)[0]}function Am(e,t){const i=e.createDocumentFragment(),n=t.split("\n"),s=n.reduce(((t,i,s)=>(t.push(i),s<n.length-1&&t.push(e.createElement("br")),t)),[]);return e.appendChild(s,i),i}function Em(e){const t=e.document.selection,i=[];if(t.isCollapsed)i.push(t.anchor);else{const n=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:t}of n)if(t.is("$textProxy")&&t.parent.is("element","codeBlock")){const n=xm(t.textNode),{parent:s,startOffset:o}=t.textNode,r=e.createPositionAt(s,o+n.length);i.push(r)}}return i}function Tm(e){const t=(0,Xi.Z)(e.getSelectedBlocks());return t&&t.is("element","codeBlock")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pm extends b.Z{constructor(e){super(e),this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,i=t.model,n=i.document.selection,s=Cm(t),o=s[0],r=Array.from(n.getSelectedBlocks()),a=void 0===e.forceValue?!this.value:e.forceValue,l=Vm(e,this._lastLanguage,o.language);i.change((e=>{a?this._applyCodeBlock(e,r,l):this._removeCodeBlock(e,r)}))}_getValue(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getSelectedBlocks()),i=!(!t||!t.is("element","codeBlock"));return!!i&&t.getAttribute("language")}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&Sm(t,i)}_applyCodeBlock(e,t,i){this._lastLanguage=i;const n=this.editor.model.schema,s=t.filter((e=>Sm(n,e)));for(const o of s)e.rename(o,"codeBlock"),e.setAttribute("language",i,o),n.removeDisallowedAttributes([o],e),Array.from(o.getChildren()).filter((e=>!n.checkChild(o,e))).forEach((t=>e.remove(t)));s.reverse().forEach(((t,i)=>{const n=s[i+1];t.previousSibling===n&&(e.appendElement("softBreak",n),e.merge(e.createPositionBefore(t)))}))}_removeCodeBlock(e,t){const i=t.filter((e=>e.is("element","codeBlock")));for(const n of i){const t=e.createRangeOn(n);for(const i of Array.from(t.getItems()).reverse())if(i.is("element","softBreak")&&i.parent.is("element","codeBlock")){const{position:t}=e.split(e.createPositionBefore(i));e.rename(t.nodeAfter,"paragraph"),e.removeAttribute("language",t.nodeAfter),e.remove(i)}e.rename(n,"paragraph"),e.removeAttribute("language",n)}}}function Sm(e,t){return!t.is("rootElement")&&!e.isLimit(t)&&e.checkChild(t.parent,"codeBlock")}function Vm(e,t,i){return e.language?e.language:e.usePreviousLanguageChoice&&t?t:i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Im extends b.Z{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor,t=e.model;t.change((e=>{const i=Em(t);for(const t of i)e.insertText(this._indentSequence,t)}))}_checkEnabled(){return!!this._indentSequence&&Tm(this.editor.model.document.selection)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nm extends b.Z{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor,t=e.model;t.change((e=>{const i=Em(t);for(const t of i){const i=Rm(this.editor.model,t,this._indentSequence);i&&e.remove(i)}}))}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return!!Tm(e.document.selection)&&Em(e).some((t=>Rm(e,t,this._indentSequence)))}}function Rm(e,t,i){const n=Dm(t);if(!n)return null;const s=xm(n),o=s.lastIndexOf(i);if(o+i.length!==s.length)return null;if(-1===o)return null;const{parent:r,startOffset:a}=n;return e.createRange(e.createPositionAt(r,a+o),e.createPositionAt(r,a+o+i.length))}function Dm(e){let t=e.parent.getChild(e.index);return t&&!t.is("element","softBreak")||(t=e.nodeBefore),!t||t.is("element","softBreak")?null:t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bm(e,t,i=!1){const n=km(t,"language","class"),s=km(t,"language","label");return(t,o,r)=>{const{writer:a,mapper:l,consumable:c}=r;if(!c.consume(o.item,"insert"))return;const d=o.item.getAttribute("language"),h=l.toViewPosition(e.createPositionBefore(o.item)),u={};i&&(u["data-language"]=s[d],u.spellcheck="false");const m=a.createContainerElement("pre",u),g=a.createContainerElement("code",{class:n[d]||null});a.insert(a.createPositionAt(m,0),g),a.insert(h,m),l.bindElements(o.item,g)}}function Mm(e){return(t,i,n)=>{if("codeBlock"!==i.item.parent.name)return;const{writer:s,mapper:o,consumable:r}=n;if(!r.consume(i.item,"insert"))return;const a=o.toViewPosition(e.createPositionBefore(i.item));s.insert(a,s.createText("\n"))}}function Om(e,t){const i=km(t,"class","language"),n=t[0].language;return(e,t,s)=>{const o=t.viewItem,r=o.parent;if(!r||!r.is("element","pre"))return;if(t.modelCursor.findAncestor("codeBlock"))return;const{consumable:a,writer:l}=s;if(!a.test(o,{name:!0}))return;const c=l.createElement("codeBlock"),d=[...o.getClassNames()];d.length||d.push("");for(const n of d){const e=i[n];if(e){l.setAttribute("language",e,c);break}}c.hasAttribute("language")||l.setAttribute("language",n,c),s.convertChildren(o,c),s.safeInsert(c,t.modelCursor)&&(a.consume(o,{name:!0}),s.updateConversionResult(c,t))}}function Lm(){return(e,t,{consumable:i,writer:n})=>{let s=t.modelCursor;if(!i.test(t.viewItem))return;if(!s.findAncestor("codeBlock"))return;i.consume(t.viewItem);const o=t.viewItem.data,r=o.split("\n").map((e=>n.createText(e))),a=r[r.length-1];for(const l of r)if(n.insert(l,s),s=s.getShiftedBy(l.offsetSize),l!==a){const e=n.createElement("softBreak");n.insert(e,s),s=n.createPositionAfter(e)}t.modelRange=n.createRange(t.modelCursor,s),t.modelCursor=s}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Fm="paragraph";class zm extends a.Z{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[gm]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"\t"})}init(){const e=this.editor,t=e.model.schema,i=e.model,n=e.editing.view,s=Cm(e);e.commands.add("codeBlock",new Pm(e)),e.commands.add("indentCodeBlock",new Im(e)),e.commands.add("outdentCodeBlock",new Nm(e));const o=e=>(t,i)=>{const n=this.editor.commands.get(e);n.isEnabled&&(this.editor.execute(e),i())};e.keystrokes.set("Tab",o("indentCodeBlock")),e.keystrokes.set("Shift+Tab",o("outdentCodeBlock")),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",isBlock:!0,allowAttributes:["language"]}),t.addAttributeCheck((e=>{if(e.endsWith("codeBlock $text"))return!1})),e.model.schema.addChildCheck(((e,t)=>{if(e.endsWith("codeBlock")&&t.isObject)return!1})),e.editing.downcastDispatcher.on("insert:codeBlock",Bm(i,s,!0)),e.data.downcastDispatcher.on("insert:codeBlock",Bm(i,s)),e.data.downcastDispatcher.on("insert:softBreak",Mm(i),{priority:"high"}),e.data.upcastDispatcher.on("element:code",Om(n,s)),e.data.upcastDispatcher.on("text",Lm()),this.listenTo(e.editing.view.document,"clipboardInput",((t,n)=>{let s=i.createRange(i.document.selection.anchor);if(n.targetRanges&&(s=e.editing.mapper.toModelRange(n.targetRanges[0])),!s.start.parent.is("element","codeBlock"))return;const o=n.dataTransfer.getData("text/plain"),r=new vh(e.editing.view.document);n.content=Am(r,o)})),this.listenTo(i,"getSelectedContent",((e,[n])=>{const s=n.anchor;!n.isCollapsed&&s.parent.is("element","codeBlock")&&s.hasSameParentAs(n.focus)&&i.change((i=>{const o=e.return;if(o.childCount>1||n.containsEntireContent(s.parent)){const t=i.createElement("codeBlock",s.parent.getAttributes());i.append(o,t);const n=i.createDocumentFragment();i.append(t,n),e.return=n}else{const e=o.getChild(0);t.checkAttribute(e,"code")&&i.setAttribute("code",!0,e)}}))}))}afterInit(){const e=this.editor,t=e.commands,i=t.get("indent"),n=t.get("outdent");i&&i.registerChildCommand(t.get("indentCodeBlock")),n&&n.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",((t,i)=>{const n=e.model.document.selection.getLastPosition().parent;n.is("element","codeBlock")&&(Zm(e,i.isSoft)||Hm(e,i.isSoft)||$m(e),i.preventDefault(),t.stop())}),{context:"pre"})}}function $m(e){const t=e.model,i=t.document,n=i.selection.getLastPosition(),s=n.nodeBefore||n.textNode;let o;s&&s.is("$text")&&(o=xm(s)),e.model.change((t=>{e.execute("shiftEnter"),o&&t.insertText(o,i.selection.anchor)}))}function Zm(e,t){const i=e.model,n=i.document,s=e.editing.view,o=n.selection.getLastPosition(),r=o.nodeAfter;return!(t||!n.selection.isCollapsed||!o.isAtStart)&&(!!Wm(r)&&(e.model.change((t=>{e.execute("enter");const i=n.selection.anchor.parent.previousSibling;t.rename(i,Fm),t.setSelection(i,"in"),e.model.schema.removeDisallowedAttributes([i],t),t.remove(r)})),s.scrollToTheSelection(),!0))}function Hm(e,t){const i=e.model,n=i.document,s=e.editing.view,o=n.selection.getLastPosition(),r=o.nodeBefore;let a;if(t||!n.selection.isCollapsed||!o.isAtEnd||!r||!r.previousSibling)return!1;if(Wm(r)&&Wm(r.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling),i.createPositionAfter(r));else if(Um(r)&&Wm(r.previousSibling)&&Wm(r.previousSibling.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling),i.createPositionAfter(r));else{if(!(Um(r)&&Wm(r.previousSibling)&&Um(r.previousSibling.previousSibling)&&Wm(r.previousSibling.previousSibling.previousSibling)))return!1;a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling.previousSibling),i.createPositionAfter(r))}return e.model.change((t=>{t.remove(a),e.execute("enter");const i=n.selection.anchor.parent;t.rename(i,Fm),e.model.schema.removeDisallowedAttributes([i],t)})),s.scrollToTheSelection(),!0}function Um(e){return e&&e.is("$text")&&!e.data.match(/\S/)}function Wm(e){return e&&e.is("element","softBreak")}var qm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gm extends a.Z{static get pluginName(){return"CodeBlockUI"}init(){const e=this.editor,t=e.t,i=e.ui.componentFactory,n=Cm(e);i.add("codeBlock",(i=>{const s=e.commands.get("codeBlock"),o=vc(i,Ql),r=o.buttonView;return r.set({label:t("Insert code block"),tooltip:!0,icon:qm,isToggleable:!0}),r.bind("isOn").to(s,"value",(e=>!!e)),r.on("execute",(()=>{e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus()})),o.on("execute",(t=>{e.execute("codeBlock",{language:t.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()})),o.class="ck-code-block-dropdown",o.bind("isEnabled").to(s),yc(o,this._getLanguageListItemDefinitions(n)),o}))}_getLanguageListItemDefinitions(e){const t=this.editor,i=t.commands.get("codeBlock"),n=new P.Z;for(const s of e){const e={type:"button",model:new Lc({_codeBlockLanguage:s.language,label:s.label,withText:!0})};e.model.bind("isOn").to(i,"value",(t=>t===e.model._codeBlockLanguage)),n.add(e)}return n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jm extends a.Z{static get requires(){return[zm,Gm]}static get pluginName(){return"CodeBlock"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Km extends ya{constructor(e,t){super(e),this.view=t,this._toolbarConfig=hc(e.config.get("toolbar")),this._elementReplacer=new Bi}get element(){return this.view.element}init(e){const t=this.editor,i=this.view,n=t.editing.view,s=i.editable,o=n.document.getRoot();s.name=o.rootName,i.render();const r=s.element;this.setEditableElement(s.name,r),this.focusTracker.add(r),i.editable.bind("isFocused").to(this.focusTracker),n.attachDomRoot(r),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy(),super.destroy()}_initToolbar(){const e=this.editor,t=this.view,i=e.editing.view;t.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),t.stickyPanel.limiterElement=t.element,t.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",(({top:e})=>e)),t.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),ed({origin:i,originFocusTracker:this.focusTracker,originKeystrokeHandler:e.keystrokes,toolbar:t.toolbar})}_initPlaceholder(){const e=this.editor,t=e.editing.view,i=t.document.getRoot(),n=e.sourceElement,s=e.config.get("placeholder")||n&&"textarea"===n.tagName.toLowerCase()&&n.getAttribute("placeholder");s&&Yd({view:t,element:i,text:s,isDirectHost:!1,keepOnFocus:!0})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jm extends Pc{constructor(e,t,i={}){super(e),this.stickyPanel=new Qc(e),this.toolbar=new uc(e,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),this.editable=new Vc(e,t)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ym extends ba{constructor(e,t){super(t),x(e)&&(this.sourceElement=e),this.model.document.createRoot();const i=!this.config.get("toolbar.shouldNotGroupWhenFull"),n=new Jm(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:i});this.ui=new Km(this,n),ka(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise((i=>{const n=new this(e,t);i(n.initPlugins().then((()=>n.ui.init(x(e)?e:null))).then((()=>{if(!x(e)&&t.initialData)throw new S.ZP("editor-create-initial-data",null);const i=void 0!==t.initialData?t.initialData:Qm(e);return n.data.init(i)})).then((()=>n.fire("ready"))).then((()=>n)))}))}}function Qm(e){return x(e)?Zi(e):e}(0,I.Z)(Ym,Aa),(0,I.Z)(Ym,Pa);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xm{constructor(e){this.files=eg(e),this._native=e}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}get isCanceled(){return"none"==this._native.dropEffect||!!this._native.mozUserCancelled}}function eg(e){const t=Array.from(e.files||[]),i=Array.from(e.items||[]);return t.length?t:i.filter((e=>"file"===e.kind)).map((e=>e.getAsFile()))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tg extends Ti{constructor(e){super(e);const t=this.document;function i(e){return(i,n)=>{n.preventDefault();const s=n.dropRange?[n.dropRange]:null,o=new qe.Z(t,e);t.fire(o,{dataTransfer:n.dataTransfer,method:i.name,targetRanges:s,target:n.target}),o.stop.called&&n.stopPropagation()}}this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"],this.listenTo(t,"paste",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",i("dragging"),{priority:"low"})}onDomEvent(e){const t={dataTransfer:new Xm(e.clipboardData?e.clipboardData:e.dataTransfer)};"drop"!=e.type&&"dragover"!=e.type||(t.dropRange=ig(this.view,e)),this.fire(e.type,e,t)}}function ig(e,t){const i=t.target.ownerDocument,n=t.clientX,s=t.clientY;let o;return i.caretRangeFromPoint&&i.caretRangeFromPoint(n,s)?o=i.caretRangeFromPoint(n,s):t.rangeParent&&(o=i.createRange(),o.setStart(t.rangeParent,t.rangeOffset),o.collapse(!0)),o?e.domConverter.domRangeToView(o):null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ng(e){return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(e.includes("</p><p>")||e.includes("<br>"))&&(e=`<p>${e}</p>`),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function sg(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,((e,t)=>1==t.length?" ":t)).replace(/<!--[\s\S]*?-->/g,"")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const og=["figcaption","li"];function rg(e){let t="";if(e.is("$text")||e.is("$textProxy"))t=e.data;else if(e.is("element","img")&&e.hasAttribute("alt"))t=e.getAttribute("alt");else if(e.is("element","br"))t="\n";else{let i=null;for(const n of e.getChildren()){const e=rg(n);i&&(i.is("containerElement")||n.is("containerElement"))&&(og.includes(i.name)||og.includes(n.name)?t+="\n":t+="\n\n"),t+=e,i=n}}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ag extends a.Z{static get pluginName(){return"ClipboardPipeline"}init(){const e=this.editor,t=e.editing.view;t.addObserver(tg),this._setupPasteDrop(),this._setupCopyCut()}_setupPasteDrop(){const e=this.editor,t=e.model,i=e.editing.view,n=i.document;this.listenTo(n,"clipboardInput",(t=>{e.isReadOnly&&t.stop()}),{priority:"highest"}),this.listenTo(n,"clipboardInput",((e,t)=>{const n=t.dataTransfer;let s=t.content||"";s||(n.getData("text/html")?s=sg(n.getData("text/html")):n.getData("text/plain")&&(s=ng(n.getData("text/plain"))),s=this.editor.data.htmlProcessor.toView(s));const o=new qe.Z(this,"inputTransformation");this.fire(o,{content:s,dataTransfer:n,targetRanges:t.targetRanges,method:t.method}),o.stop.called&&e.stop(),i.scrollToTheSelection()}),{priority:"low"}),this.listenTo(this,"inputTransformation",((e,i)=>{if(i.content.isEmpty)return;const n=this.editor.data,s=n.toModel(i.content,"$clipboardHolder");0!=s.childCount&&(e.stop(),t.change((()=>{this.fire("contentInsertion",{content:s,method:i.method,dataTransfer:i.dataTransfer,targetRanges:i.targetRanges})})))}),{priority:"low"}),this.listenTo(this,"contentInsertion",((e,i)=>{i.resultRange=t.insertContent(i.content)}),{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,i=e.editing.view,n=i.document;function s(i,s){const o=s.dataTransfer;s.preventDefault();const r=e.data.toView(e.model.getSelectedContent(t.selection));n.fire("clipboardOutput",{dataTransfer:o,content:r,method:i.name})}this.listenTo(n,"copy",s,{priority:"low"}),this.listenTo(n,"cut",((t,i)=>{e.isReadOnly?i.preventDefault():s(t,i)}),{priority:"low"}),this.listenTo(n,"clipboardOutput",((i,n)=>{n.content.isEmpty||(n.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(n.content)),n.dataTransfer.setData("text/plain",rg(n.content))),"cut"==n.method&&e.model.deleteContent(t.selection)}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lg{constructor(){this._stack=[]}add(e,t){const i=this._stack,n=i[0];this._insertDescriptor(e);const s=i[0];n===s||cg(n,s)||this.fire("change:top",{oldDescriptor:n,newDescriptor:s,writer:t})}remove(e,t){const i=this._stack,n=i[0];this._removeDescriptor(e);const s=i[0];n===s||cg(n,s)||this.fire("change:top",{oldDescriptor:n,newDescriptor:s,writer:t})}_insertDescriptor(e){const t=this._stack,i=t.findIndex((t=>t.id===e.id));if(cg(e,t[i]))return;i>-1&&t.splice(i,1);let n=0;while(t[n]&&dg(t[n],e))n++;t.splice(n,0,e)}_removeDescriptor(e){const t=this._stack,i=t.findIndex((t=>t.id===e));i>-1&&t.splice(i,1)}}function cg(e,t){return e&&t&&e.priority==t.priority&&hg(e.classes)==hg(t.classes)}function dg(e,t){return e.priority>t.priority||!(e.priority<t.priority)&&hg(e.classes)>hg(t.classes)}function hg(e){return Array.isArray(e)?e.sort().join(","):e}(0,I.Z)(lg,V.ZP);var ug='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const mg="ck-widget",gg="ck-widget_selected";function pg(e){return!!e.is("element")&&!!e.getCustomProperty("widget")}function fg(e,t,i={}){if(!e.is("containerElement"))throw new S.ZP("widget-to-widget-wrong-element-type",null,{element:e});return t.setAttribute("contenteditable","false",e),t.addClass(mg,e),t.setCustomProperty("widget",!0,e),e.getFillerOffset=xg,i.label&&_g(e,i.label,t),i.hasSelectionHandle&&Ag(e,t),vg(e,t),e}function wg(e,t,i){if(t.classes&&i.addClass((0,R.Z)(t.classes),e),t.attributes)for(const n in t.attributes)i.setAttribute(n,t.attributes[n],e)}function bg(e,t,i){if(t.classes&&i.removeClass((0,R.Z)(t.classes),e),t.attributes)for(const n in t.attributes)i.removeAttribute(n,e)}function vg(e,t,i=wg,n=bg){const s=new lg;s.on("change:top",((t,s)=>{s.oldDescriptor&&n(e,s.oldDescriptor,s.writer),s.newDescriptor&&i(e,s.newDescriptor,s.writer)})),t.setCustomProperty("addHighlight",((e,t,i)=>s.add(t,i)),e),t.setCustomProperty("removeHighlight",((e,t,i)=>s.remove(t,i)),e)}function _g(e,t,i){i.setCustomProperty("widgetLabel",t,e)}function yg(e){const t=e.getCustomProperty("widgetLabel");return t?"function"==typeof t?t():t:""}function Cg(e,t){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],e),t.setAttribute("contenteditable",e.isReadOnly?"false":"true",e),e.on("change:isReadOnly",((i,n,s)=>{t.setAttribute("contenteditable",s?"false":"true",e)})),e.on("change:isFocused",((i,n,s)=>{s?t.addClass("ck-editor__nested-editable_focused",e):t.removeClass("ck-editor__nested-editable_focused",e)})),vg(e,t),e}function kg(e,t){const i=e.getSelectedElement();if(i){const n=Ig(e);if(n)return t.createRange(t.createPositionAt(i,n));if(t.schema.isObject(i)&&!t.schema.isInline(i))return t.createRangeOn(i)}const n=e.getSelectedBlocks().next().value;if(n){if(n.isEmpty)return t.createRange(t.createPositionAt(n,0));const i=t.createPositionAfter(n);return e.focus.isTouching(i)?t.createRange(i):t.createRange(t.createPositionBefore(n))}return t.createRange(e.focus)}function xg(){return null}function Ag(e,t){const i=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},(function(e){const t=this.toDomElement(e),i=new Jl.Z;return i.set("content",ug),i.render(),t.appendChild(i.element),t}));t.insert(t.createPositionAt(e,0),i),t.addClass(["ck-widget_with-selection-handle"],e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Eg="widget-type-around";function Tg(e,t,i){return e&&pg(e)&&!i.isInline(t)}function Pg(e){return e.closest(".ck-widget__type-around__button")}function Sg(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function Vg(e,t){const i=e.closest(".ck-widget");return t.mapDomToView(i)}function Ig(e){return e.getAttribute(Eg)}var Ng='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Rg=["before","after"],Dg=(new DOMParser).parseFromString(Ng,"image/svg+xml").firstChild,Bg="ck-widget__type-around_disabled";class Mg extends a.Z{static get pluginName(){return"WidgetTypeAround"}static get requires(){return[lm,Cd]}constructor(e){super(e),this._currentFakeCaretModelElement=null}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",((i,n,s)=>{t.change((e=>{for(const i of t.document.roots)s?e.removeClass(Bg,i):e.addClass(Bg,i)})),s||e.model.change((e=>{e.removeSelectionAttribute(Eg)}))})),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableDeleteContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const i=this.editor,n=i.editing.view;i.execute("insertParagraph",{position:i.model.createPositionAt(e,t)}),n.focus(),n.scrollToTheSelection()}_listenToIfEnabled(e,t,i,n){this.listenTo(e,t,((...e)=>{this.isEnabled&&i(...e)}),n)}_insertParagraphAccordingToFakeCaretPosition(){const e=this.editor,t=e.model,i=t.document.selection,n=Ig(i);if(!n)return!1;const s=i.getSelectedElement();return this._insertParagraph(s,n),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,i=e.locale.t,n={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",((e,i,s)=>{const o=s.mapper.toViewElement(i.item);Tg(o,i.item,t)&&Og(s.writer,n,o)}),{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,i=t.document.selection,n=t.schema,s=e.editing.view;function o(e){return`ck-widget_type-around_show-fake-caret_${e}`}this._listenToIfEnabled(s.document,"arrowKey",((e,t)=>{this._handleArrowKeyPress(e,t)}),{context:[pg,"$text"],priority:"high"}),this._listenToIfEnabled(i,"change:range",((t,i)=>{i.directChange&&e.model.change((e=>{e.removeSelectionAttribute(Eg)}))})),this._listenToIfEnabled(t.document,"change:data",(()=>{const t=i.getSelectedElement();if(t){const i=e.editing.mapper.toViewElement(t);if(Tg(i,t,n))return}e.model.change((e=>{e.removeSelectionAttribute(Eg)}))})),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",((e,t,i)=>{const s=i.writer;if(this._currentFakeCaretModelElement){const e=i.mapper.toViewElement(this._currentFakeCaretModelElement);e&&(s.removeClass(Rg.map(o),e),this._currentFakeCaretModelElement=null)}const r=t.selection.getSelectedElement();if(!r)return;const a=i.mapper.toViewElement(r);if(!Tg(a,r,n))return;const l=Ig(t.selection);l&&(s.addClass(o(l),a),this._currentFakeCaretModelElement=r)})),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",((t,i,n)=>{n||e.model.change((e=>{e.removeSelectionAttribute(Eg)}))}))}_handleArrowKeyPress(e,t){const i=this.editor,n=i.model,s=n.document.selection,o=n.schema,r=i.editing.view,a=t.keyCode,l=(0,ct.Zt)(a,i.locale.contentLanguageDirection),c=r.document.selection.getSelectedElement(),d=i.editing.mapper.toModelElement(c);let h;Tg(c,d,o)?h=this._handleArrowKeyPressOnSelectedWidget(l):s.isCollapsed?h=this._handleArrowKeyPressWhenSelectionNextToAWidget(l):t.shiftKey||(h=this._handleArrowKeyPressWhenNonCollapsedSelection(l)),h&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const t=this.editor,i=t.model,n=i.document.selection,s=Ig(n);return i.change((t=>{if(!s)return t.setSelectionAttribute(Eg,e?"after":"before"),!0;{const i=s===(e?"after":"before");if(!i)return t.removeSelectionAttribute(Eg),!0}return!1}))}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,i=t.model,n=i.schema,s=t.plugins.get("Widget"),o=s._getObjectElementNextToSelection(e),r=t.editing.mapper.toViewElement(o);return!!Tg(r,o,n)&&(i.change((t=>{s._setSelectionOverElement(o),t.setSelectionAttribute(Eg,e?"before":"after")})),!0)}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,i=t.model,n=i.schema,s=t.editing.mapper,o=i.document.selection,r=e?o.getLastPosition().nodeBefore:o.getFirstPosition().nodeAfter,a=s.toViewElement(r);return!!Tg(a,r,n)&&(i.change((t=>{t.setSelection(r,"on"),t.setSelectionAttribute(Eg,e?"after":"before")})),!0)}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",((i,n)=>{const s=Pg(n.domTarget);if(!s)return;const o=Sg(s),r=Vg(s,t.domConverter),a=e.editing.mapper.toModelElement(r);this._insertParagraph(a,o),n.preventDefault(),i.stop()}))}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,i=e.editing.view;this._listenToIfEnabled(i.document,"enter",((i,n)=>{if("atTarget"!=i.eventPhase)return;const s=t.getSelectedElement(),o=e.editing.mapper.toViewElement(s),r=e.model.schema;let a;this._insertParagraphAccordingToFakeCaretPosition()?a=!0:Tg(o,s,r)&&(this._insertParagraph(s,n.isSoft?"before":"after"),a=!0),a&&(n.preventDefault(),i.stop())}),{context:pg})}_enableInsertingParagraphsOnTypingKeystroke(){const e=this.editor,t=e.editing.view,i=[ct.Do.enter,ct.Do["delete"],ct.Do.backspace];this._listenToIfEnabled(t.document,"keydown",((e,t)=>{i.includes(t.keyCode)||md(t)||this._insertParagraphAccordingToFakeCaretPosition()}),{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,i=e.model,n=i.schema;this._listenToIfEnabled(t.document,"delete",((t,s)=>{if("atTarget"!=t.eventPhase)return;const o=Ig(i.document.selection);if(!o)return;const r=s.direction,a=i.document.selection.getSelectedElement(),l="before"===o,c="forward"==r,d=l===c;if(d)e.execute("delete",{selection:i.createSelection(a,"on")});else{const t=n.getNearestSelectionRange(i.createPositionAt(a,o),r);if(t)if(t.isCollapsed){const s=i.createSelection(t.start);if(i.modifySelection(s,{direction:r}),s.focus.isEqual(t.start)){const e=zg(n,t.start.parent);i.deleteContent(i.createSelection(e,"on"),{doNotAutoparagraph:!0})}else i.change((i=>{i.setSelection(t),e.execute(c?"deleteForward":"delete")}))}else i.change((i=>{i.setSelection(t),e.execute(c?"deleteForward":"delete")}))}s.preventDefault(),t.stop()}),{context:pg})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",((e,[n,s])=>{if(s&&!s.is("documentSelection"))return;const o=Ig(i);return o?(e.stop(),t.change((e=>{const s=i.getSelectedElement(),r=t.createPositionAt(s,o),a=e.createSelection(r),l=t.insertContent(n,a);return e.setSelection(a),l}))):void 0}),{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"deleteContent",((e,[t])=>{if(t&&!t.is("documentSelection"))return;const n=Ig(i);n&&e.stop()}),{priority:"high"})}}function Og(e,t,i){const n=e.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},(function(e){const i=this.toDomElement(e);return Lg(i,t),Fg(i),i}));e.insert(e.createPositionAt(i,"end"),n)}function Lg(e,t){for(const i of Rg){const n=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${i}`],title:t[i]},children:[e.ownerDocument.importNode(Dg,!0)]});e.appendChild(n.render())}}function Fg(e){const t=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render())}function zg(e,t){let i=t;for(const n of t.getAncestors({parentFirst:!0})){if(n.childCount>1||e.isLimit(n))break;i=n}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $g(e){const t=e.model;return(i,n)=>{const s=n.keyCode==ct.Do.arrowup,o=n.keyCode==ct.Do.arrowdown,r=n.shiftKey,a=t.document.selection;if(!s&&!o)return;const l=o;if(r&&qg(a,l))return;const c=Zg(e,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return}(c.isCollapsed||Wg(e,c,l))&&(t.change((e=>{const i=l?c.end:c.start;if(r){const n=t.createSelection(a.anchor);n.setFocus(i),e.setSelection(n)}else e.setSelection(i)})),i.stop(),n.preventDefault(),n.stopPropagation())}}}function Zg(e,t,i){const n=e.model;if(i){const e=t.isCollapsed?t.focus:t.getLastPosition(),i=Hg(n,e,"forward");if(!i)return null;const s=n.createRange(e,i),o=Ug(n.schema,s,"backward");return o?n.createRange(e,o):null}{const e=t.isCollapsed?t.focus:t.getFirstPosition(),i=Hg(n,e,"backward");if(!i)return null;const s=n.createRange(i,e),o=Ug(n.schema,s,"forward");return o?n.createRange(o,e):null}}function Hg(e,t,i){const n=e.schema,s=e.createRangeIn(t.root),o="forward"==i?"elementStart":"elementEnd";for(const{previousPosition:r,item:a,type:l}of s.getWalker({startPosition:t,direction:i})){if(n.isLimit(a)&&!n.isInline(a))return r;if(l==o&&n.isBlock(a))return null}return null}function Ug(e,t,i){const n="backward"==i?t.end:t.start;if(e.checkChild(n,"$text"))return n;for(const{nextPosition:s}of t.getWalker({direction:i}))if(e.checkChild(s,"$text"))return s;return null}function Wg(e,t,i){const n=e.model,s=e.view.domConverter;if(i){const e=n.createSelection(t.start);n.modifySelection(e),e.focus.isAtEnd||t.start.isEqual(e.focus)||(t=n.createRange(e.focus,t.end))}const o=e.mapper.toViewRange(t),r=s.viewRangeToDom(o),a=Gi.getDomRangeRects(r);let l;for(const c of a)if(void 0!==l){if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}else l=Math.round(c.bottom);return!0}function qg(e,t){return!e.isCollapsed&&e.isBackward==t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gg extends a.Z{static get pluginName(){return"Widget"}static get requires(){return[Mg,Cd]}init(){const e=this.editor,t=e.editing.view,i=t.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",((t,i,n)=>{const s=n.writer,o=i.selection;if(o.isCollapsed)return;const r=o.getSelectedElement();if(!r)return;const a=e.editing.mapper.toViewElement(r);pg(a)&&n.consumable.consume(o,"selection")&&s.setSelection(s.createRangeOn(a),{fake:!0,label:yg(a)})})),this.editor.editing.downcastDispatcher.on("selection",((e,t,i)=>{this._clearPreviouslySelectedWidgets(i.writer);const n=i.writer,s=n.document.selection;let o=null;for(const r of s.getRanges())for(const e of r){const t=e.item;pg(t)&&!Kg(t,o)&&(n.addClass(gg,t),this._previouslySelected.add(t),o=t)}}),{priority:"low"}),t.addObserver(bh),this.listenTo(i,"mousedown",((...e)=>this._onMousedown(...e))),this.listenTo(i,"arrowKey",((...e)=>{this._handleSelectionChangeOnArrowKeyPress(...e)}),{context:[pg,"$text"]}),this.listenTo(i,"arrowKey",((...e)=>{this._preventDefaultOnArrowKeyPress(...e)}),{context:"$root"}),this.listenTo(i,"arrowKey",$g(this.editor.editing),{context:"$text"}),this.listenTo(i,"delete",((e,t)=>{this._handleDelete("forward"==t.direction)&&(t.preventDefault(),e.stop())}),{context:"$root"})}_onMousedown(e,t){const i=this.editor,n=i.editing.view,s=n.document;let o=t.target;if(jg(o)){if((Yt.ZP.isSafari||Yt.ZP.isGecko)&&t.domEvent.detail>=3){const e=i.editing.mapper,n=o.is("attributeElement")?o.findAncestor((e=>!e.is("attributeElement"))):o,s=e.toModelElement(n);t.preventDefault(),this.editor.model.change((e=>{e.setSelection(s,"in")}))}return}if(!pg(o)&&(o=o.findAncestor(pg),!o))return;Yt.ZP.isAndroid&&t.preventDefault(),s.isFocused||n.focus();const r=i.editing.mapper.toModelElement(o);this._setSelectionOverElement(r)}_handleSelectionChangeOnArrowKeyPress(e,t){const i=t.keyCode,n=this.editor.model,s=n.schema,o=n.document.selection,r=o.getSelectedElement(),a=(0,ct.mA)(i,this.editor.locale.contentLanguageDirection),l="down"==a||"right"==a,c="up"==a||"down"==a;if(r&&s.isObject(r)){const i=l?o.getLastPosition():o.getFirstPosition(),r=s.getNearestSelectionRange(i,l?"forward":"backward");return void(r&&(n.change((e=>{e.setSelection(r)})),t.preventDefault(),e.stop()))}if(!o.isCollapsed&&!t.shiftKey){const i=o.getFirstPosition(),r=o.getLastPosition(),a=i.nodeAfter,c=r.nodeBefore;return void((a&&s.isObject(a)||c&&s.isObject(c))&&(n.change((e=>{e.setSelection(l?r:i)})),t.preventDefault(),e.stop()))}if(!o.isCollapsed)return;const d=this._getObjectElementNextToSelection(l);if(d&&s.isObject(d)){if(s.isInline(d)&&c)return;this._setSelectionOverElement(d),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const i=this.editor.model,n=i.schema,s=i.document.selection.getSelectedElement();s&&n.isObject(s)&&(t.preventDefault(),e.stop())}_handleDelete(e){if(this.editor.isReadOnly)return;const t=this.editor.model.document,i=t.selection;if(!i.isCollapsed)return;const n=this._getObjectElementNextToSelection(e);return n?(this.editor.model.change((e=>{let t=i.anchor.parent;while(t.isEmpty){const i=t;t=i.parent,e.remove(i)}this._setSelectionOverElement(n)})),!0):void 0}_setSelectionOverElement(e){this.editor.model.change((t=>{t.setSelection(t.createRangeOn(e))}))}_getObjectElementNextToSelection(e){const t=this.editor.model,i=t.schema,n=t.document.selection,s=t.createSelection(n);if(t.modifySelection(s,{direction:e?"forward":"backward"}),s.isEqual(n))return null;const o=e?s.focus.nodeBefore:s.focus.nodeAfter;return o&&i.isObject(o)?o:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(gg,t);this._previouslySelected.clear()}}function jg(e){while(e){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(pg(e))return!1;e=e.parent}return!1}function Kg(e,t){return!!t&&Array.from(e.getAncestors()).includes(t)}var Jg=i(111);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yg extends a.Z{static get pluginName(){return"DragDrop"}static get requires(){return[ag,Gg]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,this._updateDropMarkerThrottled=(0,Jg.Z)((e=>this._updateDropMarker(e)),40),this._removeDropMarkerDelayed=op((()=>this._removeDropMarker()),40),this._clearDraggableAttributesDelayed=op((()=>this._clearDraggableAttributes()),40),t.addObserver(tg),t.addObserver(bh),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDropMarker(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",((e,t,i)=>{i?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})),this.on("change:isEnabled",((e,t,i)=>{i||this._finalizeDragging(!1)})),Yt.ZP.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._updateDropMarkerThrottled.cancel(),this._removeDropMarkerDelayed.cancel(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,i=t.document,n=e.editing.view,s=n.document;this.listenTo(s,"dragstart",((n,o)=>{const r=i.selection;if(o.target&&o.target.is("editableElement"))return void o.preventDefault();const a=o.target?rp(o.target):null;if(a){const i=e.editing.mapper.toModelElement(a);this._draggedRange=qn.fromRange(t.createRangeOn(i)),e.plugins.has("WidgetToolbarRepository")&&e.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop")}else if(!s.selection.isCollapsed){const e=s.selection.getSelectedElement();e&&pg(e)||(this._draggedRange=qn.fromRange(r.getFirstRange()))}if(!this._draggedRange)return void o.preventDefault();this._draggingUid=(0,sn.Z)(),o.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",o.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const l=t.createSelection(this._draggedRange.toRange()),c=e.data.toView(t.getSelectedContent(l));s.fire("clipboardOutput",{dataTransfer:o.dataTransfer,content:c,method:n.name}),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")}),{priority:"low"}),this.listenTo(s,"dragend",((e,t)=>{this._finalizeDragging(!t.dataTransfer.isCanceled&&"move"==t.dataTransfer.dropEffect)}),{priority:"low"}),this.listenTo(s,"dragenter",(()=>{this.isEnabled&&n.focus()})),this.listenTo(s,"dragleave",(()=>{this._removeDropMarkerDelayed()})),this.listenTo(s,"dragging",((t,i)=>{if(!this.isEnabled)return void(i.dataTransfer.dropEffect="none");this._removeDropMarkerDelayed.cancel();const n=Qg(e,i.targetRanges,i.target);this._draggedRange||(i.dataTransfer.dropEffect="copy"),Yt.ZP.isGecko||("copy"==i.dataTransfer.effectAllowed?i.dataTransfer.dropEffect="copy":["all","copyMove"].includes(i.dataTransfer.effectAllowed)&&(i.dataTransfer.dropEffect="move")),n&&this._updateDropMarkerThrottled(n)}),{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"clipboardInput",((t,i)=>{if("drop"!=i.method)return;const n=Qg(e,i.targetRanges,i.target);if(this._removeDropMarker(),!n)return this._finalizeDragging(!1),void t.stop();this._draggedRange&&this._draggingUid!=i.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="");const s="move"==sp(i.dataTransfer);if(s&&this._draggedRange&&this._draggedRange.containsRange(n,!0))return this._finalizeDragging(!1),void t.stop();i.targetRanges=[e.editing.mapper.toViewRange(n)]}),{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(ag);e.on("contentInsertion",((e,t)=>{if(!this.isEnabled||"drop"!==t.method)return;const i=t.targetRanges.map((e=>this.editor.editing.mapper.toModelRange(e)));this.editor.model.change((e=>e.setSelection(i)))}),{priority:"high"}),e.on("contentInsertion",((e,t)=>{if(!this.isEnabled||"drop"!==t.method)return;const i="move"==sp(t.dataTransfer),n=!t.resultRange||!t.resultRange.isCollapsed;this._finalizeDragging(n&&i)}),{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"mousedown",((n,s)=>{if(Yt.ZP.isAndroid||!s)return;this._clearDraggableAttributesDelayed.cancel();let o=rp(s.target);if(Yt.ZP.isBlink&&!e.isReadOnly&&!o&&!i.selection.isCollapsed){const e=i.selection.getSelectedElement();e&&pg(e)||(o=i.selection.editableElement)}o&&(t.change((e=>{e.setAttribute("draggable","true",o)})),this._draggableElement=e.editing.mapper.toModelElement(o))})),this.listenTo(i,"mouseup",(()=>{Yt.ZP.isAndroid||this._clearDraggableAttributesDelayed()}))}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change((t=>{this._draggableElement&&"$graveyard"!=this._draggableElement.root.rootName&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null}))}_setupDropMarker(){const e=this.editor;e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:i})=>{const n=e.model.schema.checkChild(t.markerRange.start,"$text");if(n)return i.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},(function(e){const t=this.toDomElement(e);return t.innerHTML="&NoBreak;<span></span>&NoBreak;",t}))}})}_updateDropMarker(e){const t=this.editor,i=t.model.markers;t.model.change((t=>{i.has("drop-target")?i.get("drop-target").getRange().isEqual(e)||t.updateMarker("drop-target",{range:e}):t.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})}))}_removeDropMarker(){const e=this.editor.model;this._removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),e.markers.has("drop-target")&&e.change((e=>{e.removeMarker("drop-target")}))}_finalizeDragging(e){const t=this.editor,i=t.model;this._removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._draggedRange&&(e&&this.isEnabled&&i.deleteContent(i.createSelection(this._draggedRange),{doNotAutoparagraph:!0}),this._draggedRange.detach(),this._draggedRange=null)}}function Qg(e,t,i){const n=e.model,s=e.editing.mapper;let o=null;const r=t?t[0].start:null;if(i.is("uiElement")&&(i=i.parent),o=Xg(e,i),o)return o;const a=np(e,i),l=r?s.toModelPosition(r):null;return l?(o=tp(e,l,a),o||(o=n.schema.getNearestSelectionRange(l,Yt.ZP.isGecko?"forward":"backward"),o||ip(e,l.parent))):ep(e,a)}function Xg(e,t){const i=e.model,n=e.editing.mapper;if(pg(t))return i.createRangeOn(n.toModelElement(t));if(!t.is("editableElement")){const e=t.findAncestor((e=>pg(e)||e.is("editableElement")));if(pg(e))return i.createRangeOn(n.toModelElement(e))}return null}function ep(e,t){const i=e.model,n=i.schema,s=i.createPositionAt(t,0);return n.getNearestSelectionRange(s,"forward")}function tp(e,t,i){const n=e.model;if(!n.schema.checkChild(i,"$block"))return null;const s=n.createPositionAt(i,0),o=t.path.slice(0,s.path.length),r=n.createPositionFromPath(t.root,o),a=r.nodeAfter;return a&&n.schema.isObject(a)?n.createRangeOn(a):null}function ip(e,t){const i=e.model;while(t){if(i.schema.isObject(t))return i.createRangeOn(t);t=t.parent}}function np(e,t){const i=e.editing.mapper,n=e.editing.view,s=i.toModelElement(t);if(s)return s;const o=n.createPositionBefore(t),r=i.findMappedViewAncestor(o);return i.toModelElement(r)}function sp(e){return Yt.ZP.isGecko?e.dropEffect:["all","copyMove"].includes(e.effectAllowed)?"move":"copy"}function op(e,t){let i;function n(...s){n.cancel(),i=setTimeout((()=>e(...s)),t)}return n.cancel=()=>{clearTimeout(i)},n}function rp(e){if(e.is("editableElement"))return null;if(e.hasClass("ck-widget__selection-handle"))return e.findAncestor(pg);if(pg(e))return e;const t=e.findAncestor((e=>pg(e)||e.is("editableElement")));return pg(t)?t:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ap extends a.Z{static get pluginName(){return"PastePlainText"}static get requires(){return[ag]}init(){const e=this.editor,t=e.model,i=e.editing.view,n=i.document,s=t.document.selection;let o=!1;i.addObserver(tg),this.listenTo(n,"keydown",((e,t)=>{o=t.shiftKey})),e.plugins.get(ag).on("contentInsertion",((e,i)=>{(o||lp(i.content,t.schema))&&t.change((e=>{const n=Array.from(s.getAttributes()).filter((([e])=>t.schema.getAttributeProperties(e).isFormatting));s.isCollapsed||t.deleteContent(s,{doNotAutoparagraph:!0}),n.push(...s.getAttributes());const o=e.createRangeIn(i.content);for(const t of o.getItems())t.is("$textProxy")&&e.setAttributes(n,t)}))}))}}function lp(e,t){if(e.childCount>1)return!1;const i=e.getChild(0);return!t.isObject(i)&&0==[...i.getAttributeKeys()].length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cp extends a.Z{static get pluginName(){return"Clipboard"}static get requires(){return[ag,Yg,ap]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dp extends b.Z{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let i=e.schema.getLimitElement(t);if(t.containsEntireContent(i)||!hp(e.schema,i))do{if(i=i.parent,!i)return}while(!hp(e.schema,i));e.change((e=>{e.setSelection(i,"in")}))}}function hp(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const up=(0,ct.Zz)("Ctrl+A");class mp extends a.Z{static get pluginName(){return"SelectAllEditing"}init(){const e=this.editor,t=e.editing.view,i=t.document;e.commands.add("selectAll",new dp(e)),this.listenTo(i,"keydown",((t,i)=>{(0,ct.Cq)(i)===up&&(e.execute("selectAll"),i.preventDefault())}))}}var gp='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pp extends a.Z{static get pluginName(){return"SelectAllUI"}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",(t=>{const i=e.commands.get("selectAll"),n=new l.Z(t),s=t.t;return n.set({label:s("Select all"),icon:gp,keystroke:"Ctrl+A",tooltip:!0}),n.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute("selectAll"),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fp extends a.Z{static get requires(){return[mp,pp]}static get pluginName(){return"SelectAll"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wp extends b.Z{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this.listenTo(e.data,"set",((e,t)=>{t[1]={...t[1]};const i=t[1];i.batchType||(i.batchType="transparent")}),{priority:"high"}),this.listenTo(e.data,"set",((e,t)=>{const i=t[1];"transparent"===i.batchType&&this.clearStack()}))}refresh(){this.isEnabled=this._stack.length>0}addBatch(e){const t=this.editor.model.document.selection,i={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:i}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,i){const n=this.editor.model,s=n.document,o=[],r=e.map((e=>e.getTransformedByOperations(i))),a=r.flat();for(const l of r){const e=l.filter((e=>e.root!=s.graveyard)).filter((e=>!vp(e,a)));e.length&&(bp(e),o.push(e[0]))}o.length&&n.change((e=>{e.setSelection(o,{backward:t})}))}_undo(e,t){const i=this.editor.model,n=i.document;this._createdBatches.add(t);const s=e.operations.slice().filter((e=>e.isDocumentOperation));s.reverse();for(const o of s){const e=o.baseVersion+1,s=Array.from(n.history.getOperations(e)),r=ch([o.getReversed()],s,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}),a=r.operationsA;for(const l of a)t.addOperation(l),i.applyOperation(l),n.history.setOperationAsUndone(o,l)}}}function bp(e){e.sort(((e,t)=>e.start.isBefore(t.start)?-1:1));for(let t=1;t<e.length;t++){const i=e[t-1],n=i.getJoined(e[t],!0);n&&(t--,e.splice(t,2,n))}}function vp(e,t){return t.some((t=>t!==e&&t.containsRange(e,!0)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _p extends wp{execute(e=null){const t=e?this._stack.findIndex((t=>t.batch==e)):this._stack.length-1,i=this._stack.splice(t,1)[0],n=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(n,(()=>{this._undo(i.batch,n);const e=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,e),this.fire("revert",i.batch,n)})),this.refresh()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yp extends wp{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(t,(()=>{const i=e.batch.operations[e.batch.operations.length-1],n=i.baseVersion+1,s=this.editor.model.document.history.getOperations(n);this._restoreSelection(e.selection.ranges,e.selection.isBackward,s),this._undo(e.batch,t)})),this.refresh()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cp extends a.Z{static get pluginName(){return"UndoEditing"}constructor(e){super(e),this._batchRegistry=new WeakSet}init(){const e=this.editor;this._undoCommand=new _p(e),this._redoCommand=new yp(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",((e,t)=>{const i=t[0];if(!i.isDocumentOperation)return;const n=i.batch,s=this._redoCommand._createdBatches.has(n),o=this._undoCommand._createdBatches.has(n),r=this._batchRegistry.has(n);r||"transparent"==n.type&&!s&&!o||(s?this._undoCommand.addBatch(n):o||(this._undoCommand.addBatch(n),this._redoCommand.clearStack()),this._batchRegistry.add(n))}),{priority:"highest"}),this.listenTo(this._undoCommand,"revert",((e,t,i)=>{this._redoCommand.addBatch(i)})),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}var kp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',xp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ap extends a.Z{static get pluginName(){return"UndoUI"}init(){const e=this.editor,t=e.locale,i=e.t,n="ltr"==t.uiLanguageDirection?kp:xp,s="ltr"==t.uiLanguageDirection?xp:kp;this._addButton("undo",i("Undo"),"CTRL+Z",n),this._addButton("redo",i("Redo"),"CTRL+Y",s)}_addButton(e,t,i,n){const s=this.editor;s.ui.componentFactory.add(e,(o=>{const r=s.commands.get(e),a=new l.Z(o);return a.set({label:t,icon:n,keystroke:i,tooltip:!0}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",(()=>{s.execute(e),s.editing.view.focus()})),a}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ep extends a.Z{static get requires(){return[Cp,Ap]}static get pluginName(){return"Undo"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tp extends a.Z{static get requires(){return[cp,lm,fp,gm,kd,Ep]}static get pluginName(){return"Essentials"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pp extends cl.Z{constructor(e){super(e);const t=e.t;this.set("matchCount",0),this.set("highlightOffset",0),this.set("isDirty",!1),this.set("_areCommandsEnabled",{}),this.set("_resultsCounterText",""),this.set("_matchCase",!1),this.set("_wholeWordsOnly",!1),this.bind("_searchResultsFound").to(this,"matchCount",this,"isDirty",((e,t)=>e>0&&!t)),this._findInputView=this._createInputField(t("Find in text…")),this._replaceInputView=this._createInputField(t("Replace with…")),this._findButtonView=this._createButton({label:t("Find"),class:"ck-button-find ck-button-action",withText:!0}),this._findPrevButtonView=this._createButton({label:t("Previous result"),class:"ck-button-prev",icon:Wc,keystroke:"Shift+F3",tooltip:!0}),this._findNextButtonView=this._createButton({label:t("Next result"),class:"ck-button-next",icon:Wc,keystroke:"F3",tooltip:!0}),this._optionsDropdown=this._createOptionsDropdown(),this._replaceButtonView=this._createButton({label:t("Replace"),class:"ck-button-replace",withText:!0}),this._replaceAllButtonView=this._createButton({label:t("Replace all"),class:"ck-button-replaceall",withText:!0}),this._findFieldsetView=this._createFindFieldset(),this._replaceFieldsetView=this._createReplaceFieldset(),this._focusTracker=new en,this._keystrokes=new tn,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this._keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-find-and-replace-form"],tabindex:"-1"},children:[new Ic(e,{label:t("Find and replace")}),this._findFieldsetView,this._replaceFieldsetView]}),Bl(this)}render(){super.render(),Ml({view:this}),this._initFocusCycling(),this._initKeystrokeHandling()}destroy(){super.destroy(),this._focusTracker.destroy(),this._keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}reset(){this._findInputView.errorText=null,this.isDirty=!0}get _textToFind(){return this._findInputView.fieldView.element.value}get _textToReplace(){return this._replaceInputView.fieldView.element.value}_createFindFieldset(){const e=this.locale,t=new cl.Z(e);return this._findInputView.fieldView.on("input",(()=>{this.isDirty=!0})),this._findButtonView.on("execute",this._onFindButtonExecute.bind(this)),this._findPrevButtonView.delegate("execute").to(this,"findPrevious"),this._findNextButtonView.delegate("execute").to(this,"findNext"),this._findPrevButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",(({findPrevious:e})=>e)),this._findNextButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",(({findNext:e})=>e)),this._injectFindResultsCounter(),t.setTemplate({tag:"fieldset",attributes:{class:["ck","ck-find-and-replace-form__find"]},children:[this._findInputView,this._findButtonView,this._findPrevButtonView,this._findNextButtonView]}),t}_onFindButtonExecute(){if(this._textToFind)this.isDirty=!1,this.fire("findNext",{searchText:this._textToFind,matchCase:this._matchCase,wholeWords:this._wholeWordsOnly});else{const e=this.t;this._findInputView.errorText=e("Text to find must not be empty.")}}_injectFindResultsCounter(){const e=this.locale,t=e.t,i=this.bindTemplate,n=new cl.Z(e);this.bind("_resultsCounterText").to(this,"highlightOffset",this,"matchCount",((e,i)=>t("%0 of %1",[e,i]))),n.setTemplate({tag:"span",attributes:{class:["ck","ck-results-counter",i.if("isDirty","ck-hidden")]},children:[{text:i.to("_resultsCounterText")}]});const s=()=>{const t=this._findInputView.fieldView.element;if(!t||!t.offsetParent)return;const i=new Gi(n.element).width,s="ltr"===e.uiLanguageDirection?"paddingRight":"paddingLeft";t.style[s]=i?`calc( 2 * var(--ck-spacing-standard) + ${i}px )`:null};this.on("change:_resultsCounterText",s,{priority:"low"}),this.on("change:isDirty",s,{priority:"low"}),this._findInputView.template.children[0].children.push(n)}_createReplaceFieldset(){const e=this.locale,t=e.t,i=new cl.Z(e);return this._replaceButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replace:e},t)=>e&&t)),this._replaceAllButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replaceAll:e},t)=>e&&t)),this._replaceInputView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replace:e},t)=>e&&t)),this._replaceInputView.bind("infoText").to(this._replaceInputView,"isEnabled",this._replaceInputView,"isFocused",((e,i)=>e||!i?"":t("Tip: Find some text first in order to replace it."))),this._replaceButtonView.on("execute",(()=>{this.fire("replace",{searchText:this._textToFind,replaceText:this._textToReplace})})),this._replaceAllButtonView.on("execute",(()=>{this.fire("replaceAll",{searchText:this._textToFind,replaceText:this._textToReplace}),this.focus()})),i.setTemplate({tag:"fieldset",attributes:{class:["ck","ck-find-and-replace-form__replace"]},children:[this._replaceInputView,this._optionsDropdown,this._replaceButtonView,this._replaceAllButtonView]}),i}_createOptionsDropdown(){const e=this.locale,t=e.t,i=vc(e);i.class="ck-options-dropdown",i.buttonView.set({withText:!1,label:t("Show options"),icon:ol.cog,tooltip:!0});const n=new Lc({withText:!0,label:t("Match case"),_isMatchCaseSwitch:!0}),s=new Lc({withText:!0,label:t("Whole words only")});return n.bind("isOn").to(this,"_matchCase"),s.bind("isOn").to(this,"_wholeWordsOnly"),i.on("execute",(e=>{e.source._isMatchCaseSwitch?this._matchCase=!this._matchCase:this._wholeWordsOnly=!this._wholeWordsOnly,this.isDirty=!0})),yc(i,new P.Z([{type:"switchbutton",model:n},{type:"switchbutton",model:s}])),i}_initFocusCycling(){const e=[this._findInputView,this._findButtonView,this._findPrevButtonView,this._findNextButtonView,this._replaceInputView,this._optionsDropdown,this._replaceButtonView,this._replaceAllButtonView];e.forEach((e=>{this._focusables.add(e),this._focusTracker.add(e.element)}))}_initKeystrokeHandling(){const e=e=>e.stopPropagation(),t=e=>{e.stopPropagation(),e.preventDefault()};this._keystrokes.listenTo(this.element),this._keystrokes.set("f3",(e=>{t(e),this._findNextButtonView.fire("execute")})),this._keystrokes.set("shift+f3",(e=>{t(e),this._findPrevButtonView.fire("execute")})),this._keystrokes.set("enter",(e=>{const i=e.target;i===this._findInputView.fieldView.element?(this._areCommandsEnabled.findNext?this._findNextButtonView.fire("execute"):this._findButtonView.fire("execute"),t(e)):i!==this._replaceInputView.fieldView.element||this.isDirty||(this._replaceButtonView.fire("execute"),t(e))})),this._keystrokes.set("shift+enter",(e=>{const i=e.target;i===this._findInputView.fieldView.element&&(this._areCommandsEnabled.findPrevious?this._findPrevButtonView.fire("execute"):this._findButtonView.fire("execute"),t(e))})),this._keystrokes.set("arrowright",e),this._keystrokes.set("arrowleft",e),this._keystrokes.set("arrowup",e),this._keystrokes.set("arrowdown",e),this.listenTo(this._findInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"}),this.listenTo(this._replaceInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}_createButton(e){const t=new l.Z(this.locale);return t.set(e),t}_createInputField(e){const t=new Dc(this.locale,Bc);return t.label=e,t}}var Sp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 13.786 1.532-1.286 3.857 4.596a1 1 0 1 1-1.532 1.286l-3.857-4.596z"/><path d="M16.004 8.5a6.5 6.5 0 0 1-9.216 5.905c-1.154-.53-.863-1.415-.663-1.615.194-.194.564-.592 1.635-.141a4.5 4.5 0 0 0 5.89-5.904l-.104-.227 1.332-1.331c.045-.046.196-.041.224.007a6.47 6.47 0 0 1 .902 3.306zm-3.4-5.715c.562.305.742 1.106.354 1.494-.388.388-.995.414-1.476.178a4.5 4.5 0 0 0-6.086 5.882l.114.236-1.348 1.349c-.038.037-.17.022-.198-.023a6.5 6.5 0 0 1 5.54-9.9 6.469 6.469 0 0 1 3.1.784z"/><path d="M4.001 11.93.948 8.877a.2.2 0 0 1 .141-.341h6.106a.2.2 0 0 1 .141.341L4.283 11.93a.2.2 0 0 1-.282 0zm11.083-6.789 3.053 3.053a.2.2 0 0 1-.14.342H11.89a.2.2 0 0 1-.14-.342l3.052-3.053a.2.2 0 0 1 .282 0z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vp extends a.Z{static get pluginName(){return"FindAndReplaceUI"}constructor(e){super(e),this.formView=null}init(){const e=this.editor;e.ui.componentFactory.add("findAndReplace",(t=>{const i=vc(t),n=this.formView=new Pp(e.locale);return i.bind("isEnabled").to(e.commands.get("find")),i.panelView.children.add(n),i.on("change:isOpen",((e,t,i)=>{i?(n.disableCssTransitions(),n.reset(),n._findInputView.fieldView.select(),n.focus(),n.enableCssTransitions()):(n.focus(),this.fire("searchReseted"))}),{priority:"low"}),this._setupDropdownButton(i),this._setupFormView(n),i}))}_setupDropdownButton(e){const t=this.editor,i=t.locale.t;e.buttonView.set({icon:Sp,label:i("Find and replace"),keystroke:"CTRL+F",tooltip:!0}),t.keystrokes.set("Ctrl+F",((t,i)=>{e.isOpen=!0,i()}))}_setupFormView(e){const t=this.editor,i=t.commands,n=this.editor.plugins.get("FindAndReplaceEditing"),s=n.state,o={before:-1,same:0,after:1};e.bind("highlightOffset").to(s,"highlightedResult",(e=>e?Array.from(s.results).sort(((e,t)=>o[e.marker.getStart().compareWith(t.marker.getStart())])).indexOf(e)+1:0)),e.listenTo(s.results,"change",(()=>{e.matchCount=s.results.length})),e.bind("_areCommandsEnabled").to(i.get("findNext"),"isEnabled",i.get("findPrevious"),"isEnabled",i.get("replace"),"isEnabled",i.get("replaceAll"),"isEnabled",((e,t,i,n)=>({findNext:e,findPrevious:t,replace:i,replaceAll:n}))),e.delegate("findNext","findPrevious","replace","replaceAll").to(this),e.on("change:isDirty",((e,t,i)=>{i&&this.fire("searchReseted")}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ip(e,t,i,n){const s=n||new P.Z;return t.change((n=>{[...e].forEach((({type:e,item:o})=>{if("elementStart"===e&&t.schema.checkChild(o,"$text")){const e=i({item:o,text:Np(t.createRangeIn(o))});if(!e)return;e.forEach((e=>{const t=`findResult:${(0,sn.Z)()}`,i=n.addMarker(t,{usingOperation:!1,affectsData:!1,range:n.createRange(n.createPositionAt(o,e.start),n.createPositionAt(o,e.end))}),r=Rp(s,i);s.add({id:t,label:e.label,marker:i},r)}))}}))})),s}function Np(e){return Array.from(e.getItems()).reduce(((e,t)=>t.is("text")||t.is("textProxy")?e+t.data:`${e}\n`),"")}function Rp(e,t){const i=e.find((({marker:e})=>t.getStart().isBefore(e.getStart())));return i?e.getIndex(i):e.length}function Dp(e){const t=e.length-1;let i=e.index;return 3===e.length&&(i+=e[1].length),{label:e[t],start:i,end:i+e[t].length}}function Bp(e,t){let i="gu";t.matchCase||(i+="i");let n=`(${Md(e)})`;if(t.wholeWords){const t="[^a-zA-ZÀ-ɏḀ-ỿ]";new RegExp("^"+t).test(e)||(n=`(^|${t}|_)${n}`),new RegExp(t+"$").test(e)||(n=`${n}(?=_|${t}|$)`)}const s=new RegExp(n,i);function o({text:e}){const t=[...e.matchAll(s)];return t.map(Dp)}return o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mp extends b.Z{constructor(e,t){super(e),this.isEnabled=!0,this.affectsData=!1,this._state=t}execute(e,{matchCase:t,wholeWords:i}={}){const{editor:n}=this,{model:s}=n;let o;"string"===typeof e?(o=Bp(e,{matchCase:t,wholeWords:i}),this._state.searchText=e):o=e;const r=s.document.getRootNames().reduce(((e,t)=>Ip(s.createRangeIn(s.document.getRoot(t)),s,o,e)),null);return this._state.clear(s),this._state.results.addMany(Array.from(r)),this._state.highlightedResult=r.get(0),"string"===typeof e&&(this._state.searchText=e),this._state.matchCase=!!t,this._state.matchWholeWords=!!i,{results:r,findCallback:o}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Op extends b.Z{constructor(e,t){super(e),this.isEnabled=!0,this._state=t}execute(e,t){const{model:i}=this.editor;i.change((n=>{const s=t.marker.getRange();if("$graveyard"===s.root.rootName)return void this._state.results.remove(t);let o={};for(const e of s.getItems())if(e.is("$text")||e.is("$textProxy")){o=e.getAttributes();break}i.insertContent(n.createText(e,o),s),this._state.results.has(t)&&this._state.results.remove(t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lp extends Op{execute(e,t){const{editor:i}=this,{model:n}=i,s=t instanceof P.Z?t:n.document.getRootNames().reduce(((e,i)=>Ip(n.createRangeIn(n.document.getRoot(i)),n,Bp(t,this._state),e)),null);s.length&&n.change((()=>{[...s].forEach((t=>{super.execute(e,t)}))}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fp extends b.Z{constructor(e,t){super(e),this.affectsData=!1,this._state=t,this.isEnabled=!1,this.listenTo(this._state.results,"change",(()=>{this.isEnabled=this._state.results.length>1}))}refresh(){this.isEnabled=this._state.results.length>1}execute(){const e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t+1>=e.length?0:t+1;this._state.highlightedResult=this._state.results.get(i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zp extends Fp{execute(){const e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t-1<0?this._state.results.length-1:t-1;this._state.highlightedResult=this._state.results.get(i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $p{constructor(e){this.set("results",new P.Z),this.set("highlightedResult",null),this.set("searchText",""),this.set("replaceText",""),this.set("matchCase",!1),this.set("matchWholeWords",!1),this.results.on("change",((t,{removed:i,index:n})=>{if(i=Array.from(i),i.length){let t=!1;if(e.change((n=>{for(const s of i)this.highlightedResult===s&&(t=!0),e.markers.has(s.marker.name)&&n.removeMarker(s.marker)})),t){const e=n>=this.results.length?0:n;this.highlightedResult=this.results.get(e)}}}))}clear(e){this.searchText="",e.change((t=>{if(this.highlightedResult){const i=this.highlightedResult.marker.name.split(":")[1],n=e.markers.get(`findResultHighlighted:${i}`);n&&t.removeMarker(n)}[...this.results].forEach((({marker:e})=>{t.removeMarker(e)}))})),this.results.clear()}}(0,I.Z)($p,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Zp="ck-find-result_selected";function Hp(e,t,i){const n=new Set,s=new Set,o=t.document.differ.getChanges();o.forEach((e=>{"$text"===e.name||t.schema.isInline(e.position.nodeAfter)?(n.add(e.position.parent),[...t.markers.getMarkersAtPosition(e.position)].forEach((e=>{s.add(e.name)}))):"insert"===e.type&&n.add(e.position.nodeAfter)})),t.document.differ.getChangedMarkers().forEach((({name:e,data:{newRange:t}})=>{t&&"$graveyard"===t.start.root.rootName&&s.add(e)})),n.forEach((e=>{const i=[...t.markers.getMarkersIntersectingRange(t.createRangeIn(e))];i.forEach((e=>s.add(e.name)))})),t.change((t=>{s.forEach((i=>{e.has(i)&&e.remove(i),t.removeMarker(i)}))})),n.forEach((n=>{Ip(t.createRangeOn(n),t,i,e)}))}class Up extends a.Z{static get pluginName(){return"FindAndReplaceEditing"}init(){this._activeResults=null,this.state=new $p(this.editor.model),this._defineConverters(),this._defineCommands(),this.listenTo(this.state,"change:highlightedResult",((e,t,i,n)=>{const{model:s}=this.editor;s.change((e=>{if(n){const t=n.marker.name.split(":")[1],i=s.markers.get(`findResultHighlighted:${t}`);i&&e.removeMarker(i)}if(i){const t=i.marker.name.split(":")[1];e.addMarker(`findResultHighlighted:${t}`,{usingOperation:!1,affectsData:!1,range:i.marker.getRange()})}}))}));const e=(0,Si.Z)(t.bind(this),32);function t(e,t,i){if(i){const e=this.editor.editing.view.domConverter,t=this.editor.editing.mapper.toViewRange(i.marker.getRange());an({target:e.viewRangeToDom(t),viewportOffset:40})}}this.listenTo(this.state,"change:highlightedResult",e,{priority:"low"}),this.listenTo(this.editor,"destroy",e.cancel)}find(e){const{editor:t}=this,{model:i}=t,{findCallback:n,results:s}=t.execute("find",e);return this._activeResults=s,this.listenTo(i.document,"change:data",(()=>Hp(this._activeResults,i,n))),this._activeResults}stop(){this._activeResults&&(this.stopListening(this.editor.model.document),this.state.clear(this.editor.model),this._activeResults=null)}_defineCommands(){this.editor.commands.add("find",new Mp(this.editor,this.state)),this.editor.commands.add("findNext",new Fp(this.editor,this.state)),this.editor.commands.add("findPrevious",new zp(this.editor,this.state)),this.editor.commands.add("replace",new Op(this.editor,this.state)),this.editor.commands.add("replaceAll",new Lp(this.editor,this.state))}_defineConverters(){const{editor:e}=this;e.conversion.for("editingDowncast").markerToHighlight({model:"findResult",view:({markerName:e})=>{const[,t]=e.split(":");return{name:"span",classes:["ck-find-result"],attributes:{"data-find-result":t}}}}),e.conversion.for("editingDowncast").markerToHighlight({model:"findResultHighlighted",view:({markerName:e})=>{const[,t]=e.split(":");return{name:"span",classes:[Zp],attributes:{"data-find-result":t}}}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wp extends a.Z{static get requires(){return[Up,Vp]}static get pluginName(){return"FindAndReplace"}init(){const e=this.editor.plugins.get("FindAndReplaceUI"),t=this.editor.plugins.get("FindAndReplaceEditing"),i=t.state;e.on("findNext",((e,t)=>{t?(i.searchText=t.searchText,this.editor.execute("find",t.searchText,t)):this.editor.execute("findNext")})),e.on("findPrevious",((e,t)=>{t&&i.searchText!==t.searchText?this.editor.execute("find",t.searchText):this.editor.execute("findPrevious")})),e.on("replace",((e,t)=>{i.searchText!==t.searchText&&this.editor.execute("find",t.searchText);const n=i.highlightedResult;n&&this.editor.execute("replace",t.replaceText,n)})),e.on("replaceAll",((e,t)=>{i.searchText!==t.searchText&&this.editor.execute("find",t.searchText),this.editor.execute("replaceAll",t.replaceText,i.results)})),e.on("searchReseted",(()=>{i.clear(this.editor.model),t.stop()}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qp extends b.Z{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document,n=i.selection,s=e.value;t.change((e=>{if(n.isCollapsed)s?e.setSelectionAttribute(this.attributeKey,s):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const t of i)s?e.setAttribute(this.attributeKey,s,t):e.removeAttribute(this.attributeKey,t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gp extends P.Z{constructor(e){super(e),this.set("isEmpty",!0),this.on("change",(()=>{this.set("isEmpty",0===this.length)}))}add(e,t){this.find((t=>t.color===e.color))||super.add(e,t)}hasColor(e){return!!this.find((t=>t.color===e))}}(0,I.Z)(Gp,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jp extends cl.Z{constructor(e,{colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:s,documentColorsCount:o}){super(e),this.items=this.createCollection(),this.colorDefinitions=t,this.focusTracker=new en,this.keystrokes=new tn,this.set("selectedColor"),this.removeButtonLabel=n,this.columns=i,this.documentColors=new Gp,this.documentColorsCount=o,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this._documentColorsLabel=s,this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-table"]},children:this.items}),this.items.add(this._removeColorButton())}updateDocumentColors(e,t){const i=e.document,n=this.documentColorsCount;this.documentColors.clear();for(const s of i.getRootNames()){const o=i.getRoot(s),r=e.createRangeIn(o);for(const e of r.getItems())if(e.is("$textProxy")&&e.hasAttribute(t)&&(this._addColorToDocumentColors(e.getAttribute(t)),this.documentColors.length>=n))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,i=this.selectedColor;t.selectedColor=i,e&&(e.selectedColor=i)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendGrids(){if(!this.staticColorsGrid&&(this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount)){const e=Ol.ZP.bind(this.documentColors,this.documentColors),t=new Tc(this.locale);t.text=this._documentColorsLabel,t.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_removeColorButton(){const e=new l.Z;return e.set({withText:!0,icon:ol.eraser,tooltip:!0,label:this.removeButtonLabel}),e.class="ck-color-table__remove-color",e.on("execute",(()=>{this.fire("execute",{value:null})})),e}_createStaticColorsGrid(){const e=new jl(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.delegate("execute").to(this),e}_createDocumentColorsGrid(){const e=Ol.ZP.bind(this.documentColors,this.documentColors),t=new jl(this.locale,{columns:this.columns});return t.delegate("execute").to(this),t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using((e=>{const t=new Wl;return t.set({color:e.color,hasBorder:e.options&&e.options.hasBorder}),e.label&&t.set({label:e.label,tooltip:!0}),t.on("execute",(()=>{this.fire("execute",{value:e.color})})),t})),this.documentColors.on("change:isEmpty",((e,i,n)=>{n&&(t.selectedColor=null)})),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find((t=>t.color===e));t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Kp="fontSize",Jp="fontFamily",Yp="fontColor",Qp="fontBackgroundColor";function Xp(e,t){const i={model:{key:e,values:[]},view:{},upcastAlso:{}};for(const n of t)i.model.values.push(n.model),i.view[n.model]=n.view,n.upcastAlso&&(i.upcastAlso[n.model]=n.upcastAlso);return i}function ef(e){return t=>sf(t.getStyle(e))}function tf(e){return(t,{writer:i})=>i.createAttributeElement("span",{style:`${e}:${t}`},{priority:7})}function nf({dropdownView:e,colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:s,documentColorsCount:o}){const r=e.locale,a=new jp(r,{colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:s,documentColorsCount:o});return e.colorTableView=a,e.panelView.children.add(a),a.delegate("execute").to(e,"execute"),a}function sf(e){return e.replace(/\s/g,"")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class of extends qp{constructor(e){super(e,Jp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function rf(e){return e.map(af).filter((e=>!!e))}function af(e){return"object"===typeof e?e:"default"===e?{title:"Default",model:void 0}:"string"===typeof e?lf(e):void 0}function lf(e){const t=e.replace(/"|'/g,"").split(","),i=t[0],n=t.map(cf).join(", ");return{title:i,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}function cf(e){return e=e.trim(),e.indexOf(" ")>0&&(e=`'${e}'`),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class df extends a.Z{static get pluginName(){return"FontFamilyEditing"}constructor(e){super(e),e.config.define(Jp,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Jp}),e.model.schema.setAttributeProperties(Jp,{isFormatting:!0,copyOnEnter:!0});const t=rf(e.config.get("fontFamily.options")).filter((e=>e.model)),i=Xp(Jp,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(i),e.commands.add(Jp,new of(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:Jp,view:(e,{writer:t})=>t.createAttributeElement("span",{style:"font-family:"+e},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:Jp,value:e=>e.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){const e=this.editor;e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:Jp,value:e=>e.getAttribute("face")}})}}var hf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uf extends a.Z{static get pluginName(){return"FontFamilyUI"}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),n=e.commands.get(Jp);e.ui.componentFactory.add(Jp,(s=>{const o=vc(s);return yc(o,mf(i,n)),o.buttonView.set({label:t("Font Family"),icon:hf,tooltip:!0}),o.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),o.bind("isEnabled").to(n),this.listenTo(o,"execute",(t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()})),o}))}_getLocalizedOptions(){const e=this.editor,t=e.t,i=rf(e.config.get(Jp).options);return i.map((e=>("Default"===e.title&&(e.title=t("Default")),e)))}}function mf(e,t){const i=new P.Z;for(const n of e){const e={type:"button",model:new Lc({commandName:Jp,commandParam:n.model,label:n.title,withText:!0})};e.model.bind("isOn").to(t,"value",(e=>e===n.model||!(!e||!n.model)&&e.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase())),n.view&&n.view.styles&&e.model.set("labelStyle",`font-family: ${n.view.styles["font-family"]}`),i.add(e)}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gf extends a.Z{static get requires(){return[df,uf]}static get pluginName(){return"FontFamily"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pf extends qp{constructor(e){super(e,Kp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ff(e){return e.map((e=>bf(e))).filter((e=>!!e))}const wf={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function bf(e){if(Cf(e))return _f(e);const t=yf(e);return t?_f(t):"default"===e?{model:void 0,title:"Default"}:kf(e)?void 0:vf(e)}function vf(e){return"number"!==typeof e&&"string"!==typeof e||(e={title:String(e),model:`${parseFloat(e)}px`}),e.view={name:"span",styles:{"font-size":e.model}},_f(e)}function _f(e){return e.view.priority||(e.view.priority=7),e}function yf(e){return wf[e]||wf[e.model]}function Cf(e){return"object"===typeof e&&e.title&&e.model&&e.view}function kf(e){let t;if("object"===typeof e){if(!e.model)throw new S.ZP("font-size-invalid-definition",null,e);t=parseFloat(e.model)}else t=parseFloat(e);return isNaN(t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xf=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class Af extends a.Z{static get pluginName(){return"FontSizeEditing"}constructor(e){super(e),e.config.define(Kp,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Kp}),e.model.schema.setAttributeProperties(Kp,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),i=ff(this.editor.config.get("fontSize.options")).filter((e=>e.model)),n=Xp(Kp,i);t?(this._prepareAnyValueConverters(n),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(n),e.commands.add(Kp,new pf(e))}_prepareAnyValueConverters(e){const t=this.editor,i=e.model.values.filter((e=>!Vh(String(e))&&!Nh(String(e))));if(i.length)throw new S.ZP("font-size-invalid-use-of-named-presets",null,{presets:i});t.conversion.for("downcast").attributeToElement({model:Kp,view:(e,{writer:t})=>{if(e)return t.createAttributeElement("span",{style:"font-size:"+e},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:Kp,value:e=>e.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){const e=this.editor;e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:Kp,value:e=>{const t=e.getAttribute("size"),i="-"===t[0]||"+"===t[0];let n=parseInt(t,10);i&&(n=3+n);const s=xf.length-1,o=Math.min(Math.max(n,0),s);return xf[o]}}})}}var Ef='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tf extends a.Z{static get pluginName(){return"FontSizeUI"}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),n=e.commands.get(Kp);e.ui.componentFactory.add(Kp,(s=>{const o=vc(s);return yc(o,Pf(i,n)),o.buttonView.set({label:t("Font Size"),icon:Ef,tooltip:!0}),o.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),o.bind("isEnabled").to(n),this.listenTo(o,"execute",(t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()})),o}))}_getLocalizedOptions(){const e=this.editor,t=e.t,i={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")},n=ff(e.config.get(Kp).options);return n.map((e=>{const t=i[e.title];return t&&t!=e.title&&(e=Object.assign({},e,{title:t})),e}))}}function Pf(e,t){const i=new P.Z;for(const n of e){const e={type:"button",model:new Lc({commandName:Kp,commandParam:n.model,label:n.title,class:"ck-fontsize-option",withText:!0})};n.view&&n.view.styles&&e.model.set("labelStyle",`font-size:${n.view.styles["font-size"]}`),n.view&&n.view.classes&&e.model.set("class",`${e.model.class} ${n.view.classes}`),e.model.bind("isOn").to(t,"value",(e=>e===n.model)),i.add(e)}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sf extends a.Z{static get requires(){return[Af,Tf]}static get pluginName(){return"FontSize"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vf extends qp{constructor(e){super(e,Yp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class If extends a.Z{static get pluginName(){return"FontColorEditing"}constructor(e){super(e),e.config.define(Yp,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:Yp,value:ef("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:Yp,value:e=>e.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:Yp,view:tf("color")}),e.commands.add(Yp,new Vf(e)),e.model.schema.extend("$text",{allowAttributes:Yp}),e.model.schema.setAttributeProperties(Yp,{isFormatting:!0,copyOnEnter:!0})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nf extends a.Z{constructor(e,{commandName:t,icon:i,componentName:n,dropdownLabel:s}){super(e),this.commandName=t,this.componentName=n,this.icon=i,this.dropdownLabel=s,this.columns=e.config.get(`${this.componentName}.columns`),this.colorTableView=void 0}init(){const e=this.editor,t=e.locale,i=t.t,n=e.commands.get(this.commandName),s=Zl(e.config.get(this.componentName).colors),o=$l(t,s),r=e.config.get(`${this.componentName}.documentColors`);e.ui.componentFactory.add(this.componentName,(t=>{const s=vc(t);return this.colorTableView=nf({dropdownView:s,colors:o.map((e=>({label:e.label,color:e.model,options:{hasBorder:e.hasBorder}}))),columns:this.columns,removeButtonLabel:i("Remove color"),documentColorsLabel:0!==r?i("Document colors"):void 0,documentColorsCount:void 0===r?this.columns:r}),this.colorTableView.bind("selectedColor").to(n,"value"),s.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),s.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),s.bind("isEnabled").to(n),s.on("execute",((t,i)=>{e.execute(this.commandName,i),e.editing.view.focus()})),s.on("change:isOpen",((t,i,n)=>{s.colorTableView.appendGrids(),n&&(0!==r&&this.colorTableView.updateDocumentColors(e.model,this.componentName),this.colorTableView.updateSelectedColors())})),s}))}}var Rf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Df extends Nf{constructor(e){const t=e.locale.t;super(e,{commandName:Yp,componentName:Yp,icon:Rf,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bf extends a.Z{static get requires(){return[If,Df]}static get pluginName(){return"FontColor"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mf extends qp{constructor(e){super(e,Qp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Of extends a.Z{static get pluginName(){return"FontBackgroundColorEditing"}constructor(e){super(e),e.config.define(Qp,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(qh),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:Qp,value:ef("background-color")}}),e.conversion.for("downcast").attributeToElement({model:Qp,view:tf("background-color")}),e.commands.add(Qp,new Mf(e)),e.model.schema.extend("$text",{allowAttributes:Qp}),e.model.schema.setAttributeProperties(Qp,{isFormatting:!0,copyOnEnter:!0})}}var Lf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ff extends Nf{constructor(e){const t=e.locale.t;super(e,{commandName:Qp,componentName:Qp,icon:Lf,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zf extends a.Z{static get requires(){return[Of,Ff]}static get pluginName(){return"FontBackgroundColor"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $f extends a.Z{static get requires(){return[gf,Sf,Bf,zf]}static get pluginName(){return"Font"}}var Zf=i(52012);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hf extends b.Z{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some((t=>Uf(e,t,this.editor.model.schema)))}execute(e){const t=this.editor.model,i=t.document,n=e.value;t.change((e=>{const s=Array.from(i.selection.getSelectedBlocks()).filter((e=>Uf(e,n,t.schema)));for(const t of s)t.is("element",n)||e.rename(t,n)}))}}function Uf(e,t,i){return i.checkChild(e.parent,t)&&!i.isObject(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Wf="paragraph";class qf extends a.Z{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Zf.Paragraph]}init(){const e=this.editor,t=e.config.get("heading.options"),i=[];for(const n of t)n.model!==Wf&&(e.model.schema.register(n.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(n),i.push(n.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new Hf(e,i))}afterInit(){const e=this.editor,t=e.commands.get("enter"),i=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",((t,n)=>{const s=e.model.document.selection.getFirstPosition().parent,o=i.some((e=>s.is("element",e.model)));o&&!s.is("element",Wf)&&0===s.childCount&&n.writer.rename(s,Wf)}))}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:nn.Z.get("low")+1})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gf(e){const t=e.t,i={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return e.config.get("heading.options").map((e=>{const t=i[e.title];return t&&t!=e.title&&(e.title=t),e}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jf extends a.Z{static get pluginName(){return"HeadingUI"}init(){const e=this.editor,t=e.t,i=Gf(e),n=t("Choose heading"),s=t("Heading");e.ui.componentFactory.add("heading",(t=>{const o={},r=new P.Z,a=e.commands.get("heading"),l=e.commands.get("paragraph"),c=[a];for(const e of i){const t={type:"button",model:new Lc({label:e.title,class:e.class,withText:!0})};"paragraph"===e.model?(t.model.bind("isOn").to(l,"value"),t.model.set("commandName","paragraph"),c.push(l)):(t.model.bind("isOn").to(a,"value",(t=>t===e.model)),t.model.set({commandName:"heading",commandValue:e.model})),r.add(t),o[e.model]=e.title}const d=vc(t);return yc(d,r),d.buttonView.set({isOn:!1,withText:!0,tooltip:s}),d.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),d.bind("isEnabled").toMany(c,"isEnabled",((...e)=>e.some((e=>e)))),d.buttonView.bind("label").to(a,"value",l,"value",((e,t)=>{const i=e||t&&"paragraph";return o[i]?o[i]:n})),this.listenTo(d,"execute",(t=>{e.execute(t.source.commandName,t.source.commandValue?{value:t.source.commandValue}:void 0),e.editing.view.focus()})),d}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kf extends a.Z{static get requires(){return[qf,jf]}static get pluginName(){return"Heading"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jf extends a.Z{static get requires(){return[jc]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",(t=>{Xf(e.editing.view.document.selection)&&t.stop()}),{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui,"update",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui.focusTracker,"change:isFocused",(()=>{this._updateToolbarsVisibility()}),{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:i,getRelatedElement:n,balloonClassName:s="ck-toolbar-container"}){if(!i.length)return void(0,S.KE)("widget-toolbar-no-items",{toolbarId:e});const o=this.editor,r=o.t,a=new uc(o.locale);if(a.ariaLabel=t||r("Widget toolbar"),this._toolbarDefinitions.has(e))throw new S.ZP("widget-toolbar-duplicated",this,{toolbarId:e});a.fillFromConfig(i,o.ui.componentFactory),this._toolbarDefinitions.set(e,{view:a,getRelatedElement:n,balloonClassName:s})}_updateToolbarsVisibility(){let e=0,t=null,i=null;for(const n of this._toolbarDefinitions.values()){const s=n.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&s)if(this.editor.ui.focusTracker.isFocused){const o=s.getAncestors().length;o>e&&(e=o,t=s,i=n)}else this._isToolbarVisible(n)&&this._hideToolbar(n);else this._isToolbarInBalloon(n)&&this._hideToolbar(n)}i&&this._showToolbar(i,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?Yf(this.editor,t):this._isToolbarInBalloon(e)||(this._balloon.add({view:e.view,position:Qf(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",(()=>{for(const e of this._toolbarDefinitions.values())if(this._isToolbarVisible(e)){const t=e.getRelatedElement(this.editor.editing.view.document.selection);Yf(this.editor,t)}})))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function Yf(e,t){const i=e.plugins.get("ContextualBalloon"),n=Qf(e,t);i.updatePosition(n)}function Qf(e,t){const i=e.editing.view,n=Zc.defaultPositions;return{target:i.domConverter.mapViewToDom(t),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}function Xf(e){const t=e.getSelectedElement();return!(!t||!pg(t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ew{constructor(e){this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}begin(e,t,i){const n=new Gi(t);this.activeHandlePosition=sw(e),this._referenceCoordinates=iw(t,ow(this.activeHandlePosition)),this.originalWidth=n.width,this.originalHeight=n.height,this.aspectRatio=n.width/n.height;const s=i.style.width;s&&s.match(/^\d+(\.\d*)?%$/)?this.originalWidthPercents=parseFloat(s):this.originalWidthPercents=tw(i,n)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function tw(e,t){const i=e.parentElement,n=parseFloat(i.ownerDocument.defaultView.getComputedStyle(i).width);return t.width/n*100}function iw(e,t){const i=new Gi(e),n=t.split("-"),s={x:"right"==n[1]?i.right:i.left,y:"bottom"==n[0]?i.bottom:i.top};return s.x+=e.ownerDocument.defaultView.scrollX,s.y+=e.ownerDocument.defaultView.scrollY,s}function nw(e){return`ck-widget__resizer__handle-${e}`}function sw(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const i of t)if(e.classList.contains(nw(i)))return i}function ow(e){const t=e.split("-"),i={top:"bottom",bottom:"top",left:"right",right:"left"};return`${i[t[0]]}-${i[t[1]]}`}(0,I.Z)(ew,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rw extends cl.Z{constructor(){super();const e=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",e.to("_viewPosition",(e=>e?`ck-orientation-${e}`:""))],style:{display:e.if("_isVisible","none",(e=>!e))}},children:[{text:e.to("_label")}]})}_bindToState(e,t){this.bind("_isVisible").to(t,"proposedWidth",t,"proposedHeight",((e,t)=>null!==e&&null!==t)),this.bind("_label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",((t,i,n)=>"px"===e.unit?`${t}×${i}`:`${n}%`)),this.bind("_viewPosition").to(t,"activeHandlePosition",t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",((e,t,i)=>t<50||i<50?"above-center":e))}_dismiss(){this.unbind(),this._isVisible=!1}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class aw{constructor(e){this._options=e,this._viewResizerWrapper=null,this.set("isEnabled",!0),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",(e=>{this.state.proposedWidth||this.state.proposedWidthPercents||(this._cleanup(),e.stop())}),{priority:"high"}),this.on("change:isEnabled",(()=>{this.isEnabled&&this.redraw()}))}attach(){const e=this,t=this._options.viewElement,i=this._options.editor.editing.view;i.change((i=>{const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},(function(t){const i=this.toDomElement(t);return e._appendHandles(i),e._appendSizeUI(i),e.on("change:isEnabled",((e,t,n)=>{i.style.display=n?"":"none"})),i.style.display=e.isEnabled?"":"none",i}));i.insert(i.createPositionAt(t,"end"),n),i.addClass("ck-widget_with-resizer",t),this._viewResizerWrapper=n}))}begin(e){this.state=new ew(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const t=this._proposeNewSize(e),i=this._options.editor.editing.view;i.change((e=>{const i=this._options.unit||"%",n=("%"===i?t.widthPercents:t.width)+i;e.setStyle("width",n,this._options.viewElement)}));const n=this._getHandleHost(),s=new Gi(n);t.handleHostWidth=Math.round(s.width),t.handleHostHeight=Math.round(s.height);const o=new Gi(n);t.width=Math.round(o.width),t.height=Math.round(o.height),this.redraw(s),this.state.update(t)}commit(){const e=this._options.unit||"%",t=("%"===e?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change((()=>{this._cleanup(),this._options.onCommit(t)}))}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const t=this._domResizerWrapper;if(!dw(t))return;const i=t.parentElement,n=this._getHandleHost(),s=this._viewResizerWrapper,o=[s.getStyle("width"),s.getStyle("height"),s.getStyle("left"),s.getStyle("top")];let r;if(i.isSameNode(n)){const t=e||new Gi(n);r=[t.width+"px",t.height+"px",void 0,void 0]}else r=[n.offsetWidth+"px",n.offsetHeight+"px",n.offsetLeft+"px",n.offsetTop+"px"];"same"!==U(o,r)&&this._options.editor.editing.view.change((e=>{e.setStyle({width:r[0],height:r[1],left:r[2],top:r[3]},s)}))}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss();const e=this._options.editor.editing.view;e.change((e=>{e.setStyle("width",this._initialViewWidth,this._options.viewElement)}))}_proposeNewSize(e){const t=this.state,i=cw(e),n=!this._options.isCentered||this._options.isCentered(this),s={x:t._referenceCoordinates.x-(i.x+t.originalWidth),y:i.y-t.originalHeight-t._referenceCoordinates.y};n&&t.activeHandlePosition.endsWith("-right")&&(s.x=i.x-(t._referenceCoordinates.x+t.originalWidth)),n&&(s.x*=2);const o={width:Math.abs(t.originalWidth+s.x),height:Math.abs(t.originalHeight+s.y)};o.dominant=o.width/t.aspectRatio>o.height?"width":"height",o.max=o[o.dominant];const r={width:o.width,height:o.height};return"width"==o.dominant?r.height=r.width/t.aspectRatio:r.width=r.height*t.aspectRatio,{width:Math.round(r.width),height:Math.round(r.height),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*r.width*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const i of t)e.appendChild(new Ol.ZP({tag:"div",attributes:{class:`ck-widget__resizer__handle ${lw(i)}`}}).render())}_appendSizeUI(e){this._sizeView=new rw,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function lw(e){return`ck-widget__resizer__handle-${e}`}function cw(e){return{x:e.pageX,y:e.pageY}}function dw(e){return e&&e.ownerDocument&&e.ownerDocument.contains(e)}(0,I.Z)(aw,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hw extends a.Z{static get pluginName(){return"WidgetResize"}init(){const e=this.editor.editing,t=ri.window.document;this.set("visibleResizer",null),this.set("_activeResizer",null),this._resizers=new Map,e.view.addObserver(bh),this._observer=Object.create(vi.Z),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this));const i=()=>{this.visibleResizer&&this.visibleResizer.redraw()};this._redrawFocusedResizerThrottled=(0,Jg.Z)(i,200),this.on("change:visibleResizer",i),this.editor.ui.on("update",this._redrawFocusedResizerThrottled),this.editor.model.document.on("change",(()=>{for(const[e,t]of this._resizers)e.isAttached()||(this._resizers.delete(e),t.destroy())}),{priority:"lowest"}),this._observer.listenTo(ri.window,"resize",this._redrawFocusedResizerThrottled);const n=this.editor.editing.view.document.selection;n.on("change",(()=>{const e=n.getSelectedElement();this.visibleResizer=this.getResizerByViewElement(e)||null}))}destroy(){this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawFocusedResizerThrottled.cancel()}attachTo(e){const t=new aw(e),i=this.editor.plugins;if(t.attach(),i.has("WidgetToolbarRepository")){const e=i.get("WidgetToolbarRepository");t.on("begin",(()=>{e.forceDisabled("resize")}),{priority:"lowest"}),t.on("cancel",(()=>{e.clearForceDisabled("resize")}),{priority:"highest"}),t.on("commit",(()=>{e.clearForceDisabled("resize")}),{priority:"highest"})}this._resizers.set(e.viewElement,t);const n=this.editor.editing.view.document.selection,s=n.getSelectedElement();return this.getResizerByViewElement(s)==t&&(this.visibleResizer=t),t}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const t of this._resizers.values())if(t.containsHandle(e))return t}_mouseDownListener(e,t){const i=t.domTarget;aw.isResizeHandle(i)&&(this._activeResizer=this._getResizerByHandle(i),this._activeResizer&&(this._activeResizer.begin(i),e.stop(),t.preventDefault()))}_mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}(0,I.Z)(hw,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uw extends b.Z{refresh(){const e=this.editor.model,t=e.schema,i=e.document.selection;this.isEnabled=mw(i,t,e)}execute(){const e=this.editor.model;e.change((t=>{const i=t.createElement("horizontalLine");e.insertContent(i);let n=i.nextSibling;const s=n&&e.schema.checkChild(n,"$text");!s&&e.schema.checkChild(i.parent,"paragraph")&&(n=t.createElement("paragraph"),e.insertContent(n,t.createPositionAfter(i))),n&&t.setSelection(n,0)}))}}function mw(e,t,i){const n=gw(e,i);return t.checkChild(n,"horizontalLine")}function gw(e,t){const i=kg(e,t),n=i.start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pw extends a.Z{static get pluginName(){return"HorizontalLineEditing"}init(){const e=this.editor,t=e.model.schema,i=e.t,n=e.conversion;t.register("horizontalLine",{isObject:!0,allowWhere:"$block"}),n.for("dataDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>t.createEmptyElement("hr")}),n.for("editingDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>{const n=i("Horizontal line"),s=t.createContainerElement("div"),o=t.createEmptyElement("hr");return t.addClass("ck-horizontal-line",s),t.setCustomProperty("hr",!0,s),t.insert(t.createPositionAt(s,0),o),fw(s,t,n)}}),n.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),e.commands.add("horizontalLine",new uw(e))}}function fw(e,t,i){return t.setCustomProperty("horizontalLine",!0,e),fg(e,t,{label:i})}var ww='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bw extends a.Z{static get pluginName(){return"HorizontalLineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("horizontalLine",(i=>{const n=e.commands.get("horizontalLine"),s=new l.Z(i);return s.set({label:t("Horizontal line"),icon:ww,tooltip:!0}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",(()=>{e.execute("horizontalLine"),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vw extends a.Z{static get requires(){return[pw,bw,Gg]}static get pluginName(){return"HorizontalLine"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _w extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled&&i.hasAttribute("alt")?this.value=i.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor,i=t.plugins.get("ImageUtils"),n=t.model,s=i.getClosestSelectedImageElement(n.document.selection);n.change((t=>{t.setAttribute("alt",e.newValue,s)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function yw(e,t){const i=e.createEmptyElement("img"),n="imageBlock"===t?e.createContainerElement("figure",{class:"image"}):e.createContainerElement("span",{class:"image-inline"},{isAllowedInsideAttributeElement:!0});return e.insert(e.createPositionAt(n,0),i),n}function Cw(e,t){if(e.plugins.has("ImageInlineEditing")!==e.plugins.has("ImageBlockEditing"))return{name:"img"};const i=e.plugins.get("ImageUtils");return e=>{if(!i.isInlineImageView(e))return null;const n=e.findAncestor(i.isBlockImageView)?"imageBlock":"imageInline";return n!==t?null:{name:!0}}}function kw(e,t){const i=(0,Xi.Z)(t.getSelectedBlocks());return!i||e.isObject(i)||i.isEmpty&&"listItem"!=i.name?"imageBlock":"imageInline"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xw extends a.Z{static get pluginName(){return"ImageUtils"}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},t=null,i=null){const n=this.editor,s=n.model,o=s.document.selection;i=Pw(n,t||o,i),e={...Object.fromEntries(o.getAttributes()),...e};for(const r in e)s.schema.checkAttribute(i,r)||delete e[r];return s.change((n=>{const r=n.createElement(i,e);return t||"imageInline"==i||(t=kg(o,s)),s.insertContent(r,t),r.parent?(n.setSelection(r,"on"),r):null}))}getClosestSelectedImageWidget(e){const t=e.getSelectedElement();if(t&&this.isImageWidget(t))return t;let i=e.getFirstPosition().parent;while(i){if(i.is("element")&&this.isImageWidget(i))return i;i=i.parent}return null}getClosestSelectedImageElement(e){const t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock")}isImageAllowed(){const e=this.editor.model,t=e.document.selection;return Aw(this.editor,t)&&Ew(t)}toImageWidget(e,t,i){t.setCustomProperty("image",!0,e);const n=()=>{const t=this.findViewImgElement(e),n=t.getAttribute("alt");return n?`${n} ${i}`:i};return fg(e,t,{label:n})}isImageWidget(e){return!!e.getCustomProperty("image")&&pg(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const t=this.editor.editing.view;for(const{item:i}of t.createRangeIn(e))if(this.isInlineImageView(i))return i}}function Aw(e,t){const i=Pw(e,t);if("imageBlock"==i){const i=Tw(t,e.model);if(e.model.schema.checkChild(i,"imageBlock"))return!0}else if(e.model.schema.checkChild(t.focus,"imageInline"))return!0;return!1}function Ew(e){return[...e.focus.getAncestors()].every((e=>!e.is("element","imageBlock")))}function Tw(e,t){const i=kg(e,t),n=i.start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}function Pw(e,t,i){const n=e.model.schema,s=e.config.get("image.insert.type");return e.plugins.has("ImageBlockEditing")?e.plugins.has("ImageInlineEditing")?i||("inline"===s?"imageInline":"block"===s?"imageBlock":t.is("selection")?kw(n,t):n.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new _w(this.editor))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vw extends cl.Z{constructor(e){super(e);const t=this.locale.t;this.focusTracker=new en,this.keystrokes=new tn,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(t("Save"),ol.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(t("Cancel"),ol.cancel,"ck-button-cancel","cancel"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),Bl(this)}render(){super.render(),this.keystrokes.listenTo(this.element),Ml({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(e,t,i,n){const s=new l.Z(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.extendTemplate({attributes:{class:i}}),n&&s.delegate("execute").to(this,n),s}_createLabeledInputView(){const e=this.locale.t,t=new Dc(this.locale,Bc);return t.label=e("Text alternative"),t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Iw(e){const t=e.plugins.get("ContextualBalloon");if(e.plugins.get("ImageUtils").getClosestSelectedImageWidget(e.editing.view.document.selection)){const i=Nw(e);t.updatePosition(i)}}function Nw(e){const t=e.editing.view,i=Zc.defaultPositions,n=e.plugins.get("ImageUtils");return{target:t.domConverter.viewToDom(n.getClosestSelectedImageWidget(t.document.selection)),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rw extends a.Z{static get requires(){return[jc]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",(i=>{const n=e.commands.get("imageTextAlternative"),s=new l.Z(i);return s.set({label:t("Change image text alternative"),icon:ol.lowVision,tooltip:!0}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",(()=>{this._showForm()})),s}))}_createForm(){const e=this.editor,t=e.editing.view,i=t.document,n=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Vw(e.locale),this._form.render(),this.listenTo(this._form,"submit",(()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)})),this.listenTo(this._form,"cancel",(()=>{this._hideForm(!0)})),this._form.keystrokes.set("Esc",((e,t)=>{this._hideForm(!0),t()})),this.listenTo(e.ui,"update",(()=>{n.getClosestSelectedImageWidget(i.selection)?this._isVisible&&Iw(e):this._hideForm(!0)})),Dl({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const e=this.editor,t=e.commands.get("imageTextAlternative"),i=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Nw(e)}),i.fieldView.value=i.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Dw extends a.Z{static get requires(){return[Sw,Rw]}static get pluginName(){return"ImageTextAlternative"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bw(e){return e=>{e.on("element:figure",t)};function t(t,i,n){if(!n.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const s=e.findViewImgElement(i.viewItem);if(!s||!n.consumable.test(s,{name:!0}))return;n.consumable.consume(i.viewItem,{name:!0,classes:"image"});const o=n.convertItem(s,i.modelCursor),r=(0,Xi.Z)(o.modelRange.getItems());r?(n.convertChildren(i.viewItem,r),n.updateConversionResult(r,i)):n.consumable.revert(i.viewItem,{name:!0,classes:"image"})}}function Mw(e,t){return e=>{e.on(`attribute:srcset:${t}`,i)};function i(t,i,n){if(!n.consumable.consume(i.item,t.name))return;const s=n.writer,o=n.mapper.toViewElement(i.item),r=e.findViewImgElement(o);if(null===i.attributeNewValue){const e=i.attributeOldValue;e.data&&(s.removeAttribute("srcset",r),s.removeAttribute("sizes",r),e.width&&s.removeAttribute("width",r))}else{const e=i.attributeNewValue;e.data&&(s.setAttribute("srcset",e.data,r),s.setAttribute("sizes","100vw",r),e.width&&s.setAttribute("width",e.width,r))}}}function Ow(e,t,i){return e=>{e.on(`attribute:${i}:${t}`,n)};function n(t,i,n){if(!n.consumable.consume(i.item,t.name))return;const s=n.writer,o=n.mapper.toViewElement(i.item),r=e.findViewImgElement(o);s.setAttribute(i.attributeKey,i.attributeNewValue||"",r)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lw extends _i{observe(e){this.listenTo(e,"load",((e,t)=>{const i=t.target;this.checkShouldIgnoreEventFromTarget(i)||"IMG"==i.tagName&&this._fireEvents(t)}),{useCapture:!0})}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fw extends b.Z{constructor(e){super(e);const t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||"block"===t&&(0,S.KE)("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||"inline"===t&&(0,S.KE)("image-inline-plugin-required")}refresh(){this.isEnabled=this.editor.plugins.get("ImageUtils").isImageAllowed()}execute(e){const t=(0,R.Z)(e.source),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),s=Object.fromEntries(i.getAttributes());t.forEach(((e,t)=>{const o=i.getSelectedElement();if("string"===typeof e&&(e={src:e}),t&&o&&n.isImage(o)){const t=this.editor.model.createPositionAfter(o);n.insertImage({...e,...s},t)}else n.insertImage({...e,...s})}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.conversion;e.editing.view.addObserver(Lw),t.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:e=>{const t={data:e.getAttribute("srcset")};return e.hasAttribute("width")&&(t.width=e.getAttribute("width")),t}}});const i=new Fw(e);e.commands.add("insertImage",i),e.commands.add("imageInsert",i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $w extends b.Z{constructor(e,t){super(e),this._modelElementName=t}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);"imageBlock"===this._modelElementName?this.isEnabled=t.isInlineImage(i):this.isEnabled=t.isBlockImage(i)}execute(){const e=this.editor,t=this.editor.model,i=e.plugins.get("ImageUtils"),n=i.getClosestSelectedImageElement(t.document.selection),s=Object.fromEntries(n.getAttributes());return s.src||s.uploadId?t.change((e=>{const o=Array.from(t.markers).filter((e=>e.getRange().containsItem(n))),r=i.insertImage(s,t.createSelection(n,"on"),this._modelElementName);if(!r)return null;const a=e.createRangeOn(r);for(const t of o){const i=t.getRange(),n="$graveyard"!=i.root.rootName?i.getJoined(a,!0):a;e.updateMarker(t,{range:n})}return{oldElement:n,newElement:r}})):null}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Zw extends a.Z{static get requires(){return[zw,xw,ag]}static get pluginName(){return"ImageBlockEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageBlock",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new $w(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,i=e.conversion,n=e.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageBlock",view:(e,{writer:t})=>yw(t,"imageBlock")}),i.for("editingDowncast").elementToElement({model:"imageBlock",view:(e,{writer:i})=>n.toImageWidget(yw(i,"imageBlock"),i,t("image widget"))}),i.for("downcast").add(Ow(n,"imageBlock","src")).add(Ow(n,"imageBlock","alt")).add(Mw(n,"imageBlock")),i.for("upcast").elementToElement({view:Cw(e,"imageBlock"),model:(e,{writer:t})=>t.createElement("imageBlock",e.hasAttribute("src")?{src:e.getAttribute("src")}:null)}).add(Bw(n))}_setupClipboardIntegration(){const e=this.editor,t=e.model,i=e.editing.view,n=e.plugins.get("ImageUtils");this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((s,o)=>{const r=Array.from(o.content.getChildren());let a;if(!r.every(n.isInlineImageView))return;a=o.targetRanges?e.editing.mapper.toModelRange(o.targetRanges[0]):t.document.selection.getFirstRange();const l=t.createSelection(a);if("imageBlock"===kw(t.schema,l)){const e=new vh(i.document),t=r.map((t=>e.createElement("figure",{class:"image"},t)));o.content=e.createDocumentFragment(t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hw extends a.Z{static get requires(){return[Zw,Gg,Dw]}static get pluginName(){return"ImageBlock"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Uw extends a.Z{static get requires(){return[zw,xw,ag]}static get pluginName(){return"ImageInlineEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageInline",{isObject:!0,isInline:!0,allowWhere:"$text",allowAttributesOf:"$text",allowAttributes:["alt","src","srcset"]}),t.addChildCheck(((e,t)=>{if(e.endsWith("caption")&&"imageInline"===t.name)return!1})),this._setupConversion(),e.plugins.has("ImageBlockEditing")&&(e.commands.add("imageTypeInline",new $w(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,i=e.conversion,n=e.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageInline",view:(e,{writer:t})=>t.createEmptyElement("img")}),i.for("editingDowncast").elementToElement({model:"imageInline",view:(e,{writer:i})=>n.toImageWidget(yw(i,"imageInline"),i,t("image widget"))}),i.for("downcast").add(Ow(n,"imageInline","src")).add(Ow(n,"imageInline","alt")).add(Mw(n,"imageInline")),i.for("upcast").elementToElement({view:Cw(e,"imageInline"),model:(e,{writer:t})=>t.createElement("imageInline",e.hasAttribute("src")?{src:e.getAttribute("src")}:null)})}_setupClipboardIntegration(){const e=this.editor,t=e.model,i=e.editing.view,n=e.plugins.get("ImageUtils");this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((s,o)=>{const r=Array.from(o.content.getChildren());let a;if(!r.every(n.isBlockImageView))return;a=o.targetRanges?e.editing.mapper.toModelRange(o.targetRanges[0]):t.document.selection.getFirstRange();const l=t.createSelection(a);if("imageInline"===kw(t.schema,l)){const e=new vh(i.document),t=r.map((t=>1===t.childCount?(Array.from(t.getAttributes()).forEach((i=>e.setAttribute(...i,n.findViewImgElement(t)))),t.getChild(0)):t));o.content=e.createDocumentFragment(t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ww extends a.Z{static get requires(){return[Uw,Gg,Dw]}static get pluginName(){return"ImageInline"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qw extends a.Z{static get requires(){return[Hw,Ww]}static get pluginName(){return"Image"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gw(e){for(const t of e.getChildren())if(t&&t.is("element","caption"))return t;return null}function jw(e,t){const i=t.getFirstPosition().findAncestor("caption");return i&&e.isBlockImage(i.parent)?i:null}function Kw(e,t){return"figcaption"==t.name&&e.isBlockImageView(t.parent)?{name:!0}:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jw extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils");if(!e.plugins.has(Zw))return this.isEnabled=!1,void(this.value=!1);const i=e.model.document.selection,n=i.getSelectedElement();if(!n){const e=jw(t,i);return this.isEnabled=!!e,void(this.value=!!e)}this.isEnabled=this.editor.plugins.get("ImageUtils").isImage(n),this.isEnabled?this.value=!!Gw(n):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change((e=>{this.value?this._hideImageCaption(e):this._showImageCaption(e,t)}))}_showImageCaption(e,t){const i=this.editor.model,n=i.document.selection,s=this.editor.plugins.get("ImageCaptionEditing");let o=n.getSelectedElement();const r=s._getSavedCaption(o);this.editor.plugins.get("ImageUtils").isInlineImage(o)&&(this.editor.execute("imageTypeBlock"),o=n.getSelectedElement());const a=r||e.createElement("caption");e.append(a,o),t&&e.setSelection(a,"in")}_hideImageCaption(e){const t=this.editor,i=t.model.document.selection,n=t.plugins.get("ImageCaptionEditing"),s=t.plugins.get("ImageUtils");let o,r=i.getSelectedElement();r?o=Gw(r):(o=jw(s,i),r=o.parent),n._saveCaption(r,o),e.setSelection(r,"on"),e.remove(o)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema;t.isRegistered("caption")?t.extend("caption",{allowIn:"imageBlock"}):t.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new Jw(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration()}_setupConversion(){const e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),n=e.t;e.conversion.for("upcast").elementToElement({view:e=>Kw(i,e),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>i.isBlockImage(e.parent)?t.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(e,{writer:s})=>{if(!i.isBlockImage(e.parent))return null;const o=s.createEditableElement("figcaption");return s.setCustomProperty("imageCaption",!0,o),Yd({view:t,element:o,text:n("Enter image caption"),keepOnFocus:!0}),Cg(o,s)}}),e.editing.mapper.on("modelToViewPosition",Qw(t)),e.data.mapper.on("modelToViewPosition",Qw(t))}_setupImageTypeCommandsIntegration(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=e.commands.get("imageTypeInline"),n=e.commands.get("imageTypeBlock"),s=e=>{if(!e.return)return;const{oldElement:i,newElement:n}=e.return;if(!i)return;if(t.isBlockImage(i)){const e=Gw(i);if(e)return void this._saveCaption(n,e)}const s=this._getSavedCaption(i);s&&this._saveCaption(n,s)};i&&this.listenTo(i,"execute",s,{priority:"low"}),n&&this.listenTo(n,"execute",s,{priority:"low"})}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?kn.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}function Qw(e){return(t,i)=>{const n=i.modelPosition,s=n.parent;if(!s.is("element","imageBlock"))return;const o=i.mapper.toViewElement(s);i.viewPosition=e.createPositionAt(o,n.offset+1)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageCaptionUI"}init(){const e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),n=e.t;e.ui.componentFactory.add("toggleImageCaption",(s=>{const o=e.commands.get("toggleImageCaption"),r=new l.Z(s);return r.set({icon:ol.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.bind("label").to(o,"value",(e=>n(e?"Toggle caption off":"Toggle caption on"))),this.listenTo(r,"execute",(()=>{e.execute("toggleImageCaption",{focusCaptionOnShow:!0});const n=jw(i,e.model.document.selection);if(n){const i=e.editing.mapper.toViewElement(n);t.scrollToTheSelection(),t.change((e=>{e.addClass("image__caption_highlighted",i)}))}})),r}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eb extends a.Z{static get requires(){return[Yw,Xw]}static get pluginName(){return"ImageCaption"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tb extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!i,i&&i.hasAttribute("width")?this.value={width:i.getAttribute("width"),height:null}:this.value=null}execute(e){const t=this.editor,i=t.model,n=t.plugins.get("ImageUtils"),s=n.getClosestSelectedImageElement(i.document.selection);this.value={width:e.width,height:null},s&&i.change((t=>{t.setAttribute("width",e.width,s)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ib extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageResizeEditing"}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new tb(e);this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t)}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:"width"}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:"width"})}_registerConverters(e){const t=this.editor;t.conversion.for("downcast").add((t=>t.on(`attribute:width:${e}`,((e,t,i)=>{if(!i.consumable.consume(t.item,e.name))return;const n=i.writer,s=i.mapper.toViewElement(t.item);null!==t.attributeNewValue?(n.setStyle("width",t.attributeNewValue,s),n.addClass("image_resized",s)):(n.removeStyle("width",s),n.removeClass("image_resized",s))})))),t.conversion.for("upcast").attributeToAttribute({view:{name:"imageBlock"===e?"figure":"img",styles:{width:/.+/}},model:{key:"width",value:e=>e.getStyle("width")}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const nb={small:ol.objectSizeSmall,medium:ol.objectSizeMedium,large:ol.objectSizeLarge,original:ol.objectSizeFull};class sb extends a.Z{static get requires(){return[ib]}static get pluginName(){return"ImageResizeButtons"}constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),i=e.commands.get("resizeImage");this.bind("isEnabled").to(i);for(const n of t)this._registerImageResizeButton(n);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:i,value:n,icon:s}=e,o=n?n+this._resizeUnit:null;t.ui.componentFactory.add(i,(i=>{const n=new l.Z(i),r=t.commands.get("resizeImage"),a=this._getOptionLabelValue(e,!0);if(!nb[s])throw new S.ZP("imageresizebuttons-missing-icon",t,e);return n.set({label:a,icon:nb[s],tooltip:a,isToggleable:!0}),n.bind("isEnabled").to(this),n.bind("isOn").to(r,"value",ob(o)),this.listenTo(n,"execute",(()=>{t.execute("resizeImage",{width:o})})),n}))}_registerImageResizeDropdown(e){const t=this.editor,i=t.t,n=e.find((e=>!e.value)),s=s=>{const o=t.commands.get("resizeImage"),r=vc(s,Yl),a=r.buttonView;return a.set({tooltip:i("Resize image"),commandValue:n.value,icon:nb.medium,isToggleable:!0,label:this._getOptionLabelValue(n),withText:!0,class:"ck-resize-image-button"}),a.bind("label").to(o,"value",(e=>e&&e.width?e.width:this._getOptionLabelValue(n))),r.bind("isOn").to(o),r.bind("isEnabled").to(this),yc(r,this._getResizeDropdownListItemDefinitions(e,o)),r.listView.ariaLabel=i("Image resize list"),this.listenTo(r,"execute",(e=>{t.execute(e.source.commandName,{width:e.source.commandValue}),t.editing.view.focus()})),r};t.ui.componentFactory.add("resizeImage",s),t.ui.componentFactory.add("imageResize",s)}_getOptionLabelValue(e,t){const i=this.editor.t;return e.label?e.label:t?e.value?i("Resize image to %0",e.value+this._resizeUnit):i("Resize image to the original size"):e.value?e.value+this._resizeUnit:i("Original")}_getResizeDropdownListItemDefinitions(e,t){const i=new P.Z;return e.map((e=>{const n=e.value?e.value+this._resizeUnit:null,s={type:"button",model:new Lc({commandName:"resizeImage",commandValue:n,label:this._getOptionLabelValue(e),withText:!0,icon:null})};s.model.bind("isOn").to(t,"value",ob(n)),i.add(s)})),i}}function ob(e){return t=>null===e&&t===e||t&&t.width===e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const rb="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",ab=/(image|image-inline)/,lb="image_resized";class cb extends a.Z{static get requires(){return[hw]}static get pluginName(){return"ImageResizeHandles"}init(){const e=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(e),this._setupResizerCreator()}_setupResizerCreator(){const e=this.editor,t=e.editing.view;t.addObserver(Lw),this.listenTo(t.document,"imageLoaded",((i,n)=>{if(!n.target.matches(rb))return;const s=e.editing.view.domConverter,o=s.domToView(n.target),r=o.findAncestor({classes:ab});let a=this.editor.plugins.get(hw).getResizerByViewElement(r);if(a)return void a.redraw();const l=e.editing.mapper,c=l.toModelElement(r);a=e.plugins.get(hw).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:c,viewElement:r,editor:e,getHandleHost(e){return e.querySelector("img")},getResizeHost(){return s.viewToDom(l.toViewElement(c.parent))},isCentered(){const e=c.getAttribute("imageStyle");return!e||"block"==e||"alignCenter"==e},onCommit(i){t.change((e=>{e.removeClass(lb,r)})),e.execute("resizeImage",{width:i})}}),a.on("updateSize",(()=>{r.hasClass(lb)||t.change((e=>{e.addClass(lb,r)}))})),a.bind("isEnabled").to(this)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class db extends a.Z{static get requires(){return[ib,cb,sb]}static get pluginName(){return"ImageResize"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hb extends b.Z{constructor(e,t){super(e),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(t.map((e=>{if(e.isDefault)for(const t of e.modelElements)this._defaultStyles[t]=e.name;return[e.name,e]})))}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled?i.hasAttribute("imageStyle")?this.value=i.getAttribute("imageStyle"):this.value=this._defaultStyles[i.name]:this.value=!1}execute(e={}){const t=this.editor,i=t.model,n=t.plugins.get("ImageUtils");i.change((t=>{const s=e.value;let o=n.getClosestSelectedImageElement(i.document.selection);s&&this.shouldConvertImageType(s,o)&&(this.editor.execute(n.isBlockImage(o)?"imageTypeInline":"imageTypeBlock"),o=n.getClosestSelectedImageElement(i.document.selection)),!s||this._styles.get(s).isDefault?t.removeAttribute("imageStyle",o):t.setAttribute("imageStyle",s,o)}))}shouldConvertImageType(e,t){const i=this._styles.get(e).modelElements;return!i.includes(t.name)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const{objectFullWidth:ub,objectInline:mb,objectLeft:gb,objectRight:pb,objectCenter:fb,objectBlockLeft:wb,objectBlockRight:bb}=ol,vb={inline:{name:"inline",title:"In line",icon:mb,modelElements:["imageInline"],isDefault:!0},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:gb,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"},alignBlockLeft:{name:"alignBlockLeft",title:"Left aligned image",icon:wb,modelElements:["imageBlock"],className:"image-style-block-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:fb,modelElements:["imageBlock"],className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:pb,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"},alignBlockRight:{name:"alignBlockRight",title:"Right aligned image",icon:bb,modelElements:["imageBlock"],className:"image-style-block-align-right"},block:{name:"block",title:"Centered image",icon:fb,modelElements:["imageBlock"],isDefault:!0},side:{name:"side",title:"Side image",icon:pb,modelElements:["imageBlock"],className:"image-style-side"}},_b={full:ub,left:wb,right:bb,center:fb,inlineLeft:gb,inlineRight:pb,inline:mb},yb=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function Cb(e){const t=e.configuredStyles.options||[],i=t.map((e=>Ab(e))).filter((t=>Eb(t,e)));return i}function kb(e,t){return e&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:e?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{}}function xb(e){return e.has("ImageBlockEditing")&&e.has("ImageInlineEditing")?[...yb]:[]}function Ab(e){return e="string"===typeof e?vb[e]?{...vb[e]}:{name:e}:Tb(vb[e.name],e),"string"===typeof e.icon&&(e.icon=_b[e.icon]||e.icon),e}function Eb(e,{isBlockPluginLoaded:t,isInlinePluginLoaded:i}){const{modelElements:n,name:s}=e;if(!(n&&n.length&&s))return Pb({style:e}),!1;{const s=[t?"imageBlock":null,i?"imageInline":null];if(!n.some((e=>s.includes(e))))return(0,S.KE)("image-style-missing-dependency",{style:e,missingPlugins:n.map((e=>"imageBlock"===e?"ImageBlockEditing":"ImageInlineEditing"))}),!1}return!0}function Tb(e,t){const i={...t};for(const n in e)Object.prototype.hasOwnProperty.call(t,n)||(i[n]=e[n]);return i}function Pb(e){(0,S.KE)("image-style-configuration-definition-invalid",e)}var Sb={normalizeStyles:Cb,getDefaultStylesConfiguration:kb,getDefaultDropdownDefinitions:xb,warnInvalidStyle:Pb,DEFAULT_OPTIONS:vb,DEFAULT_ICONS:_b,DEFAULT_DROPDOWN_DEFINITIONS:yb};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Vb(e){return(t,i,n)=>{if(!n.consumable.consume(i.item,t.name))return;const s=Nb(i.attributeNewValue,e),o=Nb(i.attributeOldValue,e),r=n.mapper.toViewElement(i.item),a=n.writer;o&&a.removeClass(o.className,r),s&&a.addClass(s.className,r)}}function Ib(e){const t={imageInline:e.filter((e=>!e.isDefault&&e.modelElements.includes("imageInline"))),imageBlock:e.filter((e=>!e.isDefault&&e.modelElements.includes("imageBlock")))};return(e,i,n)=>{if(!i.modelRange)return;const s=i.viewItem,o=(0,Xi.Z)(i.modelRange.getItems());if(o&&n.schema.checkAttribute(o,"imageStyle"))for(const r of t[o.name])n.consumable.consume(s,{classes:r.className})&&n.writer.setAttribute("imageStyle",r.name,o)}}function Nb(e,t){for(const i of t)if(i.name===e)return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rb extends a.Z{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[xw]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:t}=Sb,i=this.editor,n=i.plugins.has("ImageBlockEditing"),s=i.plugins.has("ImageInlineEditing");i.config.define("image.styles",t(n,s)),this.normalizedStyles=e({configuredStyles:i.config.get("image.styles"),isBlockPluginLoaded:n,isInlinePluginLoaded:s}),this._setupConversion(n,s),this._setupPostFixer(),i.commands.add("imageStyle",new hb(i,this.normalizedStyles))}_setupConversion(e,t){const i=this.editor,n=i.model.schema,s=Vb(this.normalizedStyles),o=Ib(this.normalizedStyles);i.editing.downcastDispatcher.on("attribute:imageStyle",s),i.data.downcastDispatcher.on("attribute:imageStyle",s),e&&(n.extend("imageBlock",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:figure",o,{priority:"low"})),t&&(n.extend("imageInline",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:img",o,{priority:"low"}))}_setupPostFixer(){const e=this.editor,t=e.model.document,i=e.plugins.get(xw),n=new Map(this.normalizedStyles.map((e=>[e.name,e])));t.registerPostFixer((e=>{let s=!1;for(const o of t.differ.getChanges())if("insert"==o.type||"attribute"==o.type&&"imageStyle"==o.attributeKey){let t="insert"==o.type?o.position.nodeAfter:o.range.start.nodeAfter;if(t&&t.is("element","paragraph")&&t.childCount>0&&(t=t.getChild(0)),!i.isImage(t))continue;const r=t.getAttribute("imageStyle");if(!r)continue;const a=n.get(r);a&&a.modelElements.includes(t.name)||(e.removeAttribute("imageStyle",t),s=!0)}return s}))}}var Db=i(69203);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bb extends a.Z{static get requires(){return[Rb]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],i=Mb(e.get("ImageStyleEditing").normalizedStyles,this.localizedDefaultStylesTitles);for(const s of i)this._createButton(s);const n=Mb([...t.filter(le.Z),...Sb.getDefaultDropdownDefinitions(e)],this.localizedDefaultStylesTitles);for(const s of n)this._createDropdown(s,i)}_createDropdown(e,t){const i=this.editor.ui.componentFactory;i.add(e.name,(n=>{let s;const{defaultItem:o,items:r,title:a}=e,l=r.filter((e=>t.find((({name:t})=>Ob(t)===e)))).map((e=>{const t=i.create(e);return e===o&&(s=t),t}));r.length!==l.length&&Sb.warnInvalidStyle({dropdown:e});const c=vc(n,Ql),d=c.buttonView;return _c(c,l),d.set({label:Lb(a,s.label),class:null,tooltip:!0}),d.bind("icon").toMany(l,"isOn",((...e)=>{const t=e.findIndex(Db.Z);return t<0?s.icon:l[t].icon})),d.bind("label").toMany(l,"isOn",((...e)=>{const t=e.findIndex(Db.Z);return Lb(a,t<0?s.label:l[t].label)})),d.bind("isOn").toMany(l,"isOn",((...e)=>e.some(Db.Z))),d.bind("class").toMany(l,"isOn",((...e)=>e.some(Db.Z)?"ck-splitbutton_flatten":null)),d.on("execute",(()=>{l.some((({isOn:e})=>e))?c.isOpen=!c.isOpen:s.fire("execute")})),c.bind("isEnabled").toMany(l,"isEnabled",((...e)=>e.some(Db.Z))),c}))}_createButton(e){const t=e.name;this.editor.ui.componentFactory.add(Ob(t),(i=>{const n=this.editor.commands.get("imageStyle"),s=new l.Z(i);return s.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),s.bind("isEnabled").to(n,"isEnabled"),s.bind("isOn").to(n,"value",(e=>e===t)),s.on("execute",this._executeCommand.bind(this,t)),s}))}_executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus()}}function Mb(e,t){for(const i of e)t[i.title]&&(i.title=t[i.title]);return e}function Ob(e){return`imageStyle:${e}`}function Lb(e,t){return(e?e+": ":"")+t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fb extends a.Z{static get requires(){return[Rb,Bb]}static get pluginName(){return"ImageStyle"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zb extends a.Z{static get requires(){return[Jf,xw]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t,i=e.plugins.get(Jf),n=e.plugins.get("ImageUtils");i.register("image",{ariaLabel:t("Image toolbar"),items:$b(e.config.get("image.toolbar")||[]),getRelatedElement:e=>n.getClosestSelectedImageWidget(e)})}}function $b(e){return e.map((e=>(0,le.Z)(e)?e.name:e))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zb(e){const t=e.map((e=>e.replace("+","\\+")));return new RegExp(`^image\\/(${t.join("|")})$`)}function Hb(e){return new Promise(((t,i)=>{const n=e.getAttribute("src");fetch(n).then((e=>e.blob())).then((e=>{const i=Wb(e,n),s=i.replace("image/",""),o=`image.${s}`,r=new File([e],o,{type:i});t(r)})).catch((e=>e&&"TypeError"===e.name?qb(n).then(t).catch(i):i(e)))}))}function Ub(e,t){return!(!e.isInlineImageView(t)||!t.getAttribute("src"))&&(t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||t.getAttribute("src").match(/^blob:/g))}function Wb(e,t){return e.type?e.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function qb(e){return Gb(e).then((t=>{const i=Wb(t,e),n=i.replace("image/",""),s=`image.${n}`;return new File([t],s,{type:i})}))}function Gb(e){return new Promise(((t,i)=>{const n=ri.document.createElement("img");n.addEventListener("load",(()=>{const e=ri.document.createElement("canvas");e.width=n.width,e.height=n.height;const s=e.getContext("2d");s.drawImage(n,0,0),e.toBlob((e=>e?t(e):i()))})),n.addEventListener("error",(()=>i())),n.src=e}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jb extends a.Z{static get pluginName(){return"ImageUploadUI"}init(){const e=this.editor,t=e.t,i=i=>{const n=new dl(i),s=e.commands.get("uploadImage"),o=e.config.get("image.upload.types"),r=Zb(o);return n.set({acceptedType:o.map((e=>`image/${e}`)).join(","),allowMultipleFiles:!0}),n.buttonView.set({label:t("Insert image"),icon:ol.image,tooltip:!0}),n.buttonView.bind("isEnabled").to(s),n.on("done",((t,i)=>{const n=Array.from(i).filter((e=>r.test(e.type)));n.length&&e.execute("uploadImage",{file:n})})),n};e.ui.componentFactory.add("uploadImage",i),e.ui.componentFactory.add("imageUpload",i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kb extends a.Z{static get pluginName(){return"ImageUploadProgress"}constructor(e){super(e),this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",((...e)=>this.uploadStatusChange(...e))),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",((...e)=>this.uploadStatusChange(...e)))}uploadStatusChange(e,t,i){const n=this.editor,s=t.item,o=s.getAttribute("uploadId");if(!i.consumable.consume(t.item,e.name))return;const r=n.plugins.get("ImageUtils"),a=n.plugins.get(al),l=o?t.attributeNewValue:null,c=this.placeholder,d=n.editing.mapper.toViewElement(s),h=i.writer;if("reading"==l)return Jb(d,h),void Qb(r,c,d,h);if("uploading"==l){const e=a.loaders.get(o);return Jb(d,h),void(e?(Xb(d,h),ev(d,h,e,n.editing.view),av(r,d,h,e)):Qb(r,c,d,h))}"complete"==l&&a.loaders.get(o)&&iv(d,h,n.editing.view),tv(d,h),Xb(d,h),Yb(d,h)}}function Jb(e,t){e.hasClass("ck-appear")||t.addClass("ck-appear",e)}function Yb(e,t){t.removeClass("ck-appear",e)}function Qb(e,t,i,n){i.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",i);const s=e.findViewImgElement(i);s.getAttribute("src")!==t&&n.setAttribute("src",t,s),ov(i,"placeholder")||n.insert(n.createPositionAfter(s),sv(n))}function Xb(e,t){e.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",e),rv(e,t,"placeholder")}function ev(e,t,i,n){const s=nv(t);t.insert(t.createPositionAt(e,"end"),s),i.on("change:uploadedPercent",((e,t,i)=>{n.change((e=>{e.setStyle("width",i+"%",s)}))}))}function tv(e,t){rv(e,t,"progressBar")}function iv(e,t,i){const n=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(e,"end"),n),setTimeout((()=>{i.change((e=>e.remove(e.createRangeOn(n))))}),3e3)}function nv(e){const t=e.createUIElement("div",{class:"ck-progress-bar"});return e.setCustomProperty("progressBar",!0,t),t}function sv(e){const t=e.createUIElement("div",{class:"ck-upload-placeholder-loader"});return e.setCustomProperty("placeholder",!0,t),t}function ov(e,t){for(const i of e.getChildren())if(i.getCustomProperty(t))return i}function rv(e,t,i){const n=ov(e,i);n&&t.remove(t.createRangeOn(n))}function av(e,t,i,n){if(n.data){const s=e.findViewImgElement(t);i.setAttribute("src",n.data,s)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lv extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=e.model.document.selection.getSelectedElement();this.isEnabled=t.isImageAllowed()||t.isImage(i)}execute(e){const t=(0,R.Z)(e.file),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),s=Object.fromEntries(i.getAttributes());t.forEach(((e,t)=>{const o=i.getSelectedElement();if(t&&o&&n.isImage(o)){const t=this.editor.model.createPositionAfter(o);this._uploadImage(e,s,t)}else this._uploadImage(e,s)}))}_uploadImage(e,t,i){const n=this.editor,s=n.plugins.get(al),o=s.createLoader(e),r=n.plugins.get("ImageUtils");o&&r.insertImage({...t,uploadId:o.id},i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cv extends a.Z{static get requires(){return[al,Oc,ag,xw]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const e=this.editor,t=e.model.document,i=e.conversion,n=e.plugins.get(al),s=e.plugins.get("ImageUtils"),o=Zb(e.config.get("image.upload.types")),r=new lv(e);e.commands.add("uploadImage",r),e.commands.add("imageUpload",r),i.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",((t,i)=>{if(dv(i.dataTransfer))return;const n=Array.from(i.dataTransfer.files).filter((e=>!!e&&o.test(e.type)));n.length&&(t.stop(),e.model.change((t=>{i.targetRanges&&t.setSelection(i.targetRanges.map((t=>e.editing.mapper.toModelRange(t)))),e.model.enqueueChange("default",(()=>{e.execute("uploadImage",{file:n})}))})))})),this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((t,i)=>{const o=Array.from(e.editing.view.createRangeIn(i.content)).filter((e=>Ub(s,e.item)&&!e.item.getAttribute("uploadProcessed"))).map((e=>({promise:Hb(e.item),imageElement:e.item})));if(!o.length)return;const r=new vh(e.editing.view.document);for(const e of o){r.setAttribute("uploadProcessed",!0,e.imageElement);const t=n.createLoader(e.promise);t&&(r.setAttribute("src","",e.imageElement),r.setAttribute("uploadId",t.id,e.imageElement))}})),e.editing.view.document.on("dragover",((e,t)=>{t.preventDefault()})),t.on("change",(()=>{const i=t.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),s=new Set;for(const t of i)if("insert"==t.type&&"$text"!=t.name){const i=t.position.nodeAfter,o="$graveyard"==t.position.root.rootName;for(const t of hv(e,i)){const e=t.getAttribute("uploadId");if(!e)continue;const i=n.loaders.get(e);i&&(o?s.has(e)||i.abort():(s.add(e),this._uploadImageElements.set(e,t),"idle"==i.status&&this._readAndUpload(i)))}}})),this.on("uploadComplete",((e,{imageElement:t,data:i})=>{const n=i.urls?i.urls:i;this.editor.model.change((e=>{e.setAttribute("src",n.default,t),this._parseAndSetSrcsetAttributeOnImage(n,t,e)}))}),{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(e){const t=this.editor,i=t.model,n=t.locale.t,s=t.plugins.get(al),o=t.plugins.get(Oc),r=t.plugins.get("ImageUtils"),a=this._uploadImageElements;return i.enqueueChange("transparent",(t=>{t.setAttribute("uploadStatus","reading",a.get(e.id))})),e.read().then((()=>{const n=e.upload(),s=a.get(e.id);if(Yt.ZP.isSafari){const e=t.editing.mapper.toViewElement(s),i=r.findViewImgElement(e);t.editing.view.once("render",(()=>{if(!i.parent)return;const e=t.editing.view.domConverter.mapViewToDom(i.parent);if(!e)return;const n=e.style.display;e.style.display="none",e._ckHack=e.offsetHeight,e.style.display=n}))}return i.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","uploading",s)})),n})).then((t=>{i.enqueueChange("transparent",(i=>{const n=a.get(e.id);i.setAttribute("uploadStatus","complete",n),this.fire("uploadComplete",{data:t,imageElement:n})})),l()})).catch((t=>{if("error"!==e.status&&"aborted"!==e.status)throw t;"error"==e.status&&t&&o.showWarning(t,{title:n("Upload failed"),namespace:"upload"}),i.enqueueChange("transparent",(t=>{t.remove(a.get(e.id))})),l()}));function l(){i.enqueueChange("transparent",(t=>{const i=a.get(e.id);t.removeAttribute("uploadId",i),t.removeAttribute("uploadStatus",i),a.delete(e.id)})),s.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,i){let n=0;const s=Object.keys(e).filter((e=>{const t=parseInt(e,10);if(!isNaN(t))return n=Math.max(n,t),!0})).map((t=>`${e[t]} ${t}w`)).join(", ");""!=s&&i.setAttribute("srcset",{data:s,width:n},t)}}function dv(e){return Array.from(e.types).includes("text/html")&&""!==e.getData("text/html")}function hv(e,t){const i=e.plugins.get("ImageUtils");return Array.from(e.model.createRangeOn(t)).filter((e=>i.isImage(e.item))).map((e=>e.item))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uv extends a.Z{static get pluginName(){return"ImageUpload"}static get requires(){return[cv,jb,Kb]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mv extends a.Z{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new v(e)),e.commands.add("outdent",new v(e))}}var gv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',pv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fv extends a.Z{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,i=e.t,n="ltr"==t.uiLanguageDirection?gv:pv,s="ltr"==t.uiLanguageDirection?pv:gv;this._defineButton("indent",i("Increase indent"),n),this._defineButton("outdent",i("Decrease indent"),s)}_defineButton(e,t,i){const n=this.editor;n.ui.componentFactory.add(e,(s=>{const o=n.commands.get(e),r=new l.Z(s);return r.set({label:t,icon:i,tooltip:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(r,"execute",(()=>{n.execute(e),n.editing.view.focus()})),r}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wv extends a.Z{static get pluginName(){return"Indent"}static get requires(){return[mv,fv]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
class bv{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach((e=>this._definitions.add(e))):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",((e,t,i)=>{if(!i.consumable.test(t.item,"attribute:linkHref"))return;const n=i.writer,s=n.document.selection;for(const o of this._definitions){const e=n.createAttributeElement("a",o.attributes,{priority:5});o.classes&&n.addClass(o.classes,e);for(const t in o.styles)n.setStyle(t,o.styles[t],e);n.setCustomProperty("link",!0,e),o.callback(t.attributeNewValue)?t.item.is("selection")?n.wrap(s.getFirstRange(),e):n.wrap(i.mapper.toViewRange(t.range),e):n.unwrap(i.mapper.toViewRange(t.range),e)}}),{priority:"high"})}}getDispatcherForLinkedImage(){return e=>{e.on("attribute:linkHref:imageBlock",((e,t,{writer:i,mapper:n})=>{const s=n.toViewElement(t.item),o=Array.from(s.getChildren()).find((e=>"a"===e.name));for(const r of this._definitions){const e=Y(r.attributes);if(r.callback(t.attributeNewValue)){for(const[t,n]of e)"class"===t?i.addClass(n,o):i.setAttribute(t,n,o);r.classes&&i.addClass(r.classes,o);for(const e in r.styles)i.setStyle(e,r.styles[e],o)}else{for(const[t,n]of e)"class"===t?i.removeClass(n,o):i.removeAttribute(t,o);r.classes&&i.removeClass(r.classes,o);for(const e in r.styles)i.removeStyle(e,o)}}}))}}}function vv(e,t,i){var n=e.length;return i=void 0===i?n:i,!t&&i>=n?e:ge(e,t,i)}var _v=vv,yv="\\ud800-\\udfff",Cv="\\u0300-\\u036f",kv="\\ufe20-\\ufe2f",xv="\\u20d0-\\u20ff",Av=Cv+kv+xv,Ev="\\ufe0e\\ufe0f",Tv="\\u200d",Pv=RegExp("["+Tv+yv+Av+Ev+"]");function Sv(e){return Pv.test(e)}var Vv=Sv;function Iv(e){return e.split("")}var Nv=Iv,Rv="\\ud800-\\udfff",Dv="\\u0300-\\u036f",Bv="\\ufe20-\\ufe2f",Mv="\\u20d0-\\u20ff",Ov=Dv+Bv+Mv,Lv="\\ufe0e\\ufe0f",Fv="["+Rv+"]",zv="["+Ov+"]",$v="\\ud83c[\\udffb-\\udfff]",Zv="(?:"+zv+"|"+$v+")",Hv="[^"+Rv+"]",Uv="(?:\\ud83c[\\udde6-\\uddff]){2}",Wv="[\\ud800-\\udbff][\\udc00-\\udfff]",qv="\\u200d",Gv=Zv+"?",jv="["+Lv+"]?",Kv="(?:"+qv+"(?:"+[Hv,Uv,Wv].join("|")+")"+jv+Gv+")*",Jv=jv+Gv+Kv,Yv="(?:"+[Hv+zv+"?",zv,Uv,Wv,Fv].join("|")+")",Qv=RegExp($v+"(?="+$v+")|"+Yv+Jv,"g");function Xv(e){return e.match(Qv)||[]}var e_=Xv;function t_(e){return Vv(e)?e_(e):Nv(e)}var i_=t_;function n_(e){return function(t){t=(0,Nd.Z)(t);var i=Vv(t)?i_(t):void 0,n=i?i[0]:t.charAt(0),s=i?_v(i,1).join(""):t.slice(1);return n[e]()+s}}var s_=n_,o_=s_("toUpperCase"),r_=o_;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const a_=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,l_=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,c_=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,d_=/^((\w+:(\/{2,})?)|(\W))/i,h_="Ctrl+K";function u_(e){return e.is("attributeElement")&&!!e.getCustomProperty("link")}function m_(e,{writer:t}){const i=t.createAttributeElement("a",{href:e},{priority:5});return t.setCustomProperty("link",!0,i),i}function g_(e){return e=String(e),p_(e)?e:"#"}function p_(e){const t=e.replace(a_,"");return t.match(l_)}function f_(e,t){const i={"Open in a new tab":e("Open in a new tab"),Downloadable:e("Downloadable")};return t.forEach((e=>(e.label&&i[e.label]&&(e.label=i[e.label]),e))),t}function w_(e){const t=[];if(e)for(const[i,n]of Object.entries(e)){const e=Object.assign({},n,{id:`link${r_(i)}`});t.push(e)}return t}function b_(e,t){return!!e&&t.checkAttribute(e.name,"linkHref")}function v_(e){return c_.test(e)}function __(e,t){const i=v_(e)?"mailto:":t,n=!!i&&!d_.test(e);return e&&n?i+e:e}function y_(e){window.open(e,"_blank","noopener")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class C_ extends b.Z{constructor(e){super(e),this.manualDecorators=new P.Z,this.automaticDecorators=new bv}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement()||(0,Xi.Z)(t.getSelectedBlocks());b_(i,e.schema)?(this.value=i.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(i,"linkHref")):(this.value=t.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref"));for(const n of this.manualDecorators)n.value=this._getDecoratorStateFromModel(n.id)}execute(e,t={}){const i=this.editor.model,n=i.document.selection,s=[],o=[];for(const r in t)t[r]?s.push(r):o.push(r);i.change((t=>{if(n.isCollapsed){const r=n.getFirstPosition();if(n.hasAttribute("linkHref")){const a=Gd(r,"linkHref",n.getAttribute("linkHref"),i);t.setAttribute("linkHref",e,a),s.forEach((e=>{t.setAttribute(e,!0,a)})),o.forEach((e=>{t.removeAttribute(e,a)})),t.setSelection(t.createPositionAfter(a.end.nodeBefore))}else if(""!==e){const o=Y(n.getAttributes());o.set("linkHref",e),s.forEach((e=>{o.set(e,!0)}));const{end:a}=i.insertContent(t.createText(e,o),r);t.setSelection(a)}["linkHref",...s,...o].forEach((e=>{t.removeSelectionAttribute(e)}))}else{const r=i.schema.getValidRanges(n.getRanges(),"linkHref"),a=[];for(const e of n.getSelectedBlocks())i.schema.checkAttribute(e,"linkHref")&&a.push(t.createRangeOn(e));const l=a.slice();for(const e of r)this._isRangeToUpdate(e,a)&&l.push(e);for(const i of l)t.setAttribute("linkHref",e,i),s.forEach((e=>{t.setAttribute(e,!0,i)})),o.forEach((e=>{t.removeAttribute(e,i)}))}}))}_getDecoratorStateFromModel(e){const t=this.editor.model,i=t.document.selection,n=i.getSelectedElement();return b_(n,t.schema)?n.getAttribute(e):i.getAttribute(e)}_isRangeToUpdate(e,t){for(const i of t)if(i.containsRange(e))return!1;return!0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class k_ extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement();b_(i,e.schema)?this.isEnabled=e.schema.checkAttribute(i,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref")}execute(){const e=this.editor,t=this.editor.model,i=t.document.selection,n=e.commands.get("link");t.change((e=>{const s=i.isCollapsed?[Gd(i.getFirstPosition(),"linkHref",i.getAttribute("linkHref"),t)]:t.schema.getValidRanges(i.getRanges(),"linkHref");for(const t of s)if(e.removeAttribute("linkHref",t),n)for(const i of n.manualDecorators)e.removeAttribute(i.id,t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class x_{constructor({id:e,label:t,attributes:i,classes:n,styles:s,defaultValue:o}){this.id=e,this.set("value"),this.defaultValue=o,this.label=t,this.attributes=i,this.classes=n,this.styles=s}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}(0,I.Z)(x_,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const A_="ck-link_selected",E_="automatic",T_="manual",P_=/^(https?:)?\/\//;class S_ extends a.Z{static get pluginName(){return"LinkEditing"}static get requires(){return[Ed,vd,ag]}constructor(e){super(e),e.config.define("link",{addTargetToExternalLinks:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:m_}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(e,t)=>m_(g_(e),t)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:e=>e.getAttribute("href")}}),e.commands.add("link",new C_(e)),e.commands.add("unlink",new k_(e));const t=f_(e.t,w_(e.config.get("link.decorators")));this._enableAutomaticDecorators(t.filter((e=>e.mode===E_))),this._enableManualDecorators(t.filter((e=>e.mode===T_)));const i=e.plugins.get(Ed);i.registerAttribute("linkHref"),Kd(e,"linkHref","a",A_),this._enableLinkOpen(),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterLink(),this._enableTypingOverLink(),this._handleDeleteContentAfterLink()}_enableAutomaticDecorators(e){const t=this.editor,i=t.commands.get("link"),n=i.automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&n.add({id:"linkIsExternal",mode:E_,callback:e=>P_.test(e),attributes:{target:"_blank",rel:"noopener noreferrer"}}),n.add(e),n.length&&t.conversion.for("downcast").add(n.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,i=t.commands.get("link"),n=i.manualDecorators;e.forEach((e=>{t.model.schema.extend("$text",{allowAttributes:e.id}),e=new x_(e),n.add(e),t.conversion.for("downcast").attributeToElement({model:e.id,view:(t,{writer:i})=>{if(t){const t=i.createAttributeElement("a",e.attributes,{priority:5});e.classes&&i.addClass(e.classes,t);for(const n in e.styles)i.setStyle(n,e.styles[n],t);return i.setCustomProperty("link",!0,t),t}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",...e._createPattern()},model:{key:e.id}})}))}_enableLinkOpen(){const e=this.editor,t=e.editing.view,i=t.document,n=e.model.document;this.listenTo(i,"click",((e,t)=>{const i=Yt.ZP.isMac?t.domEvent.metaKey:t.domEvent.ctrlKey;if(!i)return;let n=t.domTarget;if("a"!=n.tagName.toLowerCase()&&(n=n.closest("a")),!n)return;const s=n.getAttribute("href");s&&(e.stop(),t.preventDefault(),y_(s))}),{context:"$capture"}),this.listenTo(i,"enter",((e,t)=>{const i=n.selection,s=i.getSelectedElement(),o=s?s.getAttribute("linkHref"):i.getAttribute("linkHref"),r=o&&t.domEvent.altKey;r&&(e.stop(),y_(o))}),{context:"a"})}_enableInsertContentSelectionAttributesFixer(){const e=this.editor,t=e.model,i=t.document.selection;this.listenTo(t,"insertContent",(()=>{const e=i.anchor.nodeBefore,n=i.anchor.nodeAfter;i.hasAttribute("linkHref")&&e&&e.hasAttribute("linkHref")&&(n&&n.hasAttribute("linkHref")||t.change((e=>{V_(e,R_(t.schema))})))}),{priority:"low"})}_enableClickingAfterLink(){const e=this.editor,t=e.model;e.editing.view.addObserver(bh);let i=!1;this.listenTo(e.editing.view.document,"mousedown",(()=>{i=!0})),this.listenTo(e.editing.view.document,"selectionChange",(()=>{if(!i)return;i=!1;const e=t.document.selection;if(!e.isCollapsed)return;if(!e.hasAttribute("linkHref"))return;const n=e.getFirstPosition(),s=Gd(n,"linkHref",e.getAttribute("linkHref"),t);(n.isTouching(s.start)||n.isTouching(s.end))&&t.change((e=>{V_(e,R_(t.schema))}))}))}_enableTypingOverLink(){const e=this.editor,t=e.editing.view;let i,n;this.listenTo(t.document,"delete",(()=>{n=!0}),{priority:"high"}),this.listenTo(e.model,"deleteContent",(()=>{const t=e.model.document.selection;t.isCollapsed||(n?n=!1:N_(e)&&I_(e.model)&&(i=t.getAttributes()))}),{priority:"high"}),this.listenTo(e.model,"insertContent",((t,[s])=>{n=!1,N_(e)&&i&&(e.model.change((e=>{for(const[t,n]of i)e.setAttribute(t,n,s)})),i=null)}),{priority:"high"})}_handleDeleteContentAfterLink(){const e=this.editor,t=e.model,i=t.document.selection,n=e.editing.view;let s=!1,o=!1;this.listenTo(n.document,"delete",((e,t)=>{o=t.domEvent.keyCode===ct.Do.backspace}),{priority:"high"}),this.listenTo(t,"deleteContent",(()=>{s=!1;const e=i.getFirstPosition(),n=i.getAttribute("linkHref");if(!n)return;const o=Gd(e,"linkHref",n,t);s=o.containsPosition(e)||o.end.isEqual(e)}),{priority:"high"}),this.listenTo(t,"deleteContent",(()=>{o&&(o=!1,s||e.model.enqueueChange((e=>{V_(e,R_(t.schema))})))}),{priority:"low"})}}function V_(e,t){e.removeSelectionAttribute("linkHref");for(const i of t)e.removeSelectionAttribute(i)}function I_(e){const t=e.document.selection,i=t.getFirstPosition(),n=t.getLastPosition(),s=i.nodeAfter;if(!s)return!1;if(!s.is("$text"))return!1;if(!s.hasAttribute("linkHref"))return!1;const o=n.textNode||n.nodeBefore;if(s===o)return!0;const r=Gd(i,"linkHref",s.getAttribute("linkHref"),e);return r.containsRange(e.createRange(i,n),!0)}function N_(e){const t=e.plugins.get("Input");return t.isInput(e.model.change((e=>e.batch)))}function R_(e){const t=e.getDefinition("$text").allowAttributes;return t.filter((e=>e.startsWith("link")))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class D_ extends cl.Z{constructor(e,t){super(e);const i=e.t;this.focusTracker=new en,this.keystrokes=new tn,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),ol.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(i("Cancel"),ol.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t.manualDecorators),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const n=["ck","ck-link-form","ck-responsive-form"];t.manualDecorators.length&&n.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:n,tabindex:"-1"},children:this.children}),Bl(this)}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce(((e,t)=>(e[t.name]=t.isOn,e)),{})}render(){super.render(),Ml({view:this});const e=[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,t=new Dc(this.locale,Bc);return t.label=e("Link URL"),t}_createButton(e,t,i,n){const s=new l.Z(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.extendTemplate({attributes:{class:i}}),n&&s.delegate("execute").to(this,n),s}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const i of e.manualDecorators){const n=new zl(this.locale);n.set({name:i.id,label:i.label,withText:!0}),n.bind("isOn").toMany([i,e],"value",((e,t)=>void 0===t&&void 0===e?i.defaultValue:e)),n.on("execute",(()=>{i.set("value",!n.isOn)})),t.add(n)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const e=new cl.Z;e.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map((e=>({tag:"li",children:[e],attributes:{class:["ck","ck-list__item"]}}))),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(e)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}}var B_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class M_ extends cl.Z{constructor(e){super(e);const t=e.t;this.focusTracker=new en,this.keystrokes=new tn,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(t("Unlink"),B_,"unlink"),this.editButtonView=this._createButton(t("Edit link"),ol.pencil,"edit"),this.set("href"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render();const e=[this.previewButtonView,this.editButtonView,this.unlinkButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(e,t,i){const n=new l.Z(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.delegate("execute").to(this,i),n}_createPreviewButton(){const e=new l.Z(this.locale),t=this.bindTemplate,i=this.t;return e.set({withText:!0,tooltip:i("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:t.to("href",(e=>e&&g_(e))),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",(e=>e||i("This link has no URL"))),e.bind("isEnabled").to(this,"href",(e=>!!e)),e.template.tag="a",e.template.eventListeners={},e}}var O_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const L_="link-ui";class F_ extends a.Z{static get requires(){return[jc]}static get pluginName(){return"LinkUI"}init(){const e=this.editor;e.editing.view.addObserver(wh),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get(jc),this._createToolbarLinkButton(),this._enableUserBalloonInteractions(),e.conversion.for("editingDowncast").markerToHighlight({model:L_,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:L_,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,t=new M_(e.locale),i=e.commands.get("link"),n=e.commands.get("unlink");return t.bind("href").to(i,"value"),t.editButtonView.bind("isEnabled").to(i),t.unlinkButtonView.bind("isEnabled").to(n),this.listenTo(t,"edit",(()=>{this._addFormView()})),this.listenTo(t,"unlink",(()=>{e.execute("unlink"),this._hideUI()})),t.keystrokes.set("Esc",((e,t)=>{this._hideUI(),t()})),t.keystrokes.set(h_,((e,t)=>{this._addFormView(),t()})),t}_createFormView(){const e=this.editor,t=e.commands.get("link"),i=e.config.get("link.defaultProtocol"),n=new D_(e.locale,t);return n.urlInputView.fieldView.bind("value").to(t,"value"),n.urlInputView.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),n.saveButtonView.bind("isEnabled").to(t),this.listenTo(n,"submit",(()=>{const{value:t}=n.urlInputView.fieldView.element,s=__(t,i);e.execute("link",s,n.getDecoratorSwitchesState()),this._closeFormView()})),this.listenTo(n,"cancel",(()=>{this._closeFormView()})),n.keystrokes.set("Esc",((e,t)=>{this._closeFormView(),t()})),n}_createToolbarLinkButton(){const e=this.editor,t=e.commands.get("link"),i=e.t;e.keystrokes.set(h_,((e,i)=>{i(),t.isEnabled&&this._showUI(!0)})),e.ui.componentFactory.add("link",(e=>{const n=new l.Z(e);return n.isEnabled=!0,n.label=i("Link"),n.icon=O_,n.keystroke=h_,n.tooltip=!0,n.isToggleable=!0,n.bind("isEnabled").to(t,"isEnabled"),n.bind("isOn").to(t,"value",(e=>!!e)),this.listenTo(n,"execute",(()=>this._showUI(!0))),n}))}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",(()=>{const e=this._getSelectedLinkElement();e&&this._showUI()})),this.editor.keystrokes.set("Tab",((e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())}),{priority:"high"}),this.editor.keystrokes.set("Esc",((e,t)=>{this._isUIVisible&&(this._hideUI(),t())})),Dl({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const e=this.editor,t=e.commands.get("link");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=t.value||""}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let i=this._getSelectedLinkElement(),n=o();const s=()=>{const e=this._getSelectedLinkElement(),t=o();i&&!e||!i&&t!==n?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),i=e,n=t};function o(){return t.selection.focus.getAncestors().reverse().find((e=>e.is("element")))}this.listenTo(e.ui,"update",s),this.listenTo(this._balloon,"change:visibleView",s)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){const e=this._balloon.visibleView;return e==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model,i=e.document;let n=null;if(t.markers.has(L_)){const t=Array.from(this.editor.editing.mapper.markerNameToElements(L_)),i=e.createRange(e.createPositionBefore(t[0]),e.createPositionAfter(t[t.length-1]));n=e.domConverter.viewRangeToDom(i)}else n=()=>{const t=this._getSelectedLinkElement();return t?e.domConverter.mapViewToDom(t):e.domConverter.viewRangeToDom(i.selection.getFirstRange())};return{target:n}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection,i=t.getSelectedElement();if(t.isCollapsed||i&&pg(i))return z_(t.getFirstPosition());{const i=t.getFirstRange().getTrimmed(),n=z_(i.start),s=z_(i.end);return n&&n==s&&e.createRangeIn(n).getTrimmed().isEqual(i)?n:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change((t=>{const i=e.document.selection.getFirstRange();if(e.markers.has(L_))t.updateMarker(L_,{range:i});else if(i.start.isAtEnd){const n=i.start.getLastMatchingPosition((({item:t})=>!e.schema.isContent(t)),{boundaries:i});t.addMarker(L_,{usingOperation:!1,affectsData:!1,range:t.createRange(n,i.end)})}else t.addMarker(L_,{usingOperation:!1,affectsData:!1,range:i})}))}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(L_)&&e.change((e=>{e.removeMarker(L_)}))}}function z_(e){return e.getAncestors().find((e=>u_(e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const $_=4,Z_=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),H_=2;class U_ extends a.Z{static get requires(){return[Cd]}static get pluginName(){return"AutoLink"}init(){const e=this.editor,t=e.model.document.selection;t.on("change:range",(()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")})),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling()}_enableTypingHandling(){const e=this.editor,t=new Ad(e.model,(e=>{if(!W_(e))return;const t=q_(e.substr(0,e.length-1));return t?{url:t}:void 0})),i=e.plugins.get("Input");t.on("matched:data",((t,n)=>{const{batch:s,range:o,url:r}=n;if(!i.isInput(s))return;const a=o.end.getShiftedBy(-1),l=a.getShiftedBy(-r.length),c=e.model.createRange(l,a);this._applyAutoLink(r,c)})),t.bind("isEnabled").to(this)}_enableEnterHandling(){const e=this.editor,t=e.model,i=e.commands.get("enter");i&&i.on("execute",(()=>{const e=t.document.selection.getFirstPosition();if(!e.parent.previousSibling)return;const i=t.createRangeIn(e.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(i)}))}_enableShiftEnterHandling(){const e=this.editor,t=e.model,i=e.commands.get("shiftEnter");i&&i.on("execute",(()=>{const e=t.document.selection.getFirstPosition(),i=t.createRange(t.createPositionAt(e.parent,0),e.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(i)}))}_checkAndApplyAutoLinkOnRange(e){const t=this.editor.model,{text:i,range:n}=xd(e,t),s=q_(i);if(s){const e=t.createRange(n.end.getShiftedBy(-s.length),n.end);this._applyAutoLink(s,e)}}_applyAutoLink(e,t){const i=this.editor.model,n=this.editor.plugins.get("Delete");this.isEnabled&&G_(t,i)&&i.enqueueChange((s=>{const o=this.editor.config.get("link.defaultProtocol"),r=__(e,o);s.setAttribute("linkHref",r,t),i.enqueueChange((()=>{n.requestUndoOnBackspace()}))}))}}function W_(e){return e.length>$_&&" "===e[e.length-1]&&" "!==e[e.length-2]}function q_(e){const t=Z_.exec(e);return t?t[H_]:null}function G_(e,t){return t.schema.checkAttributeInSelection(t.createSelection(e),"linkHref")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class j_ extends a.Z{static get requires(){return[S_,F_,U_]}static get pluginName(){return"Link"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class K_ extends b.Z{constructor(e,t){super(e),this.type=t}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.document,n=Array.from(i.selection.getSelectedBlocks()).filter((e=>Y_(e,t.schema))),s=void 0!==e.forceValue?!e.forceValue:this.value;t.change((e=>{if(s){let t=n[n.length-1].nextSibling,i=Number.POSITIVE_INFINITY,s=[];while(t&&"listItem"==t.name&&0!==t.getAttribute("listIndent")){const e=t.getAttribute("listIndent");e<i&&(i=e);const n=e-i;s.push({element:t,listIndent:n}),t=t.nextSibling}s=s.reverse();for(const n of s)e.setAttribute("listIndent",n.listIndent,n.element)}if(!s){let e=Number.POSITIVE_INFINITY;for(const t of n)t.is("element","listItem")&&t.getAttribute("listIndent")<e&&(e=t.getAttribute("listIndent"));e=0===e?1:e,J_(n,!0,e),J_(n,!1,e)}for(const t of n.reverse())s&&"listItem"==t.name?e.rename(t,"paragraph"):s||"listItem"==t.name?s||"listItem"!=t.name||t.getAttribute("listType")==this.type||e.setAttribute("listType",this.type,t):(e.setAttributes({listType:this.type,listIndent:0},t),e.rename(t,"listItem"));this.fire("_executeCleanup",n)}))}_getValue(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("element","listItem")&&e.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&Y_(i,t)}}function J_(e,t,i){const n=t?e[0]:e[e.length-1];if(n.is("element","listItem")){let s=n[t?"previousSibling":"nextSibling"],o=n.getAttribute("listIndent");while(s&&s.is("element","listItem")&&s.getAttribute("listIndent")>=i)o>s.getAttribute("listIndent")&&(o=s.getAttribute("listIndent")),s.getAttribute("listIndent")==o&&e[t?"unshift":"push"](s),s=s[t?"previousSibling":"nextSibling"]}}function Y_(e,t){return t.checkChild(e.parent,"listItem")&&!t.isObject(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Q_ extends b.Z{constructor(e,t){super(e),this._indentBy="forward"==t?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document;let i=Array.from(t.selection.getSelectedBlocks());e.change((e=>{const t=i[i.length-1];let n=t.nextSibling;while(n&&"listItem"==n.name&&n.getAttribute("listIndent")>t.getAttribute("listIndent"))i.push(n),n=n.nextSibling;this._indentBy<0&&(i=i.reverse());for(const s of i){const t=s.getAttribute("listIndent")+this._indentBy;t<0?e.rename(s,"paragraph"):e.setAttribute("listIndent",t,s)}this.fire("_executeCleanup",i)}))}_checkEnabled(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("element","listItem"))return!1;if(this._indentBy>0){const t=e.getAttribute("listIndent"),i=e.getAttribute("listType");let n=e.previousSibling;while(n&&n.is("element","listItem")&&n.getAttribute("listIndent")>=t){if(n.getAttribute("listIndent")==t)return n.getAttribute("listType")==i;n=n.previousSibling}return!1}return!0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function X_(e){const t=e.createContainerElement("li");return t.getFillerOffset=ay,t}function ey(e,t){const i=t.mapper,n=t.writer,s="numbered"==e.getAttribute("listType")?"ol":"ul",o=X_(n),r=n.createContainerElement(s,null);return n.insert(n.createPositionAt(r,0),o),i.bindElements(e,o),o}function ty(e,t,i,n){const s=t.parent,o=i.mapper,r=i.writer;let a=o.toViewPosition(n.createPositionBefore(e));const l=sy(e.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:e.getAttribute("listIndent")}),c=e.previousSibling;if(l&&l.getAttribute("listIndent")==e.getAttribute("listIndent")){const e=o.toViewElement(l);a=r.breakContainer(r.createPositionAfter(e))}else if(c&&"listItem"==c.name){a=o.toViewPosition(n.createPositionAt(c,"end"));const e=o.findMappedViewAncestor(a),t=ry(e);a=t?r.createPositionBefore(t):r.createPositionAt(e,"end")}else a=o.toViewPosition(n.createPositionBefore(e));if(a=ny(a),r.insert(a,s),c&&"listItem"==c.name){const e=o.toViewElement(c),i=r.createRange(r.createPositionAt(e,0),a),n=i.getWalker({ignoreElementEnd:!0});for(const s of n)if(s.item.is("element","li")){const e=r.breakContainer(r.createPositionBefore(s.item)),i=s.item.parent,o=r.createPositionAt(t,"end");iy(r,o.nodeBefore,o.nodeAfter),r.move(r.createRangeOn(i),o),n.position=e}}else{const i=s.nextSibling;if(i&&(i.is("element","ul")||i.is("element","ol"))){let n=null;for(const t of i.getChildren()){const i=o.toModelElement(t);if(!(i&&i.getAttribute("listIndent")>e.getAttribute("listIndent")))break;n=t}n&&(r.breakContainer(r.createPositionAfter(n)),r.move(r.createRangeOn(n.parent),r.createPositionAt(t,"end")))}}iy(r,s,s.nextSibling),iy(r,s.previousSibling,s)}function iy(e,t,i){return!t||!i||"ul"!=t.name&&"ol"!=t.name||t.name!=i.name||t.getAttribute("class")!==i.getAttribute("class")?null:e.mergeContainers(e.createPositionAfter(t))}function ny(e){return e.getLastMatchingPosition((e=>e.item.is("uiElement")))}function sy(e,t){const i=!!t.sameIndent,n=!!t.smallerIndent,s=t.listIndent;let o=e;while(o&&"listItem"==o.name){const e=o.getAttribute("listIndent");if(i&&s==e||n&&s>e)return o;o="forward"===t.direction?o.nextSibling:o.previousSibling}return null}function oy(e,t,i,n){e.ui.componentFactory.add(t,(s=>{const o=e.commands.get(t),r=new l.Z(s);return r.set({label:i,icon:n,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.on("execute",(()=>{e.execute(t),e.editing.view.focus()})),r}))}function ry(e){for(const t of e.getChildren())if("ul"==t.name||"ol"==t.name)return t;return null}function ay(){const e=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||e?0:Be.call(this)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ly(e){return(t,i,n)=>{const s=n.consumable;if(!s.test(i.item,"insert")||!s.test(i.item,"attribute:listType")||!s.test(i.item,"attribute:listIndent"))return;s.consume(i.item,"insert"),s.consume(i.item,"attribute:listType"),s.consume(i.item,"attribute:listIndent");const o=i.item,r=ey(o,n);ty(o,r,n,e)}}function cy(e){return(t,i,n)=>{const s=n.mapper.toViewPosition(i.position),o=s.getLastMatchingPosition((e=>!e.item.is("element","li"))),r=o.nodeAfter,a=n.writer;a.breakContainer(a.createPositionBefore(r)),a.breakContainer(a.createPositionAfter(r));const l=r.parent,c=l.previousSibling,d=a.createRangeOn(l),h=a.remove(d);c&&c.nextSibling&&iy(a,c,c.nextSibling);const u=n.mapper.toModelElement(r);xy(u.getAttribute("listIndent")+1,i.position,d.start,r,n,e);for(const e of a.createRangeIn(h).getItems())n.mapper.unbindViewElement(e);t.stop()}}function dy(e,t,i){if(!i.consumable.consume(t.item,"attribute:listType"))return;const n=i.mapper.toViewElement(t.item),s=i.writer;s.breakContainer(s.createPositionBefore(n)),s.breakContainer(s.createPositionAfter(n));const o=n.parent,r="numbered"==t.attributeNewValue?"ol":"ul";s.rename(r,o)}function hy(e,t,i){const n=i.mapper.toViewElement(t.item),s=n.parent,o=i.writer;iy(o,s,s.nextSibling),iy(o,s.previousSibling,s);for(const r of t.item.getChildren())i.consumable.consume(r,"insert")}function uy(e){return(t,i,n)=>{if(!n.consumable.consume(i.item,"attribute:listIndent"))return;const s=n.mapper.toViewElement(i.item),o=n.writer;o.breakContainer(o.createPositionBefore(s)),o.breakContainer(o.createPositionAfter(s));const r=s.parent,a=r.previousSibling,l=o.createRangeOn(r);o.remove(l),a&&a.nextSibling&&iy(o,a,a.nextSibling),xy(i.attributeOldValue+1,i.range.start,l.start,s,n,e),ty(i.item,s,n,e);for(const e of i.item.getChildren())n.consumable.consume(e,"insert")}}function my(e,t,i){if("listItem"!=t.item.name){let e=i.mapper.toViewPosition(t.range.start);const n=i.writer,s=[];while("ul"==e.parent.name||"ol"==e.parent.name){if(e=n.breakContainer(e),"li"!=e.parent.name)break;const t=e,i=n.createPositionAt(e.parent,"end");if(!t.isEqual(i)){const e=n.remove(n.createRange(t,i));s.push(e)}e=n.createPositionAfter(e.parent)}if(s.length>0){for(let t=0;t<s.length;t++){const i=e.nodeBefore,o=n.insert(e,s[t]);if(e=o.end,t>0){const t=iy(n,i,i.nextSibling);t&&t.parent==i&&e.offset--}}iy(n,e.nodeBefore,e.nodeAfter)}}}function gy(e,t,i){const n=i.mapper.toViewPosition(t.position),s=n.nodeBefore,o=n.nodeAfter;iy(i.writer,s,o)}function py(e,t,i){if(i.consumable.consume(t.viewItem,{name:!0})){const e=i.writer,n=e.createElement("listItem"),s=Ey(t.viewItem);e.setAttribute("listIndent",s,n);const o=t.viewItem.parent&&"ol"==t.viewItem.parent.name?"numbered":"bulleted";if(e.setAttribute("listType",o,n),!i.safeInsert(n,t.modelCursor))return;const r=Cy(n,t.viewItem.getChildren(),i);t.modelRange=e.createRange(t.modelCursor,r),i.updateConversionResult(n,t)}}function fy(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){const e=Array.from(t.viewItem.getChildren());for(const t of e){const e=!(t.is("element","li")||Ay(t));e&&t._remove()}}}function wy(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){if(0===t.viewItem.childCount)return;const e=[...t.viewItem.getChildren()];let i=!1;for(const t of e)i&&!Ay(t)&&t._remove(),Ay(t)&&(i=!0)}}function by(e){return(t,i)=>{if(i.isPhantom)return;const n=i.modelPosition.nodeBefore;if(n&&n.is("element","listItem")){const t=i.mapper.toViewElement(n),s=t.getAncestors().find(Ay),o=e.createPositionAt(t,0).getWalker();for(const e of o){if("elementStart"==e.type&&e.item.is("element","li")){i.viewPosition=e.previousPosition;break}if("elementEnd"==e.type&&e.item==s){i.viewPosition=e.nextPosition;break}}}}}function vy(e){return(t,i)=>{const n=i.viewPosition,s=n.parent,o=i.mapper;if("ul"==s.name||"ol"==s.name){if(n.isAtEnd){const t=o.toModelElement(n.nodeBefore),s=o.getModelLength(n.nodeBefore);i.modelPosition=e.createPositionBefore(t).getShiftedBy(s)}else{const t=o.toModelElement(n.nodeAfter);i.modelPosition=e.createPositionBefore(t)}t.stop()}else if("li"==s.name&&n.nodeBefore&&("ul"==n.nodeBefore.name||"ol"==n.nodeBefore.name)){const r=o.toModelElement(s);let a=1,l=n.nodeBefore;while(l&&Ay(l))a+=o.getModelLength(l),l=l.previousSibling;i.modelPosition=e.createPositionBefore(r).getShiftedBy(a),t.stop()}}}function _y(e,t){const i=e.document.differ.getChanges(),n=new Map;let s=!1;for(const l of i)if("insert"==l.type&&"listItem"==l.name)o(l.position);else if("insert"==l.type&&"listItem"!=l.name){if("$text"!=l.name){const i=l.position.nodeAfter;i.hasAttribute("listIndent")&&(t.removeAttribute("listIndent",i),s=!0),i.hasAttribute("listType")&&(t.removeAttribute("listType",i),s=!0),i.hasAttribute("listStyle")&&(t.removeAttribute("listStyle",i),s=!0);for(const t of Array.from(e.createRangeIn(i)).filter((e=>e.item.is("element","listItem"))))o(t.previousPosition)}const i=l.position.getShiftedBy(l.length);o(i)}else"remove"==l.type&&"listItem"==l.name?o(l.position):("attribute"==l.type&&"listIndent"==l.attributeKey||"attribute"==l.type&&"listType"==l.attributeKey)&&o(l.range.start);for(const l of n.values())r(l),a(l);return s;function o(e){const t=e.nodeBefore;if(t&&t.is("element","listItem")){let e=t;if(n.has(e))return;for(let t=e.previousSibling;t&&t.is("element","listItem");t=e.previousSibling)if(e=t,n.has(e))return;n.set(t,e)}else{const t=e.nodeAfter;t&&t.is("element","listItem")&&n.set(t,t)}}function r(e){let i=0,n=null;while(e&&e.is("element","listItem")){const o=e.getAttribute("listIndent");if(o>i){let r;null===n?(n=o-i,r=i):(n>o&&(n=o),r=o-n),t.setAttribute("listIndent",r,e),s=!0}else n=null,i=e.getAttribute("listIndent")+1;e=e.nextSibling}}function a(e){let i=[],n=null;while(e&&e.is("element","listItem")){const o=e.getAttribute("listIndent");if(n&&n.getAttribute("listIndent")>o&&(i=i.slice(0,o+1)),0!=o)if(i[o]){const n=i[o];e.getAttribute("listType")!=n&&(t.setAttribute("listType",n,e),s=!0)}else i[o]=e.getAttribute("listType");n=e,e=e.nextSibling}}}function yy(e,[t,i]){let n,s=t.is("documentFragment")?t.getChild(0):t;if(n=i?this.createSelection(i):this.document.selection,s&&s.is("element","listItem")){const e=n.getFirstPosition();let t=null;if(e.parent.is("element","listItem")?t=e.parent:e.nodeBefore&&e.nodeBefore.is("element","listItem")&&(t=e.nodeBefore),t){const e=t.getAttribute("listIndent");if(e>0)while(s&&s.is("element","listItem"))s._setAttribute("listIndent",s.getAttribute("listIndent")+e),s=s.nextSibling}}}function Cy(e,t,i){const{writer:n,schema:s}=i;let o=n.createPositionAfter(e);for(const r of t)if("ul"==r.name||"ol"==r.name)o=i.convertItem(r,o).modelCursor;else{const t=i.convertItem(r,n.createPositionAt(e,"end")),a=t.modelRange.start.nodeAfter,l=a&&a.is("element")&&!s.checkChild(e,a.name);l&&(e=t.modelCursor.parent.is("element","listItem")?t.modelCursor.parent:ky(t.modelCursor),o=n.createPositionAfter(e))}return o}function ky(e){const t=new An({startPosition:e});let i;do{i=t.next()}while(!i.value.item.is("element","listItem"));return i.value.item}function xy(e,t,i,n,s,o){const r=sy(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:e,foo:"b"}),a=s.mapper,l=s.writer,c=r?r.getAttribute("listIndent"):null;let d;if(r)if(c==e){const e=a.toViewElement(r).parent;d=l.createPositionAfter(e)}else{const e=o.createPositionAt(r,"end");d=a.toViewPosition(e)}else d=i;d=ny(d);for(const h of[...n.getChildren()])Ay(h)&&(d=l.move(l.createRangeOn(h),d).end,iy(l,h,h.nextSibling),iy(l,h.previousSibling,h))}function Ay(e){return e.is("element","ol")||e.is("element","ul")}function Ey(e){let t=0,i=e.parent;while(i){if(i.is("element","li"))t++;else{const e=i.previousSibling;e&&e.is("element","li")&&t++}i=i.parent}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ty extends a.Z{static get pluginName(){return"ListEditing"}static get requires(){return[lm,Cd]}init(){const e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const t=e.data,i=e.editing;e.model.document.registerPostFixer((t=>_y(e.model,t))),i.mapper.registerViewToModelLength("li",Py),t.mapper.registerViewToModelLength("li",Py),i.mapper.on("modelToViewPosition",by(i.view)),i.mapper.on("viewToModelPosition",vy(e.model)),t.mapper.on("modelToViewPosition",by(i.view)),e.conversion.for("editingDowncast").add((t=>{t.on("insert",my,{priority:"high"}),t.on("insert:listItem",ly(e.model)),t.on("attribute:listType:listItem",dy,{priority:"high"}),t.on("attribute:listType:listItem",hy,{priority:"low"}),t.on("attribute:listIndent:listItem",uy(e.model)),t.on("remove:listItem",cy(e.model)),t.on("remove",gy,{priority:"low"})})),e.conversion.for("dataDowncast").add((t=>{t.on("insert",my,{priority:"high"}),t.on("insert:listItem",ly(e.model))})),e.conversion.for("upcast").add((e=>{e.on("element:ul",fy,{priority:"high"}),e.on("element:ol",fy,{priority:"high"}),e.on("element:li",wy,{priority:"high"}),e.on("element:li",py)})),e.model.on("insertContent",yy,{priority:"high"}),e.commands.add("numberedList",new K_(e,"numbered")),e.commands.add("bulletedList",new K_(e,"bulleted")),e.commands.add("indentList",new Q_(e,"forward")),e.commands.add("outdentList",new Q_(e,"backward"));const n=i.view.document;this.listenTo(n,"enter",((e,t)=>{const i=this.editor.model.document,n=i.selection.getLastPosition().parent;i.selection.isCollapsed&&"listItem"==n.name&&n.isEmpty&&(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),{context:"li"}),this.listenTo(n,"delete",((e,t)=>{if("backward"!==t.direction)return;const i=this.editor.model.document.selection;if(!i.isCollapsed)return;const n=i.getFirstPosition();if(!n.isAtStart)return;const s=n.parent;if("listItem"!==s.name)return;const o=s.previousSibling&&"listItem"===s.previousSibling.name;o||(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),{context:"li"});const s=e=>(t,i)=>{const n=this.editor.commands.get(e);n.isEnabled&&(this.editor.execute(e),i())};e.keystrokes.set("Tab",s("indentList")),e.keystrokes.set("Shift+Tab",s("outdentList"))}afterInit(){const e=this.editor.commands,t=e.get("indent"),i=e.get("outdent");t&&t.registerChildCommand(e.get("indentList")),i&&i.registerChildCommand(e.get("outdentList"))}}function Py(e){let t=1;for(const i of e.getChildren())if("ul"==i.name||"ol"==i.name)for(const e of i.getChildren())t+=Py(e);return t}var Sy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Vy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Iy extends a.Z{static get pluginName(){return"ListUI"}init(){const e=this.editor.t;oy(this.editor,"numberedList",e("Numbered List"),Sy),oy(this.editor,"bulletedList",e("Bulleted List"),Vy)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ny extends a.Z{static get requires(){return[Ty,Iy]}static get pluginName(){return"List"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ry="todoListChecked";class Dy extends b.Z{constructor(e){super(e),this._selectedElements=[],this.on("execute",(()=>{this.refresh()}),{priority:"highest"})}refresh(){this._selectedElements=this._getSelectedItems(),this.value=this._selectedElements.every((e=>!!e.getAttribute("todoListChecked"))),this.isEnabled=!!this._selectedElements.length}_getSelectedItems(){const e=this.editor.model,t=e.schema,i=e.document.selection.getFirstRange(),n=i.start.parent,s=[];t.checkAttribute(n,Ry)&&s.push(n);for(const o of i.getItems())t.checkAttribute(o,Ry)&&!s.includes(o)&&s.push(o);return s}execute(e={}){this.editor.model.change((t=>{for(const i of this._selectedElements){const n=void 0===e.forceValue?!this.value:e.forceValue;n?t.setAttribute(Ry,!0,i):t.removeAttribute(Ry,i)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function By(e,t){return(i,n,s)=>{const o=s.consumable;if(!o.test(n.item,"insert")||!o.test(n.item,"attribute:listType")||!o.test(n.item,"attribute:listIndent"))return;if("todo"!=n.item.getAttribute("listType"))return;const r=n.item;o.consume(r,"insert"),o.consume(r,"attribute:listType"),o.consume(r,"attribute:listIndent"),o.consume(r,"attribute:todoListChecked");const a=s.writer,l=ey(r,s),c=!!r.getAttribute("todoListChecked"),d=$y(r,a,c,t),h=a.createContainerElement("span",{class:"todo-list__label__description"});a.addClass("todo-list",l.parent),a.insert(a.createPositionAt(l,0),d),a.insert(a.createPositionAfter(d),h),ty(r,l,s,e)}}function My(e){return(t,i,n)=>{const s=n.consumable;if(!s.test(i.item,"insert")||!s.test(i.item,"attribute:listType")||!s.test(i.item,"attribute:listIndent"))return;if("todo"!=i.item.getAttribute("listType"))return;const o=i.item;s.consume(o,"insert"),s.consume(o,"attribute:listType"),s.consume(o,"attribute:listIndent"),s.consume(o,"attribute:todoListChecked");const r=n.writer,a=ey(o,n);r.addClass("todo-list",a.parent);const l=r.createContainerElement("label",{class:"todo-list__label"}),c=r.createEmptyElement("input",{type:"checkbox",disabled:"disabled"}),d=r.createContainerElement("span",{class:"todo-list__label__description"});o.getAttribute("todoListChecked")&&r.setAttribute("checked","checked",c),r.insert(r.createPositionAt(a,0),l),r.insert(r.createPositionAt(l,0),c),r.insert(r.createPositionAfter(c),d),ty(o,a,n,e)}}function Oy(e,t,i){const n=t.modelCursor,s=n.parent,o=t.viewItem;if("checkbox"!=o.getAttribute("type")||"listItem"!=s.name||!n.isAtStart)return;if(!i.consumable.consume(o,{name:!0}))return;const r=i.writer;r.setAttribute("listType","todo",s),t.viewItem.hasAttribute("checked")&&r.setAttribute("todoListChecked",!0,s),t.modelRange=r.createRange(n)}function Ly(e,t){return(i,n,s)=>{const o=s.mapper.toViewElement(n.item),r=s.writer,a=Zy(o,t);if("todo"==n.attributeNewValue){const t=!!n.item.getAttribute("todoListChecked"),i=$y(n.item,r,t,e),s=r.createContainerElement("span",{class:"todo-list__label__description"}),a=r.createRangeIn(o),l=ry(o),c=ny(a.start),d=l?r.createPositionBefore(l):a.end,h=r.createRange(c,d);r.addClass("todo-list",o.parent),r.move(h,r.createPositionAt(s,0)),r.insert(r.createPositionAt(o,0),i),r.insert(r.createPositionAfter(i),s)}else if("todo"==n.attributeOldValue){const e=Hy(o,t);r.removeClass("todo-list",o.parent),r.remove(a),r.move(r.createRangeIn(e),r.createPositionBefore(e)),r.remove(e)}}}function Fy(e){return(t,i,n)=>{if("todo"!=i.item.getAttribute("listType"))return;if(!n.consumable.consume(i.item,"attribute:todoListChecked"))return;const{mapper:s,writer:o}=n,r=!!i.item.getAttribute("todoListChecked"),a=s.toViewElement(i.item),l=a.getChild(0),c=$y(i.item,o,r,e);o.insert(o.createPositionAfter(l),c),o.remove(l)}}function zy(e){return(t,i)=>{const n=i.modelPosition,s=n.parent;if(!s.is("element","listItem")||"todo"!=s.getAttribute("listType"))return;const o=i.mapper.toViewElement(s),r=Hy(o,e);r&&(i.viewPosition=i.mapper.findPositionIn(r,n.offset))}}function $y(e,t,i,n){const s=t.createUIElement("label",{class:"todo-list__label",contenteditable:!1},(function(t){const s=$i(document,"input",{type:"checkbox"});i&&s.setAttribute("checked","checked"),s.addEventListener("change",(()=>n(e)));const o=this.toDomElement(t);return o.appendChild(s),o}));return s}function Zy(e,t){const i=t.createRangeIn(e);for(const n of i)if(n.item.is("uiElement","label"))return n.item}function Hy(e,t){const i=t.createRangeIn(e);for(const n of i)if(n.item.is("containerElement","span")&&n.item.hasClass("todo-list__label__description"))return n.item}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Uy=(0,ct.Zz)("Ctrl+Enter");class Wy extends a.Z{static get pluginName(){return"TodoListEditing"}static get requires(){return[Ty]}init(){const e=this.editor,{editing:t,data:i,model:n}=e;n.schema.extend("listItem",{allowAttributes:["todoListChecked"]}),n.schema.addAttributeCheck(((e,t)=>{const i=e.last;if("todoListChecked"==t&&"listItem"==i.name&&"todo"!=i.getAttribute("listType"))return!1})),e.commands.add("todoList",new K_(e,"todo"));const s=new Dy(e);e.commands.add("checkTodoList",s),e.commands.add("todoListCheck",s),i.downcastDispatcher.on("insert:listItem",My(n),{priority:"high"}),i.upcastDispatcher.on("element:input",Oy,{priority:"high"}),t.downcastDispatcher.on("insert:listItem",By(n,(e=>this._handleCheckmarkChange(e))),{priority:"high"}),t.downcastDispatcher.on("attribute:listType:listItem",Ly((e=>this._handleCheckmarkChange(e)),t.view)),t.downcastDispatcher.on("attribute:todoListChecked:listItem",Fy((e=>this._handleCheckmarkChange(e)))),t.mapper.on("modelToViewPosition",zy(t.view)),i.mapper.on("modelToViewPosition",zy(t.view)),this.listenTo(t.view.document,"arrowKey",qy(n,e.locale),{context:"li"}),this.listenTo(t.view.document,"keydown",((t,i)=>{(0,ct.Cq)(i)===Uy&&(e.execute("checkTodoList"),t.stop())}),{priority:"high"});const o=new Set;this.listenTo(n,"applyOperation",((e,t)=>{const i=t[0];if("rename"==i.type&&"listItem"==i.oldName){const e=i.position.nodeAfter;e.hasAttribute("todoListChecked")&&o.add(e)}else if("changeAttribute"==i.type&&"listType"==i.key&&"todo"===i.oldValue)for(const n of i.range.getItems())n.hasAttribute("todoListChecked")&&"todo"!==n.getAttribute("listType")&&o.add(n)})),n.document.registerPostFixer((e=>{let t=!1;for(const i of o)e.removeAttribute("todoListChecked",i),t=!0;return o.clear(),t}))}_handleCheckmarkChange(e){const t=this.editor,i=t.model,n=Array.from(i.document.selection.getRanges());i.change((i=>{i.setSelection(e,"end"),t.execute("checkTodoList"),i.setSelection(n)}))}}function qy(e,t){return(i,n)=>{const s=(0,ct.mA)(n.keyCode,t.contentLanguageDirection);if("left"!=s)return;const o=e.schema,r=e.document.selection;if(!r.isCollapsed)return;const a=r.getFirstPosition(),l=a.parent;if("listItem"===l.name&&"todo"==l.getAttribute("listType")&&a.isAtStart){const t=o.getNearestSelectionRange(e.createPositionBefore(l),"backward");t&&e.change((e=>e.setSelection(t))),n.preventDefault(),n.stopPropagation(),i.stop()}}}var Gy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jy extends a.Z{static get pluginName(){return"TodoListUI"}init(){const e=this.editor.t;oy(this.editor,"todoList",e("To-do List"),Gy)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ky extends a.Z{static get requires(){return[Wy,jy]}static get pluginName(){return"TodoList"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Jy(e,t){return e=>{e.on("attribute:url:media",i)};function i(i,n,s){if(!s.consumable.consume(n.item,i.name))return;const o=n.attributeNewValue,r=s.writer,a=s.mapper.toViewElement(n.item),l=[...a.getChildren()].find((e=>e.getCustomProperty("media-content")));r.remove(l);const c=e.getMediaViewElement(r,o,t);r.insert(r.createPositionAt(a,0),c)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Yy(e,t,i){return t.setCustomProperty("media",!0,e),fg(e,t,{label:i})}function Qy(e,t,i,n){const s=e.createContainerElement("figure",{class:"media"});return e.insert(e.createPositionAt(s,0),t.getMediaViewElement(e,i,n)),s}function Xy(e){const t=e.getSelectedElement();return t&&t.is("element","media")?t:null}function eC(e,t,i){e.change((n=>{const s=n.createElement("media",{url:t});e.insertContent(s,i),n.setSelection(s,"on")}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tC extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=Xy(t);this.value=i?i.getAttribute("url"):null,this.isEnabled=nC(t)||iC(t,e)}execute(e){const t=this.editor.model,i=t.document.selection,n=Xy(i);n?t.change((t=>{t.setAttribute("url",e,n)})):eC(t,e,kg(i,t))}}function iC(e,t){const i=kg(e,t);let n=i.start.parent;return n.isEmpty&&!t.schema.isLimit(n)&&(n=n.parent),t.schema.checkChild(n,"media")}function nC(e){const t=e.getSelectedElement();return!!t&&"media"===t.name}var sC='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const oC="0 0 64 42";class rC{constructor(e,t){const i=t.providers,n=t.extraProviders||[],s=new Set(t.removeProviders),o=i.concat(n).filter((e=>{const t=e.name;return t?!s.has(t):((0,S.KE)("media-embed-no-provider-name",{provider:e}),!1)}));this.locale=e,this.providerDefinitions=o}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,i){return this._getMedia(t).getViewElement(e,i)}_getMedia(e){if(!e)return new aC(this.locale);e=e.trim();for(const t of this.providerDefinitions){const i=t.html,n=(0,R.Z)(t.url);for(const t of n){const n=this._getUrlMatches(e,t);if(n)return new aC(this.locale,e,n,i)}}return null}_getUrlMatches(e,t){let i=e.match(t);if(i)return i;let n=e.replace(/^https?:\/\//,"");return i=n.match(t),i||(n=n.replace(/^www\./,""),i=n.match(t),i||null)}}class aC{constructor(e,t,i,n){this.url=this._getValidUrl(t),this._t=e.t,this._match=i,this._previewRenderer=n}getViewElement(e,t){const i={};let n;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(i["data-oembed-url"]=this.url),t.renderForEditingView&&(i.class="ck-media__wrapper");const s=this._getPreviewHtml(t);n=e.createRawElement("div",i,((e,t)=>{t.setContentOf(e,s)}))}else this.url&&(i.url=this.url),n=e.createEmptyElement(t.elementName,i);return e.setCustomProperty("media-content",!0,n),n}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new Xc.Z,t=new Jl.Z;e.text=this._t("Open media in new tab"),t.content=sC,t.viewBox=oC;const i=new Ol.ZP({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[t]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},e]}]}).render();return i.outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lC extends a.Z{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`}},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`}},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`}},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new rC(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,i=e.t,n=e.conversion,s=e.config.get("mediaEmbed.previewsInData"),o=e.config.get("mediaEmbed.elementName"),r=this.registry;e.commands.add("mediaEmbed",new tC(e)),t.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),n.for("dataDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const i=e.getAttribute("url");return Qy(t,r,i,{elementName:o,renderMediaPreview:i&&s})}}),n.for("dataDowncast").add(Jy(r,{elementName:o,renderMediaPreview:s})),n.for("editingDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const n=e.getAttribute("url"),s=Qy(t,r,n,{elementName:o,renderForEditingView:!0});return Yy(s,t,i("media widget"))}}),n.for("editingDowncast").add(Jy(r,{elementName:o,renderForEditingView:!0})),n.for("upcast").elementToElement({view:e=>["oembed",o].includes(e.name)&&e.getAttribute("url")?{name:!0}:null,model:(e,{writer:t})=>{const i=e.getAttribute("url");if(r.hasMedia(i))return t.createElement("media",{url:i})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(e,{writer:t})=>{const i=e.getAttribute("data-oembed-url");if(r.hasMedia(i))return t.createElement("media",{url:i})}}).add((e=>{function t(e,t,i){if(!i.consumable.consume(t.viewItem,{name:!0,classes:"media"}))return;const{modelRange:n,modelCursor:s}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=n,t.modelCursor=s;const o=(0,Xi.Z)(n.getItems());o||i.consumable.revert(t.viewItem,{name:!0,classes:"media"})}e.on("element:figure",t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const cC=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class dC extends a.Z{static get requires(){return[cp,Cd,Ep]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document;this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",(()=>{const e=t.selection.getFirstRange(),i=Ir.fromPosition(e.start);i.stickiness="toPrevious";const n=Ir.fromPosition(e.end);n.stickiness="toNext",t.once("change:data",(()=>{this._embedMediaBetweenPositions(i,n),i.detach(),n.detach()}),{priority:"high"})})),e.commands.get("undo").on("execute",(()=>{this._timeoutId&&(ri.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)}),{priority:"high"})}_embedMediaBetweenPositions(e,t){const i=this.editor,n=i.plugins.get(lC).registry,s=new qn(e,t),o=s.getWalker({ignoreElementEnd:!0});let r="";for(const l of o)l.item.is("$textProxy")&&(r+=l.item.data);if(r=r.trim(),!r.match(cC))return void s.detach();if(!n.hasMedia(r))return void s.detach();const a=i.commands.get("mediaEmbed");a.isEnabled?(this._positionToInsert=Ir.fromPosition(e),this._timeoutId=ri.window.setTimeout((()=>{i.model.change((e=>{let t;this._timeoutId=null,e.remove(s),s.detach(),"$graveyard"!==this._positionToInsert.root.rootName&&(t=this._positionToInsert),eC(i.model,r,t),this._positionToInsert.detach(),this._positionToInsert=null})),i.plugins.get("Delete").requestUndoOnBackspace()}),100)):s.detach()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hC extends cl.Z{constructor(e,t){super(t);const i=t.t;this.focusTracker=new en,this.keystrokes=new tn,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),ol.check,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",(e=>!!e)),this.cancelButtonView=this._createButton(i("Cancel"),ol.cancel,"ck-button-cancel","cancel"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]}),Bl(this)}render(){super.render(),Ml({view:this});const e=[this.urlInputView,this.saveButtonView,this.cancelButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element);const t=e=>e.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t),this.listenTo(this.urlInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new Dc(this.locale,Bc),i=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,i.on("input",(()=>{t.infoText=i.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=i.element.value.trim()})),t}_createButton(e,t,i,n){const s=new l.Z(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.extendTemplate({attributes:{class:i}}),n&&s.delegate("execute").to(this,n),s}}var uC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mC extends a.Z{static get requires(){return[lC]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,t=e.commands.get("mediaEmbed"),i=e.plugins.get(lC).registry;e.ui.componentFactory.add("mediaEmbed",(n=>{const s=vc(n),o=new hC(gC(e.t,i),e.locale);return this._setUpDropdown(s,o,t,e),this._setUpForm(s,o,t),s}))}_setUpDropdown(e,t,i){const n=this.editor,s=n.t,o=e.buttonView;function r(){n.editing.view.focus(),e.isOpen=!1}e.bind("isEnabled").to(i),e.panelView.children.add(t),o.set({label:s("Insert media"),icon:uC,tooltip:!0}),o.on("open",(()=>{t.disableCssTransitions(),t.url=i.value||"",t.urlInputView.fieldView.select(),t.focus(),t.enableCssTransitions()}),{priority:"low"}),e.on("submit",(()=>{t.isValid()&&(n.execute("mediaEmbed",t.url),r())})),e.on("change:isOpen",(()=>t.resetFormStatus())),e.on("cancel",(()=>r()))}_setUpForm(e,t,i){t.delegate("submit","cancel").to(e),t.urlInputView.bind("value").to(i,"value"),t.urlInputView.bind("isReadOnly").to(i,"isEnabled",(e=>!e))}}function gC(e,t){return[t=>{if(!t.url.length)return e("The URL must not be empty.")},i=>{if(!t.hasMedia(i.url))return e("This media URL is not supported.")}]}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pC extends a.Z{static get requires(){return[lC,mC,dC,Gg]}static get pluginName(){return"MediaEmbed"}}var fC=i(76920),wC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const bC="removeFormat";class vC extends a.Z{static get pluginName(){return"RemoveFormatUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(bC,(i=>{const n=e.commands.get(bC),s=new l.Z(i);return s.set({label:t("Remove Format"),icon:wC,tooltip:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(s,"execute",(()=>{e.execute(bC),e.editing.view.focus()})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _C extends b.Z{refresh(){const e=this.editor.model;this.isEnabled=!!(0,Xi.Z)(this._getFormattingItems(e.document.selection,e.schema))}execute(){const e=this.editor.model,t=e.schema;e.change((i=>{for(const n of this._getFormattingItems(e.document.selection,t))if(n.is("selection"))for(const e of this._getFormattingAttributes(n,t))i.removeSelectionAttribute(e);else{const e=i.createRangeOn(n);for(const s of this._getFormattingAttributes(n,t))i.removeAttribute(s,e)}}))}*_getFormattingItems(e,t){const i=e=>!!(0,Xi.Z)(this._getFormattingAttributes(e,t));for(const n of e.getRanges())for(const e of n.getItems())!t.isBlock(e)&&i(e)&&(yield e);for(const n of e.getSelectedBlocks())i(n)&&(yield n);i(e)&&(yield e)}*_getFormattingAttributes(e,t){for(const[i]of e.getAttributes()){const e=t.getAttributeProperties(i);e&&e.isFormatting&&(yield i)}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yC extends a.Z{static get pluginName(){return"RemoveFormatEditing"}init(){const e=this.editor;e.commands.add("removeFormat",new _C(e))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class CC extends a.Z{static get requires(){return[yC,vC]}static get pluginName(){return"RemoveFormat"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function kC(e){const t=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"br",isVoid:!0},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"input",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"pre",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"textarea",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],i=t.map((e=>e.name)).join("|"),n=e.replace(new RegExp(`</?(${i})( .*?)?>`,"g"),"\n$&\n").split("\n");let s=0;return n.filter((e=>e.length)).map((e=>xC(e,t)?EC(e,s++):AC(e,t)?EC(e,--s):EC(e,s))).join("\n")}function xC(e,t){return t.some((t=>!t.isVoid&&!!new RegExp(`<${t.name}( .*?)?>`).test(e)))}function AC(e,t){return t.some((t=>new RegExp(`</${t.name}>`).test(e)))}function EC(e,t,i="    "){return`${i.repeat(t)}${e}`}var TC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const PC="SourceEditingMode";class SC extends a.Z{static get pluginName(){return"SourceEditing"}static get requires(){return[Sa]}constructor(e){super(e),this.set("isSourceEditingMode",!1),this._elementReplacer=new Bi,this._replacedRoots=new Map,this._dataFromRoots=new Map}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("sourceEditing",(i=>{const n=new l.Z(i);return n.set({label:t("Source"),icon:TC,tooltip:!0,withText:!0,class:"ck-source-editing-button"}),n.bind("isOn").to(this,"isSourceEditingMode"),n.bind("isEnabled").to(this,"isEnabled",e,"isReadOnly",e.plugins.get(Sa),"hasAny",((e,t,i)=>!!e&&(!t&&!i))),this.listenTo(n,"execute",(()=>{this.isSourceEditingMode=!this.isSourceEditingMode})),n})),this._isAllowedToHandleSourceEditingMode()&&(this.on("change:isSourceEditingMode",((e,t,i)=>{i?(this._showSourceEditing(),this._disableCommands()):(this._hideSourceEditing(),this._enableCommands())})),this.on("change:isEnabled",((e,t,i)=>this._handleReadOnlyMode(!i))),this.listenTo(e,"change:isReadOnly",((e,t,i)=>this._handleReadOnlyMode(i)))),e.data.on("get",(()=>{this.isSourceEditingMode&&this._updateEditorData()}),{priority:"high"})}afterInit(){const e=this.editor,t=["RealTimeCollaborativeEditing","CommentsEditing","TrackChangesEditing","RevisionHistory"];t.some((t=>e.plugins.has(t)))&&console.warn("You initialized the editor with the source editing feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing feature and restricted editing feature. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.")}_showSourceEditing(){const e=this.editor,t=e.editing.view,i=e.model;i.change((e=>{e.setSelection(null),e.removeSelectionAttribute(i.document.selection.getAttributeKeys())}));for(const[n,s]of t.domRoots){const i=VC(e.data.get({rootName:n})),o=$i(s.ownerDocument,"textarea",{rows:"1"}),r=$i(s.ownerDocument,"div",{class:"ck-source-editing-area","data-value":i},[o]);o.value=i,o.setSelectionRange(0,0),o.addEventListener("input",(()=>{r.dataset.value=o.value})),t.change((e=>{const i=t.document.getRoot(n);e.addClass("ck-hidden",i)})),this._replacedRoots.set(n,r),this._elementReplacer.replace(s,r),this._dataFromRoots.set(n,i)}this._focusSourceEditing()}_hideSourceEditing(){const e=this.editor,t=e.editing.view;this._updateEditorData(),t.change((e=>{for(const[i]of this._replacedRoots)e.removeClass("ck-hidden",t.document.getRoot(i))})),this._elementReplacer.restore(),this._replacedRoots.clear(),this._dataFromRoots.clear(),t.focus()}_updateEditorData(){const e=this.editor,t={};for(const[i,n]of this._replacedRoots){const e=this._dataFromRoots.get(i),s=n.dataset.value;e!==s&&(t[i]=s)}Object.keys(t).length&&e.data.set(t,{batchType:"default"})}_focusSourceEditing(){const[e]=this._replacedRoots.values(),t=e.querySelector("textarea");t.focus()}_disableCommands(){const e=this.editor;for(const t of e.commands.commands())t.forceDisabled(PC)}_enableCommands(){const e=this.editor;for(const t of e.commands.commands())t.clearForceDisabled(PC)}_handleReadOnlyMode(e){if(this.isSourceEditingMode)for(const[,t]of this._replacedRoots)t.querySelector("textarea").readOnly=e}_isAllowedToHandleSourceEditingMode(){const e=this.editor,t=e.ui.view.editable;return t&&!t._hasExternalElement}}function VC(e){return IC(e)?kC(e):e}function IC(e){return e.startsWith("<")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class NC extends Ic{constructor(e,t){super(e);const i=e.t;this.set("class","ck-special-characters-navigation"),this.groupDropdownView=this._createGroupDropdown(t),this.groupDropdownView.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",this.label=i("Special characters"),this.children.add(this.groupDropdownView)}get currentGroupName(){return this.groupDropdownView.value}_createGroupDropdown(e){const t=this.locale,i=t.t,n=vc(t),s=this._getCharacterGroupListItemDefinitions(n,e);return n.set("value",s.first.model.label),n.buttonView.bind("label").to(n,"value"),n.buttonView.set({isOn:!1,withText:!0,tooltip:i("Character categories"),class:["ck-dropdown__button_label-width_auto"]}),n.on("execute",(e=>{n.value=e.source.label})),n.delegate("execute").to(this),yc(n,s),n}_getCharacterGroupListItemDefinitions(e,t){const i=new P.Z;for(const n of t){const t={type:"button",model:new Lc({label:n,withText:!0})};t.model.bind("isOn").to(e,"value",(e=>e===t.model.label)),i.add(t)}return i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class RC extends cl.Z{constructor(e){super(e),this.tiles=this.createCollection(),this.setTemplate({tag:"div",children:[{tag:"div",attributes:{class:["ck","ck-character-grid__tiles"]},children:this.tiles}],attributes:{class:["ck","ck-character-grid"]}})}createTile(e,t){const i=new l.Z(this.locale);return i.set({label:e,withText:!0,class:"ck-character-grid__tile"}),i.extendTemplate({attributes:{title:t},on:{mouseover:i.bindTemplate.to("mouseover")}}),i.on("mouseover",(()=>{this.fire("tileHover",{name:t,character:e})})),i.on("execute",(()=>{this.fire("execute",{name:t,character:e})})),i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class DC extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("character",null),this.set("name",null),this.bind("code").to(this,"character",BC),this.setTemplate({tag:"div",children:[{tag:"span",attributes:{class:["ck-character-info__name"]},children:[{text:t.to("name",(e=>e||"​"))}]},{tag:"span",attributes:{class:["ck-character-info__code"]},children:[{text:t.to("code")}]}],attributes:{class:["ck","ck-character-info"]}})}}function BC(e){if(null===e)return"";const t=e.codePointAt(0).toString(16);return"U+"+("0000"+t).slice(-4)}var MC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2.5a7.47 7.47 0 0 1 4.231 1.31 7.268 7.268 0 0 1 2.703 3.454 7.128 7.128 0 0 1 .199 4.353c-.39 1.436-1.475 2.72-2.633 3.677h2.013c0-.226.092-.443.254-.603a.876.876 0 0 1 1.229 0c.163.16.254.377.254.603v.853c0 .209-.078.41-.22.567a.873.873 0 0 1-.547.28l-.101.006h-4.695a.517.517 0 0 1-.516-.518v-1.265c0-.21.128-.398.317-.489a5.601 5.601 0 0 0 2.492-2.371 5.459 5.459 0 0 0 .552-3.693 5.53 5.53 0 0 0-1.955-3.2A5.71 5.71 0 0 0 10 4.206 5.708 5.708 0 0 0 6.419 5.46 5.527 5.527 0 0 0 4.46 8.663a5.457 5.457 0 0 0 .554 3.695 5.6 5.6 0 0 0 2.497 2.37.55.55 0 0 1 .317.49v1.264c0 .286-.23.518-.516.518H2.618a.877.877 0 0 1-.614-.25.845.845 0 0 1-.254-.603v-.853c0-.226.091-.443.254-.603a.876.876 0 0 1 1.228 0c.163.16.255.377.255.603h1.925c-1.158-.958-2.155-2.241-2.545-3.678a7.128 7.128 0 0 1 .199-4.352 7.268 7.268 0 0 1 2.703-3.455A7.475 7.475 0 0 1 10 2.5z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const OC="All";class LC extends a.Z{static get requires(){return[kd]}static get pluginName(){return"SpecialCharacters"}constructor(e){super(e),this._characters=new Map,this._groups=new Map}init(){const e=this.editor,t=e.t,i=e.commands.get("input");e.ui.componentFactory.add("specialCharacters",(n=>{const s=vc(n);let o;return s.buttonView.set({label:t("Special characters"),icon:MC,tooltip:!0}),s.bind("isEnabled").to(i),s.on("execute",((t,i)=>{e.execute("input",{text:i.character}),e.editing.view.focus()})),s.on("change:isOpen",(()=>{o||(o=this._createDropdownPanelContent(n,s),s.panelView.children.add(o.navigationView),s.panelView.children.add(o.gridView),s.panelView.children.add(o.infoView)),o.infoView.set({character:null,name:null})})),s}))}addItems(e,t){if(e===OC)throw new S.ZP(`special-character-invalid-group-name: The name "${OC}" is reserved and cannot be used.`);const i=this._getGroup(e);for(const n of t)i.add(n.title),this._characters.set(n.title,n.character)}getGroups(){return this._groups.keys()}getCharactersForGroup(e){return e===OC?new Set(this._characters.keys()):this._groups.get(e)}getCharacter(e){return this._characters.get(e)}_getGroup(e){return this._groups.has(e)||this._groups.set(e,new Set),this._groups.get(e)}_updateGrid(e,t){t.tiles.clear();const i=this.getCharactersForGroup(e);for(const n of i){const e=this.getCharacter(n);t.tiles.add(t.createTile(e,n))}}_createDropdownPanelContent(e,t){const i=[...this.getGroups()];i.unshift(OC);const n=new NC(e,i),s=new RC(e),o=new DC(e);return s.delegate("execute").to(t),s.on("tileHover",((e,t)=>{o.set(t)})),n.on("execute",(()=>{this._updateGrid(n.currentGroupName,s)})),this._updateGrid(n.currentGroupName,s),{navigationView:n,gridView:s,infoView:o}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class FC extends a.Z{static get pluginName(){return"SpecialCharactersCurrency"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Currency",[{character:"$",title:t("Dollar sign")},{character:"€",title:t("Euro sign")},{character:"¥",title:t("Yen sign")},{character:"£",title:t("Pound sign")},{character:"¢",title:t("Cent sign")},{character:"₠",title:t("Euro-currency sign")},{character:"₡",title:t("Colon sign")},{character:"₢",title:t("Cruzeiro sign")},{character:"₣",title:t("French franc sign")},{character:"₤",title:t("Lira sign")},{character:"¤",title:t("Currency sign")},{character:"₿",title:t("Bitcoin sign")},{character:"₥",title:t("Mill sign")},{character:"₦",title:t("Naira sign")},{character:"₧",title:t("Peseta sign")},{character:"₨",title:t("Rupee sign")},{character:"₩",title:t("Won sign")},{character:"₪",title:t("New sheqel sign")},{character:"₫",title:t("Dong sign")},{character:"₭",title:t("Kip sign")},{character:"₮",title:t("Tugrik sign")},{character:"₯",title:t("Drachma sign")},{character:"₰",title:t("German penny sign")},{character:"₱",title:t("Peso sign")},{character:"₲",title:t("Guarani sign")},{character:"₳",title:t("Austral sign")},{character:"₴",title:t("Hryvnia sign")},{character:"₵",title:t("Cedi sign")},{character:"₶",title:t("Livre tournois sign")},{character:"₷",title:t("Spesmilo sign")},{character:"₸",title:t("Tenge sign")},{character:"₹",title:t("Indian rupee sign")},{character:"₺",title:t("Turkish lira sign")},{character:"₻",title:t("Nordic mark sign")},{character:"₼",title:t("Manat sign")},{character:"₽",title:t("Ruble sign")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zC extends a.Z{static get pluginName(){return"SpecialCharactersMathematical"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Mathematical",[{character:"<",title:t("Less-than sign")},{character:">",title:t("Greater-than sign")},{character:"≤",title:t("Less-than or equal to")},{character:"≥",title:t("Greater-than or equal to")},{character:"–",title:t("En dash")},{character:"—",title:t("Em dash")},{character:"¯",title:t("Macron")},{character:"‾",title:t("Overline")},{character:"°",title:t("Degree sign")},{character:"−",title:t("Minus sign")},{character:"±",title:t("Plus-minus sign")},{character:"÷",title:t("Division sign")},{character:"⁄",title:t("Fraction slash")},{character:"×",title:t("Multiplication sign")},{character:"ƒ",title:t("Latin small letter f with hook")},{character:"∫",title:t("Integral")},{character:"∑",title:t("N-ary summation")},{character:"∞",title:t("Infinity")},{character:"√",title:t("Square root")},{character:"∼",title:t("Tilde operator")},{character:"≅",title:t("Approximately equal to")},{character:"≈",title:t("Almost equal to")},{character:"≠",title:t("Not equal to")},{character:"≡",title:t("Identical to")},{character:"∈",title:t("Element of")},{character:"∉",title:t("Not an element of")},{character:"∋",title:t("Contains as member")},{character:"∏",title:t("N-ary product")},{character:"∧",title:t("Logical and")},{character:"∨",title:t("Logical or")},{character:"¬",title:t("Not sign")},{character:"∩",title:t("Intersection")},{character:"∪",title:t("Union")},{character:"∂",title:t("Partial differential")},{character:"∀",title:t("For all")},{character:"∃",title:t("There exists")},{character:"∅",title:t("Empty set")},{character:"∇",title:t("Nabla")},{character:"∗",title:t("Asterisk operator")},{character:"∝",title:t("Proportional to")},{character:"∠",title:t("Angle")},{character:"¼",title:t("Vulgar fraction one quarter")},{character:"½",title:t("Vulgar fraction one half")},{character:"¾",title:t("Vulgar fraction three quarters")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $C extends a.Z{static get pluginName(){return"SpecialCharactersArrows"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Arrows",[{title:t("leftwards double arrow"),character:"⇐"},{title:t("rightwards double arrow"),character:"⇒"},{title:t("upwards double arrow"),character:"⇑"},{title:t("downwards double arrow"),character:"⇓"},{title:t("leftwards dashed arrow"),character:"⇠"},{title:t("rightwards dashed arrow"),character:"⇢"},{title:t("upwards dashed arrow"),character:"⇡"},{title:t("downwards dashed arrow"),character:"⇣"},{title:t("leftwards arrow to bar"),character:"⇤"},{title:t("rightwards arrow to bar"),character:"⇥"},{title:t("upwards arrow to bar"),character:"⤒"},{title:t("downwards arrow to bar"),character:"⤓"},{title:t("up down arrow with base"),character:"↨"},{title:t("back with leftwards arrow above"),character:"🔙"},{title:t("end with leftwards arrow above"),character:"🔚"},{title:t("on with exclamation mark with left right arrow above"),character:"🔛"},{title:t("soon with rightwards arrow above"),character:"🔜"},{title:t("top with upwards arrow above"),character:"🔝"}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ZC extends a.Z{static get pluginName(){return"SpecialCharactersLatin"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Latin",[{character:"Ā",title:t("Latin capital letter a with macron")},{character:"ā",title:t("Latin small letter a with macron")},{character:"Ă",title:t("Latin capital letter a with breve")},{character:"ă",title:t("Latin small letter a with breve")},{character:"Ą",title:t("Latin capital letter a with ogonek")},{character:"ą",title:t("Latin small letter a with ogonek")},{character:"Ć",title:t("Latin capital letter c with acute")},{character:"ć",title:t("Latin small letter c with acute")},{character:"Ĉ",title:t("Latin capital letter c with circumflex")},{character:"ĉ",title:t("Latin small letter c with circumflex")},{character:"Ċ",title:t("Latin capital letter c with dot above")},{character:"ċ",title:t("Latin small letter c with dot above")},{character:"Č",title:t("Latin capital letter c with caron")},{character:"č",title:t("Latin small letter c with caron")},{character:"Ď",title:t("Latin capital letter d with caron")},{character:"ď",title:t("Latin small letter d with caron")},{character:"Đ",title:t("Latin capital letter d with stroke")},{character:"đ",title:t("Latin small letter d with stroke")},{character:"Ē",title:t("Latin capital letter e with macron")},{character:"ē",title:t("Latin small letter e with macron")},{character:"Ĕ",title:t("Latin capital letter e with breve")},{character:"ĕ",title:t("Latin small letter e with breve")},{character:"Ė",title:t("Latin capital letter e with dot above")},{character:"ė",title:t("Latin small letter e with dot above")},{character:"Ę",title:t("Latin capital letter e with ogonek")},{character:"ę",title:t("Latin small letter e with ogonek")},{character:"Ě",title:t("Latin capital letter e with caron")},{character:"ě",title:t("Latin small letter e with caron")},{character:"Ĝ",title:t("Latin capital letter g with circumflex")},{character:"ĝ",title:t("Latin small letter g with circumflex")},{character:"Ğ",title:t("Latin capital letter g with breve")},{character:"ğ",title:t("Latin small letter g with breve")},{character:"Ġ",title:t("Latin capital letter g with dot above")},{character:"ġ",title:t("Latin small letter g with dot above")},{character:"Ģ",title:t("Latin capital letter g with cedilla")},{character:"ģ",title:t("Latin small letter g with cedilla")},{character:"Ĥ",title:t("Latin capital letter h with circumflex")},{character:"ĥ",title:t("Latin small letter h with circumflex")},{character:"Ħ",title:t("Latin capital letter h with stroke")},{character:"ħ",title:t("Latin small letter h with stroke")},{character:"Ĩ",title:t("Latin capital letter i with tilde")},{character:"ĩ",title:t("Latin small letter i with tilde")},{character:"Ī",title:t("Latin capital letter i with macron")},{character:"ī",title:t("Latin small letter i with macron")},{character:"Ĭ",title:t("Latin capital letter i with breve")},{character:"ĭ",title:t("Latin small letter i with breve")},{character:"Į",title:t("Latin capital letter i with ogonek")},{character:"į",title:t("Latin small letter i with ogonek")},{character:"İ",title:t("Latin capital letter i with dot above")},{character:"ı",title:t("Latin small letter dotless i")},{character:"Ĳ",title:t("Latin capital ligature ij")},{character:"ĳ",title:t("Latin small ligature ij")},{character:"Ĵ",title:t("Latin capital letter j with circumflex")},{character:"ĵ",title:t("Latin small letter j with circumflex")},{character:"Ķ",title:t("Latin capital letter k with cedilla")},{character:"ķ",title:t("Latin small letter k with cedilla")},{character:"ĸ",title:t("Latin small letter kra")},{character:"Ĺ",title:t("Latin capital letter l with acute")},{character:"ĺ",title:t("Latin small letter l with acute")},{character:"Ļ",title:t("Latin capital letter l with cedilla")},{character:"ļ",title:t("Latin small letter l with cedilla")},{character:"Ľ",title:t("Latin capital letter l with caron")},{character:"ľ",title:t("Latin small letter l with caron")},{character:"Ŀ",title:t("Latin capital letter l with middle dot")},{character:"ŀ",title:t("Latin small letter l with middle dot")},{character:"Ł",title:t("Latin capital letter l with stroke")},{character:"ł",title:t("Latin small letter l with stroke")},{character:"Ń",title:t("Latin capital letter n with acute")},{character:"ń",title:t("Latin small letter n with acute")},{character:"Ņ",title:t("Latin capital letter n with cedilla")},{character:"ņ",title:t("Latin small letter n with cedilla")},{character:"Ň",title:t("Latin capital letter n with caron")},{character:"ň",title:t("Latin small letter n with caron")},{character:"ŉ",title:t("Latin small letter n preceded by apostrophe")},{character:"Ŋ",title:t("Latin capital letter eng")},{character:"ŋ",title:t("Latin small letter eng")},{character:"Ō",title:t("Latin capital letter o with macron")},{character:"ō",title:t("Latin small letter o with macron")},{character:"Ŏ",title:t("Latin capital letter o with breve")},{character:"ŏ",title:t("Latin small letter o with breve")},{character:"Ő",title:t("Latin capital letter o with double acute")},{character:"ő",title:t("Latin small letter o with double acute")},{character:"Œ",title:t("Latin capital ligature oe")},{character:"œ",title:t("Latin small ligature oe")},{character:"Ŕ",title:t("Latin capital letter r with acute")},{character:"ŕ",title:t("Latin small letter r with acute")},{character:"Ŗ",title:t("Latin capital letter r with cedilla")},{character:"ŗ",title:t("Latin small letter r with cedilla")},{character:"Ř",title:t("Latin capital letter r with caron")},{character:"ř",title:t("Latin small letter r with caron")},{character:"Ś",title:t("Latin capital letter s with acute")},{character:"ś",title:t("Latin small letter s with acute")},{character:"Ŝ",title:t("Latin capital letter s with circumflex")},{character:"ŝ",title:t("Latin small letter s with circumflex")},{character:"Ş",title:t("Latin capital letter s with cedilla")},{character:"ş",title:t("Latin small letter s with cedilla")},{character:"Š",title:t("Latin capital letter s with caron")},{character:"š",title:t("Latin small letter s with caron")},{character:"Ţ",title:t("Latin capital letter t with cedilla")},{character:"ţ",title:t("Latin small letter t with cedilla")},{character:"Ť",title:t("Latin capital letter t with caron")},{character:"ť",title:t("Latin small letter t with caron")},{character:"Ŧ",title:t("Latin capital letter t with stroke")},{character:"ŧ",title:t("Latin small letter t with stroke")},{character:"Ũ",title:t("Latin capital letter u with tilde")},{character:"ũ",title:t("Latin small letter u with tilde")},{character:"Ū",title:t("Latin capital letter u with macron")},{character:"ū",title:t("Latin small letter u with macron")},{character:"Ŭ",title:t("Latin capital letter u with breve")},{character:"ŭ",title:t("Latin small letter u with breve")},{character:"Ů",title:t("Latin capital letter u with ring above")},{character:"ů",title:t("Latin small letter u with ring above")},{character:"Ű",title:t("Latin capital letter u with double acute")},{character:"ű",title:t("Latin small letter u with double acute")},{character:"Ų",title:t("Latin capital letter u with ogonek")},{character:"ų",title:t("Latin small letter u with ogonek")},{character:"Ŵ",title:t("Latin capital letter w with circumflex")},{character:"ŵ",title:t("Latin small letter w with circumflex")},{character:"Ŷ",title:t("Latin capital letter y with circumflex")},{character:"ŷ",title:t("Latin small letter y with circumflex")},{character:"Ÿ",title:t("Latin capital letter y with diaeresis")},{character:"Ź",title:t("Latin capital letter z with acute")},{character:"ź",title:t("Latin small letter z with acute")},{character:"Ż",title:t("Latin capital letter z with dot above")},{character:"ż",title:t("Latin small letter z with dot above")},{character:"Ž",title:t("Latin capital letter z with caron")},{character:"ž",title:t("Latin small letter z with caron")},{character:"ſ",title:t("Latin small letter long s")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class HC extends a.Z{static get pluginName(){return"SpecialCharactersText"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Text",[{character:"‹",title:t("Single left-pointing angle quotation mark")},{character:"›",title:t("Single right-pointing angle quotation mark")},{character:"«",title:t("Left-pointing double angle quotation mark")},{character:"»",title:t("Right-pointing double angle quotation mark")},{character:"‘",title:t("Left single quotation mark")},{character:"’",title:t("Right single quotation mark")},{character:"“",title:t("Left double quotation mark")},{character:"”",title:t("Right double quotation mark")},{character:"‚",title:t("Single low-9 quotation mark")},{character:"„",title:t("Double low-9 quotation mark")},{character:"¡",title:t("Inverted exclamation mark")},{character:"¿",title:t("Inverted question mark")},{character:"‥",title:t("Two dot leader")},{character:"…",title:t("Horizontal ellipsis")},{character:"‡",title:t("Double dagger")},{character:"‰",title:t("Per mille sign")},{character:"‱",title:t("Per ten thousand sign")},{character:"‼",title:t("Double exclamation mark")},{character:"⁈",title:t("Question exclamation mark")},{character:"⁉",title:t("Exclamation question mark")},{character:"⁇",title:t("Double question mark")},{character:"©",title:t("Copyright sign")},{character:"®",title:t("Registered sign")},{character:"™",title:t("Trade mark sign")},{character:"§",title:t("Section sign")},{character:"¶",title:t("Paragraph sign")},{character:"⁋",title:t("Reversed paragraph sign")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class UC extends a.Z{static get requires(){return[FC,HC,zC,$C,ZC]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function WC(e,t,i,n,s=1){t>s?n.setAttribute(e,t,i):n.removeAttribute(e,i)}function qC(e,t,i={}){const n=e.createElement("tableCell",i);return e.insertElement("paragraph",n),e.insert(n,t),n}function GC(e,t){const i=t.parent.parent,n=parseInt(i.getAttribute("headingColumns")||0),{column:s}=e.getCellLocation(t);return!!n&&s<n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jC(){return e=>{e.on("element:figure",((e,t,i)=>{if(!i.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;const n=QC(t.viewItem);if(!n||!i.consumable.test(n,{name:!0}))return;i.consumable.consume(t.viewItem,{name:!0,classes:"table"});const s=i.convertItem(n,t.modelCursor),o=(0,Xi.Z)(s.modelRange.getItems());o?(i.convertChildren(t.viewItem,i.writer.createPositionAt(o,"end")),i.updateConversionResult(o,t)):i.consumable.revert(t.viewItem,{name:!0,classes:"table"})}))}}function KC(){return e=>{e.on("element:table",((e,t,i)=>{const n=t.viewItem;if(!i.consumable.test(n,{name:!0}))return;const{rows:s,headingRows:o,headingColumns:r}=XC(n),a={};r&&(a.headingColumns=r),o&&(a.headingRows=o);const l=i.writer.createElement("table",a);if(i.safeInsert(l,t.modelCursor)){if(i.consumable.consume(n,{name:!0}),s.forEach((e=>i.convertItem(e,i.writer.createPositionAt(l,"end")))),i.convertChildren(n,i.writer.createPositionAt(l,"end")),l.isEmpty){const e=i.writer.createElement("tableRow");i.writer.insert(e,i.writer.createPositionAt(l,"end")),qC(i.writer,i.writer.createPositionAt(e,"end"))}i.updateConversionResult(l,t)}}))}}function JC(){return e=>{e.on("element:tr",((e,t)=>{t.viewItem.isEmpty&&0==t.modelCursor.index&&e.stop()}),{priority:"high"})}}function YC(e){return t=>{t.on(`element:${e}`,((e,t,i)=>{if(t.modelRange&&t.viewItem.isEmpty){const e=t.modelRange.start.nodeAfter,n=i.writer.createPositionAt(e,0);i.writer.insertElement("paragraph",n)}}),{priority:"low"})}}function QC(e){for(const t of e.getChildren())if(t.is("element","table"))return t}function XC(e){const t={headingRows:0,headingColumns:0},i=[],n=[];let s;for(const o of Array.from(e.getChildren()))if("tbody"===o.name||"thead"===o.name||"tfoot"===o.name){"thead"!==o.name||s||(s=o);const e=Array.from(o.getChildren()).filter((e=>e.is("element","tr")));for(const o of e)if("thead"===o.parent.name&&o.parent===s)t.headingRows++,i.push(o);else{n.push(o);const e=ek(o,t,s);e>t.headingColumns&&(t.headingColumns=e)}}return t.rows=[...i,...n],t}function ek(e){let t=0,i=0;const n=Array.from(e.getChildren()).filter((e=>"th"===e.name||"td"===e.name));while(i<n.length&&"th"===n[i].name){const e=n[i],s=parseInt(e.getAttribute("colspan")||1);t+=s,i++}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tk{constructor(e,t={}){this._table=e,this._startRow=void 0!==t.row?t.row:t.startRow||0,this._endRow=void 0!==t.row?t.row:t.endRow,this._startColumn=void 0!==t.column?t.column:t.startColumn||0,this._endColumn=void 0!==t.column?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(i.cell,i.row,i.column));else{const i=e.getChild(this._cellIndex);if(!i)return this._advanceToNextRow();const n=parseInt(i.getAttribute("colspan")||1),s=parseInt(i.getAttribute("rowspan")||1);(n>1||s>1)&&this._recordSpans(i,s,n),this._shouldSkipSlot()||(t=this._formatOutValue(i)),this._nextCellAtColumn=this._column+n}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return void 0!==this._endRow&&this._row>this._endRow}_isOverEndColumn(){return void 0!==this._endColumn&&this._column>this._endColumn}_formatOutValue(e,t=this._row,i=this._column){return{done:!1,value:new ik(this,e,t,i)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,i=this._column<this._startColumn,n=void 0!==this._endColumn&&this._column>this._endColumn;return e||t||i||n}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,i){const n={cell:e,row:this._row,column:this._column};for(let s=this._row;s<this._row+t;s++)for(let e=this._column;e<this._column+i;e++)s==this._row&&e==this._column||this._markSpannedCell(s,e,n)}_markSpannedCell(e,t,i){this._spannedCells.has(e)||this._spannedCells.set(e,new Map);const n=this._spannedCells.get(e);n.set(t,i)}}class ik{constructor(e,t,i,n){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=i,this.cellAnchorColumn=n,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||1)}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||1)}get rowIndex(){return this._rowIndex}getPositionBefore(){const e=this._table.root.document.model;return e.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function nk(e={}){return t=>t.on("insert:table",((t,i,n)=>{const s=i.item;if(!n.consumable.consume(s,"insert"))return;n.consumable.consume(s,"attribute:headingRows:table"),n.consumable.consume(s,"attribute:headingColumns:table");const o=e&&e.asWidget,r=n.writer.createContainerElement("figure",{class:"table"}),a=n.writer.createContainerElement("table");let l;n.writer.insert(n.writer.createPositionAt(r,0),a),o&&(l=dk(r,n.writer));const c=new tk(s),d={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0},h=new Map;for(const m of c){const{row:t,cell:i}=m,o=s.getChild(t),r=h.get(t)||gk(a,o,t,d,n);h.set(t,r),n.consumable.consume(i,"insert");const l=n.writer.createPositionAt(r,"end");mk(m,d,l,n,e)}for(const e of s.getChildren()){const t=e.index;e.is("element","tableRow")&&!h.has(t)&&h.set(t,gk(a,e,t,d,n))}const u=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(s,o?l:r),n.writer.insert(u,o?l:r)}))}function sk(){return e=>e.on("insert:tableRow",((e,t,i)=>{const n=t.item;if(!i.consumable.consume(n,"insert"))return;const s=n.parent,o=i.mapper.toViewElement(s),r=yk(o),a=s.getChildIndex(n),l=new tk(s,{row:a}),c={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0},d=new Map;for(const h of l){const e=d.get(a)||gk(r,n,a,c,i);d.set(a,e),i.consumable.consume(h.cell,"insert");const t=i.writer.createPositionAt(e,"end");mk(h,c,t,i,{asWidget:!0})}}))}function ok(){return e=>e.on("insert:tableCell",((e,t,i)=>{const n=t.item;if(!i.consumable.consume(n,"insert"))return;const s=n.parent,o=s.parent,r=o.getChildIndex(s),a=new tk(o,{row:r}),l={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0};for(const c of a)if(c.cell===n){const e=i.mapper.toViewElement(s),t=i.writer.createPositionAt(e,s.getChildIndex(n));return void mk(c,l,t,i,{asWidget:!0})}}))}function rk(){return e=>e.on("attribute:headingColumns:table",((e,t,i)=>{const n=t.item;if(!i.consumable.consume(t.item,e.name))return;const s={headingRows:n.getAttribute("headingRows")||0,headingColumns:n.getAttribute("headingColumns")||0},o=t.attributeOldValue,r=t.attributeNewValue,a=(o>r?o:r)-1;for(const l of new tk(n,{endColumn:a}))uk(l,s,i)}))}function ak(){return e=>e.on("remove:tableRow",((e,t,i)=>{e.stop();const n=i.writer,s=i.mapper,o=s.toViewPosition(t.position).getLastMatchingPosition((e=>!e.item.is("element","tr"))),r=o.nodeAfter,a=r.parent,l=a.parent,c=n.createRangeOn(r),d=n.remove(c);for(const h of n.createRangeIn(d).getItems())s.unbindViewElement(h);_k("thead",l,i),_k("tbody",l,i)}),{priority:"higher"})}function lk(e,t){const{writer:i}=t;if(e.parent.is("element","tableCell"))return ck(e)?i.createContainerElement("span",{class:"ck-table-bogus-paragraph"}):i.createContainerElement("p")}function ck(e){const t=e.parent,i=1===t.childCount;return i&&!Ck(e)}function dk(e,t){return t.setCustomProperty("table",!0,e),fg(e,t,{hasSelectionHandle:!0})}function hk(e,t,i){const n=i.writer,s=i.mapper.toViewElement(e),o=n.createEditableElement(t,s.getAttributes()),r=Cg(o,n);n.insert(n.createPositionAfter(s),r),n.move(n.createRangeIn(s),n.createPositionAt(r,0)),n.remove(n.createRangeOn(s)),i.mapper.unbindViewElement(s),i.mapper.bindElements(e,r)}function uk(e,t,i){const{cell:n}=e,s=pk(e,t),o=i.mapper.toViewElement(n);o&&o.name!==s&&hk(n,s,i)}function mk(e,t,i,n,s){const o=s&&s.asWidget,r=pk(e,t),a=o?Cg(n.writer.createEditableElement(r),n.writer):n.writer.createContainerElement(r),l=e.cell,c=l.getChild(0),d=1===l.childCount&&"paragraph"===c.name;if(n.writer.insert(i,a),n.mapper.bindElements(l,a),!o&&d&&!Ck(c)){const e=l.getChild(0);n.consumable.consume(e,"insert"),n.mapper.bindElements(e,a)}}function gk(e,t,i,n,s){s.consumable.consume(t,"insert");const o=t.isEmpty?s.writer.createEmptyElement("tr"):s.writer.createContainerElement("tr");s.mapper.bindElements(t,o);const r=n.headingRows,a=wk(fk(i,n),e,s),l=r>0&&i>=r?i-r:i,c=s.writer.createPositionAt(a,l);return s.writer.insert(c,o),o}function pk(e,t){const{row:i,column:n}=e,{headingColumns:s,headingRows:o}=t,r=o&&o>i;if(r)return"th";const a=s&&s>n;return a?"th":"td"}function fk(e,t){return e<t.headingRows?"thead":"tbody"}function wk(e,t,i){const n=bk(e,t);return n||vk(e,t,i)}function bk(e,t){for(const i of t.getChildren())if(i.name==e)return i}function vk(e,t,i){const n=i.writer.createContainerElement(e),s=i.writer.createPositionAt(t,"tbody"==e?"end":0);return i.writer.insert(s,n),n}function _k(e,t,i){const n=bk(e,t);n&&0===n.childCount&&i.writer.remove(i.writer.createRangeOn(n))}function yk(e){for(const t of e.getChildren())if("table"===t.name)return t}function Ck(e){return!![...e.getAttributeKeys()].length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kk extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=e.schema;this.isEnabled=xk(t,i)}execute(e={}){const t=this.editor.model,i=t.document.selection,n=this.editor.plugins.get("TableUtils"),s=this.editor.config.get("table"),o=kg(i,t),r=s.defaultHeadings.rows,a=s.defaultHeadings.columns;void 0===e.headingRows&&r&&(e.headingRows=r),void 0===e.headingColumns&&a&&(e.headingColumns=a),t.change((i=>{const s=n.createTable(i,e);t.insertContent(s,o),i.setSelection(i.createPositionAt(s.getNodeByPath([0,0,0]),0))}))}}function xk(e,t){const i=e.getFirstPosition().parent,n=i===i.root?i:i.parent;return t.checkChild(n,"table")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ak(e){const t=[];for(const i of Ik(e.getRanges())){const e=i.getContainedElement();e&&e.is("element","tableCell")&&t.push(e)}return t}function Ek(e){const t=[];for(const i of e.getRanges()){const e=i.start.findAncestor("tableCell");e&&t.push(e)}return t}function Tk(e){const t=Ak(e);return t.length?t:Ek(e)}function Pk(e){const t=e.map((e=>e.parent.index));return Nk(t)}function Sk(e){const t=e[0].findAncestor("table"),i=[...new tk(t)],n=i.filter((t=>e.includes(t.cell))).map((e=>e.column));return Nk(n)}function Vk(e,t){if(e.length<2||!Bk(e))return!1;const i=new Set,n=new Set;let s=0;for(const r of e){const{row:e,column:o}=t.getCellLocation(r),a=parseInt(r.getAttribute("rowspan")||1),l=parseInt(r.getAttribute("colspan")||1);i.add(e),n.add(o),a>1&&i.add(e+a-1),l>1&&n.add(o+l-1),s+=a*l}const o=Dk(i,n);return o==s}function Ik(e){return Array.from(e).sort(Rk)}function Nk(e){const t=e.sort(((e,t)=>e-t)),i=t[0],n=t[t.length-1];return{first:i,last:n}}function Rk(e,t){const i=e.start,n=t.start;return i.isBefore(n)?-1:1}function Dk(e,t){const i=Array.from(e.values()),n=Array.from(t.values()),s=Math.max(...i),o=Math.min(...i),r=Math.max(...n),a=Math.min(...n);return(s-o+1)*(r-a+1)}function Bk(e){const t=e[0].findAncestor("table"),i=Pk(e),n=parseInt(t.getAttribute("headingRows")||0);if(!Mk(i,n))return!1;const s=parseInt(t.getAttribute("headingColumns")||0),o=Sk(e);return Mk(o,s)}function Mk({first:e,last:t},i){const n=e<i,s=t<i;return n===s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ok extends b.Z{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection,t=!!Tk(e).length;this.isEnabled=t}execute(){const e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),n="above"===this.order,s=Tk(t),o=Pk(s),r=n?o.first:o.last,a=s[0].findAncestor("table");i.insertRows(a,{at:n?r:r+1,copyStructureFromAbove:!n})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lk extends b.Z{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection,t=!!Tk(e).length;this.isEnabled=t}execute(){const e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),n="left"===this.order,s=Tk(t),o=Sk(s),r=n?o.first:o.last,a=s[0].findAncestor("table");i.insertColumns(a,{columns:1,at:n?r:r+1})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fk extends b.Z{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const e=Tk(this.editor.model.document.selection);this.isEnabled=1===e.length}execute(){const e=Tk(this.editor.model.document.selection)[0],t="horizontally"===this.direction,i=this.editor.plugins.get("TableUtils");t?i.splitCellHorizontally(e,2):i.splitCellVertically(e,2)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zk(e,t,i){const{startRow:n,startColumn:s,endRow:o,endColumn:r}=t,a=i.createElement("table"),l=o-n+1;for(let d=0;d<l;d++)i.insertElement("tableRow",a,"end");const c=[...new tk(e,{startRow:n,endRow:o,startColumn:s,endColumn:r,includeAllSlots:!0})];for(const{row:d,column:h,cell:u,isAnchor:m,cellAnchorRow:g,cellAnchorColumn:p}of c){const e=d-n,t=a.getChild(e);if(m){const e=i.cloneElement(u);i.append(e,t),Wk(e,d,h,o,r,i)}else(g<n||p<s)&&qC(i,i.createPositionAt(t,"end"))}return qk(a,e,n,s,i),a}function $k(e,t,i=0){const n=[],s=new tk(e,{startRow:i,endRow:t-1});for(const o of s){const{row:e,cellHeight:i}=o,s=e+i-1;e<t&&t<=s&&n.push(o)}return n}function Zk(e,t,i){const n=e.parent,s=n.parent,o=n.index,r=parseInt(e.getAttribute("rowspan")),a=t-o,l={},c=r-a;c>1&&(l.rowspan=c);const d=parseInt(e.getAttribute("colspan")||1);d>1&&(l.colspan=d);const h=o,u=h+a,m=[...new tk(s,{startRow:h,endRow:u,includeAllSlots:!0})];let g,p=null;for(const f of m){const{row:t,column:n,cell:s}=f;s===e&&void 0===g&&(g=n),void 0!==g&&g===n&&t===u&&(p=qC(i,f.getPositionBefore(),l))}return WC("rowspan",a,e,i),p}function Hk(e,t){const i=[],n=new tk(e);for(const s of n){const{column:e,cellWidth:n}=s,o=e+n-1;e<t&&t<=o&&i.push(s)}return i}function Uk(e,t,i,n){const s=parseInt(e.getAttribute("colspan")),o=i-t,r={},a=s-o;a>1&&(r.colspan=a);const l=parseInt(e.getAttribute("rowspan")||1);l>1&&(r.rowspan=l);const c=qC(n,n.createPositionAfter(e),r);return WC("colspan",o,e,n),c}function Wk(e,t,i,n,s,o){const r=parseInt(e.getAttribute("colspan")||1),a=parseInt(e.getAttribute("rowspan")||1),l=i+r-1;if(l>s){const t=s-i+1;WC("colspan",t,e,o,1)}const c=t+a-1;if(c>n){const i=n-t+1;WC("rowspan",i,e,o,1)}}function qk(e,t,i,n,s){const o=parseInt(t.getAttribute("headingRows")||0);if(o>0){const t=o-i;WC("headingRows",t,e,s,0)}const r=parseInt(t.getAttribute("headingColumns")||0);if(r>0){const t=r-n;WC("headingColumns",t,e,s,0)}}function Gk(e,t){const i=t.getColumns(e),n=new Array(i).fill(0);for(const{column:o}of new tk(e))n[o]++;const s=n.reduce(((e,t,i)=>t?e:[...e,i]),[]);if(s.length>0){const i=s[s.length-1];return t.removeColumns(e,{at:i}),!0}return!1}function jk(e,t){const i=[],n=t.getRows(e);for(let s=0;s<n;s++){const t=e.getChild(s);t.isEmpty&&i.push(s)}if(i.length>0){const n=i[i.length-1];return t.removeRows(e,{at:n}),!0}return!1}function Kk(e,t){const i=Gk(e,t);i||jk(e,t)}function Jk(e,t){const i=Array.from(new tk(e,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow})),n=i.every((({cellHeight:e})=>1===e));if(n)return t.lastRow;const s=i[0].cellHeight-1;return t.lastRow+s}function Yk(e,t){const i=Array.from(new tk(e,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn})),n=i.every((({cellWidth:e})=>1===e));if(n)return t.lastColumn;const s=i[0].cellWidth-1;return t.lastColumn+s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qk extends b.Z{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=e.document,i=Ek(t.selection)[0],n=this.value,s=this.direction;e.change((e=>{const t="right"==s||"down"==s,o=t?i:n,r=t?n:i,a=r.parent;tx(r,o,e);const l=this.isHorizontal?"colspan":"rowspan",c=parseInt(i.getAttribute(l)||1),d=parseInt(n.getAttribute(l)||1);e.setAttribute(l,c+d,o),e.setSelection(e.createRangeIn(o));const h=this.editor.plugins.get("TableUtils"),u=a.findAncestor("table");Kk(u,h)}))}_getMergeableCell(){const e=this.editor.model,t=e.document,i=Ek(t.selection)[0];if(!i)return;const n=this.editor.plugins.get("TableUtils"),s=this.isHorizontal?Xk(i,this.direction,n):ex(i,this.direction,n);if(!s)return;const o=this.isHorizontal?"rowspan":"colspan",r=parseInt(i.getAttribute(o)||1),a=parseInt(s.getAttribute(o)||1);return a===r?s:void 0}}function Xk(e,t,i){const n=e.parent,s=n.parent,o="right"==t?e.nextSibling:e.previousSibling,r=(s.getAttribute("headingColumns")||0)>0;if(!o)return;const a="right"==t?e:o,l="right"==t?o:e,{column:c}=i.getCellLocation(a),{column:d}=i.getCellLocation(l),h=parseInt(a.getAttribute("colspan")||1),u=GC(i,a,s),m=GC(i,l,s);if(r&&u!=m)return;const g=c+h===d;return g?o:void 0}function ex(e,t,i){const n=e.parent,s=n.parent,o=s.getChildIndex(n);if("down"==t&&o===i.getRows(s)-1||"up"==t&&0===o)return;const r=parseInt(e.getAttribute("rowspan")||1),a=s.getAttribute("headingRows")||0,l="down"==t&&o+r===a,c="up"==t&&o===a;if(a&&(l||c))return;const d=parseInt(e.getAttribute("rowspan")||1),h="down"==t?o+d:o,u=[...new tk(s,{endRow:h})],m=u.find((t=>t.cell===e)),g=m.column,p=u.find((({row:e,cellHeight:i,column:n})=>n===g&&("down"==t?e===h:h===e+i)));return p&&p.cell}function tx(e,t,i){ix(e)||(ix(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e)}function ix(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nx extends b.Z{refresh(){const e=Tk(this.editor.model.document.selection),t=e[0];if(t){const i=t.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getRows(i),s=n-1,o=Pk(e),r=0===o.first&&o.last===s;this.isEnabled=!r}else this.isEnabled=!1}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),i=Tk(e.document.selection),n=Pk(i),s=i[0],o=s.findAncestor("table"),r=t.getCellLocation(s).column;e.change((e=>{const i=n.last-n.first+1;t.removeRows(o,{at:n.first,rows:i});const s=sx(o,n.first,r,t.getRows(o));e.setSelection(e.createPositionAt(s,0))}))}}function sx(e,t,i,n){const s=e.getChild(Math.min(t,n-1));let o=s.getChild(0),r=0;for(const a of s.getChildren()){if(r>i)return o;o=a,r+=parseInt(a.getAttribute("colspan")||1)}return o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ox extends b.Z{refresh(){const e=Tk(this.editor.model.document.selection),t=e[0];if(t){const i=t.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getColumns(i),{first:s,last:o}=Sk(e);this.isEnabled=o-s<n-1}else this.isEnabled=!1}execute(){const[e,t]=ax(this.editor.model.document.selection),i=e.parent.parent,n=[...new tk(i)],s={first:n.find((t=>t.cell===e)).column,last:n.find((e=>e.cell===t)).column},o=rx(n,e,t,s);this.editor.model.change((e=>{const t=s.last-s.first+1;this.editor.plugins.get("TableUtils").removeColumns(i,{at:s.first,columns:t}),e.setSelection(e.createPositionAt(o,0))}))}}function rx(e,t,i,n){const s=parseInt(i.getAttribute("colspan")||1);return s>1?i:t.previousSibling||i.nextSibling?i.nextSibling||t.previousSibling:n.first?e.reverse().find((({column:e})=>e<n.first)).cell:e.reverse().find((({column:e})=>e>n.last)).cell}function ax(e){const t=Tk(e),i=t[0],n=t.pop(),s=[i,n];return i.isBefore(n)?s:s.reverse()}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lx extends b.Z{refresh(){const e=this.editor.model,t=Tk(e.document.selection),i=t.length>0;this.isEnabled=i,this.value=i&&t.every((e=>this._isInHeading(e,e.parent.parent)))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,i=Tk(t.document.selection),n=i[0].findAncestor("table"),{first:s,last:o}=Pk(i),r=this.value?s:o+1,a=n.getAttribute("headingRows")||0;t.change((e=>{if(r){const t=r>a?a:0,i=$k(n,r,t);for(const{cell:n}of i)Zk(n,r,e)}WC("headingRows",r,n,e,0)}))}_isInHeading(e,t){const i=parseInt(t.getAttribute("headingRows")||0);return!!i&&e.parent.index<i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cx extends b.Z{refresh(){const e=this.editor.model,t=Tk(e.document.selection),i=this.editor.plugins.get("TableUtils"),n=t.length>0;this.isEnabled=n,this.value=n&&t.every((e=>GC(i,e)))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,i=Tk(t.document.selection),n=i[0].findAncestor("table"),{first:s,last:o}=Sk(i),r=this.value?s:o+1;t.change((e=>{if(r){const t=Hk(n,r);for(const{cell:i,column:n}of t)Uk(i,n,r,e)}WC("headingColumns",r,n,e,0)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dx extends a.Z{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,i=t.parent,n=i.getChildIndex(t),s=new tk(i,{row:n});for(const{cell:o,row:r,column:a}of s)if(o===e)return{row:r,column:a}}createTable(e,t){const i=e.createElement("table"),n=parseInt(t.rows)||2,s=parseInt(t.columns)||2;return hx(e,i,0,n,s),t.headingRows&&WC("headingRows",Math.min(t.headingRows,n),i,e,0),t.headingColumns&&WC("headingColumns",Math.min(t.headingColumns,s),i,e,0),i}insertRows(e,t={}){const i=this.editor.model,n=t.at||0,s=t.rows||1,o=void 0!==t.copyStructureFromAbove,r=t.copyStructureFromAbove?n-1:n,a=this.getRows(e),l=this.getColumns(e);if(n>a)throw new S.ZP("tableutils-insertrows-insert-out-of-range",this,{options:t});i.change((t=>{const i=e.getAttribute("headingRows")||0;if(i>n&&WC("headingRows",i+s,e,t,0),!o&&(0===n||n===a))return void hx(t,e,n,s,l);const c=o?Math.max(n,r):n,d=new tk(e,{endRow:c}),h=new Array(l).fill(1);for(const{row:e,column:a,cellHeight:l,cellWidth:u,cell:m}of d){const i=e+l-1,c=e<n&&n<=i,d=e<=r&&r<=i;c?(t.setAttribute("rowspan",l+s,m),h[a]=-u):o&&d&&(h[a]=u)}for(let o=0;o<s;o++){const i=t.createElement("tableRow");t.insert(i,e,n);for(let e=0;e<h.length;e++){const n=h[e],s=t.createPositionAt(i,"end");n>0&&qC(t,s,n>1?{colspan:n}:null),e+=Math.abs(n)-1}}}))}insertColumns(e,t={}){const i=this.editor.model,n=t.at||0,s=t.columns||1;i.change((t=>{const i=e.getAttribute("headingColumns");n<i&&t.setAttribute("headingColumns",i+s,e);const o=this.getColumns(e);if(0===n||o===n){for(const i of e.getChildren())i.is("element","tableRow")&&ux(s,t,t.createPositionAt(i,n?"end":0));return}const r=new tk(e,{column:n,includeAllSlots:!0});for(const e of r){const{row:i,cell:o,cellAnchorColumn:a,cellAnchorRow:l,cellWidth:c,cellHeight:d}=e;if(a<n){t.setAttribute("colspan",c+s,o);const e=l+d-1;for(let t=i;t<=e;t++)r.skipRow(t)}else ux(s,t,e.getPositionBefore())}}))}removeRows(e,t){const i=this.editor.model,n=t.rows||1,s=this.getRows(e),o=t.at,r=o+n-1;if(r>s-1)throw new S.ZP("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});i.change((t=>{const{cellsToMove:i,cellsToTrim:n}=fx(e,o,r);if(i.size){const n=r+1;wx(e,n,i,t)}for(let s=r;s>=o;s--)t.remove(e.getChild(s));for(const{rowspan:e,cell:s}of n)WC("rowspan",e,s,t);px(e,o,r,t),Gk(e,this)||jk(e,this)}))}removeColumns(e,t){const i=this.editor.model,n=t.at,s=t.columns||1,o=t.at+s-1;i.change((t=>{gx(e,{first:n,last:o},t);for(let i=o;i>=n;i--)for(const{cell:n,column:s,cellWidth:o}of[...new tk(e)])s<=i&&o>1&&s+o>i?WC("colspan",o-1,n,t):s===i&&t.remove(n);jk(e,this)||Gk(e,this)}))}splitCellVertically(e,t=2){const i=this.editor.model,n=e.parent,s=n.parent,o=parseInt(e.getAttribute("rowspan")||1),r=parseInt(e.getAttribute("colspan")||1);i.change((i=>{if(r>1){const{newCellsSpan:n,updatedSpan:s}=mx(r,t);WC("colspan",s,e,i);const a={};n>1&&(a.colspan=n),o>1&&(a.rowspan=o);const l=r>t?t-1:r-1;ux(l,i,i.createPositionAfter(e),a)}if(r<t){const n=t-r,a=[...new tk(s)],{column:l}=a.find((({cell:t})=>t===e)),c=a.filter((({cell:t,cellWidth:i,column:n})=>{const s=t!==e&&n===l,o=n<l&&n+i>l;return s||o}));for(const{cell:e,cellWidth:t}of c)i.setAttribute("colspan",t+n,e);const d={};o>1&&(d.rowspan=o),ux(n,i,i.createPositionAfter(e),d);const h=s.getAttribute("headingColumns")||0;h>l&&WC("headingColumns",h+n,s,i)}}))}splitCellHorizontally(e,t=2){const i=this.editor.model,n=e.parent,s=n.parent,o=s.getChildIndex(n),r=parseInt(e.getAttribute("rowspan")||1),a=parseInt(e.getAttribute("colspan")||1);i.change((i=>{if(r>1){const n=[...new tk(s,{startRow:o,endRow:o+r-1,includeAllSlots:!0})],{newCellsSpan:l,updatedSpan:c}=mx(r,t);WC("rowspan",c,e,i);const{column:d}=n.find((({cell:t})=>t===e)),h={};l>1&&(h.rowspan=l),a>1&&(h.colspan=a);for(const e of n){const{column:t,row:n}=e,s=n>=o+c,r=t===d,a=(n+o+c)%l===0;s&&r&&a&&ux(1,i,e.getPositionBefore(),h)}}if(r<t){const n=t-r,l=[...new tk(s,{startRow:0,endRow:o})];for(const{cell:t,cellHeight:s,row:r}of l)if(t!==e&&r+s>o){const e=s+n;i.setAttribute("rowspan",e,t)}const c={};a>1&&(c.colspan=a),hx(i,s,o+1,n,1,c);const d=s.getAttribute("headingRows")||0;d>o&&WC("headingRows",d+n,s,i)}}))}getColumns(e){const t=e.getChild(0);return[...t.getChildren()].reduce(((e,t)=>{const i=parseInt(t.getAttribute("colspan")||1);return e+i}),0)}getRows(e){return Array.from(e.getChildren()).reduce(((e,t)=>t.is("element","tableRow")?e+1:e),0)}}function hx(e,t,i,n,s,o={}){for(let r=0;r<n;r++){const n=e.createElement("tableRow");e.insert(n,t,i),ux(s,e,e.createPositionAt(n,"end"),o)}}function ux(e,t,i,n={}){for(let s=0;s<e;s++)qC(t,i,n)}function mx(e,t){if(e<t)return{newCellsSpan:1,updatedSpan:1};const i=Math.floor(e/t),n=e-i*t+i;return{newCellsSpan:i,updatedSpan:n}}function gx(e,t,i){const n=e.getAttribute("headingColumns")||0;if(n&&t.first<n){const s=Math.min(n-1,t.last)-t.first+1;i.setAttribute("headingColumns",n-s,e)}}function px(e,t,i,n){const s=e.getAttribute("headingRows")||0;if(t<s){const o=i<s?s-(i-t+1):t;WC("headingRows",o,e,n,0)}}function fx(e,t,i){const n=new Map,s=[];for(const{row:o,column:r,cellHeight:a,cell:l}of new tk(e,{endRow:i})){const e=o+a-1,c=o>=t&&o<=i&&e>i;if(c){const e=i-o+1,t=a-e;n.set(r,{cell:l,rowspan:t})}const d=o<t&&e>=t;if(d){let n;n=e>=i?i-t+1:e-t+1,s.push({cell:l,rowspan:a-n})}}return{cellsToMove:n,cellsToTrim:s}}function wx(e,t,i,n){const s=new tk(e,{includeAllSlots:!0,row:t}),o=[...s],r=e.getChild(t);let a;for(const{column:l,cell:c,isAnchor:d}of o)if(i.has(l)){const{cell:e,rowspan:t}=i.get(l),s=a?n.createPositionAfter(a):n.createPositionAt(r,0);n.move(n.createRangeOn(e),s),WC("rowspan",t,e,n),a=e}else d&&(a=c)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bx extends b.Z{refresh(){const e=Ak(this.editor.model.document.selection);this.isEnabled=Vk(e,this.editor.plugins.get(dx))}execute(){const e=this.editor.model,t=this.editor.plugins.get(dx);e.change((i=>{const n=Ak(e.document.selection),s=n.shift(),{mergeWidth:o,mergeHeight:r}=yx(s,n,t);WC("colspan",o,s,i),WC("rowspan",r,s,i);for(const e of n)vx(e,s,i);const a=s.findAncestor("table");Kk(a,t),i.setSelection(s,"in")}))}}function vx(e,t,i){_x(e)||(_x(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e)}function _x(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}function yx(e,t,i){let n=0,s=0;for(const c of t){const{row:e,column:t}=i.getCellLocation(c);n=Cx(c,t,n,"colspan"),s=Cx(c,e,s,"rowspan")}const{row:o,column:r}=i.getCellLocation(e),a=n-r,l=s-o;return{mergeWidth:a,mergeHeight:l}}function Cx(e,t,i,n){const s=parseInt(e.getAttribute(n)||1);return Math.max(i,t+s)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kx extends b.Z{constructor(e){super(e),this.affectsData=!1}refresh(){const e=Tk(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=Tk(e.document.selection),i=Pk(t),n=t[0].findAncestor("table"),s=[];for(let o=i.first;o<=i.last;o++)for(const t of n.getChild(o).getChildren())s.push(e.createRangeOn(t));e.change((e=>{e.setSelection(s)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xx extends b.Z{constructor(e){super(e),this.affectsData=!1}refresh(){const e=Tk(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=Tk(e.document.selection),i=t[0],n=t.pop(),s=i.findAncestor("table"),o=this.editor.plugins.get("TableUtils"),r=o.getCellLocation(i),a=o.getCellLocation(n),l=Math.min(r.column,a.column),c=Math.max(r.column,a.column),d=[];for(const h of new tk(s,{startColumn:l,endColumn:c}))d.push(e.createRangeOn(h.cell));e.change((e=>{e.setSelection(d)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ax(e){e.document.registerPostFixer((t=>Ex(t,e)))}function Ex(e,t){const i=t.document.differ.getChanges();let n=!1;const s=new Set;for(const o of i){let t;"table"==o.name&&"insert"==o.type&&(t=o.position.nodeAfter),"tableRow"!=o.name&&"tableCell"!=o.name||(t=o.position.findAncestor("table")),Ix(o)&&(t=o.range.start.findAncestor("table")),t&&!s.has(t)&&(n=Tx(t,e)||n,n=Px(t,e)||n,s.add(t))}return n}function Tx(e,t){let i=!1;const n=Sx(e);if(n.length){i=!0;for(const e of n)WC("rowspan",e.rowspan,e.cell,t,1)}return i}function Px(e,t){let i=!1;const n=Vx(e),s=[];for(const[l,c]of n.entries())!c&&e.getChild(l).is("element","tableRow")&&s.push(l);if(s.length){i=!0;for(const i of s.reverse())t.remove(e.getChild(i)),n.splice(i,1)}const o=n.filter(((t,i)=>e.getChild(i).is("element","tableRow"))),r=o[0],a=o.every((e=>e===r));if(!a){const n=o.reduce(((e,t)=>t>e?t:e),0);for(const[s,r]of o.entries()){const o=n-r;if(o){for(let i=0;i<o;i++)qC(t,t.createPositionAt(e.getChild(s),"end"));i=!0}}}return i}function Sx(e){const t=parseInt(e.getAttribute("headingRows")||0),i=Array.from(e.getChildren()).reduce(((e,t)=>t.is("element","tableRow")?e+1:e),0),n=[];for(const{row:s,cell:o,cellHeight:r}of new tk(e)){if(r<2)continue;const e=s<t,a=e?t:i;if(s+r>a){const e=a-s;n.push({cell:o,rowspan:e})}}return n}function Vx(e){const t=new Array(e.childCount).fill(0);for(const{rowIndex:i}of new tk(e,{includeAllSlots:!0}))t[i]++;return t}function Ix(e){const t="attribute"===e.type,i=e.attributeKey;return t&&("headingRows"===i||"colspan"===i||"rowspan"===i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Nx(e){e.document.registerPostFixer((t=>Rx(t,e)))}function Rx(e,t){const i=t.document.differ.getChanges();let n=!1;for(const s of i)"insert"==s.type&&"table"==s.name&&(n=Dx(s.position.nodeAfter,e)||n),"insert"==s.type&&"tableRow"==s.name&&(n=Bx(s.position.nodeAfter,e)||n),"insert"==s.type&&"tableCell"==s.name&&(n=Mx(s.position.nodeAfter,e)||n),Ox(s)&&(n=Mx(s.position.parent,e)||n);return n}function Dx(e,t){let i=!1;for(const n of e.getChildren())n.is("element","tableRow")&&(i=Bx(n,t)||i);return i}function Bx(e,t){let i=!1;for(const n of e.getChildren())i=Mx(n,t)||i;return i}function Mx(e,t){if(0==e.childCount)return t.insertElement("paragraph",e),!0;const i=Array.from(e.getChildren()).filter((e=>e.is("$text")));for(const n of i)t.wrap(t.createRangeOn(n),"paragraph");return!!i.length}function Ox(e){return!(!e.position||!e.position.parent.is("element","tableCell"))&&("insert"==e.type&&"$text"==e.name||"remove"==e.type)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Lx(e,t){e.document.registerPostFixer((()=>Fx(e.document.differ,t)))}function Fx(e,t){const i=new Set;for(const n of e.getChanges()){const e="attribute"==n.type?n.range.start.parent:n.position.parent;e.is("element","tableCell")&&i.add(e)}for(const n of i.values())for(const i of[...n.getChildren()].filter((e=>zx(e,t))))e.refreshItem(i);return!1}function zx(e,t){if(!e.is("element","paragraph"))return!1;const i=t.toViewElement(e);return!!i&&ck(e)!==i.is("element","span")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $x(e){e.document.registerPostFixer((()=>Zx(e)))}function Zx(e){const t=e.document.differ,i=new Set;for(const n of t.getChanges())if("attribute"===n.type){const e=n.range.start.nodeAfter;e&&e.is("element","table")&&"headingRows"===n.attributeKey&&i.add(e)}else if("insert"===n.type||"remove"===n.type)if("tableRow"===n.name){const e=n.position.findAncestor("table"),t=e.getAttribute("headingRows")||0;n.position.offset<t&&i.add(e)}else if("tableCell"===n.name){const e=n.position.findAncestor("table"),t=e.getAttribute("headingColumns")||0;n.position.offset<t&&i.add(e)}if(i.size){for(const e of i.values())t.refreshItem(e);return!0}return!1}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hx extends a.Z{static get pluginName(){return"TableEditing"}init(){const e=this.editor,t=e.model,i=t.schema,n=e.conversion;i.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isObject:!0,isBlock:!0}),i.register("tableRow",{allowIn:"table",isLimit:!0}),i.register("tableCell",{allowIn:"tableRow",allowChildren:"$block",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),n.for("upcast").add(jC()),n.for("upcast").add(KC()),n.for("editingDowncast").add(nk({asWidget:!0})),n.for("dataDowncast").add(nk()),n.for("upcast").elementToElement({model:"tableRow",view:"tr"}),n.for("upcast").add(JC()),n.for("editingDowncast").add(sk()),n.for("editingDowncast").add(ak()),n.for("upcast").elementToElement({model:"tableCell",view:"td"}),n.for("upcast").elementToElement({model:"tableCell",view:"th"}),n.for("upcast").add(YC("td")),n.for("upcast").add(YC("th")),n.for("editingDowncast").add(ok()),n.for("editingDowncast").elementToElement({model:"paragraph",view:lk,converterPriority:"high"}),n.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),n.for("upcast").attributeToAttribute({model:{key:"colspan",value:Wx("colspan")},view:"colspan"}),n.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),n.for("upcast").attributeToAttribute({model:{key:"rowspan",value:Wx("rowspan")},view:"rowspan"}),n.for("editingDowncast").add(rk()),e.data.mapper.on("modelToViewPosition",Ux()),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new kk(e)),e.commands.add("insertTableRowAbove",new Ok(e,{order:"above"})),e.commands.add("insertTableRowBelow",new Ok(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Lk(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Lk(e,{order:"right"})),e.commands.add("removeTableRow",new nx(e)),e.commands.add("removeTableColumn",new ox(e)),e.commands.add("splitTableCellVertically",new Fk(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new Fk(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new bx(e)),e.commands.add("mergeTableCellRight",new Qk(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new Qk(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new Qk(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new Qk(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new cx(e)),e.commands.add("setTableRowHeader",new lx(e)),e.commands.add("selectTableRow",new kx(e)),e.commands.add("selectTableColumn",new xx(e)),$x(t),Ax(t),Lx(t,e.editing.mapper),Nx(t)}static get requires(){return[dx]}}function Ux(){return(e,t)=>{const i=t.modelPosition.parent,n=t.modelPosition.nodeBefore;if(!i.is("element","tableCell"))return;if(!n||!n.is("element","paragraph"))return;const s=t.mapper.toViewElement(n),o=t.mapper.toViewElement(i);s===o&&(t.viewPosition=t.mapper.findPositionIn(o,n.maxOffset))}}function Wx(e){return t=>{const i=parseInt(t.getAttribute(e));return Number.isNaN(i)||i<=0?null:i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qx extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",((e,t)=>`${t} × ${e}`)),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:t.to("label")}]}],on:{mousedown:t.to((e=>{e.preventDefault()})),click:t.to((()=>{this.fire("execute")}))}}),this.on("boxover",((e,t)=>{const{row:i,column:n}=t.target.dataset;this.set({rows:parseInt(i),columns:parseInt(n)})})),this.on("change:columns",(()=>{this._highlightGridBoxes()})),this.on("change:rows",(()=>{this._highlightGridBoxes()}))}focus(){}focusLast(){}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map(((i,n)=>{const s=Math.floor(n/10),o=n%10,r=s<e&&o<t;i.set("isOn",r)}))}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const i=Math.floor(t/10),n=t%10;e.push(new Gx(this.locale,i+1,n+1))}return this.createCollection(e)}}class Gx extends cl.Z{constructor(e,t,i){super(e);const n=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",n.if("isOn","ck-on")],"data-row":t,"data-column":i}})}}var jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',Kx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',Jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',Yx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qx extends a.Z{static get pluginName(){return"TableUI"}init(){const e=this.editor,t=this.editor.t,i=e.locale.contentLanguageDirection,n="ltr"===i;e.ui.componentFactory.add("insertTable",(i=>{const n=e.commands.get("insertTable"),s=vc(i);let o;return s.bind("isEnabled").to(n),s.buttonView.set({icon:jx,label:t("Insert table"),tooltip:!0}),s.on("change:isOpen",(()=>{o||(o=new qx(i),s.panelView.children.add(o),o.delegate("execute").to(s),s.buttonView.on("open",(()=>{o.rows=0,o.columns=0})),s.on("execute",(()=>{e.execute("insertTable",{rows:o.rows,columns:o.columns}),e.editing.view.focus()})))})),s})),e.ui.componentFactory.add("tableColumn",(e=>{const i=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:n?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:n?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),Kx,i,e)})),e.ui.componentFactory.add("tableRow",(e=>{const i=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),Jx,i,e)})),e.ui.componentFactory.add("mergeTableCells",(e=>{const i=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:n?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:n?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),Yx,i,e)}))}_prepareDropdown(e,t,i,n){const s=this.editor,o=vc(n),r=this._fillDropdownWithListOptions(o,i);return o.buttonView.set({label:e,icon:t,tooltip:!0}),o.bind("isEnabled").toMany(r,"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(o,"execute",(e=>{s.execute(e.source.commandName),s.editing.view.focus()})),o}_prepareMergeSplitButtonDropdown(e,t,i,n){const s=this.editor,o=vc(n,Ql),r="mergeTableCells",a=s.commands.get(r),l=this._fillDropdownWithListOptions(o,i);return o.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),o.bind("isEnabled").toMany([a,...l],"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(o.buttonView,"execute",(()=>{s.execute(r),s.editing.view.focus()})),this.listenTo(o,"execute",(e=>{s.execute(e.source.commandName),s.editing.view.focus()})),o}_fillDropdownWithListOptions(e,t){const i=this.editor,n=[],s=new P.Z;for(const o of t)Xx(o,i,n,s);return yc(e,s,i.ui.componentFactory),n}}function Xx(e,t,i,n){const s=e.model=new Lc(e.model),{commandName:o,bindIsOn:r}=e.model;if("button"===e.type||"switchbutton"===e.type){const e=t.commands.get(o);i.push(e),s.set({commandName:o}),s.bind("isEnabled").to(e),r&&s.bind("isOn").to(e,"value")}s.set({withText:!0}),n.add(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eA extends a.Z{static get pluginName(){return"TableSelection"}static get requires(){return[dx]}init(){const e=this.editor,t=e.model;this.listenTo(t,"deleteContent",((e,t)=>this._handleDeleteContent(e,t)),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=this.editor.model.document.selection,t=Ak(e);return 0==t.length?null:t}getSelectionAsFragment(){const e=this.getSelectedTableCells();return e?this.editor.model.change((t=>{const i=t.createDocumentFragment(),n=this.editor.plugins.get("TableUtils"),{first:s,last:o}=Sk(e),{first:r,last:a}=Pk(e),l=e[0].findAncestor("table");let c=a,d=o;if(Vk(e,n)){const e={firstColumn:s,lastColumn:o,firstRow:r,lastRow:a};c=Jk(l,e),d=Yk(l,e)}const h={startRow:r,startColumn:s,endRow:c,endColumn:d},u=zk(l,h,t);return t.insert(u,i,0),i})):null}setCellSelection(e,t){const i=this._getCellsToSelect(e,t);this.editor.model.change((e=>{e.setSelection(i.cells.map((t=>e.createRangeOn(t))),{backward:i.backward})}))}getFocusCell(){const e=this.editor.model.document.selection,t=[...e.getRanges()].pop(),i=t.getContainedElement();return i&&i.is("element","tableCell")?i:null}getAnchorCell(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getRanges()),i=t.getContainedElement();return i&&i.is("element","tableCell")?i:null}_defineSelectionConverter(){const e=this.editor,t=new Set;function i(e){for(const i of t)e.removeClass("ck-editor__editable_selected",i);t.clear()}e.conversion.for("editingDowncast").add((e=>e.on("selection",((e,n,s)=>{const o=s.writer;i(o);const r=this.getSelectedTableCells();if(!r)return;for(const i of r){const e=s.mapper.toViewElement(i);o.addClass("ck-editor__editable_selected",e),t.add(e)}const a=s.mapper.toViewElement(r[r.length-1]);o.setSelection(a,0)}),{priority:"lowest"})))}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",(()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change((i=>{const n=i.createPositionAt(t[0],0),s=e.model.schema.getNearestSelectionRange(n);i.setSelection(s)}))}}))}_handleDeleteContent(e,t){const[i,n]=t,s=this.editor.model,o=!n||"backward"==n.direction,r=Ak(i);r.length&&(e.stop(),s.change((e=>{const t=r[o?r.length-1:0];s.change((e=>{for(const t of r)s.deleteContent(e.createSelection(t,"in"))}));const n=s.schema.getNearestSelectionRange(e.createPositionAt(t,0));i.is("documentSelection")?e.setSelection(n):i.setTo(n)})))}_getCellsToSelect(e,t){const i=this.editor.plugins.get("TableUtils"),n=i.getCellLocation(e),s=i.getCellLocation(t),o=Math.min(n.row,s.row),r=Math.max(n.row,s.row),a=Math.min(n.column,s.column),l=Math.max(n.column,s.column),c=new Array(r-o+1).fill(null).map((()=>[])),d={startRow:o,endRow:r,startColumn:a,endColumn:l};for(const{row:m,cell:g}of new tk(e.findAncestor("table"),d))c[m-o].push(g);const h=s.row<n.row,u=s.column<n.column;return h&&c.reverse(),u&&c.forEach((e=>e.reverse())),{cells:c.flat(),backward:h||u}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tA extends a.Z{static get pluginName(){return"TableClipboard"}static get requires(){return[eA,dx]}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",((e,t)=>this._onCopyCut(e,t))),this.listenTo(t,"cut",((e,t)=>this._onCopyCut(e,t))),this.listenTo(e.model,"insertContent",((e,t)=>this._onInsertContent(e,...t)),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(e,t){const i=this.editor.plugins.get(eA);if(!i.getSelectedTableCells())return;if("cut"==e.name&&this.editor.isReadOnly)return;t.preventDefault(),e.stop();const n=this.editor.data,s=this.editor.editing.view.document,o=n.toView(i.getSelectionAsFragment());s.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:o,method:e.name})}_onInsertContent(e,t,i){if(i&&!i.is("documentSelection"))return;const n=this.editor.model,s=this.editor.plugins.get(dx);let o=iA(t,n);if(!o)return;const r=Tk(n.document.selection);r.length?(e.stop(),n.change((e=>{const t={width:s.getColumns(o),height:s.getRows(o)},i=nA(r,t,e,s),n=i.lastRow-i.firstRow+1,a=i.lastColumn-i.firstColumn+1,l={startRow:0,startColumn:0,endRow:Math.min(n,t.height)-1,endColumn:Math.min(a,t.width)-1};o=zk(o,l,e);const c=r[0].findAncestor("table"),d=this._replaceSelectedCellsWithPasted(o,t,c,i,e);if(this.editor.plugins.get("TableSelection").isEnabled){const t=Ik(d.map((t=>e.createRangeOn(t))));e.setSelection(t)}else e.setSelection(d[0],0)}))):Kk(o,s)}_replaceSelectedCellsWithPasted(e,t,i,n,s){const{width:o,height:r}=t,a=oA(e,o,r),l=[...new tk(i,{startRow:n.firstRow,endRow:n.lastRow,startColumn:n.firstColumn,endColumn:n.lastColumn,includeAllSlots:!0})],c=[];let d;for(const p of l){const{row:e,column:t}=p;t===n.firstColumn&&(d=p.getPositionBefore());const i=e-n.firstRow,l=t-n.firstColumn,h=a[i%r][l%o],u=h?s.cloneElement(h):null,m=this._replaceTableSlotCell(p,u,d,s);m&&(Wk(m,e,t,n.lastRow,n.lastColumn,s),c.push(m),d=s.createPositionAfter(m))}const h=parseInt(i.getAttribute("headingRows")||0),u=parseInt(i.getAttribute("headingColumns")||0),m=n.firstRow<h&&h<=n.lastRow,g=n.firstColumn<u&&u<=n.lastColumn;if(m){const e={first:n.firstColumn,last:n.lastColumn},t=aA(i,h,e,s,n.firstRow);c.push(...t)}if(g){const e={first:n.firstRow,last:n.lastRow},t=lA(i,u,e,s);c.push(...t)}return c}_replaceTableSlotCell(e,t,i,n){const{cell:s,isAnchor:o}=e;return o&&n.remove(s),t?(n.insert(t,i),t):null}}function iA(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(1==e.childCount&&e.getChild(0).is("element","table"))return e.getChild(0);const i=t.createRangeIn(e);for(const n of i.getItems())if(n.is("element","table")){const e=t.createRange(i.start,t.createPositionBefore(n));if(t.hasContent(e,{ignoreWhitespaces:!0}))return null;const s=t.createRange(t.createPositionAfter(n),i.end);return t.hasContent(s,{ignoreWhitespaces:!0})?null:n}return null}function nA(e,t,i,n){const s=e[0].findAncestor("table"),o=Sk(e),r=Pk(e),a={firstColumn:o.first,lastColumn:o.last,firstRow:r.first,lastRow:r.last},l=1===e.length;return l&&(a.lastRow+=t.height-1,a.lastColumn+=t.width-1,sA(s,a.lastRow+1,a.lastColumn+1,n)),l||!Vk(e,n)?rA(s,a,i):(a.lastRow=Jk(s,a),a.lastColumn=Yk(s,a)),a}function sA(e,t,i,n){const s=n.getColumns(e),o=n.getRows(e);i>s&&n.insertColumns(e,{at:s,columns:i-s}),t>o&&n.insertRows(e,{at:o,rows:t-o})}function oA(e,t,i){const n=new Array(i).fill(null).map((()=>new Array(t).fill(null)));for(const{column:s,row:o,cell:r}of new tk(e))n[o][s]=r;return n}function rA(e,t,i){const{firstRow:n,lastRow:s,firstColumn:o,lastColumn:r}=t,a={first:n,last:s},l={first:o,last:r};lA(e,o,a,i),lA(e,r+1,a,i),aA(e,n,l,i),aA(e,s+1,l,i,n)}function aA(e,t,i,n,s=0){if(t<1)return;const o=$k(e,t,s),r=o.filter((({column:e,cellWidth:t})=>cA(e,t,i)));return r.map((({cell:e})=>Zk(e,t,n)))}function lA(e,t,i,n){if(t<1)return;const s=Hk(e,t),o=s.filter((({row:e,cellHeight:t})=>cA(e,t,i)));return o.map((({cell:e,column:i})=>Uk(e,i,t,n)))}function cA(e,t,i){const n=e+t-1,{first:s,last:o}=i,r=e>=s&&e<=o,a=e<s&&n>=s;return r||a}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dA extends a.Z{static get pluginName(){return"TableKeyboard"}static get requires(){return[eA]}init(){const e=this.editor.editing.view,t=e.document;this.editor.keystrokes.set("Tab",((...e)=>this._handleTabOnSelectedTable(...e)),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(t,"arrowKey",((...e)=>this._onArrowKey(...e)),{context:"table"})}_handleTabOnSelectedTable(e,t){const i=this.editor,n=i.model.document.selection,s=n.getSelectedElement();s&&s.is("element","table")&&(t(),i.model.change((e=>{e.setSelection(e.createRangeIn(s.getChild(0).getChild(0)))})))}_getTabHandler(e){const t=this.editor;return(i,n)=>{const s=t.model.document.selection;let o=Ek(s)[0];if(o||(o=this.editor.plugins.get("TableSelection").getFocusCell()),!o)return;n();const r=o.parent,a=r.parent,l=a.getChildIndex(r),c=r.getChildIndex(o),d=0===c;if(!e&&d&&0===l)return void t.model.change((e=>{e.setSelection(e.createRangeOn(a))}));const h=this.editor.plugins.get("TableUtils"),u=c===r.childCount-1,m=l===h.getRows(a)-1;if(e&&m&&u&&(t.execute("insertTableRowBelow"),l===h.getRows(a)-1))return void t.model.change((e=>{e.setSelection(e.createRangeOn(a))}));let g;if(e&&u){const e=a.getChild(l+1);g=e.getChild(0)}else if(!e&&d){const e=a.getChild(l-1);g=e.getChild(e.childCount-1)}else g=r.getChild(c+(e?1:-1));t.model.change((e=>{e.setSelection(e.createRangeIn(g))}))}}_onArrowKey(e,t){const i=this.editor,n=t.keyCode,s=(0,ct.mA)(n,i.locale.contentLanguageDirection),o=this._handleArrowKeys(s,t.shiftKey);o&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const i=this.editor.model,n=i.document.selection,s=["right","down"].includes(e),o=Ak(n);if(o.length){let i;return i=t?this.editor.plugins.get("TableSelection").getFocusCell():s?o[o.length-1]:o[0],this._navigateFromCellInDirection(i,e,t),!0}const r=n.focus.findAncestor("tableCell");if(!r)return!1;if(!n.isCollapsed)if(t){if(n.isBackward==s&&!n.containsEntireContent(r))return!1}else{const e=n.getSelectedElement();if(!e||!i.schema.isObject(e))return!1}return!!this._isSelectionAtCellEdge(n,r,s)&&(this._navigateFromCellInDirection(r,e,t),!0)}_isSelectionAtCellEdge(e,t,i){const n=this.editor.model,s=this.editor.model.schema,o=i?e.getLastPosition():e.getFirstPosition();if(!s.getLimitElement(o).is("element","tableCell")){const e=n.createPositionAt(t,i?"end":0);return e.isTouching(o)}const r=n.createSelection(o);return n.modifySelection(r,{direction:i?"forward":"backward"}),o.isEqual(r.focus)}_navigateFromCellInDirection(e,t,i=!1){const n=this.editor.model,s=e.findAncestor("table"),o=[...new tk(s,{includeAllSlots:!0})],{row:r,column:a}=o[o.length-1],l=o.find((({cell:t})=>t==e));let{row:c,column:d}=l;switch(t){case"left":d--;break;case"up":c--;break;case"right":d+=l.cellWidth;break;case"down":c+=l.cellHeight;break}const h=c<0||c>r,u=d<0&&c<=0,m=d>a&&c>=r;if(h||u||m)return void n.change((e=>{e.setSelection(e.createRangeOn(s))}));d<0?(d=i?0:a,c--):d>a&&(d=i?a:0,c++);const g=o.find((e=>e.row==c&&e.column==d)).cell,p=["right","down"].includes(t),f=this.editor.plugins.get("TableSelection");if(i&&f.isEnabled){const t=f.getAnchorCell()||e;f.setCellSelection(t,g)}else{const e=n.createPositionAt(g,p?0:"end");n.change((t=>{t.setSelection(e)}))}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hA extends Ti{constructor(e){super(e),this.domEventType=["mousemove","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uA extends a.Z{static get pluginName(){return"TableMouse"}static get requires(){return[eA]}init(){const e=this.editor;e.editing.view.addObserver(hA),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor;let t=!1;const i=e.plugins.get(eA);this.listenTo(e.editing.view.document,"mousedown",((n,s)=>{if(!this.isEnabled||!i.isEnabled)return;if(!s.domEvent.shiftKey)return;const o=i.getAnchorCell()||Ek(e.model.document.selection)[0];if(!o)return;const r=this._getModelTableCellFromDomEvent(s);r&&mA(o,r)&&(t=!0,i.setCellSelection(o,r),s.preventDefault())})),this.listenTo(e.editing.view.document,"mouseup",(()=>{t=!1})),this.listenTo(e.editing.view.document,"selectionChange",(e=>{t&&e.stop()}),{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,i,n=!1,s=!1;const o=e.plugins.get(eA);this.listenTo(e.editing.view.document,"mousedown",((e,i)=>{this.isEnabled&&o.isEnabled&&(i.domEvent.shiftKey||i.domEvent.ctrlKey||i.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(i)))})),this.listenTo(e.editing.view.document,"mousemove",((e,r)=>{if(!r.domEvent.buttons)return;if(!t)return;const a=this._getModelTableCellFromDomEvent(r);a&&mA(t,a)&&(i=a,n||i==t||(n=!0)),n&&(s=!0,o.setCellSelection(t,i),r.preventDefault())})),this.listenTo(e.editing.view.document,"mouseup",(()=>{n=!1,s=!1,t=null,i=null})),this.listenTo(e.editing.view.document,"selectionChange",(e=>{s&&e.stop()}),{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,i=this.editor.editing.view.createPositionAt(t,0),n=this.editor.editing.mapper.toModelPosition(i),s=n.parent;return s.findAncestor("tableCell",{includeSelf:!0})}}function mA(e,t){return e.parent.parent==t.parent.parent}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gA extends a.Z{static get requires(){return[Hx,Qx,eA,uA,dA,tA,Gg]}static get pluginName(){return"Table"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function pA(e){e.document.registerPostFixer((t=>fA(t,e)))}function fA(e,t){const i=t.document.differ.getChanges();let n=!1;for(const s of i){if("insert"!=s.type)continue;const t=s.position.parent;if(t.is("element","table")||"table"==s.name){const t="table"==s.name?s.position.nodeAfter:s.position.parent,i=Array.from(t.getChildren()).filter((e=>e.is("element","caption"))),o=i.shift();if(!o)continue;for(const n of i)e.move(e.createRangeIn(n),o,"end"),e.remove(n);o.nextSibling&&(e.move(e.createRangeOn(o),t,"end"),n=!0),n=!!i.length||n}}return n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function wA(e){return!!e&&e.is("element","table")}function bA(e){for(const t of e.getChildren())if(t.is("element","caption"))return t;return null}function vA(e){const t=yA(e);return t?bA(t):null}function _A(e){const t=e.parent;return"figcaption"==e.name&&t&&"figure"==t.name&&t.hasClass("table")||"caption"==e.name&&t&&"table"==t.name?{name:!0}:null}function yA(e){const t=e.getSelectedElement();return t&&t.is("element","table")?t:e.getFirstPosition().findAncestor("table")}
/**
* @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
class CA extends b.Z{refresh(){const e=this.editor,t=yA(e.model.document.selection);this.isEnabled=!!t,this.isEnabled?this.value=!!bA(t):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change((e=>{this.value?this._hideTableCaption(e):this._showTableCaption(e,t)}))}_showTableCaption(e,t){const i=this.editor.model,n=yA(i.document.selection),s=this.editor.plugins.get("TableCaptionEditing"),o=s._getSavedCaption(n),r=o||e.createElement("caption");e.append(r,n),t&&e.setSelection(r,"in")}_hideTableCaption(e){const t=this.editor.model,i=yA(t.document.selection),n=this.editor.plugins.get("TableCaptionEditing"),s=bA(i);n._saveCaption(i,s),e.setSelection(e.createRangeIn(i.getChild(0).getChild(0))),e.remove(s)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kA extends a.Z{static get pluginName(){return"TableCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema,i=e.editing.view,n=e.t;t.isRegistered("caption")?t.extend("caption",{allowIn:"table"}):t.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new CA(this.editor)),e.conversion.for("upcast").elementToElement({view:_A,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>wA(e.parent)?t.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>{if(!wA(e.parent))return null;const s=t.createEditableElement("figcaption");return t.setCustomProperty("tableCaption",!0,s),Yd({view:i,element:s,text:n("Enter table caption"),keepOnFocus:!0}),Cg(s,t)}}),pA(e.model)}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?kn.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}
/**
* @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
class xA extends a.Z{static get pluginName(){return"TableCaptionUI"}init(){const e=this.editor,t=e.editing.view,i=e.t;e.ui.componentFactory.add("toggleTableCaption",(n=>{const s=e.commands.get("toggleTableCaption"),o=new l.Z(n);return o.set({icon:ol.caption,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),o.bind("label").to(s,"value",(e=>i(e?"Toggle caption off":"Toggle caption on"))),this.listenTo(o,"execute",(()=>{if(e.execute("toggleTableCaption",{focusCaptionOnShow:!0}),s.value){const i=vA(e.model.document.selection),n=e.editing.mapper.toViewElement(i);if(!n)return;t.scrollToTheSelection(),t.change((e=>{e.addClass("table__caption_highlighted",n)}))}})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class AA extends a.Z{static get pluginName(){return"TableCaption"}static get requires(){return[kA,xA]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class EA extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate;this.set("value",""),this.set("id"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.set("ariaDescribedById"),this.options=t,this._dropdownView=this._createDropdownView(),this._inputView=this._createInputTextView(),this._stillTyping=!1,this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color",i.if("hasError","ck-error")],id:i.to("id"),"aria-invalid":i.if("hasError",!0),"aria-describedby":i.to("ariaDescribedById")},children:[this._dropdownView,this._inputView]}),this.on("change:value",((e,t,i)=>this._setInputValue(i)))}focus(){this._inputView.focus()}_createDropdownView(){const e=this.locale,t=e.t,i=this.bindTemplate,n=this._createColorGrid(e),s=vc(e),o=new cl.Z,r=this._createRemoveColorButton();return o.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:i.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",i.if("value","ck-hidden",(e=>""!=e))]}}]}),s.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),s.buttonView.children.add(o),s.buttonView.tooltip=t("Color picker"),s.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",s.panelView.children.add(r),s.panelView.children.add(n),s.bind("isEnabled").to(this,"isReadOnly",(e=>!e)),s}_createInputTextView(){const e=this.locale,t=new Nc(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",(()=>{const e=t.element.value,i=this.options.colorDefinitions.find((t=>e===t.label));this._stillTyping=!0,this.value=i&&i.color||e})),t.on("blur",(()=>{this._stillTyping=!1,this._setInputValue(t.element.value)})),t.delegate("input").to(this),t}_createRemoveColorButton(){const e=this.locale,t=e.t,i=new l.Z(e),n=this.options.defaultColorValue||"",s=t(n?"Restore default":"Remove color");return i.class="ck-input-color__remove-color",i.withText=!0,i.icon=ol.eraser,i.label=s,i.on("execute",(()=>{this.value=n,this._dropdownView.isOpen=!1,this.fire("input")})),i}_createColorGrid(e){const t=new jl(e,{colorDefinitions:this.options.colorDefinitions,columns:this.options.columns});return t.on("execute",((e,t)=>{this.value=t.value,this._dropdownView.isOpen=!1,this.fire("input")})),t.bind("selectedColor").to(this,"value"),t}_setInputValue(e){if(!this._stillTyping){const t=TA(e),i=this.options.colorDefinitions.find((e=>t===TA(e.color)));this._inputView.value=i?i.label:e||""}}}function TA(e){return e.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const PA=e=>""===e;function SA(e){return{none:e("None"),solid:e("Solid"),dotted:e("Dotted"),dashed:e("Dashed"),double:e("Double"),groove:e("Groove"),ridge:e("Ridge"),inset:e("Inset"),outset:e("Outset")}}function VA(e){return e('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function IA(e){return e('The value is invalid. Try "10px" or "2em" or simply "2".')}function NA(e){return e=e.trim(),PA(e)||Eh(e)}function RA(e){return e=e.trim(),PA(e)||FA(e)||Vh(e)||Nh(e)}function DA(e){return e=e.trim(),PA(e)||FA(e)||Vh(e)}function BA(e,t){const i=new P.Z,n=SA(e.t);for(const s in n){const o={type:"button",model:new Lc({_borderStyleValue:s,label:n[s],withText:!0})};"none"===s?o.model.bind("isOn").to(e,"borderStyle",(e=>"none"===t?!e:e===s)):o.model.bind("isOn").to(e,"borderStyle",(e=>e===s)),i.add(o)}return i}function MA(e){const{view:t,icons:i,toolbar:n,labels:s,propertyName:o,nameToValue:r,defaultValue:a}=e;for(const c in s){const e=new l.Z(t.locale);e.set({label:s[c],icon:i[c],tooltip:s[c]});const d=r?r(c):c;e.bind("isOn").to(t,o,(e=>{let t=e;return""===e&&a&&(t=a),d===t})),e.on("execute",(()=>{t[o]=d})),n.items.add(e)}}const OA=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function LA(e){return(t,i,n)=>{const s=new EA(t.locale,{colorDefinitions:zA(e.colorConfig),columns:e.columns,defaultColorValue:e.defaultColorValue});return s.set({id:i,ariaDescribedById:n}),s.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),s.bind("hasError").to(t,"errorText",(e=>!!e)),s.on("input",(()=>{t.errorText=null})),t.bind("isEmpty","isFocused").to(s),s}}function FA(e){const t=parseFloat(e);return!Number.isNaN(t)&&e===String(t)}function zA(e){return e.map((e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}})))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $A extends cl.Z{constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("class",t.class||null),this.children=this.createCollection(),t.children&&t.children.forEach((e=>this.children.add(e))),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",i.to("class")],role:i.to("_role"),"aria-labelledby":i.to("_ariaLabelledBy")},children:this.children})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ZA={left:ol.alignLeft,center:ol.alignCenter,right:ol.alignRight,justify:ol.alignJustify,top:ol.alignTop,middle:ol.alignMiddle,bottom:ol.alignBottom};class HA extends cl.Z{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:i,borderWidthInput:n,borderColorInput:s,borderRowLabel:o}=this._createBorderFields(),{backgroundRowLabel:r,backgroundInput:a}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{horizontalAlignmentToolbar:u,verticalAlignmentToolbar:m,alignmentLabel:g}=this._createAlignmentFields();this.focusTracker=new en,this.keystrokes=new tn,this.children=this.createCollection(),this.borderStyleDropdown=i,this.borderWidthInput=n,this.borderColorInput=s,this.backgroundInput=a,this.paddingInput=this._createPaddingField(),this.widthInput=l,this.heightInput=d,this.horizontalAlignmentToolbar=u,this.verticalAlignmentToolbar=m;const{saveButtonView:p,cancelButtonView:f}=this._createActionButtons();this.saveButtonView=p,this.cancelButtonView=f,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Ic(e,{label:this.t("Cell properties")})),this.children.add(new $A(e,{labelView:o,children:[o,i,s,n],class:"ck-table-form__border-row"})),this.children.add(new $A(e,{labelView:r,children:[r,a],class:"ck-table-form__background-row"})),this.children.add(new $A(e,{children:[new $A(e,{labelView:h,children:[h,l,c,d],class:"ck-table-form__dimensions-row"}),new $A(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new $A(e,{labelView:g,children:[g,u,m],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new $A(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ml({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=LA({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color}),n=this.locale,s=this.t,o=new Tc(n);o.text=s("Border");const r=SA(s),a=new Dc(n,Mc);a.set({label:s("Style"),class:"ck-table-form__border-style"}),a.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:s("Style")}),a.fieldView.buttonView.bind("label").to(this,"borderStyle",(e=>r[e||"none"])),a.fieldView.on("execute",(e=>{this.borderStyle=e.source._borderStyleValue})),a.bind("isEmpty").to(this,"borderStyle",(e=>!e)),yc(a.fieldView,BA(this,t.style));const l=new Dc(n,Bc);l.set({label:s("Width"),class:"ck-table-form__border-width"}),l.fieldView.bind("value").to(this,"borderWidth"),l.bind("isEnabled").to(this,"borderStyle",UA),l.fieldView.on("input",(()=>{this.borderWidth=l.fieldView.element.value}));const c=new Dc(n,i);return c.set({label:s("Color"),class:"ck-table-form__border-color"}),c.fieldView.bind("value").to(this,"borderColor"),c.bind("isEnabled").to(this,"borderStyle",UA),c.fieldView.on("input",(()=>{this.borderColor=c.fieldView.value})),this.on("change:borderStyle",((e,i,n,s)=>{UA(n)||(this.borderColor="",this.borderWidth=""),UA(s)||(this.borderColor=t.color,this.borderWidth=t.width)})),{borderRowLabel:o,borderStyleDropdown:a,borderColorInput:c,borderWidthInput:l}}_createBackgroundFields(){const e=this.locale,t=this.t,i=new Tc(e);i.text=t("Background");const n=LA({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor}),s=new Dc(e,n);return s.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),s.fieldView.bind("value").to(this,"backgroundColor"),s.fieldView.on("input",(()=>{this.backgroundColor=s.fieldView.value})),{backgroundRowLabel:i,backgroundInput:s}}_createDimensionFields(){const e=this.locale,t=this.t,i=new Tc(e);i.text=t("Dimensions");const n=new Dc(e,Bc);n.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",(()=>{this.width=n.fieldView.element.value}));const s=new cl.Z(e);s.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const o=new Dc(e,Bc);return o.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),o.fieldView.bind("value").to(this,"height"),o.fieldView.on("input",(()=>{this.height=o.fieldView.element.value})),{dimensionsLabel:i,widthInput:n,operatorLabel:s,heightInput:o}}_createPaddingField(){const e=this.locale,t=this.t,i=new Dc(e,Bc);return i.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),i.fieldView.bind("value").to(this,"padding"),i.fieldView.on("input",(()=>{this.padding=i.fieldView.element.value})),i}_createAlignmentFields(){const e=this.locale,t=this.t,i=new Tc(e);i.text=t("Table cell text alignment");const n=new uc(e),s="rtl"===this.locale.contentLanguageDirection;n.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),MA({view:this,icons:ZA,toolbar:n,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:e=>{if(s){if("left"===e)return"right";if("right"===e)return"left"}return e},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const o=new uc(e);return o.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),MA({view:this,icons:ZA,toolbar:o,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:n,verticalAlignmentToolbar:o,alignmentLabel:i}}_createActionButtons(){const e=this.locale,t=this.t,i=new l.Z(e),n=new l.Z(e),s=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return i.set({label:t("Save"),icon:ol.check,class:"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(s,"errorText",((...e)=>e.every((e=>!e)))),n.set({label:t("Cancel"),icon:ol.cancel,class:"ck-button-cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:n}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,i=t("Align cell text to the left"),n=t("Align cell text to the center"),s=t("Align cell text to the right"),o=t("Justify cell text");return"rtl"===e.uiLanguageDirection?{right:s,center:n,left:i,justify:o}:{left:i,center:n,right:s,justify:o}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function UA(e){return"none"!==e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function WA(e){const t=e.getSelectedElement();return t&&GA(t)?t:null}function qA(e){let t=e.getFirstPosition().parent;while(t){if(t.is("element")&&GA(t))return t;t=t.parent}return null}function GA(e){return!!e.getCustomProperty("table")&&pg(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const jA=Zc.defaultPositions,KA=[jA.northArrowSouth,jA.northArrowSouthWest,jA.northArrowSouthEast,jA.southArrowNorth,jA.southArrowNorthWest,jA.southArrowNorthEast,jA.viewportStickyNorth];function JA(e,t){const i=e.plugins.get("ContextualBalloon");if(qA(e.editing.view.document.selection)){let n;n="cell"===t?QA(e):YA(e),i.updatePosition(n)}}function YA(e){const t=e.model.document.selection.getFirstPosition(),i=t.findAncestor("table"),n=e.editing.mapper.toViewElement(i);return{target:e.editing.view.domConverter.viewToDom(n),positions:KA}}function QA(e){const t=e.editing.mapper,i=e.editing.view.domConverter,n=e.model.document.selection;if(n.rangeCount>1)return{target:()=>eE(n.getRanges(),e),positions:KA};const s=XA(n.getFirstPosition()),o=t.toViewElement(s);return{target:i.viewToDom(o),positions:KA}}function XA(e){const t=e.nodeAfter&&e.nodeAfter.is("element","tableCell");return t?e.nodeAfter:e.findAncestor("tableCell")}function eE(e,t){const i=t.editing.mapper,n=t.editing.view.domConverter,s=Array.from(e).map((e=>{const t=XA(e.start),s=i.toViewElement(t);return new Gi(n.viewToDom(s))}));return Gi.getBoundingRect(s)}var tE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function iE(e){if(!e||!(0,le.Z)(e))return e;const{top:t,right:i,bottom:n,left:s}=e;return t==i&&i==n&&n==s?t:void 0}function nE(e,t){const i=parseFloat(e);return Number.isNaN(i)||String(i)!==String(e)?e:`${i}${t}`}function sE(e,t={}){const i=Object.assign({borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:""},e);return t.includeAlignmentProperty&&!i.alignment&&(i.alignment="center"),t.includePaddingProperty&&!i.padding&&(i.padding=""),t.includeVerticalAlignmentProperty&&!i.verticalAlignment&&(i.verticalAlignment="middle"),t.includeHorizontalAlignmentProperty&&!i.horizontalAlignment&&(i.horizontalAlignment=t.isRightToLeftContent?"right":"left"),i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const oE=500,rE={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",width:"tableCellWidth",height:"tableCellHeight",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class aE extends a.Z{static get requires(){return[jc]}static get pluginName(){return"TableCellPropertiesUI"}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:OA,backgroundColors:OA})}init(){const e=this.editor,t=e.t;this._defaultTableCellProperties=sE(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection}),this._balloon=e.plugins.get(jc),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableCellProperties",(i=>{const n=new l.Z(i);n.set({label:t("Cell properties"),icon:tE,tooltip:!0}),this.listenTo(n,"execute",(()=>this._showView()));const s=Object.values(rE).map((t=>e.commands.get(t)));return n.bind("isEnabled").toMany(s,"isEnabled",((...e)=>e.some((e=>e)))),n}))}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.editing.view.document,i=e.config.get("table.tableCellProperties"),n=Zl(i.borderColors),s=$l(e.locale,n),o=Zl(i.backgroundColors),r=$l(e.locale,o),a=new HA(e.locale,{borderColors:s,backgroundColors:r,defaultTableCellProperties:this._defaultTableCellProperties}),l=e.t;a.render(),this.listenTo(a,"submit",(()=>{this._hideView()})),this.listenTo(a,"cancel",(()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()})),a.keystrokes.set("Esc",((e,t)=>{this._hideView(),t()})),this.listenTo(e.ui,"update",(()=>{qA(t.selection)?this._isViewVisible&&JA(e,"cell"):this._hideView()})),Dl({emitter:a,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const c=VA(l),d=IA(l);return a.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle",this._defaultTableCellProperties.borderStyle)),a.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:a.borderColorInput,commandName:"tableCellBorderColor",errorText:c,validator:NA,defaultValue:this._defaultTableCellProperties.borderColor})),a.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:a.borderWidthInput,commandName:"tableCellBorderWidth",errorText:d,validator:DA,defaultValue:this._defaultTableCellProperties.borderWidth})),a.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:a.paddingInput,commandName:"tableCellPadding",errorText:d,validator:RA,defaultValue:this._defaultTableCellProperties.padding})),a.on("change:width",this._getValidatedPropertyChangeCallback({viewField:a.widthInput,commandName:"tableCellWidth",errorText:d,validator:RA,defaultValue:this._defaultTableCellProperties.width})),a.on("change:height",this._getValidatedPropertyChangeCallback({viewField:a.heightInput,commandName:"tableCellHeight",errorText:d,validator:RA,defaultValue:this._defaultTableCellProperties.height})),a.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:a.backgroundInput,commandName:"tableCellBackgroundColor",errorText:c,validator:NA,defaultValue:this._defaultTableCellProperties.backgroundColor})),a.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment",this._defaultTableCellProperties.horizontalAlignment)),a.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment",this._defaultTableCellProperties.verticalAlignment)),a}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(rE).map((([t,i])=>{const n=this._defaultTableCellProperties[t]||"";return[t,e.get(i).value||n]})).forEach((([e,i])=>{("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&this.view.set(e,i)}))}_showView(){const e=this.editor;this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:QA(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){if(!this._isViewInBalloon)return;const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e,t){return(i,n,s,o)=>{(o||t!==s)&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:i,validator:n,errorText:s,defaultValue:o}=e,r=(0,Si.Z)((()=>{i.errorText=s}),oE);return(e,s,a,l)=>{r.cancel(),(l||o!==a)&&(n(a)?(this.editor.execute(t,{value:a,batch:this._undoStepBatch}),i.errorText=null):r())}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function lE(e,t){const{viewElement:i,defaultValue:n,modelAttribute:s,styleName:o,reduceBoxSides:r=!1}=t;e.for("upcast").attributeToAttribute({view:{name:i,styles:{[o]:/[\s\S]+/}},model:{key:s,value:e=>{const t=e.getNormalizedStyle(o),i=r?uE(t):t;if(n!==i)return i}}})}function cE(e,t,i,n){e.for("upcast").add((e=>e.on("element:"+t,((e,t,s)=>{if(!t.modelRange)return;const o=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter((e=>t.viewItem.hasStyle(e)));if(!o.length)return;const r={styles:o};if(!s.consumable.test(t.viewItem,r))return;const a=[...t.modelRange.getItems({shallow:!0})].pop();s.consumable.consume(t.viewItem,r);const l={style:t.viewItem.getNormalizedStyle("border-style"),color:t.viewItem.getNormalizedStyle("border-color"),width:t.viewItem.getNormalizedStyle("border-width")},c={style:uE(l.style),color:uE(l.color),width:uE(l.width)};c.style!==n.style&&s.writer.setAttribute(i.style,c.style,a),c.color!==n.color&&s.writer.setAttribute(i.color,c.color,a),c.width!==n.width&&s.writer.setAttribute(i.width,c.width,a)}))))}function dE(e,{modelElement:t,modelAttribute:i,styleName:n}){e.for("downcast").attributeToAttribute({model:{name:t,key:i},view:e=>({key:"style",value:{[n]:e}})})}function hE(e,{modelAttribute:t,styleName:i}){e.for("downcast").add((e=>e.on(`attribute:${t}:table`,((e,t,n)=>{const{item:s,attributeNewValue:o}=t,{mapper:r,writer:a}=n;if(!n.consumable.consume(t.item,e.name))return;const l=[...r.toViewElement(s).getChildren()].find((e=>e.is("element","table")));o?a.setStyle(i,o,l):a.removeStyle(i,l)}))))}function uE(e){if(!e)return;const t=["top","right","bottom","left"].map((t=>e[t])).reduce(((e,t)=>e==t?e:null));return t||e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mE extends b.Z{constructor(e,t,i){super(e),this.attributeName=t,this._defaultValue=i}refresh(){const e=this.editor,t=Tk(e.model.document.selection);this.isEnabled=!!t.length,this.value=this._getSingleValue(t)}execute(e={}){const{value:t,batch:i}=e,n=this.editor.model,s=Tk(n.document.selection),o=this._getValueToSet(t);n.enqueueChange(i||"default",(e=>{o?s.forEach((t=>e.setAttribute(this.attributeName,o,t))):s.forEach((t=>e.removeAttribute(this.attributeName,t)))}))}_getAttribute(e){if(!e)return;const t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const t=this._getAttribute(e[0]),i=e.every((e=>this._getAttribute(e)===t));return i?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gE extends mE{constructor(e,t){super(e,"tableCellPadding",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=nE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pE extends mE{constructor(e,t){super(e,"tableCellWidth",t)}_getValueToSet(e){if(e=nE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fE extends mE{constructor(e,t){super(e,"tableCellHeight",t)}_getValueToSet(e){return e=nE(e,"px"),e===this._defaultValue?null:e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wE extends mE{constructor(e,t){super(e,"tableCellBackgroundColor",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bE extends mE{constructor(e,t){super(e,"tableCellVerticalAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vE extends mE{constructor(e,t){super(e,"tableCellHorizontalAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _E extends mE{constructor(e,t){super(e,"tableCellBorderStyle",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yE extends mE{constructor(e,t){super(e,"tableCellBorderColor",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class CE extends mE{constructor(e,t){super(e,"tableCellBorderWidth",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=nE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const kE=/^(top|middle|bottom)$/,xE=/^(left|center|right|justify)$/;class AE extends a.Z{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[Hx]}init(){const e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});const n=sE(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection});e.data.addStyleProcessorRules(jh),EE(t,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),e.commands.add("tableCellBorderStyle",new _E(e,n.borderStyle)),e.commands.add("tableCellBorderColor",new yE(e,n.borderColor)),e.commands.add("tableCellBorderWidth",new CE(e,n.borderWidth)),SE(t,i,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:n.width}),e.commands.add("tableCellWidth",new pE(e,n.width)),SE(t,i,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:n.height}),e.commands.add("tableCellHeight",new fE(e,n.height)),e.data.addStyleProcessorRules(ru),SE(t,i,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:n.padding}),e.commands.add("tableCellPadding",new gE(e,n.padding)),e.data.addStyleProcessorRules(qh),SE(t,i,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),e.commands.add("tableCellBackgroundColor",new wE(e,n.backgroundColor)),TE(t,i,n.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new vE(e,n.horizontalAlignment)),PE(t,i,n.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new bE(e,n.verticalAlignment))}}function EE(e,t,i){const n={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};e.extend("tableCell",{allowAttributes:Object.values(n)}),cE(t,"td",n,i),cE(t,"th",n,i),dE(t,{modelElement:"tableCell",modelAttribute:n.style,styleName:"border-style"}),dE(t,{modelElement:"tableCell",modelAttribute:n.color,styleName:"border-color"}),dE(t,{modelElement:"tableCell",modelAttribute:n.width,styleName:"border-width"})}function TE(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:e=>({key:"style",value:{"text-align":e}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":xE}},model:{key:"tableCellHorizontalAlignment",value:e=>{const t=e.getStyle("text-align");return t===i?null:t}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:xE}},model:{key:"tableCellHorizontalAlignment",value:e=>{const t=e.getAttribute("align");return t===i?null:t}}})}function PE(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:e=>({key:"style",value:{"vertical-align":e}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":kE}},model:{key:"tableCellVerticalAlignment",value:e=>{const t=e.getStyle("vertical-align");return t===i?null:t}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:kE}},model:{key:"tableCellVerticalAlignment",value:e=>{const t=e.getAttribute("valign");return t===i?null:t}}})}function SE(e,t,i){const{modelAttribute:n}=i;e.extend("tableCell",{allowAttributes:[n]}),lE(t,{viewElement:/^(td|th)$/,...i}),dE(t,{modelElement:"tableCell",...i})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class VE extends a.Z{static get pluginName(){return"TableCellProperties"}static get requires(){return[AE,aE]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class IE extends b.Z{constructor(e,t,i){super(e),this.attributeName=t,this._defaultValue=i}refresh(){const e=this.editor,t=e.model.document.selection,i=t.getFirstPosition().findAncestor("table");this.isEnabled=!!i,this.value=this._getValue(i)}execute(e={}){const t=this.editor.model,i=t.document.selection,{value:n,batch:s}=e,o=i.getFirstPosition().findAncestor("table"),r=this._getValueToSet(n);t.enqueueChange(s||"default",(e=>{r?e.setAttribute(this.attributeName,r,o):e.removeAttribute(this.attributeName,o)}))}_getValue(e){if(!e)return;const t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class NE extends IE{constructor(e,t){super(e,"tableBackgroundColor",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class RE extends IE{constructor(e,t){super(e,"tableBorderColor",t)}_getValue(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class DE extends IE{constructor(e,t){super(e,"tableBorderStyle",t)}_getValue(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class BE extends IE{constructor(e,t){super(e,"tableBorderWidth",t)}_getValue(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=nE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ME extends IE{constructor(e,t){super(e,"tableWidth",t)}_getValueToSet(e){if(e=nE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class OE extends IE{constructor(e,t){super(e,"tableHeight",t)}_getValueToSet(e){return e=nE(e,"px"),e===this._defaultValue?null:e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class LE extends IE{constructor(e,t){super(e,"tableAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const FE=/^(left|center|right)$/,zE=/^(left|none|right)$/;class $E extends a.Z{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[Hx]}init(){const e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});const n=sE(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});e.data.addStyleProcessorRules(jh),ZE(t,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),e.commands.add("tableBorderColor",new RE(e,n.borderColor)),e.commands.add("tableBorderStyle",new DE(e,n.borderStyle)),e.commands.add("tableBorderWidth",new BE(e,n.borderWidth)),HE(t,i,n.alignment),e.commands.add("tableAlignment",new LE(e,n.alignment)),WE(t,i,{modelAttribute:"tableWidth",styleName:"width",defaultValue:n.width}),e.commands.add("tableWidth",new ME(e,n.width)),WE(t,i,{modelAttribute:"tableHeight",styleName:"height",defaultValue:n.height}),e.commands.add("tableHeight",new OE(e,n.height)),e.data.addStyleProcessorRules(qh),UE(t,i,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),e.commands.add("tableBackgroundColor",new NE(e,n.backgroundColor))}}function ZE(e,t,i){const n={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};e.extend("table",{allowAttributes:Object.values(n)}),cE(t,"table",n,i),hE(t,{modelAttribute:n.color,styleName:"border-color"}),hE(t,{modelAttribute:n.style,styleName:"border-style"}),hE(t,{modelAttribute:n.width,styleName:"border-width"})}function HE(e,t,i){e.extend("table",{allowAttributes:["tableAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:e=>({key:"style",value:{float:"center"===e?"none":e}}),converterPriority:"high"}),t.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:zE}},model:{key:"tableAlignment",value:e=>{let t=e.getStyle("float");return"none"===t&&(t="center"),t===i?null:t}}}).attributeToAttribute({view:{attributes:{align:FE}},model:{name:"table",key:"tableAlignment",value:e=>{const t=e.getAttribute("align");return t===i?null:t}}})}function UE(e,t,i){const{modelAttribute:n}=i;e.extend("table",{allowAttributes:[n]}),lE(t,{viewElement:"table",...i}),hE(t,i)}function WE(e,t,i){const{modelAttribute:n}=i;e.extend("table",{allowAttributes:[n]}),lE(t,{viewElement:/^(table|figure)$/,...i}),dE(t,{modelElement:"table",...i})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const qE={left:ol.objectLeft,center:ol.objectCenter,right:ol.objectRight};class GE extends cl.Z{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:i,borderWidthInput:n,borderColorInput:s,borderRowLabel:o}=this._createBorderFields(),{backgroundRowLabel:r,backgroundInput:a}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{alignmentToolbar:u,alignmentLabel:m}=this._createAlignmentFields();this.focusTracker=new en,this.keystrokes=new tn,this.children=this.createCollection(),this.borderStyleDropdown=i,this.borderWidthInput=n,this.borderColorInput=s,this.backgroundInput=a,this.widthInput=l,this.heightInput=d,this.alignmentToolbar=u;const{saveButtonView:g,cancelButtonView:p}=this._createActionButtons();this.saveButtonView=g,this.cancelButtonView=p,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Ic(e,{label:this.t("Table properties")})),this.children.add(new $A(e,{labelView:o,children:[o,i,s,n],class:"ck-table-form__border-row"})),this.children.add(new $A(e,{labelView:r,children:[r,a],class:"ck-table-form__background-row"})),this.children.add(new $A(e,{children:[new $A(e,{labelView:h,children:[h,l,c,d],class:"ck-table-form__dimensions-row"}),new $A(e,{labelView:m,children:[m,u],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new $A(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ml({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=LA({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color}),n=this.locale,s=this.t,o=new Tc(n);o.text=s("Border");const r=SA(this.t),a=new Dc(n,Mc);a.set({label:s("Style"),class:"ck-table-form__border-style"}),a.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:s("Style")}),a.fieldView.buttonView.bind("label").to(this,"borderStyle",(e=>r[e||"none"])),a.fieldView.on("execute",(e=>{this.borderStyle=e.source._borderStyleValue})),a.bind("isEmpty").to(this,"borderStyle",(e=>!e)),yc(a.fieldView,BA(this,t.style));const l=new Dc(n,Bc);l.set({label:s("Width"),class:"ck-table-form__border-width"}),l.fieldView.bind("value").to(this,"borderWidth"),l.bind("isEnabled").to(this,"borderStyle",jE),l.fieldView.on("input",(()=>{this.borderWidth=l.fieldView.element.value}));const c=new Dc(n,i);return c.set({label:s("Color"),class:"ck-table-form__border-color"}),c.fieldView.bind("value").to(this,"borderColor"),c.bind("isEnabled").to(this,"borderStyle",jE),c.fieldView.on("input",(()=>{this.borderColor=c.fieldView.value})),this.on("change:borderStyle",((e,i,n,s)=>{jE(n)||(this.borderColor="",this.borderWidth=""),jE(s)||(this.borderColor=t.color,this.borderWidth=t.width)})),{borderRowLabel:o,borderStyleDropdown:a,borderColorInput:c,borderWidthInput:l}}_createBackgroundFields(){const e=this.locale,t=this.t,i=new Tc(e);i.text=t("Background");const n=LA({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor}),s=new Dc(e,n);return s.set({label:t("Color"),class:"ck-table-properties-form__background"}),s.fieldView.bind("value").to(this,"backgroundColor"),s.fieldView.on("input",(()=>{this.backgroundColor=s.fieldView.value})),{backgroundRowLabel:i,backgroundInput:s}}_createDimensionFields(){const e=this.locale,t=this.t,i=new Tc(e);i.text=t("Dimensions");const n=new Dc(e,Bc);n.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",(()=>{this.width=n.fieldView.element.value}));const s=new cl.Z(e);s.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const o=new Dc(e,Bc);return o.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),o.fieldView.bind("value").to(this,"height"),o.fieldView.on("input",(()=>{this.height=o.fieldView.element.value})),{dimensionsLabel:i,widthInput:n,operatorLabel:s,heightInput:o}}_createAlignmentFields(){const e=this.locale,t=this.t,i=new Tc(e);i.text=t("Alignment");const n=new uc(e);return n.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),MA({view:this,icons:qE,toolbar:n,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:i,alignmentToolbar:n}}_createActionButtons(){const e=this.locale,t=this.t,i=new l.Z(e),n=new l.Z(e),s=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return i.set({label:t("Save"),icon:ol.check,class:"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(s,"errorText",((...e)=>e.every((e=>!e)))),n.set({label:t("Cancel"),icon:ol.cancel,class:"ck-button-cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:n}}get _alignmentLabels(){const e=this.locale,t=this.t,i=t("Align table to the left"),n=t("Center table"),s=t("Align table to the right");return"rtl"===e.uiLanguageDirection?{right:s,center:n,left:i}:{left:i,center:n,right:s}}}function jE(e){return"none"!==e}var KE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const JE=500,YE={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class QE extends a.Z{static get requires(){return[jc]}static get pluginName(){return"TablePropertiesUI"}constructor(e){super(e),e.config.define("table.tableProperties",{borderColors:OA,backgroundColors:OA})}init(){const e=this.editor,t=e.t;this._defaultTableProperties=sE(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(jc),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableProperties",(i=>{const n=new l.Z(i);n.set({label:t("Table properties"),icon:KE,tooltip:!0}),this.listenTo(n,"execute",(()=>this._showView()));const s=Object.values(YE).map((t=>e.commands.get(t)));return n.bind("isEnabled").toMany(s,"isEnabled",((...e)=>e.some((e=>e)))),n}))}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableProperties"),i=Zl(t.borderColors),n=$l(e.locale,i),s=Zl(t.backgroundColors),o=$l(e.locale,s),r=new GE(e.locale,{borderColors:n,backgroundColors:o,defaultTableProperties:this._defaultTableProperties}),a=e.t;r.render(),this.listenTo(r,"submit",(()=>{this._hideView()})),this.listenTo(r,"cancel",(()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()})),r.keystrokes.set("Esc",((e,t)=>{this._hideView(),t()})),Dl({emitter:r,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const l=VA(a),c=IA(a);return r.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle",this._defaultTableProperties.borderStyle)),r.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:r.borderColorInput,commandName:"tableBorderColor",errorText:l,validator:NA,defaultValue:this._defaultTableProperties.borderColor})),r.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:r.borderWidthInput,commandName:"tableBorderWidth",errorText:c,validator:DA,defaultValue:this._defaultTableProperties.borderWidth})),r.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:r.backgroundInput,commandName:"tableBackgroundColor",errorText:l,validator:NA,defaultValue:this._defaultTableProperties.backgroundColor})),r.on("change:width",this._getValidatedPropertyChangeCallback({viewField:r.widthInput,commandName:"tableWidth",errorText:c,validator:RA,defaultValue:this._defaultTableProperties.width})),r.on("change:height",this._getValidatedPropertyChangeCallback({viewField:r.heightInput,commandName:"tableHeight",errorText:c,validator:RA,defaultValue:this._defaultTableProperties.height})),r.on("change:alignment",this._getPropertyChangeCallback("tableAlignment",this._defaultTableProperties.alignment)),r}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(YE).map((([t,i])=>{const n=this._defaultTableProperties[t]||"";return[t,e.get(i).value||n]})).forEach((([e,i])=>{("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&this.view.set(e,i)}))}_showView(){const e=this.editor;this.listenTo(e.ui,"update",(()=>{this._updateView()})),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:YA(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;qA(t.selection)?this._isViewVisible&&JA(e,"table"):this._hideView()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e,t){return(i,n,s,o)=>{(o||t!==s)&&this.editor.execute(e,{value:s,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:i,validator:n,errorText:s,defaultValue:o}=e,r=(0,Si.Z)((()=>{i.errorText=s}),JE);return(e,s,a,l)=>{r.cancel(),(l||o!==a)&&(n(a)?(this.editor.execute(t,{value:a,batch:this._undoStepBatch}),i.errorText=null):r())}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class XE extends a.Z{static get pluginName(){return"TableProperties"}static get requires(){return[$E,QE]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eT extends a.Z{static get requires(){return[Jf]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,i=e.plugins.get(Jf),n=e.config.get("table.contentToolbar"),s=e.config.get("table.tableToolbar");n&&i.register("tableContent",{ariaLabel:t("Table toolbar"),items:n,getRelatedElement:qA}),s&&i.register("table",{ariaLabel:t("Table toolbar"),items:s,getRelatedElement:WA})}}var tT={name:"CustomCKEditor",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1},tagName:{type:String,default:"div"},placeholder:{type:String,default:""},lang:{type:String,default:null},shouldNotGroupWhenFull:{type:Boolean,default:!0},toolbarItems:{type:Array,default:()=>["heading","|","bold","italic","underline","strikethrough","code","codeBlock","subscript","superscript","removeFormat","selectAll","specialCharacters","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","todoList","alignment","|","outdent","indent","|","link","uploadImage","insertTable","mediaEmbed","findAndReplace","|","undo","redo","|","sourceEditing","addBreezeMedias","|","fullScreen"]},imageToolbarItems:{type:Array,default:()=>["imageStyle:inline","imageStyle:block","imageStyle:side","|","toggleImageCaption","imageTextAlternative","|","resizeImage:50","resizeImage:75","resizeImage:original"]},tableContentToolbar:{type:Array,default:()=>["toggleTableCaption","tableColumn","tableRow","mergeTableCells"]}},emits:["update:modelValue","ready","focus","blur","destroy"],data(){return{editor:Ym,editorConfig:{language:this.lang||this.$i18n.locale,placeholder:this.placeholder,plugins:[Tp,vl,hu,vu,Nu,im,Lu,Eu,Uu,Ju,ym,Kf,qw,eb,Fb,zb,uv,db,j_,Ny,fC.Z,nd,gA,eT,AA,XE,VE,pC,wv,zd,jm,Wp,$f,gf,vw,Ky,CC,fp,SC,LC,UC,h,p],toolbar:{items:this.toolbarItems,shouldNotGroupWhenFull:this.shouldNotGroupWhenFull},image:{toolbar:this.imageToolbarItems,resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]},table:{contentToolbar:this.tableContentToolbar}},mediaPickerVisible:!1,STORAGE_API_BASE_URL:f.STORAGE_API_BASE_URL,BASE_URL_MUSTACHE:"{{BASE_URL}}"}},created(){document.addEventListener("add-breeze-medias",this.onAddMediaBtnClick)},beforeUnmount(){document.removeEventListener("add-breeze-medias",this.onAddMediaBtnClick)},methods:{onAddMediaBtnClick(){this.mediaPickerVisible=!0},onMediasSelected(e){if(e){let t=this.modelValue||"";e.forEach((e=>{e.type==w.Tr.IMAGE.value&&(t+=`<p><img src="${this.resolveMediaLink(e.link)}" /></p>`),e.type==w.Tr.DOCUMENT.value&&(t+=`<p><a href="${this.resolveMediaLink(e.link)}">${e.name}</a></p>`),e.type==w.Tr.AUDIO.value&&(t+=`<p style="text-align:center">[audio]${e.name}[/audio]</p>`),e.type==w.Tr.VIDEO.value&&(t+=`<p style="text-align:center">[video]${e.name}[/video]</p>`),e.type==w.Tr.OTHERS.value&&(t+=`<p><a href="${this.resolveMediaLink(e.link)}">${e.name}</a></p>`)})),this.$emit("update:modelValue",t?.replace(new RegExp(f.STORAGE_API_BASE_URL,"g"),this.BASE_URL_MUSTACHE))}this.mediaPickerVisible=!1}}},iT=i(83744);const nT=(0,iT.Z)(tT,[["render",o],["__scopeId","data-v-64323a7e"]]);var sT=nT},71561:function(e,t,i){"use strict";i.d(t,{Z:function(){return y}});var n=i(89948),s=i(82234),o=i(75979);const r=e=>((0,s.pushScopeId)("data-v-725fb0c0"),e=e(),(0,s.popScopeId)(),e),a={class:"picker-container"},l={class:"picker-content"},c={key:0},d={class:"cropper-container"},h={class:"vertical-buttons"},u=r((()=>(0,s.createElementVNode)("br",null,null,-1))),m={class:"preview-container"},g={key:1,class:"text-center"},p={class:"picker-action"},f={class:"dialog-footer"},w={name:"ImageEditor",inheritAttrs:!1};var b=Object.assign(w,{props:{cropperAutoZoom:{type:Boolean,default:!0},cropperScalable:{type:Boolean,default:!1},cropperMovable:{type:Boolean,default:!1},cropperRatio:{type:Number,default:null},roundPreview:{type:Boolean,default:!1},previewWidth:{type:Number,default:null},previewHeight:{type:Number,default:120},src:{type:String,default:null}},emits:["croppedFileChange","save","cancel"],setup(e,{emit:t}){const i=e,{t:r}=(0,n.useI18n)(),w=(0,s.ref)(null),b=(0,s.ref)({coordinates:null,image:null}),v=(0,s.computed)((()=>i.previewWidth?i.previewWidth:b.value&&b.value.coordinates?b.value.coordinates.width/b.value.coordinates.height*i.previewHeight:i.previewHeight)),_=({coordinates:e,image:i})=>{b.value={coordinates:e,image:i};const{canvas:n}=w.value.getResult();t("croppedFileChange",b.value,n.toDataURL())},y=(e,t)=>{w.value.customImageTransforms.rotate%180!==0?w.value.flip(!e,!t):w.value.flip(e,t)},C=e=>{w.value.rotate(e)},k=()=>{const{canvas:e}=w.value.getResult();t("save",b.value,e.toDataURL())};return(e,n)=>{const x=(0,s.resolveComponent)("font-awesome-icon"),A=(0,s.resolveComponent)("n-alert"),E=(0,s.resolveComponent)("n-button");return(0,s.openBlock)(),(0,s.createElementBlock)("div",a,[(0,s.createElementVNode)("div",l,[i.src?((0,s.openBlock)(),(0,s.createElementBlock)("div",c,[(0,s.createElementVNode)("div",d,[(0,s.createVNode)((0,s.unref)(o.Cropper),{ref_key:"cropper",ref:w,class:"cropper",src:i.src,"auto-zoom":i.cropperAutoZoom,"stencil-props":{movable:i.cropperMovable,scalable:i.cropperScalable,aspectRatio:i.cropperRatio,previewClass:i.roundPreview?"circle-stencil-preview":""},"image-restriction":"stencil","background-class":"cropper-background","stencil-component":i.roundPreview?(0,s.unref)(o.CircleStencil):(0,s.unref)(o.RectangleStencil),onChange:_},null,8,["src","auto-zoom","stencil-props","stencil-component"]),(0,s.createElementVNode)("div",h,[(0,s.createElementVNode)("div",{class:"square-button",title:"Flip Horizontal",onClick:n[0]||(n[0]=e=>y(!0,!1))},[(0,s.createVNode)(x,{icon:["fas","arrows-alt-h"],size:"1x",style:{color:"white"}})]),(0,s.createElementVNode)("div",{class:"square-button",title:"Flip Vertical",onClick:n[1]||(n[1]=e=>y(!1,!0))},[(0,s.createVNode)(x,{icon:["fas","arrows-alt-v"],size:"1x",style:{color:"white"}})]),(0,s.createElementVNode)("div",{class:"square-button",title:"Rotate Clockwise",onClick:n[2]||(n[2]=e=>C(90))},[(0,s.createVNode)(x,{icon:["fas","redo"],size:"1x",style:{color:"white"}})]),(0,s.createElementVNode)("div",{class:"square-button",title:"Rotate Counter-Clockwise",onClick:n[3]||(n[3]=e=>C(-90))},[(0,s.createVNode)(x,{icon:["fas","undo"],size:"1x",style:{color:"white"}})])])]),u,(0,s.createElementVNode)("div",m,[(0,s.createVNode)((0,s.unref)(o.Preview),{ref:"preview",class:(0,s.normalizeClass)(["preview",{round:i.roundPreview}]),image:(0,s.unref)(b).image,width:(0,s.unref)(v),height:i.previewHeight,coordinates:(0,s.unref)(b).coordinates},null,8,["image","width","height","class","coordinates"])])])):((0,s.openBlock)(),(0,s.createElementBlock)("div",g,[(0,s.createVNode)(A,{title:(0,s.unref)(r)("noSrcFileWarning"),type:"warning","show-icon":""},null,8,["title"])])),(0,s.createElementVNode)("div",p,[(0,s.createElementVNode)("span",f,[(0,s.createVNode)(E,{onClick:n[4]||(n[4]=e=>t("cancel"))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)((0,s.unref)(r)("close")),1)])),_:1}),i.src?((0,s.openBlock)(),(0,s.createBlock)(E,{key:0,type:"primary",onClick:n[5]||(n[5]=e=>k())},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)((0,s.unref)(r)("save")),1)])),_:1})):(0,s.createCommentVNode)("",!0)])])])])}}}),v=i(83744);const _=(0,v.Z)(b,[["__scopeId","data-v-725fb0c0"]]);var y=_},68716:function(e,t,i){"use strict";i.d(t,{Z:function(){return ce}});var n=i(82234);function s(e,t,i,s,o,r){const a=(0,n.resolveComponent)("el-button"),l=(0,n.resolveComponent)("el-col"),c=(0,n.resolveComponent)("el-input"),d=(0,n.resolveComponent)("el-row"),h=(0,n.resolveComponent)("el-card");return(0,n.openBlock)(),(0,n.createBlock)(h,null,{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(o.items,((s,h)=>((0,n.openBlock)(),(0,n.createBlock)(d,{key:h,gutter:10,class:"mb-10 urls-container"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{span:2},{default:(0,n.withCtx)((()=>[i.multiple?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,type:"primary",disabled:0===h&&i.multiple&&i.limit>0&&o.items.length>=i.limit,icon:0===h?"plus":"minus",onClick:e=>r.manageItems(h)},null,8,["disabled","icon","onClick"])):(0,n.createCommentVNode)("",!0)])),_:2},1024),(0,n.createVNode)(l,{span:20},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{modelValue:s.url,"onUpdate:modelValue":e=>s.url=e,placeholder:e.$t("insertLink"),style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1024),(0,n.createVNode)(l,{span:2},{default:(0,n.withCtx)((()=>[0===h?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,type:"primary",disabled:!r.isUrlsValid,onClick:t[0]||(t[0]=e=>r.validate())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("validate")),1)])),_:1},8,["disabled"])):(0,n.createCommentVNode)("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})}i(57658);var o=i(14340),r={name:"AddFromAnUrl",props:{multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},acceptImages:{type:Boolean,default:!0},acceptVideos:{type:Boolean,default:!0},acceptAudios:{type:Boolean,default:!0},acceptDocuments:{type:Boolean,default:!0},acceptOtherTypes:{type:Boolean,default:!0}},emits:["validate"],data(){return{items:[{url:"http://"}],docExtList:["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],vidExtList:["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"],audExtList:["MP3","WAV","M4A","WMA","AAC","FLAC"]}},computed:{isUrlsValid(){const e=this.items.filter((e=>e.url&&this.$validator.isURL(e.url)));return e.length===this.items.length}},methods:{manageItems(e){e>0?this.items.splice(e,1):this.items.push({url:"http://"})},getFileTypeByUrl(e){const t=e.split(".").pop();if(t){if(this.docExtList.includes(t.toUpperCase()))return o.Tr.DOCUMENT.value;if(this.vidExtList.includes(t.toUpperCase()))return o.Tr.VIDEO.value;if(this.imgExtList.includes(t.toUpperCase()))return o.Tr.IMAGE.value;if(this.audExtList.includes(t.toUpperCase()))return o.Tr.AUDIO.value}return o.Tr.OTHERS.value},validate(){if(this.isUrlsValid){let e=!0;const t=[];for(let i=0;i<this.items.length;i++){const n=this.getFileTypeByUrl(this.items[i].url),s=!this.acceptImages&&n==o.Tr.IMAGE.value||!this.acceptVideos&&n==o.Tr.VIDEO.value||!this.acceptAudios&&n==o.Tr.AUDIO.value||!this.acceptDocuments&&n==o.Tr.DOCUMENT.value||!this.acceptOtherTypes&&n==o.Tr.OTHERS.value;s&&this.$message.error(this.$t("fileFormatNotAllowed",[this.items[i].url])),e&&s&&(e=!1),t.push(this.items[i].url)}if(!e)return;this.$emit("validate",this.multiple?t:t[0],this.multiple)}}}},a=i(83744);const l=(0,a.Z)(r,[["render",s],["__scopeId","data-v-47880409"]]);var c=l,d=i(71561),h=i(39494);const u={class:"text-left"},m={class:"text-right"},g={key:0,class:"mt-5 text-center"},p={class:"item-selector"},f={class:"image-slot"},w={key:1,class:"item-doc"},b={class:"item-doc-center"},v={class:"item-doc-footer"},_={key:2,class:"item-aud"},y={class:"item-aud-center"},C={class:"item-aud-footer"},k={key:3,class:"item-vid"},x={class:"item-vid-center"},A={class:"item-vid-footer"},E={key:4,class:"item-oth"},T={class:"item-oth-center"},P={class:"item-oth-footer"},S={class:"text-center"},V={key:1,class:"no-medias-container mt-5"},I={class:"text-center"},N={class:"text-left item-actions-container"},R={class:"text-center"},D={id:"music",preload:"all",autoplay:"",controls:"",style:{width:"100%"}},B=["src"],M={id:"video",autoplay:"",controls:"",style:{width:"100%"}},O=["src"],L={class:"dialog-footer"};function F(e,t,i,s,o,r){const a=(0,n.resolveComponent)("el-option"),l=(0,n.resolveComponent)("el-select"),c=(0,n.resolveComponent)("el-input"),F=(0,n.resolveComponent)("el-col"),z=(0,n.resolveComponent)("el-button"),$=(0,n.resolveComponent)("el-row"),Z=(0,n.resolveComponent)("el-card"),H=(0,n.resolveComponent)("loading"),U=(0,n.resolveComponent)("el-icon"),W=(0,n.resolveComponent)("el-checkbox"),q=(0,n.resolveComponent)("Picture"),G=(0,n.resolveComponent)("el-image"),j=(0,n.resolveComponent)("font-awesome-icon"),K=(0,n.resolveComponent)("infinite-loading"),J=h.Z,Y=(0,n.resolveComponent)("el-divider"),Q=(0,n.resolveComponent)("el-table-column"),X=(0,n.resolveComponent)("el-table"),ee=(0,n.resolveComponent)("el-image-viewer"),te=(0,n.resolveComponent)("el-dialog"),ie=d.Z;return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(Z,{shadow:"never",class:"mb-10 header-card"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)($,{align:"middle"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(F,{span:16},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",u,[(0,n.createVNode)(l,{modelValue:o.mediaType,"onUpdate:modelValue":t[0]||(t[0]=e=>o.mediaType=e),placeholder:e.$t("mediaType"),style:{width:"165px"},class:"mr-10"},{default:(0,n.withCtx)((()=>[i.showImages&&i.showVideos&&i.showAudios&&i.showDocuments&&i.showOtherTypes?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,label:e.$t("allMedias"),value:0},null,8,["label"])):(0,n.createCommentVNode)("",!0),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(o.mediaTypes,(e=>((0,n.openBlock)(),(0,n.createBlock)(a,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder"]),(0,n.createVNode)(l,{modelValue:o.mediaDate,"onUpdate:modelValue":t[1]||(t[1]=e=>o.mediaDate=e),style:{width:"165px"},class:"mr-10"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(a,{label:e.$t("allDates"),value:0},null,8,["label"]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(o.mediaDates,(e=>((0,n.openBlock)(),(0,n.createBlock)(a,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,n.createVNode)(c,{modelValue:o.mediaSearch,"onUpdate:modelValue":t[2]||(t[2]=e=>o.mediaSearch=e),class:"mr-10",style:{width:"185px"},placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])])),_:1}),(0,n.createVNode)(F,{span:8},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",m,[(0,n.createVNode)(z,{size:"default",icon:"refresh-right",onClick:t[3]||(t[3]=e=>r.reset())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("reload")),1)])),_:1}),(0,n.createVNode)(z,{class:"ml-10",size:"default",type:"primary",icon:"check",disabled:!o.selectedMedias.length,onClick:t[4]||(t[4]=e=>r.validate())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("validateSelection")),1)])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1}),(0,n.createVNode)($,{gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(F,{span:16},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Z,{shadow:"never",class:"medias-card"},{default:(0,n.withCtx)((()=>[o.isLoading?((0,n.openBlock)(),(0,n.createElementBlock)("div",g,[(0,n.createVNode)(U,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(H)])),_:1},8,["color"])])):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[r.filteredMedias&&r.filteredMedias.length>0?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)($,{gutter:10,class:"mt-5"},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(r.filteredMedias,((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(F,{key:i,span:4,class:"mb-10 item-container",onClick:e=>r.updateSelectedMedias(t,i)},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",p,[(0,n.createVNode)(W,{size:"default","model-value":o.selectedMedias.findIndex((e=>e.id===t.id))>-1,onChange:e=>r.updateSelectedMedias(t,i)},null,8,["model-value","onChange"])]),t.type==o.MediaTypes.IMAGE.value?((0,n.openBlock)(),(0,n.createBlock)(G,{key:0,class:"item-img",src:e.resolveMediaLink(t.link),fit:"cover"},{error:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",f,[(0,n.createVNode)(U,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(q)])),_:1})])])),_:2},1032,["src"])):t.type==o.MediaTypes.DOCUMENT.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",w,[(0,n.createElementVNode)("div",b,[(0,n.createVNode)(j,{icon:"file",class:"item-doc-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",v,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])])):t.type==o.MediaTypes.AUDIO.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",_,[(0,n.createElementVNode)("div",y,[(0,n.createVNode)(j,{icon:"music",class:"item-aud-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",C,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])])):t.type==o.MediaTypes.VIDEO.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",k,[(0,n.createElementVNode)("div",x,[(0,n.createVNode)(j,{icon:"video",class:"item-vid-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",A,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])])):((0,n.openBlock)(),(0,n.createElementBlock)("div",E,[(0,n.createElementVNode)("div",T,[(0,n.createVNode)(j,{icon:"question-circle",class:"item-oth-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",P,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])]))])),_:2},1032,["onClick"])))),128))])),_:1}),(0,n.createVNode)(K,{onInfinite:r.infiniteHandler},{"no-more":(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("noOtherMediaFound")),1)])),"no-results":(0,n.withCtx)((()=>[(0,n.createTextVNode)(".")])),spinner:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",S,[(0,n.createVNode)(U,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(H)])),_:1},8,["color"])])])),error:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("somethingWrong"))+". ",1),(0,n.createElementVNode)("a",{href:"javascript:;",onClick:t[5]||(t[5]=t=>e.location.reload())},(0,n.toDisplayString)(e.$t("retry")),1)])),_:1},8,["onInfinite"])],64)):((0,n.openBlock)(),(0,n.createElementBlock)("div",V,[(0,n.createElementVNode)("div",I,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.$t("noMediaFound")),1)])]))],64))])),_:1})])),_:1}),(0,n.createVNode)(F,{span:8},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Z,{shadow:"never",class:"media-info-card"},{default:(0,n.withCtx)((()=>[o.detailsData.length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createElementVNode)("div",N,[(0,n.createVNode)(z,{icon:"view",size:"small",type:"primary",onClick:t[6]||(t[6]=e=>r.showPreview(o.currentItem,o.currentItemIndex))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("preview")),1)])),_:1}),(0,n.createVNode)(J,{"to-copy":e.resolveMediaLink(o.currentItem.link),class:"link-copy-btn",onCopy:r.copyLink},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(z,{icon:"link",size:"small",type:"success"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("copyLink")),1)])),_:1})])),_:1},8,["to-copy","onCopy"]),o.currentItem.type==o.MediaTypes.IMAGE.value?((0,n.openBlock)(),(0,n.createBlock)(z,{key:0,icon:"edit",size:"small",type:"warning",onClick:t[7]||(t[7]=e=>o.imageEditorVisible=!0)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("edit")),1)])),_:1})):(0,n.createCommentVNode)("",!0)]),(0,n.createVNode)(Y),(0,n.createVNode)(X,{data:o.detailsData,"show-header":!1,stripe:"",size:"default",style:{width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Q,{prop:"name",label:"",width:"100"}),(0,n.createVNode)(Q,{prop:"value",label:""})])),_:1},8,["data"]),(0,n.createVNode)(Y),(0,n.createElementVNode)("div",R,[(0,n.createVNode)(z,{icon:"delete",size:"default",type:"danger",onClick:t[8]||(t[8]=e=>r.deleteItem())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("delete")),1)])),_:1})])],64)):(0,n.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),o.showViewer?((0,n.openBlock)(),(0,n.createBlock)(ee,{key:0,infinite:!1,"hide-on-click-modal":!0,"url-list":r.filteredMediaLinks,"initial-index":o.currentItemIndex,onClose:t[9]||(t[9]=e=>o.showViewer=!1)},null,8,["url-list","initial-index"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(te,{modelValue:o.showAudioReaderDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>o.showAudioReaderDialog=e),width:"35%","show-close":"","destroy-on-close":"",title:o.currentItem?o.currentItem.name:"",top:"30vh"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("audio",D,[(0,n.createElementVNode)("source",{src:e.resolveMediaLink(o.currentItem.link)},null,8,B)])])),_:1},8,["modelValue","title"]),(0,n.createVNode)(te,{modelValue:o.showVideoReaderDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>o.showVideoReaderDialog=e),width:"45%","show-close":"","destroy-on-close":"",title:o.currentItem?o.currentItem.name:"",top:"10vh"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("video",M,[(0,n.createElementVNode)("source",{src:e.resolveMediaLink(o.currentItem.link)},null,8,O)])])),_:1},8,["modelValue","title"]),(0,n.createVNode)(te,{modelValue:o.imageEditorVisible,"onUpdate:modelValue":t[17]||(t[17]=e=>o.imageEditorVisible=e),"destroy-on-close":"",top:"1vh"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(ie,{"cropper-ratio":null,"round-preview":!1,src:o.currentItem?e.resolveMediaLink(o.currentItem.link):null,onCancel:t[12]||(t[12]=e=>o.imageEditorVisible=!1),onSave:r.storeEditedPicture},null,8,["src","onSave"]),(0,n.createVNode)(te,{modelValue:o.imageEditorConfirmVisible,"onUpdate:modelValue":t[16]||(t[16]=e=>o.imageEditorConfirmVisible=e),width:"50%",title:e.$t("confirmation"),"append-to-body":""},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("span",L,[(0,n.createVNode)(z,{size:"default",onClick:t[13]||(t[13]=e=>o.imageEditorConfirmVisible=!1)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,n.createVNode)(z,{type:"primary",size:"default",onClick:t[14]||(t[14]=e=>r.saveEditedPicture(!1))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("saveNewFile")),1)])),_:1}),(0,n.createVNode)(z,{type:"danger",size:"default",onClick:t[15]||(t[15]=e=>r.saveEditedPicture(!0))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("overwriteExistingFile")),1)])),_:1})])])),default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("whatDoYouWantToDo"))+" ",1)])),_:1},8,["modelValue","title"])])),_:1},8,["modelValue"])],64)}var z=i(39355),$=i(11165),Z=i(92829),H=i(98761),U=i(64713),W=i(21101),q={name:"MediaLibrary",mixins:[H.Z],props:{multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},showImages:{type:Boolean,default:!0},showVideos:{type:Boolean,default:!0},showAudios:{type:Boolean,default:!0},showDocuments:{type:Boolean,default:!0},showOtherTypes:{type:Boolean,default:!0},baseUrl:{type:String,default:$.STORAGE_API_BASE_URL},folder:{type:String,default:"medias"},initSelectedMedias:{type:Array,default:null}},emits:["validate"],data(){return{MediaTypes:o.Tr,users:[],medias:[],mediaDate:0,mediaType:0,mediaTypes:[],mediaDates:[],detailsData:[],mediaSearch:"",isLoading:!0,showViewer:!1,currentItem:null,lastMediaRowId:0,selectedMedias:[],currentItemIndex:0,imageEditorVisible:!1,currentEditorDataUrl:null,showAudioReaderDialog:!1,showVideoReaderDialog:!1,imageEditorConfirmVisible:!1}},computed:{filteredMedias(){let e=[];const t=this.medias.filter((e=>0==this.mediaType||e.type==this.mediaType));e=this.mediaSearch?t.filter((e=>e.name.toLowerCase().includes(this.mediaSearch.toLowerCase()))):t;const i=e.filter((e=>0==this.mediaDate||this.extractDatetimeMonthYear(e.insert_datetime)==this.mediaDate));return i},filteredMediaLinks(){const e=[];return this.filteredMedias.forEach((t=>{t.type==o.Tr.IMAGE.value&&e.push(this.resolveMediaLink(t.link))})),e}},watch:{medias:{handler(e,t){this.loadMediaDates()},deep:!0}},created(){this.$_.forIn(o.Tr,((e,t)=>{this.showImages&&e.value==o.Tr.IMAGE.value&&this.mediaTypes.push(e),this.showAudios&&e.value==o.Tr.AUDIO.value&&this.mediaTypes.push(e),this.showVideos&&e.value==o.Tr.VIDEO.value&&this.mediaTypes.push(e),this.showOtherTypes&&e.value==o.Tr.OTHERS.value&&this.mediaTypes.push(e),this.showDocuments&&e.value==o.Tr.DOCUMENT.value&&this.mediaTypes.push(e)})),this.mediaType=this.showImages&&this.showVideos&&this.showAudios&&this.showDocuments&&this.showOtherTypes?0:this.mediaTypes[0].value,this.init()},methods:{...(0,W.mapActions)("media",["getMediasPage","deleteMedia","generateThumbnail"]),...(0,W.mapActions)("user",["getAllUsers"]),async init(){const e=await this.getAllUsers();e.data&&(this.users=e.data);let t=null;const i=await this.getMediasPage({offset:this.lastMediaRowId,limit:18});return i.success&&i.data?(t=i.data,this.lastMediaRowId+=t.length,this.medias.push(...t),t.forEach((e=>{this.initSelectedMedias&&this.initSelectedMedias.includes(e.link)&&this.selectedMedias.push(e)}))):this.$message.error(this.$t("anErrorOccured")),this.isLoading&&(this.isLoading=!1),t?t.length:0},async infiniteHandler(e){const t=await this.init();t>0?e.loaded():e.complete()},loadMediaDates(){this.mediaDates=[],this.medias.forEach((e=>{const t=this.extractDatetimeMonthYear(e.insert_datetime);this.mediaDates.includes(t)||this.mediaDates.push(t)}))},extractDatetimeMonthYear(e){if(!e)return"";let t=(0,z.bK)(e.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale});return t=t.split(" "),(0,Z.fm)(t[1])+" "+t[2]},showPreview(e,t){this.currentItem=e,this.currentItemIndex=t,e.type==o.Tr.IMAGE.value&&(this.showViewer=!0),e.type==o.Tr.DOCUMENT.value&&window.open(this.resolveMediaLink(e.link)),e.type==o.Tr.AUDIO.value&&(this.showAudioReaderDialog=!0),e.type==o.Tr.VIDEO.value&&(this.showVideoReaderDialog=!0),e.type==o.Tr.OTHERS.value&&this.$message.warning(this.$t("cannotOpenThisFile"))},loadDetails(e,t){this.currentItem=e,this.currentItemIndex=t;const i=this.mediaTypes.find((t=>t.value==e.type)),n=(0,z.bK)(e.insert_datetime.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale}),s=this.users.find((t=>t.id==e.sender));if(this.detailsData=[{name:this.$t("name"),value:e.name},{name:this.$t("url"),value:this.resolveMediaLink(e.link)},{name:this.$t("type"),value:i?i.label:""},{name:this.$t("size"),value:(0,Z.gB)(e.size,!0)},{name:this.$t("mimeType"),value:e.mime},{name:this.$t("sentBy"),value:s?s.name:""},{name:this.$t("date"),value:n}],e.type==o.Tr.IMAGE.value){var r=new Image;r.onload=()=>{const e=r.naturalHeight,t=r.naturalWidth;t&&e&&this.detailsData.length&&this.detailsData.push({name:this.$t("dimensions"),value:t+" x "+e})},r.src=this.resolveMediaLink(e.link)}},async reset(){this.isLoading=!0,this.medias=[],this.detailsData=[],this.selectedMedias=[],this.lastMediaRowId=0,await this.init()},copyLink(e,t){t&&this.$message.success(this.$t("mediaLinkCopied"))},updateSelectedMedias(e,t){const i=this.selectedMedias.findIndex((t=>t.id===e.id));i>-1?(this.selectedMedias.splice(i,1),this.detailsData=[]):(this.multiple?this.selectedMedias.push(e):this.selectedMedias=[e],this.loadDetails(e,t))},deleteItem(){this.$confirm(this.$t("deleteMediaQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteMedia({id:this.currentItem.id});e.success?(this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},validate(){this.$emit("validate",this.multiple?this.selectedMedias:this.selectedMedias[0],this.multiple)},storeEditedPicture(e,t){this.currentEditorDataUrl=t,this.imageEditorConfirmVisible=!0},async saveEditedPicture(e){if(this.currentEditorDataUrl){var t=(0,Z.Bo)(this.currentEditorDataUrl,{filename:this.$uuidv4()+".png",type:"image/png"});this.compressImages&&(t=await(0,Z.hv)(t,{maxSizeMB:this.compressThreshold}));const n=e?this.currentItem.name:t.name,s=new FormData;s.append("folder",this.folder),s.append("overwrite",e),s.append("file",t,n);try{const i=await this.axios.post(this.baseUrl,s,{headers:$.API_REQUEST_HEADERS});i.data&&"success"==i.data["status"]?(e&&await this.deleteMedia({id:this.currentItem.id}),await this.addItemInDB({context:U.R,data:{name:n,link:"root/"+this.folder+"/"+n,type:o.Tr.IMAGE.value,size:t.size||0,mime:t.type||"",sender:this.userData.id}}),await this.generateThumbnail({autoWidth:this.thumbnailsFormat==o.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==o.vh.AUTOHEIGHT.value,folder:this.folder,file:n,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))}),this.imageEditorConfirmVisible=!1,this.imageEditorVisible=!1,await this.reset()):this.$message.error(this.$t("anErrorOccured"))}catch(i){this.$message.error(this.$t("anErrorOccured"))}}}}};const G=(0,a.Z)(q,[["render",F],["__scopeId","data-v-0bb993f2"]]);var j=G;const K={class:"text-right"},J={class:"mr-10"},Y={class:"mr-5"},Q={key:0,class:"mb-10"},X={key:0,class:"text-left"},ee={class:"text-right"},te={class:"el-upload__text mt-10"};function ie(e,t,i,s,o,r){const a=(0,n.resolveComponent)("el-switch"),l=(0,n.resolveComponent)("el-button"),c=(0,n.resolveComponent)("el-col"),d=(0,n.resolveComponent)("el-row"),h=(0,n.resolveComponent)("el-card"),u=(0,n.resolveComponent)("el-progress"),m=(0,n.resolveComponent)("UploadFilled"),g=(0,n.resolveComponent)("el-icon"),p=(0,n.resolveComponent)("el-upload");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[o.fileList&&o.fileList.length?((0,n.openBlock)(),(0,n.createBlock)(h,{key:0,class:"mb-10 header-card",shadow:"never"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{span:24},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",K,[(0,n.createElementVNode)("span",J,[(0,n.createElementVNode)("b",Y,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.$t("overwriteDuplicateFiles")),1)]),(0,n.createVNode)(a,{modelValue:o.overwrite,"onUpdate:modelValue":t[0]||(t[0]=e=>o.overwrite=e),"active-color":e.appPrimaryColor,size:"default"},null,8,["modelValue","active-color"])]),(0,n.createVNode)(l,{size:"default",icon:"close",disabled:o.isUploading,class:"ml-10",onClick:t[1]||(t[1]=e=>r.clearFileList())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("clearList")),1)])),_:1},8,["disabled"]),(0,n.createVNode)(l,{size:"default",type:"primary",icon:"upload",disabled:o.isUploading,onClick:t[2]||(t[2]=e=>r.send())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("send")+" ("+o.fileList.length+")"),1)])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1})):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(h,{shadow:"never"},{default:(0,n.withCtx)((()=>[o.isUploading?((0,n.openBlock)(),(0,n.createElementBlock)("div",Q,[(0,n.createVNode)(d,{gutter:10,class:"mb-10"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{span:12},{default:(0,n.withCtx)((()=>[o.uploadedFileName?((0,n.openBlock)(),(0,n.createElementBlock)("div",X,(0,n.toDisplayString)(e.$t("sendingInProgress")+": "+o.uploadedFileName),1)):(0,n.createCommentVNode)("",!0)])),_:1}),(0,n.createVNode)(c,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",ee,(0,n.toDisplayString)(o.uploadedList.length+o.failedList.length+" / "+o.fileList.length),1)])),_:1})])),_:1}),(0,n.createVNode)(u,{percentage:o.percentage,format:r.format},null,8,["percentage","format"])])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(p,{ref:"upload",class:"upload-box","auto-upload":!1,"file-list":o.fileList,"on-change":r.handleChange,"on-remove":r.handleChange,headers:i.headers,action:i.baseUrl,multiple:"",drag:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(g,{class:"upload-icon",size:64},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(m)])),_:1}),(0,n.createElementVNode)("div",te,(0,n.toDisplayString)(e.$t("uploadFilesOrClickToSend")),1)])),_:1},8,["file-list","on-change","on-remove","headers","action"])])),_:1})],64)}var ne={name:"UploadFiles",mixins:[H.Z],props:{folder:{type:String,default:"medias"},maxUploadSize:{type:Number,default:256},baseUrl:{type:String,default:$.STORAGE_API_BASE_URL},headers:{type:Object,default:$.API_REQUEST_HEADERS},acceptImages:{type:Boolean,default:!0},acceptVideos:{type:Boolean,default:!0},acceptAudios:{type:Boolean,default:!0},acceptDocuments:{type:Boolean,default:!0},acceptOtherTypes:{type:Boolean,default:!0}},data(){return{fileList:[],percentage:0,failedList:[],uploadedList:[],overwrite:!0,isUploading:!1,uploadedFileName:"",docExtList:["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],vidExtList:["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"],audExtList:["MP3","WAV","M4A","WMA","AAC","FLAC"]}},computed:{acceptedExtensions(){const e=[];return this.acceptImages&&this.acceptAudios&&this.acceptVideos&&this.acceptDocuments&&this.acceptOtherTypes?"*":(this.acceptImages&&this.imgExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptAudios&&this.audExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptVideos&&this.vidExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptDocuments&&this.docExtList.forEach((t=>{e.push("."+t.toLowerCase())})),e.join(", "))}},methods:{...(0,W.mapActions)("media",["generateThumbnail"]),format(e){return 100===e?this.$t("completed"):`${e}%`},handleChange(e,t){this.fileList=t},getFileTypeByName(e){const t=e.split(".").pop();if(t){if(this.docExtList.includes(t.toUpperCase()))return o.Tr.DOCUMENT.value;if(this.vidExtList.includes(t.toUpperCase()))return o.Tr.VIDEO.value;if(this.imgExtList.includes(t.toUpperCase()))return o.Tr.IMAGE.value;if(this.audExtList.includes(t.toUpperCase()))return o.Tr.AUDIO.value}return o.Tr.OTHERS.value},async send(){let e=!0;for(let n=0;n<this.fileList.length;n++){const t=this.fileList[n].size/1024/1024<this.maxUploadSize;t||(e=!1,this.$message.error(this.$t("uploadFileSizeWarning",[this.fileList[n].name,this.maxUploadSize])));const i=this.getFileTypeByName(this.fileList[n].name),s=!this.acceptImages&&i==o.Tr.IMAGE.value||!this.acceptVideos&&i==o.Tr.VIDEO.value||!this.acceptAudios&&i==o.Tr.AUDIO.value||!this.acceptDocuments&&i==o.Tr.DOCUMENT.value||!this.acceptOtherTypes&&i==o.Tr.OTHERS.value;s&&this.$message.error(this.$t("fileFormatNotAllowed",[this.fileList[n].name])),e&&s&&(e=!1)}if(e){this.isUploading=!0;for(let e=0;e<this.fileList.length;e++){const n=this.fileList[e].name;var t=this.fileList[e].raw;this.compressImages&&(t=await(0,Z.hv)(t,{maxSizeMB:this.compressThreshold}));const s=new FormData;s.append("folder",this.folder),s.append("overwrite",this.overwrite),s.append("file",t,n);try{this.percentage=0,this.uploadedFileName=this.fileList[e].name;const i=await this.axios.post(this.baseUrl,s,{headers:this.headers,onUploadProgress:e=>{null!==e.total&&(this.percentage=Math.round(100*e.loaded/e.total))}});i.data&&"success"==i.data["status"]?(this.uploadedList.push(this.fileList[e].name),await this.addItemInDB({context:U.R,data:{name:n,link:"root/"+this.folder+"/"+n,type:this.getFileTypeByName(n),size:t.size||0,mime:t.type||"",sender:this.userData.id}}),this.getFileTypeByName(n)==o.Tr.IMAGE.value&&await this.generateThumbnail({autoWidth:this.thumbnailsFormat==o.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==o.vh.AUTOHEIGHT.value,folder:this.folder,file:n,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))})):i.data&&"exists"==i.data["status"]?(this.failedList.push(this.fileList[e].name),this.$message({type:"error",duration:5e3,showClose:!0,message:this.$t("fileExistsError",[this.fileList[e].name])})):(this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name])))}catch(i){this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name]))}this.uploadedFileName=""}setTimeout((()=>{this.$message({showClose:!0,duration:5e3,message:this.$t("sendingCompleted",[this.uploadedList.length,this.failedList.length])}),this.clearFileList(),this.isUploading=!1}),1e3)}},clearFileList(){this.fileList=[],this.failedList=[],this.uploadedList=[]}}};const se=(0,a.Z)(ne,[["render",ie],["__scopeId","data-v-66d0394a"]]);var oe=se;function re(e,t,i,s,o,r){const a=oe,l=(0,n.resolveComponent)("el-tab-pane"),d=j,h=c,u=(0,n.resolveComponent)("el-tabs");return(0,n.openBlock)(),(0,n.createBlock)(u,{modelValue:o.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>o.tab=e),type:"card",onTabClick:r.handleClick},{default:(0,n.withCtx)((()=>[i.enableUploadFiles?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,label:e.$t("uploadFiles"),name:"1"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(a,{"max-upload-size":i.uploadConfig.maxUploadSize,"base-url":i.uploadConfig.baseUrl,folder:i.uploadConfig.folder,"accept-images":i.displayImages,"accept-videos":i.displayVideos,"accept-audios":i.displayAudios,"accept-documents":i.displayDocuments,"accept-other-types":i.displayOtherTypes},null,8,["max-upload-size","base-url","folder","accept-images","accept-videos","accept-audios","accept-documents","accept-other-types"])])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0),i.enableMediaLibrary?((0,n.openBlock)(),(0,n.createBlock)(l,{key:1,label:e.$t("mediaLibrary"),name:"2"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{limit:i.limit,multiple:i.multiple,"show-images":i.displayImages,"show-videos":i.displayVideos,"show-audios":i.displayAudios,"show-documents":i.displayDocuments,"show-other-types":i.displayOtherTypes,"init-selected-medias":i.initSelectedMedias,onValidate:r.validateSelection},null,8,["limit","multiple","show-images","show-videos","show-audios","show-documents","show-other-types","init-selected-medias","onValidate"])])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0),i.enableAddFromAnUrl?((0,n.openBlock)(),(0,n.createBlock)(l,{key:2,label:e.$t("addFromAnUrl"),name:"3"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(h,{limit:i.limit,multiple:i.multiple,"accept-images":i.displayImages,"accept-videos":i.displayVideos,"accept-audios":i.displayAudios,"accept-documents":i.displayDocuments,"accept-other-types":i.displayOtherTypes,onValidate:r.validateLinks},null,8,["limit","multiple","accept-images","accept-videos","accept-audios","accept-documents","accept-other-types","onValidate"])])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0)])),_:1},8,["modelValue","onTabClick"])}var ae={name:"MediaPicker",components:{UploadFiles:oe,MediaLibrary:j,AddFromAnUrl:c},props:{enableUploadFiles:{type:Boolean,default:!0},enableMediaLibrary:{type:Boolean,default:!0},enableAddFromAnUrl:{type:Boolean,default:!0},displayImages:{type:Boolean,default:!0},displayVideos:{type:Boolean,default:!0},displayAudios:{type:Boolean,default:!0},displayDocuments:{type:Boolean,default:!0},displayOtherTypes:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},uploadConfig:{type:Object,default:()=>({folder:"medias",maxUploadSize:256,baseUrl:$.STORAGE_API_BASE_URL})},currentTab:{type:String,default:"2"},initSelectedMedias:{type:Array,default:null},enableSelectionDetails:{type:Boolean,default:!1}},emits:["selected"],data(){return{tab:this.currentTab}},methods:{handleClick(){},validateSelection(e,t){if(t){const t=[];e.forEach((e=>{this.enableSelectionDetails?t.push(e):t.push(e.link)})),this.$emit("selected",t)}else this.$emit("selected",this.enableSelectionDetails?e:e.link)},validateLinks(e,t){t?this.$emit("selected",e):this.$emit("selected",e[0])}}};const le=(0,a.Z)(ae,[["render",re],["__scopeId","data-v-ce9c6404"]]);var ce=le},12670:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var n=i(31377),s=i(82234);const o={style:{float:"left"}},r={style:{float:"left"}};function a(e,t,i,a,l,c){const d=(0,s.resolveComponent)("country-flag"),h=(0,s.resolveComponent)("el-option"),u=(0,s.resolveComponent)("el-select"),m=(0,s.resolveComponent)("el-col"),g=n.Z,p=(0,s.resolveComponent)("el-input"),f=(0,s.resolveComponent)("el-row");return i.reverse?((0,s.openBlock)(),(0,s.createBlock)(f,{key:0,gutter:2,style:{width:"100%"}},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(m,{span:i.selectorSpan},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(u,{modelValue:l.langCode,"onUpdate:modelValue":t[0]||(t[0]=e=>l.langCode=e),size:i.size,style:{width:"100%"},placeholder:e.$t("code"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,s.createSlots)({default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.langList,(e=>((0,s.openBlock)(),(0,s.createBlock)(h,{key:e.code,value:e.code,label:i.displayCode?e.code:" "},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",o," [ "+(0,s.toDisplayString)(e.code)+" ] "+(0,s.toDisplayString)(e.label),1)])),_:2},1032,["value","label"])))),128))])),_:2},[i.displayFlag?{name:"prefix",fn:(0,s.withCtx)((()=>[(0,s.createVNode)(d,{iso:l.langCode.replace("EN","GB"),class:"ml-5 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","size","placeholder","no-data-text","no-match-text"])])),_:1},8,["span"]),(0,s.createVNode)(m,{span:24-i.selectorSpan},{default:(0,s.withCtx)((()=>["editor"==i.type?((0,s.openBlock)(),(0,s.createBlock)(g,{key:0,modelValue:c.content,"onUpdate:modelValue":t[1]||(t[1]=e=>c.content=e),style:(0,s.normalizeStyle)(i.inputStyles),placeholder:i.placeholder,"toolbar-items":i.contentEditorItems,"should-not-group-when-full":!1},null,8,["modelValue","style","placeholder","toolbar-items"])):(0,s.createCommentVNode)("",!0),"text"==i.type?((0,s.openBlock)(),(0,s.createBlock)(p,{key:1,modelValue:c.content,"onUpdate:modelValue":t[2]||(t[2]=e=>c.content=e),size:i.size,type:i.type,style:(0,s.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","style","placeholder"])):(0,s.createCommentVNode)("",!0),"textarea"==i.type?((0,s.openBlock)(),(0,s.createBlock)(p,{key:2,modelValue:c.content,"onUpdate:modelValue":t[3]||(t[3]=e=>c.content=e),size:i.size,type:i.type,rows:i.rows,style:(0,s.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","rows","style","placeholder"])):(0,s.createCommentVNode)("",!0)])),_:1},8,["span"])])),_:1})):((0,s.openBlock)(),(0,s.createBlock)(f,{key:1,gutter:2,style:{width:"100%"}},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(m,{span:24-i.selectorSpan},{default:(0,s.withCtx)((()=>["editor"==i.type?((0,s.openBlock)(),(0,s.createBlock)(g,{key:0,modelValue:c.content,"onUpdate:modelValue":t[4]||(t[4]=e=>c.content=e),style:(0,s.normalizeStyle)(i.inputStyles),placeholder:i.placeholder,"toolbar-items":i.contentEditorItems,"should-not-group-when-full":!1},null,8,["modelValue","style","placeholder","toolbar-items"])):(0,s.createCommentVNode)("",!0),"text"==i.type?((0,s.openBlock)(),(0,s.createBlock)(p,{key:1,modelValue:c.content,"onUpdate:modelValue":t[5]||(t[5]=e=>c.content=e),size:i.size,type:i.type,style:(0,s.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","style","placeholder"])):(0,s.createCommentVNode)("",!0),"textarea"==i.type?((0,s.openBlock)(),(0,s.createBlock)(p,{key:2,modelValue:c.content,"onUpdate:modelValue":t[6]||(t[6]=e=>c.content=e),size:i.size,type:i.type,rows:i.rows,style:(0,s.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","rows","style","placeholder"])):(0,s.createCommentVNode)("",!0)])),_:1},8,["span"]),(0,s.createVNode)(m,{span:i.selectorSpan},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(u,{modelValue:l.langCode,"onUpdate:modelValue":t[7]||(t[7]=e=>l.langCode=e),size:i.size,style:{width:"100%"},placeholder:e.$t("code"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,s.createSlots)({default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.langList,(e=>((0,s.openBlock)(),(0,s.createBlock)(h,{key:e.code,value:e.code,label:i.displayCode?e.code:" "},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",r,(0,s.toDisplayString)(e.label),1)])),_:2},1032,["value","label"])))),128))])),_:2},[i.displayFlag?{name:"prefix",fn:(0,s.withCtx)((()=>[(0,s.createVNode)(d,{iso:l.langCode.replace("EN","GB"),class:"ml-5 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","size","placeholder","no-data-text","no-match-text"])])),_:1},8,["span"])])),_:1}))}var l=i(2258);const c=()=>({langCode:""}),d={},h={},u=(0,l.defineStore)("mltlang",{state:c,getters:d,actions:h});var m=i(98761),g={name:"MltlangInput",mixins:[m.Z],props:{type:{type:String,default:"text"},size:{type:String,default:"default"},placeholder:{type:String,default:""},inputStyles:{type:Object,default:()=>({width:"100%"})},selectorSpan:{type:Number,default:3},modelValue:{type:String,required:!0},displayCode:{type:Boolean,default:!1},displayFlag:{type:Boolean,default:!0},reverse:{type:Boolean,default:!1},synchro:{type:Boolean,default:!1},rows:{type:Number,default:2},contentEditorItems:{type:Array,default:()=>["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"]}},emits:["update:modelValue","codeChange"],setup(){const e=u();return{mltlangStore:e}},data(){return{langCode:""}},computed:{content:{get(){let e;try{e=JSON.parse(this.modelValue)}catch(t){e={}}return e[this.langCode]||""},set(e){let t;try{t=JSON.parse(this.modelValue)}catch(i){t={}}t[this.langCode]=e,this.$emit("update:modelValue",JSON.stringify(t))}}},watch:{langCode:{handler(e,t){this.$emit("codeChange",e),this.mltlangStore.langCode=e}},"mltlangStore.langCode":{handler(e,t){this.synchro&&(this.langCode=e)}}},created(){this.mltlangStore.langCode&&(this.langCode=this.mltlangStore.langCode),this.langList?.length&&!this.langCode&&(this.langCode=this.langList[0]?.code)}},p=i(83744);const f=(0,p.Z)(g,[["render",a],["__scopeId","data-v-494e3f59"]]);var w=f},97200:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var n=i(82234);const s=(0,n.createElementVNode)("div",null,"Sticky Top",-1);function o(e,t,i,o,r,a){return(0,n.openBlock)(),(0,n.createElementBlock)("div",{style:(0,n.normalizeStyle)({height:r.height+"px",zIndex:i.zIndex})},[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(i.className),style:(0,n.normalizeStyle)({top:r.isSticky?i.top+"px":"",zIndex:i.zIndex,position:r.position,width:r.width,height:r.height+"px"})},[(0,n.renderSlot)(e.$slots,"default",{},(()=>[s]))],6)],4)}var r={name:"Sticky",props:{top:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated(){this.handleScroll()},unmounted(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset(){this.active&&this.reset()},reset(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll(){const e=this.$el.getBoundingClientRect().width;this.width=e||"auto";const t=this.$el.getBoundingClientRect().top;t<this.top?this.sticky():this.handleReset()},handleResize(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},a=i(83744);const l=(0,a.Z)(r,[["render",o]]);var c=l},6432:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var n=i(82234);const s={style:{"line-height":"36px","font-size":"18px"}};function o(e,t,i,o,r,a){const l=(0,n.resolveComponent)("el-col"),c=(0,n.resolveComponent)("el-button"),d=(0,n.resolveComponent)("el-row"),h=(0,n.resolveComponent)("el-card"),u=(0,n.resolveComponent)("Form");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{span:8},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("b",s,(0,n.toDisplayString)(e.$t("addArticle")),1)])),_:1}),(0,n.createVNode)(l,{span:16,class:"text-right"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,n.createElementVNode)("section",null,[(0,n.createVNode)(u)])],64)}var r=i(59607),a=i(31922),l={name:"AddArticle",components:{Form:a.Z},mixins:[r.Z],data(){return{articles:[]}},async created(){const e=await this.$store.dispatch("newsArticle/getAllArticles",{root:!0});e.success&&e.data&&(this.articles=e.data),this.$store.dispatch("newsTag/getAllTags",{root:!0}),this.$store.dispatch("user/getAllUsers",{root:!0}),this.loadCategories(),this.articleData.author=this.userData?.id},methods:{async save(){if(this.dataProvided){if(this.articles.findIndex((e=>this.tr(e.title)==this.tr(this.articleData.title)))>-1)return this.$message.error(this.$t("sameArticleTitleError")),!1;if(this.articles.findIndex((e=>e.slug==this.articleData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;const e=await this.addItemInDB({context:this.NEWS_ARTICLE_CONTEXT,data:{title:this.articleData.title,content:this.articleData.content,slug:this.articleData.slug,tags:JSON.stringify(this.articleData.tags),categories:JSON.stringify(this.articleData.categories),summary:this.articleData.summary,featured_image:this.articleData.featuredImage,allow_comment:this.articleData.allowComment,status:this.articleData.status,author:this.articleData.author,insert_by:this.userData?.id}});e.success?this.$router.replace(this.Routes.NEWS.PATH+"/articles"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",o]]);var h=d},9763:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var n=i(82234);const s={style:{"line-height":"36px","font-size":"18px"}};function o(e,t,i,o,r,a){const l=(0,n.resolveComponent)("el-col"),c=(0,n.resolveComponent)("el-button"),d=(0,n.resolveComponent)("el-row"),h=(0,n.resolveComponent)("el-card"),u=(0,n.resolveComponent)("Form"),m=(0,n.resolveDirective)("loading");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{span:8},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("b",s,(0,n.toDisplayString)(e.$t("editArticle")),1)])),_:1}),(0,n.createVNode)(l,{span:16,class:"text-right"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("section",null,[(0,n.createVNode)(u)])),[[m,r.isLoading]])],64)}var r=i(59607),a=i(31922),l={name:"EditArticle",components:{Form:a.Z},mixins:[r.Z],data(){return{isLoading:!1,currentTitle:"",currentSlug:"",articles:[]}},async created(){const e=await this.$store.dispatch("newsArticle/getAllArticles",{root:!0});e.success&&e.data&&(this.articles=e.data),this.$store.dispatch("newsTag/getAllTags",{root:!0}),this.$store.dispatch("user/getAllUsers",{root:!0}),this.loadCategories(),this.init()},methods:{async init(){if(this.$route.params&&this.$route.params.article){this.isLoading=!0;const e=await this.getItemFromDB({context:this.NEWS_ARTICLE_CONTEXT,id:this.$route.params.article});e.data&&e.success?(this.articleData={title:e.data.title,content:e.data.content,slug:e.data.slug,tags:JSON.parse(e.data.tags),categories:JSON.parse(e.data.categories),summary:e.data.summary,featuredImage:e.data.featured_image,allowComment:parseInt(e.data.allow_comment),status:parseInt(e.data.status),author:e.data.author},this.currentTitle=e.data.title,this.currentSlug=e.data.slug,this.isLoading=!1):this.$router.replace(this.Routes.NEWS.PATH+"/articles")}else this.$router.replace(this.Routes.NEWS.PATH+"/articles")},async save(){if(this.dataProvided){if(this.tr(this.currentTitle)!==this.tr(this.articleData.title)&&this.articles.findIndex((e=>this.tr(e.title)==this.tr(this.articleData.title)))>-1)return this.$message.error(this.$t("sameArticleTitleError")),!1;if(this.currentSlug!==this.articleData.slug&&this.articles.findIndex((e=>e.slug==this.articleData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;const e=await this.updateItemInDB({context:this.NEWS_ARTICLE_CONTEXT,id:this.$route.params.article,data:{title:this.articleData.title,content:this.articleData.content,slug:this.articleData.slug,tags:JSON.stringify(this.articleData.tags),categories:JSON.stringify(this.articleData.categories),summary:this.articleData.summary,featured_image:this.articleData.featuredImage,allow_comment:this.articleData.allowComment,status:this.articleData.status,author:this.articleData.author}});e.success?this.$router.replace(this.Routes.NEWS.PATH+"/articles"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",o]]);var h=d},31922:function(e,t,i){"use strict";i.d(t,{Z:function(){return P}});var n=i(68716),s=i(97200),o=i(12670),r=i(82234);const a=e=>((0,r.pushScopeId)("data-v-2468c4c9"),e=e(),(0,r.popScopeId)(),e),l={class:"item-title"},c={class:"item-title"},d={class:"item-title"},h=a((()=>(0,r.createElementVNode)("div",{class:"mb-10"},null,-1))),u={class:"item-title"},m={key:0,style:{color:"#000"}},g={key:1},p={class:"item-title"},f={class:"item-title"},w={class:"item-title"},b={class:"item-title"},v={class:"card-header"},_={class:"text-center"},y={class:"img-preview-container"},C={class:"image-slot"},k={key:1};function x(e,t,i,a,x,A){const E=o.Z,T=(0,r.resolveComponent)("el-option"),P=(0,r.resolveComponent)("el-select"),S=(0,r.resolveComponent)("el-col"),V=(0,r.resolveComponent)("el-input"),I=(0,r.resolveComponent)("Delete"),N=(0,r.resolveComponent)("el-icon"),R=(0,r.resolveComponent)("Picture"),D=(0,r.resolveComponent)("el-image"),B=(0,r.resolveComponent)("el-card"),M=(0,r.resolveComponent)("el-checkbox"),O=s.Z,L=(0,r.resolveComponent)("el-row"),F=n.Z,z=(0,r.resolveComponent)("el-dialog");return(0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,null,[(0,r.createVNode)(B,{shadow:"never"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(L,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(S,{span:16},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",l,(0,r.toDisplayString)(e.$t("title")),1),(0,r.createVNode)(E,{modelValue:e.$parent.articleData.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$parent.articleData.title=t),class:"mb-10",synchro:!0,placeholder:e.$t("enterTheTitle"),type:"text"},null,8,["modelValue","placeholder"]),(0,r.createElementVNode)("span",c,(0,r.toDisplayString)(e.$t("summary")),1),(0,r.createVNode)(E,{modelValue:e.$parent.articleData.summary,"onUpdate:modelValue":t[1]||(t[1]=t=>e.$parent.articleData.summary=t),rows:4,synchro:!0,placeholder:e.$t("articleSummary"),type:"textarea",class:"mb-25"},null,8,["modelValue","placeholder"]),(0,r.createElementVNode)("span",d,(0,r.toDisplayString)(e.$t("content")),1),(0,r.createVNode)(E,{modelValue:e.$parent.articleData.content,"onUpdate:modelValue":t[2]||(t[2]=t=>e.$parent.articleData.content=t),type:"editor",synchro:!0,placeholder:e.$t("articleContent"),class:"article-content-editor"},null,8,["modelValue","placeholder"]),h,(0,r.createElementVNode)("span",u,(0,r.toDisplayString)(e.$t("categories")),1),(0,r.createVNode)(P,{modelValue:e.$parent.articleData.categories,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$parent.articleData.categories=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.categories,(t=>((0,r.openBlock)(),(0,r.createBlock)(T,{key:t.id,value:t.id,label:e.tr(t.name)},{default:(0,r.withCtx)((()=>[t.isParent?((0,r.openBlock)(),(0,r.createElementBlock)("b",m,(0,r.toDisplayString)(e.tr(t.name)),1)):((0,r.openBlock)(),(0,r.createElementBlock)("span",g,(0,r.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,r.createElementVNode)("span",p,(0,r.toDisplayString)(e.$t("tags")),1),(0,r.createVNode)(P,{modelValue:e.$parent.articleData.tags,"onUpdate:modelValue":t[4]||(t[4]=t=>e.$parent.articleData.tags=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.tags,(t=>((0,r.openBlock)(),(0,r.createBlock)(T,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1}),(0,r.createVNode)(S,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(O,{top:60},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",f,(0,r.toDisplayString)(e.$t("slug")),1),(0,r.createVNode)(V,{modelValue:e.$parent.articleData.slug,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$parent.articleData.slug=t),class:"mb-10",style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"]),(0,r.createElementVNode)("span",w,(0,r.toDisplayString)(e.$t("status")),1),(0,r.createVNode)(P,{modelValue:e.$parent.articleData.status,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$parent.articleData.status=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.articleStatus,(e=>((0,r.openBlock)(),(0,r.createBlock)(T,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,r.createElementVNode)("span",b,(0,r.toDisplayString)(e.$t("author")),1),(0,r.createVNode)(P,{modelValue:e.$parent.articleData.author,"onUpdate:modelValue":t[7]||(t[7]=t=>e.$parent.articleData.author=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.users,(e=>((0,r.openBlock)(),(0,r.createBlock)(T,{key:e.id,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,r.createVNode)(B,{shadow:"hover",class:"featured-image-card mb-10"},{header:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",v,[(0,r.createElementVNode)("h4",null,(0,r.toDisplayString)(e.$t("featuredImage")),1),e.$parent.articleData.featuredImage?((0,r.openBlock)(),(0,r.createBlock)(N,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:t[8]||(t[8]=t=>e.$parent.articleData.featuredImage="")},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(I)])),_:1},8,["title"])):(0,r.createCommentVNode)("",!0)])])),default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",_,[(0,r.createElementVNode)("div",y,[(0,r.createElementVNode)("div",{class:"img-preview",style:{width:"250px","aspect-ratio":"16 / 9"},onClick:t[9]||(t[9]=t=>e.$parent.addFeaturedImage())},[e.$parent.articleData.featuredImage?((0,r.openBlock)(),(0,r.createBlock)(D,{key:0,fit:"cover",style:{height:"100%",width:"100%"},src:e.$parent.resolveMediaLink(e.$parent.articleData.featuredImage)},{error:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",C,[(0,r.createVNode)(N,null,{default:(0,r.withCtx)((()=>[(0,r.createVNode)(R)])),_:1})])])),_:1},8,["src"])):((0,r.openBlock)(),(0,r.createElementBlock)("span",k,(0,r.toDisplayString)(e.$t("defineFeaturedImage")),1))])])])])),_:1}),(0,r.createVNode)(B,{shadow:"hover",class:"options-card mb-10"},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",null,[(0,r.createVNode)(M,{modelValue:e.$parent.articleData.allowComment,"onUpdate:modelValue":t[10]||(t[10]=t=>e.$parent.articleData.allowComment=t),"true-label":1,"false-label":0,label:e.$t("allowComments"),size:"default"},null,8,["modelValue","label"])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,r.createVNode)(z,{modelValue:e.$parent.pickerVisible,"onUpdate:modelValue":t[11]||(t[11]=t=>e.$parent.pickerVisible=t),title:e.$t("featuredImage"),"destroy-on-close":"",fullscreen:"",top:"1vh"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(F,{"display-videos":!1,"display-audios":!1,"display-documents":!1,"display-other-types":!1,onSelected:e.$parent.onFeaturedImageSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)}var A={},E=i(83744);const T=(0,E.Z)(A,[["render",x],["__scopeId","data-v-2468c4c9"]]);var P=T},99372:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return T}});i(57658);var n=i(82234);const s=e=>((0,n.pushScopeId)("data-v-84fab018"),e=e(),(0,n.popScopeId)(),e),o={style:{"line-height":"36px","font-size":"18px"}},r={style:{color:"dimgray"}},a={key:0,style:{color:"#000"}},l={key:1,style:{color:"dimgray"}},c={class:"collection-container"},d=s((()=>(0,n.createElementVNode)("div",null,null,-1))),h={class:"counter default"},u={class:"counter default"},m={class:"counter default"},g={class:"counter warning"},p={class:"counter success"},f={class:"counter danger"},w={class:"mb-5"},b={key:0},v={style:{"text-align":"center","margin-top":"20px",display:"flex"}},_={class:"text-center"};function y(e,t,i,s,y,C){const k=(0,n.resolveComponent)("el-col"),x=(0,n.resolveComponent)("el-button"),A=(0,n.resolveComponent)("el-option"),E=(0,n.resolveComponent)("el-select"),T=(0,n.resolveComponent)("el-divider"),P=(0,n.resolveComponent)("el-row"),S=(0,n.resolveComponent)("el-card"),V=(0,n.resolveComponent)("el-radio-button"),I=(0,n.resolveComponent)("el-radio-group"),N=(0,n.resolveComponent)("el-table-column"),R=(0,n.resolveComponent)("el-input"),D=(0,n.resolveComponent)("el-table"),B=(0,n.resolveComponent)("el-pagination"),M=(0,n.resolveComponent)("el-dialog"),O=(0,n.resolveDirective)("loading");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(S,{class:"mb-5 header-card",shadow:"hover"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(P,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(k,{span:6},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("b",o,(0,n.toDisplayString)(e.$t("articlesManagement")),1)])),_:1}),(0,n.createVNode)(k,{span:18,class:"text-right"},{default:(0,n.withCtx)((()=>[y.multipleSelection.length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)(x,{size:"default",type:"warning",icon:"sort",class:"change-status-btn",onClick:C.changeStatus},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("changeStatus")),1)])),_:1},8,["onClick"]),"trash"==y.collection?((0,n.openBlock)(),(0,n.createBlock)(x,{key:0,size:"default",type:"danger",icon:"delete",onClick:C.deleteMultipleItems},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("delete")),1)])),_:1},8,["onClick"])):(0,n.createCommentVNode)("",!0)],64)):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[(0,n.createVNode)(E,{modelValue:y.category,"onUpdate:modelValue":t[0]||(t[0]=e=>y.category=e),size:"default",class:"mr-10",style:{width:"185px"},disabled:!!y.multipleSelection.length},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{label:e.$t("allCategories"),value:0},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("span",r,(0,n.toDisplayString)(e.$t("allCategories")),1)])),_:1},8,["label"]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.categories,(t=>((0,n.openBlock)(),(0,n.createBlock)(A,{key:t.id,value:t.id,label:e.tr(t.name)},{default:(0,n.withCtx)((()=>[t.isParent?((0,n.openBlock)(),(0,n.createElementBlock)("b",a,(0,n.toDisplayString)(e.tr(t.name)),1)):((0,n.openBlock)(),(0,n.createElementBlock)("span",l,(0,n.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue","disabled"]),(0,n.createVNode)(E,{modelValue:y.articleDate,"onUpdate:modelValue":t[1]||(t[1]=e=>y.articleDate=e),size:"default",style:{width:"165px"},disabled:!!y.multipleSelection.length},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{label:e.$t("allDates"),value:0},null,8,["label"]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(y.articleDates,(e=>((0,n.openBlock)(),(0,n.createBlock)(A,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue","disabled"]),(0,n.createVNode)(T,{direction:"vertical"}),(0,n.createVNode)(x,{size:"default",type:"primary",icon:"plus",disabled:!!y.multipleSelection.length,onClick:t[2]||(t[2]=t=>e.$router.push(e.Routes.NEWS.PATH+"/add-article"))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("addArticle")),1)])),_:1},8,["disabled"])],64))])),_:1})])),_:1})])),_:1}),(0,n.createVNode)(S,{class:"mb-5 header-card",shadow:"hover"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",c,[d,(0,n.createVNode)(I,{modelValue:y.collection,"onUpdate:modelValue":t[3]||(t[3]=e=>y.collection=e),class:"collection-radio-group",disabled:!!y.multipleSelection.length},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(V,{label:"all"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("all"))+" ",1),(0,n.createElementVNode)("span",h,(0,n.toDisplayString)(y.tableData.length),1)])),_:1}),(0,n.createVNode)(V,{label:"mine"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("myArticles"))+" ",1),(0,n.createElementVNode)("span",u,(0,n.toDisplayString)(y.tableData.filter((t=>t.author==e.userData.id)).length),1)])),_:1}),(0,n.createVNode)(V,{label:"draft"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("draft"))+" ",1),(0,n.createElementVNode)("span",m,(0,n.toDisplayString)(y.tableData.filter((t=>t.status==e.ArticleStatus.DRAFT.id)).length),1)])),_:1}),(0,n.createVNode)(V,{label:"pending"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("pendingReading"))+" ",1),(0,n.createElementVNode)("span",g,(0,n.toDisplayString)(y.tableData.filter((t=>t.status==e.ArticleStatus.PENDING.id)).length),1)])),_:1}),(0,n.createVNode)(V,{label:"published"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("publishedArticles"))+" ",1),(0,n.createElementVNode)("span",p,(0,n.toDisplayString)(y.tableData.filter((t=>t.status==e.ArticleStatus.PUBLISHED.id)).length),1)])),_:1}),(0,n.createVNode)(V,{label:"trash"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("trash"))+" ",1),(0,n.createElementVNode)("span",f,(0,n.toDisplayString)(y.tableData.filter((t=>t.status==e.ArticleStatus.TRASH.id)).length),1)])),_:1})])),_:1},8,["modelValue","disabled"])])])),_:1}),(0,n.createVNode)(S,{shadow:"hover"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",w,[(0,n.createElementVNode)("small",null,[y.multipleSelection.length?((0,n.openBlock)(),(0,n.createElementBlock)("b",b,(0,n.toDisplayString)(e.$t("xSelectedItems",[y.multipleSelection.length])),1)):(0,n.createCommentVNode)("",!0)])]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(D,{border:"",stripe:"",data:C.pagedTableData,"empty-text":e.$t("noData"),style:{width:"100%"},onSelectionChange:C.handleSelectionChange},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(N,{width:"50",type:"selection",fixed:""}),(0,n.createVNode)(N,{sortable:"",label:e.$t("title"),prop:"title",width:"175",fixed:""},{default:(0,n.withCtx)((t=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(t.row.title)),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{sortable:"",label:e.$t("summary"),prop:"summary",width:"175",fixed:"","show-overflow-tooltip":""},{default:(0,n.withCtx)((t=>[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(e.tr(t.row.summary)),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{sortable:"",label:e.$t("categories"),prop:"categories",width:"200"},{default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(C.showCategories(e.row.categories)),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{sortable:"",label:e.$t("tags"),prop:"tags",width:"200"},{default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(C.showTags(e.row.tags)),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{sortable:"",label:e.$t("insertBy"),prop:"insert_by",width:"175"},{default:(0,n.withCtx)((e=>[(0,n.createTextVNode)((0,n.toDisplayString)(C.showUserName(e.row.insert_by)),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{sortable:"",label:e.$t("addedOn"),width:"160"},{default:(0,n.withCtx)((t=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.reformatDate(t.row.insert_datetime,{inPattern:"YYYY-MM-DD HH:mm:ss",outPattern:e.dateFormat+" - HH:mm",locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{sortable:"",label:e.$t("modifiedOn"),width:"160"},{default:(0,n.withCtx)((t=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.reformatDate(t.row.edit_datetime,{inPattern:"YYYY-MM-DD HH:mm:ss",outPattern:e.dateFormat+" - HH:mm",locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,n.createVNode)(N,{align:"right",width:"225",fixed:"right"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(R,{modelValue:y.search,"onUpdate:modelValue":t[4]||(t[4]=e=>y.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,n.withCtx)((t=>[(0,n.createVNode)(P,{gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(k,{span:"trash"==y.collection?8:12},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(x,{size:"small",type:"primary",icon:"switch",style:{width:"100%"},title:e.$t("status"),disabled:!!y.multipleSelection.length,onClick:e=>C.editItemStatus(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1032,["span"]),(0,n.createVNode)(k,{span:"trash"==y.collection?8:12},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(x,{size:"small",type:"warning",icon:"edit",style:{width:"100%"},title:e.$t("edit"),disabled:!!y.multipleSelection.length,onClick:e=>C.editItem(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1032,["span"]),"trash"==y.collection?((0,n.openBlock)(),(0,n.createBlock)(k,{key:0,span:8},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(x,{size:"small",type:"danger",icon:"delete",style:{width:"100%"},title:e.$t("delete"),disabled:!!y.multipleSelection.length,onClick:e=>C.deleteItem(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1024)):(0,n.createCommentVNode)("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data","empty-text","onSelectionChange"])),[[O,y.isLoading]]),(0,n.createElementVNode)("div",v,[(0,n.createVNode)(B,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":y.pageSize,total:y.total,onCurrentChange:C.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,n.createVNode)(M,{modelValue:y.statusDialog,"onUpdate:modelValue":t[6]||(t[6]=e=>y.statusDialog=e),title:e.$t("articleStatus"),top:"20vh"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",_,[(0,n.createVNode)(I,{modelValue:y.status,"onUpdate:modelValue":t[5]||(t[5]=e=>y.status=e),onChange:C.updateArticleStatus},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(V,{label:e.ArticleStatus.DRAFT.id},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("draft")),1)])),_:1},8,["label"]),(0,n.createVNode)(V,{label:e.ArticleStatus.PENDING.id},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("pendingReading")),1)])),_:1},8,["label"]),(0,n.createVNode)(V,{label:e.ArticleStatus.PUBLISHED.id},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("publishedArticles")),1)])),_:1},8,["label"]),(0,n.createVNode)(V,{label:e.ArticleStatus.TRASH.id},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("trash")),1)])),_:1},8,["label"])])),_:1},8,["modelValue","onChange"])])])),_:1},8,["modelValue","title"])],64)}var C=i(59607),k=i(98761),x={name:"Articles",mixins:[C.Z,k.Z],data(){return{status:0,category:0,articleDate:0,statusEditId:0,articleDates:[],collection:"all",statusEditMode:"single",currentEditItem:null,multipleSelection:[],statusDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.filtering.filter((e=>e.title.toLowerCase().includes(this.search.toLowerCase())||e.summary.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.filtering.length,this.filtering)},filtering(){const e=this.tableData.filter((e=>0==this.category||JSON.parse(e.categories).map((e=>parseInt(e))).includes(parseInt(this.category)))),t=e.filter((e=>0==this.articleDate||this.extractDatetimeMonthYear(e.insert_datetime)==this.articleDate)),i=t;switch(this.collection){case"mine":return i.filter((e=>e.author==this.userData.id));case"draft":return i.filter((e=>e.status==this.ArticleStatus.DRAFT.id));case"pending":return i.filter((e=>e.status==this.ArticleStatus.PENDING.id));case"published":return i.filter((e=>e.status==this.ArticleStatus.PUBLISHED.id));case"trash":return i.filter((e=>e.status==this.ArticleStatus.TRASH.id))}return i}},watch:{tableData:{handler(e,t){this.loadArticleDates()},deep:!0}},async created(){this.init()},methods:{setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},handleSelectionChange(e){this.multipleSelection=e},showUserName(e){const t=this.users.find((t=>t.id==e));return t?t.name:""},changeStatus(){this.statusEditId=0,this.statusEditMode="multiple",this.statusDialog=!0},showCategories(e){const t=JSON.parse(e),i=[];return t.forEach((e=>{const t=this.categories.find((t=>t.id==e));t&&i.push(this.tr(t.name))})),i.length?i.join(" / "):""},showTags(e){const t=JSON.parse(e),i=[];return t.forEach((e=>{const t=this.tags.find((t=>t.id==e));t&&i.push(this.tr(t.name))})),i.length?i.join(" / "):""},async init(){this.isLoading=!0,this.$store.dispatch("user/getAllUsers",{root:!0}),this.$store.dispatch("newsTag/getAllTags",{root:!0}),this.loadCategories();const e=await this.getAllArticles();e.data&&(this.tableData=e.data.reverse()),e.failure&&this.$message.error(this.$t("unableToUpdateData")),this.isLoading=!1},async editItemStatus(e,t){this.statusEditMode="single",this.statusEditId=t.id,this.status=t.status,this.statusDialog=!0},async editItem(e,t){this.$router.push({name:"EditArticle"+this.Routes.NEWS.NAME,params:{article:t.id}})},deleteItem(e,t){this.$confirm(this.$t("deleteArticleQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteItemInDB({context:this.NEWS_ARTICLE_CONTEXT,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},deleteMultipleItems(){this.$confirm(1===this.multipleSelection.length?this.$t("deleteArticleQuestion"):this.$t("deleteMultipleItems",[this.multipleSelection.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.multipleSelection.length;t++)await this.deleteItemInDB({context:this.NEWS_ARTICLE_CONTEXT,id:this.multipleSelection[t].id});e.close(),this.$message.success(this.$t("success")),this.init()})).catch((()=>{}))},loadArticleDates(){this.articleDates=[],this.tableData.forEach((e=>{const t=this.extractDatetimeMonthYear(e.insert_datetime);this.articleDates.includes(t)||this.articleDates.push(t)}))},extractDatetimeMonthYear(e){if(!e)return"";let t=this.reformatDate(e.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale});return t=t.split(" "),this.capitalizeFirstLetter(t[1])+" "+t[2]},async updateArticleStatus(){if("single"==this.statusEditMode){const e=await this.updateItemInDB({context:this.NEWS_ARTICLE_CONTEXT,id:this.statusEditId,data:{status:this.status}});e.success?this.init():this.$message.error(this.$t("anErrorOccured"))}else{let e=!0;for(let t=0;t<this.multipleSelection.length;t++){const i=await this.updateItemInDB({context:this.NEWS_ARTICLE_CONTEXT,id:this.multipleSelection[t].id,data:{status:this.status}});i.failure&&(e=!1)}this.init(),e||this.$message.error(this.$t("anErrorOccured"))}this.statusDialog=!1}}},A=i(83744);const E=(0,A.Z)(x,[["render",y],["__scopeId","data-v-84fab018"]]);var T=E},4381:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return S}});var n=i(68716),s=i(12670),o=i(82234);const r={style:{"line-height":"36px","font-size":"18px"}},a={style:{"text-align":"center","margin-top":"20px",display:"flex"}},l={class:"card-header"},c={class:"img-preview-container"},d={class:"image-slot"},h={key:1},u={class:"dialog-footer"},m={class:"card-header"},g={class:"img-preview-container"},p={class:"image-slot"},f={key:1},w={class:"dialog-footer"};function b(e,t,i,b,v,_){const y=(0,o.resolveComponent)("el-col"),C=(0,o.resolveComponent)("el-button"),k=(0,o.resolveComponent)("el-row"),x=(0,o.resolveComponent)("el-card"),A=(0,o.resolveComponent)("el-table-column"),E=(0,o.resolveComponent)("el-tag"),T=(0,o.resolveComponent)("el-input"),P=(0,o.resolveComponent)("el-table"),S=(0,o.resolveComponent)("el-pagination"),V=(0,o.resolveComponent)("Delete"),I=(0,o.resolveComponent)("el-icon"),N=(0,o.resolveComponent)("Picture"),R=(0,o.resolveComponent)("el-image"),D=s.Z,B=(0,o.resolveComponent)("el-form-item"),M=(0,o.resolveComponent)("el-radio-button"),O=(0,o.resolveComponent)("el-radio-group"),L=(0,o.resolveComponent)("el-input-number"),F=(0,o.resolveComponent)("el-color-picker"),z=(0,o.resolveComponent)("el-form"),$=(0,o.resolveComponent)("el-dialog"),Z=n.Z,H=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(x,{class:"mb-10 header-card",shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",r,(0,o.toDisplayString)(e.$t("categoriesManagement")),1)])),_:1}),(0,o.createVNode)(y,{span:12,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(C,{size:"default",type:"primary",icon:"plus",onClick:t[0]||(t[0]=e=>_.addItem())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.createVNode)(x,{shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(P,{border:"","row-key":"id","default-expand-all":"",data:_.pagedTableData,"empty-text":e.$t("noData"),"row-class-name":_.tableRowClassName,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{width:"50",fixed:""},{header:(0,o.withCtx)((()=>[])),_:1}),(0,o.createVNode)(A,{sortable:"",label:e.$t("name"),prop:"name",width:"150",fixed:""},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.tr(t.row.name)),1)])),_:1},8,["label"]),(0,o.createVNode)(A,{sortable:"",label:e.$t("slug"),prop:"slug",width:"150"},null,8,["label"]),(0,o.createVNode)(A,{sortable:"",label:e.$t("description"),prop:"description",width:"175","show-overflow-tooltip":""},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(e.tr(t.row.description)),1)])),_:1},8,["label"]),(0,o.createVNode)(A,{sortable:"",label:e.$t("status"),prop:"display",width:"125"},{default:(0,o.withCtx)((t=>[parseInt(t.row.display)?((0,o.openBlock)(),(0,o.createBlock)(E,{key:0,type:"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(E,{key:1,type:"danger"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}))])),_:1},8,["label"]),(0,o.createVNode)(A,{sortable:"",label:e.$t("relatedArticles"),width:"140"},{default:(0,o.withCtx)((e=>[e.row.count_articles?((0,o.openBlock)(),(0,o.createBlock)(E,{key:0},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.row.count_articles),1)])),_:2},1024)):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,o.createVNode)(A,{sortable:"",label:e.$t("position"),width:"125"},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(E,null,{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.row.position),1)])),_:2},1024)])),_:1},8,["label"]),(0,o.createVNode)(A,{label:e.$t("color"),width:"125"},{default:(0,o.withCtx)((e=>[e.row.color?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,style:(0,o.normalizeStyle)("width: 50px; height: 10px; background: "+e.row.color)},null,4)):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,o.createVNode)(A,{align:"right",width:"300",fixed:"right"},{header:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{modelValue:v.search,"onUpdate:modelValue":t[1]||(t[1]=e=>v.search=e),size:"small",placeholder:e.$t("search"),style:{width:"260px"}},null,8,["modelValue","placeholder"])])),default:(0,o.withCtx)((t=>[t.row.isParent?((0,o.openBlock)(),(0,o.createBlock)(C,{key:0,size:"small",type:"primary",icon:"plus",onClick:e=>_.addSubItem(t.$index,t.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("subCategory")),1)])),_:2},1032,["onClick"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(C,{size:"small",type:"warning",icon:"edit",onClick:e=>_.editItem(t.$index,t.row)},null,8,["onClick"]),(0,o.createVNode)(C,{size:"small",type:"danger",icon:"delete",onClick:e=>_.deleteItem(t.$index,t.row)},null,8,["onClick"])])),_:1})])),_:1},8,["data","empty-text","row-class-name"])),[[H,v.isLoading]]),(0,o.createElementVNode)("div",a,[(0,o.createVNode)(S,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":v.pageSize,total:v.total,onCurrentChange:_.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,o.createVNode)($,{modelValue:v.addDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>v.addDialog=e),title:0!=v.addCategoryData.parent?e.$t("addSubCategory"):e.$t("addCategory"),width:"65%",top:"3vh"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",u,[(0,o.createVNode)(C,{onClick:t[9]||(t[9]=e=>_.cancelForm(v.addCategoryForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(C,{type:"primary",onClick:t[10]||(t[10]=e=>_.submitForm(v.addCategoryForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(z,{ref:v.addCategoryForm,rules:v.rules,model:v.addCategoryData,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{gutter:20},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(x,{class:"category-uploader-container",shadow:"never"},{header:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("categoryPreview")),1),v.addCategoryData.preview?((0,o.openBlock)(),(0,o.createBlock)(I,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:_.clearPreview},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V)])),_:1},8,["title","onClick"])):(0,o.createCommentVNode)("",!0)])])),default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",{class:"img-preview",onClick:t[2]||(t[2]=e=>v.pickerVisible=!0)},[v.addCategoryData.preview?((0,o.openBlock)(),(0,o.createBlock)(R,{key:0,style:{width:"100%",height:"100%"},src:e.resolveMediaLink(v.addCategoryData.preview),fit:"cover"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(I,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N)])),_:1})])])),_:1},8,["src"])):((0,o.openBlock)(),(0,o.createElementBlock)("span",h,(0,o.toDisplayString)(e.$t("select")),1))])])])),_:1})])),_:1}),(0,o.createVNode)(y,{span:16},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{prop:"name",label:e.$t("name")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:v.addCategoryData.name,"onUpdate:modelValue":t[3]||(t[3]=e=>v.addCategoryData.name=e),synchro:!0,"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(B,{prop:"slug",label:e.$t("slug")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{modelValue:v.addCategoryData.slug,"onUpdate:modelValue":t[4]||(t[4]=e=>v.addCategoryData.slug=e),style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(B,{prop:"description",label:e.$t("description")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:v.addCategoryData.description,"onUpdate:modelValue":t[5]||(t[5]=e=>v.addCategoryData.description=e),type:"textarea",synchro:!0,"selector-span":5,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(B,{prop:"display",label:e.$t("status")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(O,{modelValue:v.addCategoryData.display,"onUpdate:modelValue":t[6]||(t[6]=e=>v.addCategoryData.display=e)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(M,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,o.createVNode)(k,{gutter:20},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{span:14},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{prop:"position",label:e.$t("position")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(L,{modelValue:v.addCategoryData.position,"onUpdate:modelValue":t[7]||(t[7]=e=>v.addCategoryData.position=e),style:{width:"100%"},"controls-position":"right",placeholder:e.$t("position")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,o.createVNode)(y,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{prop:"color",label:e.$t("color")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(F,{modelValue:v.addCategoryData.color,"onUpdate:modelValue":t[8]||(t[8]=e=>v.addCategoryData.color=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,o.createVNode)($,{modelValue:v.editDialog,"onUpdate:modelValue":t[21]||(t[21]=e=>v.editDialog=e),title:0!=v.editCategoryData.parent?e.$t("editSubCategory"):e.$t("editCategory"),width:"65%",top:"3vh"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",w,[(0,o.createVNode)(C,{onClick:t[19]||(t[19]=e=>_.cancelForm(v.editCategoryForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(C,{type:"primary",onClick:t[20]||(t[20]=e=>_.submitForm(v.editCategoryForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(z,{ref:v.editCategoryForm,rules:v.rules,model:v.editCategoryData,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{gutter:20},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(x,{class:"category-uploader-container",shadow:"never"},{header:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("categoryPreview")),1),v.editCategoryData.preview?((0,o.openBlock)(),(0,o.createBlock)(I,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:_.clearPreview},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V)])),_:1},8,["title","onClick"])):(0,o.createCommentVNode)("",!0)])])),default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",g,[(0,o.createElementVNode)("div",{class:"img-preview",onClick:t[12]||(t[12]=e=>v.pickerVisible=!0)},[v.editCategoryData.preview?((0,o.openBlock)(),(0,o.createBlock)(R,{key:0,style:{width:"100%",height:"100%"},src:e.resolveMediaLink(v.editCategoryData.preview),fit:"cover"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(I,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N)])),_:1})])])),_:1},8,["src"])):((0,o.openBlock)(),(0,o.createElementBlock)("span",f,(0,o.toDisplayString)(e.$t("select")),1))])])])),_:1})])),_:1}),(0,o.createVNode)(y,{span:16},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{prop:"name",label:e.$t("name")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:v.editCategoryData.name,"onUpdate:modelValue":t[13]||(t[13]=e=>v.editCategoryData.name=e),synchro:!0,"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(B,{prop:"slug",label:e.$t("slug")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{modelValue:v.editCategoryData.slug,"onUpdate:modelValue":t[14]||(t[14]=e=>v.editCategoryData.slug=e),style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(B,{prop:"description",label:e.$t("description")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:v.editCategoryData.description,"onUpdate:modelValue":t[15]||(t[15]=e=>v.editCategoryData.description=e),type:"textarea",synchro:!0,"selector-span":5,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(B,{prop:"display",label:e.$t("status")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(O,{modelValue:v.editCategoryData.display,"onUpdate:modelValue":t[16]||(t[16]=e=>v.editCategoryData.display=e)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(M,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,o.createVNode)(k,{gutter:20},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{span:14},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{prop:"position",label:e.$t("position")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(L,{modelValue:v.editCategoryData.position,"onUpdate:modelValue":t[17]||(t[17]=e=>v.editCategoryData.position=e),style:{width:"100%"},"controls-position":"right",placeholder:e.$t("position")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,o.createVNode)(y,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{prop:"color",label:e.$t("color")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(F,{modelValue:v.editCategoryData.color,"onUpdate:modelValue":t[18]||(t[18]=e=>v.editCategoryData.color=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,o.createVNode)($,{modelValue:v.pickerVisible,"onUpdate:modelValue":t[22]||(t[22]=e=>v.pickerVisible=e),title:v.currentEditItem?e.$t("editCategory"):e.$t("addCategory"),"destroy-on-close":"","append-to-body":"",fullscreen:"",top:"1vh"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(Z,{"display-videos":!1,"display-audios":!1,"display-documents":!1,"display-other-types":!1,"enable-add-from-an-url":!1,onSelected:_.savePreview},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)}var v=i(46962),_=i.n(v),y=(i(57658),i(31567)),C=i(98761),k=i(38855),x=i(15904),A=i(21101),E={name:"Categories",mixins:[k.Z,y.Z,C.Z],data(){return{editCategoryData:{name:"",parent:0,position:0,color:"",slug:"",description:"",display:"",preview:""},addCategoryData:{name:"",parent:0,position:0,color:"",slug:"",description:"",display:"",preview:""},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],parent:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],slug:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],display:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},currentStoFolder:"categories",addCategoryForm:"addCategoryForm",editCategoryForm:"editCategoryForm",currentEditItem:null,pickerVisible:!1,editDialog:!1,addDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())||e.slug.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},watch:{"addCategoryData.name":{handler(e){this.addCategoryData.slug=_()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"addCategoryData.slug":{handler(e){this.addCategoryData.slug=_()(e,{trim:!0,lower:!0,strict:!0})}},"editCategoryData.name":{handler(e){this.editCategoryData.slug=_()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"editCategoryData.slug":{handler(e){this.editCategoryData.slug=_()(e,{trim:!0,lower:!0,strict:!0})}}},async created(){this.init()},methods:{...(0,A.mapActions)("newsCategory",["getCategoriesByParent"]),...(0,A.mapActions)("newsArticle",["getAllArticles"]),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},tableRowClassName({row:e}){return e.isParent?"":"info-row"},async init(){this.isLoading=!0;const e=await this.getCategoriesByParent(0);if(e.success&&e.data){this.tableData=e.data;for(let e=0;e<this.tableData.length;e++){const t=await this.getCategoriesByParent(this.tableData[e].id);if(this.tableData[e].isParent=!0,t.success&&t.data){const i=[];t.data.forEach((e=>{i.push(e)})),this.tableData[e].children=i}}}else this.$message.error(this.$t("anErrorOccured"));this.countCategoriesArticles(),this.isLoading=!1},async countCategoriesArticles(){const e=await this.getAllArticles(),t=[];e.success&&e.data&&(e.data.forEach((e=>{let i;try{i=JSON.parse(e.categories)}catch(n){i=[]}t.push(i)})),this.tableData.forEach((e=>{e.count_articles=t.filter((t=>t.includes(e.id)))?.length||0})))},addItem(){this.addCategoryData.parent=0,this.addDialog=!0},addSubItem(e,t){this.addCategoryData.parent=t.id,this.addDialog=!0},async editItem(e,t){this.currentEditItem=t,this.editCategoryData.name=t.name,this.editCategoryData.slug=t.slug,this.editCategoryData.preview=t.preview,this.editCategoryData.description=t.description,this.editCategoryData.display=parseInt(t.display),this.editCategoryData.position=parseInt(t.position),this.editCategoryData.color=t.color,this.editDialog=!0},deleteItem(e,t){this.$confirm(this.$t("deleteCategoryQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteItemInDB({context:x.s,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},clearPreview(){this.currentEditItem?this.editCategoryData.preview="":this.addCategoryData.preview=""},async savePreview(e){this.currentEditItem?this.editCategoryData.preview=e:this.addCategoryData.preview=e,this.pickerVisible=!1},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;if(e===this.addCategoryForm){if(this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.addCategoryData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(this.tableData.findIndex((e=>e.slug==this.addCategoryData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;const e=await this.addItemInDB({context:x.s,data:{name:this.addCategoryData.name,parent:this.addCategoryData.parent,preview:this.addCategoryData.preview,slug:this.addCategoryData.slug,description:this.addCategoryData.description,display:this.addCategoryData.display,position:this.addCategoryData.position,color:this.addCategoryData.color}});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}else if(e===this.editCategoryForm){const e={};if(this.tr(this.currentEditItem.name)!==this.tr(this.editCategoryData.name)&&this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.editCategoryData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(e["name"]=this.editCategoryData.name,this.currentEditItem.slug!==this.editCategoryData.slug&&this.tableData.findIndex((e=>e.slug==this.editCategoryData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;if(e["slug"]=this.editCategoryData.slug,this.currentEditItem.description!==this.editCategoryData.description&&(e["description"]=this.editCategoryData.description),this.currentEditItem.preview!==this.editCategoryData.preview&&(e["preview"]=this.editCategoryData.preview),this.currentEditItem.display!==this.editCategoryData.display&&(e["display"]=this.editCategoryData.display),this.currentEditItem.position!==this.editCategoryData.position&&(e["position"]=this.editCategoryData.position),this.currentEditItem.color!==this.editCategoryData.color&&(e["color"]=this.editCategoryData.color),!this.$_.isEmpty(e)){const t=await this.updateItemInDB({context:x.s,id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.cancelForm(e),this.init()}))},cancelForm(e){this.$refs[e].resetFields(),this.addDialog=this.editDialog=!1,this.addCategoryData.preview=this.editCategoryData.preview=""}}},T=i(83744);const P=(0,T.Z)(E,[["render",b],["__scopeId","data-v-2c13c500"]]);var S=P},59431:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return w}});var n=i(82234);const s={style:{"line-height":"36px","font-size":"18px"}},o={class:"mr-10"},r={style:{"text-align":"center","margin-top":"20px",display:"flex"}};function a(e,t,i,a,l,c){const d=(0,n.resolveComponent)("el-col"),h=(0,n.resolveComponent)("el-button"),u=(0,n.resolveComponent)("el-row"),m=(0,n.resolveComponent)("el-card"),g=(0,n.resolveComponent)("el-table-column"),p=(0,n.resolveComponent)("el-tag"),f=(0,n.resolveComponent)("el-input"),w=(0,n.resolveComponent)("el-popconfirm"),b=(0,n.resolveComponent)("el-table"),v=(0,n.resolveComponent)("el-pagination"),_=(0,n.resolveDirective)("loading");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(m,{class:"mb-10 header-card",shadow:"hover"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("b",s,(0,n.toDisplayString)(e.$t("commentsManagement")),1)])),_:1}),(0,n.createVNode)(d,{span:12,class:"text-right"},{default:(0,n.withCtx)((()=>[l.multipleSelection.length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createElementVNode)("small",o,(0,n.toDisplayString)(e.$t("selectedComment(s)",[l.multipleSelection.length])),1),(0,n.createVNode)(h,{size:"default",type:"danger",icon:"delete",onClick:t[0]||(t[0]=e=>c.deleteSelectedComments())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("delete")),1)])),_:1})],64)):(0,n.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),(0,n.createVNode)(m,{shadow:"hover"},{default:(0,n.withCtx)((()=>[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(b,{border:"",stripe:"",data:c.pagedTableData,"empty-text":e.$t("noData"),style:{width:"100%"},onSelectionChange:c.handleSelectionChange},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(g,{width:"50",type:"selection",fixed:""}),(0,n.createVNode)(g,{sortable:"",label:e.$t("content"),prop:"content",width:"175",fixed:""},{default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(e.row.content),1)])),_:1},8,["label"]),(0,n.createVNode)(g,{sortable:"",label:e.$t("date"),width:"150",fixed:""},{default:(0,n.withCtx)((t=>[(0,n.createTextVNode)((0,n.toDisplayString)(c.reformatDate(t.row.date,{inPattern:"YYYY-MM-DD HH:mm:ss",outPattern:e.dateFormat,locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,n.createVNode)(g,{sortable:"",label:e.$t("status"),width:"150"},{default:(0,n.withCtx)((t=>[parseInt(t.row.status)?((0,n.openBlock)(),(0,n.createBlock)(p,{key:0,type:"success"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("published")),1)])),_:1})):((0,n.openBlock)(),(0,n.createBlock)(p,{key:1,type:"danger"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("unpublished")),1)])),_:1}))])),_:1},8,["label"]),(0,n.createVNode)(g,{sortable:"",label:e.$t("author"),prop:"author",width:"150"},null,8,["label"]),(0,n.createVNode)(g,{sortable:"",label:e.$t("article"),prop:"article",width:"150"},{default:(0,n.withCtx)((t=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(l.articles.find((e=>e.id==t.row.article))?.title)),1)])),_:1},8,["label"]),(0,n.createVNode)(g,{align:"right",width:"200",fixed:"right"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(f,{modelValue:l.search,"onUpdate:modelValue":t[1]||(t[1]=e=>l.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,n.withCtx)((t=>[(0,n.createVNode)(w,{width:250,"cancel-button-text":e.$t("no"),"confirm-button-text":e.$t("yes"),title:e.$t("deleteCommentQuestion"),onConfirm:e=>c.deleteItem(t.$index,t.row)},{reference:(0,n.withCtx)((()=>[(0,n.createVNode)(h,{size:"small",type:"danger",icon:"delete",disabled:l.multipleSelection.length>0},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("delete")),1)])),_:1},8,["disabled"])])),_:2},1032,["cancel-button-text","confirm-button-text","title","onConfirm"])])),_:1})])),_:1},8,["data","empty-text","onSelectionChange"])),[[_,l.isLoading]]),(0,n.createElementVNode)("div",r,[(0,n.createVNode)(v,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":l.pageSize,total:l.total,onCurrentChange:c.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1})],64)}i(57658);var l=i(39355),c=i(31567),d=i(98761),h=i(38855),u=i(95340),m=i(21101),g={name:"Comments",mixins:[h.Z,c.Z,d.Z],data(){return{articles:[],multipleSelection:[],isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.content.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},async created(){this.init()},methods:{...(0,m.mapActions)("newsComment",["getAllComments"]),...(0,m.mapActions)("newsArticle",["getAllArticles"]),reformatDate:l.bK,setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},handleSelectionChange(e){this.multipleSelection=e},async init(){this.isLoading=!0;const e=await this.getAllComments();e.success&&e.data?this.tableData=e.data:this.$message.error(this.$t("anErrorOccured"));const t=await this.getAllArticles();t.success&&t.data&&(this.articles=t.data),this.isLoading=!1},async deleteItem(e,t){const i=await this.deleteItemInDB({context:u.D,id:t.id});i.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))},deleteSelectedComments(){this.$confirm(this.$t("deleteSelectedComment(s)Question",[this.multipleSelection.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=[];for(let t=0;t<this.multipleSelection.length;t++){const i=await this.deleteItemInDB({context:u.D,id:this.multipleSelection[t].id});e.push(i.success)}0==e.filter((e=>!e)).length?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured")),this.init()})).catch((()=>{}))}}},p=i(83744);const f=(0,p.Z)(g,[["render",a]]);var w=f},22632:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return y}});var n=i(12670),s=i(82234);const o={style:{"line-height":"36px","font-size":"18px"}},r={class:"mr-10"},a={style:{"text-align":"center","margin-top":"20px",display:"flex"}},l={class:"dialog-footer"},c={class:"dialog-footer"};function d(e,t,i,d,h,u){const m=(0,s.resolveComponent)("el-col"),g=(0,s.resolveComponent)("el-button"),p=(0,s.resolveComponent)("el-row"),f=(0,s.resolveComponent)("el-card"),w=(0,s.resolveComponent)("el-table-column"),b=(0,s.resolveComponent)("el-tag"),v=(0,s.resolveComponent)("el-input"),_=(0,s.resolveComponent)("el-popconfirm"),y=(0,s.resolveComponent)("el-table"),C=(0,s.resolveComponent)("el-pagination"),k=n.Z,x=(0,s.resolveComponent)("el-form-item"),A=(0,s.resolveComponent)("el-form"),E=(0,s.resolveComponent)("el-dialog"),T=(0,s.resolveDirective)("loading");return(0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createVNode)(f,{class:"mb-10 header-card",shadow:"hover"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(p,null,{default:(0,s.withCtx)((()=>[(0,s.createVNode)(m,{span:12},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("b",o,(0,s.toDisplayString)(e.$t("tagsManagement")),1)])),_:1}),(0,s.createVNode)(m,{span:12,class:"text-right"},{default:(0,s.withCtx)((()=>[h.multipleSelection.length?((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,{key:0},[(0,s.createElementVNode)("small",r,(0,s.toDisplayString)(e.$t("selectedTag(s)",[h.multipleSelection.length])),1),(0,s.createVNode)(g,{size:"default",type:"danger",icon:"delete",onClick:t[0]||(t[0]=e=>u.deleteSelectedTags())},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("delete")),1)])),_:1})],64)):((0,s.openBlock)(),(0,s.createBlock)(g,{key:1,size:"default",type:"primary",icon:"plus",onClick:t[1]||(t[1]=e=>h.addDialog=!0)},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("add")),1)])),_:1}))])),_:1})])),_:1})])),_:1}),(0,s.createVNode)(f,{shadow:"hover"},{default:(0,s.withCtx)((()=>[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(y,{border:"",stripe:"",data:u.pagedTableData,"empty-text":e.$t("noData"),style:{width:"100%"},onSelectionChange:u.handleSelectionChange},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(w,{width:"50",type:"selection",fixed:""}),(0,s.createVNode)(w,{sortable:"",label:e.$t("name"),prop:"name",width:"150",fixed:""},{default:(0,s.withCtx)((t=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.tr(t.row.name)),1)])),_:1},8,["label"]),(0,s.createVNode)(w,{sortable:"",label:e.$t("slug"),prop:"slug",width:"150",fixed:""},null,8,["label"]),(0,s.createVNode)(w,{sortable:"",label:e.$t("description"),prop:"description",width:"175","show-overflow-tooltip":""},{default:(0,s.withCtx)((t=>[(0,s.createElementVNode)("small",null,(0,s.toDisplayString)(e.tr(t.row.description)),1)])),_:1},8,["label"]),(0,s.createVNode)(w,{sortable:"",label:e.$t("relatedArticles"),width:"125"},{default:(0,s.withCtx)((e=>[e.row.count_articles?((0,s.openBlock)(),(0,s.createBlock)(b,{key:0},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.row.count_articles),1)])),_:2},1024)):(0,s.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,s.createVNode)(w,{align:"right",width:"300",fixed:"right"},{header:(0,s.withCtx)((()=>[(0,s.createVNode)(v,{modelValue:h.search,"onUpdate:modelValue":t[2]||(t[2]=e=>h.search=e),size:"small",placeholder:e.$t("search"),style:{width:"260px"}},null,8,["modelValue","placeholder"])])),default:(0,s.withCtx)((t=>[(0,s.createVNode)(g,{size:"small",type:"warning",icon:"edit",disabled:h.multipleSelection.length>0,onClick:e=>u.editItem(t.$index,t.row)},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("edit")),1)])),_:2},1032,["disabled","onClick"]),(0,s.createVNode)(_,{width:250,"cancel-button-text":e.$t("no"),"confirm-button-text":e.$t("yes"),title:e.$t("deleteTagQuestion"),onConfirm:e=>u.deleteItem(t.$index,t.row)},{reference:(0,s.withCtx)((()=>[(0,s.createVNode)(g,{size:"small",type:"danger",icon:"delete",disabled:h.multipleSelection.length>0},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("delete")),1)])),_:1},8,["disabled"])])),_:2},1032,["cancel-button-text","confirm-button-text","title","onConfirm"])])),_:1})])),_:1},8,["data","empty-text","onSelectionChange"])),[[T,h.isLoading]]),(0,s.createElementVNode)("div",a,[(0,s.createVNode)(C,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":h.pageSize,total:h.total,onCurrentChange:u.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,s.createVNode)(E,{modelValue:h.addDialog,"onUpdate:modelValue":t[8]||(t[8]=e=>h.addDialog=e),title:e.$t("addTag"),width:"40%",top:"3vh"},{footer:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",l,[(0,s.createVNode)(g,{onClick:t[6]||(t[6]=e=>u.cancelForm(h.addTagForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,s.createVNode)(g,{type:"primary",onClick:t[7]||(t[7]=e=>u.submitForm(h.addTagForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{ref:h.addTagForm,rules:h.rules,model:h.addTagData,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{prop:"name",label:e.$t("name")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,{modelValue:h.addTagData.name,"onUpdate:modelValue":t[3]||(t[3]=e=>h.addTagData.name=e),synchro:!0,"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(x,{prop:"slug",label:e.$t("slug")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(v,{modelValue:h.addTagData.slug,"onUpdate:modelValue":t[4]||(t[4]=e=>h.addTagData.slug=e),style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(x,{prop:"description",label:e.$t("description")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,{modelValue:h.addTagData.description,"onUpdate:modelValue":t[5]||(t[5]=e=>h.addTagData.description=e),type:"textarea",synchro:!0,"selector-span":5,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,s.createVNode)(E,{modelValue:h.editDialog,"onUpdate:modelValue":t[14]||(t[14]=e=>h.editDialog=e),title:e.$t("editTag"),width:"40%",top:"3vh"},{footer:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",c,[(0,s.createVNode)(g,{onClick:t[12]||(t[12]=e=>u.cancelForm(h.editTagForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,s.createVNode)(g,{type:"primary",onClick:t[13]||(t[13]=e=>u.submitForm(h.editTagForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{ref:h.editTagForm,rules:h.rules,model:h.editTagData,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{prop:"name",label:e.$t("name")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,{modelValue:h.editTagData.name,"onUpdate:modelValue":t[9]||(t[9]=e=>h.editTagData.name=e),synchro:!0,"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(x,{prop:"slug",label:e.$t("slug")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(v,{modelValue:h.editTagData.slug,"onUpdate:modelValue":t[10]||(t[10]=e=>h.editTagData.slug=e),style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(x,{prop:"description",label:e.$t("description")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,{modelValue:h.editTagData.description,"onUpdate:modelValue":t[11]||(t[11]=e=>h.editTagData.description=e),type:"textarea",synchro:!0,"selector-span":5,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"])],64)}var h=i(46962),u=i.n(h),m=(i(57658),i(31567)),g=i(98761),p=i(38855),f=i(19412),w=i(21101),b={name:"Tags",mixins:[p.Z,m.Z,g.Z],data(){return{editTagData:{name:"",slug:"",description:""},addTagData:{name:"",slug:"",description:""},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],slug:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},multipleSelection:[],addTagForm:"addTagForm",editTagForm:"editTagForm",currentEditItem:null,editDialog:!1,addDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())||e.slug.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},watch:{"addTagData.name":{handler(e){this.addTagData.slug=u()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"addTagData.slug":{handler(e){this.addTagData.slug=u()(e,{trim:!0,lower:!0,strict:!0})}},"editTagData.name":{handler(e){this.editTagData.slug=u()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"editTagData.slug":{handler(e){this.editTagData.slug=u()(e,{trim:!0,lower:!0,strict:!0})}}},async created(){this.init()},methods:{...(0,w.mapActions)("newsTag",["getAllTags"]),...(0,w.mapActions)("newsArticle",["getAllArticles"]),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},handleSelectionChange(e){this.multipleSelection=e},async init(){this.isLoading=!0;const e=await this.getAllTags();e.success&&e.data?this.tableData=e.data:this.$message.error(this.$t("anErrorOccured")),this.countCategoriesArticles(),this.isLoading=!1},async countCategoriesArticles(){const e=await this.getAllArticles(),t=[];e.success&&e.data&&(e.data.forEach((e=>{let i;try{i=JSON.parse(e.tags)}catch(n){i=[]}t.push(i)})),this.tableData.forEach((e=>{e.count_articles=t.filter((t=>t.includes(e.id)))?.length||0})))},async editItem(e,t){this.currentEditItem=t,this.editTagData.name=t.name,this.editTagData.slug=t.slug,this.editTagData.description=t.description,this.editDialog=!0},async deleteItem(e,t){const i=await this.deleteItemInDB({context:f.Z,id:t.id});i.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))},deleteSelectedTags(){this.$confirm(this.$t("deleteSelectedTag(s)Question",[this.multipleSelection.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=[];for(let t=0;t<this.multipleSelection.length;t++){const i=await this.deleteItemInDB({context:f.Z,id:this.multipleSelection[t].id});e.push(i.success)}0==e.filter((e=>!e)).length?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured")),this.init()})).catch((()=>{}))},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;if(e===this.addTagForm){if(this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.addTagData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(this.tableData.findIndex((e=>e.slug==this.addTagData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;const e=await this.addItemInDB({context:f.Z,data:{name:this.addTagData.name,slug:this.addTagData.slug,description:this.addTagData.description}});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}else if(e===this.editTagForm){const e={};if(this.tr(this.currentEditItem.name)!==this.tr(this.editTagData.name)&&this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.editTagData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(e["name"]=this.editTagData.name,this.currentEditItem.slug!==this.editTagData.slug&&this.tableData.findIndex((e=>e.slug==this.editTagData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;if(e["slug"]=this.editTagData.slug,this.currentEditItem.description!==this.editTagData.description&&(e["description"]=this.editTagData.description),!this.$_.isEmpty(e)){const t=await this.updateItemInDB({context:f.Z,id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.cancelForm(e),this.init()}))},cancelForm(e){this.$refs[e].resetFields(),this.addDialog=this.editDialog=!1}}},v=i(83744);const _=(0,v.Z)(b,[["render",d]]);var y=_},31567:function(e,t,i){"use strict";var n=i(14340),s=i(21101);t["Z"]={created(){const e=-1===this.restrictedScopes.findIndex((e=>this.$route.name.includes(e.value)));e||this.$router.replace(n.Z5.LOGIN.PATH)},computed:{...(0,s.mapState)({userData:e=>e.session.userData,accessList:e=>e.access.accessList}),...(0,s.mapGetters)({userScopes:"access/getUserScopes",restrictedScopes:"access/getUserRestrictedScopes",disabledModuleScopes:"access/getDisabledModuleScopes",userPageScopes:"access/getUserPageScopes",userActionScopes:"access/getUserActionScopes",userSectionScopes:"access/getUserSectionScopes",userPageScope:"access/getUserPageScope",userActionScope:"access/getUserActionScope",userSectionScope:"access/getUserSectionScope"})},methods:{...(0,s.mapActions)("access",["getAllAccess"]),getAccessName(e){const t=this.accessList.find((t=>t.id==e));return t?t.name:""}}}},59607:function(e,t,i){"use strict";var n=i(46962),s=i.n(n),o=(i(57658),i(39355)),r=i(14340),a=i(92829),l=i(31567),c=i(98761),d=i(38855),h=i(38644),u=i(21101);t["Z"]={mixins:[d.Z,l.Z,c.Z],data(){return{Routes:r.Z5,ArticleStatus:r.af,categories:[],articleStatus:[],articleData:{title:"",content:"",slug:"",tags:[],categories:[],summary:"",featuredImage:"",allowComment:1,status:r.af.DRAFT.id,author:0},pickerVisible:!1,NEWS_ARTICLE_CONTEXT:h.z}},created(){this.$_.forIn(r.af,(e=>{e.id!=r.af.TRASH.id&&this.articleStatus.push(e)}))},watch:{"articleData.title":{handler(e){this.articleData.slug=s()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"articleData.slug":{handler(e){this.articleData.slug=s()(e,{trim:!0,lower:!0,strict:!0})}}},computed:{...(0,u.mapState)({tags:e=>e.newsTag.tags,users:e=>e.user.users}),dataProvided(){return this.articleData.title&&this.articleData.slug&&this.articleData.content&&this.articleData.summary}},methods:{...(0,u.mapActions)("newsCategory",["getCategoriesByParent"]),...(0,u.mapActions)("newsArticle",["getAllArticles"]),capitalizeFirstLetter:a.fm,reformatDate:o.bK,slugify:s(),async loadCategories(){this.categories=[];const e=await this.getCategoriesByParent(0);if(e.success&&e.data){const t=e.data;for(let e=0;e<t.length;e++){const i=await this.getCategoriesByParent(t[e].id);t[e].isParent=!0,this.categories.push(t[e]),i.success&&i.data&&i.data.forEach((e=>{this.categories.push(e)}))}}},addFeaturedImage(){this.pickerVisible=!0},onFeaturedImageSelected(e){this.articleData.featuredImage=e,this.pickerVisible=!1}}}},38855:function(e,t,i){"use strict";i(57658);var n=i(39355),s=i(14340),o=i(20747),r=i(21101);t["Z"]={data(){return{Routes:s.Z5,Currencies:s.Kt,WebsiteInfo:s.a,currencies:[]}},async created(){this.$_.forIn(s.Kt,((e,t)=>{this.currencies.push(e)})),this.$store.commit("global/updateCurrentPanelPath",this.$route.path,{root:!0});const e=await this.getItemFromDB({context:o.A,id:this.userData?.id});e.success&&e.data&&e.data.status==s.dp.DISABLED&&(this.destroySession(),this.$router.replace(s.Z5.LOGIN.PATH))},computed:{...(0,r.mapState)({userData:e=>e.session.userData}),...(0,r.mapGetters)({isUserConnected:"session/isUserConnected",getSettingValue:"setting/getSettingValue"})},methods:{formatDate:n.p6,reformatDate:n.bK,...(0,r.mapMutations)({destroySession:"session/destroySession"})}}}}]);
//# sourceMappingURL=group-news.71d64481.js.map