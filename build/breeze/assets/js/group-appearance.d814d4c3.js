(self["webpackChunkbreeze"]=self["webpackChunkbreeze"]||[]).push([[45],{99726:function(){!function(e){const t=e.fr=e.fr||{};t.dictionary=Object.assign(t.dictionary||{},{"%0 of %1":"%0 sur %1",Aquamarine:"Bleu vert",Black:"Noir","Block quote":"Citation",Blue:"Bleu",Bold:"Gras","Break text":"","Bulleted List":"Liste à puces",Cancel:"Annuler","Cannot upload file:":"Envoi du fichier échoué :","Centered image":"Image centrée","Change image text alternative":"Changer le texte alternatif à l’image","Choose heading":"Choisir l'en-tête",Column:"Colonne","Could not insert image at the current position.":"Impossible d'insérer l'image à la position courante.","Could not obtain resized image URL.":"Impossible d'obtenir l'image redimensionnée","Decrease indent":"Diminuer le retrait","Delete column":"Supprimer la colonne","Delete row":"Supprimer la ligne","Dim grey":"Gris pâle",Downloadable:"Fichier téléchargeable","Dropdown toolbar":"Barre d'outils dans un menu déroulant","Edit block":"Modifier le bloc","Edit link":"Modifier le lien","Editor toolbar":"Barre d'outils de l'éditeur","Enter image caption":"Saisir la légende de l’image","Full size image":"Image taille réelle",Green:"Vert",Grey:"Gris","Header column":"Colonne d'entête","Header row":"Ligne d'entête",Heading:"En-tête","Heading 1":"Titre 1","Heading 2":"Titre 2","Heading 3":"Titre 3","Heading 4":"Titre 4","Heading 5":"Titre 5","Heading 6":"Titre 6","Image toolbar":"Barre d'outils des images","image widget":"Objet image","In line":"","Increase indent":"Augmenter le retrait","Insert column left":"Insérer une colonne à gauche","Insert column right":"Insérer une colonne à droite","Insert image":"Insérer une image","Insert image or file":"Insérer une image ou un fichier","Insert media":"Insérer un média","Insert paragraph after block":"Insérer du texte après ce bloc","Insert paragraph before block":"Insérer du texte avant ce bloc","Insert row above":"Insérer une ligne au-dessus","Insert row below":"Insérer une ligne en-dessous","Insert table":"Insérer un tableau","Inserting image failed":"L'insertion d'image a échoué.",Italic:"Italique","Left aligned image":"Image alignée à gauche","Light blue":"Bleu clair","Light green":"Vert clair","Light grey":"Gris clair",Link:"Lien","Link URL":"URL du lien","Media URL":"URL de média","media widget":"Widget média","Merge cell down":"Fusionner la cellule en-dessous","Merge cell left":"Fusionner la cellule à gauche","Merge cell right":"Fusionner la cellule à droite","Merge cell up":"Fusionner la cellule au-dessus","Merge cells":"Fusionner les cellules",Next:"Suivant","Numbered List":"Liste numérotée","Open in a new tab":"Ouvrir dans un nouvel onglet","Open link in new tab":"Ouvrir le lien dans un nouvel onglet",Orange:"Orange",Paragraph:"Paragraphe","Paste the media URL in the input.":"Coller l'URL du média",Previous:"Précedent",Purple:"Violet",Red:"Rouge",Redo:"Restaurer","Rich Text Editor":"Éditeur de texte enrichi","Rich Text Editor, %0":"Éditeur de texte enrichi, %0","Right aligned image":"Image alignée à droite",Row:"Ligne",Save:"Enregistrer","Select all":"Sélectionner tout","Select column":"Sélectionner la colonne","Select row":"Sélectionner la ligne","Selecting resized image failed":"La sélection de l'image redimensionnée a échoué.","Show more items":"Montrer plus d'éléments","Side image":"Image latérale","Split cell horizontally":"Scinder la cellule horizontalement","Split cell vertically":"Scinder la cellule verticalement","Table toolbar":"Barre d'outils des tableaux","Text alternative":"Texte alternatif","The URL must not be empty.":"L'URL ne doit pas être vide.","This link has no URL":"Ce lien n'a pas d'URL","This media URL is not supported.":"Cette URL de média n'est pas supportée.","Tip: Paste the URL into the content to embed faster.":"Astuce : Copier l'URL du média dans le contenu pour l'insérer plus rapidement","Toggle caption off":"","Toggle caption on":"",Turquoise:"Turquoise",Undo:"Annuler",Unlink:"Supprimer le lien","Upload failed":"Échec de l'envoi","Upload in progress":"Téléchargement en cours",White:"Blanc","Widget toolbar":"Barre d'outils du widget","Wrap text":"",Yellow:"Jaune"}),t.getPluralForm=function(e){return e>1}}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={}))},39494:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var n=i(82234);function o(e,t,i,o,s,r){return(0,n.openBlock)(),(0,n.createElementBlock)("button",{onClick:t[0]||(t[0]=(...e)=>o.copy&&o.copy(...e))},[(0,n.renderSlot)(e.$slots,"default")])}var s=i(76109),r=i.n(s),a={name:"Copy",props:{toCopy:{type:String,default:""}},emits:["copy"],setup(e,t){const{toClipboard:i}=r()(),n=async()=>{try{await i(e.toCopy),t.emit("copy",e.toCopy,!0)}catch(n){console.error(n),t.emit("copy",e.toCopy,!1)}};return{copy:n}}},l=i(83744);const c=(0,l.Z)(a,[["render",o]]);var d=c},31377:function(e,t,i){"use strict";i.d(t,{Z:function(){return oE}});var n=i(68716),o=i(82234);function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("ckeditor"),c=n.Z,d=(0,o.resolveComponent)("el-dialog");return(0,o.openBlock)(),(0,o.createElementBlock)("section",null,[(0,o.createVNode)(l,{editor:r.editor,"tag-name":i.tagName,disabled:i.disabled,config:r.editorConfig,"model-value":i.modelValue?.replace(new RegExp(r.BASE_URL_MUSTACHE,"g"),r.STORAGE_API_BASE_URL),class:"page-content-editor",onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t?.replace(new RegExp(r.STORAGE_API_BASE_URL,"g"),r.BASE_URL_MUSTACHE))),onDestroy:t[1]||(t[1]=t=>e.$emit("destroy",t)),onReady:t[2]||(t[2]=t=>e.$emit("ready",t)),onFocus:t[3]||(t[3]=t=>e.$emit("focus",t)),onBlur:t[4]||(t[4]=t=>e.$emit("blur",t))},null,8,["editor","tag-name","disabled","config","model-value"]),(0,o.createVNode)(d,{modelValue:r.mediaPickerVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>r.mediaPickerVisible=e),title:e.$t("add"),"destroy-on-close":"",fullscreen:""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{multiple:!0,"display-videos":!0,"display-audios":!0,"display-images":!0,"display-documents":!0,"display-other-types":!0,"enable-add-from-an-url":!1,"enable-selection-details":!0,onSelected:a.onMediasSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])])}var r=i(75010),a=i(41371),l=i(45642),c='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M7 19L12 14L13.88 15.88C13.33 16.79 13 17.86 13 19H7M10 10.5C10 9.67 9.33 9 8.5 9S7 9.67 7 10.5 7.67 12 8.5 12 10 11.33 10 10.5M13.09 20H6V4H13V9H18V13.09C18.33 13.04 18.66 13 19 13C19.34 13 19.67 13.04 20 13.09V8L14 2H6C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H13.81C13.46 21.39 13.21 20.72 13.09 20M18 15V18H15V20H18V23H20V20H23V18H20V15H18Z" /></svg>';const{t:d}=r.Z.global;class h extends a.Z{init(){const e=this.editor;e.ui.componentFactory.add("addBreezeMedias",(e=>{const t=new l.Z(e);return t.set({label:d("add"),icon:c,withText:!1,tooltip:!0}),t.on("execute",(()=>{const e=new Event("add-breeze-medias");document.dispatchEvent(e)})),t}))}}var u='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z" /></svg>',m='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z" /></svg>';const{t:g}=r.Z.global;class p extends a.Z{init(){const e=this.editor;e.ui.componentFactory.add("fullScreen",(t=>{const i=new l.Z(t);let n=0;return i.set({label:g("fullscreen"),icon:m,withText:!1,tooltip:!0}),i.on("execute",(()=>{1==n?(e.sourceElement.nextElementSibling.removeAttribute("id"),document.body.removeAttribute("id"),i.set({label:g("fullscreen"),icon:m,withText:!1,tooltip:!0}),n=0):(e.sourceElement.nextElementSibling.setAttribute("id","fullscreeneditor"),document.body.setAttribute("id","fullscreenoverlay"),i.set({label:g("normalSize"),icon:u,withText:!1,tooltip:!0}),n=1)})),i}))}}var f=i(11165),w=i(14340),b=i(7397);i(57658);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class v extends b.Z{constructor(e){super(e),this._childCommands=[]}refresh(){}execute(...e){const t=this._getFirstEnabledCommand();return null!=t&&t.execute(e)}registerChildCommand(e){this._childCommands.push(e),e.on("change:isEnabled",(()=>this._checkEnabled())),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find((e=>e.isEnabled))}}var _=i(37514),y=i(24612),k=i(18533);function C(e){return(0,k.Z)(e)&&1===e.nodeType&&!(0,_.Z)(e)}var x=C;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class V{constructor(e,t){this._config={},t&&this.define(A(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){const i=!0;this._setToTarget(this._config,e,t,i)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,i,n=!1){if((0,_.Z)(t))return void this._setObjectToTarget(e,t,n);const o=t.split(".");t=o.pop();for(const s of o)(0,_.Z)(e[s])||(e[s]={}),e=e[s];if((0,_.Z)(i))return(0,_.Z)(e[t])||(e[t]={}),e=e[t],void this._setObjectToTarget(e,i,n);n&&"undefined"!=typeof e[t]||(e[t]=i)}_getFromSource(e,t){const i=t.split(".");t=i.pop();for(const n of i){if(!(0,_.Z)(e[n])){e=null;break}e=e[n]}return e?A(e[t]):void 0}_setObjectToTarget(e,t,i){Object.keys(t).forEach((n=>{this._setToTarget(e,n,t[n],i)}))}}function A(e){return(0,y.Z)(e,E)}function E(e){return x(e)?e:void 0}var T=i(32364),P=i(13117),S=i(3026),I=i(61409);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class N{constructor(e,t=[],i=[]){this._context=e,this._plugins=new Map,this._availablePlugins=new Map;for(const n of t)n.pluginName&&this._availablePlugins.set(n.pluginName,n);this._contextPlugins=new Map;for(const[n,o]of i)this._contextPlugins.set(n,o),this._contextPlugins.set(o,n),n.pluginName&&this._availablePlugins.set(n.pluginName,n)}*[Symbol.iterator](){for(const e of this._plugins)"function"==typeof e[0]&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let t=e;throw"function"==typeof e&&(t=e.pluginName||e.name),new P.ZP("plugincollection-plugin-not-loaded",this._context,{plugin:t})}return t}has(e){return this._plugins.has(e)}init(e,t=[],i=[]){const n=this,o=this._context;u(e),g(e);const s=e.filter((e=>!d(e,t))),r=[...m(s)];_(r,i);const a=b(r);return v(a,"init").then((()=>v(a,"afterInit"))).then((()=>a));function l(e){return"function"===typeof e}function c(e){return l(e)&&e.isContextPlugin}function d(e,t){return t.some((t=>t===e||(h(e)===t||h(t)===e)))}function h(e){return l(e)?e.pluginName||e.name:e}function u(e,t=new Set){e.forEach((e=>{l(e)&&(t.has(e)||(t.add(e),e.pluginName&&!n._availablePlugins.has(e.pluginName)&&n._availablePlugins.set(e.pluginName,e),e.requires&&u(e.requires,t)))}))}function m(e,t=new Set){return e.map((e=>l(e)?e:n._availablePlugins.get(e))).reduce(((e,i)=>t.has(i)?e:(t.add(i),i.requires&&(g(i.requires,i),m(i.requires,t).forEach((t=>e.add(t)))),e.add(i))),new Set)}function g(e,t=null){e.map((e=>l(e)?e:n._availablePlugins.get(e)||e)).forEach((e=>{p(e,t),f(e,t),w(e,t)}))}function p(e,t){if(!l(e)){if(t)throw new P.ZP("plugincollection-soft-required",o,{missingPlugin:e,requiredBy:h(t)});throw new P.ZP("plugincollection-plugin-not-found",o,{plugin:e})}}function f(e,t){if(c(t)&&!c(e))throw new P.ZP("plugincollection-context-required",o,{plugin:h(e),requiredBy:h(t)})}function w(e,i){if(i&&d(e,t))throw new P.ZP("plugincollection-required",o,{plugin:h(e),requiredBy:h(i)})}function b(e){return e.map((e=>{const t=n._contextPlugins.get(e)||new e(o);return n._add(e,t),t}))}function v(e,t){return e.reduce(((e,i)=>i[t]?n._contextPlugins.has(i)?e:e.then(i[t].bind(i)):e),Promise.resolve())}function _(e,t){for(const i of t){if("function"!=typeof i)throw new P.ZP("plugincollection-replace-plugin-invalid-type",null,{pluginItem:i});const t=i.pluginName;if(!t)throw new P.ZP("plugincollection-replace-plugin-missing-name",null,{pluginItem:i});if(i.requires&&i.requires.length)throw new P.ZP("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:t});const o=n._availablePlugins.get(t);if(!o)throw new P.ZP("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:t});const s=e.indexOf(o);if(-1===s){if(n._contextPlugins.has(o))return;throw new P.ZP("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:t})}if(o.requires&&o.requires.length)throw new P.ZP("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:t});e.splice(s,1,i),n._availablePlugins.set(t,i)}}}destroy(){const e=[];for(const[,t]of this)"function"!=typeof t.destroy||this._contextPlugins.has(t)||e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const i=e.pluginName;if(i){if(this._plugins.has(i))throw new P.ZP("plugincollection-plugin-name-conflict",null,{pluginName:i,plugin1:this._plugins.get(i).constructor,plugin2:e});this._plugins.set(i,t)}}}(0,I.Z)(N,S.ZP);var B=i(77125);function R(e,t,i=1){if("number"!==typeof i)throw new P.ZP("translation-service-quantity-not-a-number",null,{quantity:i});const n=M();1===n&&(e=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const o=t.id||t.string;if(0===n||!D(e,o))return 1!==i?t.plural:t.string;const s=window.CKEDITOR_TRANSLATIONS[e].dictionary,r=window.CKEDITOR_TRANSLATIONS[e].getPluralForm||(e=>1===e?0:1);if("string"===typeof s[o])return s[o];const a=Number(r(i));return s[o][a]}function D(e,t){return!!window.CKEDITOR_TRANSLATIONS[e]&&!!window.CKEDITOR_TRANSLATIONS[e].dictionary[t]}function M(){return Object.keys(window.CKEDITOR_TRANSLATIONS).length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const O=["ar","ara","fa","per","fas","he","heb","ku","kur","ug","uig"];function L(e){return O.includes(e)?"rtl":"ltr"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class F{constructor(e={}){this.uiLanguage=e.uiLanguage||"en",this.contentLanguage=e.contentLanguage||this.uiLanguage,this.uiLanguageDirection=L(this.uiLanguage),this.contentLanguageDirection=L(this.contentLanguage),this.t=(e,t)=>this._t(e,t)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=(0,B.Z)(t),"string"===typeof e&&(e={string:e});const i=!!e.plural,n=i?t[0]:1,o=R(this.uiLanguage,e,n);return z(o,t)}}function z(e,t){return e.replace(/%(\d+)/g,((e,i)=>i<t.length?t[i]:e))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ${constructor(e){this.config=new V(e,this.constructor.defaultConfig);const t=this.constructor.builtinPlugins;this.config.define("plugins",t),this.plugins=new N(this,t);const i=this.config.get("language")||{};this.locale=new F({uiLanguage:"string"===typeof i?i:i.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new T.Z,this._contextOwner=null}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const i of e.concat(t)){if("function"!=typeof i)throw new P.ZP("context-initplugins-constructor-only",null,{Plugin:i});if(!0!==i.isContextPlugin)throw new P.ZP("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,(e=>e.destroy()))).then((()=>this.plugins.destroy()))}_addEditor(e,t){if(this._contextOwner)throw new P.ZP("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise((t=>{const i=new this(e);t(i.initPlugins().then((()=>i)))}))}}var Z=i(75880);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class W{constructor(e){this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}(0,I.Z)(W,Z.Z);i(30541);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function H(e,t){const i=Math.min(e.length,t.length);for(let n=0;n<i;n++)if(e[n]!=t[n])return n;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}var U=i(92346);i(92310);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class q{constructor(e){this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new P.ZP("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;while(e.parent)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;while(t.parent)e.unshift(t.index),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}getCommonAncestor(e,t={}){const i=this.getAncestors(t),n=e.getAncestors(t);let o=0;while(i[o]==n[o]&&i[o])o++;return 0===o?null:i[o-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),i=e.getPath(),n=H(t,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<i[n]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire("change:"+e,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=(0,U.Z)(this);return delete e.parent,e}is(e){return"node"===e||"view:node"===e}}(0,I.Z)(q,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class G extends q{constructor(e,t){super(e),this._textData=t}is(e){return"$text"===e||"view:$text"===e||"text"===e||"view:text"===e||"node"===e||"view:node"===e}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof G&&(this===e||this.data===e.data)}_clone(){return new G(this.document,this.data)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class j{constructor(e,t,i){if(this.textNode=e,t<0||t>e.data.length)throw new P.ZP("view-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.data.length)throw new P.ZP("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return"$textProxy"===e||"view:$textProxy"===e||"textProxy"===e||"view:textProxy"===e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this.textNode:this.parent;while(null!==i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function K(e){const t=new Map;for(const i in e)t.set(i,e[i]);return t}var J=i(34665);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Y(e){return(0,J.Z)(e)?new Map(e):K(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Q{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)("string"==typeof t||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const e of this._patterns){const i=X(t,e);if(i)return{element:t,pattern:e,match:i}}return null}matchAll(...e){const t=[];for(const i of e)for(const e of this._patterns){const n=X(i,e);n&&t.push({element:i,pattern:e,match:n})}return t.length>0?t:null}getElementName(){if(1!==this._patterns.length)return null;const e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t}}function X(e,t){if("function"==typeof t)return t(e);const i={};return t.name&&(i.name=ee(t.name,e.name),!i.name)||t.attributes&&(i.attributes=se(t.attributes,e),!i.attributes)?null:!(t.classes&&(i.classes=re(t.classes,e),!i.classes))&&(!(t.styles&&(i.styles=ae(t.styles,e),!i.styles))&&i)}function ee(e,t){return e instanceof RegExp?!!t.match(e):e===t}function te(e,t,i){const n=ie(e),o=Array.from(t),s=[];return n.forEach((([e,t])=>{o.forEach((n=>{ne(e,n)&&oe(t,n,i)&&s.push(n)}))})),!n.length||s.length<n.length?null:s}function ie(e){return Array.isArray(e)?e.map((e=>(0,_.Z)(e)?(void 0!==e.key&&void 0!==e.value||(0,P.KE)("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0])):(0,_.Z)(e)?Object.entries(e):[[e,!0]]}function ne(e,t){return!0===e||e===t||e instanceof RegExp&&t.match(e)}function oe(e,t,i){if(!0===e)return!0;const n=i(t);return e===n||e instanceof RegExp&&!!String(n).match(e)}function se(e,t){const i=new Set(t.getAttributeKeys());return(0,_.Z)(e)?(void 0!==e.style&&(0,P.KE)("matcher-pattern-deprecated-attributes-style-key",e),void 0!==e.class&&(0,P.KE)("matcher-pattern-deprecated-attributes-class-key",e)):(i.delete("style"),i.delete("class")),te(e,i,(e=>t.getAttribute(e)))}function re(e,t){return te(e,t.getClassNames())}function ae(e,t){return te(e,t.getStyleNames(!0),(e=>t.getStyle(e)))}var le=i(77226),ce=i(22823);function de(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var he=de,ue=i(13317);function me(e,t,i){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),i=i>o?o:i,i<0&&(i+=o),o=t>i?0:i-t>>>0,t>>>=0;var s=Array(o);while(++n<o)s[n]=e[n+t];return s}var ge=me;function pe(e,t){return t.length<2?e:(0,ue.Z)(e,ge(t,0,-1))}var fe=pe,we=i(62281);function be(e,t){return t=(0,ce.Z)(t,e),e=fe(e,t),null==e||delete e[(0,we.Z)(he(t))]}var ve=be;function _e(e,t){return null==e||ve(e,t)}var ye=_e,ke=i(16423),Ce=i(40987),xe=i(48707);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ve{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){const e=Object.entries(this._styles),t=Array.from(e);return!t.length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=Array.from(Ee(e).entries());for(const[i,n]of t)this._styleProcessor.toNormalizedForm(i,n,this._styles)}has(e){if(this.isEmpty)return!1;const t=this._styleProcessor.getReducedForm(e,this._styles),i=t.find((([t])=>t===e));return Array.isArray(i)}set(e,t){if((0,le.Z)(e))for(const[i,n]of Object.entries(e))this._styleProcessor.toNormalizedForm(i,n,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t=Te(e);ye(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map((e=>e.join(":"))).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!(0,le.Z)(this._styles[e]))return this._styles[e];const t=this._styleProcessor.getReducedForm(e,this._styles),i=t.find((([t])=>t===e));return Array.isArray(i)?i[1]:void 0}getStyleNames(e=!1){if(this.isEmpty)return[];if(e)return this._styleProcessor.getStyleNames(this._styles);const t=this._getStylesEntries();return t.map((([e])=>e))}clear(){this._styles={}}_getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const i of t)e.push(...this._styleProcessor.getReducedForm(i,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split("."),i=t.length>1;if(!i)return;const n=t.splice(0,t.length-1).join("."),o=(0,ke.Z)(this._styles,n);if(!o)return;const s=!Array.from(Object.keys(o)).length;s&&this.remove(n)}}class Ae{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,i){if((0,le.Z)(t))Pe(i,Te(e),t);else if(this._normalizers.has(e)){const n=this._normalizers.get(e),{path:o,value:s}=n(t);Pe(i,o,s)}else Pe(i,e,t)}getNormalized(e,t){if(!e)return(0,Ce.Z)({},t);if(void 0!==t[e])return t[e];if(this._extractors.has(e)){const i=this._extractors.get(e);if("string"===typeof i)return(0,ke.Z)(t,i);const n=i(e,t);if(n)return n}return(0,ke.Z)(t,Te(e))}getReducedForm(e,t){const i=this.getNormalized(e,t);if(void 0===i)return[];if(this._reducers.has(e)){const t=this._reducers.get(e);return t(i)}return[[e,i]]}getStyleNames(e){const t=Array.from(this._consumables.keys()).filter((t=>{const i=this.getNormalized(t,e);return i&&"object"==typeof i?Object.keys(i).length:i})),i=new Set([...t,...Object.keys(e)]);return Array.from(i.values())}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const i of t)this._mapStyleNames(i,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function Ee(e){let t=null,i=0,n=0,o=null;const s=new Map;if(""===e)return s;";"!=e.charAt(e.length-1)&&(e+=";");for(let r=0;r<e.length;r++){const a=e.charAt(r);if(null===t)switch(a){case":":o||(o=e.substr(i,r-i),n=r+1);break;case'"':case"'":t=a;break;case";":{const t=e.substr(n,r-n);o&&s.set(o.trim(),t.trim()),o=null,i=r+1;break}}else a===t&&(t=null)}return s}function Te(e){return e.replace("-",".")}function Pe(e,t,i){let n=i;(0,le.Z)(i)&&(n=(0,Ce.Z)({},(0,ke.Z)(e,t),i)),(0,xe.Z)(e,t,n)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Se extends q{constructor(e,t,i,n){if(super(e),this.name=t,this._attrs=Ie(i),this._children=[],n&&this._insertChild(0,n),this._classes=new Set,this._attrs.has("class")){const e=this._attrs.get("class");Ne(this._classes,e),this._attrs.delete("class")}this._styles=new Ve(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map,this._isAllowedInsideAttributeElement=!1,this._unsafeAttributesToRender=[]}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}get isAllowedInsideAttributeElement(){return this._isAllowedInsideAttributeElement}is(e,t=null){return t?t===this.name&&("element"===e||"view:element"===e):"element"===e||"view:element"===e||"node"===e||"view:node"===e}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if("class"==e)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==e){const e=this._styles.toString();return""==e?void 0:e}return this._attrs.get(e)}hasAttribute(e){return"class"==e?this._classes.size>0:"style"==e?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof Se))return!1;if(this===e)return!0;if(this.name!=e.name)return!1;if(this.isAllowedInsideAttributeElement!=e.isAllowedInsideAttributeElement)return!1;if(this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,i]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==i)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const t of this._styles.getStyleNames())if(!e._styles.has(t)||e._styles.getAsString(t)!==this._styles.getAsString(t))return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e=!1){return this._styles.getStyleNames(e)}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new Q(...e);let i=this.parent;while(i){if(t.match(i))return i;i=i.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=this._styles.toString(),i=Array.from(this._attrs).map((e=>`${e[0]}="${e[1]}"`)).sort().join(" ");return this.name+(""==e?"":` class="${e}"`)+(t?` style="${t}"`:"")+(""==i?"":` ${i}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const t=[];if(e)for(const n of this.getChildren())t.push(n._clone(e));const i=new this.constructor(this.document,this.name,this._attrs,t);return i._classes=new Set(this._classes),i._styles.set(this._styles.getNormalized()),i._customProperties=new Map(this._customProperties),i.getFillerOffset=this.getFillerOffset,i._isAllowedInsideAttributeElement=this.isAllowedInsideAttributeElement,i}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let i=0;const n=Be(this.document,t);for(const o of n)null!==o.parent&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(e,0,o),e++,i++;return i}_removeChildren(e,t=1){this._fireChange("children",this);for(let i=e;i<e+t;i++)this._children[i].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){t=String(t),this._fireChange("attributes",this),"class"==e?Ne(this._classes,t):"style"==e?this._styles.setTo(t):this._attrs.set(e,t)}_removeAttribute(e){return this._fireChange("attributes",this),"class"==e?this._classes.size>0&&(this._classes.clear(),!0):"style"==e?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const t of(0,B.Z)(e))this._classes.add(t)}_removeClass(e){this._fireChange("attributes",this);for(const t of(0,B.Z)(e))this._classes.delete(t)}_setStyle(e,t){this._fireChange("attributes",this),this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this);for(const t of(0,B.Z)(e))this._styles.remove(t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}function Ie(e){e=Y(e);for(const[t,i]of e)null===i?e.delete(t):"string"!=typeof i&&e.set(t,String(i));return e}function Ne(e,t){const i=t.split(/\s+/);e.clear(),i.forEach((t=>e.add(t)))}function Be(e,t){return"string"==typeof t?[new G(e,t)]:((0,J.Z)(t)||(t=[t]),Array.from(t).map((t=>"string"==typeof t?new G(e,t):t instanceof j?new G(e,t.data):t)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Re extends Se{constructor(e,t,i,n){super(e,t,i,n),this.getFillerOffset=De}is(e,t=null){return t?t===this.name&&("containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}}function De(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const i of e)if(!i.is("uiElement"))return null;return this.childCount}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Me extends Re{constructor(e,t,i,n){super(e,t,i,n),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",(t=>t&&e.selection.editableElement==this)),this.listenTo(e.selection,"change",(()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this}))}is(e,t=null){return t?t===this.name&&("editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}destroy(){this.stopListening()}}(0,I.Z)(Me,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Oe=Symbol("rootName");class Le extends Me{constructor(e,t){super(e,t),this.rootName="main"}is(e,t=null){return t?t===this.name&&("rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}get rootName(){return this.getCustomProperty(Oe)}set rootName(e){this._setCustomProperty(Oe,e)}set _name(e){this.name=e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fe{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new P.ZP("view-tree-walker-no-start-position",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new P.ZP("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=ze._createAt(e.startPosition):this.position=ze._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(e){let t,i,n;do{n=this.position,({done:t,value:i}=this.next())}while(!t&&e(i));t||(this.position=n)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,i=e.parent;if(null===i.parent&&e.offset===i.childCount)return{done:!0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};let n;if(i instanceof G){if(e.isAtEnd)return this.position=ze._createAfter(i),this._next();n=i.data[e.offset]}else n=i.getChild(e.offset);if(n instanceof Se)return this.shallow?e.offset++:e=new ze(n,0),this.position=e,this._formatReturnValue("elementStart",n,t,e,1);if(n instanceof G){if(this.singleCharacters)return e=new ze(n,0),this.position=e,this._next();{let i,o=n.data.length;return n==this._boundaryEndParent?(o=this.boundaries.end.offset,i=new j(n,0,o),e=ze._createAfter(i)):(i=new j(n,0,n.data.length),e.offset++),this.position=e,this._formatReturnValue("text",i,t,e,o)}}if("string"==typeof n){let n;if(this.singleCharacters)n=1;else{const t=i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length;n=t-e.offset}const o=new j(i,e.offset,n);return e.offset+=n,this.position=e,this._formatReturnValue("text",o,t,e,n)}return e=ze._createAfter(i),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,t,e)}_previous(){let e=this.position.clone();const t=this.position,i=e.parent;if(null===i.parent&&0===e.offset)return{done:!0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};let n;if(i instanceof G){if(e.isAtStart)return this.position=ze._createBefore(i),this._previous();n=i.data[e.offset-1]}else n=i.getChild(e.offset-1);if(n instanceof Se)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",n,t,e,1)):(e=new ze(n,n.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",n,t,e));if(n instanceof G){if(this.singleCharacters)return e=new ze(n,n.data.length),this.position=e,this._previous();{let i,o=n.data.length;if(n==this._boundaryStartParent){const t=this.boundaries.start.offset;i=new j(n,t,n.data.length-t),o=i.data.length,e=ze._createBefore(i)}else i=new j(n,0,n.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",i,t,e,o)}}if("string"==typeof n){let n;if(this.singleCharacters)n=1;else{const t=i===this._boundaryStartParent?this.boundaries.start.offset:0;n=e.offset-t}e.offset-=n;const o=new j(i,e.offset,n);return this.position=e,this._formatReturnValue("text",o,t,e,n)}return e=ze._createBefore(i),this.position=e,this._formatReturnValue("elementStart",i,t,e,1)}_formatReturnValue(e,t,i,n,o){return t instanceof j&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?i=ze._createAfter(t.textNode):(n=ze._createAfter(t.textNode),this.position=n)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?i=ze._createBefore(t.textNode):(n=ze._createBefore(t.textNode),this.position=n))),{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:n,length:o}}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ze{constructor(e,t){this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;while(!(e instanceof Me)){if(!e.parent)return null;e=e.parent}return e}getShiftedBy(e){const t=ze._createAt(this),i=t.offset+e;return t.offset=i<0?0:i,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const i=new Fe(t);return i.skip(e),i.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),i=e.getAncestors();let n=0;while(t[n]==i[n]&&t[n])n++;return 0===n?null:t[n-1]}is(e){return"position"===e||"view:position"===e}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return"before"==this.compareWith(e)}isAfter(e){return"after"==this.compareWith(e)}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],i=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),i.push(e.offset);const n=H(t,i);switch(n){case"prefix":return"before";case"extension":return"after";default:return t[n]<i[n]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Fe(e)}clone(){return new ze(this.parent,this.offset)}static _createAt(e,t){if(e instanceof ze)return new this(e.parent,e.offset);{const i=e;if("end"==t)t=i.is("$text")?i.data.length:i.childCount;else{if("before"==t)return this._createBefore(i);if("after"==t)return this._createAfter(i);if(0!==t&&!t)throw new P.ZP("view-createpositionat-offset-required",i)}return new ze(i,t)}}static _createAfter(e){if(e.is("$textProxy"))return new ze(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new P.ZP("view-position-after-root",e,{root:e});return new ze(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new ze(e.textNode,e.offsetInText);if(!e.parent)throw new P.ZP("view-position-before-root",e,{root:e});return new ze(e.parent,e.index)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $e{constructor(e,t=null){this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new Fe({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Ze,{direction:"backward"}),t=this.end.getLastMatchingPosition(Ze);return e.parent.is("$text")&&e.isAtStart&&(e=ze._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=ze._createAfter(t.parent)),new $e(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(Ze);if(e.isAfter(this.end)||e.isEqual(this.end))return new $e(e,e);let t=this.end.getLastMatchingPosition(Ze,{direction:"backward"});const i=e.nodeAfter,n=t.nodeBefore;return i&&i.is("$text")&&(e=new ze(i,0)),n&&n.is("$text")&&(t=new ze(n,n.data.length)),new $e(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&n}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new $e(this.start,e.start)),this.containsPosition(e.end)&&t.push(new $e(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,i=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(i=e.end),new $e(t,i)}return null}getWalker(e={}){return e.boundaries=this,new Fe(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new $e(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Fe(e);for(const i of t)yield i.item}*getPositions(e={}){e.boundaries=this;const t=new Fe(e);yield t.position;for(const i of t)yield i.nextPosition}is(e){return"range"===e||"view:range"===e}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,i,n){return new this(new ze(e,t),new ze(i,n))}static _createFromPositionAndShift(e,t){const i=e,n=e.getShiftedBy(t);return t>0?new this(i,n):new this(n,i)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(ze._createBefore(e),t)}}function Ze(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function We(e){let t=0;for(const i of e)t++;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class He{constructor(e=null,t,i){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,t,i)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1],t=this._lastRangeBackward?e.end:e.start;return t.clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1],t=this._lastRangeBackward?e.start:e.end;return t.clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel)return!1;if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let i=!1;for(const n of e._ranges)if(t.isEqual(n)){i=!0;break}if(!i)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=We(this.getRanges()),i=We(e.getRanges());if(t!=i)return!1;if(0==t)return!0;for(let n of this.getRanges()){n=n.getTrimmed();let t=!1;for(let i of e.getRanges())if(i=i.getTrimmed(),n.start.isEqual(i.start)&&n.end.isEqual(i.end)){t=!0;break}if(!t)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(e,t,i){if(null===e)this._setRanges([]),this._setFakeOptions(t);else if(e instanceof He||e instanceof Ue)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof $e)this._setRanges([e],t&&t.backward),this._setFakeOptions(t);else if(e instanceof ze)this._setRanges([new $e(e)]),this._setFakeOptions(t);else if(e instanceof q){const n=!!i&&!!i.backward;let o;if(void 0===t)throw new P.ZP("view-selection-setto-required-second-parameter",this);o="in"==t?$e._createIn(e):"on"==t?$e._createOn(e):new $e(ze._createAt(e,t)),this._setRanges([o],n),this._setFakeOptions(i)}else{if(!(0,J.Z)(e))throw new P.ZP("view-selection-setto-not-selectable",this);this._setRanges(e,t&&t.backward),this._setFakeOptions(t)}this.fire("change")}setFocus(e,t){if(null===this.anchor)throw new P.ZP("view-selection-setfocus-no-ranges",this);const i=ze._createAt(e,t);if("same"==i.compareWith(this.focus))return;const n=this.anchor;this._ranges.pop(),"before"==i.compareWith(n)?this._addRange(new $e(i,n),!0):this._addRange(new $e(n,i)),this.fire("change")}is(e){return"selection"===e||"view:selection"===e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const i of e)this._addRange(i);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof $e))throw new P.ZP("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new P.ZP("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new $e(e.start,e.end))}}(0,I.Z)(He,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ue{constructor(e=null,t,i){this._selection=new He,this._selection.delegate("change").to(this),this._selection.setTo(e,t,i)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}is(e){return"selection"===e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e}_setTo(e,t,i){this._selection.setTo(e,t,i)}_setFocus(e,t){this._selection.setFocus(e,t)}}(0,I.Z)(Ue,S.ZP);var qe=i(48810);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ge extends qe.Z{constructor(e,t,i){super(e,t),this.startRange=i,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const je=Symbol("bubbling contexts"),Ke={fire(e,...t){try{const i=e instanceof qe.Z?e:new qe.Z(this,e),n=et(this);if(!n.size)return;if(Ye(i,"capturing",this),Qe(n,"$capture",i,...t))return i.return;const o=i.startRange||this.selection.getFirstRange(),s=o?o.getContainedElement():null,r=!!s&&Boolean(Xe(n,s));let a=s||tt(o);if(Ye(i,"atTarget",a),!r){if(Qe(n,"$text",i,...t))return i.return;Ye(i,"bubbling",a)}while(a){if(a.is("rootElement")){if(Qe(n,"$root",i,...t))return i.return}else if(a.is("element")&&Qe(n,a.name,i,...t))return i.return;if(Qe(n,a,i,...t))return i.return;a=a.parent,Ye(i,"bubbling",a)}return Ye(i,"bubbling",this),Qe(n,"$document",i,...t),i.return}catch(i){P.ZP.rethrowUnexpectedError(i,this)}},_addEventListener(e,t,i){const n=(0,B.Z)(i.context||"$document"),o=et(this);for(const s of n){let n=o.get(s);n||(n=Object.create(S.ZP),o.set(s,n)),this.listenTo(n,e,t,i)}},_removeEventListener(e,t){const i=et(this);for(const n of i.values())this.stopListening(n,e,t)}};var Je=Ke;function Ye(e,t,i){e instanceof Ge&&(e._eventPhase=t,e._currentTarget=i)}function Qe(e,t,i,...n){const o="string"==typeof t?e.get(t):Xe(e,t);return!!o&&(o.fire(i,...n),i.stop.called)}function Xe(e,t){for(const[i,n]of e)if("function"==typeof i&&i(t))return n;return null}function et(e){return e[je]||(e[je]=new Map),e[je]}function tt(e){if(!e)return null;const t=e.start.parent,i=e.end.parent,n=t.getPath(),o=i.getPath();return n.length>o.length?t:i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class it{constructor(e){this.selection=new Ue,this.roots=new T.Z({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map((e=>e.destroy())),this.stopListening()}_callPostFixers(e){let t=!1;do{for(const i of this._postFixers)if(t=i(e),t)break}while(t)}}(0,I.Z)(it,Je),(0,I.Z)(it,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const nt=10;class ot extends Se{constructor(e,t,i,n){super(e,t,i,n),this.getFillerOffset=st,this._priority=nt,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new P.ZP("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}is(e,t=null){return t?t===this.name&&("attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e):"attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}function st(){if(rt(this))return null;let e=this.parent;while(e&&e.is("attributeElement")){if(rt(e)>1)return null;e=e.parent}return!e||rt(e)>1?null:this.childCount}function rt(e){return Array.from(e.getChildren()).filter((e=>!e.is("uiElement"))).length}ot.DEFAULT_PRIORITY=nt;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class at extends Se{constructor(e,t,i,n){super(e,t,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=lt}is(e,t=null){return t?t===this.name&&("emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e):"emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new P.ZP("view-emptyelement-cannot-add",[this,t])}}function lt(){return null}var ct=i(41700);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dt extends Se{constructor(e,t,i,n){super(e,t,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=ut}is(e,t=null){return t?t===this.name&&("uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e):"uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new P.ZP("view-uielement-cannot-add",this)}render(e){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const i of this.getAttributeKeys())t.setAttribute(i,this.getAttribute(i));return t}}function ht(e){e.document.on("arrowKey",((t,i)=>mt(t,i,e.domConverter)),{priority:"low"})}function ut(){return null}function mt(e,t,i){if(t.keyCode==ct.Do.arrowright){const e=t.domTarget.ownerDocument.defaultView.getSelection(),n=1==e.rangeCount&&e.getRangeAt(0).collapsed;if(n||t.shiftKey){const t=e.focusNode,o=e.focusOffset,s=i.domPositionToView(t,o);if(null===s)return;let r=!1;const a=s.getLastMatchingPosition((e=>(e.item.is("uiElement")&&(r=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement")))));if(r){const t=i.viewPositionToDom(a);n?e.collapse(t.parent,t.offset):e.extend(t.parent,t.offset)}}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gt extends Se{constructor(e,t,i,n){super(e,t,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=pt}is(e,t=null){return t?t===this.name&&("rawElement"===e||"view:rawElement"===e||"element"===e||"view:element"===e):"rawElement"===e||"view:rawElement"===e||e===this.name||e==="view:"+this.name||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new P.ZP("view-rawelement-cannot-add",[this,t])}}function pt(){return null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ft{constructor(e,t){this.document=e,this._children=[],t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"view:documentFragment"===e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let i=0;const n=wt(this.document,t);for(const o of n)null!==o.parent&&o._remove(),o.parent=this,this._children.splice(e,0,o),e++,i++;return i}_removeChildren(e,t=1){this._fireChange("children",this);for(let i=e;i<e+t;i++)this._children[i].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}}function wt(e,t){return"string"==typeof t?[new G(e,t)]:((0,J.Z)(t)||(t=[t]),Array.from(t).map((t=>"string"==typeof t?new G(e,t):t instanceof j?new G(e,t.data):t)))}(0,I.Z)(ft,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bt{constructor(e){this.document=e,this._cloneGroups=new Map}setSelection(e,t,i){this.document.selection._setTo(e,t,i)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new ft(this.document,e)}createText(e){return new G(this.document,e)}createAttributeElement(e,t,i={}){const n=new ot(this.document,e,t);return"number"===typeof i.priority&&(n._priority=i.priority),i.id&&(n._id=i.id),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createContainerElement(e,t,i={}){const n=new Re(this.document,e,t);return void 0!==i.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createEditableElement(e,t,i={}){const n=new Me(this.document,e,t);return n._document=this.document,i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createEmptyElement(e,t,i={}){const n=new at(this.document,e,t);return void 0!==i.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),i.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),n}createUIElement(e,t,i,n={}){const o=new dt(this.document,e,t);return i&&(o.render=i),void 0!==n.isAllowedInsideAttributeElement&&(o._isAllowedInsideAttributeElement=n.isAllowedInsideAttributeElement),o}createRawElement(e,t,i,n={}){const o=new gt(this.document,e,t);return o.render=i||(()=>{}),void 0!==n.isAllowedInsideAttributeElement&&(o._isAllowedInsideAttributeElement=n.isAllowedInsideAttributeElement),n.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),o}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){(0,_.Z)(e)&&void 0===i&&(i=t),i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof ze?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new P.ZP("view-writer-break-non-container-element",this.document);if(!t.parent)throw new P.ZP("view-writer-break-root",this.document);if(e.isAtStart)return ze._createBefore(t);if(!e.isAtEnd){const i=t._clone(!1);this.insert(ze._createAfter(t),i);const n=new $e(e,ze._createAt(t,"end")),o=new ze(i,0);this.move(n,o)}return ze._createAfter(t)}mergeAttributes(e){const t=e.offset,i=e.parent;if(i.is("$text"))return e;if(i.is("attributeElement")&&0===i.childCount){const e=i.parent,t=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new ze(e,t))}const n=i.getChild(t-1),o=i.getChild(t);if(!n||!o)return e;if(n.is("$text")&&o.is("$text"))return xt(n,o);if(n.is("attributeElement")&&o.is("attributeElement")&&n.isSimilar(o)){const e=n.childCount;return n._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new ze(n,e))}return e}mergeContainers(e){const t=e.nodeBefore,i=e.nodeAfter;if(!t||!i||!t.is("containerElement")||!i.is("containerElement"))throw new P.ZP("view-writer-merge-containers-invalid-position",this.document);const n=t.getChild(t.childCount-1),o=n instanceof G?ze._createAt(n,"end"):ze._createAt(t,"end");return this.move($e._createIn(i),ze._createAt(t,"end")),this.remove($e._createOn(i)),o}insert(e,t){t=(0,J.Z)(t)?[...t]:[t],Vt(t,this.document);const i=t.reduce(((e,t)=>{const i=e[e.length-1],n=!(t.is("uiElement")&&t.isAllowedInsideAttributeElement);return i&&i.breakAttributes==n?i.nodes.push(t):e.push({breakAttributes:n,nodes:[t]}),e}),[]);let n=null,o=e;for(const{nodes:s,breakAttributes:r}of i){const e=this._insertNodes(o,s,r);n||(n=e.start),o=e.end}return n?new $e(n,o):new $e(e)}remove(e){const t=e instanceof $e?e:$e._createOn(e);if(Tt(t,this.document),t.isCollapsed)return new ft(this.document);const{start:i,end:n}=this._breakAttributesRange(t,!0),o=i.parent,s=n.offset-i.offset,r=o._removeChildren(i.offset,s);for(const l of r)this._removeFromClonedElementsGroup(l);const a=this.mergeAttributes(i);return t.start=a,t.end=a.clone(),new ft(this.document,r)}clear(e,t){Tt(e,this.document);const i=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const n of i){const i=n.item;let o;if(i.is("element")&&t.isSimilar(i))o=$e._createOn(i);else if(!n.nextPosition.isAfter(e.start)&&i.is("$textProxy")){const e=i.getAncestors().find((e=>e.is("element")&&t.isSimilar(e)));e&&(o=$e._createIn(e))}o&&(o.end.isAfter(e.end)&&(o.end=e.end),o.start.isBefore(e.start)&&(o.start=e.start),this.remove(o))}}move(e,t){let i;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const n=t.parent,o=n.childCount;e=this._breakAttributesRange(e,!0),i=this.remove(e),t.offset+=n.childCount-o}else i=this.remove(e);return this.insert(t,i)}wrap(e,t){if(!(t instanceof ot))throw new P.ZP("view-writer-wrap-invalid-attribute",this.document);if(Tt(e,this.document),e.isCollapsed){let i=e.start;i.parent.is("element")&&!vt(i.parent)&&(i=i.getLastMatchingPosition((e=>e.item.is("uiElement")))),i=this._wrapPosition(i,t);const n=this.document.selection;return n.isCollapsed&&n.getFirstPosition().isEqual(e.start)&&this.setSelection(i),new $e(i)}return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof ot))throw new P.ZP("view-writer-unwrap-invalid-attribute",this.document);if(Tt(e,this.document),e.isCollapsed)return e;const{start:i,end:n}=this._breakAttributesRange(e,!0),o=i.parent,s=this._unwrapChildren(o,i.offset,n.offset,t),r=this.mergeAttributes(s.start);r.isEqual(s.start)||s.end.offset--;const a=this.mergeAttributes(s.end);return new $e(r,a)}rename(e,t){const i=new Re(this.document,e,t.getAttributes());return this.insert(ze._createAfter(t),i),this.move($e._createIn(t),ze._createAt(i,0)),this.remove($e._createOn(t)),i}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return ze._createAt(e,t)}createPositionAfter(e){return ze._createAfter(e)}createPositionBefore(e){return ze._createBefore(e)}createRange(e,t){return new $e(e,t)}createRangeOn(e){return $e._createOn(e)}createRangeIn(e){return $e._createIn(e)}createSelection(e,t,i){return new He(e,t,i)}_insertNodes(e,t,i){let n,o;if(n=i?_t(e):e.parent.is("$text")?e.parent.parent:e.parent,!n)throw new P.ZP("view-writer-invalid-position-container",this.document);o=i?this._breakAttributes(e,!0):e.parent.is("$text")?Ct(e):e;const s=n._insertChild(o.offset,t);for(const c of t)this._addToClonedElementsGroup(c);const r=o.getShiftedBy(s),a=this.mergeAttributes(o);a.isEqual(o)||r.offset--;const l=this.mergeAttributes(r);return new $e(a,l)}_wrapChildren(e,t,i,n){let o=t;const s=[];while(o<i){const t=e.getChild(o),i=t.is("$text"),r=t.is("attributeElement"),a=t.isAllowedInsideAttributeElement;if(r&&this._wrapAttributeElement(n,t))s.push(new ze(e,o));else if(i||a||r&&yt(n,t)){const i=n._clone();t._remove(),i._appendChild(t),e._insertChild(o,i),this._addToClonedElementsGroup(i),s.push(new ze(e,o))}else r&&this._wrapChildren(t,0,t.childCount,n);o++}let r=0;for(const a of s){if(a.offset-=r,a.offset==t)continue;const e=this.mergeAttributes(a);e.isEqual(a)||(r++,i--)}return $e._createFromParentsAndOffsets(e,t,e,i)}_unwrapChildren(e,t,i,n){let o=t;const s=[];while(o<i){const t=e.getChild(o);if(t.is("attributeElement"))if(t.isSimilar(n)){const n=t.getChildren(),r=t.childCount;t._remove(),e._insertChild(o,n),this._removeFromClonedElementsGroup(t),s.push(new ze(e,o),new ze(e,o+r)),o+=r,i+=r-1}else this._unwrapAttributeElement(n,t)?(s.push(new ze(e,o),new ze(e,o+1)),o++):(this._unwrapChildren(t,0,t.childCount,n),o++);else o++}let r=0;for(const a of s){if(a.offset-=r,a.offset==t||a.offset==i)continue;const e=this.mergeAttributes(a);e.isEqual(a)||(r++,i--)}return $e._createFromParentsAndOffsets(e,t,e,i)}_wrapRange(e,t){const{start:i,end:n}=this._breakAttributesRange(e,!0),o=i.parent,s=this._wrapChildren(o,i.offset,n.offset,t),r=this.mergeAttributes(s.start);r.isEqual(s.start)||s.end.offset--;const a=this.mergeAttributes(s.end);return new $e(r,a)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return kt(e.clone());e.parent.is("$text")&&(e=Ct(e));const i=this.createAttributeElement();i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,e.parent._insertChild(e.offset,i);const n=new $e(e,e.getShiftedBy(1));this.wrap(n,t);const o=new ze(i.parent,i.index);i._remove();const s=o.nodeBefore,r=o.nodeAfter;return s instanceof G&&r instanceof G?xt(s,r):kt(o)}_wrapAttributeElement(e,t){if(!Pt(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if("class"!==i&&"style"!==i&&t.hasAttribute(i)&&t.getAttribute(i)!==e.getAttribute(i))return!1;for(const i of e.getStyleNames())if(t.hasStyle(i)&&t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())"class"!==i&&"style"!==i&&(t.hasAttribute(i)||this.setAttribute(i,e.getAttribute(i),t));for(const i of e.getStyleNames())t.hasStyle(i)||this.setStyle(i,e.getStyle(i),t);for(const i of e.getClassNames())t.hasClass(i)||this.addClass(i,t);return!0}_unwrapAttributeElement(e,t){if(!Pt(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if("class"!==i&&"style"!==i&&(!t.hasAttribute(i)||t.getAttribute(i)!==e.getAttribute(i)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const i of e.getStyleNames())if(!t.hasStyle(i)||t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())"class"!==i&&"style"!==i&&this.removeAttribute(i,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const i=e.start,n=e.end;if(Tt(e,this.document),e.isCollapsed){const i=this._breakAttributes(e.start,t);return new $e(i,i)}const o=this._breakAttributes(n,t),s=o.parent.childCount,r=this._breakAttributes(i,t);return o.offset+=o.parent.childCount-s,new $e(r,o)}_breakAttributes(e,t=!1){const i=e.offset,n=e.parent;if(e.parent.is("emptyElement"))throw new P.ZP("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new P.ZP("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new P.ZP("view-writer-cannot-break-raw-element",this.document);if(!t&&n.is("$text")&&Et(n.parent))return e.clone();if(Et(n))return e.clone();if(n.is("$text"))return this._breakAttributes(Ct(e),t);const o=n.childCount;if(i==o){const e=new ze(n.parent,n.index+1);return this._breakAttributes(e,t)}if(0===i){const e=new ze(n.parent,n.index);return this._breakAttributes(e,t)}{const e=n.index+1,o=n._clone();n.parent._insertChild(e,o),this._addToClonedElementsGroup(o);const s=n.childCount-i,r=n._removeChildren(i,s);o._appendChild(r);const a=new ze(n.parent,e);return this._breakAttributes(a,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const n of e.getChildren())this._addToClonedElementsGroup(n);const t=e.id;if(!t)return;let i=this._cloneGroups.get(t);i||(i=new Set,this._cloneGroups.set(t,i)),i.add(e),e._clonesGroup=i}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const n of e.getChildren())this._removeFromClonedElementsGroup(n);const t=e.id;if(!t)return;const i=this._cloneGroups.get(t);i&&i.delete(e)}}function vt(e){return Array.from(e.getChildren()).some((e=>!e.is("uiElement")))}function _t(e){let t=e.parent;while(!Et(t)){if(!t)return;t=t.parent}return t}function yt(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity()}function kt(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new ze(t,t.data.length);const i=e.nodeAfter;return i&&i.is("$text")?new ze(i,0):e}function Ct(e){if(e.offset==e.parent.data.length)return new ze(e.parent.parent,e.parent.index+1);if(0===e.offset)return new ze(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new G(e.root.document,t)),new ze(e.parent.parent,e.parent.index+1)}function xt(e,t){const i=e.data.length;return e._data+=t.data,t._remove(),new ze(e,i)}function Vt(e,t){for(const i of e){if(!At.some((e=>i instanceof e)))throw new P.ZP("view-writer-insert-invalid-node-type",t);i.is("$text")||Vt(i.getChildren(),t)}}const At=[G,ot,Re,at,gt,dt];function Et(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function Tt(e,t){const i=_t(e.start),n=_t(e.end);if(!i||!n||i!==n)throw new P.ZP("view-writer-invalid-range-container",t)}function Pt(e,t){return null===e.id&&null===t.id}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function St(e){return"[object Text]"==Object.prototype.toString.call(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const It=e=>e.createTextNode(" "),Nt=e=>{const t=e.createElement("span");return t.dataset.ckeFiller=!0,t.innerHTML=" ",t},Bt=e=>{const t=e.createElement("br");return t.dataset.ckeFiller=!0,t},Rt=7,Dt="⁠".repeat(Rt);function Mt(e){return St(e)&&e.data.substr(0,Rt)===Dt}function Ot(e){return e.data.length==Rt&&Mt(e)}function Lt(e){return Mt(e)?e.data.slice(Rt):e.data}function Ft(e){e.document.on("arrowKey",zt,{priority:"low"})}function zt(e,t){if(t.keyCode==ct.Do.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(1==e.rangeCount&&e.getRangeAt(0).collapsed){const t=e.getRangeAt(0).startContainer,i=e.getRangeAt(0).startOffset;Mt(t)&&i<=Rt&&e.collapse(t,0)}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $t(e,t,i,n=!1){i=i||function(e,t){return e===t},Array.isArray(e)||(e=Array.prototype.slice.call(e)),Array.isArray(t)||(t=Array.prototype.slice.call(t));const o=Zt(e,t,i);return n?qt(o,t.length):Ut(t,o)}function Zt(e,t,i){const n=Wt(e,t,i);if(-1===n)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const o=Ht(e,n),s=Ht(t,n),r=Wt(o,s,i),a=e.length-r,l=t.length-r;return{firstIndex:n,lastIndexOld:a,lastIndexNew:l}}function Wt(e,t,i){for(let n=0;n<Math.max(e.length,t.length);n++)if(void 0===e[n]||void 0===t[n]||!i(e[n],t[n]))return n;return-1}function Ht(e,t){return e.slice(t).reverse()}function Ut(e,t){const i=[],{firstIndex:n,lastIndexOld:o,lastIndexNew:s}=t;return s-n>0&&i.push({index:n,type:"insert",values:e.slice(n,s)}),o-n>0&&i.push({index:n+(s-n),type:"delete",howMany:o-n}),i}function qt(e,t){const{firstIndex:i,lastIndexOld:n,lastIndexNew:o}=e;if(-1===i)return Array(t).fill("equal");let s=[];return i>0&&(s=s.concat(Array(i).fill("equal"))),o-i>0&&(s=s.concat(Array(o-i).fill("insert"))),n-i>0&&(s=s.concat(Array(n-i).fill("delete"))),o<t&&(s=s.concat(Array(t-o).fill("equal"))),s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gt(e,t,i){i=i||function(e,t){return e===t};const n=e.length,o=t.length;if(n>200||o>200||n+o>300)return Gt.fastDiff(e,t,i,!0);let s,r;if(o<n){const i=e;e=t,t=i,s="delete",r="insert"}else s="insert",r="delete";const a=e.length,l=t.length,c=l-a,d={},h={};function u(n){const o=(void 0!==h[n-1]?h[n-1]:-1)+1,c=void 0!==h[n+1]?h[n+1]:-1,u=o>c?-1:1;d[n+u]&&(d[n]=d[n+u].slice(0)),d[n]||(d[n]=[]),d[n].push(o>c?s:r);let m=Math.max(o,c),g=m-n;while(g<a&&m<l&&i(e[g],t[m]))g++,m++,d[n].push("equal");return m}let m,g=0;do{for(m=-g;m<c;m++)h[m]=u(m);for(m=c+g;m>c;m--)h[m]=u(m);h[c]=u(c),g++}while(h[c]!==l);return d[c].slice(1)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jt(e,t,i){e.insertBefore(i,e.childNodes[t]||null)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Kt(e){const t=e.parentNode;t&&t.removeChild(e)}Gt.fastDiff=$t;var Jt=i(4817),Yt=i(91704);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qt{constructor(e,t){this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),Yt.ZP.isBlink&&!Yt.ZP.isAndroid&&this.on("change:isSelecting",(()=>{this.isSelecting||this.render()})),this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new P.ZP("view-renderer-unknown-type",this);this.markedChildren.add(t)}}}render(){let e;const t=!(Yt.ZP.isBlink&&!Yt.ZP.isAndroid)||!this.isSelecting;for(const i of this.markedChildren)this._updateChildrenMappings(i);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller));for(const i of this.markedAttributes)this._updateAttrs(i);for(const i of this.markedChildren)this._updateChildren(i,{inlineFillerPosition:e});for(const i of this.markedTexts)!this.markedChildren.has(i.parent)&&this.domConverter.mapViewToDom(i.parent)&&this._updateText(i,{inlineFillerPosition:e});if(t)if(e){const t=this.domConverter.viewPositionToDom(e),i=t.parent.ownerDocument;Mt(t.parent)?this._inlineFiller=t.parent:this._inlineFiller=ei(i,t.parent,t.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(this.domConverter.mapViewToDom(e).childNodes),n=Array.from(this.domConverter.viewChildrenToDom(e,t.ownerDocument,{withChildren:!1})),o=this._diffNodeLists(i,n),s=this._findReplaceActions(o,i,n);if(-1!==s.indexOf("replace")){const t={equal:0,insert:0,delete:0};for(const o of s)if("replace"===o){const o=t.equal+t.insert,s=t.equal+t.delete,r=e.getChild(o);!r||r.is("uiElement")||r.is("rawElement")||this._updateElementMappings(r,i[s]),Kt(n[o]),t.equal++}else t[o]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?ze._createBefore(this.selection.getFirstPosition().parent):e}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&St(t.parent)&&Mt(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Mt(e))throw new P.ZP("view-renderer-filler-was-lost",this);Ot(e)?e.remove():e.data=e.data.substr(Rt),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,i=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!Xt(t))return!1;if(i===t.getFillerOffset())return!1;const n=e.nodeBefore,o=e.nodeAfter;return!(n instanceof G||o instanceof G)}_updateText(e,t){const i=this.domConverter.findCorrespondingDomText(e),n=this.domConverter.viewToDom(e,i.ownerDocument),o=i.data;let s=n.data;const r=t.inlineFillerPosition;if(r&&r.parent==e.parent&&r.offset==e.index&&(s=Dt+s),o!=s){const e=$t(o,s);for(const t of e)"insert"===t.type?i.insertData(t.index,t.values.join("")):i.deleteData(t.index,t.howMany)}}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(t.attributes).map((e=>e.name)),n=e.getAttributeKeys();for(const o of n)this.domConverter.setDomElementAttribute(t,o,e.getAttribute(o),e);for(const o of i)e.hasAttribute(o)||this.domConverter.removeDomElementAttribute(t,o)}_updateChildren(e,t){const i=this.domConverter.mapViewToDom(e);if(!i)return;const n=t.inlineFillerPosition,o=this.domConverter.mapViewToDom(e).childNodes,s=Array.from(this.domConverter.viewChildrenToDom(e,i.ownerDocument,{bind:!0}));n&&n.parent===e&&ei(i.ownerDocument,s,n.offset);const r=this._diffNodeLists(o,s);let a=0;const l=new Set;for(const c of r)"delete"===c?(l.add(o[a]),Kt(o[a])):"equal"===c&&a++;a=0;for(const c of r)"insert"===c?(jt(i,a,s[a]),a++):"equal"===c&&(this._markDescendantTextToSync(this.domConverter.domToView(s[a])),a++);for(const c of l)c.parentNode||this.domConverter.unbindDomElement(c)}_diffNodeLists(e,t){return e=oi(e,this._fakeSelectionContainer),Gt(e,t,ii.bind(null,this.domConverter))}_findReplaceActions(e,t,i){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;let n=[],o=[],s=[];const r={equal:0,insert:0,delete:0};for(const a of e)"insert"===a?s.push(i[r.equal+r.insert]):"delete"===a?o.push(t[r.equal+r.delete]):(n=n.concat(Gt(o,s,ti).map((e=>"equal"===e?"replace":e))),n.push("equal"),o=[],s=[]),r[a]++;return n.concat(Gt(o,s,ti).map((e=>"equal"===e?"replace":e)))}_markDescendantTextToSync(e){if(e)if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}_updateSelection(){if(Yt.ZP.isBlink&&!Yt.ZP.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e&&(this.selection.isFake?this._updateFakeSelection(e):(this._removeFakeSelection(),this._updateDomSelection(e)))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=si(t));const i=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(i,this.selection),!this._fakeSelectionNeedsUpdate(e))return;i.parentElement&&i.parentElement==e||e.appendChild(i),i.textContent=this.selection.fakeSelectionLabel||" ";const n=t.getSelection(),o=t.createRange();n.removeAllRanges(),o.selectNodeContents(i),n.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const i=this.domConverter.viewPositionToDom(this.selection.anchor),n=this.domConverter.viewPositionToDom(this.selection.focus);t.collapse(i.parent,i.offset),t.extend(n.parent,n.offset),Yt.ZP.isGecko&&ni(n,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return(!t||!this.selection.isEqual(t))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,i=e.ownerDocument.getSelection();return!t||t.parentElement!==e||(i.anchorNode!==t&&!t.contains(i.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel)}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const t=e.activeElement,i=this.domConverter.mapDomToView(t);t&&i&&e.getSelection().removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function Xt(e){if("false"==e.getAttribute("contenteditable"))return!1;const t=e.findAncestor((e=>e.hasAttribute("contenteditable")));return!t||"true"==t.getAttribute("contenteditable")}function ei(e,t,i){const n=t instanceof Array?t:t.childNodes,o=n[i];if(St(o))return o.data=Dt+o.data,o;{const o=e.createTextNode(Dt);return Array.isArray(t)?n.splice(i,0,o):jt(t,i,o),o}}function ti(e,t){return(0,Jt.Z)(e)&&(0,Jt.Z)(t)&&!St(e)&&!St(t)&&e.nodeType!==Node.COMMENT_NODE&&t.nodeType!==Node.COMMENT_NODE&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function ii(e,t,i){return t===i||(St(t)&&St(i)?t.data===i.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(i)))}function ni(e,t){const i=e.parent;if(i.nodeType!=Node.ELEMENT_NODE||e.offset!=i.childNodes.length-1)return;const n=i.childNodes[e.offset];n&&"BR"==n.tagName&&t.addRange(t.getRangeAt(0))}function oi(e,t){const i=Array.from(e);if(0==i.length||!t)return i;const n=i[i.length-1];return n==t&&i.pop(),i}function si(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}(0,I.Z)(Qt,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */var ri={window:window,document:document};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ai(e){let t=0;while(e.previousSibling)e=e.previousSibling,t++;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function li(e){const t=[];while(e&&e.nodeType!=Node.DOCUMENT_NODE)t.unshift(e),e=e.parentNode;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ci=Bt(document),di=It(document),hi=Nt(document),ui="data-ck-unsafe-attribute-",mi="data-ck-unsafe-element";class gi{constructor(e,t={}){this.document=e,this.renderingMode=t.renderingMode||"editing",this.blockFillerMode=t.blockFillerMode||("editing"===this.renderingMode?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new Q,this._encounteredRawContentDomNodes=new WeakSet}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new He(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const t of e.childNodes)this.unbindDomElement(t)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,i){return"data"===this.renderingMode||(e=e.toLowerCase(),!e.startsWith("on")&&(("srcdoc"!==e||!t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i))&&("img"===i&&("src"===e||"srcset"===e)||("source"===i&&"srcset"===e||!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i)))))}setContentOf(e,t){if("data"===this.renderingMode)return void(e.innerHTML=t);const i=(new DOMParser).parseFromString(t,"text/html"),n=i.createDocumentFragment(),o=i.body.childNodes;while(o.length>0)n.appendChild(o[0]);const s=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT),r=[];let a;while(a=s.nextNode())r.push(a);for(const l of r){for(const t of l.getAttributeNames())this.setDomElementAttribute(l,t,l.getAttribute(t));const e=l.tagName.toLowerCase();this._shouldRenameElement(e)&&((0,P.KE)("domconverter-unsafe-element-detected",{unsafeElement:l}),l.replaceWith(this._createReplacementDomElement(e,l)))}while(e.firstChild)e.firstChild.remove();e.append(n)}viewToDom(e,t,i={}){if(e.is("$text")){const i=this._processDataFromViewText(e);return t.createTextNode(i)}{if(this.mapViewToDom(e))return this.mapViewToDom(e);let n;if(e.is("documentFragment"))n=t.createDocumentFragment(),i.bind&&this.bindDocumentFragments(n,e);else{if(e.is("uiElement"))return n="$comment"===e.name?t.createComment(e.getCustomProperty("$rawContent")):e.render(t,this),i.bind&&this.bindElements(n,e),n;this._shouldRenameElement(e.name)?((0,P.KE)("domconverter-unsafe-element-detected",{unsafeElement:e}),n=this._createReplacementDomElement(e.name)):n=e.hasAttribute("xmlns")?t.createElementNS(e.getAttribute("xmlns"),e.name):t.createElement(e.name),e.is("rawElement")&&e.render(n,this),i.bind&&this.bindElements(n,e);for(const t of e.getAttributeKeys())this.setDomElementAttribute(n,t,e.getAttribute(t),e)}if(!1!==i.withChildren)for(const o of this.viewChildrenToDom(e,t,i))n.appendChild(o);return n}}setDomElementAttribute(e,t,i,n=null){const o=this.shouldRenderAttribute(t,i,e.tagName.toLowerCase())||n&&n.shouldRenderUnsafeAttribute(t);o||(0,P.KE)("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:i}),e.hasAttribute(t)&&!o?e.removeAttribute(t):e.hasAttribute(ui+t)&&o&&e.removeAttribute(ui+t),e.setAttribute(o?t:ui+t,i)}removeDomElementAttribute(e,t){t!=mi&&(e.removeAttribute(t),e.removeAttribute(ui+t))}*viewChildrenToDom(e,t,i={}){const n=e.getFillerOffset&&e.getFillerOffset();let o=0;for(const s of e.getChildren())n===o&&(yield this._getBlockFiller(t)),yield this.viewToDom(s,t,i),o++;n===o&&(yield this._getBlockFiller(t))}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),i=this.viewPositionToDom(e.end),n=document.createRange();return n.setStart(t.parent,t.offset),n.setEnd(i.parent,i.offset),n}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const i=this.findCorrespondingDomText(t);if(!i)return null;let n=e.offset;return Mt(i)&&(n+=Rt),{parent:i,offset:n}}{let i,n,o;if(0===e.offset){if(i=this.mapViewToDom(t),!i)return null;o=i.childNodes[0]}else{const t=e.nodeBefore;if(n=t.is("$text")?this.findCorrespondingDomText(t):this.mapViewToDom(e.nodeBefore),!n)return null;i=n.parentNode,o=n.nextSibling}if(St(o)&&Mt(o))return{parent:o,offset:Rt};const s=n?ai(n)+1:0;return{parent:i,offset:s}}}domToView(e,t={}){if(this.isBlockFiller(e))return null;const i=this.getHostViewElement(e);if(i)return i;if(this.isComment(e)&&t.skipComments)return null;if(St(e)){if(Ot(e))return null;{const t=this._processDataFromDomText(e);return""===t?null:new G(this.document,t)}}{if(this.mapDomToView(e))return this.mapDomToView(e);let i;if(this.isDocumentFragment(e))i=new ft(this.document),t.bind&&this.bindDocumentFragments(e,i);else{i=this._createViewElement(e,t),t.bind&&this.bindElements(e,i);const n=e.attributes;if(n)for(let e=n.length-1;e>=0;e--)i._setAttribute(n[e].name,n[e].value);if(this._isViewElementWithRawContent(i,t)||this.isComment(e)){const t=this.isComment(e)?e.data:e.innerHTML;return i._setCustomProperty("$rawContent",t),this._encounteredRawContentDomNodes.add(e),i}}if(!1!==t.withChildren)for(const n of this.domChildrenToView(e,t))i._appendChild(n);return i}}*domChildrenToView(e,t={}){for(let i=0;i<e.childNodes.length;i++){const n=e.childNodes[i],o=this.domToView(n,t);null!==o&&(yield o)}}domSelectionToView(e){if(1===e.rangeCount){let t=e.getRangeAt(0).startContainer;St(t)&&(t=t.parentNode);const i=this.fakeSelectionToView(t);if(i)return i}const t=this.isDomSelectionBackward(e),i=[];for(let n=0;n<e.rangeCount;n++){const t=e.getRangeAt(n),o=this.domRangeToView(t);o&&i.push(o)}return new He(i,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),i=this.domPositionToView(e.endContainer,e.endOffset);return t&&i?new $e(t,i):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,ai(e));const i=this.mapDomToView(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return ze._createBefore(i);if(St(e)){if(Ot(e))return this.domPositionToView(e.parentNode,ai(e));const i=this.findCorrespondingViewText(e);let n=t;return i?(Mt(e)&&(n-=Rt,n=n<0?0:n),new ze(i,n)):null}if(0===t){const t=this.mapDomToView(e);if(t)return new ze(t,0)}else{const i=e.childNodes[t-1],n=St(i)?this.findCorrespondingViewText(i):this.mapDomToView(i);if(n&&n.parent)return new ze(n.parent,n.index+1)}return null}mapDomToView(e){const t=this.getHostViewElement(e);return t||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(Ot(e))return null;const t=this.getHostViewElement(e);if(t)return t;const i=e.previousSibling;if(i){if(!this.isElement(i))return null;const e=this.mapDomToView(i);if(e){const t=e.nextSibling;return t instanceof G?e.nextSibling:null}}else{const t=this.mapDomToView(e.parentNode);if(t){const e=t.getChild(0);return e instanceof G?e:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:e,scrollY:i}=ri.window,n=[];fi(t,(e=>{const{scrollLeft:t,scrollTop:i}=e;n.push([t,i])})),t.focus(),fi(t,(e=>{const[t,i]=n.shift();e.scrollLeft=t,e.scrollTop=i})),ri.window.scrollTo(e,i)}}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(e){return e&&e.nodeType==Node.COMMENT_NODE}isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(ci):!("BR"!==e.tagName||!bi(e,this.blockElements)||1!==e.parentNode.childNodes.length)||(e.isEqualNode(hi)||wi(e,this.blockElements))}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=document.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);const i=t.collapsed;return t.detach(),i}getHostViewElement(e){const t=li(e);t.pop();while(t.length){const e=t.pop(),i=this._domToViewMapping.get(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return i}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}_getBlockFiller(e){switch(this.blockFillerMode){case"nbsp":return It(e);case"markedNbsp":return Nt(e);case"br":return Bt(e)}}_isDomSelectionPositionCorrect(e,t){if(St(e)&&Mt(e)&&t<Rt)return!1;if(this.isElement(e)&&Mt(e.childNodes[t]))return!1;const i=this.mapDomToView(e);return!i||!i.is("uiElement")&&!i.is("rawElement")}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return t;if(" "==t.charAt(0)){const i=this._getTouchingInlineViewNode(e,!1),n=i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i);!n&&i||(t=" "+t.substr(1))}if(" "==t.charAt(t.length-1)){const i=this._getTouchingInlineViewNode(e,!0),n=i&&i.is("$textProxy")&&" "==i.data.charAt(0);" "!=t.charAt(t.length-2)&&i&&!n||(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return!1;const t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1)}_processDataFromDomText(e){let t=e.data;if(pi(e,this.preElements))return Lt(e);t=t.replace(/[ \n\t\r]{1,}/g," ");const i=this._getTouchingInlineDomNode(e,!1),n=this._getTouchingInlineDomNode(e,!0),o=this._checkShouldLeftTrimDomText(e,i),s=this._checkShouldRightTrimDomText(e,n);o&&(t=t.replace(/^ /,"")),s&&(t=t.replace(/ $/,"")),t=Lt(new Text(t)),t=t.replace(/ \u00A0/g,"  ");const r=n&&this.isElement(n)&&"BR"!=n.tagName,a=n&&St(n)&&" "==n.data.charAt(0);return(/( |\u00A0)\u00A0$/.test(t)||!n||r||a)&&(t=t.replace(/\u00A0$/," ")),(o||i&&this.isElement(i)&&"BR"!=i.tagName)&&(t=t.replace(/^\u00A0/," ")),t}_checkShouldLeftTrimDomText(e,t){return!t||(this.isElement(t)?"BR"===t.tagName:!this._encounteredRawContentDomNodes.has(e.previousSibling)&&/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(e,t){return!t&&!Mt(e)}_getTouchingInlineViewNode(e,t){const i=new Fe({startPosition:t?ze._createAfter(e):ze._createBefore(e),direction:t?"forward":"backward"});for(const n of i){if(n.item.is("element")&&this.inlineObjectElements.includes(n.item.name))return n.item;if(n.item.is("containerElement"))return null;if(n.item.is("element","br"))return null;if(n.item.is("$textProxy"))return n.item}return null}_getTouchingInlineDomNode(e,t){if(!e.parentNode)return null;const i=t?"firstChild":"lastChild",n=t?"nextSibling":"previousSibling";let o=!0;do{if(!o&&e[i]?e=e[i]:e[n]?(e=e[n],o=!1):(e=e.parentNode,o=!0),!e||this._isBlockElement(e))return null}while(!St(e)&&"BR"!=e.tagName&&!this._isInlineObjectElement(e));return e}_isBlockElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isInlineObjectElement(e){return this.isElement(e)&&this.inlineObjectElements.includes(e.tagName.toLowerCase())}_createViewElement(e,t){if(this.isComment(e))return new dt(this.document,"$comment");const i=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Se(this.document,i)}_isViewElementWithRawContent(e,t){return!1!==t.withChildren&&this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){return"editing"==this.renderingMode&&"script"==e.toLowerCase()}_createReplacementDomElement(e,t=null){const i=document.createElement("span");if(i.setAttribute(mi,e),t){while(t.firstChild)i.appendChild(t.firstChild);for(const e of t.getAttributeNames())i.setAttribute(e,t.getAttribute(e))}return i}}function pi(e,t){const i=li(e);return i.some((e=>e.tagName&&t.includes(e.tagName.toLowerCase())))}function fi(e,t){while(e&&e!=ri.document)t(e),e=e.parentNode}function wi(e,t){const i=e.isEqualNode(di);return i&&bi(e,t)&&1===e.parentNode.childNodes.length}function bi(e,t){const i=e.parentNode;return i&&i.tagName&&t.includes(i.tagName.toLowerCase())}var vi=i(49981);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _i{constructor(e){this.view=e,this.document=e.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&3===e.nodeType&&(e=e.parentNode),!(!e||1!==e.nodeType)&&e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}(0,I.Z)(_i,vi.Z);var yi=i(2674);function ki(e,t,i){i="function"==typeof i?i:void 0;var n=i?i(e,t):void 0;return void 0===n?(0,yi.Z)(e,t,void 0,i):!!n}var Ci=ki;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xi extends _i{constructor(e){super(e),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.push(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(0===e.length)return;const t=this.domConverter,i=new Map,n=new Set;for(const l of e)if("childList"===l.type){const e=t.mapDomToView(l.target);if(e&&(e.is("uiElement")||e.is("rawElement")))continue;e&&!this._isBogusBrMutation(l)&&n.add(e)}for(const l of e){const e=t.mapDomToView(l.target);if((!e||!e.is("uiElement")&&!e.is("rawElement"))&&"characterData"===l.type){const e=t.findCorrespondingViewText(l.target);e&&!n.has(e.parent)?i.set(e,{type:"text",oldText:e.data,newText:Lt(l.target),node:e}):!e&&Mt(l.target)&&n.add(t.mapDomToView(l.target.parentNode))}}const o=[];for(const l of i.values())this.renderer.markToSync("text",l.node),o.push(l);for(const l of n){const e=t.mapViewToDom(l),i=Array.from(l.getChildren()),n=Array.from(t.domChildrenToView(e,{withChildren:!1}));Ci(i,n,a)||(this.renderer.markToSync("children",l),o.push({type:"children",oldChildren:i,newChildren:n,node:l}))}const s=e[0].target.ownerDocument.getSelection();let r=null;if(s&&s.anchorNode){const e=t.domPositionToView(s.anchorNode,s.anchorOffset),i=t.domPositionToView(s.focusNode,s.focusOffset);e&&i&&(r=new He(e),r.setFocus(i))}function a(e,t){if(!Array.isArray(e))return e===t||!(!e.is("$text")||!t.is("$text"))&&e.data===t.data}o.length&&(this.document.fire("mutations",o,r),this.view.forceRender())}_isBogusBrMutation(e){let t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}var Vi=i(80207);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ai{constructor(e,t,i){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,(0,Vi.Z)(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ei extends _i{constructor(e){super(e),this.useCapture=!1}observe(e){const t="string"==typeof this.domEventType?[this.domEventType]:this.domEventType;t.forEach((t=>{this.listenTo(e,t,((e,t)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(t.target)&&this.onDomEvent(t)}),{useCapture:this.useCapture})}))}fire(e,t,i){this.isEnabled&&this.document.fire(e,new Ai(this.view,t,i))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ti extends Ei{constructor(e){super(e),this.domEventType=["keydown","keyup"]}onDomEvent(e){this.fire(e.type,e,{keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return(0,ct.Cq)(this)}})}}var Pi=i(8891);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Si extends _i{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=(0,Pi.Z)((e=>this.document.fire("selectionChangeDone",e)),200)}observe(){const e=this.document;e.on("arrowKey",((t,i)=>{const n=e.selection;n.isFake&&this.isEnabled&&i.preventDefault()}),{context:"$capture"}),e.on("arrowKey",((t,i)=>{const n=e.selection;n.isFake&&this.isEnabled&&this._handleSelectionMove(i.keyCode)}),{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,i=new He(t.getRanges(),{backward:t.isBackward,fake:!1});e!=ct.Do.arrowleft&&e!=ct.Do.arrowup||i.setTo(i.getFirstPosition()),e!=ct.Do.arrowright&&e!=ct.Do.arrowdown||i.setTo(i.getLastPosition());const n={oldSelection:t,newSelection:i,domSelection:null};this.document.fire("selectionChange",n),this._fireSelectionChangeDoneDebounced(n)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ii extends _i{constructor(e){super(e),this.mutationObserver=e.getObserver(xi),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=(0,Pi.Z)((e=>this.document.fire("selectionChangeDone",e)),200),this._clearInfiniteLoopInterval=setInterval((()=>this._clearInfiniteLoop()),1e3),this._documentIsSelectingInactivityTimeoutDebounced=(0,Pi.Z)((()=>this.document.isSelecting=!1),5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,i=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},n=()=>{this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel()};this.listenTo(e,"selectstart",i,{priority:"highest"}),this.listenTo(e,"keydown",n,{priority:"highest"}),this.listenTo(e,"keyup",n,{priority:"highest"}),this._documents.has(t)||(this.listenTo(t,"mouseup",n,{priority:"highest"}),this.listenTo(t,"selectionchange",((e,i)=>{this._handleSelectionChange(i,t),this._documentIsSelectingInactivityTimeoutDebounced()})),this._documents.add(t))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_handleSelectionChange(e,t){if(!this.isEnabled)return;const i=t.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(i.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(i);if(0!=n.rangeCount){if(this.view.hasDomSelection=!0,(!this.selection.isEqual(n)||!this.domConverter.isDomSelectionCorrect(i))&&!(++this._loopbackCounter>60))if(this.selection.isSimilar(n))this.view.forceRender();else{const e={oldSelection:this.selection,newSelection:n,domSelection:i};this.document.fire("selectionChange",e),this._fireSelectionChangeDoneDebounced(e)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ni extends Ei{constructor(e){super(e),this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",(()=>{t.isFocused=!0,this._renderTimeoutId=setTimeout((()=>e.change((()=>{}))),50)})),t.on("blur",((i,n)=>{const o=t.selection.editableElement;null!==o&&o!==n.target||(t.isFocused=!1,e.change((()=>{})))}))}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bi extends Ei{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",(()=>{t.isComposing=!0})),t.on("compositionend",(()=>{t.isComposing=!1}))}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
class Ri extends Ei{constructor(e){super(e),this.domEventType=["beforeinput"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Di{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach((({element:e,newElement:t})=>{e.style.display="",t&&t.remove()})),this._replacedElements=[]}}var Mi=i(93589),Oi=i(27771),Li="[object String]";function Fi(e){return"string"==typeof e||!(0,Oi.Z)(e)&&(0,k.Z)(e)&&(0,Mi.Z)(e)==Li}var zi=Fi;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $i(e,t,i={},n=[]){const o=i&&i.xmlns,s=o?e.createElementNS(o,t):e.createElement(t);for(const r in i)s.setAttribute(r,i[r]);!zi(n)&&(0,J.Z)(n)||(n=[n]);for(let r of n)zi(r)&&(r=e.createTextNode(r)),s.appendChild(r);return s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zi(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Wi(e){return"[object Range]"==Object.prototype.toString.apply(e)}var Hi=i(56272);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ui(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const qi=["top","right","bottom","left","width","height"];class Gi{constructor(e){const t=Wi(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),x(e)||t)if(t){const t=Gi.getDomRangeRects(e);ji(this,Gi.getBoundingRect(t))}else ji(this,e.getBoundingClientRect());else if((0,Hi.Z)(e)){const{innerWidth:t,innerHeight:i}=e;ji(this,{top:0,right:t,bottom:i,left:0,width:t,height:i})}else ji(this,e)}clone(){return new Gi(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0?null:new Gi(t)}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(!Ki(e)){let i=e.parentNode||e.commonAncestorContainer;while(i&&!Ki(i)){const e=new Gi(i),n=t.getIntersection(e);if(!n)return null;n.getArea()<t.getArea()&&(t=n),i=i.parentNode}}return t}isEqual(e){for(const t of qi)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!(!t||!t.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let t,i,n;if((0,Hi.Z)(e))t=e.innerWidth-e.document.documentElement.clientWidth,i=e.innerHeight-e.document.documentElement.clientHeight,n=e.getComputedStyle(e.document.documentElement).direction;else{const o=Ui(this._source);t=e.offsetWidth-e.clientWidth-o.left-o.right,i=e.offsetHeight-e.clientHeight-o.top-o.bottom,n=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,"ltr"===n?this.right-=t:this.left+=t,this.height-=i,this.bottom-=i,this}static getDomRangeRects(e){const t=[],i=Array.from(e.getClientRects());if(i.length)for(const n of i)t.push(new Gi(n));else{let i=e.startContainer;St(i)&&(i=i.parentNode);const n=new Gi(i.getBoundingClientRect());n.right=n.left,n.width=0,t.push(n)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY};let i=0;for(const n of e)i++,t.left=Math.min(t.left,n.left),t.top=Math.min(t.top,n.top),t.right=Math.max(t.right,n.right),t.bottom=Math.max(t.bottom,n.bottom);return 0==i?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new Gi(t))}}function ji(e,t){for(const i of qi)e[i]=t[i]}function Ki(e){return!!x(e)&&e===e.ownerDocument.body}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ji=100;class Yi{constructor(e,t){Yi._observerInstance||Yi._createObserver(),this._element=e,this._callback=t,Yi._addElementCallback(e,t),Yi._observerInstance.observe(e)}destroy(){Yi._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){Yi._elementCallbacks||(Yi._elementCallbacks=new Map);let i=Yi._elementCallbacks.get(e);i||(i=new Set,Yi._elementCallbacks.set(e,i)),i.add(t)}static _deleteElementCallback(e,t){const i=Yi._getElementCallbacks(e);i&&(i.delete(t),i.size||(Yi._elementCallbacks.delete(e),Yi._observerInstance.unobserve(e))),Yi._elementCallbacks&&!Yi._elementCallbacks.size&&(Yi._observerInstance=null,Yi._elementCallbacks=null)}static _getElementCallbacks(e){return Yi._elementCallbacks?Yi._elementCallbacks.get(e):null}static _createObserver(){let e;e="function"===typeof ri.window.ResizeObserver?ri.window.ResizeObserver:Qi,Yi._observerInstance=new e((e=>{for(const t of e){const e=Yi._getElementCallbacks(t.target);if(e)for(const i of e)i(t)}}))}}Yi._observerInstance=null,Yi._elementCallbacks=null;class Qi{constructor(e){this._callback=e,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(e){this._elements.add(e),this._checkElementRectsAndExecuteCallback(),1===this._elements.size&&this._startPeriodicCheck()}unobserve(e){this._elements.delete(e),this._previousRects.delete(e),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const e=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(e,Ji)};this.listenTo(ri.window,"resize",(()=>{this._checkElementRectsAndExecuteCallback()})),this._periodicCheckTimeout=setTimeout(e,Ji)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const e=[];for(const t of this._elements)this._hasRectChanged(t)&&e.push({target:t,contentRect:this._previousRects.get(t)});e.length&&this._callback(e)}_hasRectChanged(e){if(!e.ownerDocument.body.contains(e))return!1;const t=new Gi(e),i=this._previousRects.get(e),n=!i||!i.isEqual(t);return this._previousRects.set(e,t),n}}(0,I.Z)(Qi,vi.Z);var Xi=i(81759);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class en{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(e){if(this._elements.has(e))throw new P.ZP("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",(()=>this._focus(e)),{useCapture:!0}),this.listenTo(e,"blur",(()=>this._blur()),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(e),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout((()=>{this.focusedElement=null,this.isFocused=!1}),0)}}(0,I.Z)(en,vi.Z),(0,I.Z)(en,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tn{constructor(){this._listener=Object.create(vi.Z)}listenTo(e){this._listener.listenTo(e,"keydown",((e,t)=>{this._listener.fire("_keydown:"+(0,ct.Cq)(t),t)}))}set(e,t,i={}){const n=(0,ct.Zz)(e),o=i.priority;this._listener.listenTo(this._listener,"_keydown:"+n,((e,i)=>{t(i,(()=>{i.preventDefault(),i.stopPropagation(),e.stop()})),e.return=!0}),{priority:o})}press(e){return!!this._listener.fire("_keydown:"+(0,ct.Cq)(e),e)}destroy(){this._listener.stopListening()}}var nn=i(13719),on=i(18481);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sn extends _i{constructor(e){super(e),this.document.on("keydown",((e,t)=>{if(this.isEnabled&&(0,ct.dj)(t.keyCode)){const i=new Ge(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(i,t),i.stop.called&&e.stop()}}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const rn={};function an({target:e,viewportOffset:t=0}){const i=pn(e);let n=i,o=null;while(n){let s;s=fn(n==i?e:o),dn(s,(()=>wn(e,n)));const r=wn(e,n);if(cn(n,r,t),n.parent!=n){if(o=n.frameElement,n=n.parent,!o)return}else n=null}}function ln(e){const t=fn(e);dn(t,(()=>new Gi(e)))}function cn(e,t,i){const n=t.clone().moveBy(0,i),o=t.clone().moveBy(0,-i),s=new Gi(e).excludeScrollbarsAndBorders(),r=[o,n];if(!r.every((e=>s.contains(e)))){let{scrollX:r,scrollY:a}=e;un(o,s)?a-=s.top-t.top+i:hn(n,s)&&(a+=t.bottom-s.bottom+i),mn(t,s)?r-=s.left-t.left+i:gn(t,s)&&(r+=t.right-s.right+i),e.scrollTo(r,a)}}function dn(e,t){const i=pn(e);let n,o;while(e!=i.document.body)o=t(),n=new Gi(e).excludeScrollbarsAndBorders(),n.contains(o)||(un(o,n)?e.scrollTop-=n.top-o.top:hn(o,n)&&(e.scrollTop+=o.bottom-n.bottom),mn(o,n)?e.scrollLeft-=n.left-o.left:gn(o,n)&&(e.scrollLeft+=o.right-n.right)),e=e.parentNode}function hn(e,t){return e.bottom>t.bottom}function un(e,t){return e.top<t.top}function mn(e,t){return e.left<t.left}function gn(e,t){return e.right>t.right}function pn(e){return Wi(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function fn(e){if(Wi(e)){let t=e.commonAncestorContainer;return St(t)&&(t=t.parentNode),t}return e.parentNode}function wn(e,t){const i=pn(e),n=new Gi(e);if(i===t)return n;{let e=i;while(e!=t){const t=e.frameElement,i=new Gi(t).excludeScrollbarsAndBorders();n.moveBy(i.left,i.top),e=e.parent}}return n}Object.assign(rn,{scrollViewportToShowTarget:an,scrollAncestorsToShowTarget:ln});
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bn{constructor(e){this.document=new it(e),this.domConverter=new gi(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Qt(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new bt(this.document),this.addObserver(xi),this.addObserver(Ii),this.addObserver(Ni),this.addObserver(Ti),this.addObserver(Si),this.addObserver(Bi),this.addObserver(sn),Yt.ZP.isAndroid&&this.addObserver(Ri),Ft(this),ht(this),this.on("render",(()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1})),this.listenTo(this.document.selection,"change",(()=>{this._hasChangedSinceTheLastRendering=!0})),this.listenTo(this.document,"change:isFocused",(()=>{this._hasChangedSinceTheLastRendering=!0}))}attachDomRoot(e,t="main"){const i=this.document.getRoot(t);i._name=e.tagName.toLowerCase();const n={};for(const{name:s,value:r}of Array.from(e.attributes))n[s]=r,"class"===s?this._writer.addClass(r.split(" "),i):this._writer.setAttribute(s,r,i);this._initialDomRootAttributes.set(e,n);const o=()=>{this._writer.setAttribute("contenteditable",!i.isReadOnly,i),i.isReadOnly?this._writer.addClass("ck-read-only",i):this._writer.removeClass("ck-read-only",i)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,i),this._renderer.markToSync("children",i),this._renderer.markToSync("attributes",i),this._renderer.domDocuments.add(e.ownerDocument),i.on("change:children",((e,t)=>this._renderer.markToSync("children",t))),i.on("change:attributes",((e,t)=>this._renderer.markToSync("attributes",t))),i.on("change:text",((e,t)=>this._renderer.markToSync("text",t))),i.on("change:isReadOnly",(()=>this.change(o))),i.on("change",(()=>{this._hasChangedSinceTheLastRendering=!0}));for(const s of this._observers.values())s.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach((({name:e})=>t.removeAttribute(e)));const i=this._initialDomRootAttributes.get(t);for(const n in i)t.setAttribute(n,i[n]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[i,n]of this.domRoots)t.observe(n,i);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection(){const e=this.document.selection.getFirstRange();e&&an({target:this.domConverter.viewRangeToDom(e),viewportOffset:20})}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new P.ZP("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){P.ZP.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change((()=>{}))}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return ze._createAt(e,t)}createPositionAfter(e){return ze._createAfter(e)}createPositionBefore(e){return ze._createBefore(e)}createRange(e,t){return new $e(e,t)}createRangeOn(e){return $e._createOn(e)}createRangeIn(e){return $e._createIn(e)}createSelection(e,t,i){return new He(e,t,i)}_disableRendering(e){this._renderingDisabled=e,0==e&&this.change((()=>{}))}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}(0,I.Z)(bn,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vn{constructor(e){this.parent=null,this._attrs=Y(e)}get index(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildIndex(this)))throw new P.ZP("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildStartOffset(this)))throw new P.ZP("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;while(e.parent)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;while(t.parent)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}getCommonAncestor(e,t={}){const i=this.getAncestors(t),n=e.getAncestors(t);let o=0;while(i[o]==n[o]&&i[o])o++;return 0===o?null:i[o-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),i=e.getPath(),n=H(t,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<i[n]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce(((e,t)=>(e[t[0]]=t[1],e)),{})),e}is(e){return"node"===e||"model:node"===e}_clone(){return new vn(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=Y(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _n extends vn{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}is(e){return"$text"===e||"model:$text"===e||"text"===e||"model:text"===e||"node"===e||"model:node"===e}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new _n(this.data,this.getAttributes())}static fromJSON(e){return new _n(e.data,e.attributes)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yn{constructor(e,t,i){if(this.textNode=e,t<0||t>e.offsetSize)throw new P.ZP("model-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.offsetSize)throw new P.ZP("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(e){return"$textProxy"===e||"model:$textProxy"===e||"textProxy"===e||"model:textProxy"===e}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kn{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce(((e,t)=>e+t.offsetSize),0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return-1==t?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return null===t?null:this._nodes.slice(0,t).reduce(((e,t)=>e+t.offsetSize),0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new P.ZP("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const i of this._nodes){if(e>=t&&e<t+i.offsetSize)return this.getNodeIndex(i);t+=i.offsetSize}if(t!=e)throw new P.ZP("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const i of t)if(!(i instanceof vn))throw new P.ZP("model-nodelist-insertnodes-not-node",this);this._nodes.splice(e,0,...t)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map((e=>e.toJSON()))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cn extends vn{constructor(e,t,i){super(t),this.name=e,this._children=new kn,i&&this._insertChild(0,i)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(e,t=null){return t?t===this.name&&("element"===e||"model:element"===e):"element"===e||"model:element"===e||"node"===e||"model:node"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const i of e)t=t.getChild(t.offsetToIndex(i));return t}findAncestor(e,t={includeSelf:!1}){let i=t.includeSelf?this:this.parent;while(i){if(i.name===e)return i;i=i.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map((e=>e._clone(!0))):null;return new Cn(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const i=xn(t);for(const n of i)null!==n.parent&&n._remove(),n.parent=this;this._children._insertNodes(e,i)}_removeChildren(e,t=1){const i=this._children._removeNodes(e,t);for(const n of i)n.parent=null;return i}static fromJSON(e){let t=null;if(e.children){t=[];for(const i of e.children)i.name?t.push(Cn.fromJSON(i)):t.push(_n.fromJSON(i))}return new Cn(e.name,e.attributes,t)}}function xn(e){return"string"==typeof e?[new _n(e)]:((0,J.Z)(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new _n(e):e instanceof yn?new _n(e.data,e.getAttributes()):e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vn{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new P.ZP("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new P.ZP("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=En._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(e){let t,i,n,o;do{n=this.position,o=this._visitedParent,({done:t,value:i}=this.next())}while(!t&&e(i));t||(this.position=n,this._visitedParent=o)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&t.offset===i.maxOffset)return{done:!0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};const n=t.parent,o=Tn(t,n),s=o||Pn(t,n,o);if(s instanceof Cn)return this.shallow?t.offset++:(t.path.push(0),this._visitedParent=s),this.position=t,An("elementStart",s,e,t,1);if(s instanceof _n){let n;if(this.singleCharacters)n=1;else{let e=s.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<e&&(e=this.boundaries.end.offset),n=e-t.offset}const o=t.offset-s.startOffset,r=new yn(s,o,n);return t.offset+=n,this.position=t,An("text",r,e,t,n)}return t.path.pop(),t.offset++,this.position=t,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():An("elementEnd",i,e,t)}_previous(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&0===t.offset)return{done:!0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};const n=t.parent,o=Tn(t,n),s=o||Sn(t,n,o);if(s instanceof Cn)return t.offset--,this.shallow?(this.position=t,An("elementStart",s,e,t,1)):(t.path.push(s.maxOffset),this.position=t,this._visitedParent=s,this.ignoreElementEnd?this._previous():An("elementEnd",s,e,t));if(s instanceof _n){let n;if(this.singleCharacters)n=1;else{let e=s.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>e&&(e=this.boundaries.start.offset),n=t.offset-e}const o=t.offset-s.startOffset,r=new yn(s,o-n,n);return t.offset-=n,this.position=t,An("text",r,e,t,n)}return t.path.pop(),this.position=t,this._visitedParent=i.parent,An("elementStart",i,e,t,1)}}function An(e,t,i,n,o){return{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:n,length:o}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class En{constructor(e,t,i="toNone"){if(!e.is("element")&&!e.is("documentFragment"))throw new P.ZP("model-position-root-invalid",e);if(!(t instanceof Array)||0===t.length)throw new P.ZP("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=i}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new P.ZP("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new P.ZP("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Tn(this,this.parent)}get nodeAfter(){const e=this.parent;return Pn(this,e,Tn(this,e))}get nodeBefore(){const e=this.parent;return Sn(this,e,Tn(this,e))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=H(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const i=new Vn(t);return i.skip(e),i.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=H(this.path,e.path),i="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,i)}getCommonAncestor(e){const t=this.getAncestors(),i=e.getAncestors();let n=0;while(t[n]==i[n]&&t[n])n++;return 0===n?null:t[n-1]}getShiftedBy(e){const t=this.clone(),i=t.offset+e;return t.offset=i<0?0:i,t}isAfter(e){return"after"==this.compareWith(e)}isBefore(e){return"before"==this.compareWith(e)}isEqual(e){return"same"==this.compareWith(e)}isTouching(e){let t=null,i=null;const n=this.compareWith(e);switch(n){case"same":return!0;case"before":t=En._createAt(this),i=En._createAt(e);break;case"after":t=En._createAt(e),i=En._createAt(this);break;default:return!1}let o=t.parent;while(t.path.length+i.path.length){if(t.isEqual(i))return!0;if(t.path.length>i.path.length){if(t.offset!==o.maxOffset)return!1;t.path=t.path.slice(0,-1),o=o.parent,t.offset++}else{if(0!==i.offset)return!1;i.path=i.path.slice(0,-1)}}}is(e){return"position"===e||"model:position"===e}hasSameParentAs(e){if(this.root!==e.root)return!1;const t=this.getParentPath(),i=e.getParentPath();return"same"==H(t,i)}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=En._createAt(this);break}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange,i=t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness;return i?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange,i=t.containsPosition(this)||t.start.isEqual(this);let n;return i?(n=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(n=n._getTransformedByDeletion(e.deletionPosition,1))):n=this.isEqual(e.deletionPosition)?En._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),n}_getTransformedByDeletion(e,t){const i=En._createAt(this);if(this.root!=e.root)return i;if("same"==H(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;i.offset-=t}}else if("prefix"==H(e.getParentPath(),this.getParentPath())){const n=e.path.length-1;if(e.offset<=this.path[n]){if(e.offset+t>this.path[n])return null;i.path[n]-=t}}return i}_getTransformedByInsertion(e,t){const i=En._createAt(this);if(this.root!=e.root)return i;if("same"==H(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(i.offset+=t);else if("prefix"==H(e.getParentPath(),this.getParentPath())){const n=e.path.length-1;e.offset<=this.path[n]&&(i.path[n]+=t)}return i}_getTransformedByMove(e,t,i){if(t=t._getTransformedByDeletion(e,i),e.isEqual(t))return En._createAt(this);const n=this._getTransformedByDeletion(e,i),o=null===n||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(i).isEqual(this)&&"toPrevious"==this.stickiness;return o?this._getCombined(e,t):n._getTransformedByInsertion(t,i)}_getCombined(e,t){const i=e.path.length-1,n=En._createAt(t);return n.stickiness=this.stickiness,n.offset=n.offset+this.path[i]-e.offset,n.path=[...n.path,...this.path.slice(i+1)],n}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,i="toNone"){if(e instanceof En)return new En(e.root,e.path,e.stickiness);{const n=e;if("end"==t)t=n.maxOffset;else{if("before"==t)return this._createBefore(n,i);if("after"==t)return this._createAfter(n,i);if(0!==t&&!t)throw new P.ZP("model-createpositionat-offset-required",[this,e])}if(!n.is("element")&&!n.is("documentFragment"))throw new P.ZP("model-position-parent-incorrect",[this,e]);const o=n.getPath();return o.push(t),new this(n.root,o,i)}}static _createAfter(e,t){if(!e.parent)throw new P.ZP("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new P.ZP("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if("$graveyard"===e.root){const i=new En(t.graveyard,e.path);return i.stickiness=e.stickiness,i}if(!t.getRoot(e.root))throw new P.ZP("model-position-fromjson-no-root",t,{rootName:e.root});return new En(t.getRoot(e.root),e.path,e.stickiness)}}function Tn(e,t){const i=t.getChild(t.offsetToIndex(e.offset));return i&&i.is("$text")&&i.startOffset<e.offset?i:null}function Pn(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset))}function Sn(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset)-1)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class In{constructor(e,t=null){this.start=En._createAt(e),this.end=t?En._createAt(t):En._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Vn({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),t=this.end.getParentPath();return"same"==H(e,t)}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&n}containsItem(e){const t=En._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}is(e){return"range"===e||"model:range"===e}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new In(this.start,e.start)),this.containsPosition(e.end)&&t.push(new In(e.end,this.end))):t.push(new In(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,i=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(i=e.end),new In(t,i)}return null}getJoined(e,t=!1){let i=this.isIntersecting(e);if(i||(i=this.start.isBefore(e.start)?t?this.end.isTouching(e.start):this.end.isEqual(e.start):t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!i)return null;let n=this.start,o=this.end;return e.start.isBefore(n)&&(n=e.start),e.end.isAfter(o)&&(o=e.end),new In(n,o)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,i=En._createAt(this.start);let n=i.parent;while(i.path.length>t+1){const t=n.maxOffset-i.offset;0!==t&&e.push(new In(i,i.getShiftedBy(t))),i.path=i.path.slice(0,-1),i.offset++,n=n.parent}while(i.path.length<=this.end.path.length){const t=this.end.path[i.path.length-1],n=t-i.offset;0!==n&&e.push(new In(i,i.getShiftedBy(n))),i.offset=t,i.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Vn(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Vn(e);for(const i of t)yield i.item}*getPositions(e={}){e.boundaries=this;const t=new Vn(e);yield t.position;for(const i of t)yield i.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new In(this.start,this.end)]}getTransformedByOperations(e){const t=[new In(this.start,this.end)];for(const i of e)for(let e=0;e<t.length;e++){const n=t[e].getTransformedByOperation(i);t.splice(e,1,...n),e+=n.length-1}for(let i=0;i<t.length;i++){const e=t[i];for(let n=i+1;n<t.length;n++){const i=t[n];(e.containsRange(i)||i.containsRange(e)||e.isEqual(i))&&t.splice(n,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const i=e.sourcePosition,n=e.howMany,o=e.targetPosition;return this._getTransformedByMove(i,o,n,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let i=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(i=this.end.getShiftedBy(1)),t.root!=i.root&&(i=this.end.getShiftedBy(-1)),new In(t,i)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new In(this.start);let t=this.start._getTransformedByMergeOperation(e),i=this.end._getTransformedByMergeOperation(e);return t.root!=i.root&&(i=this.end.getShiftedBy(-1)),t.isAfter(i)?(e.sourcePosition.isBefore(e.targetPosition)?(t=En._createAt(i),t.offset=0):(e.deletionPosition.isEqual(t)||(i=e.deletionPosition),t=e.targetPosition),new In(t,i)):new In(t,i)}_getTransformedByInsertion(e,t,i=!1){if(i&&this.containsPosition(e))return[new In(this.start,e),new In(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const i=new In(this.start,this.end);return i.start=i.start._getTransformedByInsertion(e,t),i.end=i.end._getTransformedByInsertion(e,t),[i]}}_getTransformedByMove(e,t,i,n=!1){if(this.isCollapsed){const n=this.start._getTransformedByMove(e,t,i);return[new In(n)]}const o=In._createFromPositionAndShift(e,i),s=t._getTransformedByDeletion(e,i);if(this.containsPosition(t)&&!n&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const n=this.start._getTransformedByMove(e,t,i),o=this.end._getTransformedByMove(e,t,i);return[new In(n,o)]}let r;const a=this.getDifference(o);let l=null;const c=this.getIntersection(o);if(1==a.length?l=new In(a[0].start._getTransformedByDeletion(e,i),a[0].end._getTransformedByDeletion(e,i)):2==a.length&&(l=new In(this.start,this.end._getTransformedByDeletion(e,i))),r=l?l._getTransformedByInsertion(s,i,null!==c||n):[],c){const e=new In(c.start._getCombined(o.start,s),c.end._getCombined(o.start,s));2==r.length?r.splice(1,0,e):r.push(e)}return r}_getTransformedByDeletion(e,t){let i=this.start._getTransformedByDeletion(e,t),n=this.end._getTransformedByDeletion(e,t);return null==i&&null==n?null:(null==i&&(i=e),null==n&&(n=e),new In(i,n))}static _createFromPositionAndShift(e,t){const i=e,n=e.getShiftedBy(t);return t>0?new this(i,n):new this(n,i)}static _createIn(e){return new this(En._createAt(e,0),En._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(En._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(0===e.length)throw new P.ZP("range-create-from-ranges-empty-array",null);if(1==e.length)return e[0].clone();const t=e[0];e.sort(((e,t)=>e.start.isAfter(t.start)?1:-1));const i=e.indexOf(t),n=new this(t.start,t.end);if(i>0)for(let o=i-1;1;o++){if(!e[o].end.isEqual(n.start))break;n.start=En._createAt(e[o].start)}for(let o=i+1;o<e.length;o++){if(!e[o].start.isEqual(n.end))break;n.end=En._createAt(e[o].end)}return n}static fromJSON(e,t){return new this(En.fromJSON(e.start,t),En.fromJSON(e.end,t))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nn{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",((e,t)=>{if(t.viewPosition)return;const i=this._modelToViewMapping.get(t.modelPosition.parent);t.viewPosition=this.findPositionIn(i,t.modelPosition.offset)}),{priority:"low"}),this.on("viewToModelPosition",((e,t)=>{if(t.modelPosition)return;const i=this.findMappedViewAncestor(t.viewPosition),n=this._viewToModelMapping.get(i),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,i);t.modelPosition=En._createAt(n,o)}),{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e){const t=this.toModelElement(e);if(this._viewToModelMapping.delete(e),this._elementToMarkerNames.has(e))for(const i of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(i);this._modelToViewMapping.get(t)==e&&this._modelToViewMapping.delete(t)}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const i=this._markerNameToElements.get(t)||new Set;i.add(e);const n=this._elementToMarkerNames.get(e)||new Set;n.add(t),this._markerNameToElements.set(t,i),this._elementToMarkerNames.set(e,n)}unbindElementFromMarkerName(e,t){const i=this._markerNameToElements.get(t);i&&(i.delete(e),0==i.size&&this._markerNameToElements.delete(t));const n=this._elementToMarkerNames.get(e);n&&(n.delete(t),0==n.size&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new In(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new $e(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={isPhantom:!1}){const i={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",i),i.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const i=new Set;for(const n of t)if(n.is("attributeElement"))for(const e of n.getElementsWithSameId())i.add(e);else i.add(n);return i}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;while(!this._viewToModelMapping.has(t))t=t.parent;return t}_toModelOffset(e,t,i){if(i!=e){const n=this._toModelOffset(e.parent,e.index,i),o=this._toModelOffset(e,t,e);return n+o}if(e.is("$text"))return t;let n=0;for(let o=0;o<t;o++)n+=this.getModelLength(e.getChild(o));return n}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name)){const t=this._viewToModelLengthCallbacks.get(e.name);return t(e)}if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const i of e.getChildren())t+=this.getModelLength(i);return t}}findPositionIn(e,t){let i,n=0,o=0,s=0;if(e.is("$text"))return new ze(e,t);while(o<t)i=e.getChild(s),n=this.getModelLength(i),o+=n,s++;return o==t?this._moveViewPositionToTextNode(new ze(e,s)):this.findPositionIn(i,t-(o-n))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,i=e.nodeAfter;return t instanceof G?new ze(t,t.data.length):i instanceof G?new ze(i,0):e}}(0,I.Z)(Nn,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bn{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=Rn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=Rn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0)}test(e,t){t=Rn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e));const i=this._consumable.get(e);if(void 0===i)return null;const n=i.get(t);return void 0===n?null:n}revert(e,t){t=Rn(t),e instanceof yn&&(e=this._getSymbolForTextProxy(e));const i=this.test(e,t);return!1===i?(this._consumable.get(e).set(t,!0),!0):!0!==i&&null}_getSymbolForTextProxy(e){let t=null;const i=this._textProxyRegistry.get(e.startOffset);if(i){const n=i.get(e.endOffset);n&&(t=n.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e.startOffset,e.endOffset,e.parent)),t}_addSymbolForTextProxy(e,t,i){const n=Symbol("textProxySymbol");let o,s;return o=this._textProxyRegistry.get(e),o||(o=new Map,this._textProxyRegistry.set(e,o)),s=o.get(t),s||(s=new Map,o.set(t,s)),s.set(i,n),n}}function Rn(e){const t=e.split(":");return"addMarker"==t[0]||"removeMarker"==t[0]?e:t.length>1?t[0]+":"+t[1]:t[0]}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Dn{constructor(e){this.conversionApi=Object.assign({dispatcher:this},e),this._reconversionEventsMapping=new Map}convertChanges(e,t,i){for(const o of e.getMarkersToRemove())this.convertMarkerRemove(o.name,o.range,i);const n=this._mapChangesWithAutomaticReconversion(e);for(const o of n)"insert"===o.type?this.convertInsert(In._createFromPositionAndShift(o.position,o.length),i):"remove"===o.type?this.convertRemove(o.position,o.length,o.name,i):"reconvert"===o.type?this.reconvertElement(o.element,i):this.convertAttribute(o.range,o.attributeKey,o.attributeOldValue,o.attributeNewValue,i);for(const o of this.conversionApi.mapper.flushUnboundMarkerNames()){const e=t.get(o).getRange();this.convertMarkerRemove(o,e,i),this.convertMarkerAdd(o,e,i)}for(const o of e.getMarkersToAdd())this.convertMarkerAdd(o.name,o.range,i)}convertInsert(e,t){this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(e);for(const i of Array.from(e).map(Ln))this._convertInsertWithAttributes(i);this._clearConversionApi()}convertRemove(e,t,i,n){this.conversionApi.writer=n,this.fire("remove:"+i,{position:e,length:t},this.conversionApi),this._clearConversionApi()}convertAttribute(e,t,i,n,o){this.conversionApi.writer=o,this.conversionApi.consumable=this._createConsumableForRange(e,`attribute:${t}`);for(const s of e){const e=s.item,o=In._createFromPositionAndShift(s.previousPosition,s.length),r={item:e,range:o,attributeKey:t,attributeOldValue:i,attributeNewValue:n};this._testAndFire(`attribute:${t}`,r)}this._clearConversionApi()}reconvertElement(e,t){const i=In._createOn(e);this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(i);const n=this.conversionApi.mapper,o=n.toViewElement(e);t.remove(o),this._convertInsertWithAttributes({item:e,range:i});const s=n.toViewElement(e);for(const r of In._createIn(e)){const{item:e}=r,i=Fn(e,n);i?i.root!==s.root&&t.move(t.createRangeOn(i),n.toViewPosition(En._createBefore(e))):this._convertInsertWithAttributes(Ln(r))}n.unbindViewElement(o),this._clearConversionApi()}convertSelection(e,t,i){const n=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this.conversionApi.writer=i,this.conversionApi.consumable=this._createSelectionConsumable(e,n),this.fire("selection",{selection:e},this.conversionApi),e.isCollapsed){for(const t of n){const i=t.getRange();if(!Mn(e.getFirstPosition(),t,this.conversionApi.mapper))continue;const n={item:e,markerName:t.name,markerRange:i};this.conversionApi.consumable.test(e,"addMarker:"+t.name)&&this.fire("addMarker:"+t.name,n,this.conversionApi)}for(const t of e.getAttributeKeys()){const i={item:e,range:e.getFirstRange(),attributeKey:t,attributeOldValue:null,attributeNewValue:e.getAttribute(t)};this.conversionApi.consumable.test(e,"attribute:"+i.attributeKey)&&this.fire("attribute:"+i.attributeKey+":$text",i,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerAdd(e,t,i){if("$graveyard"==t.root.rootName)return;this.conversionApi.writer=i;const n="addMarker:"+e,o=new Bn;if(o.add(t,n),this.conversionApi.consumable=o,this.fire(n,{markerName:e,markerRange:t},this.conversionApi),o.test(t,n)){this.conversionApi.consumable=this._createConsumableForRange(t,n);for(const i of t.getItems()){if(!this.conversionApi.consumable.test(i,n))continue;const o={item:i,range:In._createOn(i),markerName:e,markerRange:t};this.fire(n,o,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerRemove(e,t,i){"$graveyard"!=t.root.rootName&&(this.conversionApi.writer=i,this.fire("removeMarker:"+e,{markerName:e,markerRange:t},this.conversionApi),this._clearConversionApi())}_mapReconversionTriggerEvent(e,t){this._reconversionEventsMapping.set(t,e)}_createInsertConsumable(e){const t=new Bn;for(const i of e){const e=i.item;t.add(e,"insert");for(const i of e.getAttributeKeys())t.add(e,"attribute:"+i)}return t}_createConsumableForRange(e,t){const i=new Bn;for(const n of e.getItems())i.add(n,t);return i}_createSelectionConsumable(e,t){const i=new Bn;i.add(e,"selection");for(const n of t)i.add(e,"addMarker:"+n.name);for(const n of e.getAttributeKeys())i.add(e,"attribute:"+n);return i}_testAndFire(e,t){this.conversionApi.consumable.test(t.item,e)&&this.fire(On(e,t),t,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}_convertInsertWithAttributes(e){this._testAndFire("insert",e);for(const t of e.item.getAttributeKeys())e.attributeKey=t,e.attributeOldValue=null,e.attributeNewValue=e.item.getAttribute(t),this._testAndFire(`attribute:${t}`,e)}_mapChangesWithAutomaticReconversion(e){const t=new Set,i=[];for(const n of e.getChanges()){const e=n.position||n.range.start,o=e.parent,s=Tn(e,o);if(s){i.push(n);continue}const r="attribute"===n.type?Pn(e,o,null):o;if(r.is("$text")){i.push(n);continue}let a;if(a="attribute"===n.type?`attribute:${n.attributeKey}:${r.name}`:`${n.type}:${n.name}`,this._isReconvertTriggerEvent(a,r.name)){if(t.has(r))continue;t.add(r),i.push({type:"reconvert",element:r})}else i.push(n)}return i}_isReconvertTriggerEvent(e,t){return this._reconversionEventsMapping.get(e)===t}}function Mn(e,t,i){const n=t.getRange(),o=Array.from(e.getAncestors());o.shift(),o.reverse();const s=o.some((e=>{if(n.containsItem(e)){const t=i.toViewElement(e);return!!t.getCustomProperty("addHighlight")}}));return!s}function On(e,t){const i=t.item.name||"$text";return`${e}:${i}`}function Ln(e){const t=e.item,i=In._createFromPositionAndShift(e.previousPosition,e.length);return{item:t,range:i}}function Fn(e,t){if(e.is("textProxy")){const i=t.toViewPosition(En._createBefore(e)),n=i.parent;return n.is("$text")?n:null}return t.toViewElement(e)}(0,I.Z)(Dn,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zn{constructor(e,t,i){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,e&&this.setTo(e,t,i)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){const e=this._ranges.length;return 1===e&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let i=!1;for(const n of e._ranges)if(t.isEqual(n)){i=!0;break}if(!i)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new In(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?new In(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?new In(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(e,t,i){if(null===e)this._setRanges([]);else if(e instanceof zn)this._setRanges(e.getRanges(),e.isBackward);else if(e&&"function"==typeof e.getRanges)this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof In)this._setRanges([e],!!t&&!!t.backward);else if(e instanceof En)this._setRanges([new In(e)]);else if(e instanceof vn){const n=!!i&&!!i.backward;let o;if("in"==t)o=In._createIn(e);else if("on"==t)o=In._createOn(e);else{if(void 0===t)throw new P.ZP("model-selection-setto-required-second-parameter",[this,e]);o=new In(En._createAt(e,t))}this._setRanges([o],n)}else{if(!(0,J.Z)(e))throw new P.ZP("model-selection-setto-not-selectable",[this,e]);this._setRanges(e,t&&!!t.backward)}}_setRanges(e,t=!1){e=Array.from(e);const i=e.some((t=>{if(!(t instanceof In))throw new P.ZP("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every((e=>!e.isEqual(t)))}));if(e.length!==this._ranges.length||i){this._removeAllRanges();for(const t of e)this._pushRange(t);this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0})}}setFocus(e,t){if(null===this.anchor)throw new P.ZP("model-selection-setfocus-no-ranges",[this,e]);const i=En._createAt(e,t);if("same"==i.compareWith(this.focus))return;const n=this.anchor;this._ranges.length&&this._popRange(),"before"==i.compareWith(n)?(this._pushRange(new In(i,n)),this._lastRangeBackward=!0):(this._pushRange(new In(n,i)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}is(e){return"selection"===e||"model:selection"===e}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const i=Wn(t.start,e);i&&Hn(i,t)&&(yield i);for(const o of t.getWalker()){const i=o.item;"elementEnd"==o.type&&Zn(i,e,t)&&(yield i)}const n=Wn(t.end,e);n&&!t.end.isTouching(En._createAt(n,0))&&Hn(n,t)&&(yield n)}}containsEntireContent(e=this.anchor.root){const t=En._createAt(e,0),i=En._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&i.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new In(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new P.ZP("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_removeAllRanges(){while(this._ranges.length>0)this._popRange()}_popRange(){this._ranges.pop()}}function $n(e,t){return!t.has(e)&&(t.add(e),e.root.document.model.schema.isBlock(e)&&e.parent)}function Zn(e,t,i){return $n(e,t)&&Hn(e,i)}function Wn(e,t){const i=e.parent,n=i.root.document.model.schema,o=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let s=!1;const r=o.find((e=>!s&&(s=n.isLimit(e),!s&&$n(e,t))));return o.forEach((e=>t.add(e))),r}function Hn(e,t){const i=Un(e);if(!i)return!0;const n=t.containsRange(In._createOn(i),!0);return!n}function Un(e){const t=e.root.document.model.schema;let i=e.parent;while(i){if(t.isBlock(i))return i;i=i.parent}}(0,I.Z)(zn,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qn extends In{constructor(e,t){super(e,t),Gn.call(this)}detach(){this.stopListening()}is(e){return"liveRange"===e||"model:liveRange"===e||"range"==e||"model:range"===e}toRange(){return new In(this.start,this.end)}static fromRange(e){return new qn(e.start,e.end)}}function Gn(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&jn.call(this,i)}),{priority:"low"})}function jn(e){const t=this.getTransformedByOperation(e),i=In._createFromRanges(t),n=!i.isEqual(this),o=Kn(this,e);let s=null;if(n){"$graveyard"==i.root.rootName&&(s="remove"==e.type?e.sourcePosition:e.deletionPosition);const t=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",t,{deletionPosition:s})}else o&&this.fire("change:content",this.toRange(),{deletionPosition:s})}function Kn(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}(0,I.Z)(qn,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Jn="selection:";class Yn{constructor(e){this._selection=new Qn(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}is(e){return"selection"===e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(e,t,i){this._selection.setTo(e,t,i)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return Jn+e}static _isStoreAttributeKey(e){return e.startsWith(Jn)}}(0,I.Z)(Yn,S.ZP);class Qn extends zn{constructor(e){super(),this.markers=new T.Z({idProperty:"name"}),this._model=e.model,this._document=e,this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this.listenTo(this._model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&"marker"!=i.type&&"rename"!=i.type&&"noop"!=i.type&&(0==this._ranges.length&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))}),{priority:"lowest"}),this.on("change:range",(()=>{for(const e of this.getRanges())if(!this._document._validateSelectionRange(e))throw new P.ZP("document-selection-wrong-position",this,{range:e})})),this.listenTo(this._model.markers,"update",((e,t,i,n)=>{this._updateMarker(t,n)})),this.listenTo(this._document,"change",((e,t)=>{eo(this._model,t)}))}get isCollapsed(){const e=this._ranges.length;return 0===e?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(e,t,i){super.setTo(e,t,i),this._updateAttributes(!0),this._updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this._updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=(0,on.Z)();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new P.ZP("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this._updateMarkers()}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=qn.fromRange(e);return t.on("change:range",((e,i,n)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=n.deletionPosition;const e=this._ranges.indexOf(t);this._ranges.splice(e,1),t.detach()}})),t}_updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const n of this._model.markers){const t=n.name.split(":",1)[0];if(!this._observedMarkers.has(t))continue;const i=n.getRange();for(const o of this.getRanges())i.containsRange(o,!o.isCollapsed)&&e.push(n)}const i=Array.from(this.markers);for(const n of e)this.markers.has(n)||(this.markers.add(n),t=!0);for(const n of Array.from(this.markers))e.includes(n)||(this.markers.remove(n),t=!0);t&&this.fire("change:marker",{oldMarkers:i,directChange:!1})}_updateMarker(e,t){const i=e.name.split(":",1)[0];if(!this._observedMarkers.has(i))return;let n=!1;const o=Array.from(this.markers),s=this.markers.has(e);if(t){let i=!1;for(const e of this.getRanges())if(t.containsRange(e,!e.isCollapsed)){i=!0;break}i&&!s?(this.markers.add(e),n=!0):!i&&s&&(this.markers.remove(e),n=!0)}else s&&(this.markers.remove(e),n=!0);n&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=Y(this._getSurroundingAttributes()),i=Y(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,s]of this._attributePriority)"low"==s&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(t);const n=[];for(const[o,s]of this.getAttributes())i.has(o)&&i.get(o)===s||n.push(o);for(const[o]of i)this.hasAttribute(o)||n.push(o);n.length>0&&this.fire("change:attribute",{attributeKeys:n,directChange:!1})}_setAttribute(e,t,i=!0){const n=i?"normal":"low";if("low"==n&&"normal"==this._attributePriority.get(e))return!1;const o=super.getAttribute(e);return o!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,n),!0)}_removeAttribute(e,t=!0){const i=t?"normal":"low";return("low"!=i||"normal"!=this._attributePriority.get(e))&&(this._attributePriority.set(e,i),!!super.hasAttribute(e)&&(this._attrs.delete(e),!0))}_setAttributesTo(e){const t=new Set;for(const[i,n]of this.getAttributes())e.get(i)!==n&&this._removeAttribute(i,!1);for(const[i,n]of e){const e=this._setAttribute(i,n,!1);e&&t.add(i)}return t}*_getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())if(t.startsWith(Jn)){const i=t.substr(Jn.length);yield[i,e.getAttribute(t)]}}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;let i=null;if(this.isCollapsed){const n=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(i=Xn(n)),i||(i=Xn(o)),!this.isGravityOverridden&&!i){let e=n;while(e&&!t.isInline(e)&&!i)e=e.previousSibling,i=Xn(e)}if(!i){let e=o;while(e&&!t.isInline(e)&&!i)e=e.nextSibling,i=Xn(e)}i||(i=this._getStoredAttributes())}else{const e=this.getFirstRange();for(const n of e){if(n.item.is("element")&&t.isObject(n.item))break;if("text"==n.type){i=n.item.getAttributes();break}}}return i}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function Xn(e){return e instanceof yn||e instanceof _n?e.getAttributes():null}function eo(e,t){const i=e.document.differ;for(const n of i.getChanges()){if("insert"!=n.type)continue;const i=n.position.parent,o=n.length===i.maxOffset;o&&e.enqueueChange(t,(e=>{const t=Array.from(i.getAttributeKeys()).filter((e=>e.startsWith(Jn)));for(const n of t)e.removeAttribute(n,i)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class to{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}var io=i(68652);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class no extends to{elementToElement(e){return this.add(xo(e))}attributeToElement(e){return this.add(Vo(e))}attributeToAttribute(e){return this.add(Ao(e))}markerToElement(e){return this.add(Eo(e))}markerToHighlight(e){return this.add(Po(e))}markerToData(e){return this.add(To(e))}}function oo(){return(e,t,i)=>{if(!i.consumable.consume(t.item,"insert"))return;const n=i.writer,o=i.mapper.toViewPosition(t.range.start),s=n.createText(t.item.data);n.insert(o,s)}}function so(){return(e,t,i)=>{const n=i.mapper.toViewPosition(t.position),o=t.position.getShiftedBy(t.length),s=i.mapper.toViewPosition(o,{isPhantom:!0}),r=i.writer.createRange(n,s),a=i.writer.remove(r.getTrimmed());for(const l of i.writer.createRangeIn(a).getItems())i.mapper.unbindViewElement(l)}}function ro(e,t){const i=e.createAttributeElement("span",t.attributes);return t.classes&&i._addClass(t.classes),"number"===typeof t.priority&&(i._priority=t.priority),i._id=t.id,i}function ao(){return(e,t,i)=>{const n=t.selection;if(n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;const o=[];for(const s of n.getRanges()){const e=i.mapper.toViewRange(s);o.push(e)}i.writer.setSelection(o,{backward:n.isBackward})}}function lo(){return(e,t,i)=>{const n=t.selection;if(!n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;const o=i.writer,s=n.getFirstPosition(),r=i.mapper.toViewPosition(s),a=o.breakAttributes(r);o.setSelection(a)}}function co(){return(e,t,i)=>{const n=i.writer,o=n.document.selection;for(const s of o.getRanges())s.isCollapsed&&s.end.parent.isAttached()&&i.writer.mergeAttributes(s.start);n.setSelection(null)}}function ho(e){return(t,i,n)=>{const o=e(i.attributeOldValue,n),s=e(i.attributeNewValue,n);if(!o&&!s)return;if(!n.consumable.consume(i.item,t.name))return;const r=n.writer,a=r.document.selection;if(i.item instanceof zn||i.item instanceof Yn)r.wrap(a.getFirstRange(),s);else{let e=n.mapper.toViewRange(i.range);null!==i.attributeOldValue&&o&&(e=r.unwrap(e,o)),null!==i.attributeNewValue&&s&&r.wrap(e,s)}}}function uo(e){return(t,i,n)=>{const o=e(i.item,n);if(!o)return;if(!n.consumable.consume(i.item,"insert"))return;const s=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(i.item,o),n.writer.insert(s,o)}}function mo(e){return(t,i,n)=>{i.isOpening=!0;const o=e(i,n);i.isOpening=!1;const s=e(i,n);if(!o||!s)return;const r=i.markerRange;if(r.isCollapsed&&!n.consumable.consume(r,t.name))return;for(const e of r)if(!n.consumable.consume(e.item,t.name))return;const a=n.mapper,l=n.writer;l.insert(a.toViewPosition(r.start),o),n.mapper.bindElementToMarker(o,i.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),s),n.mapper.bindElementToMarker(s,i.markerName)),t.stop()}}function go(){return(e,t,i)=>{const n=i.mapper.markerNameToElements(t.markerName);if(n){for(const e of n)i.mapper.unbindElementFromMarkerName(e,t.markerName),i.writer.clear(i.writer.createRangeOn(e),e);i.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function po(e){return(t,i,n)=>{const o=e(i.markerName,n);if(!o)return;const s=i.markerRange;n.consumable.consume(s,t.name)&&(fo(s,!1,n,i,o),fo(s,!0,n,i,o),t.stop())}}function fo(e,t,i,n,o){const s=t?e.start:e.end,r=s.nodeAfter&&s.nodeAfter.is("element")?s.nodeAfter:null,a=s.nodeBefore&&s.nodeBefore.is("element")?s.nodeBefore:null;if(r||a){let e,s;t&&r||!t&&!a?(e=r,s=!0):(e=a,s=!1);const l=i.mapper.toViewElement(e);if(l)return void wo(l,t,s,i,n,o)}const l=i.mapper.toViewPosition(s);bo(l,t,i,n,o)}function wo(e,t,i,n,o,s){const r=`data-${s.group}-${t?"start":"end"}-${i?"before":"after"}`,a=e.hasAttribute(r)?e.getAttribute(r).split(","):[];a.unshift(s.name),n.writer.setAttribute(r,a.join(","),e),n.mapper.bindElementToMarker(e,o.markerName)}function bo(e,t,i,n,o){const s=`${o.group}-${t?"start":"end"}`,r=o.name?{name:o.name}:null,a=i.writer.createUIElement(s,r);i.writer.insert(e,a),i.mapper.bindElementToMarker(a,n.markerName)}function vo(e){return(t,i,n)=>{const o=e(i.markerName,n);if(!o)return;const s=n.mapper.markerNameToElements(i.markerName);if(s){for(const e of s)n.mapper.unbindElementFromMarkerName(e,i.markerName),e.is("containerElement")?(r(`data-${o.group}-start-before`,e),r(`data-${o.group}-start-after`,e),r(`data-${o.group}-end-before`,e),r(`data-${o.group}-end-after`,e)):n.writer.clear(n.writer.createRangeOn(e),e);n.writer.clearClonedElementsGroup(i.markerName),t.stop()}function r(e,t){if(t.hasAttribute(e)){const i=new Set(t.getAttribute(e).split(","));i.delete(o.name),0==i.size?n.writer.removeAttribute(e,t):n.writer.setAttribute(e,Array.from(i).join(","),t)}}}}function _o(e){return(t,i,n)=>{const o=e(i.attributeOldValue,n),s=e(i.attributeNewValue,n);if(!o&&!s)return;if(!n.consumable.consume(i.item,t.name))return;const r=n.mapper.toViewElement(i.item),a=n.writer;if(!r)throw new P.ZP("conversion-attribute-to-attribute-on-text",[i,n]);if(null!==i.attributeOldValue&&o)if("class"==o.key){const e=(0,B.Z)(o.value);for(const t of e)a.removeClass(t,r)}else if("style"==o.key){const e=Object.keys(o.value);for(const t of e)a.removeStyle(t,r)}else a.removeAttribute(o.key,r);if(null!==i.attributeNewValue&&s)if("class"==s.key){const e=(0,B.Z)(s.value);for(const t of e)a.addClass(t,r)}else if("style"==s.key){const e=Object.keys(s.value);for(const t of e)a.setStyle(t,s.value[t],r)}else a.setAttribute(s.key,s.value,r)}}function yo(e){return(t,i,n)=>{if(!i.item)return;if(!(i.item instanceof zn||i.item instanceof Yn)&&!i.item.is("$textProxy"))return;const o=Ro(e,i,n);if(!o)return;if(!n.consumable.consume(i.item,t.name))return;const s=n.writer,r=ro(s,o),a=s.document.selection;if(i.item instanceof zn||i.item instanceof Yn)s.wrap(a.getFirstRange(),r,a);else{const e=n.mapper.toViewRange(i.range),t=s.wrap(e,r);for(const o of t.getItems())if(o.is("attributeElement")&&o.isSimilar(r)){n.mapper.bindElementToMarker(o,i.markerName);break}}}}function ko(e){return(t,i,n)=>{if(!i.item)return;if(!(i.item instanceof Cn))return;const o=Ro(e,i,n);if(!o)return;if(!n.consumable.test(i.item,t.name))return;const s=n.mapper.toViewElement(i.item);if(s&&s.getCustomProperty("addHighlight")){n.consumable.consume(i.item,t.name);for(const e of In._createIn(i.item))n.consumable.consume(e.item,t.name);s.getCustomProperty("addHighlight")(s,o,n.writer),n.mapper.bindElementToMarker(s,i.markerName)}}}function Co(e){return(t,i,n)=>{if(i.markerRange.isCollapsed)return;const o=Ro(e,i,n);if(!o)return;const s=ro(n.writer,o),r=n.mapper.markerNameToElements(i.markerName);if(r){for(const e of r)n.mapper.unbindElementFromMarkerName(e,i.markerName),e.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(e),s):e.getCustomProperty("removeHighlight")(e,o.id,n.writer);n.writer.clearClonedElementsGroup(i.markerName),t.stop()}}}function xo(e){return e=(0,io.Z)(e),e.view=So(e.view,"container"),t=>{if(t.on("insert:"+e.model,uo(e.view),{priority:e.converterPriority||"normal"}),e.triggerBy){if(e.triggerBy.attributes)for(const i of e.triggerBy.attributes)t._mapReconversionTriggerEvent(e.model,`attribute:${i}:${e.model}`);if(e.triggerBy.children)for(const i of e.triggerBy.children)t._mapReconversionTriggerEvent(e.model,`insert:${i}`),t._mapReconversionTriggerEvent(e.model,`remove:${i}`)}}}function Vo(e){e=(0,io.Z)(e);const t=e.model.key?e.model.key:e.model;let i="attribute:"+t;if(e.model.name&&(i+=":"+e.model.name),e.model.values)for(const o of e.model.values)e.view[o]=So(e.view[o],"attribute");else e.view=So(e.view,"attribute");const n=No(e);return t=>{t.on(i,ho(n),{priority:e.converterPriority||"normal"})}}function Ao(e){e=(0,io.Z)(e);const t=e.model.key?e.model.key:e.model;let i="attribute:"+t;if(e.model.name&&(i+=":"+e.model.name),e.model.values)for(const o of e.model.values)e.view[o]=Bo(e.view[o]);else e.view=Bo(e.view);const n=No(e);return t=>{t.on(i,_o(n),{priority:e.converterPriority||"normal"})}}function Eo(e){return e=(0,io.Z)(e),e.view=So(e.view,"ui"),t=>{t.on("addMarker:"+e.model,mo(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,go(e.view),{priority:e.converterPriority||"normal"})}}function To(e){e=(0,io.Z)(e);const t=e.model;return e.view||(e.view=i=>({group:t,name:i.substr(e.model.length+1)})),i=>{i.on("addMarker:"+t,po(e.view),{priority:e.converterPriority||"normal"}),i.on("removeMarker:"+t,vo(e.view),{priority:e.converterPriority||"normal"})}}function Po(e){return t=>{t.on("addMarker:"+e.model,yo(e.view),{priority:e.converterPriority||"normal"}),t.on("addMarker:"+e.model,ko(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,Co(e.view),{priority:e.converterPriority||"normal"})}}function So(e,t){return"function"==typeof e?e:(i,n)=>Io(e,n,t)}function Io(e,t,i){let n;"string"==typeof e&&(e={name:e});const o=t.writer,s=Object.assign({},e.attributes);if("container"==i)n=o.createContainerElement(e.name,s);else if("attribute"==i){const t={priority:e.priority||ot.DEFAULT_PRIORITY};n=o.createAttributeElement(e.name,s,t)}else n=o.createUIElement(e.name,s);if(e.styles){const t=Object.keys(e.styles);for(const i of t)o.setStyle(i,e.styles[i],n)}if(e.classes){const t=e.classes;if("string"==typeof t)o.addClass(t,n);else for(const e of t)o.addClass(e,n)}return n}function No(e){return e.model.values?(t,i)=>{const n=e.view[t];return n?n(t,i):null}:e.view}function Bo(e){return"string"==typeof e?t=>({key:e,value:t}):"object"==typeof e?e.value?()=>e:t=>({key:e.key,value:t}):e}function Ro(e,t,i){const n="function"==typeof e?e(t,i):e;return n?(n.priority||(n.priority=10),n.id||(n.id=t.markerName),n):null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Do(e){const{schema:t,document:i}=e.model;for(const n of i.getRootNames()){const o=i.getRoot(n);if(o.isEmpty&&!t.checkChild(o,"$text")&&t.checkChild(o,"paragraph"))return e.insertElement("paragraph",o),!0}return!1}function Mo(e,t,i){const n=i.createContext(e);return!!i.checkChild(n,"paragraph")&&!!i.checkChild(n.push("paragraph"),t)}function Oo(e,t){const i=t.createElement("paragraph");return t.insert(i,e),t.createPositionAt(i,0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lo extends to{elementToElement(e){return this.add(Zo(e))}elementToAttribute(e){return this.add(Wo(e))}attributeToAttribute(e){return this.add(Ho(e))}elementToMarker(e){return this.add(Uo(e))}dataToMarker(e){return this.add(qo(e))}}function Fo(){return(e,t,i)=>{if(!t.modelRange&&i.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:n}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=n}}}function zo(){return(e,t,{schema:i,consumable:n,writer:o})=>{let s=t.modelCursor;if(!n.test(t.viewItem))return;if(!i.checkChild(s,"$text")){if(!Mo(s,"$text",i))return;s=Oo(s,o)}n.consume(t.viewItem);const r=o.createText(t.viewItem.data);o.insert(r,s),t.modelRange=o.createRange(s,s.getShiftedBy(r.offsetSize)),t.modelCursor=t.modelRange.end}}function $o(e,t){return(i,n)=>{const o=n.newSelection,s=[];for(const e of o.getRanges())s.push(t.toModelRange(e));const r=e.createSelection(s,{backward:o.isBackward});r.isEqual(e.document.selection)||e.change((e=>{e.setSelection(r)}))}}function Zo(e){e=(0,io.Z)(e);const t=Ko(e),i=jo(e.view),n=i?"element:"+i:"element";return i=>{i.on(n,t,{priority:e.converterPriority||"normal"})}}function Wo(e){e=(0,io.Z)(e),Qo(e);const t=Xo(e,!1),i=jo(e.view),n=i?"element:"+i:"element";return i=>{i.on(n,t,{priority:e.converterPriority||"low"})}}function Ho(e){e=(0,io.Z)(e);let t=null;("string"==typeof e.view||e.view.key)&&(t=Yo(e)),Qo(e,t);const i=Xo(e,!0);return t=>{t.on("element",i,{priority:e.converterPriority||"low"})}}function Uo(e){return e=(0,io.Z)(e),is(e),Zo(e)}function qo(e){e=(0,io.Z)(e),e.model||(e.model=t=>t?e.view+":"+t:e.view);const t=Ko(ns(e,"start")),i=Ko(ns(e,"end"));return n=>{n.on("element:"+e.view+"-start",t,{priority:e.converterPriority||"normal"}),n.on("element:"+e.view+"-end",i,{priority:e.converterPriority||"normal"});const o=nn.Z.get("low"),s=nn.Z.get("highest"),r=nn.Z.get(e.converterPriority)/s;n.on("element",Go(e),{priority:o+r})}}function Go(e){return(t,i,n)=>{const o=`data-${e.view}`;function s(t,o){for(const s of o){const o=e.model(s,n),r=n.writer.createElement("$marker",{"data-name":o});n.writer.insert(r,t),i.modelCursor.isEqual(t)?i.modelCursor=i.modelCursor.getShiftedBy(1):i.modelCursor=i.modelCursor._getTransformedByInsertion(t,1),i.modelRange=i.modelRange._getTransformedByInsertion(t,1)[0]}}(n.consumable.test(i.viewItem,{attributes:o+"-end-after"})||n.consumable.test(i.viewItem,{attributes:o+"-start-after"})||n.consumable.test(i.viewItem,{attributes:o+"-end-before"})||n.consumable.test(i.viewItem,{attributes:o+"-start-before"}))&&(i.modelRange||Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor)),n.consumable.consume(i.viewItem,{attributes:o+"-end-after"})&&s(i.modelRange.end,i.viewItem.getAttribute(o+"-end-after").split(",")),n.consumable.consume(i.viewItem,{attributes:o+"-start-after"})&&s(i.modelRange.end,i.viewItem.getAttribute(o+"-start-after").split(",")),n.consumable.consume(i.viewItem,{attributes:o+"-end-before"})&&s(i.modelRange.start,i.viewItem.getAttribute(o+"-end-before").split(",")),n.consumable.consume(i.viewItem,{attributes:o+"-start-before"})&&s(i.modelRange.start,i.viewItem.getAttribute(o+"-start-before").split(",")))}}function jo(e){return"string"==typeof e?e:"object"==typeof e&&"string"==typeof e.name?e.name:null}function Ko(e){const t=new Q(e.view);return(i,n,o)=>{const s=t.match(n.viewItem);if(!s)return;const r=s.match;if(r.name=!0,!o.consumable.test(n.viewItem,r))return;const a=Jo(e.model,n.viewItem,o);a&&o.safeInsert(a,n.modelCursor)&&(o.consumable.consume(n.viewItem,r),o.convertChildren(n.viewItem,a),o.updateConversionResult(a,n))}}function Jo(e,t,i){return e instanceof Function?e(t,i):i.writer.createElement(e)}function Yo(e){"string"==typeof e.view&&(e.view={key:e.view});const t=e.view.key;let i;if("class"==t||"style"==t){const n="class"==t?"classes":"styles";i={[n]:e.view.value}}else{const n="undefined"==typeof e.view.value?/[\s\S]*/:e.view.value;i={attributes:{[t]:n}}}return e.view.name&&(i.name=e.view.name),e.view=i,t}function Qo(e,t=null){const i=null===t||(e=>e.getAttribute(t)),n="object"!=typeof e.model?e.model:e.model.key,o="object"!=typeof e.model||"undefined"==typeof e.model.value?i:e.model.value;e.model={key:n,value:o}}function Xo(e,t){const i=new Q(e.view);return(n,o,s)=>{const r=i.match(o.viewItem);if(!r)return;if(es(e.view,o.viewItem)?r.match.name=!0:delete r.match.name,!s.consumable.test(o.viewItem,r.match))return;const a=e.model.key,l="function"==typeof e.model.value?e.model.value(o.viewItem,s):e.model.value;if(null===l)return;o.modelRange||Object.assign(o,s.convertChildren(o.viewItem,o.modelCursor));const c=ts(o.modelRange,{key:a,value:l},t,s);c&&s.consumable.consume(o.viewItem,r.match)}}function es(e,t){const i="function"==typeof e?e(t):e;return!("object"==typeof i&&!jo(i))&&(!i.classes&&!i.attributes&&!i.styles)}function ts(e,t,i,n){let o=!1;for(const s of Array.from(e.getItems({shallow:i})))n.schema.checkAttribute(s,t.key)&&(o=!0,s.hasAttribute(t.key)||n.writer.setAttribute(t.key,t.value,s));return o}function is(e){const t=e.model;e.model=(e,i)=>{const n="string"==typeof t?t:t(e,i);return i.writer.createElement("$marker",{"data-name":n})}}function ns(e,t){const i={};return i.view=e.view+"-"+t,i.model=(t,i)=>{const n=t.getAttribute("name"),o=e.model(n,i);return i.writer.createElement("$marker",{"data-name":o})},i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class os{constructor(e,t){this.model=e,this.view=new bn(t),this.mapper=new Nn,this.downcastDispatcher=new Dn({mapper:this.mapper,schema:e.schema});const i=this.model.document,n=i.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",(()=>{this.view._disableRendering(!0)}),{priority:"highest"}),this.listenTo(this.model,"_afterChanges",(()=>{this.view._disableRendering(!1)}),{priority:"lowest"}),this.listenTo(i,"change",(()=>{this.view.change((e=>{this.downcastDispatcher.convertChanges(i.differ,o,e),this.downcastDispatcher.convertSelection(n,o,e)}))}),{priority:"low"}),this.listenTo(this.view.document,"selectionChange",$o(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",oo(),{priority:"lowest"}),this.downcastDispatcher.on("remove",so(),{priority:"low"}),this.downcastDispatcher.on("selection",co(),{priority:"high"}),this.downcastDispatcher.on("selection",ao(),{priority:"low"}),this.downcastDispatcher.on("selection",lo(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using((e=>{if("$graveyard"==e.rootName)return null;const t=new Le(this.view.document,e.name);return t.rootName=e.rootName,this.mapper.bindElements(e,t),t}))}destroy(){this.view.destroy(),this.stopListening()}}(0,I.Z)(os,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ss{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const i=this.get(e);if(!i)throw new P.ZP("commandcollection-command-not-found",this,{commandName:e});return i.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rs{constructor(){this._consumables=new Map}add(e,t){let i;e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?i=this._consumables.get(e):(i=new as(e),this._consumables.set(e,i)),i.add(t))}test(e,t){const i=this._consumables.get(e);return void 0===i?null:e.is("$text")||e.is("documentFragment")?i:i.test(t)}consume(e,t){return!!this.test(e,t)&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0)}revert(e,t){const i=this._consumables.get(e);void 0!==i&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):i.revert(t))}static consumablesFromElement(e){const t={element:e,name:!0,attributes:[],classes:[],styles:[]},i=e.getAttributeKeys();for(const s of i)"style"!=s&&"class"!=s&&t.attributes.push(s);const n=e.getClassNames();for(const s of n)t.classes.push(s);const o=e.getStyleNames();for(const s of o)t.styles.push(s);return t}static createFrom(e,t){if(t||(t=new rs(e)),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,rs.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const i of e.getChildren())t=rs.createFrom(i,t);return t}}class as{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t in this._consumables)if(t in e){const i=this._test(t,e[t]);if(!0!==i)return i}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t in this._consumables)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._revert(t,e[t])}_add(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const o of i){if("attributes"===e&&("class"===o||"style"===o))throw new P.ZP("viewconsumable-invalid-attribute",this);if(n.set(o,!0),"styles"===e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(o))n.set(e,!0)}}_test(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const o of i)if("attributes"!==e||"class"!==o&&"style"!==o){const e=n.get(o);if(void 0===e)return null;if(!e)return!1}else{const e="class"==o?"classes":"styles",t=this._test(e,[...this._consumables[e].keys()]);if(!0!==t)return t}return!0}_consume(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const o of i)if("attributes"!==e||"class"!==o&&"style"!==o){if(n.set(o,!1),"styles"==e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(o))n.set(e,!1)}else{const e="class"==o?"classes":"styles";this._consume(e,[...this._consumables[e].keys()])}}_revert(e,t){const i=(0,Oi.Z)(t)?t:[t],n=this._consumables[e];for(const o of i)if("attributes"!==e||"class"!==o&&"style"!==o){const e=n.get(o);!1===e&&n.set(o,!0)}else{const e="class"==o?"classes":"styles";this._revert(e,[...this._consumables[e].keys()])}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ls{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",((e,t)=>{t[0]=new cs(t[0])}),{priority:"highest"}),this.on("checkChild",((e,t)=>{t[0]=new cs(t[0]),t[1]=this.getDefinition(t[1])}),{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new P.ZP("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new P.ZP("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return t="string"==typeof e?e:e.is&&(e.is("$text")||e.is("$textProxy"))?"$text":e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!(!t||!t.isBlock)}isLimit(e){const t=this.getDefinition(e);return!!t&&!(!t.isLimit&&!t.isObject)}isObject(e){const t=this.getDefinition(e);return!!t&&!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent)}isInline(e){const t=this.getDefinition(e);return!(!t||!t.isInline)}isSelectable(e){const t=this.getDefinition(e);return!!t&&!(!t.isSelectable&&!t.isObject)}isContent(e){const t=this.getDefinition(e);return!!t&&!(!t.isContent&&!t.isObject)}checkChild(e,t){return!!t&&this._checkContextMatch(t,e)}checkAttribute(e,t){const i=this.getDefinition(e.last);return!!i&&i.allowAttributes.includes(t)}checkMerge(e,t=null){if(e instanceof En){const t=e.nodeBefore,i=e.nodeAfter;if(!(t instanceof Cn))throw new P.ZP("schema-check-merge-no-element-before",this);if(!(i instanceof Cn))throw new P.ZP("schema-check-merge-no-element-after",this);return this.checkMerge(t,i)}for(const i of t.getChildren())if(!this.checkChild(e,i))return!1;return!0}addChildCheck(e){this.on("checkChild",((t,[i,n])=>{if(!n)return;const o=e(i,n);"boolean"==typeof o&&(t.stop(),t.return=o)}),{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",((t,[i,n])=>{const o=e(i,n);"boolean"==typeof o&&(t.stop(),t.return=o)}),{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;if(e instanceof En)t=e.parent;else{const i=e instanceof In?[e]:Array.from(e.getRanges());t=i.reduce(((e,t)=>{const i=t.getCommonAncestor();return e?e.getCommonAncestor(i,{includeSelf:!0}):i}),null)}while(!this.isLimit(t)){if(!t.parent)break;t=t.parent}return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const i=e.getFirstPosition(),n=[...i.getAncestors(),new _n("",e.getAttributes())];return this.checkAttribute(n,t)}{const i=e.getRanges();for(const e of i)for(const i of e)if(this.checkAttribute(i.item,t))return!0}return!1}*getValidRanges(e,t){e=As(e);for(const i of e)yield*this._getValidRangesForRange(i,t)}getNearestSelectionRange(e,t="both"){if(this.checkChild(e,"$text"))return new In(e);let i,n;const o=e.getAncestors().reverse().find((e=>this.isLimit(e)))||e.root;"both"!=t&&"backward"!=t||(i=new Vn({boundaries:In._createIn(o),startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(n=new Vn({boundaries:In._createIn(o),startPosition:e}));for(const s of Vs(i,n)){const e=s.walker==i?"elementEnd":"elementStart",t=s.value;if(t.type==e&&this.isObject(t.item))return In._createOn(t.item);if(this.checkChild(t.nextPosition,"$text"))return new In(t.nextPosition)}return null}findAllowedParent(e,t){let i=e.parent;while(i){if(this.checkChild(i,t))return i;if(this.isLimit(i))return null;i=i.parent}return null}removeDisallowedAttributes(e,t){for(const i of e)if(i.is("$text"))Es(this,i,t);else{const e=In._createIn(i),n=e.getPositions();for(const i of n){const e=i.nodeBefore||i.parent;Es(this,e,t)}}}createContext(e){return new cs(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,i=Object.keys(t);for(const n of i)e[n]=ds(t[n],n);for(const n of i)hs(e,n);for(const n of i)us(e,n);for(const n of i)ms(e,n);for(const n of i)gs(e,n),ps(e,n);for(const n of i)fs(e,n),ws(e,n),bs(e,n);this._compiledDefinitions=e}_checkContextMatch(e,t,i=t.length-1){const n=t.getItem(i);if(e.allowIn.includes(n.name)){if(0==i)return!0;{const e=this.getDefinition(n);return this._checkContextMatch(e,t,i-1)}}return!1}*_getValidRangesForRange(e,t){let i=e.start,n=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(In._createIn(o),t)),this.checkAttribute(o,t)||(i.isEqual(n)||(yield new In(i,n)),i=En._createAfter(o)),n=En._createAfter(o);i.isEqual(n)||(yield new In(i,n))}}(0,I.Z)(ls,Z.Z);class cs{constructor(e){if(e instanceof cs)return e;"string"==typeof e?e=[e]:Array.isArray(e)||(e=e.getAncestors({includeSelf:!0})),this._items=e.map(xs)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new cs([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map((e=>e.name))}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function ds(e,t){const i={name:t,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return vs(e,i),_s(e,i,"allowIn"),_s(e,i,"allowContentOf"),_s(e,i,"allowWhere"),_s(e,i,"allowAttributes"),_s(e,i,"allowAttributesOf"),_s(e,i,"allowChildren"),_s(e,i,"inheritTypesFrom"),ys(e,i),i}function hs(e,t){const i=e[t];for(const n of i.allowChildren){const i=e[n];i&&i.allowIn.push(t)}i.allowChildren.length=0}function us(e,t){for(const i of e[t].allowContentOf)if(e[i]){const n=ks(e,i);n.forEach((e=>{e.allowIn.push(t)}))}delete e[t].allowContentOf}function ms(e,t){for(const i of e[t].allowWhere){const n=e[i];if(n){const i=n.allowIn;e[t].allowIn.push(...i)}}delete e[t].allowWhere}function gs(e,t){for(const i of e[t].allowAttributesOf){const n=e[i];if(n){const i=n.allowAttributes;e[t].allowAttributes.push(...i)}}delete e[t].allowAttributesOf}function ps(e,t){const i=e[t];for(const n of i.inheritTypesFrom){const t=e[n];if(t){const e=Object.keys(t).filter((e=>e.startsWith("is")));for(const n of e)n in i||(i[n]=t[n])}}delete i.inheritTypesFrom}function fs(e,t){const i=e[t],n=i.allowIn.filter((t=>e[t]));i.allowIn=Array.from(new Set(n))}function ws(e,t){const i=e[t];for(const n of i.allowIn){const i=e[n];i.allowChildren.push(t)}}function bs(e,t){const i=e[t];i.allowAttributes=Array.from(new Set(i.allowAttributes))}function vs(e,t){for(const i of e){const e=Object.keys(i).filter((e=>e.startsWith("is")));for(const n of e)t[n]=i[n]}}function _s(e,t,i){for(const n of e)"string"==typeof n[i]?t[i].push(n[i]):Array.isArray(n[i])&&t[i].push(...n[i])}function ys(e,t){for(const i of e){const e=i.inheritAllFrom;e&&(t.allowContentOf.push(e),t.allowWhere.push(e),t.allowAttributesOf.push(e),t.inheritTypesFrom.push(e))}}function ks(e,t){const i=e[t];return Cs(e).filter((e=>e.allowIn.includes(i.name)))}function Cs(e){return Object.keys(e).map((t=>e[t]))}function xs(e){return"string"==typeof e||e.is("documentFragment")?{name:"string"==typeof e?e:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute(t){return e.getAttribute(t)}}}function*Vs(e,t){let i=!1;while(!i){if(i=!0,e){const t=e.next();t.done||(i=!1,yield{walker:e,value:t.value})}if(t){const e=t.next();e.done||(i=!1,yield{walker:t,value:e.value})}}}function*As(e){for(const t of e)yield*t.getMinimalFlatRanges()}function Es(e,t,i){for(const n of t.getAttributeKeys())e.checkAttribute(t,n)||i.removeAttribute(n,t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ts{constructor(e={}){this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.safeInsert=this._safeInsert.bind(this),this.conversionApi.updateConversionResult=this._updateConversionResult.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(e,t,i=["$root"]){this.fire("viewCleanup",e),this._modelCursor=Ss(i,t),this.conversionApi.writer=t,this.conversionApi.consumable=rs.createFrom(e),this.conversionApi.store={};const{modelRange:n}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(n){this._removeEmptyElements();for(const e of Array.from(this._modelCursor.parent.getChildren()))t.append(e,o);o.markers=Ps(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const i=Object.assign({viewItem:e,modelCursor:t,modelRange:null});if(e.is("element")?this.fire("element:"+e.name,i,this.conversionApi):e.is("$text")?this.fire("text",i,this.conversionApi):this.fire("documentFragment",i,this.conversionApi),i.modelRange&&!(i.modelRange instanceof In))throw new P.ZP("view-conversion-dispatcher-incorrect-result",this);return{modelRange:i.modelRange,modelCursor:i.modelCursor}}_convertChildren(e,t){let i=t.is("position")?t:En._createAt(t,0);const n=new In(i);for(const o of Array.from(e.getChildren())){const e=this._convertItem(o,i);e.modelRange instanceof In&&(n.end=e.modelRange.end,i=e.modelCursor)}return{modelRange:n,modelCursor:i}}_safeInsert(e,t){const i=this._splitToAllowedParent(e,t);return!!i&&(this.conversionApi.writer.insert(e,i.position),!0)}_updateConversionResult(e,t){const i=this._getSplitParts(e),n=this.conversionApi.writer;t.modelRange||(t.modelRange=n.createRange(n.createPositionBefore(e),n.createPositionAfter(i[i.length-1])));const o=this._cursorParents.get(e);t.modelCursor=o?n.createPositionAt(o,0):t.modelRange.end}_splitToAllowedParent(e,t){const{schema:i,writer:n}=this.conversionApi;let o=i.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return Mo(t,e,i)?{position:Oo(t,n)}:null;const s=this.conversionApi.writer.split(t,o),r=[];for(const l of s.range.getWalker())if("elementEnd"==l.type)r.push(l.item);else{const e=r.pop(),t=l.item;this._registerSplitPair(e,t)}const a=s.range.end.parent;return this._cursorParents.set(e,a),{position:s.position,cursorParent:a}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const i=this._splitParts.get(e);this._splitParts.set(t,i),i.push(t)}_getSplitParts(e){let t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}function Ps(e,t){const i=new Set,n=new Map,o=In._createIn(e).getItems();for(const s of o)"$marker"==s.name&&i.add(s);for(const s of i){const e=s.getAttribute("data-name"),i=t.createPositionBefore(s);n.has(e)?n.get(e).end=i.clone():n.set(e,new In(i.clone())),t.remove(s)}return n}function Ss(e,t){let i;for(const n of new cs(e)){const e={};for(const t of n.getAttributeKeys())e[t]=n.getAttribute(t);const o=t.createElement(n.name,e);i&&t.append(o,i),i=En._createAt(o,0)}return i}(0,I.Z)(Ts,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Is{getHtml(e){const t=document.implementation.createHTMLDocument(""),i=t.createElement("div");return i.appendChild(e),i.innerHTML}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ns{constructor(e){this.domParser=new DOMParser,this.domConverter=new gi(e,{renderingMode:"data"}),this.htmlWriter=new Is}toData(e){const t=this.domConverter.viewToDom(e,document);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t)}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode="marked"==e?"markedNbsp":"nbsp"}_toDom(e){const t=this.domParser.parseFromString(e,"text/html"),i=t.createDocumentFragment();let n=t.firstChild;while(!n.isSameNode(t.documentElement)){const e=n;n=n.nextSibling,e.nodeType==Node.COMMENT_NODE&&i.appendChild(e)}const o=t.body.childNodes;while(o.length>0)i.appendChild(o[0]);return i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bs{constructor(e,t){this.model=e,this.mapper=new Nn,this.downcastDispatcher=new Dn({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",oo(),{priority:"lowest"}),this.upcastDispatcher=new Ts({schema:e.schema}),this.viewDocument=new it(t),this.stylesProcessor=t,this.htmlProcessor=new Ns(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new bt(this.viewDocument),this.upcastDispatcher.on("text",zo(),{priority:"lowest"}),this.upcastDispatcher.on("element",Fo(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",Fo(),{priority:"lowest"}),this.decorate("init"),this.decorate("set"),this.decorate("get"),this.on("init",(()=>{this.fire("ready")}),{priority:"lowest"}),this.on("ready",(()=>{this.model.enqueueChange("transparent",Do)}),{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:i="empty"}=e;if(!this._checkIfRootsExists([t]))throw new P.ZP("datacontroller-get-non-existent-root",this);const n=this.model.document.getRoot(t);return"empty"!==i||this.model.hasContent(n,{ignoreWhitespaces:!0})?this.stringify(n,e):""}stringify(e,t={}){const i=this.toView(e,t);return this.processor.toData(i)}toView(e,t={}){const i=this.viewDocument,n=this._viewWriter;this.mapper.clearBindings();const o=In._createIn(e),s=new ft(i);this.mapper.bindElements(e,s),this.downcastDispatcher.conversionApi.options=t,this.downcastDispatcher.convertInsert(o,n);const r=e.is("documentFragment")?Array.from(e.markers):Rs(e);for(const[a,l]of r)this.downcastDispatcher.convertMarkerAdd(a,l,n);return delete this.downcastDispatcher.conversionApi.options,s}init(e){if(this.model.document.version)throw new P.ZP("datacontroller-init-document-not-empty",this);let t={};if("string"===typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new P.ZP("datacontroller-init-non-existent-root",this);return this.model.enqueueChange("transparent",(e=>{for(const i of Object.keys(t)){const n=this.model.document.getRoot(i);e.insert(this.parse(t[i],n),n,0)}})),Promise.resolve()}set(e,t={}){let i={};if("string"===typeof e?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new P.ZP("datacontroller-set-non-existent-root",this);const n=t.batchType||"default";this.model.enqueueChange(n,(e=>{e.setSelection(null),e.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const t of Object.keys(i)){const n=this.model.document.getRoot(t);e.remove(e.createRangeIn(n)),e.insert(this.parse(i[t],n),n,0)}}))}parse(e,t="$root"){const i=this.processor.toView(e);return this.toModel(i,t)}toModel(e,t="$root"){return this.model.change((i=>this.upcastDispatcher.convert(e,i,t)))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRootNames().includes(t))return!1;return!0}}function Rs(e){const t=[],i=e.root.document;if(!i)return[];const n=In._createIn(e);for(const o of i.model.markers){const e=o.getRange(),i=e.isCollapsed,s=e.start.isEqual(n.start)||e.end.isEqual(n.end);if(i&&s)t.push([o.name,e]);else{const i=n.getIntersection(e);i&&t.push([o.name,i])}}return t.sort((([e,t],[i,n])=>{if("after"!==t.end.compareWith(n.start))return 1;if("before"!==t.start.compareWith(n.end))return-1;switch(t.start.compareWith(n.start)){case"before":return 1;case"after":return-1;default:switch(t.end.compareWith(n.end)){case"before":return 1;case"after":return-1;default:return i.localeCompare(e)}}}))}(0,I.Z)(Bs,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ds{constructor(e,t){this._helpers=new Map,this._downcast=(0,B.Z)(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=(0,B.Z)(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const i=this._downcast.includes(t),n=this._upcast.includes(t);if(!n&&!i)throw new P.ZP("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:i})}for(e){if(!this._helpers.has(e))throw new P.ZP("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:i}of Ms(e))this.for("upcast").elementToElement({model:t,view:i,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:i}of Ms(e))this.for("upcast").elementToAttribute({view:i,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:i}of Ms(e))this.for("upcast").attributeToAttribute({view:i,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:i}){if(this._helpers.has(e))throw new P.ZP("conversion-group-exists",this);const n=i?new no(t):new Lo(t);this._helpers.set(e,n)}}function*Ms(e){if(e.model.values)for(const t of e.model.values){const i={key:e.model.key,value:t},n=e.view[t],o=e.upcastAlso?e.upcastAlso[t]:void 0;yield*Os(i,n,o)}else yield*Os(e.model,e.view,e.upcastAlso)}function*Os(e,t,i){if(yield{model:e,view:t},i)for(const n of(0,B.Z)(i))yield{model:e,view:n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ls{constructor(e="default"){this.operations=[],this.type=e}get baseVersion(){for(const e of this.operations)if(null!==e.baseVersion)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fs{constructor(e){this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e){return new this(e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zs{constructor(e){this.markers=new Map,this._children=new kn,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"model:documentFragment"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const i of e)t=t.getChild(t.offsetToIndex(i));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const i of e)i.name?t.push(Cn.fromJSON(i)):t.push(_n.fromJSON(i));return new zs(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const i=$s(t);for(const n of i)null!==n.parent&&n._remove(),n.parent=this;this._children._insertNodes(e,i)}_removeChildren(e,t=1){const i=this._children._removeNodes(e,t);for(const n of i)n.parent=null;return i}}function $s(e){return"string"==typeof e?[new _n(e)]:((0,J.Z)(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new _n(e):e instanceof yn?new _n(e.data,e.getAttributes()):e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zs(e,t){t=qs(t);const i=t.reduce(((e,t)=>e+t.offsetSize),0),n=e.parent;js(e);const o=e.index;return n._insertChild(o,t),Gs(n,o+t.length),Gs(n,o),new In(e,e.getShiftedBy(i))}function Ws(e){if(!e.isFlat)throw new P.ZP("operation-utils-remove-range-not-flat",this);const t=e.start.parent;js(e.start),js(e.end);const i=t._removeChildren(e.start.index,e.end.index-e.start.index);return Gs(t,e.start.index),i}function Hs(e,t){if(!e.isFlat)throw new P.ZP("operation-utils-move-range-not-flat",this);const i=Ws(e);return t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),Zs(t,i)}function Us(e,t,i){js(e.start),js(e.end);for(const n of e.getItems({shallow:!0})){const e=n.is("$textProxy")?n.textNode:n;null!==i?e._setAttribute(t,i):e._removeAttribute(t),Gs(e.parent,e.index)}Gs(e.end.parent,e.end.index)}function qs(e){const t=[];e instanceof Array||(e=[e]);for(let i=0;i<e.length;i++)if("string"==typeof e[i])t.push(new _n(e[i]));else if(e[i]instanceof yn)t.push(new _n(e[i].data,e[i].getAttributes()));else if(e[i]instanceof zs||e[i]instanceof kn)for(const n of e[i])t.push(n);else e[i]instanceof vn&&t.push(e[i]);for(let i=1;i<t.length;i++){const e=t[i],n=t[i-1];e instanceof _n&&n instanceof _n&&Ks(e,n)&&(t.splice(i-1,2,new _n(n.data+e.data,n.getAttributes())),i--)}return t}function Gs(e,t){const i=e.getChild(t-1),n=e.getChild(t);if(i&&n&&i.is("$text")&&n.is("$text")&&Ks(i,n)){const o=new _n(i.data+n.data,i.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,o)}}function js(e){const t=e.textNode,i=e.parent;if(t){const n=e.offset-t.startOffset,o=t.index;i._removeChildren(o,1);const s=new _n(t.data.substr(0,n),t.getAttributes()),r=new _n(t.data.substr(n),t.getAttributes());i._insertChild(o,[s,r])}}function Ks(e,t){const i=e.getAttributes(),n=t.getAttributes();for(const o of i){if(o[1]!==t.getAttribute(o[0]))return!1;n.next()}return n.next().done}var Js=i(50576);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ys extends Fs{constructor(e,t,i,n,o){super(o),this.range=e.clone(),this.key=t,this.oldValue=void 0===i?null:i,this.newValue=void 0===n?null:n}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new Ys(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Ys(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new P.ZP("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!(0,Js.Z)(e.getAttribute(this.key),this.oldValue))throw new P.ZP("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&e.hasAttribute(this.key))throw new P.ZP("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){(0,Js.Z)(this.oldValue,this.newValue)||Us(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new Ys(In.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qs extends Fs{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new P.ZP("detach-operation-on-document-node",this)}_execute(){Ws(In._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xs extends Fs{constructor(e,t,i,n){super(n),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,i=this.sourcePosition.offset,n=this.targetPosition.offset;if(i+this.howMany>e.maxOffset)throw new P.ZP("move-operation-nodes-do-not-exist",this);if(e===t&&i<n&&n<i+this.howMany)throw new P.ZP("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==H(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const e=this.sourcePosition.path.length-1;if(this.targetPosition.path[e]>=i&&this.targetPosition.path[e]<i+this.howMany)throw new P.ZP("move-operation-node-into-itself",this)}}_execute(){Hs(In._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const i=En.fromJSON(e.sourcePosition,t),n=En.fromJSON(e.targetPosition,t);return new this(i,e.howMany,n,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class er extends Fs{constructor(e,t,i){super(i),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new kn(qs(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const e=new kn([...this.nodes].map((e=>e._clone(!0)))),t=new er(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new En(e,[0]);return new Xs(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new P.ZP("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new kn([...e].map((e=>e._clone(!0)))),Zs(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const i=[];for(const o of e.nodes)o.name?i.push(Cn.fromJSON(o)):i.push(_n.fromJSON(o));const n=new er(En.fromJSON(e.position,t),i,e.baseVersion);return n.shouldReceiveAttributes=e.shouldReceiveAttributes,n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tr extends Fs{constructor(e,t,i,n,o,s){super(s),this.name=e,this.oldRange=t?t.clone():null,this.newRange=i?i.clone():null,this.affectsData=o,this._markers=n}get type(){return"marker"}clone(){return new tr(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new tr(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const e=this.newRange?"_set":"_remove";this._markers[e](this.name,this.newRange,!0,this.affectsData)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new tr(e.name,e.oldRange?In.fromJSON(e.oldRange,t):null,e.newRange?In.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ir extends Fs{constructor(e,t,i,n){super(n),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=i}get type(){return"rename"}clone(){return new ir(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new ir(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(!(e instanceof Cn))throw new P.ZP("rename-operation-wrong-position",this);if(e.name!==this.oldName)throw new P.ZP("rename-operation-wrong-name",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new ir(En.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nr extends Fs{constructor(e,t,i,n,o){super(o),this.root=e,this.key=t,this.oldValue=i,this.newValue=n}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new nr(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new nr(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new P.ZP("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new P.ZP("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new P.ZP("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new P.ZP("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new nr(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class or extends Fs{constructor(e,t,i,n,o){super(o),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=n.clone()}get type(){return"merge"}get deletionPosition(){return new En(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new In(this.sourcePosition,e)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),i=new En(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new sr(e,this.howMany,i,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new P.ZP("merge-operation-source-position-invalid",this);if(!t.parent)throw new P.ZP("merge-operation-target-position-invalid",this);if(this.howMany!=e.maxOffset)throw new P.ZP("merge-operation-how-many-invalid",this)}_execute(){const e=this.sourcePosition.parent,t=In._createIn(e);Hs(t,this.targetPosition),Hs(In._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const i=En.fromJSON(e.sourcePosition,t),n=En.fromJSON(e.targetPosition,t),o=En.fromJSON(e.graveyardPosition,t);return new this(i,e.howMany,n,o,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sr extends Fs{constructor(e,t,i,n,o){super(o),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=i,this.graveyardPosition=n?n.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new En(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new In(this.splitPosition,e)}clone(){return new this.constructor(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new En(e,[0]);return new or(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new P.ZP("split-operation-position-invalid",this);if(!e.parent)throw new P.ZP("split-operation-split-in-root",this);if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new P.ZP("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new P.ZP("split-operation-graveyard-position-invalid",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)Hs(In._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const t=e._clone();Zs(this.insertionPosition,t)}const t=new In(En._createAt(e,this.splitPosition.offset),En._createAt(e,e.maxOffset));Hs(t,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new En(e.root,t,"toPrevious")}static fromJSON(e,t){const i=En.fromJSON(e.splitPosition,t),n=En.fromJSON(e.insertionPosition,t),o=e.graveyardPosition?En.fromJSON(e.graveyardPosition,t):null;return new this(i,e.howMany,n,o,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rr extends Cn{constructor(e,t,i="main"){super(t),this._document=e,this.rootName=i}get document(){return this._document}is(e,t){return t?t===this.name&&("rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e):"rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e||"node"===e||"model:node"===e}toJSON(){return this.rootName}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ar{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new _n(e,t)}createElement(e,t){return new Cn(e,t)}createDocumentFragment(){return new zs}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,i=0){if(this._assertWriterUsedCorrectly(),e instanceof _n&&""==e.data)return;const n=En._createAt(t,i);if(e.parent){if(ur(e.root,n.root))return void this.move(In._createOn(e),n);if(e.root.document)throw new P.ZP("model-writer-insert-forbidden-move",this);this.remove(e)}const o=n.root.document?n.root.document.version:null,s=new er(n,e,o);if(e instanceof _n&&(s.shouldReceiveAttributes=!0),this.batch.addOperation(s),this.model.applyOperation(s),e instanceof zs)for(const[r,a]of e.markers){const e=En._createAt(a.root,0),t=new In(a.start._getCombined(e,n),a.end._getCombined(e,n)),i={range:t,usingOperation:!0,affectsData:!0};this.model.markers.has(r)?this.updateMarker(r,i):this.addMarker(r,i)}}insertText(e,t,i,n){t instanceof zs||t instanceof Cn||t instanceof En?this.insert(this.createText(e),t,i):this.insert(this.createText(e,t),i,n)}insertElement(e,t,i,n){t instanceof zs||t instanceof Cn||t instanceof En?this.insert(this.createElement(e),t,i):this.insert(this.createElement(e,t),i,n)}append(e,t){this.insert(e,t,"end")}appendText(e,t,i){t instanceof zs||t instanceof Cn?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),i,"end")}appendElement(e,t,i){t instanceof zs||t instanceof Cn?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),i,"end")}setAttribute(e,t,i){if(this._assertWriterUsedCorrectly(),i instanceof In){const n=i.getMinimalFlatRanges();for(const i of n)lr(this,e,t,i)}else cr(this,e,t,i)}setAttributes(e,t){for(const[i,n]of Y(e))this.setAttribute(i,n,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof In){const i=t.getMinimalFlatRanges();for(const t of i)lr(this,e,null,t)}else cr(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=e=>{for(const t of e.getAttributeKeys())this.removeAttribute(t,e)};if(e instanceof In)for(const i of e.getItems())t(i);else t(e)}move(e,t,i){if(this._assertWriterUsedCorrectly(),!(e instanceof In))throw new P.ZP("writer-move-invalid-range",this);if(!e.isFlat)throw new P.ZP("writer-move-range-not-flat",this);const n=En._createAt(t,i);if(n.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!ur(e.root,n.root))throw new P.ZP("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,s=new Xs(e.start,e.end.offset-e.start.offset,n,o);this.batch.addOperation(s),this.model.applyOperation(s)}remove(e){this._assertWriterUsedCorrectly();const t=e instanceof In?e:In._createOn(e),i=t.getMinimalFlatRanges().reverse();for(const n of i)this._addOperationForAffectedMarkers("move",n),hr(n.start,n.end.offset-n.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,i=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Cn))throw new P.ZP("writer-merge-no-element-before",this);if(!(i instanceof Cn))throw new P.ZP("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,i){return this.model.createPositionFromPath(e,t,i)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(e,t,i){return this.model.createSelection(e,t,i)}_mergeDetached(e){const t=e.nodeBefore,i=e.nodeAfter;this.move(In._createIn(i),En._createAt(t,"end")),this.remove(i)}_merge(e){const t=En._createAt(e.nodeBefore,"end"),i=En._createAt(e.nodeAfter,0),n=e.root.document.graveyard,o=new En(n,[0]),s=e.root.document.version,r=new or(i,e.nodeAfter.maxOffset,t,o,s);this.batch.addOperation(r),this.model.applyOperation(r)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Cn))throw new P.ZP("writer-rename-not-element-instance",this);const i=e.root.document?e.root.document.version:null,n=new ir(En._createBefore(e),e.name,t,i);this.batch.addOperation(n),this.model.applyOperation(n)}split(e,t){this._assertWriterUsedCorrectly();let i,n,o=e.parent;if(!o.parent)throw new P.ZP("writer-split-element-no-parent",this);if(t||(t=o.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new P.ZP("writer-split-invalid-limit-element",this);do{const t=o.root.document?o.root.document.version:null,s=o.maxOffset-e.offset,r=sr.getInsertionPosition(e),a=new sr(e,s,r,null,t);this.batch.addOperation(a),this.model.applyOperation(a),i||n||(i=o,n=e.parent.nextSibling),e=this.createPositionAfter(e.parent),o=e.parent}while(o!==t);return{position:e,range:new In(En._createAt(i,"end"),En._createAt(n,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new P.ZP("writer-wrap-range-not-flat",this);const i=t instanceof Cn?t:new Cn(t);if(i.childCount>0)throw new P.ZP("writer-wrap-element-not-empty",this);if(null!==i.parent)throw new P.ZP("writer-wrap-element-attached",this);this.insert(i,e.start);const n=new In(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(n,En._createAt(i,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new P.ZP("writer-unwrap-element-no-parent",this);this.move(In._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new P.ZP("writer-addmarker-no-usingoperation",this);const i=t.usingOperation,n=t.range,o=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new P.ZP("writer-addmarker-marker-exists",this);if(!n)throw new P.ZP("writer-addmarker-no-range",this);return i?(dr(this,e,null,n,o),this.model.markers.get(e)):this.model.markers._set(e,n,i,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const i="string"==typeof e?e:e.name,n=this.model.markers.get(i);if(!n)throw new P.ZP("writer-updatemarker-marker-not-exists",this);if(!t)return void this.model.markers._refresh(n);const o="boolean"==typeof t.usingOperation,s="boolean"==typeof t.affectsData,r=s?t.affectsData:n.affectsData;if(!o&&!t.range&&!s)throw new P.ZP("writer-updatemarker-wrong-options",this);const a=n.getRange(),l=t.range?t.range:a;o&&t.usingOperation!==n.managedUsingOperations?t.usingOperation?dr(this,i,null,l,r):(dr(this,i,a,null,r),this.model.markers._set(i,l,void 0,r)):n.managedUsingOperations?dr(this,i,a,l,r):this.model.markers._set(i,l,void 0,r)}removeMarker(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new P.ZP("writer-removemarker-no-marker",this);const i=this.model.markers.get(t);if(!i.managedUsingOperations)return void this.model.markers._remove(t);const n=i.getRange();dr(this,t,n,null,i.affectsData)}setSelection(e,t,i){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(e,t,i)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"===typeof e)this._setSelectionAttribute(e,t);else for(const[i,n]of Y(e))this._setSelectionAttribute(i,n)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"===typeof e)this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const n=Yn._getStoreAttributeKey(e);this.setAttribute(n,t,i.anchor.parent)}i._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const i=Yn._getStoreAttributeKey(e);this.removeAttribute(i,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new P.ZP("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const n=i.getRange();let o=!1;if("move"===e)o=t.containsPosition(n.start)||t.start.isEqual(n.start)||t.containsPosition(n.end)||t.end.isEqual(n.end);else{const e=t.nodeBefore,i=t.nodeAfter,s=n.start.parent==e&&n.start.isAtEnd,r=n.end.parent==i&&0==n.end.offset,a=n.end.nodeAfter==i,l=n.start.nodeAfter==i;o=s||r||a||l}o&&this.updateMarker(i.name,{range:n})}}}function lr(e,t,i,n){const o=e.model,s=o.document;let r,a,l,c=n.start;for(const h of n.getWalker({shallow:!0}))l=h.item.getAttribute(t),r&&a!=l&&(a!=i&&d(),c=r),r=h.nextPosition,a=l;function d(){const n=new In(c,r),l=n.root.document?s.version:null,d=new Ys(n,t,a,i,l);e.batch.addOperation(d),o.applyOperation(d)}r instanceof En&&r!=c&&a!=i&&d()}function cr(e,t,i,n){const o=e.model,s=o.document,r=n.getAttribute(t);let a,l;if(r!=i){const c=n.root===n;if(c){const e=n.document?s.version:null;l=new nr(n,t,r,i,e)}else{a=new In(En._createBefore(n),e.createPositionAfter(n));const o=a.root.document?s.version:null;l=new Ys(a,t,r,i,o)}e.batch.addOperation(l),o.applyOperation(l)}}function dr(e,t,i,n,o){const s=e.model,r=s.document,a=new tr(t,i,n,s.markers,o,r.version);e.batch.addOperation(a),s.applyOperation(a)}function hr(e,t,i,n){let o;if(e.root.document){const i=n.document,s=new En(i.graveyard,[0]);o=new Xs(e,t,s,i.version)}else o=new Qs(e,t);i.addOperation(o),n.applyOperation(o)}function ur(e,t){return e===t||e instanceof rr&&t instanceof rr}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mr{constructor(e){this._markerCollection=e,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize);const t=In._createOn(e);for(const i of this._markerCollection.getMarkersIntersectingRange(t)){const e=i.getRange();this.bufferMarkerChange(i.name,e,e,i.affectsData)}this._cachedChanges=null}bufferOperation(e){switch(e.type){case"insert":if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const t of e.range.getItems({shallow:!0}))this._isInInsertedElement(t.parent)||this._markAttribute(t);break;case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const t=this._isInInsertedElement(e.sourcePosition.parent),i=this._isInInsertedElement(e.targetPosition.parent);t||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),i||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const t=In._createFromPositionAndShift(e.position,1);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}break}case"split":{const t=e.splitPosition.parent;this._isInInsertedElement(t)||this._markRemove(t,e.splitPosition.offset,e.howMany),this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1);break}case"merge":{const t=e.sourcePosition.parent;this._isInInsertedElement(t.parent)||this._markRemove(t.parent,t.startOffset,1);const i=e.graveyardPosition.parent;this._markInsert(i,e.graveyardPosition.offset,1);const n=e.targetPosition.parent;this._isInInsertedElement(n)||this._markInsert(n,e.targetPosition.offset,t.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(e,t,i,n){const o=this._changedMarkers.get(e);o?(o.newRange=i,o.affectsData=n,null==o.oldRange&&null==o.newRange&&this._changedMarkers.delete(e)):this._changedMarkers.set(e,{oldRange:t,newRange:i,affectsData:n})}getMarkersToRemove(){const e=[];for(const[t,i]of this._changedMarkers)null!=i.oldRange&&e.push({name:t,range:i.oldRange});return e}getMarkersToAdd(){const e=[];for(const[t,i]of this._changedMarkers)null!=i.newRange&&e.push({name:t,range:i.newRange});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map((e=>({name:e[0],data:{oldRange:e[1].oldRange,newRange:e[1].newRange}})))}hasDataChanges(){for(const[,e]of this._changedMarkers)if(e.affectsData)return!0;return this._changesInElement.size>0}getChanges(e={includeChangesInGraveyard:!1}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const i of this._changesInElement.keys()){const e=this._changesInElement.get(i).sort(((e,t)=>e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1)),n=this._elementSnapshots.get(i),o=gr(i.getChildren()),s=pr(n.length,e);let r=0,a=0;for(const l of s)if("i"===l)t.push(this._getInsertDiff(i,r,o[r].name)),r++;else if("r"===l)t.push(this._getRemoveDiff(i,r,n[a].name)),a++;else if("a"===l){const e=o[r].attributes,s=n[a].attributes;let l;if("$text"==o[r].name)l=new In(En._createAt(i,r),En._createAt(i,r+1));else{const e=i.offsetToIndex(r);l=new In(En._createAt(i,r),En._createAt(i.getChild(e),0))}t.push(...this._getAttributesDiff(l,s,e)),r++,a++}else r++,a++}t.sort(((e,t)=>e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1));for(let i=1,n=0;i<t.length;i++){const e=t[n],o=t[i],s="remove"==e.type&&"remove"==o.type&&"$text"==e.name&&"$text"==o.name&&e.position.isEqual(o.position),r="insert"==e.type&&"insert"==o.type&&"$text"==e.name&&"$text"==o.name&&e.position.parent==o.position.parent&&e.position.offset+e.length==o.position.offset,a="attribute"==e.type&&"attribute"==o.type&&e.position.parent==o.position.parent&&e.range.isFlat&&o.range.isFlat&&e.position.offset+e.length==o.position.offset&&e.attributeKey==o.attributeKey&&e.attributeOldValue==o.attributeOldValue&&e.attributeNewValue==o.attributeNewValue;s||r||a?(e.length++,a&&(e.range.end=e.range.end.getShiftedBy(1)),t[i]=null):n=i}t=t.filter((e=>e));for(const i of t)delete i.changeCount,"attribute"==i.type&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t.slice(),this._cachedChanges=t.filter(fr),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(e,t,i){const n={type:"insert",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,n)}_markRemove(e,t,i){const n={type:"remove",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,n),this._removeAllNestedChanges(e,t,i)}_markAttribute(e){const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const i=this._getChangesForElement(e);this._handleChange(t,i),i.push(t);for(let n=0;n<i.length;n++)i[n].howMany<1&&(i.splice(n,1),n--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,gr(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const i of t){const n=e.offset+e.howMany,o=i.offset+i.howMany;if("insert"==e.type&&("insert"==i.type&&(e.offset<=i.offset?i.offset+=e.howMany:e.offset<o&&(i.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==i.type&&e.offset<i.offset&&(i.offset+=e.howMany),"attribute"==i.type))if(e.offset<=i.offset)i.offset+=e.howMany;else if(e.offset<o){const o=i.howMany;i.howMany=e.offset-i.offset,t.unshift({type:"attribute",offset:n,howMany:o-i.howMany,count:this._changeCount++})}if("remove"==e.type){if("insert"==i.type)if(n<=i.offset)i.offset-=e.howMany;else if(n<=o)if(e.offset<i.offset){const t=n-i.offset;i.offset=e.offset,i.howMany-=t,e.nodesToHandle-=t}else i.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=i.offset)e.nodesToHandle-=i.howMany,i.howMany=0;else if(e.offset<o){const t=o-e.offset;i.howMany-=t,e.nodesToHandle-=t}if("remove"==i.type&&(n<=i.offset?i.offset-=e.howMany:e.offset<i.offset&&(e.nodesToHandle+=i.howMany,i.howMany=0)),"attribute"==i.type)if(n<=i.offset)i.offset-=e.howMany;else if(e.offset<i.offset){const t=n-i.offset;i.offset=e.offset,i.howMany-=t}else if(e.offset<o)if(n<=o){const n=i.howMany;i.howMany=e.offset-i.offset;const o=n-i.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:o,count:this._changeCount++})}else i.howMany-=o-e.offset}if("attribute"==e.type){if("insert"==i.type)if(e.offset<i.offset&&n>i.offset){if(n>o){const e={type:"attribute",offset:o,howMany:n-o,count:this._changeCount++};this._handleChange(e,t),t.push(e)}e.nodesToHandle=i.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=i.offset&&e.offset<o&&(n>o?(e.nodesToHandle=n-o,e.offset=o):e.nodesToHandle=0);if("remove"==i.type&&e.offset<i.offset&&n>i.offset){const o={type:"attribute",offset:i.offset,howMany:n-i.offset,count:this._changeCount++};this._handleChange(o,t),t.push(o),e.nodesToHandle=i.offset-e.offset,e.howMany=e.nodesToHandle}"attribute"==i.type&&(e.offset>=i.offset&&n<=o?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=i.offset&&n>=o&&(i.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,i){return{type:"insert",position:En._createAt(e,t),name:i,length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,t,i){return{type:"remove",position:En._createAt(e,t),name:i,length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,i){const n=[];i=new Map(i);for(const[o,s]of t){const t=i.has(o)?i.get(o):null;t!==s&&n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:s,attributeNewValue:t,changeCount:this._changeCount++}),i.delete(o)}for(const[o,s]of i)n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:o,attributeOldValue:null,attributeNewValue:s,changeCount:this._changeCount++});return n}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const i=this._changesInElement.get(t),n=e.startOffset;if(i)for(const o of i)if("insert"==o.type&&n>=o.offset&&n<o.offset+o.howMany)return!0;return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,i){const n=new In(En._createAt(e,t),En._createAt(e,t+i));for(const o of n.getItems({shallow:!0}))o.is("element")&&(this._elementSnapshots.delete(o),this._changesInElement.delete(o),this._removeAllNestedChanges(o,0,o.maxOffset))}}function gr(e){const t=[];for(const i of e)if(i.is("$text"))for(let e=0;e<i.data.length;e++)t.push({name:"$text",attributes:new Map(i.getAttributes())});else t.push({name:i.name,attributes:new Map(i.getAttributes())});return t}function pr(e,t){const i=[];let n=0,o=0;for(const s of t){if(s.offset>n){for(let e=0;e<s.offset-n;e++)i.push("e");o+=s.offset-n}if("insert"==s.type){for(let e=0;e<s.howMany;e++)i.push("i");n=s.offset+s.howMany}else if("remove"==s.type){for(let e=0;e<s.howMany;e++)i.push("r");n=s.offset,o+=s.howMany}else i.push(..."a".repeat(s.howMany).split("")),n=s.offset+s.howMany,o+=s.howMany}if(o<e)for(let s=0;s<e-o-n;s++)i.push("e");return i}function fr(e){const t=e.position&&"$graveyard"==e.position.root.rootName,i=e.range&&"$graveyard"==e.range.root.rootName;return!t&&!i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wr{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(e){this._operations.includes(e)||this._operations.push(e)}getOperations(e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY){const i=[];for(const n of this._operations)n.baseVersion>=e&&n.baseVersion<t&&i.push(n);return i}getOperation(e){for(const t of this._operations)if(t.baseVersion==e)return t}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function br(e){return!!e&&1==e.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(e)}function vr(e){return!!e&&1==e.length&&/[\ud800-\udbff]/.test(e)}function _r(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e)}function yr(e,t){return vr(e.charAt(t-1))&&_r(e.charAt(t))}function kr(e,t){return br(e.charAt(t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Cr="$graveyard";class xr{constructor(e){this.model=e,this.version=0,this.history=new wr(this),this.selection=new Yn(this),this.roots=new T.Z({idProperty:"rootName"}),this.differ=new mr(e.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",Cr),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];if(i.isDocumentOperation&&i.baseVersion!==this.version)throw new P.ZP("model-document-applyoperation-wrong-version",this,{operation:i})}),{priority:"highest"}),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&this.differ.bufferOperation(i)}),{priority:"high"}),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&(this.version++,this.history.addOperation(i))}),{priority:"low"}),this.listenTo(this.selection,"change",(()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0})),this.listenTo(e.markers,"update",((e,t,i,n)=>{this.differ.bufferMarkerChange(t.name,i,n,t.affectsData),null===i&&t.on("change",((e,i)=>{this.differ.bufferMarkerChange(t.name,i,t.getRange(),t.affectsData)}))}))}get graveyard(){return this.getRoot(Cr)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new P.ZP("model-document-createroot-name-exists",this,{name:t});const i=new rr(this,e,t);return this.roots.add(i),i}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(){return Array.from(this.roots,(e=>e.rootName)).filter((e=>e!=Cr))}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=(0,U.Z)(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const e of this.roots)if(e!==this.graveyard)return e;return this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,i=t.schema,n=t.createPositionFromPath(e,[0]),o=i.getNearestSelectionRange(n);return o||t.createRange(n)}_validateSelectionRange(e){return Vr(e.start)&&Vr(e.end)}_callPostFixers(e){let t=!1;do{for(const i of this._postFixers)if(this.selection.refresh(),t=i(e),t)break}while(t)}}function Vr(e){const t=e.textNode;if(t){const i=t.data,n=e.offset-t.startOffset;return!yr(i,n)&&!kr(i,n)}return!0}(0,I.Z)(xr,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ar{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof Er?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,i=!1,n=!1){const o=e instanceof Er?e.name:e;if(o.includes(","))throw new P.ZP("markercollection-incorrect-marker-name",this);const s=this._markers.get(o);if(s){const e=s.getRange();let r=!1;return e.isEqual(t)||(s._attachLiveRange(qn.fromRange(t)),r=!0),i!=s.managedUsingOperations&&(s._managedUsingOperations=i,r=!0),"boolean"===typeof n&&n!=s.affectsData&&(s._affectsData=n,r=!0),r&&this.fire("update:"+o,s,e,t),s}const r=qn.fromRange(t),a=new Er(o,r,i,n);return this._markers.set(o,a),this.fire("update:"+o,a,null,t),a}_remove(e){const t=e instanceof Er?e.name:e,i=this._markers.get(t);return!!i&&(this._markers.delete(t),this.fire("update:"+t,i,i.getRange(),null),this._destroyMarker(i),!0)}_refresh(e){const t=e instanceof Er?e.name:e,i=this._markers.get(t);if(!i)throw new P.ZP("markercollection-refresh-marker-not-exists",this);const n=i.getRange();this.fire("update:"+t,i,n,n,i.managedUsingOperations,i.affectsData)}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)null!==t.getRange().getIntersection(e)&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}(0,I.Z)(Ar,S.ZP);class Er{constructor(e,t,i,n){this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=i,this._affectsData=n}get managedUsingOperations(){if(!this._liveRange)throw new P.ZP("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new P.ZP("marker-destroyed",this);return this._affectsData}getStart(){if(!this._liveRange)throw new P.ZP("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new P.ZP("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new P.ZP("marker-destroyed",this);return this._liveRange.toRange()}is(e){return"marker"===e||"model:marker"===e}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}(0,I.Z)(Er,S.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tr extends Fs{get type(){return"noop"}clone(){return new Tr(this.baseVersion)}getReversed(){return new Tr(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Pr={};Pr[Ys.className]=Ys,Pr[er.className]=er,Pr[tr.className]=tr,Pr[Xs.className]=Xs,Pr[Tr.className]=Tr,Pr[Fs.className]=Fs,Pr[ir.className]=ir,Pr[nr.className]=nr,Pr[sr.className]=sr,Pr[or.className]=or;class Sr{static fromJSON(e,t){return Pr[e.__className].fromJSON(e,t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ir extends En{constructor(e,t,i="toNone"){if(super(e,t,i),!this.root.is("rootElement"))throw new P.ZP("model-liveposition-root-not-rootelement",e);Nr.call(this)}detach(){this.stopListening()}is(e){return"livePosition"===e||"model:livePosition"===e||"position"==e||"model:position"===e}toPosition(){return new En(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}function Nr(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&Br.call(this,i)}),{priority:"low"})}function Br(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Rr(e,t,i,n){return e.change((o=>{let s;s=i?i instanceof zn||i instanceof Yn?i:o.createSelection(i,n):e.document.selection,s.isCollapsed||e.deleteContent(s,{doNotAutoparagraph:!0});const r=new Dr(e,o,s.anchor);let a;a=t.is("documentFragment")?t.getChildren():[t],r.handleNodes(a);const l=r.getSelectionRange();l&&(s instanceof Yn?o.setSelection(l):s.setTo(l));const c=r.getAffectedRange()||e.createRange(s.anchor);return r.destroy(),c}))}(0,I.Z)(Ir,S.ZP);class Dr{constructor(e,t,i){this.model=e,this.writer=t,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0),this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(e);if(i.isAfter(t)){if(this._lastNode=e,this.position.parent!=e||!this.position.isAtEnd)throw new P.ZP("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this.nodeToSelect?In._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new In(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(this.schema.isObject(e))return void this._handleObject(e);let t=this._checkAndAutoParagraphToAllowedPosition(e);t||(t=this._checkAndSplitToAllowedPosition(e),t)?(this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e):this._handleDisallowedNode(e)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=Ir.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleObject(e){this._checkAndSplitToAllowedPosition(e)?this._appendToFragment(e):this._tryAutoparagraphing(e)}_handleDisallowedNode(e){e.is("element")?this.handleNodes(e.getChildren()):this._tryAutoparagraphing(e)}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new P.ZP("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=e:this.nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=Ir.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Ir.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Cn))return;if(!this._canMergeLeft(e))return;const t=Ir._createBefore(e);t.stickiness="toNext";const i=Ir.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=Ir._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=Ir._createAt(t.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Cn))return;if(!this._canMergeRight(e))return;const t=Ir._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new P.ZP("insertcontent-invalid-insertion-position",this);this.position=En._createAt(t.nodeBefore,"end");const i=Ir.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=Ir._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=Ir._createAt(t.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Cn&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Cn&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_tryAutoparagraphing(e){const t=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,t)&&this.schema.checkChild(t,e)&&(t._appendChild(e),this._handleNode(t))}_checkAndAutoParagraphToAllowedPosition(e){if(this.schema.checkChild(this.position.parent,e))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",e))return!1;this._insertPartialFragment();const t=this.writer.createElement("paragraph");return this.writer.insert(t,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=t,this.position=this.writer.createPositionAt(t,0),!0}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;t!=this.position.parent&&this._insertPartialFragment();while(t!=this.position.parent)if(this.position.isAtStart){const e=this.position.parent;this.position=this.writer.createPositionBefore(e),e.isEmpty&&e.parent===t&&this.writer.remove(e)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const e=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=e,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Mr(e,t,i={}){if(t.isCollapsed)return;const n=t.getFirstRange();if("$graveyard"==n.root.rootName)return;const o=e.schema;e.change((e=>{if(!i.doNotResetEntireContent&&Kr(o,t))return void jr(e,t,o);const[s,r]=Or(n);s.isTouching(r)||e.remove(e.createRange(s,r)),i.leaveUnmerged||(Fr(e,s,r),o.removeDisallowedAttributes(s.parent.getChildren(),e)),Jr(e,t,s),!i.doNotAutoparagraph&&Ur(o,s)&&Gr(e,s,t),s.detach(),r.detach()}))}function Or(e){const t=e.root.document.model,i=e.start;let n=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const i=Lr(n);if(i&&n.isTouching(t.createPositionAt(i,0))){const i=t.createSelection(e);t.modifySelection(i,{direction:"backward"});const o=i.getLastPosition(),s=t.createRange(o,n);t.hasContent(s,{ignoreMarkers:!0})||(n=o)}}return[Ir.fromPosition(i,"toPrevious"),Ir.fromPosition(n,"toNext")]}function Lr(e){const t=e.parent,i=t.root.document.model.schema,n=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const o of n){if(i.isLimit(o))return null;if(i.isBlock(o))return o}}function Fr(e,t,i){const n=e.model;if(!Wr(e.model.schema,t,i))return;const[o,s]=Hr(t,i);o&&s&&(!n.hasContent(o,{ignoreMarkers:!0})&&n.hasContent(s,{ignoreMarkers:!0})?$r(e,t,i,o.parent):zr(e,t,i,o.parent))}function zr(e,t,i,n){const o=t.parent,s=i.parent;if(o!=n&&s!=n){t=e.createPositionAfter(o),i=e.createPositionBefore(s),i.isEqual(t)||e.insert(s,t),e.merge(t);while(i.parent.isEmpty){const t=i.parent;i=e.createPositionBefore(t),e.remove(t)}Wr(e.model.schema,t,i)&&zr(e,t,i,n)}}function $r(e,t,i,n){const o=t.parent,s=i.parent;if(o!=n&&s!=n){t=e.createPositionAfter(o),i=e.createPositionBefore(s),i.isEqual(t)||e.insert(o,i);while(t.parent.isEmpty){const i=t.parent;t=e.createPositionBefore(i),e.remove(i)}i=e.createPositionBefore(s),Zr(e,i),Wr(e.model.schema,t,i)&&$r(e,t,i,n)}}function Zr(e,t){const i=t.nodeBefore,n=t.nodeAfter;i.name!=n.name&&e.rename(i,n.name),e.clearAttributes(i),e.setAttributes(Object.fromEntries(n.getAttributes()),i),e.merge(t)}function Wr(e,t,i){const n=t.parent,o=i.parent;return n!=o&&(!e.isLimit(n)&&!e.isLimit(o)&&qr(t,i,e))}function Hr(e,t){const i=e.getAncestors(),n=t.getAncestors();let o=0;while(i[o]&&i[o]==n[o])o++;return[i[o],n[o]]}function Ur(e,t){const i=e.checkChild(t,"$text"),n=e.checkChild(t,"paragraph");return!i&&n}function qr(e,t,i){const n=new In(e,t);for(const o of n.getWalker())if(i.isLimit(o.item))return!1;return!0}function Gr(e,t,i){const n=e.createElement("paragraph");e.insert(n,t),Jr(e,i,e.createPositionAt(n,0))}function jr(e,t){const i=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(i)),Gr(e,e.createPositionAt(i,0),t)}function Kr(e,t){const i=e.getLimitElement(t);if(!t.containsEntireContent(i))return!1;const n=t.getFirstRange();return n.start.parent!=n.end.parent&&e.checkChild(i,"paragraph")}function Jr(e,t,i){t instanceof Yn?e.setSelection(i):t.setTo(i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yr=' ,.?!:;"-()';function Qr(e,t,i={}){const n=e.schema,o="backward"!=i.direction,s=i.unit?i.unit:"character",r=t.focus,a=new Vn({boundaries:ia(r,o),singleCharacters:!0,direction:o?"forward":"backward"}),l={walker:a,schema:n,isForward:o,unit:s};let c;while(c=a.next()){if(c.done)return;const i=Xr(l,c.value);if(i)return void(t instanceof Yn?e.change((e=>{e.setSelectionFocus(i)})):t.setFocus(i))}}function Xr(e,t){const{isForward:i,walker:n,unit:o,schema:s}=e,{type:r,item:a,nextPosition:l}=t;if("text"==r)return"word"===e.unit?ta(n,i):ea(n,o,i);if(r==(i?"elementStart":"elementEnd")){if(s.isSelectable(a))return En._createAt(a,i?"after":"before");if(s.checkChild(l,"$text"))return l}else{if(s.isLimit(a))return void n.skip((()=>!0));if(s.checkChild(l,"$text"))return l}}function ea(e,t){const i=e.position.textNode;if(i){const n=i.data;let o=e.position.offset-i.startOffset;while(yr(n,o)||"character"==t&&kr(n,o))e.next(),o=e.position.offset-i.startOffset}return e.position}function ta(e,t){let i=e.position.textNode;if(i){let n=e.position.offset-i.startOffset;while(!na(i.data,n,t)&&!oa(i,n,t)){e.next();const o=t?e.position.nodeAfter:e.position.nodeBefore;if(o&&o.is("$text")){const n=o.data.charAt(t?0:o.data.length-1);Yr.includes(n)||(e.next(),i=e.position.textNode)}n=e.position.offset-i.startOffset}}return e.position}function ia(e,t){const i=e.root,n=En._createAt(i,t?"end":0);return t?new In(e,n):new In(n,e)}function na(e,t,i){const n=t+(i?0:-1);return Yr.includes(e.charAt(n))}function oa(e,t,i){return t===(i?e.endOffset:0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function sa(e,t){return e.change((e=>{const i=e.createDocumentFragment(),n=t.getFirstRange();if(!n||n.isCollapsed)return i;const o=n.start.root,s=n.start.getCommonPath(n.end),r=o.getNodeByPath(s);let a;a=n.start.parent==n.end.parent?n:e.createRange(e.createPositionAt(r,n.start.path[s.length]),e.createPositionAt(r,n.end.path[s.length]+1));const l=a.end.offset-a.start.offset;for(const t of a.getItems({shallow:!0}))t.is("$textProxy")?e.appendText(t.data,t.getAttributes(),i):e.append(e.cloneElement(t,!0),i);if(a!=n){const t=n._getTransformedByMove(a.start,e.createPositionAt(i,0),l)[0],o=e.createRange(e.createPositionAt(i,0),t.start),s=e.createRange(t.end,e.createPositionAt(i,"end"));ra(s,e),ra(o,e)}return i}))}function ra(e,t){const i=[];Array.from(e.getItems({direction:"backward"})).map((e=>t.createRangeOn(e))).filter((t=>{const i=(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end));return i})).forEach((e=>{i.push(e.start.parent),t.remove(e)})),i.forEach((e=>{let i=e;while(i.parent&&i.isEmpty){const e=t.createRangeOn(i);i=i.parent,t.remove(e)}}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function aa(e){e.document.registerPostFixer((t=>la(t,e)))}function la(e,t){const i=t.document.selection,n=t.schema,o=[];let s=!1;for(const r of i.getRanges()){const e=ca(r,n);e&&!e.isEqual(r)?(o.push(e),s=!0):o.push(r)}s&&e.setSelection(ga(o),{backward:i.isBackward})}function ca(e,t){return e.isCollapsed?da(e,t):ha(e,t)}function da(e,t){const i=e.start,n=t.getNearestSelectionRange(i);if(!n){const e=i.getAncestors().reverse().find((e=>t.isObject(e)));return e?In._createOn(e):null}if(!n.isCollapsed)return n;const o=n.start;return i.isEqual(o)?null:new In(o)}function ha(e,t){const{start:i,end:n}=e,o=t.checkChild(i,"$text"),s=t.checkChild(n,"$text"),r=t.getLimitElement(i),a=t.getLimitElement(n);if(r===a){if(o&&s)return null;if(ma(i,n,t)){const e=i.nodeAfter&&t.isSelectable(i.nodeAfter),o=e?null:t.getNearestSelectionRange(i,"forward"),s=n.nodeBefore&&t.isSelectable(n.nodeBefore),r=s?null:t.getNearestSelectionRange(n,"backward"),a=o?o.start:i,l=r?r.end:n;return new In(a,l)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const e=i.nodeAfter&&n.nodeBefore&&i.nodeAfter.parent===n.nodeBefore.parent,o=l&&(!e||!pa(i.nodeAfter,t)),s=c&&(!e||!pa(n.nodeBefore,t));let d=i,h=n;return o&&(d=En._createBefore(ua(r,t))),s&&(h=En._createAfter(ua(a,t))),new In(d,h)}return null}function ua(e,t){let i=e,n=i;while(t.isLimit(n)&&n.parent)i=n,n=n.parent;return i}function ma(e,t,i){const n=e.nodeAfter&&!i.isLimit(e.nodeAfter)||i.checkChild(e,"$text"),o=t.nodeBefore&&!i.isLimit(t.nodeBefore)||i.checkChild(t,"$text");return n||o}function ga(e){const t=[...e],i=new Set;let n=1;while(n<t.length){const e=t[n],o=t.slice(0,n);for(const[s,r]of o.entries())if(!i.has(s))if(e.isEqual(r))i.add(s);else if(e.isIntersecting(r)){i.add(s),i.add(n);const o=e.getJoined(r);t.push(o)}n++}const o=t.filter(((e,t)=>!i.has(t)));return o}function pa(e,t){return e&&t.isSelectable(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fa{constructor(){this.markers=new Ar,this.document=new xr(this),this.schema=new ls,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach((e=>this.decorate(e))),this.on("applyOperation",((e,t)=>{const i=t[0];i._validate()}),{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(((e,t)=>{if("$marker"===t.name)return!0})),aa(this),this.document.registerPostFixer(Do)}change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new Ls,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){P.ZP.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{"string"===typeof e?e=new Ls(e):"function"==typeof e&&(t=e,e=new Ls),this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(i){P.ZP.rethrowUnexpectedError(i,this)}}applyOperation(e){e._execute()}insertContent(e,t,i){return Rr(this,e,t,i)}deleteContent(e,t){Mr(this,e,t)}modifySelection(e,t){Qr(this,e,t)}getSelectedContent(e){return sa(this,e)}hasContent(e,t={}){const i=e instanceof Cn?In._createIn(e):e;if(i.isCollapsed)return!1;const{ignoreWhitespaces:n=!1,ignoreMarkers:o=!1}=t;if(!o)for(const s of this.markers.getMarkersIntersectingRange(i))if(s.affectsData)return!0;for(const s of i.getItems())if(this.schema.isContent(s)){if(!s.is("$textProxy"))return!0;if(!n)return!0;if(-1!==s.data.search(/\S/))return!0}return!1}createPositionFromPath(e,t,i){return new En(e,t,i)}createPositionAt(e,t){return En._createAt(e,t)}createPositionAfter(e){return En._createAfter(e)}createPositionBefore(e){return En._createBefore(e)}createRange(e,t){return new In(e,t)}createRangeIn(e){return In._createIn(e)}createRangeOn(e){return In._createOn(e)}createSelection(e,t,i){return new zn(e,t,i)}createBatch(e){return new Ls(e)}createOperationFromJSON(e){return Sr.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");while(this._pendingChanges.length){const t=this._pendingChanges[0].batch;this._currentWriter=new ar(this,t);const i=this._pendingChanges[0].callback(this._currentWriter);e.push(i),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),e}}(0,I.Z)(fa,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wa extends tn{constructor(e){super(),this.editor=e}set(e,t,i={}){if("string"==typeof t){const e=t;t=(t,i)=>{this.editor.execute(e),i()}}super.set(e,t,i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ba{constructor(e={}){const t=e.language||this.constructor.defaultConfig&&this.constructor.defaultConfig.language;this._context=e.context||new $({language:t}),this._context._addEditor(this,!e.context);const i=Array.from(this.constructor.builtinPlugins||[]);this.config=new V(e,this.constructor.defaultConfig),this.config.define("plugins",i),this.config.define(this._context._getEditorConfig()),this.plugins=new N(this,i,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new ss,this.set("state","initializing"),this.once("ready",(()=>this.state="ready"),{priority:"high"}),this.once("destroy",(()=>this.state="destroyed"),{priority:"high"}),this.set("isReadOnly",!1),this.model=new fa;const n=new Ae;this.data=new Bs(this.model,n),this.editing=new os(this.model,n),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Ds([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new wa(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const e=this.config,t=e.get("plugins"),i=e.get("removePlugins")||[],n=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(n),i,o)}destroy(){let e=Promise.resolve();return"initializing"==this.state&&(e=new Promise((e=>this.once("ready",e)))),e.then((()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()})).then((()=>this.plugins.destroy())).then((()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()})).then((()=>this._context._removeEditor(this)))}execute(...e){try{return this.commands.execute(...e)}catch(t){P.ZP.rethrowUnexpectedError(t,this)}}focus(){this.editing.view.focus()}}(0,I.Z)(ba,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class va{constructor(e){this.editor=e,this._components=new Map}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(_a(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new P.ZP("componentfactory-item-missing",this,{name:e});return this._components.get(_a(e)).callback(this.editor.locale)}has(e){return this._components.has(_a(e))}}function _a(e){return String(e).toLowerCase()}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ya{constructor(e){this.editor=e,this.componentFactory=new va(e),this.focusTracker=new en,this.set("viewportOffset",this._readViewportOffsetFromConfig()),this._editableElementsMap=new Map,this.listenTo(e.editing.view.document,"layoutChanged",(()=>this.update()))}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const i=e.config.get("toolbar.viewportTopOffset");return i?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:i}):{top:0}}}(0,I.Z)(ya,Z.Z);var ka=i(73234);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ca(e){if(!(0,ka.Z)(e.updateSourceElement))throw new P.ZP("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(t&&"textarea"===t.tagName.toLowerCase()&&t.form){let i;const n=t.form,o=()=>e.updateSourceElement();(0,ka.Z)(n.submit)&&(i=n.submit,n.submit=()=>{o(),i.apply(n)}),n.addEventListener("submit",o),e.on("destroy",(()=>{n.removeEventListener("submit",o),i&&(n.submit=i)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xa={setData(e){this.data.set(e)},getData(e){return this.data.get(e)}};var Va=xa;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Aa(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ea={updateSourceElement(){if(!this.sourceElement)throw new P.ZP("editor-missing-sourceelement",this);Aa(this.sourceElement,this.data.get())}};var Ta=Ea;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pa extends W{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new T.Z({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if("string"!==typeof e)throw new P.ZP("pendingactions-add-invalid-message",this);const t=Object.create(Z.Z);return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var Sa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',Ia='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',Na='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',Ba='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',Ra='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',Da='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',Ma='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',Oa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',La='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',Fa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',za='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',$a='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',Za='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',Wa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',Ha='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ua='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',qa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',Ga='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',ja='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ka='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ja='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',Ya='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',Qa='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',Xa='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',el='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',tl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',il='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',nl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',ol='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sl={cancel:Sa,caption:Ia,check:Na,cog:Ba,eraser:Ra,lowVision:Da,image:Ma,alignBottom:Oa,alignMiddle:La,alignTop:Fa,alignLeft:za,alignCenter:$a,alignRight:Za,alignJustify:Wa,objectLeft:Ka,objectCenter:Ua,objectRight:Ja,objectFullWidth:Ga,objectInline:ja,objectBlockLeft:Ha,objectBlockRight:qa,objectSizeFull:Ya,objectSizeLarge:Qa,objectSizeSmall:Xa,objectSizeMedium:el,pencil:tl,pilcrow:il,quote:nl,threeVerticalDots:ol};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rl{constructor(){const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=e=>{this.loaded=e.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise(((i,n)=>{t.onload=()=>{const e=t.result;this._data=e,i(e)},t.onerror=()=>{n("error")},t.onabort=()=>{n("aborted")},this._reader.readAsDataURL(e)}))}abort(){this._reader.abort()}}(0,I.Z)(rl,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class al extends a.Z{static get pluginName(){return"FileRepository"}static get requires(){return[Pa]}init(){this.loaders=new T.Z,this.loaders.on("add",(()=>this._updatePendingAction())),this.loaders.on("remove",(()=>this._updatePendingAction())),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0))}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return(0,P.KE)("filerepository-no-upload-adapter"),null;const t=new ll(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then((e=>{this._loadersMap.set(e,t)})).catch((()=>{})),t.on("change:uploaded",(()=>{let e=0;for(const t of this.loaders)e+=t.uploaded;this.uploaded=e})),t.on("change:uploadTotal",(()=>{let e=0;for(const t of this.loaders)t.uploadTotal&&(e+=t.uploadTotal);this.uploadTotal=e})),t}destroyLoader(e){const t=e instanceof ll?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach(((e,i)=>{e===t&&this._loadersMap.delete(i)}))}_updatePendingAction(){const e=this.editor.plugins.get(Pa);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,i=e=>`${t("Upload in progress")} ${parseInt(e)}%.`;this._pendingAction=e.add(i(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",i)}}else e.remove(this._pendingAction),this._pendingAction=null}}(0,I.Z)(al,Z.Z);class ll{constructor(e,t){this.id=(0,on.Z)(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new rl,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0)),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then((e=>this._filePromiseWrapper?e:null)):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new P.ZP("filerepository-read-wrong-status",this);return this.status="reading",this.file.then((e=>this._reader.read(e))).then((e=>{if("reading"!==this.status)throw this.status;return this.status="idle",e})).catch((e=>{if("aborted"===e)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:e}))}upload(){if("idle"!=this.status)throw new P.ZP("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then((()=>this._adapter.upload())).then((e=>(this.uploadResponse=e,this.status="idle",e))).catch((e=>{if("aborted"===this.status)throw"aborted";throw this.status="error",e}))}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==e?this._reader.abort():"uploading"==e&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch((()=>{})),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise(((i,n)=>{t.rejecter=n,t.isFulfilled=!1,e.then((e=>{t.isFulfilled=!0,i(e)})).catch((e=>{t.isFulfilled=!0,n(e)}))})),t}}(0,I.Z)(ll,Z.Z);var cl=i(52612);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dl extends cl.Z{constructor(e){super(e),this.buttonView=new l.Z(e),this._fileInputView=new hl(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",(()=>{this._fileInputView.open()}))}focus(){this.buttonView.focus()}}class hl extends cl.Z{constructor(e){super(e),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to((()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""}))}})}open(){this.element.click()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
i(23767),i(8585),i(68696);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ul="ckCsrfToken",ml=40,gl="abcdefghijklmnopqrstuvwxyz0123456789";function pl(){let e=fl(ul);return e&&e.length==ml||(e=bl(ml),wl(ul,e)),e}function fl(e){e=e.toLowerCase();const t=document.cookie.split(";");for(const i of t){const t=i.split("="),n=decodeURIComponent(t[0].trim().toLowerCase());if(n===e)return decodeURIComponent(t[1])}return null}function wl(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"}function bl(e){let t="";const i=new Uint8Array(e);window.crypto.getRandomValues(i);for(let n=0;n<i.length;n++){const e=gl.charAt(i[n]%gl.length);t+=Math.random()>.5?e.toUpperCase():e}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vl extends a.Z{static get requires(){return[al]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(al).createUploadAdapter=t=>new _l(t,e,this.editor.t))}}class _l{constructor(e,t,i){this.loader=e,this.url=t,this.t=i}upload(){return this.loader.file.then((e=>new Promise(((t,i)=>{this._initRequest(),this._initListeners(t,i,e),this._sendRequest(e)}))))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.url,!0),e.responseType="json"}_initListeners(e,t,i){const n=this.xhr,o=this.loader,s=this.t,r=s("Cannot upload file:")+` ${i.name}.`;n.addEventListener("error",(()=>t(r))),n.addEventListener("abort",(()=>t())),n.addEventListener("load",(()=>{const i=n.response;if(!i||!i.uploaded)return t(i&&i.error&&i.error.message?i.error.message:r);e({default:i.url})})),n.upload&&n.upload.addEventListener("progress",(e=>{e.lengthComputable&&(o.uploadTotal=e.total,o.uploaded=e.loaded)}))}_sendRequest(e){const t=new FormData;t.append("upload",e),t.append("ckCsrfToken",pl()),this.xhr.send(t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const yl=["left","right","center","justify"];function kl(e){return yl.includes(e)}function Cl(e,t){return"rtl"==t.contentLanguageDirection?"right"===e:"left"===e}function xl(e){const t=e.map((e=>{let t;return t="string"==typeof e?{name:e}:e,t})).filter((e=>{const t=!!yl.includes(e.name);return t||(0,P.KE)("alignment-config-name-not-recognized",{option:e}),t})),i=t.filter((e=>!!e.className)).length;if(i&&i<t.length)throw new P.ZP("alignment-config-classnames-are-missing",{configuredOptions:e});return t.forEach(((t,i,n)=>{const o=n.slice(i+1),s=o.some((e=>e.name==t.name));if(s)throw new P.ZP("alignment-config-name-already-defined",{option:t,configuredOptions:e});if(t.className){const i=o.some((e=>e.className==t.className));if(i)throw new P.ZP("alignment-config-classname-already-defined",{option:t,configuredOptions:e})}})),t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Vl="alignment";class Al extends b.Z{refresh(){const e=this.editor,t=e.locale,i=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!i&&this._canBeAligned(i),this.isEnabled&&i.hasAttribute("alignment")?this.value=i.getAttribute("alignment"):this.value="rtl"===t.contentLanguageDirection?"right":"left"}execute(e={}){const t=this.editor,i=t.locale,n=t.model,o=n.document,s=e.value;n.change((e=>{const t=Array.from(o.selection.getSelectedBlocks()).filter((e=>this._canBeAligned(e))),n=t[0].getAttribute("alignment"),r=Cl(s,i)||n===s||!s;r?El(t,e):Tl(t,e,s)}))}_canBeAligned(e){return this.editor.model.schema.checkAttribute(e,Vl)}}function El(e,t){for(const i of e)t.removeAttribute(Vl,i)}function Tl(e,t,i){for(const n of e)t.setAttribute(Vl,i,n)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pl extends a.Z{static get pluginName(){return"AlignmentEditing"}constructor(e){super(e),e.config.define("alignment",{options:[...yl.map((e=>({name:e})))]})}init(){const e=this.editor,t=e.locale,i=e.model.schema,n=xl(e.config.get("alignment.options")),o=n.filter((e=>kl(e.name)&&!Cl(e.name,t))),s=o.some((e=>!!e.className));i.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),s?e.conversion.attributeToAttribute(Bl(o)):e.conversion.for("downcast").attributeToAttribute(Sl(o));const r=Il(o);for(const l of r)e.conversion.for("upcast").attributeToAttribute(l);const a=Nl(o);for(const l of a)e.conversion.for("upcast").attributeToAttribute(l);e.commands.add("alignment",new Al(e))}}function Sl(e){const t={model:{key:"alignment",values:e.map((e=>e.name))},view:{}};for(const{name:i}of e)t.view[i]={key:"style",value:{"text-align":i}};return t}function Il(e){const t=[];for(const{name:i}of e)t.push({view:{key:"style",value:{"text-align":i}},model:{key:"alignment",value:i}});return t}function Nl(e){const t=[];for(const{name:i}of e)t.push({view:{key:"align",value:i},model:{key:"alignment",value:i}});return t}function Bl(e){const t={model:{key:"alignment",values:e.map((e=>e.name))},view:{}};for(const i of e)t.view[i.name]={key:"class",value:i.className};return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Rl({emitter:e,activator:t,callback:i,contextElements:n}){e.listenTo(document,"mousedown",((e,o)=>{if(!t())return;const s="function"==typeof o.composedPath?o.composedPath():[];for(const t of n)if(t.contains(o.target)||s.includes(t))return;i()}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dl(e){e.set("_isCssTransitionsDisabled",!1),e.disableCssTransitions=()=>{e._isCssTransitionsDisabled=!0},e.enableCssTransitions=()=>{e._isCssTransitionsDisabled=!1},e.extendTemplate({attributes:{class:[e.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ml({view:e}){e.listenTo(e.element,"submit",((t,i)=>{i.preventDefault(),e.fire("submit")}),{useCapture:!0})}var Ol=i(4167),Ll=i(70575);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fl extends Ll.Z{constructor(e,t=[]){super(t),this.locale=e}attachToDom(){this._bodyCollectionContainer=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=$i(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&0==e.childElementCount&&e.remove()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zl extends l.Z{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new cl.Z;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $l(e,t){const i=e.t,n={Black:i("Black"),"Dim grey":i("Dim grey"),Grey:i("Grey"),"Light grey":i("Light grey"),White:i("White"),Red:i("Red"),Orange:i("Orange"),Yellow:i("Yellow"),"Light green":i("Light green"),Green:i("Green"),Aquamarine:i("Aquamarine"),Turquoise:i("Turquoise"),"Light blue":i("Light blue"),Blue:i("Blue"),Purple:i("Purple")};return t.map((e=>{const t=n[e.label];return t&&t!=e.label&&(e.label=t),e}))}function Zl(e){return e.map(Wl).filter((e=>!!e))}function Wl(e){return"string"===typeof e?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:void 0!==e.hasBorder&&e.hasBorder,view:{name:"span",styles:{color:`${e.color}`}}}}var Hl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ul extends l.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("color"),this.set("hasBorder"),this.icon=Hl,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color")},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-table__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ql{constructor(e){if(Object.assign(this,e),e.actions&&e.keystrokeHandler)for(const t in e.actions){let i=e.actions[t];"string"==typeof i&&(i=[i]);for(const n of i)e.keystrokeHandler.set(n,((e,i)=>{this[t](),i()}))}}get first(){return this.focusables.find(Gl)||null}get last(){return this.focusables.filter(Gl).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(((t,i)=>{const n=t.element===this.focusTracker.focusedElement;return n&&(e=i),n})),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const t=this.current,i=this.focusables.length;if(!i)return null;if(null===t)return this[1===e?"first":"last"];let n=(t+i+e)%i;do{const t=this.focusables.get(n);if(Gl(t))return t;n=(n+i+e)%i}while(n!==t);return null}}function Gl(e){return!(!e.focus||"none"==ri.window.getComputedStyle(e.element).display)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jl extends cl.Z{constructor(e,t){super(e);const i=t&&t.colorDefinitions||[],n={};t&&t.columns&&(n.gridTemplateColumns=`repeat( ${t.columns}, 1fr)`),this.set("selectedColor"),this.items=this.createCollection(),this.focusTracker=new en,this.keystrokes=new tn,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.items.on("add",((e,t)=>{t.isOn=t.color===this.selectedColor})),i.forEach((e=>{const t=new Ul;t.set({color:e.color,label:e.label,tooltip:!0,hasBorder:e.options.hasBorder}),t.on("execute",(()=>{this.fire("execute",{value:e.color,hasBorder:e.options.hasBorder,label:e.label})})),this.items.add(t)})),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:n}}),this.on("change:selectedColor",((e,t,i)=>{for(const n of this.items)n.isOn=n.color===i}))}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}var Kl='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>',Jl=i(92926);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yl extends l.Z{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Jl.Z;return e.content=Kl,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ql extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("class"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new tn,this.focusTracker=new en,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",t.to("class"),t.if("isVisible","ck-hidden",(e=>!e)),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",((e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())})),this.keystrokes.set("arrowleft",((e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(){const e=new l.Z;return e.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),e.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),e.delegate("execute").to(this),e}_createArrowView(){const e=new l.Z,t=e.bindTemplate;return e.icon=Kl,e.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":t.to("isOn",(e=>String(e)))}}),e.bind("isEnabled").to(this),e.delegate("execute").to(this,"open"),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xl extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",(e=>`ck-dropdown__panel_${e}`)),t.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:t.to((e=>e.preventDefault()))}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const e=this.children.last;"function"===typeof e.focusLast?e.focusLast():e.focus()}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ec(e){return e&&e.parentNode?e.offsetParent===ri.document.body?null:e.offsetParent:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function tc({element:e,target:t,positions:i,limiter:n,fitInViewport:o,viewportOffsetConfig:s}){(0,ka.Z)(t)&&(t=t()),(0,ka.Z)(n)&&(n=n());const r=ec(e),a=new Gi(e),l=new Gi(t);let c;const d={targetRect:l,elementRect:a,positionedElementAncestor:r};if(n||o){const e=n&&new Gi(n).getVisible(),t=o&&ic(s);Object.assign(d,{limiterRect:e,viewportRect:t}),c=nc(i,d)||new rc(i[0],d)}else c=new rc(i[0],d);return c}function ic(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);const t=new Gi(ri.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t}function nc(e,t){const{elementRect:i}=t,n=i.getArea(),o=e.map((e=>new rc(e,t))).filter((e=>!!e.name));let s=0,r=null;for(const a of o){const{_limiterIntersectionArea:e,_viewportIntersectionArea:t}=a;if(e===n)return a;const i=t**2+e**2;i>s&&(s=i,r=a)}return r}function oc(e,t){const i=sc(new Gi(t)),n=Ui(t);let o=0,s=0;o-=i.left,s-=i.top,o+=t.scrollLeft,s+=t.scrollTop,o-=n.left,s-=n.top,e.moveBy(o,s)}function sc(e){const{scrollX:t,scrollY:i}=ri.window;return e.clone().moveBy(t,i)}class rc{constructor(e,t){const i=e(t.targetRect,t.elementRect,t.viewportRect);if(!i)return;const{left:n,top:o,name:s,config:r}=i;Object.assign(this,{name:s,config:r}),this._positioningFunctionCorrdinates={left:n,top:o},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get _limiterIntersectionArea(){const e=this._options.limiterRect;if(e){const t=this._options.viewportRect;if(!t)return e.getIntersectionArea(this._rect);{const i=e.getIntersection(t);if(i)return i.getIntersectionArea(this._rect)}}return 0}get _viewportIntersectionArea(){const e=this._options.viewportRect;return e?e.getIntersectionArea(this._rect):0}get _rect(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCorrdinates.left,this._positioningFunctionCorrdinates.top)),this._cachedRect}get _absoluteRect(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=sc(this._rect),this._options.positionedElementAncestor&&oc(this._cachedAbsoluteRect,this._options.positionedElementAncestor)),this._cachedAbsoluteRect}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ac extends cl.Z{constructor(e,t,i){super(e);const n=this.bindTemplate;this.buttonView=t,this.panelView=i,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new tn,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",n.to("class"),n.if("isEnabled","ck-disabled",(e=>!e))],id:n.to("id"),"aria-describedby":n.to("ariaDescribedById")},children:[t,i]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",(()=>{this.isOpen=!this.isOpen})),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",(()=>{this.isOpen&&("auto"===this.panelPosition?this.panelView.position=ac._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)})),this.keystrokes.listenTo(this.element);const e=(e,t)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,t())};this.keystrokes.set("arrowdown",((e,t)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,t())})),this.keystrokes.set("arrowright",((e,t)=>{this.isOpen&&t()})),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:i,southWest:n,northEast:o,northWest:s,southMiddleEast:r,southMiddleWest:a,northMiddleEast:l,northMiddleWest:c}=ac.defaultPanelPositions;return"rtl"!==this.locale.uiLanguageDirection?[i,n,r,a,e,o,s,l,c,t]:[n,i,a,r,e,s,o,c,l,t]}}ac.defaultPanelPositions={south:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),southMiddleEast:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"}),southMiddleWest:(e,t)=>({top:e.bottom,left:e.left-3*(t.width-e.width)/4,name:"smw"}),north:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),northMiddleEast:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"}),northMiddleWest:(e,t)=>({top:e.top-t.height,left:e.left-3*(t.width-e.width)/4,name:"nmw"})},ac._getOptimalPosition=tc;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function dc(e){return e.bindTemplate.to((t=>{t.target===e.element&&t.preventDefault()}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function hc(e){return Array.isArray(e)?{items:e,removeItems:[]}:e?Object.assign({items:[],removeItems:[]},e):{items:[],removeItems:[]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uc extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate,n=this.t;this.options=t||{},this.set("ariaLabel",n("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new en,this.keystrokes=new tn,this.set("class"),this.set("isCompact",!1),this.itemsView=new mc(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o="rtl"===e.uiLanguageDirection;this._focusCycler=new ql({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const s=["ck","ck-toolbar",i.to("class"),i.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&s.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:s,role:"toolbar","aria-label":i.to("ariaLabel"),style:{maxWidth:i.to("maxWidth")}},children:this.children,on:{mousedown:dc(this)}}),this._behavior=this.options.shouldGroupWhenFull?new pc(this):new gc(this)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t){const i=hc(e),n=i.items.filter(((e,n,o)=>"|"===e||-1===i.removeItems.indexOf(e)&&("-"===e?!this.options.shouldGroupWhenFull||((0,P.KE)("toolbarview-line-break-ignored-when-grouping-items",o),!1):!!t.has(e)||((0,P.KE)("toolbarview-item-unavailable",{name:e}),!1)))),o=this._cleanSeparators(n).map((e=>"|"===e?new lc:"-"===e?new cc:t.create(e)));this.items.addMany(o)}_cleanSeparators(e){const t=e=>"-"!==e&&"|"!==e,i=e.length,n=e.findIndex(t),o=i-e.slice().reverse().findIndex(t);return e.slice(n,o).filter(((e,i,n)=>{if(t(e))return!0;const o=i>0&&n[i-1]===e;return!o}))}}class mc extends cl.Z{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class gc{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using((e=>e)),e.focusables.bindTo(e.items).using((e=>e)),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class pc{constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,e.itemsView.children.bindTo(this.ungroupedItems).using((e=>e)),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),e.children.on("add",this._updateFocusCycleableItems.bind(this)),e.children.on("remove",this._updateFocusCycleableItems.bind(this)),e.items.on("change",((e,t)=>{const i=t.index;for(const n of t.removed)i>=this.ungroupedItems.length?this.groupedItems.remove(n):this.ungroupedItems.remove(n);for(let n=i;n<i+t.added.length;n++){const e=t.added[n-i];n>this.ungroupedItems.length?this.groupedItems.add(e,n-this.ungroupedItems.length):this.ungroupedItems.add(e,n)}this._updateGrouping()})),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);const e=this.groupedItems.length;let t;while(this._areItemsOverflowing)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){while(this.groupedItems.length&&!this._areItemsOverflowing)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,i=new Gi(e.lastChild),n=new Gi(e);if(!this.cachedPadding){const i=ri.window.getComputedStyle(e),n="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(i[n])}return"ltr"===t?i.right>n.right-this.cachedPadding:i.left<n.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new Yi(this.viewElement,(t=>{e&&e===t.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)})),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",(()=>{this._updateGrouping()}))}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new lc),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,i=vc(e);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",_c(i,[]),i.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:"rtl"===e.uiLanguageDirection?"se":"sw",icon:ol}),i.toolbarView.items.bindTo(this.groupedItems).using((e=>e)),i}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map((e=>{this.viewFocusables.add(e)})),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fc extends cl.Z{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new en,this.keystrokes=new tn,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wc extends cl.Z{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function vc(e,t=Yl){const i=new t(e),n=new Xl(e),o=new ac(e,i,n);return i.bind("isEnabled").to(o),i instanceof Yl?i.bind("isOn").to(o,"isOpen"):i.arrowView.bind("isOn").to(o,"isOpen"),kc(o),o}function _c(e,t){const i=e.locale,n=i.t,o=e.toolbarView=new uc(i);o.set("ariaLabel",n("Dropdown toolbar")),e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),t.map((e=>o.items.add(e))),e.panelView.children.add(o),o.items.delegate("execute").to(e)}function yc(e,t){const i=e.locale,n=e.listView=new fc(i);n.items.bindTo(t).using((({type:e,model:t})=>{if("separator"===e)return new bc(i);if("button"===e||"switchbutton"===e){const n=new wc(i);let o;return o="button"===e?new l.Z(i):new zl(i),o.bind(...Object.keys(t)).to(t),o.delegate("execute").to(n),n.children.add(o),n}})),e.panelView.children.add(n),n.items.delegate("execute").to(e)}function kc(e){Cc(e),xc(e),Vc(e)}function Cc(e){e.on("render",(()=>{Rl({emitter:e,activator:()=>e.isOpen,callback:()=>{e.isOpen=!1},contextElements:[e.element]})}))}function xc(e){e.on("execute",(t=>{t.source instanceof zl||(e.isOpen=!1)}))}function Vc(e){e.keystrokes.set("arrowdown",((t,i)=>{e.isOpen&&(e.panelView.focus(),i())})),e.keystrokes.set("arrowup",((t,i)=>{e.isOpen&&(e.panelView.focusLast(),i())}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ac extends cl.Z{constructor(e){super(e),this.body=new Fl(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ec extends cl.Z{constructor(e){super(e),this.set("text"),this.set("for"),this.id=`ck-editor__label_${(0,on.Z)()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tc extends Ac{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new Ec;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pc extends cl.Z{constructor(e,t,i){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=i,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",(()=>this._updateIsFocusedClasses())),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const e=this._editingView;function t(t){e.change((i=>{const n=e.document.getRoot(t.name);i.addClass(t.isFocused?"ck-focused":"ck-blurred",n),i.removeClass(t.isFocused?"ck-blurred":"ck-focused",n)}))}function i(n){e.once("change:isRenderingInProgress",((e,o,s)=>{s?i(n):t(n)}))}e.isRenderingInProgress?i(this):t(this)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sc extends Pc{constructor(e,t,i){super(e,t,i),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView,t=this.t;e.change((i=>{const n=e.document.getRoot(this.name);i.setAttribute("aria-label",t("Rich Text Editor, %0",this.name),n)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ic extends cl.Z{constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",i.to("class")]},children:this.children});const n=new cl.Z(e);n.setTemplate({tag:"span",attributes:{class:["ck","ck-form__header__label"]},children:[{text:i.to("label")}]}),this.children.add(n)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nc extends cl.Z{constructor(e){super(e),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new en,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById")},on:{input:t.to(((...e)=>{this.fire("input",...e),this._updateIsEmpty()})),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",((e,t,i)=>{this._setDomElementValue(i),this._updateIsEmpty()}))}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=Bc(this.element)}_setDomElementValue(e){this.element.value=e||0===e?e:""}}function Bc(e){return!e.value}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rc extends cl.Z{constructor(e,t){super(e);const i=`ck-labeled-field-view-${(0,on.Z)()}`,n=`ck-labeled-field-view-status-${(0,on.Z)()}`;this.fieldView=t(this,i,n),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(i),this.statusView=this._createStatusView(n),this.bind("_statusText").to(this,"errorText",this,"infoText",((e,t)=>e||t));const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",(e=>!e)),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(e){const t=new Ec(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new cl.Z(this.locale),i=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",i.if("errorText","ck-labeled-field-view__status_error"),i.if("_statusText","ck-hidden",(e=>!e))],id:e,role:i.if("errorText","alert")},children:[{text:i.to("_statusText")}]}),t}focus(){this.fieldView.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dc(e,t,i){const n=new Nc(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isReadOnly").to(e,"isEnabled",(e=>!e)),n.bind("hasError").to(e,"errorText",(e=>!!e)),n.on("input",(()=>{e.errorText=null})),e.bind("isEmpty","isFocused","placeholder").to(n),n}function Mc(e,t,i){const n=vc(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isEnabled").to(e),n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Oc extends W{static get pluginName(){return"Notification"}init(){this.on("show:warning",((e,t)=>{window.alert(t.message)}),{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t=`show:${e.type}`+(e.namespace?`:${e.namespace}`:"");this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lc{constructor(e,t){t&&(0,Vi.Z)(this,t),e&&this.set(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Fc(e){return t=>t+e}(0,I.Z)(Lc,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
const zc=Fc("px"),$c=ri.document.body;class Zc extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",(e=>`ck-balloon-panel_${e}`)),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",zc),left:t.to("left",zc)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=Zc.defaultPositions,i=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthMiddleWest,t.southArrowNorthMiddleEast,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthMiddleWest,t.northArrowSouthMiddleEast,t.northArrowSouthWest,t.northArrowSouthEast,t.viewportStickyNorth],limiter:$c,fitInViewport:!0},e),n=Zc._getOptimalPosition(i),o=parseInt(n.left),s=parseInt(n.top),{name:r,config:a={}}=n,{withArrow:l=!0}=a;Object.assign(this,{top:s,left:o,position:r,withArrow:l})}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=Wc(e.target),i=e.limiter?Wc(e.limiter):$c;this.listenTo(ri.document,"scroll",((n,o)=>{const s=o.target,r=t&&s.contains(t),a=i&&s.contains(i);!r&&!a&&t&&i||this.attachTo(e)}),{useCapture:!0}),this.listenTo(ri.window,"resize",(()=>{this.attachTo(e)}))}_stopPinning(){this.stopListening(ri.document,"scroll"),this.stopListening(ri.window,"resize")}}function Wc(e){return x(e)?e:Wi(e)?e.commonAncestorContainer:"function"==typeof e?Wc(e()):null}function Hc({horizontalOffset:e=Zc.arrowHorizontalOffset,verticalOffset:t=Zc.arrowVerticalOffset,stickyVerticalOffset:i=Zc.stickyVerticalOffset,config:n}={}){return{northWestArrowSouthWest:(t,i)=>({top:o(t,i),left:t.left-e,name:"arrow_sw",...n&&{config:n}}),northWestArrowSouthMiddleWest:(t,i)=>({top:o(t,i),left:t.left-.25*i.width-e,name:"arrow_smw",...n&&{config:n}}),northWestArrowSouth:(e,t)=>({top:o(e,t),left:e.left-t.width/2,name:"arrow_s",...n&&{config:n}}),northWestArrowSouthMiddleEast:(t,i)=>({top:o(t,i),left:t.left-.75*i.width+e,name:"arrow_sme",...n&&{config:n}}),northWestArrowSouthEast:(t,i)=>({top:o(t,i),left:t.left-i.width+e,name:"arrow_se",...n&&{config:n}}),northArrowSouthWest:(t,i)=>({top:o(t,i),left:t.left+t.width/2-e,name:"arrow_sw",...n&&{config:n}}),northArrowSouthMiddleWest:(t,i)=>({top:o(t,i),left:t.left+t.width/2-.25*i.width-e,name:"arrow_smw",...n&&{config:n}}),northArrowSouth:(e,t)=>({top:o(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s",...n&&{config:n}}),northArrowSouthMiddleEast:(t,i)=>({top:o(t,i),left:t.left+t.width/2-.75*i.width+e,name:"arrow_sme",...n&&{config:n}}),northArrowSouthEast:(t,i)=>({top:o(t,i),left:t.left+t.width/2-i.width+e,name:"arrow_se",...n&&{config:n}}),northEastArrowSouthWest:(t,i)=>({top:o(t,i),left:t.right-e,name:"arrow_sw",...n&&{config:n}}),northEastArrowSouthMiddleWest:(t,i)=>({top:o(t,i),left:t.right-.25*i.width-e,name:"arrow_smw",...n&&{config:n}}),northEastArrowSouth:(e,t)=>({top:o(e,t),left:e.right-t.width/2,name:"arrow_s",...n&&{config:n}}),northEastArrowSouthMiddleEast:(t,i)=>({top:o(t,i),left:t.right-.75*i.width+e,name:"arrow_sme",...n&&{config:n}}),northEastArrowSouthEast:(t,i)=>({top:o(t,i),left:t.right-i.width+e,name:"arrow_se",...n&&{config:n}}),southWestArrowNorthWest:(t,i)=>({top:s(t,i),left:t.left-e,name:"arrow_nw",...n&&{config:n}}),southWestArrowNorthMiddleWest:(t,i)=>({top:s(t,i),left:t.left-.25*i.width-e,name:"arrow_nmw",...n&&{config:n}}),southWestArrowNorth:(e,t)=>({top:s(e,t),left:e.left-t.width/2,name:"arrow_n",...n&&{config:n}}),southWestArrowNorthMiddleEast:(t,i)=>({top:s(t,i),left:t.left-.75*i.width+e,name:"arrow_nme",...n&&{config:n}}),southWestArrowNorthEast:(t,i)=>({top:s(t,i),left:t.left-i.width+e,name:"arrow_ne",...n&&{config:n}}),southArrowNorthWest:(t,i)=>({top:s(t,i),left:t.left+t.width/2-e,name:"arrow_nw",...n&&{config:n}}),southArrowNorthMiddleWest:(t,i)=>({top:s(t,i),left:t.left+t.width/2-.25*i.width-e,name:"arrow_nmw",...n&&{config:n}}),southArrowNorth:(e,t)=>({top:s(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_n",...n&&{config:n}}),southArrowNorthMiddleEast:(t,i)=>({top:s(t,i),left:t.left+t.width/2-.75*i.width+e,name:"arrow_nme",...n&&{config:n}}),southArrowNorthEast:(t,i)=>({top:s(t,i),left:t.left+t.width/2-i.width+e,name:"arrow_ne",...n&&{config:n}}),southEastArrowNorthWest:(t,i)=>({top:s(t,i),left:t.right-e,name:"arrow_nw",...n&&{config:n}}),southEastArrowNorthMiddleWest:(t,i)=>({top:s(t,i),left:t.right-.25*i.width-e,name:"arrow_nmw",...n&&{config:n}}),southEastArrowNorth:(e,t)=>({top:s(e,t),left:e.right-t.width/2,name:"arrow_n",...n&&{config:n}}),southEastArrowNorthMiddleEast:(t,i)=>({top:s(t,i),left:t.right-.75*i.width+e,name:"arrow_nme",...n&&{config:n}}),southEastArrowNorthEast:(t,i)=>({top:s(t,i),left:t.right-i.width+e,name:"arrow_ne",...n&&{config:n}}),viewportStickyNorth:(e,t,o)=>e.getIntersection(o)?{top:o.top+i,left:e.left+e.width/2-t.width/2,name:"arrowless",config:{withArrow:!1,...n}}:null};function o(e,i){return e.top-i.height-t}function s(e){return e.bottom+t}}Zc.arrowHorizontalOffset=25,Zc.arrowVerticalOffset=10,Zc.stickyVerticalOffset=20,Zc._getOptimalPosition=tc,Zc.defaultPositions=Hc();var Uc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',qc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Gc=Fc("px");class jc extends a.Z{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this.positionLimiter=()=>{const e=this.editor.editing.view,t=e.document,i=t.selection.editableElement;return i?e.domConverter.mapViewToDom(i.root):null},this.set("visibleView",null),this.view=new Zc(e.locale),e.ui.view.body.add(this.view),e.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}destroy(){super.destroy(),this.view.destroy(),this._rotatorView.destroy(),this._fakePanelsView.destroy()}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this.hasView(e.view))throw new P.ZP("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t))return this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!e.singleViewMode||this.showStack(t));const i=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),i.set(e.view,e),this._viewToStack.set(e.view,i),i===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new P.ZP("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(1===t.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),1===t.size?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new P.ZP("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){const t=Array.from(this._idToStack.entries()).find((t=>t[1]===e));return t[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new Kc(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>!t&&e>1)),e.on("change:isNavigationVisible",(()=>this.updatePosition()),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",((e,i)=>{if(i<2)return"";const n=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[n,i])})),e.buttonNextView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()})),e.buttonPrevView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()})),e}_createFakePanelsView(){const e=new Jc(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>{const i=!t&&e>=2;return i?Math.min(e-1,2):0})),e.listenTo(this.view,"change:top",(()=>e.updatePosition())),e.listenTo(this.view,"change:left",(()=>e.updatePosition())),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:i=!0,singleViewMode:n=!1}){this.view.class=t,this.view.withArrow=i,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),n&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class Kc extends cl.Z{constructor(e){super(e);const t=e.t,i=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new en,this.buttonPrevView=this._createButtonView(t("Previous"),Uc),this.buttonNextView=this._createButtonView(t("Next"),qc),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",i.to("isNavigationVisible",(e=>e?"":"ck-hidden"))]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:i.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const i=new l.Z(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i}}class Jc extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",i.to("numberOfPanels",(e=>e?"":"ck-hidden"))],style:{top:i.to("top",Gc),left:i.to("left",Gc),width:i.to("width",Gc),height:i.to("height",Gc)}},children:this.content}),this.on("change:numberOfPanels",((e,t,i,n)=>{i>n?this._addPanels(i-n):this._removePanels(n-i),this.updatePosition()}))}_addPanels(e){while(e--){const e=new cl.Z;e.setTemplate({tag:"div"}),this.content.add(e),this.registerChild(e)}}_removePanels(e){while(e--){const e=this.content.last;this.content.remove(e),this.deregisterChild(e),e.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:i,height:n}=new Gi(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:i,height:n})}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yc=Fc("px");class Qc extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",(e=>e?"block":"none")),height:t.to("isSticky",(e=>e?Yc(this._panelRect.height):null))}}}).render(),this._contentPanel=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",(e=>e?Yc(this._contentPanelPlaceholder.getBoundingClientRect().width):null)),top:t.to("_hasViewportTopOffset",(e=>e?Yc(this.viewportTopOffset):null)),bottom:t.to("_isStickyToTheLimiter",(e=>e?Yc(this.limiterBottomOffset):null)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(ri.window,"scroll",(()=>{this._checkIfShouldBeSticky()})),this.listenTo(this,"change:isActive",(()=>{this._checkIfShouldBeSticky()}))}_checkIfShouldBeSticky(){const e=this._panelRect=this._contentPanel.getBoundingClientRect();let t;this.limiterElement?(t=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&t.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<t.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=t.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:Yc(-ri.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}var Xc=i(71174);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ed({origin:e,originKeystrokeHandler:t,originFocusTracker:i,toolbar:n,beforeFocus:o,afterBlur:s}){i.add(n.element),t.set("Alt+F10",((e,t)=>{i.isFocused&&!n.focusTracker.isFocused&&(o&&o(),n.focus(),t())})),n.keystrokes.set("Esc",((t,i)=>{n.focusTracker.isFocused&&(e.focus(),s&&s(),i())}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
Fc("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
Fc("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
Fc("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const td=new Map([["left",sl.alignLeft],["right",sl.alignRight],["center",sl.alignCenter],["justify",sl.alignJustify]]);class id extends a.Z{get localizedOptionTitles(){const e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const e=this.editor,t=e.ui.componentFactory,i=e.t,n=xl(e.config.get("alignment.options"));n.map((e=>e.name)).filter(kl).forEach((e=>this._addButton(e))),t.add("alignment",(e=>{const o=vc(e),s=n.map((e=>t.create(`alignment:${e.name}`)));_c(o,s),o.buttonView.set({label:i("Text alignment"),tooltip:!0}),o.toolbarView.isVertical=!0,o.toolbarView.ariaLabel=i("Text alignment toolbar"),o.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const r="rtl"===e.contentLanguageDirection?td.get("right"):td.get("left");return o.buttonView.bind("icon").toMany(s,"isOn",((...e)=>{const t=e.findIndex((e=>e));return t<0?r:s[t].icon})),o.bind("isEnabled").toMany(s,"isEnabled",((...e)=>e.some((e=>e)))),o}))}_addButton(e){const t=this.editor;t.ui.componentFactory.add(`alignment:${e}`,(i=>{const n=t.commands.get("alignment"),o=new l.Z(i);return o.set({label:this.localizedOptionTitles[e],icon:td.get(e),tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(n),o.bind("isOn").to(n,"value",(t=>t===e)),this.listenTo(o,"execute",(()=>{t.execute("alignment",{value:e}),t.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nd extends a.Z{static get requires(){return[Pl,id]}static get pluginName(){return"Alignment"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class od{constructor(e,t=20){this.model=e,this.size=0,this.limit=t,this.isLocked=!1,this._changeCallback=(e,t)=>{"transparent"!=t.type&&t!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(e){this.size+=e,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e){this.isLocked&&!e||(this._batch=null,this.size=0)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sd extends b.Z{constructor(e,t){super(e),this._buffer=new od(e.model,t),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,i=t.document,n=e.text||"",o=n.length,s=e.range?t.createSelection(e.range):i.selection,r=e.resultRange;t.enqueueChange(this._buffer.batch,(e=>{this._buffer.lock(),this._batches.add(this._buffer.batch),t.deleteContent(s),n&&t.insertContent(e.createText(n,i.selection.getAttributes()),s),r?e.setSelection(r):s.is("documentSelection")||e.setSelection(s),this._buffer.unlock(),this._buffer.input(o)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function rd(e,t){const i=[];let n,o=0;return e.forEach((e=>{"equal"==e?(s(),o++):"insert"==e?(r("insert")?n.values.push(t[o]):(s(),n={type:"insert",index:o,values:[t[o]]}),o++):r("delete")?n.howMany++:(s(),n={type:"delete",index:o,howMany:1})})),s(),i;function s(){n&&(i.push(n),n=null)}function r(e){return n&&n.type==e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ad(e){if(0==e.length)return!1;for(const t of e)if("children"===t.type&&!ld(t))return!0;return!1}function ld(e){if(e.newChildren.length-e.oldChildren.length!=1)return;const t=Gt(e.oldChildren,e.newChildren,cd),i=rd(t,e.newChildren);if(i.length>1)return;const n=i[0];return n.values[0]&&n.values[0].is("$text")?n:void 0}function cd(e,t){return e&&e.is("$text")&&t&&t.is("$text")?e.data===t.data:e===t}function dd(e,t){const i=t.selection,n=e.shiftKey&&e.keyCode===ct.Do["delete"],o=!i.isCollapsed;return n&&o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function hd(e){let t=null;const i=e.model,n=e.editing.view,o=e.commands.get("input");function s(e){if(Yt.ZP.isWindows&&dd(e,n.document))return;const s=i.document,r=n.document.isComposing,l=t&&t.isEqual(s.selection);t=null,o.isEnabled&&(md(e)||s.selection.isCollapsed||r&&229===e.keyCode||!r&&229===e.keyCode&&l||a())}function r(){const e=i.document,t=1!==e.selection.rangeCount||e.selection.getFirstRange().isFlat;e.selection.isCollapsed||t||a()}function a(){const e=o.buffer;e.lock();const t=e.batch;o._batches.add(t),i.enqueueChange(t,(()=>{i.deleteContent(i.document.selection)})),e.unlock()}Yt.ZP.isAndroid?n.document.on("beforeinput",((e,t)=>s(t)),{priority:"lowest"}):n.document.on("keydown",((e,t)=>s(t)),{priority:"lowest"}),n.document.on("compositionstart",r,{priority:"lowest"}),n.document.on("compositionend",(()=>{t=i.createSelection(i.document.selection)}),{priority:"lowest"})}const ud=[(0,ct.Cq)("arrowUp"),(0,ct.Cq)("arrowRight"),(0,ct.Cq)("arrowDown"),(0,ct.Cq)("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let sE=112;sE<=135;sE++)ud.push(sE);function md(e){return!(!e.ctrlKey&&!e.metaKey)||ud.includes(e.keyCode)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function gd(e){e.editing.view.document.on("mutations",((t,i,n)=>{new pd(e).handle(i,n)}))}class pd{constructor(e){this.editor=e,this.editing=this.editor.editing}handle(e,t){if(ad(e))this._handleContainerChildrenMutations(e,t);else for(const i of e)this._handleTextMutation(i,t),this._handleTextNodeInsertion(i)}_handleContainerChildrenMutations(e,t){const i=fd(e);if(!i)return;const n=this.editor.editing.view.domConverter,o=n.mapViewToDom(i),s=new gi(this.editor.editing.view.document),r=this.editor.data.toModel(s.domToView(o)).getChild(0),a=this.editor.editing.mapper.toModelElement(i);if(!a)return;const l=Array.from(r.getChildren()),c=Array.from(a.getChildren()),d=l[l.length-1],h=c[c.length-1],u=d&&d.is("element","softBreak"),m=h&&!h.is("element","softBreak");u&&m&&l.pop();const g=this.editor.model.schema;if(!wd(l,g)||!wd(c,g))return;const p=l.map((e=>e.is("$text")?e.data:"@")).join("").replace(/\u00A0/g," "),f=c.map((e=>e.is("$text")?e.data:"@")).join("").replace(/\u00A0/g," ");if(f===p)return;const w=Gt(f,p),{firstChangeAt:b,insertions:v,deletions:_}=bd(w);let y=null;t&&(y=this.editing.mapper.toModelRange(t.getFirstRange()));const k=p.substr(b,v),C=this.editor.model.createRange(this.editor.model.createPositionAt(a,b),this.editor.model.createPositionAt(a,b+_));this.editor.execute("input",{text:k,range:C,resultRange:y})}_handleTextMutation(e,t){if("text"!=e.type)return;const i=e.newText.replace(/\u00A0/g," "),n=e.oldText.replace(/\u00A0/g," ");if(n===i)return;const o=Gt(n,i),{firstChangeAt:s,insertions:r,deletions:a}=bd(o);let l=null;t&&(l=this.editing.mapper.toModelRange(t.getFirstRange()));const c=this.editing.view.createPositionAt(e.node,s),d=this.editing.mapper.toModelPosition(c),h=this.editor.model.createRange(d,d.getShiftedBy(a)),u=i.substr(s,r);this.editor.execute("input",{text:u,range:h,resultRange:l})}_handleTextNodeInsertion(e){if("children"!=e.type)return;const t=ld(e),i=this.editing.view.createPositionAt(e.node,t.index),n=this.editing.mapper.toModelPosition(i),o=t.values[0].data;this.editor.execute("input",{text:o.replace(/\u00A0/g," "),range:this.editor.model.createRange(n)})}}function fd(e){const t=e.map((e=>e.node)).reduce(((e,t)=>e.getCommonAncestor(t,{includeSelf:!0})));if(t)return t.getAncestors({includeSelf:!0,parentFirst:!0}).find((e=>e.is("containerElement")||e.is("rootElement")))}function wd(e,t){return e.every((e=>t.isInline(e)))}function bd(e){let t=null,i=null;for(let s=0;s<e.length;s++){const n=e[s];"equal"!=n&&(t=null===t?s:t,i=s)}let n=0,o=0;for(let s=t;s<=i;s++)"insert"!=e[s]&&n++,"delete"!=e[s]&&o++;return{insertions:o,deletions:n,firstChangeAt:t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vd extends a.Z{static get pluginName(){return"Input"}init(){const e=this.editor,t=new sd(e,e.config.get("typing.undoStep")||20);e.commands.add("input",t),hd(e),gd(e)}isInput(e){const t=this.editor.commands.get("input");return t._batches.has(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _d extends b.Z{constructor(e,t){super(e),this.direction=t,this._buffer=new od(e.model,e.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,i=t.document;t.enqueueChange(this._buffer.batch,(n=>{this._buffer.lock();const o=n.createSelection(e.selection||i.selection),s=e.sequence||1,r=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit}),this._shouldEntireContentBeReplacedWithParagraph(s))return void this._replaceEntireContentWithParagraph(n);if(this._shouldReplaceFirstBlockWithParagraph(o,s))return void this.editor.execute("paragraph",{selection:o});if(o.isCollapsed)return;let a=0;o.getFirstRange().getMinimalFlatRanges().forEach((e=>{a+=We(e.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))})),t.deleteContent(o,{doNotResetEntireContent:r,direction:this.direction}),this._buffer.input(a),n.setSelection(o),this._buffer.unlock()}))}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,i=t.document,n=i.selection,o=t.schema.getLimitElement(n),s=n.isCollapsed&&n.containsEntireContent(o);if(!s)return!1;if(!t.schema.checkChild(o,"paragraph"))return!1;const r=o.getChild(0);return!r||"paragraph"!==r.name}_replaceEntireContentWithParagraph(e){const t=this.editor.model,i=t.document,n=i.selection,o=t.schema.getLimitElement(n),s=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(s,o),e.setSelection(s,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const i=this.editor.model;if(t>1||"backward"!=this.direction)return!1;if(!e.isCollapsed)return!1;const n=e.getFirstPosition(),o=i.schema.getLimitElement(n),s=o.getChild(0);return n.parent==s&&(!!e.containsEntireContent(s)&&(!!i.schema.checkChild(o,"paragraph")&&"paragraph"!=s.name))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yd extends _i{constructor(e){super(e);const t=e.document;let i=0;function n(e,i,n){const o=new Ge(t,"delete",t.selection.getFirstRange());t.fire(o,new Ai(t,i,n)),o.stop.called&&e.stop()}t.on("keyup",((e,t)=>{t.keyCode!=ct.Do["delete"]&&t.keyCode!=ct.Do.backspace||(i=0)})),t.on("keydown",((e,o)=>{if(Yt.ZP.isWindows&&dd(o,t))return;const s={};if(o.keyCode==ct.Do["delete"])s.direction="forward",s.unit="character";else{if(o.keyCode!=ct.Do.backspace)return;s.direction="backward",s.unit="codePoint"}const r=Yt.ZP.isMac?o.altKey:o.ctrlKey;s.unit=r?"word":s.unit,s.sequence=++i,n(e,o.domEvent,s)})),Yt.ZP.isAndroid&&t.on("beforeinput",((t,i)=>{if("deleteContentBackward"!=i.domEvent.inputType)return;const o={unit:"codepoint",direction:"backward",sequence:1},s=i.domTarget.ownerDocument.defaultView.getSelection();s.anchorNode==s.focusNode&&s.anchorOffset+1!=s.focusOffset&&(o.selectionToRemove=e.domConverter.domSelectionToView(s)),n(t,i.domEvent,o)}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kd extends a.Z{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,i=t.document,n=e.model.document;t.addObserver(yd),this._undoOnBackspace=!1;const o=new _d(e,"forward");if(e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new _d(e,"backward")),this.listenTo(i,"delete",((i,n)=>{const o={unit:n.unit,sequence:n.sequence};if(n.selectionToRemove){const t=e.model.createSelection(),i=[];for(const o of n.selectionToRemove.getRanges())i.push(e.editing.mapper.toModelRange(o));t.setTo(i),o.selection=t}e.execute("forward"==n.direction?"deleteForward":"delete",o),n.preventDefault(),t.scrollToTheSelection()}),{priority:"low"}),Yt.ZP.isAndroid){let e=null;this.listenTo(i,"delete",((t,i)=>{const n=i.domTarget.ownerDocument.defaultView.getSelection();e={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}),{priority:"lowest"}),this.listenTo(i,"keyup",((t,i)=>{if(e){const t=i.domTarget.ownerDocument.defaultView.getSelection();t.collapse(e.anchorNode,e.anchorOffset),t.extend(e.focusNode,e.focusOffset),e=null}}))}this.editor.plugins.has("UndoEditing")&&(this.listenTo(i,"delete",((t,i)=>{this._undoOnBackspace&&"backward"==i.direction&&1==i.sequence&&"codePoint"==i.unit&&(this._undoOnBackspace=!1,e.execute("undo"),i.preventDefault(),t.stop())}),{context:"$capture"}),this.listenTo(n,"change",(()=>{this._undoOnBackspace=!1})))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cd extends a.Z{static get requires(){return[vd,kd]}static get pluginName(){return"Typing"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function xd(e,t){let i=e.start;const n=Array.from(e.getItems()).reduce(((e,n)=>n.is("$text")||n.is("$textProxy")?e+n.data:(i=t.createPositionAfter(n),"")),"");return{text:n,range:t.createRange(i,e.end)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vd{constructor(e,t){this.model=e,this.testCallback=t,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",(()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))})),this._startListening()}_startListening(){const e=this.model,t=e.document;this.listenTo(t.selection,"change:range",((e,{directChange:i})=>{i&&(t.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))})),this.listenTo(t,"change:data",((e,t)=>{"transparent"!=t.type&&this._evaluateTextBeforeSelection("data",{batch:t})}))}_evaluateTextBeforeSelection(e,t={}){const i=this.model,n=i.document,o=n.selection,s=i.createRange(i.createPositionAt(o.focus.parent,0),o.focus),{text:r,range:a}=xd(s,i),l=this.testCallback(r);if(!l&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!l,l){const i=Object.assign(t,{text:r,range:a});"object"==typeof l&&Object.assign(i,l),this.fire(`matched:${e}`,i)}}}(0,I.Z)(Vd,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ad extends a.Z{static get pluginName(){return"TwoStepCaretMovement"}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,i=e.editing.view,n=e.locale,o=t.document.selection;this.listenTo(i.document,"arrowKey",((e,t)=>{if(!o.isCollapsed)return;if(t.shiftKey||t.altKey||t.ctrlKey)return;const i=t.keyCode==ct.Do.arrowright,s=t.keyCode==ct.Do.arrowleft;if(!i&&!s)return;const r=n.contentLanguageDirection;let a=!1;a="ltr"===r&&i||"rtl"===r&&s?this._handleForwardMovement(t):this._handleBackwardMovement(t),!0===a&&e.stop()}),{context:"$text",priority:"highest"}),this._isNextGravityRestorationSkipped=!1,this.listenTo(o,"change:range",((e,t)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!t.directChange&&Id(o.getFirstPosition(),this.attributes)||this._restoreGravity())}))}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,i=this.editor.model,n=i.document.selection,o=n.getFirstPosition();return!this._isGravityOverridden&&((!o.isAtStart||!Ed(n,t))&&(Id(o,t)?(Pd(e),this._overrideGravity(),!0):void 0))}_handleBackwardMovement(e){const t=this.attributes,i=this.editor.model,n=i.document.selection,o=n.getFirstPosition();return this._isGravityOverridden?(Pd(e),this._restoreGravity(),Td(i,t,o),!0):o.isAtStart?!!Ed(n,t)&&(Pd(e),Td(i,t,o),!0):Sd(o,t)?o.isAtEnd&&!Ed(n,t)&&Id(o,t)?(Pd(e),Td(i,t,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):void 0}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change((e=>e.overrideSelectionGravity()))}_restoreGravity(){this.editor.model.change((e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null}))}}function Ed(e,t){for(const i of t)if(e.hasAttribute(i))return!0;return!1}function Td(e,t,i){const n=i.nodeBefore;e.change((e=>{n?e.setSelectionAttribute(n.getAttributes()):e.removeSelectionAttribute(t)}))}function Pd(e){e.preventDefault()}function Sd(e,t){const i=e.getShiftedBy(-1);return Id(i,t)}function Id(e,t){const{nodeBefore:i,nodeAfter:n}=e;for(const o of t){const e=i?i.getAttribute(o):void 0,t=n?n.getAttribute(o):void 0;if(t!==e)return!0}return!1}var Nd=i(50751),Bd=/[\\^$.*+?()[\]{}|]/g,Rd=RegExp(Bd.source);function Dd(e){return e=(0,Nd.Z)(e),e&&Rd.test(e)?e.replace(Bd,"\\$&"):e}var Md=Dd;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Od={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:Hd('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:Hd("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:Hd("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:Hd('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:Hd('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:Hd("'"),to:[null,"‚",null,"’"]}},Ld={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},Fd=["symbols","mathematical","typography","quotes"];class zd extends a.Z{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(e){super(e),e.config.define("typing",{transformations:{include:Fd}})}init(){const e=this.editor.model,t=e.document.selection;t.on("change:range",(()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")})),this._enableTransformationWatchers()}_enableTransformationWatchers(){const e=this.editor,t=e.model,i=e.plugins.get("Input"),n=e.plugins.get("Delete"),o=Ud(e.config.get("typing.transformations")),s=e=>{for(const t of o){const i=t.from,n=i.test(e);if(n)return{normalizedTransformation:t}}},r=(e,o)=>{if(!i.isInput(o.batch))return;const{from:s,to:r}=o.normalizedTransformation,a=s.exec(o.text),l=r(a.slice(1)),c=o.range;let d=a.index;t.enqueueChange((e=>{for(let i=1;i<a.length;i++){const n=a[i],o=l[i-1];if(null==o){d+=n.length;continue}const s=c.start.getShiftedBy(d),r=t.createRange(s,s.getShiftedBy(n.length)),h=Wd(s);t.insertContent(e.createText(o,h),r),d+=o.length}t.enqueueChange((()=>{n.requestUndoOnBackspace()}))}))},a=new Vd(e.model,s);a.on("matched:data",r),a.bind("isEnabled").to(this)}}function $d(e){return"string"==typeof e?new RegExp(`(${Md(e)})$`):e}function Zd(e){return"string"==typeof e?()=>[e]:e instanceof Array?()=>e:e}function Wd(e){const t=e.textNode?e.textNode:e.nodeAfter;return t.getAttributes()}function Hd(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}function Ud(e){const t=e.extra||[],i=e.remove||[],n=e=>!i.includes(e),o=e.include.concat(t).filter(n);return qd(o).filter(n).map((e=>Od[e]||e)).map((e=>({from:$d(e.from),to:Zd(e.to)})))}function qd(e){const t=new Set;for(const i of e)if(Ld[i])for(const e of Ld[i])t.add(e);else t.add(i);return Array.from(t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gd(e,t,i,n){return n.createRange(jd(e,t,i,!0,n),jd(e,t,i,!1,n))}function jd(e,t,i,n,o){let s=e.textNode||(n?e.nodeBefore:e.nodeAfter),r=null;while(s&&s.getAttribute(t)==i)r=s,s=n?s.previousSibling:s.nextSibling;return r?o.createPositionAt(r,n?"before":"after"):e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Kd(e,t,i,n){const o=e.editing.view,s=new Set;o.document.registerPostFixer((o=>{const r=e.model.document.selection;let a=!1;if(r.hasAttribute(t)){const l=Gd(r.getFirstPosition(),t,r.getAttribute(t),e.model),c=e.editing.mapper.toViewRange(l);for(const e of c.getItems())e.is("element",i)&&!e.hasClass(n)&&(o.addClass(n,e),s.add(e),a=!0)}return a})),e.conversion.for("editingDowncast").add((e=>{function t(){o.change((e=>{for(const t of s.values())e.removeClass(n,t),s.delete(t)}))}e.on("insert",t,{priority:"highest"}),e.on("remove",t,{priority:"highest"}),e.on("attribute",t,{priority:"highest"}),e.on("selection",t,{priority:"highest"})}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Jd=new WeakMap;function Yd(e){const{view:t,element:i,text:n,isDirectHost:o=!0,keepOnFocus:s=!1}=e,r=t.document;Jd.has(r)||(Jd.set(r,new Map),r.registerPostFixer((e=>th(r,e)))),Jd.get(r).set(i,{text:n,isDirectHost:o,keepOnFocus:s,hostElement:o?i:null}),t.change((e=>th(r,e)))}function Qd(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0)}function Xd(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0)}function eh(e,t){if(!e.isAttached())return!1;const i=Array.from(e.getChildren()).some((e=>!e.is("uiElement")));if(i)return!1;if(t)return!0;const n=e.document;if(!n.isFocused)return!0;const o=n.selection,s=o.anchor;return s&&s.parent!==e}function th(e,t){const i=Jd.get(e),n=[];let o=!1;for(const[s,r]of i)r.isDirectHost&&(n.push(s),ih(t,s,r)&&(o=!0));for(const[s,r]of i){if(r.isDirectHost)continue;const e=nh(s);e&&(n.includes(e)||(r.hostElement=e,ih(t,s,r)&&(o=!0)))}return o}function ih(e,t,i){const{text:n,isDirectHost:o,hostElement:s}=i;let r=!1;s.getAttribute("data-placeholder")!==n&&(e.setAttribute("data-placeholder",n,s),r=!0);const a=o||1==t.childCount;return a&&eh(s,i.keepOnFocus)?Qd(e,s)&&(r=!0):Xd(e,s)&&(r=!0),r}function nh(e){if(e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement"))return t}return null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const oh=new Map;function sh(e,t,i){let n=oh.get(e);n||(n=new Map,oh.set(e,n)),n.set(t,i)}function rh(e,t){const i=oh.get(e);return i&&i.has(t)?i.get(t):ah}function ah(e){return[e]}function lh(e,t,i={}){const n=rh(e.constructor,t.constructor);try{return e=e.clone(),n(e,t,i)}catch(o){throw o}}function ch(e,t,i){e=e.slice(),t=t.slice();const n=new dh(i.document,i.useRelations,i.forceWeakRemove);n.setOriginalOperations(e),n.setOriginalOperations(t);const o=n.originalOperations;if(0==e.length||0==t.length)return{operationsA:e,operationsB:t,originalOperations:o};const s=new WeakMap;for(const l of e)s.set(l,0);const r={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let a=0;while(a<e.length){const i=e[a],o=s.get(i);if(o==t.length){a++;continue}const r=t[o],l=lh(i,r,n.getContext(i,r,!0)),c=lh(r,i,n.getContext(r,i,!1));n.updateRelation(i,r),n.setOriginalOperations(l,i),n.setOriginalOperations(c,r);for(const e of l)s.set(e,o+c.length);e.splice(a,1,...l),t.splice(o,1,...c)}if(i.padWithNoOps){const i=e.length-r.originalOperationsACount,n=t.length-r.originalOperationsBCount;uh(e,n-i),uh(t,i-n)}return hh(e,r.nextBaseVersionB),hh(t,r.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:o}}class dh{constructor(e,t,i=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(e,t=null){const i=t?this.originalOperations.get(t):null;for(const n of e)this.originalOperations.set(n,i||n)}updateRelation(e,t){switch(e.constructor){case Xs:switch(t.constructor){case or:e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter");break;case Xs:e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter");break}break;case sr:switch(t.constructor){case or:e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");break;case Xs:if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const i=In._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.splitPosition)){const n=i.end.offset-e.splitPosition.offset,o=e.splitPosition.offset-i.start.offset;this._setRelation(e,t,{howMany:n,offset:o})}}}break;case or:switch(t.constructor){case or:e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement");break;case sr:e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource")}break;case tr:{const i=e.newRange;if(!i)return;switch(t.constructor){case Xs:{const n=In._createFromPositionAndShift(t.sourcePosition,t.howMany),o=n.containsPosition(i.start)||n.start.isEqual(i.start),s=n.containsPosition(i.end)||n.end.isEqual(i.end);!o&&!s||n.containsRange(i)||this._setRelation(e,t,{side:o?"left":"right",path:o?i.start.path.slice():i.end.path.slice()});break}case or:{const n=i.start.isEqual(t.targetPosition),o=i.start.isEqual(t.deletionPosition),s=i.end.isEqual(t.deletionPosition),r=i.end.isEqual(t.sourcePosition);(n||o||s||r)&&this._setRelation(e,t,{wasInLeftElement:n,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:s,wasInRightElement:r});break}}break}}}getContext(e,t,i){return{aIsStrong:i,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const i=this.originalOperations.get(t),n=this._history.getUndoneOperation(i);if(!n)return null;const o=this.originalOperations.get(e),s=this._relations.get(o);return s&&s.get(n)||null}_setRelation(e,t,i){const n=this.originalOperations.get(e),o=this.originalOperations.get(t);let s=this._relations.get(n);s||(s=new Map,this._relations.set(n,s)),s.set(o,i)}}function hh(e,t){for(const i of e)i.baseVersion=t++}function uh(e,t){for(let i=0;i<t;i++)e.push(new Tr(0))}function mh(e,t,i){const n=e.nodes,o=n.getNode(0).getAttribute(t);if(o==i)return null;const s=new In(e.position,e.position.getShiftedBy(e.howMany));return new Ys(s,t,o,i,0)}function gh(e,t){const i=In._createFromPositionAndShift(t.sourcePosition,t.howMany);let n=null,o=[];i.containsRange(e,!0)?n=e:e.start.hasSameParentAs(i.start)?(o=e.getDifference(i),n=e.getIntersection(i)):o=[e];const s=[];for(let r of o){r=r._getTransformedByDeletion(t.sourcePosition,t.howMany);const e=t.getMovedRangeStart(),i=r.start.hasSameParentAs(e);r=r._getTransformedByInsertion(e,t.howMany,i),s.push(...r)}return n&&s.push(n._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),s}function ph(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)}function fh(e,t){const i=[];for(let n=0;n<e.length;n++){const o=e[n],s=new Xs(o.start,o.end.offset-o.start.offset,t,0);i.push(s);for(let t=n+1;t<e.length;t++)e[t]=e[t]._getTransformedByMove(s.sourcePosition,s.targetPosition,s.howMany)[0];t=t._getTransformedByMove(s.sourcePosition,s.targetPosition,s.howMany)}return i}sh(Ys,Ys,((e,t,i)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const n=e.range.getDifference(t.range).map((t=>new Ys(t,e.key,e.oldValue,e.newValue,0))),o=e.range.getIntersection(t.range);return o&&i.aIsStrong&&n.push(new Ys(o,t.key,t.newValue,e.newValue,0)),0==n.length?[new Tr(0)]:n}return[e]})),sh(Ys,er,((e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const i=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes),n=i.map((t=>new Ys(t,e.key,e.oldValue,e.newValue,e.baseVersion)));if(t.shouldReceiveAttributes){const i=mh(t,e.key,e.oldValue);i&&n.unshift(i)}return n}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]})),sh(Ys,or,((e,t)=>{const i=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&i.push(In._createFromPositionAndShift(t.graveyardPosition,1));const n=e.range._getTransformedByMergeOperation(t);return n.isCollapsed||i.push(n),i.map((t=>new Ys(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),sh(Ys,Xs,((e,t)=>{const i=gh(e.range,t);return i.map((t=>new Ys(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),sh(Ys,sr,((e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const i=e.clone();return i.range=new In(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,i]}return e.range=e.range._getTransformedBySplitOperation(t),[e]})),sh(er,Ys,((e,t)=>{const i=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const n=mh(e,t.key,t.newValue);n&&i.push(n)}return i})),sh(er,er,((e,t,i)=>(e.position.isEqual(t.position)&&i.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e]))),sh(er,Xs,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),sh(er,sr,((e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e]))),sh(er,or,((e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e]))),sh(tr,er,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e]))),sh(tr,tr,((e,t,i)=>{if(e.name==t.name){if(!i.aIsStrong)return[new Tr(0)];e.oldRange=t.newRange?t.newRange.clone():null}return[e]})),sh(tr,or,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e]))),sh(tr,Xs,((e,t,i)=>{if(e.oldRange&&(e.oldRange=In._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){if(i.abRelation){const n=In._createFromRanges(e.newRange._getTransformedByMoveOperation(t));if("left"==i.abRelation.side&&t.targetPosition.isEqual(e.newRange.start))return e.newRange.start.path=i.abRelation.path,e.newRange.end=n.end,[e];if("right"==i.abRelation.side&&t.targetPosition.isEqual(e.newRange.end))return e.newRange.start=n.start,e.newRange.end.path=i.abRelation.path,[e]}e.newRange=In._createFromRanges(e.newRange._getTransformedByMoveOperation(t))}return[e]})),sh(tr,sr,((e,t,i)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(i.abRelation){const n=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?e.newRange.start=En._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!i.abRelation.wasInLeftElement&&(e.newRange.start=En._createAt(t.moveTargetPosition)),e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasInRightElement?e.newRange.end=En._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?e.newRange.end=En._createAt(t.insertionPosition):e.newRange.end=n.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]})),sh(or,er,((e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e]))),sh(or,or,((e,t,i)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(i.bWasUndone){const i=t.graveyardPosition.path.slice();return i.push(0),e.sourcePosition=new En(t.graveyardPosition.root,i),e.howMany=0,[e]}return[new Tr(0)]}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!i.bWasUndone&&"splitAtSource"!=i.abRelation){const n="$graveyard"==e.targetPosition.root.rootName,o="$graveyard"==t.targetPosition.root.rootName,s=n&&!o,r=o&&!n,a=r||!s&&i.aIsStrong;if(a){const i=t.targetPosition._getTransformedByMergeOperation(t),n=e.targetPosition._getTransformedByMergeOperation(t);return[new Xs(i,e.howMany,n,0)]}return[new Tr(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&i.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),sh(or,Xs,((e,t,i)=>{const n=In._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!i.bWasUndone&&!i.forceWeakRemove&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.sourcePosition)?[new Tr(0)]:(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])})),sh(or,sr,((e,t,i)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){const n=0!=t.howMany,o=t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition);if(n||o||"mergeTargetNotMoved"==i.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e]}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==i.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==i.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]})),sh(Xs,er,((e,t)=>{const i=In._createFromPositionAndShift(e.sourcePosition,e.howMany),n=i._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=n.start,e.howMany=n.end.offset-n.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]})),sh(Xs,Xs,((e,t,i)=>{const n=In._createFromPositionAndShift(e.sourcePosition,e.howMany),o=In._createFromPositionAndShift(t.sourcePosition,t.howMany);let s,r=i.aIsStrong,a=!i.aIsStrong;if("insertBefore"==i.abRelation||"insertAfter"==i.baRelation?a=!0:"insertAfter"!=i.abRelation&&"insertBefore"!=i.baRelation||(a=!1),s=e.targetPosition.isEqual(t.targetPosition)&&a?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),ph(e,t)&&ph(t,e))return[t.getReversed()];const l=n.containsPosition(t.targetPosition);if(l&&n.containsRange(o,!0))return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),fh([n],s);const c=o.containsPosition(e.targetPosition);if(c&&o.containsRange(n,!0))return n.start=n.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),n.end=n.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),fh([n],s);const d=H(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==d||"extension"==d)return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),fh([n],s);"remove"!=e.type||"remove"==t.type||i.aWasUndone||i.forceWeakRemove?"remove"==e.type||"remove"!=t.type||i.bWasUndone||i.forceWeakRemove||(r=!1):r=!0;const h=[],u=n.getDifference(o);for(const g of u){g.start=g.start._getTransformedByDeletion(t.sourcePosition,t.howMany),g.end=g.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const e="same"==H(g.start.getParentPath(),t.getMovedRangeStart().getParentPath()),i=g._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,e);h.push(...i)}const m=n.getIntersection(o);return null!==m&&r&&(m.start=m.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.end=m.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===h.length?h.push(m):1==h.length?o.start.isBefore(n.start)||o.start.isEqual(n.start)?h.unshift(m):h.push(m):h.splice(1,0,m)),0===h.length?[new Tr(e.baseVersion)]:fh(h,s)})),sh(Xs,sr,((e,t,i)=>{let n=e.targetPosition.clone();e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=i.abRelation||(n=e.targetPosition._getTransformedBySplitOperation(t));const o=In._createFromPositionAndShift(e.sourcePosition,e.howMany);if(o.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=n,[e];if(o.start.hasSameParentAs(t.splitPosition)&&o.containsPosition(t.splitPosition)){let e=new In(t.splitPosition,o.end);e=e._getTransformedBySplitOperation(t);const i=[new In(o.start,t.splitPosition),e];return fh(i,n)}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==i.abRelation&&(n=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==i.abRelation&&(n=e.targetPosition);const s=o._getTransformedBySplitOperation(t),r=[s];if(t.graveyardPosition){const n=o.start.isEqual(t.graveyardPosition)||o.containsPosition(t.graveyardPosition);e.howMany>1&&n&&!i.aWasUndone&&r.push(In._createFromPositionAndShift(t.insertionPosition,1))}return fh(r,n)})),sh(Xs,or,((e,t,i)=>{const n=In._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.sourcePosition))if("remove"!=e.type||i.forceWeakRemove){if(1==e.howMany)return i.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new Tr(0)]}else if(!i.aWasUndone){const i=[];let n=t.graveyardPosition.clone(),o=t.targetPosition._getTransformedByMergeOperation(t);e.howMany>1&&(i.push(new Xs(e.sourcePosition,e.howMany-1,e.targetPosition,0)),n=n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1),o=o._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1));const s=t.deletionPosition._getCombined(e.sourcePosition,e.targetPosition),r=new Xs(n,1,s,0),a=r.getMovedRangeStart().path.slice();a.push(0);const l=new En(r.targetPosition.root,a);o=o._getTransformedByMove(n,s,1);const c=new Xs(o,t.howMany,l,0);return i.push(r),i.push(c),i}const o=In._createFromPositionAndShift(e.sourcePosition,e.howMany),s=o._getTransformedByMergeOperation(t);return e.sourcePosition=s.start,e.howMany=s.end.offset-s.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]})),sh(ir,er,((e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e]))),sh(ir,or,((e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e]))),sh(ir,Xs,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),sh(ir,ir,((e,t,i)=>{if(e.position.isEqual(t.position)){if(!i.aIsStrong)return[new Tr(0)];e.oldName=t.newName}return[e]})),sh(ir,sr,((e,t)=>{const i=e.position.path,n=t.splitPosition.getParentPath();if("same"==H(i,n)&&!t.graveyardPosition){const t=new ir(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,t]}return e.position=e.position._getTransformedBySplitOperation(t),[e]})),sh(nr,nr,((e,t,i)=>{if(e.root===t.root&&e.key===t.key){if(!i.aIsStrong||e.newValue===t.newValue)return[new Tr(0)];e.oldValue=t.newValue}return[e]})),sh(sr,er,((e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e]))),sh(sr,or,((e,t,i)=>{if(!e.graveyardPosition&&!i.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const i=t.graveyardPosition.path.slice();i.push(0);const n=new En(t.graveyardPosition.root,i),o=sr.getInsertionPosition(new En(t.graveyardPosition.root,i)),s=new sr(n,0,o,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),e.graveyardPosition=s.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[s,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),sh(sr,Xs,((e,t,i)=>{const n=In._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const o=n.start.isEqual(e.graveyardPosition)||n.containsPosition(e.graveyardPosition);if(!i.bWasUndone&&o){const i=e.splitPosition._getTransformedByMoveOperation(t),n=e.graveyardPosition._getTransformedByMoveOperation(t),o=n.path.slice();o.push(0);const s=new En(n.root,o),r=new Xs(i,e.howMany,s,0);return[r]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}const o=e.splitPosition.isEqual(t.targetPosition);if(o&&("insertAtSource"==i.baRelation||"splitBefore"==i.abRelation))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e];if(o&&i.abRelation&&i.abRelation.howMany){const{howMany:t,offset:n}=i.abRelation;return e.howMany+=t,e.splitPosition=e.splitPosition.getShiftedBy(n),[e]}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){const i=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=i,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e]}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e]})),sh(sr,sr,((e,t,i)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new Tr(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new Tr(0)];if("splitBefore"==i.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const n="$graveyard"==e.splitPosition.root.rootName,o="$graveyard"==t.splitPosition.root.rootName,s=n&&!o,r=o&&!n,a=r||!s&&i.aIsStrong;if(a){const i=[];return t.howMany&&i.push(new Xs(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&i.push(new Xs(e.splitPosition,e.howMany,e.moveTargetPosition,0)),i}return[new Tr(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==i.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==i.baRelation){const i=t.insertionPosition.path.slice();i.push(0);const n=new En(t.insertionPosition.root,i),o=new Xs(e.insertionPosition,1,n,0);return[e,o]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e]}));
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wh extends Ei{constructor(e){super(e),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bh extends Ei{constructor(e){super(e),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vh{constructor(e){this.document=e}createDocumentFragment(e){return new ft(this.document,e)}createElement(e,t,i){return new Se(this.document,e,t,i)}createText(e){return new G(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,i){return i._insertChild(e,t)}removeChildren(e,t,i){return i._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const i=e.parent;if(i){const n=i.getChildIndex(e);return this.removeChildren(n,1,i),this.insertChild(n,t,i),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const i=t.getChildIndex(e);this.remove(e),this.insertChild(i,e.getChildren(),t)}}rename(e,t){const i=new Se(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,i)?i:null}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){(0,_.Z)(e)&&void 0===i&&(i=t),i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return ze._createAt(e,t)}createPositionAfter(e){return ze._createAfter(e)}createPositionBefore(e){return ze._createBefore(e)}createRange(e,t){return new $e(e,t)}createRangeOn(e){return $e._createOn(e)}createRangeIn(e){return $e._createIn(e)}createSelection(e,t,i){return new He(e,t,i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const _h=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,yh=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,kh=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Ch=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,xh=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Vh=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function Ah(e){return e.startsWith("#")?_h.test(e):e.startsWith("rgb")?yh.test(e)||kh.test(e):e.startsWith("hsl")?Ch.test(e)||xh.test(e):Vh.has(e.toLowerCase())}const Eh=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function Th(e){return Eh.includes(e)}const Ph=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Sh(e){return Ph.test(e)}const Ih=/^[+-]?[0-9]*([.][0-9]+)?%$/;function Nh(e){return Ih.test(e)}const Bh=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function Rh(e){return Bh.includes(e)}const Dh=["center","top","bottom","left","right"];function Mh(e){return Dh.includes(e)}const Oh=["fixed","scroll","local"];function Lh(e){return Oh.includes(e)}const Fh=/^url\(/;function zh(e){return Fh.test(e)}function $h(e=""){if(""===e)return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=Uh(e),i=t[0],n=t[2]||i,o=t[1]||i,s=t[3]||o;return{top:i,bottom:n,right:o,left:s}}function Zh(e){return t=>{const{top:i,right:n,bottom:o,left:s}=t,r=[];return[i,n,s,o].every((e=>!!e))?r.push([e,Wh(t)]):(i&&r.push([e+"-top",i]),n&&r.push([e+"-right",n]),o&&r.push([e+"-bottom",o]),s&&r.push([e+"-left",s])),r}}function Wh({top:e,right:t,bottom:i,left:n}){const o=[];return n!==t?o.push(e,t,i,n):i!==e?o.push(e,t,i):t!==e?o.push(e,t):o.push(e),o.join(" ")}function Hh(e){return t=>({path:e,value:$h(t)})}function Uh(e){return e.replace(/, /g,",").split(" ").map((e=>e.replace(/,/g,", ")))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function qh(e){e.setNormalizer("background",Gh),e.setNormalizer("background-color",(e=>({path:"background.color",value:e}))),e.setReducer("background",(e=>{const t=[];return t.push(["background-color",e.color]),t})),e.setStyleRelation("background",["background-color"])}function Gh(e){const t={},i=Uh(e);for(const n of i)Rh(n)?(t.repeat=t.repeat||[],t.repeat.push(n)):Mh(n)?(t.position=t.position||[],t.position.push(n)):Lh(n)?t.attachment=n:Ah(n)?t.color=n:zh(n)&&(t.image=n);return{path:"background",value:t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jh(e){e.setNormalizer("border",Kh),e.setNormalizer("border-top",Jh("top")),e.setNormalizer("border-right",Jh("right")),e.setNormalizer("border-bottom",Jh("bottom")),e.setNormalizer("border-left",Jh("left")),e.setNormalizer("border-color",Yh("color")),e.setNormalizer("border-width",Yh("width")),e.setNormalizer("border-style",Yh("style")),e.setNormalizer("border-top-color",Xh("color","top")),e.setNormalizer("border-top-style",Xh("style","top")),e.setNormalizer("border-top-width",Xh("width","top")),e.setNormalizer("border-right-color",Xh("color","right")),e.setNormalizer("border-right-style",Xh("style","right")),e.setNormalizer("border-right-width",Xh("width","right")),e.setNormalizer("border-bottom-color",Xh("color","bottom")),e.setNormalizer("border-bottom-style",Xh("style","bottom")),e.setNormalizer("border-bottom-width",Xh("width","bottom")),e.setNormalizer("border-left-color",Xh("color","left")),e.setNormalizer("border-left-style",Xh("style","left")),e.setNormalizer("border-left-width",Xh("width","left")),e.setExtractor("border-top",eu("top")),e.setExtractor("border-right",eu("right")),e.setExtractor("border-bottom",eu("bottom")),e.setExtractor("border-left",eu("left")),e.setExtractor("border-top-color","border.color.top"),e.setExtractor("border-right-color","border.color.right"),e.setExtractor("border-bottom-color","border.color.bottom"),e.setExtractor("border-left-color","border.color.left"),e.setExtractor("border-top-width","border.width.top"),e.setExtractor("border-right-width","border.width.right"),e.setExtractor("border-bottom-width","border.width.bottom"),e.setExtractor("border-left-width","border.width.left"),e.setExtractor("border-top-style","border.style.top"),e.setExtractor("border-right-style","border.style.right"),e.setExtractor("border-bottom-style","border.style.bottom"),e.setExtractor("border-left-style","border.style.left"),e.setReducer("border-color",Zh("border-color")),e.setReducer("border-style",Zh("border-style")),e.setReducer("border-width",Zh("border-width")),e.setReducer("border-top",ou("top")),e.setReducer("border-right",ou("right")),e.setReducer("border-bottom",ou("bottom")),e.setReducer("border-left",ou("left")),e.setReducer("border",nu()),e.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),e.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),e.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),e.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),e.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),e.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function Kh(e){const{color:t,style:i,width:n}=iu(e);return{path:"border",value:{color:$h(t),style:$h(i),width:$h(n)}}}function Jh(e){return t=>{const{color:i,style:n,width:o}=iu(t),s={};return void 0!==i&&(s.color={[e]:i}),void 0!==n&&(s.style={[e]:n}),void 0!==o&&(s.width={[e]:o}),{path:"border",value:s}}}function Yh(e){return t=>({path:"border",value:Qh(t,e)})}function Qh(e,t){return{[t]:$h(e)}}function Xh(e,t){return i=>({path:"border",value:{[e]:{[t]:i}}})}function eu(e){return(t,i)=>{if(i.border)return tu(i.border,e)}}function tu(e,t){const i={};return e.width&&e.width[t]&&(i.width=e.width[t]),e.style&&e.style[t]&&(i.style=e.style[t]),e.color&&e.color[t]&&(i.color=e.color[t]),i}function iu(e){const t={},i=Uh(e);for(const n of i)Sh(n)||/thin|medium|thick/.test(n)?t.width=n:Th(n)?t.style=n:t.color=n;return t}function nu(){return t=>{const i=tu(t,"top"),n=tu(t,"right"),o=tu(t,"bottom"),s=tu(t,"left"),r=[i,n,o,s],a={width:e(r,"width"),style:e(r,"style"),color:e(r,"color")},l=su(a,"all");if(l.length)return l;const c=Object.entries(a).reduce(((e,[t,i])=>(i&&(e.push([`border-${t}`,i]),r.forEach((e=>e[t]=null))),e)),[]);return[...c,...su(i,"top"),...su(n,"right"),...su(o,"bottom"),...su(s,"left")]};function e(e,t){return e.map((e=>e[t])).reduce(((e,t)=>e==t?e:null))}}function ou(e){return t=>su(t,e)}function su(e,t){const i=[];if(e&&e.width&&i.push("width"),e&&e.style&&i.push("style"),e&&e.color&&i.push("color"),3==i.length){const n=i.map((t=>e[t])).join(" ");return["all"==t?["border",n]:[`border-${t}`,n]]}return"all"==t?[]:i.map((i=>[`border-${t}-${i}`,e[i]]))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ru(e){e.setNormalizer("padding",Hh("padding")),e.setNormalizer("padding-top",(e=>({path:"padding.top",value:e}))),e.setNormalizer("padding-right",(e=>({path:"padding.right",value:e}))),e.setNormalizer("padding-bottom",(e=>({path:"padding.bottom",value:e}))),e.setNormalizer("padding-left",(e=>({path:"padding.left",value:e}))),e.setReducer("padding",Zh("padding")),e.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function au(e,t,i,n){let o,s=null;"function"==typeof n?o=n:(s=e.commands.get(n),o=()=>{e.execute(n)}),e.model.document.on("change:data",((r,a)=>{if(s&&!s.isEnabled||!t.isEnabled)return;const l=(0,Xi.Z)(e.model.document.selection.getRanges());if(!l.isCollapsed)return;if("transparent"==a.type)return;const c=Array.from(e.model.document.differ.getChanges()),d=c[0];if(1!=c.length||"insert"!==d.type||"$text"!=d.name||1!=d.length)return;const h=d.position.parent;if(h.is("element","codeBlock"))return;if(h.is("element","listItem")&&"function"!==typeof n&&!["numberedList","bulletedList","todoList"].includes(n))return;if(s&&!0===s.value)return;const u=h.getChild(0),m=e.model.createRangeOn(u);if(!m.containsRange(l)&&!l.end.isEqual(m.end))return;const g=i.exec(u.data.substr(0,l.end.offset));g&&e.model.enqueueChange((t=>{const i=t.createPositionAt(h,0),n=t.createPositionAt(h,g[0].length),s=new qn(i,n),r=o({match:g});if(!1!==r){t.remove(s);const i=e.model.document.selection.getFirstRange(),n=t.createRangeIn(h);!h.isEmpty||n.isEqual(i)||n.containsRange(i,!0)||t.remove(h)}s.detach(),e.model.enqueueChange((()=>{e.plugins.get("Delete").requestUndoOnBackspace()}))}))}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function lu(e,t,i,n){let o,s;i instanceof RegExp?o=i:s=i,s=s||(e=>{let t;const i=[],n=[];while(null!==(t=o.exec(e))){if(t&&t.length<4)break;let{index:e,1:o,2:s,3:r}=t;const a=o+s+r;e+=t[0].length-a.length;const l=[e,e+o.length],c=[e+o.length+s.length,e+o.length+s.length+r.length];i.push(l),i.push(c),n.push([e+o.length,e+o.length+s.length])}return{remove:i,format:n}}),e.model.document.on("change:data",((i,o)=>{if("transparent"==o.type||!t.isEnabled)return;const r=e.model,a=r.document.selection;if(!a.isCollapsed)return;const l=Array.from(r.document.differ.getChanges()),c=l[0];if(1!=l.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;const d=a.focus,h=d.parent,{text:u,range:m}=du(r.createRange(r.createPositionAt(h,0),d),r),g=s(u),p=cu(m.start,g.format,r),f=cu(m.start,g.remove,r);p.length&&f.length&&r.enqueueChange((t=>{const i=n(t,p);if(!1!==i){for(const e of f.reverse())t.remove(e);r.enqueueChange((()=>{e.plugins.get("Delete").requestUndoOnBackspace()}))}}))}))}function cu(e,t,i){return t.filter((e=>void 0!==e[0]&&void 0!==e[1])).map((t=>i.createRange(e.getShiftedBy(t[0]),e.getShiftedBy(t[1]))))}function du(e,t){let i=e.start;const n=Array.from(e.getItems()).reduce(((e,n)=>!n.is("$text")&&!n.is("$textProxy")||n.getAttribute("code")?(i=t.createPositionAfter(n),""):e+n.data),"");return{text:n,range:t.createRange(i,e.end)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hu extends a.Z{static get requires(){return[kd]}static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&au(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&au(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&au(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&au(this.editor,this,/^\[\s?x\s?\]\s$/,(()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")}))}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const e=uu(this.editor,"bold");lu(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,e),lu(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,e)}if(e.get("italic")){const e=uu(this.editor,"italic");lu(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,e),lu(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,e)}if(e.get("code")){const e=uu(this.editor,"code");lu(this.editor,this,/(`)([^`]+)(`)$/g,e)}if(e.get("strikethrough")){const e=uu(this.editor,"strikethrough");lu(this.editor,this,/(~~)([^~]+)(~~)$/g,e)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter((e=>e.match(/^heading[1-6]$/))).forEach((t=>{const i=t[7],n=new RegExp(`^(#{${i}})\\s$`);au(this.editor,this,n,(()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})}))}))}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&au(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&au(e,this,/^```$/,(()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})}))}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&au(this.editor,this,/^---$/,"horizontalLine")}}function uu(e,t){return(i,n)=>{const o=e.commands.get(t);if(!o.isEnabled)return!1;const s=e.model.schema.getValidRanges(n,t);for(const e of s)i.setAttribute(t,!0,e);i.removeSelectionAttribute(t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mu extends b.Z{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document,n=i.selection,o=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(n.isCollapsed)o?e.setSelectionAttribute(this.attributeKey,!0):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const t of i)o?e.setAttribute(this.attributeKey,o,t):e.removeAttribute(this.attributeKey,t)}}))}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,i=e.document.selection;if(i.isCollapsed)return i.hasAttribute(this.attributeKey);for(const n of i.getRanges())for(const e of n.getItems())if(t.checkAttribute(e,this.attributeKey))return e.hasAttribute(this.attributeKey);return!1}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const gu="bold";class pu extends a.Z{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:gu}),e.model.schema.setAttributeProperties(gu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:gu,view:"strong",upcastAlso:["b",e=>{const t=e.getStyle("font-weight");return t?"bold"==t||Number(t)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),e.commands.add(gu,new mu(e,gu)),e.keystrokes.set("CTRL+B",gu)}}var fu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const wu="bold";class bu extends a.Z{static get pluginName(){return"BoldUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(wu,(i=>{const n=e.commands.get(wu),o=new l.Z(i);return o.set({label:t("Bold"),icon:fu,keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(wu),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vu extends a.Z{static get requires(){return[pu,bu]}static get pluginName(){return"Bold"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const _u="code",yu="ck-code_selected";class ku extends a.Z{static get pluginName(){return"CodeEditing"}static get requires(){return[Ad]}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:_u}),e.model.schema.setAttributeProperties(_u,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:_u,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),e.commands.add(_u,new mu(e,_u)),e.plugins.get(Ad).registerAttribute(_u),Kd(e,_u,"code",yu)}}var Cu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xu="code";class Vu extends a.Z{static get pluginName(){return"CodeUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(xu,(i=>{const n=e.commands.get(xu),o=new l.Z(i);return o.set({label:t("Code"),icon:Cu,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(xu),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Au extends a.Z{static get requires(){return[ku,Vu]}static get pluginName(){return"Code"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Eu="italic";class Tu extends a.Z{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Eu}),e.model.schema.setAttributeProperties(Eu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Eu,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Eu,new mu(e,Eu)),e.keystrokes.set("CTRL+I",Eu)}}var Pu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Su="italic";class Iu extends a.Z{static get pluginName(){return"ItalicUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Su,(i=>{const n=e.commands.get(Su),o=new l.Z(i);return o.set({label:t("Italic"),icon:Pu,keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(Su),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nu extends a.Z{static get requires(){return[Tu,Iu]}static get pluginName(){return"Italic"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Bu="strikethrough";class Ru extends a.Z{static get pluginName(){return"StrikethroughEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Bu}),e.model.schema.setAttributeProperties(Bu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Bu,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Bu,new mu(e,Bu)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}var Du='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Mu="strikethrough";class Ou extends a.Z{static get pluginName(){return"StrikethroughUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Mu,(i=>{const n=e.commands.get(Mu),o=new l.Z(i);return o.set({label:t("Strikethrough"),icon:Du,keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(Mu),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lu extends a.Z{static get requires(){return[Ru,Ou]}static get pluginName(){return"Strikethrough"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Fu="subscript";class zu extends a.Z{static get pluginName(){return"SubscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Fu}),e.model.schema.setAttributeProperties(Fu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Fu,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),e.commands.add(Fu,new mu(e,Fu))}}var $u='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.03 10.349 3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Zu="subscript";class Wu extends a.Z{static get pluginName(){return"SubscriptUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Zu,(i=>{const n=e.commands.get(Zu),o=new l.Z(i);return o.set({label:t("Subscript"),icon:$u,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(Zu),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hu extends a.Z{static get requires(){return[zu,Wu]}static get pluginName(){return"Subscript"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Uu="superscript";class qu extends a.Z{static get pluginName(){return"SuperscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Uu}),e.model.schema.setAttributeProperties(Uu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Uu,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),e.commands.add(Uu,new mu(e,Uu))}}var Gu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ju="superscript";class Ku extends a.Z{static get pluginName(){return"SuperscriptUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(ju,(i=>{const n=e.commands.get(ju),o=new l.Z(i);return o.set({label:t("Superscript"),icon:Gu,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(ju),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ju extends a.Z{static get requires(){return[qu,Ku]}static get pluginName(){return"Superscript"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yu="underline";class Qu extends a.Z{static get pluginName(){return"UnderlineEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Yu}),e.model.schema.setAttributeProperties(Yu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Yu,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Yu,new mu(e,Yu)),e.keystrokes.set("CTRL+U","underline")}}var Xu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const em="underline";class tm extends a.Z{static get pluginName(){return"UnderlineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(em,(i=>{const n=e.commands.get(em),o=new l.Z(i);return o.set({label:t("Underline"),icon:Xu,keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(em),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class im extends a.Z{static get requires(){return[Qu,tm]}static get pluginName(){return"Underline"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function*nm(e,t){for(const i of t)i&&e.getAttributeProperties(i[0]).copyOnEnter&&(yield i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class om extends b.Z{execute(){const e=this.editor.model,t=e.document;e.change((i=>{sm(this.editor.model,i,t.selection,e.schema),this.fire("afterExecute",{writer:i})}))}}function sm(e,t,i,n){const o=i.isCollapsed,s=i.getFirstRange(),r=s.start.parent,a=s.end.parent;if(n.isLimit(r)||n.isLimit(a))o||r!=a||e.deleteContent(i);else if(o){const e=nm(t.model.schema,i.getAttributes());rm(t,s.start),t.setSelectionAttribute(e)}else{const n=!(s.start.isAtStart&&s.end.isAtEnd),o=r==a;e.deleteContent(i,{leaveUnmerged:n}),n&&(o?rm(t,i.focus):t.setSelection(a,0))}}function rm(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class am extends _i{constructor(e){super(e);const t=this.document;t.on("keydown",((e,i)=>{if(this.isEnabled&&i.keyCode==ct.Do.enter){const n=new Ge(t,"enter",t.selection.getFirstRange());t.fire(n,new Ai(t,i.domEvent,{isSoft:i.shiftKey})),n.stop.called&&e.stop()}}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lm extends a.Z{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,i=t.document;t.addObserver(am),e.commands.add("enter",new om(e)),this.listenTo(i,"enter",((i,n)=>{n.preventDefault(),n.isSoft||(e.execute("enter"),t.scrollToTheSelection())}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cm extends b.Z{execute(){const e=this.editor.model,t=e.document;e.change((i=>{hm(e,i,t.selection),this.fire("afterExecute",{writer:i})}))}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=dm(e.schema,t.selection)}}function dm(e,t){if(t.rangeCount>1)return!1;const i=t.anchor;if(!i||!e.checkChild(i,"softBreak"))return!1;const n=t.getFirstRange(),o=n.start.parent,s=n.end.parent;return!mm(o,e)&&!mm(s,e)||o===s}function hm(e,t,i){const n=i.isCollapsed,o=i.getFirstRange(),s=o.start.parent,r=o.end.parent,a=s==r;if(n){const n=nm(e.schema,i.getAttributes());um(e,t,o.end),t.removeSelectionAttribute(i.getAttributeKeys()),t.setSelectionAttribute(n)}else{const n=!(o.start.isAtStart&&o.end.isAtEnd);e.deleteContent(i,{leaveUnmerged:n}),a?um(e,t,i.focus):n&&t.setSelection(r,0)}}function um(e,t,i){const n=t.createElement("softBreak");e.insertContent(n,i),t.setSelection(n,"after")}function mm(e,t){return!e.is("rootElement")&&(t.isLimit(e)||mm(e.parent,t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gm extends a.Z{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,i=e.conversion,n=e.editing.view,o=n.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),i.for("upcast").elementToElement({model:"softBreak",view:"br"}),i.for("downcast").elementToElement({model:"softBreak",view:(e,{writer:t})=>t.createEmptyElement("br")}),n.addObserver(am),e.commands.add("shiftEnter",new cm(e)),this.listenTo(o,"enter",((t,i)=>{i.preventDefault(),i.isSoft&&(e.execute("shiftEnter"),n.scrollToTheSelection())}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pm extends b.Z{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.schema,n=t.document.selection,o=Array.from(n.getSelectedBlocks()),s=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(s){const t=o.filter((e=>fm(e)||bm(i,e)));this._applyQuote(e,t)}else this._removeQuote(e,o.filter(fm))}))}_getValue(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getSelectedBlocks());return!(!t||!fm(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&bm(t,i)}_removeQuote(e,t){wm(e,t).reverse().forEach((t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const i=e.createPositionBefore(t.start.parent);return void e.move(t,i)}t.end.isAtEnd||e.split(t.end);const i=e.createPositionAfter(t.end.parent);e.move(t,i)}))}_applyQuote(e,t){const i=[];wm(e,t).reverse().forEach((t=>{let n=fm(t.start);n||(n=e.createElement("blockQuote"),e.wrap(t,n)),i.push(n)})),i.reverse().reduce(((t,i)=>t.nextSibling==i?(e.merge(e.createPositionAfter(t)),t):i))}}function fm(e){return"blockQuote"==e.parent.name?e.parent:null}function wm(e,t){let i,n=0;const o=[];while(n<t.length){const s=t[n],r=t[n+1];i||(i=e.createPositionBefore(s)),r&&s.nextSibling==r||(o.push(e.createRange(i,e.createPositionAfter(s))),i=null),n++}return o}function bm(e,t){const i=e.checkChild(t.parent,"blockQuote"),n=e.checkChild(["$root","blockQuote"],t);return i&&n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vm extends a.Z{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[lm,kd]}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new pm(e)),t.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer((i=>{const n=e.model.document.differ.getChanges();for(const e of n)if("insert"==e.type){const n=e.position.nodeAfter;if(!n)continue;if(n.is("element","blockQuote")&&n.isEmpty)return i.remove(n),!0;if(n.is("element","blockQuote")&&!t.checkChild(e.position,n))return i.unwrap(n),!0;if(n.is("element")){const e=i.createRangeIn(n);for(const n of e.getItems())if(n.is("element","blockQuote")&&!t.checkChild(i.createPositionBefore(n),n))return i.unwrap(n),!0}}else if("remove"==e.type){const t=e.position.parent;if(t.is("element","blockQuote")&&t.isEmpty)return i.remove(t),!0}return!1}));const i=this.editor.editing.view.document,n=e.model.document.selection,o=e.commands.get("blockQuote");this.listenTo(i,"enter",((t,i)=>{if(!n.isCollapsed||!o.value)return;const s=n.getLastPosition().parent;s.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop())}),{context:"blockquote"}),this.listenTo(i,"delete",((t,i)=>{if("backward"!=i.direction||!n.isCollapsed||!o.value)return;const s=n.getLastPosition().parent;s.isEmpty&&!s.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop())}),{context:"blockquote"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _m extends a.Z{static get pluginName(){return"BlockQuoteUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("blockQuote",(i=>{const n=e.commands.get("blockQuote"),o=new l.Z(i);return o.set({label:t("Block quote"),icon:sl.quote,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute("blockQuote"),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ym extends a.Z{static get requires(){return[vm,_m]}static get pluginName(){return"BlockQuote"}}i(99726);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function km(e){const t=e.t,i=e.config.get("codeBlock.languages");for(const n of i)"Plain text"===n.label&&(n.label=t("Plain text")),void 0===n.class&&(n.class=`language-${n.language}`);return i}function Cm(e,t,i){const n={};for(const o of e)"class"===t?n[o[t].split(" ").shift()]=o[i]:n[o[t]]=o[i];return n}function xm(e){return e.data.match(/^(\s*)/)[0]}function Vm(e,t){const i=e.createDocumentFragment(),n=t.split("\n"),o=n.reduce(((t,i,o)=>(t.push(i),o<n.length-1&&t.push(e.createElement("br")),t)),[]);return e.appendChild(o,i),i}function Am(e){const t=e.document.selection,i=[];if(t.isCollapsed)i.push(t.anchor);else{const n=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:t}of n)if(t.is("$textProxy")&&t.parent.is("element","codeBlock")){const n=xm(t.textNode),{parent:o,startOffset:s}=t.textNode,r=e.createPositionAt(o,s+n.length);i.push(r)}}return i}function Em(e){const t=(0,Xi.Z)(e.getSelectedBlocks());return t&&t.is("element","codeBlock")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tm extends b.Z{constructor(e){super(e),this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,i=t.model,n=i.document.selection,o=km(t),s=o[0],r=Array.from(n.getSelectedBlocks()),a=void 0===e.forceValue?!this.value:e.forceValue,l=Sm(e,this._lastLanguage,s.language);i.change((e=>{a?this._applyCodeBlock(e,r,l):this._removeCodeBlock(e,r)}))}_getValue(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getSelectedBlocks()),i=!(!t||!t.is("element","codeBlock"));return!!i&&t.getAttribute("language")}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&Pm(t,i)}_applyCodeBlock(e,t,i){this._lastLanguage=i;const n=this.editor.model.schema,o=t.filter((e=>Pm(n,e)));for(const s of o)e.rename(s,"codeBlock"),e.setAttribute("language",i,s),n.removeDisallowedAttributes([s],e),Array.from(s.getChildren()).filter((e=>!n.checkChild(s,e))).forEach((t=>e.remove(t)));o.reverse().forEach(((t,i)=>{const n=o[i+1];t.previousSibling===n&&(e.appendElement("softBreak",n),e.merge(e.createPositionBefore(t)))}))}_removeCodeBlock(e,t){const i=t.filter((e=>e.is("element","codeBlock")));for(const n of i){const t=e.createRangeOn(n);for(const i of Array.from(t.getItems()).reverse())if(i.is("element","softBreak")&&i.parent.is("element","codeBlock")){const{position:t}=e.split(e.createPositionBefore(i));e.rename(t.nodeAfter,"paragraph"),e.removeAttribute("language",t.nodeAfter),e.remove(i)}e.rename(n,"paragraph"),e.removeAttribute("language",n)}}}function Pm(e,t){return!t.is("rootElement")&&!e.isLimit(t)&&e.checkChild(t.parent,"codeBlock")}function Sm(e,t,i){return e.language?e.language:e.usePreviousLanguageChoice&&t?t:i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Im extends b.Z{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor,t=e.model;t.change((e=>{const i=Am(t);for(const t of i)e.insertText(this._indentSequence,t)}))}_checkEnabled(){return!!this._indentSequence&&Em(this.editor.model.document.selection)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nm extends b.Z{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor,t=e.model;t.change((e=>{const i=Am(t);for(const t of i){const i=Bm(this.editor.model,t,this._indentSequence);i&&e.remove(i)}}))}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return!!Em(e.document.selection)&&Am(e).some((t=>Bm(e,t,this._indentSequence)))}}function Bm(e,t,i){const n=Rm(t);if(!n)return null;const o=xm(n),s=o.lastIndexOf(i);if(s+i.length!==o.length)return null;if(-1===s)return null;const{parent:r,startOffset:a}=n;return e.createRange(e.createPositionAt(r,a+s),e.createPositionAt(r,a+s+i.length))}function Rm(e){let t=e.parent.getChild(e.index);return t&&!t.is("element","softBreak")||(t=e.nodeBefore),!t||t.is("element","softBreak")?null:t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dm(e,t,i=!1){const n=Cm(t,"language","class"),o=Cm(t,"language","label");return(t,s,r)=>{const{writer:a,mapper:l,consumable:c}=r;if(!c.consume(s.item,"insert"))return;const d=s.item.getAttribute("language"),h=l.toViewPosition(e.createPositionBefore(s.item)),u={};i&&(u["data-language"]=o[d],u.spellcheck="false");const m=a.createContainerElement("pre",u),g=a.createContainerElement("code",{class:n[d]||null});a.insert(a.createPositionAt(m,0),g),a.insert(h,m),l.bindElements(s.item,g)}}function Mm(e){return(t,i,n)=>{if("codeBlock"!==i.item.parent.name)return;const{writer:o,mapper:s,consumable:r}=n;if(!r.consume(i.item,"insert"))return;const a=s.toViewPosition(e.createPositionBefore(i.item));o.insert(a,o.createText("\n"))}}function Om(e,t){const i=Cm(t,"class","language"),n=t[0].language;return(e,t,o)=>{const s=t.viewItem,r=s.parent;if(!r||!r.is("element","pre"))return;if(t.modelCursor.findAncestor("codeBlock"))return;const{consumable:a,writer:l}=o;if(!a.test(s,{name:!0}))return;const c=l.createElement("codeBlock"),d=[...s.getClassNames()];d.length||d.push("");for(const n of d){const e=i[n];if(e){l.setAttribute("language",e,c);break}}c.hasAttribute("language")||l.setAttribute("language",n,c),o.convertChildren(s,c),o.safeInsert(c,t.modelCursor)&&(a.consume(s,{name:!0}),o.updateConversionResult(c,t))}}function Lm(){return(e,t,{consumable:i,writer:n})=>{let o=t.modelCursor;if(!i.test(t.viewItem))return;if(!o.findAncestor("codeBlock"))return;i.consume(t.viewItem);const s=t.viewItem.data,r=s.split("\n").map((e=>n.createText(e))),a=r[r.length-1];for(const l of r)if(n.insert(l,o),o=o.getShiftedBy(l.offsetSize),l!==a){const e=n.createElement("softBreak");n.insert(e,o),o=n.createPositionAfter(e)}t.modelRange=n.createRange(t.modelCursor,o),t.modelCursor=o}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Fm="paragraph";class zm extends a.Z{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[gm]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"\t"})}init(){const e=this.editor,t=e.model.schema,i=e.model,n=e.editing.view,o=km(e);e.commands.add("codeBlock",new Tm(e)),e.commands.add("indentCodeBlock",new Im(e)),e.commands.add("outdentCodeBlock",new Nm(e));const s=e=>(t,i)=>{const n=this.editor.commands.get(e);n.isEnabled&&(this.editor.execute(e),i())};e.keystrokes.set("Tab",s("indentCodeBlock")),e.keystrokes.set("Shift+Tab",s("outdentCodeBlock")),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",isBlock:!0,allowAttributes:["language"]}),t.addAttributeCheck((e=>{if(e.endsWith("codeBlock $text"))return!1})),e.model.schema.addChildCheck(((e,t)=>{if(e.endsWith("codeBlock")&&t.isObject)return!1})),e.editing.downcastDispatcher.on("insert:codeBlock",Dm(i,o,!0)),e.data.downcastDispatcher.on("insert:codeBlock",Dm(i,o)),e.data.downcastDispatcher.on("insert:softBreak",Mm(i),{priority:"high"}),e.data.upcastDispatcher.on("element:code",Om(n,o)),e.data.upcastDispatcher.on("text",Lm()),this.listenTo(e.editing.view.document,"clipboardInput",((t,n)=>{let o=i.createRange(i.document.selection.anchor);if(n.targetRanges&&(o=e.editing.mapper.toModelRange(n.targetRanges[0])),!o.start.parent.is("element","codeBlock"))return;const s=n.dataTransfer.getData("text/plain"),r=new vh(e.editing.view.document);n.content=Vm(r,s)})),this.listenTo(i,"getSelectedContent",((e,[n])=>{const o=n.anchor;!n.isCollapsed&&o.parent.is("element","codeBlock")&&o.hasSameParentAs(n.focus)&&i.change((i=>{const s=e.return;if(s.childCount>1||n.containsEntireContent(o.parent)){const t=i.createElement("codeBlock",o.parent.getAttributes());i.append(s,t);const n=i.createDocumentFragment();i.append(t,n),e.return=n}else{const e=s.getChild(0);t.checkAttribute(e,"code")&&i.setAttribute("code",!0,e)}}))}))}afterInit(){const e=this.editor,t=e.commands,i=t.get("indent"),n=t.get("outdent");i&&i.registerChildCommand(t.get("indentCodeBlock")),n&&n.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",((t,i)=>{const n=e.model.document.selection.getLastPosition().parent;n.is("element","codeBlock")&&(Zm(e,i.isSoft)||Wm(e,i.isSoft)||$m(e),i.preventDefault(),t.stop())}),{context:"pre"})}}function $m(e){const t=e.model,i=t.document,n=i.selection.getLastPosition(),o=n.nodeBefore||n.textNode;let s;o&&o.is("$text")&&(s=xm(o)),e.model.change((t=>{e.execute("shiftEnter"),s&&t.insertText(s,i.selection.anchor)}))}function Zm(e,t){const i=e.model,n=i.document,o=e.editing.view,s=n.selection.getLastPosition(),r=s.nodeAfter;return!(t||!n.selection.isCollapsed||!s.isAtStart)&&(!!Um(r)&&(e.model.change((t=>{e.execute("enter");const i=n.selection.anchor.parent.previousSibling;t.rename(i,Fm),t.setSelection(i,"in"),e.model.schema.removeDisallowedAttributes([i],t),t.remove(r)})),o.scrollToTheSelection(),!0))}function Wm(e,t){const i=e.model,n=i.document,o=e.editing.view,s=n.selection.getLastPosition(),r=s.nodeBefore;let a;if(t||!n.selection.isCollapsed||!s.isAtEnd||!r||!r.previousSibling)return!1;if(Um(r)&&Um(r.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling),i.createPositionAfter(r));else if(Hm(r)&&Um(r.previousSibling)&&Um(r.previousSibling.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling),i.createPositionAfter(r));else{if(!(Hm(r)&&Um(r.previousSibling)&&Hm(r.previousSibling.previousSibling)&&Um(r.previousSibling.previousSibling.previousSibling)))return!1;a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling.previousSibling),i.createPositionAfter(r))}return e.model.change((t=>{t.remove(a),e.execute("enter");const i=n.selection.anchor.parent;t.rename(i,Fm),e.model.schema.removeDisallowedAttributes([i],t)})),o.scrollToTheSelection(),!0}function Hm(e){return e&&e.is("$text")&&!e.data.match(/\S/)}function Um(e){return e&&e.is("element","softBreak")}var qm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gm extends a.Z{static get pluginName(){return"CodeBlockUI"}init(){const e=this.editor,t=e.t,i=e.ui.componentFactory,n=km(e);i.add("codeBlock",(i=>{const o=e.commands.get("codeBlock"),s=vc(i,Ql),r=s.buttonView;return r.set({label:t("Insert code block"),tooltip:!0,icon:qm,isToggleable:!0}),r.bind("isOn").to(o,"value",(e=>!!e)),r.on("execute",(()=>{e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus()})),s.on("execute",(t=>{e.execute("codeBlock",{language:t.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()})),s.class="ck-code-block-dropdown",s.bind("isEnabled").to(o),yc(s,this._getLanguageListItemDefinitions(n)),s}))}_getLanguageListItemDefinitions(e){const t=this.editor,i=t.commands.get("codeBlock"),n=new T.Z;for(const o of e){const e={type:"button",model:new Lc({_codeBlockLanguage:o.language,label:o.label,withText:!0})};e.model.bind("isOn").to(i,"value",(t=>t===e.model._codeBlockLanguage)),n.add(e)}return n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jm extends a.Z{static get requires(){return[zm,Gm]}static get pluginName(){return"CodeBlock"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Km extends ya{constructor(e,t){super(e),this.view=t,this._toolbarConfig=hc(e.config.get("toolbar")),this._elementReplacer=new Di}get element(){return this.view.element}init(e){const t=this.editor,i=this.view,n=t.editing.view,o=i.editable,s=n.document.getRoot();o.name=s.rootName,i.render();const r=o.element;this.setEditableElement(o.name,r),this.focusTracker.add(r),i.editable.bind("isFocused").to(this.focusTracker),n.attachDomRoot(r),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy(),super.destroy()}_initToolbar(){const e=this.editor,t=this.view,i=e.editing.view;t.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),t.stickyPanel.limiterElement=t.element,t.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",(({top:e})=>e)),t.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),ed({origin:i,originFocusTracker:this.focusTracker,originKeystrokeHandler:e.keystrokes,toolbar:t.toolbar})}_initPlaceholder(){const e=this.editor,t=e.editing.view,i=t.document.getRoot(),n=e.sourceElement,o=e.config.get("placeholder")||n&&"textarea"===n.tagName.toLowerCase()&&n.getAttribute("placeholder");o&&Yd({view:t,element:i,text:o,isDirectHost:!1,keepOnFocus:!0})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jm extends Tc{constructor(e,t,i={}){super(e),this.stickyPanel=new Qc(e),this.toolbar=new uc(e,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),this.editable=new Sc(e,t)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ym extends ba{constructor(e,t){super(t),x(e)&&(this.sourceElement=e),this.model.document.createRoot();const i=!this.config.get("toolbar.shouldNotGroupWhenFull"),n=new Jm(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:i});this.ui=new Km(this,n),Ca(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise((i=>{const n=new this(e,t);i(n.initPlugins().then((()=>n.ui.init(x(e)?e:null))).then((()=>{if(!x(e)&&t.initialData)throw new P.ZP("editor-create-initial-data",null);const i=void 0!==t.initialData?t.initialData:Qm(e);return n.data.init(i)})).then((()=>n.fire("ready"))).then((()=>n)))}))}}function Qm(e){return x(e)?Zi(e):e}(0,I.Z)(Ym,Va),(0,I.Z)(Ym,Ta);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xm{constructor(e){this.files=eg(e),this._native=e}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}get isCanceled(){return"none"==this._native.dropEffect||!!this._native.mozUserCancelled}}function eg(e){const t=Array.from(e.files||[]),i=Array.from(e.items||[]);return t.length?t:i.filter((e=>"file"===e.kind)).map((e=>e.getAsFile()))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tg extends Ei{constructor(e){super(e);const t=this.document;function i(e){return(i,n)=>{n.preventDefault();const o=n.dropRange?[n.dropRange]:null,s=new qe.Z(t,e);t.fire(s,{dataTransfer:n.dataTransfer,method:i.name,targetRanges:o,target:n.target}),s.stop.called&&n.stopPropagation()}}this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"],this.listenTo(t,"paste",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",i("dragging"),{priority:"low"})}onDomEvent(e){const t={dataTransfer:new Xm(e.clipboardData?e.clipboardData:e.dataTransfer)};"drop"!=e.type&&"dragover"!=e.type||(t.dropRange=ig(this.view,e)),this.fire(e.type,e,t)}}function ig(e,t){const i=t.target.ownerDocument,n=t.clientX,o=t.clientY;let s;return i.caretRangeFromPoint&&i.caretRangeFromPoint(n,o)?s=i.caretRangeFromPoint(n,o):t.rangeParent&&(s=i.createRange(),s.setStart(t.rangeParent,t.rangeOffset),s.collapse(!0)),s?e.domConverter.domRangeToView(s):null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ng(e){return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(e.includes("</p><p>")||e.includes("<br>"))&&(e=`<p>${e}</p>`),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function og(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,((e,t)=>1==t.length?" ":t)).replace(/<!--[\s\S]*?-->/g,"")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sg=["figcaption","li"];function rg(e){let t="";if(e.is("$text")||e.is("$textProxy"))t=e.data;else if(e.is("element","img")&&e.hasAttribute("alt"))t=e.getAttribute("alt");else if(e.is("element","br"))t="\n";else{let i=null;for(const n of e.getChildren()){const e=rg(n);i&&(i.is("containerElement")||n.is("containerElement"))&&(sg.includes(i.name)||sg.includes(n.name)?t+="\n":t+="\n\n"),t+=e,i=n}}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ag extends a.Z{static get pluginName(){return"ClipboardPipeline"}init(){const e=this.editor,t=e.editing.view;t.addObserver(tg),this._setupPasteDrop(),this._setupCopyCut()}_setupPasteDrop(){const e=this.editor,t=e.model,i=e.editing.view,n=i.document;this.listenTo(n,"clipboardInput",(t=>{e.isReadOnly&&t.stop()}),{priority:"highest"}),this.listenTo(n,"clipboardInput",((e,t)=>{const n=t.dataTransfer;let o=t.content||"";o||(n.getData("text/html")?o=og(n.getData("text/html")):n.getData("text/plain")&&(o=ng(n.getData("text/plain"))),o=this.editor.data.htmlProcessor.toView(o));const s=new qe.Z(this,"inputTransformation");this.fire(s,{content:o,dataTransfer:n,targetRanges:t.targetRanges,method:t.method}),s.stop.called&&e.stop(),i.scrollToTheSelection()}),{priority:"low"}),this.listenTo(this,"inputTransformation",((e,i)=>{if(i.content.isEmpty)return;const n=this.editor.data,o=n.toModel(i.content,"$clipboardHolder");0!=o.childCount&&(e.stop(),t.change((()=>{this.fire("contentInsertion",{content:o,method:i.method,dataTransfer:i.dataTransfer,targetRanges:i.targetRanges})})))}),{priority:"low"}),this.listenTo(this,"contentInsertion",((e,i)=>{i.resultRange=t.insertContent(i.content)}),{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,i=e.editing.view,n=i.document;function o(i,o){const s=o.dataTransfer;o.preventDefault();const r=e.data.toView(e.model.getSelectedContent(t.selection));n.fire("clipboardOutput",{dataTransfer:s,content:r,method:i.name})}this.listenTo(n,"copy",o,{priority:"low"}),this.listenTo(n,"cut",((t,i)=>{e.isReadOnly?i.preventDefault():o(t,i)}),{priority:"low"}),this.listenTo(n,"clipboardOutput",((i,n)=>{n.content.isEmpty||(n.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(n.content)),n.dataTransfer.setData("text/plain",rg(n.content))),"cut"==n.method&&e.model.deleteContent(t.selection)}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lg{constructor(){this._stack=[]}add(e,t){const i=this._stack,n=i[0];this._insertDescriptor(e);const o=i[0];n===o||cg(n,o)||this.fire("change:top",{oldDescriptor:n,newDescriptor:o,writer:t})}remove(e,t){const i=this._stack,n=i[0];this._removeDescriptor(e);const o=i[0];n===o||cg(n,o)||this.fire("change:top",{oldDescriptor:n,newDescriptor:o,writer:t})}_insertDescriptor(e){const t=this._stack,i=t.findIndex((t=>t.id===e.id));if(cg(e,t[i]))return;i>-1&&t.splice(i,1);let n=0;while(t[n]&&dg(t[n],e))n++;t.splice(n,0,e)}_removeDescriptor(e){const t=this._stack,i=t.findIndex((t=>t.id===e));i>-1&&t.splice(i,1)}}function cg(e,t){return e&&t&&e.priority==t.priority&&hg(e.classes)==hg(t.classes)}function dg(e,t){return e.priority>t.priority||!(e.priority<t.priority)&&hg(e.classes)>hg(t.classes)}function hg(e){return Array.isArray(e)?e.sort().join(","):e}(0,I.Z)(lg,S.ZP);var ug='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const mg="ck-widget",gg="ck-widget_selected";function pg(e){return!!e.is("element")&&!!e.getCustomProperty("widget")}function fg(e,t,i={}){if(!e.is("containerElement"))throw new P.ZP("widget-to-widget-wrong-element-type",null,{element:e});return t.setAttribute("contenteditable","false",e),t.addClass(mg,e),t.setCustomProperty("widget",!0,e),e.getFillerOffset=xg,i.label&&_g(e,i.label,t),i.hasSelectionHandle&&Vg(e,t),vg(e,t),e}function wg(e,t,i){if(t.classes&&i.addClass((0,B.Z)(t.classes),e),t.attributes)for(const n in t.attributes)i.setAttribute(n,t.attributes[n],e)}function bg(e,t,i){if(t.classes&&i.removeClass((0,B.Z)(t.classes),e),t.attributes)for(const n in t.attributes)i.removeAttribute(n,e)}function vg(e,t,i=wg,n=bg){const o=new lg;o.on("change:top",((t,o)=>{o.oldDescriptor&&n(e,o.oldDescriptor,o.writer),o.newDescriptor&&i(e,o.newDescriptor,o.writer)})),t.setCustomProperty("addHighlight",((e,t,i)=>o.add(t,i)),e),t.setCustomProperty("removeHighlight",((e,t,i)=>o.remove(t,i)),e)}function _g(e,t,i){i.setCustomProperty("widgetLabel",t,e)}function yg(e){const t=e.getCustomProperty("widgetLabel");return t?"function"==typeof t?t():t:""}function kg(e,t){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],e),t.setAttribute("contenteditable",e.isReadOnly?"false":"true",e),e.on("change:isReadOnly",((i,n,o)=>{t.setAttribute("contenteditable",o?"false":"true",e)})),e.on("change:isFocused",((i,n,o)=>{o?t.addClass("ck-editor__nested-editable_focused",e):t.removeClass("ck-editor__nested-editable_focused",e)})),vg(e,t),e}function Cg(e,t){const i=e.getSelectedElement();if(i){const n=Ig(e);if(n)return t.createRange(t.createPositionAt(i,n));if(t.schema.isObject(i)&&!t.schema.isInline(i))return t.createRangeOn(i)}const n=e.getSelectedBlocks().next().value;if(n){if(n.isEmpty)return t.createRange(t.createPositionAt(n,0));const i=t.createPositionAfter(n);return e.focus.isTouching(i)?t.createRange(i):t.createRange(t.createPositionBefore(n))}return t.createRange(e.focus)}function xg(){return null}function Vg(e,t){const i=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},(function(e){const t=this.toDomElement(e),i=new Jl.Z;return i.set("content",ug),i.render(),t.appendChild(i.element),t}));t.insert(t.createPositionAt(e,0),i),t.addClass(["ck-widget_with-selection-handle"],e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ag="widget-type-around";function Eg(e,t,i){return e&&pg(e)&&!i.isInline(t)}function Tg(e){return e.closest(".ck-widget__type-around__button")}function Pg(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function Sg(e,t){const i=e.closest(".ck-widget");return t.mapDomToView(i)}function Ig(e){return e.getAttribute(Ag)}var Ng='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Bg=["before","after"],Rg=(new DOMParser).parseFromString(Ng,"image/svg+xml").firstChild,Dg="ck-widget__type-around_disabled";class Mg extends a.Z{static get pluginName(){return"WidgetTypeAround"}static get requires(){return[lm,kd]}constructor(e){super(e),this._currentFakeCaretModelElement=null}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",((i,n,o)=>{t.change((e=>{for(const i of t.document.roots)o?e.removeClass(Dg,i):e.addClass(Dg,i)})),o||e.model.change((e=>{e.removeSelectionAttribute(Ag)}))})),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableDeleteContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const i=this.editor,n=i.editing.view;i.execute("insertParagraph",{position:i.model.createPositionAt(e,t)}),n.focus(),n.scrollToTheSelection()}_listenToIfEnabled(e,t,i,n){this.listenTo(e,t,((...e)=>{this.isEnabled&&i(...e)}),n)}_insertParagraphAccordingToFakeCaretPosition(){const e=this.editor,t=e.model,i=t.document.selection,n=Ig(i);if(!n)return!1;const o=i.getSelectedElement();return this._insertParagraph(o,n),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,i=e.locale.t,n={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",((e,i,o)=>{const s=o.mapper.toViewElement(i.item);Eg(s,i.item,t)&&Og(o.writer,n,s)}),{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,i=t.document.selection,n=t.schema,o=e.editing.view;function s(e){return`ck-widget_type-around_show-fake-caret_${e}`}this._listenToIfEnabled(o.document,"arrowKey",((e,t)=>{this._handleArrowKeyPress(e,t)}),{context:[pg,"$text"],priority:"high"}),this._listenToIfEnabled(i,"change:range",((t,i)=>{i.directChange&&e.model.change((e=>{e.removeSelectionAttribute(Ag)}))})),this._listenToIfEnabled(t.document,"change:data",(()=>{const t=i.getSelectedElement();if(t){const i=e.editing.mapper.toViewElement(t);if(Eg(i,t,n))return}e.model.change((e=>{e.removeSelectionAttribute(Ag)}))})),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",((e,t,i)=>{const o=i.writer;if(this._currentFakeCaretModelElement){const e=i.mapper.toViewElement(this._currentFakeCaretModelElement);e&&(o.removeClass(Bg.map(s),e),this._currentFakeCaretModelElement=null)}const r=t.selection.getSelectedElement();if(!r)return;const a=i.mapper.toViewElement(r);if(!Eg(a,r,n))return;const l=Ig(t.selection);l&&(o.addClass(s(l),a),this._currentFakeCaretModelElement=r)})),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",((t,i,n)=>{n||e.model.change((e=>{e.removeSelectionAttribute(Ag)}))}))}_handleArrowKeyPress(e,t){const i=this.editor,n=i.model,o=n.document.selection,s=n.schema,r=i.editing.view,a=t.keyCode,l=(0,ct.Zt)(a,i.locale.contentLanguageDirection),c=r.document.selection.getSelectedElement(),d=i.editing.mapper.toModelElement(c);let h;Eg(c,d,s)?h=this._handleArrowKeyPressOnSelectedWidget(l):o.isCollapsed?h=this._handleArrowKeyPressWhenSelectionNextToAWidget(l):t.shiftKey||(h=this._handleArrowKeyPressWhenNonCollapsedSelection(l)),h&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const t=this.editor,i=t.model,n=i.document.selection,o=Ig(n);return i.change((t=>{if(!o)return t.setSelectionAttribute(Ag,e?"after":"before"),!0;{const i=o===(e?"after":"before");if(!i)return t.removeSelectionAttribute(Ag),!0}return!1}))}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,i=t.model,n=i.schema,o=t.plugins.get("Widget"),s=o._getObjectElementNextToSelection(e),r=t.editing.mapper.toViewElement(s);return!!Eg(r,s,n)&&(i.change((t=>{o._setSelectionOverElement(s),t.setSelectionAttribute(Ag,e?"before":"after")})),!0)}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,i=t.model,n=i.schema,o=t.editing.mapper,s=i.document.selection,r=e?s.getLastPosition().nodeBefore:s.getFirstPosition().nodeAfter,a=o.toViewElement(r);return!!Eg(a,r,n)&&(i.change((t=>{t.setSelection(r,"on"),t.setSelectionAttribute(Ag,e?"after":"before")})),!0)}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",((i,n)=>{const o=Tg(n.domTarget);if(!o)return;const s=Pg(o),r=Sg(o,t.domConverter),a=e.editing.mapper.toModelElement(r);this._insertParagraph(a,s),n.preventDefault(),i.stop()}))}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,i=e.editing.view;this._listenToIfEnabled(i.document,"enter",((i,n)=>{if("atTarget"!=i.eventPhase)return;const o=t.getSelectedElement(),s=e.editing.mapper.toViewElement(o),r=e.model.schema;let a;this._insertParagraphAccordingToFakeCaretPosition()?a=!0:Eg(s,o,r)&&(this._insertParagraph(o,n.isSoft?"before":"after"),a=!0),a&&(n.preventDefault(),i.stop())}),{context:pg})}_enableInsertingParagraphsOnTypingKeystroke(){const e=this.editor,t=e.editing.view,i=[ct.Do.enter,ct.Do["delete"],ct.Do.backspace];this._listenToIfEnabled(t.document,"keydown",((e,t)=>{i.includes(t.keyCode)||md(t)||this._insertParagraphAccordingToFakeCaretPosition()}),{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,i=e.model,n=i.schema;this._listenToIfEnabled(t.document,"delete",((t,o)=>{if("atTarget"!=t.eventPhase)return;const s=Ig(i.document.selection);if(!s)return;const r=o.direction,a=i.document.selection.getSelectedElement(),l="before"===s,c="forward"==r,d=l===c;if(d)e.execute("delete",{selection:i.createSelection(a,"on")});else{const t=n.getNearestSelectionRange(i.createPositionAt(a,s),r);if(t)if(t.isCollapsed){const o=i.createSelection(t.start);if(i.modifySelection(o,{direction:r}),o.focus.isEqual(t.start)){const e=zg(n,t.start.parent);i.deleteContent(i.createSelection(e,"on"),{doNotAutoparagraph:!0})}else i.change((i=>{i.setSelection(t),e.execute(c?"deleteForward":"delete")}))}else i.change((i=>{i.setSelection(t),e.execute(c?"deleteForward":"delete")}))}o.preventDefault(),t.stop()}),{context:pg})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",((e,[n,o])=>{if(o&&!o.is("documentSelection"))return;const s=Ig(i);return s?(e.stop(),t.change((e=>{const o=i.getSelectedElement(),r=t.createPositionAt(o,s),a=e.createSelection(r),l=t.insertContent(n,a);return e.setSelection(a),l}))):void 0}),{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"deleteContent",((e,[t])=>{if(t&&!t.is("documentSelection"))return;const n=Ig(i);n&&e.stop()}),{priority:"high"})}}function Og(e,t,i){const n=e.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},(function(e){const i=this.toDomElement(e);return Lg(i,t),Fg(i),i}));e.insert(e.createPositionAt(i,"end"),n)}function Lg(e,t){for(const i of Bg){const n=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${i}`],title:t[i]},children:[e.ownerDocument.importNode(Rg,!0)]});e.appendChild(n.render())}}function Fg(e){const t=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render())}function zg(e,t){let i=t;for(const n of t.getAncestors({parentFirst:!0})){if(n.childCount>1||e.isLimit(n))break;i=n}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $g(e){const t=e.model;return(i,n)=>{const o=n.keyCode==ct.Do.arrowup,s=n.keyCode==ct.Do.arrowdown,r=n.shiftKey,a=t.document.selection;if(!o&&!s)return;const l=s;if(r&&qg(a,l))return;const c=Zg(e,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return}(c.isCollapsed||Ug(e,c,l))&&(t.change((e=>{const i=l?c.end:c.start;if(r){const n=t.createSelection(a.anchor);n.setFocus(i),e.setSelection(n)}else e.setSelection(i)})),i.stop(),n.preventDefault(),n.stopPropagation())}}}function Zg(e,t,i){const n=e.model;if(i){const e=t.isCollapsed?t.focus:t.getLastPosition(),i=Wg(n,e,"forward");if(!i)return null;const o=n.createRange(e,i),s=Hg(n.schema,o,"backward");return s?n.createRange(e,s):null}{const e=t.isCollapsed?t.focus:t.getFirstPosition(),i=Wg(n,e,"backward");if(!i)return null;const o=n.createRange(i,e),s=Hg(n.schema,o,"forward");return s?n.createRange(s,e):null}}function Wg(e,t,i){const n=e.schema,o=e.createRangeIn(t.root),s="forward"==i?"elementStart":"elementEnd";for(const{previousPosition:r,item:a,type:l}of o.getWalker({startPosition:t,direction:i})){if(n.isLimit(a)&&!n.isInline(a))return r;if(l==s&&n.isBlock(a))return null}return null}function Hg(e,t,i){const n="backward"==i?t.end:t.start;if(e.checkChild(n,"$text"))return n;for(const{nextPosition:o}of t.getWalker({direction:i}))if(e.checkChild(o,"$text"))return o;return null}function Ug(e,t,i){const n=e.model,o=e.view.domConverter;if(i){const e=n.createSelection(t.start);n.modifySelection(e),e.focus.isAtEnd||t.start.isEqual(e.focus)||(t=n.createRange(e.focus,t.end))}const s=e.mapper.toViewRange(t),r=o.viewRangeToDom(s),a=Gi.getDomRangeRects(r);let l;for(const c of a)if(void 0!==l){if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}else l=Math.round(c.bottom);return!0}function qg(e,t){return!e.isCollapsed&&e.isBackward==t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gg extends a.Z{static get pluginName(){return"Widget"}static get requires(){return[Mg,kd]}init(){const e=this.editor,t=e.editing.view,i=t.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",((t,i,n)=>{const o=n.writer,s=i.selection;if(s.isCollapsed)return;const r=s.getSelectedElement();if(!r)return;const a=e.editing.mapper.toViewElement(r);pg(a)&&n.consumable.consume(s,"selection")&&o.setSelection(o.createRangeOn(a),{fake:!0,label:yg(a)})})),this.editor.editing.downcastDispatcher.on("selection",((e,t,i)=>{this._clearPreviouslySelectedWidgets(i.writer);const n=i.writer,o=n.document.selection;let s=null;for(const r of o.getRanges())for(const e of r){const t=e.item;pg(t)&&!Kg(t,s)&&(n.addClass(gg,t),this._previouslySelected.add(t),s=t)}}),{priority:"low"}),t.addObserver(bh),this.listenTo(i,"mousedown",((...e)=>this._onMousedown(...e))),this.listenTo(i,"arrowKey",((...e)=>{this._handleSelectionChangeOnArrowKeyPress(...e)}),{context:[pg,"$text"]}),this.listenTo(i,"arrowKey",((...e)=>{this._preventDefaultOnArrowKeyPress(...e)}),{context:"$root"}),this.listenTo(i,"arrowKey",$g(this.editor.editing),{context:"$text"}),this.listenTo(i,"delete",((e,t)=>{this._handleDelete("forward"==t.direction)&&(t.preventDefault(),e.stop())}),{context:"$root"})}_onMousedown(e,t){const i=this.editor,n=i.editing.view,o=n.document;let s=t.target;if(jg(s)){if((Yt.ZP.isSafari||Yt.ZP.isGecko)&&t.domEvent.detail>=3){const e=i.editing.mapper,n=s.is("attributeElement")?s.findAncestor((e=>!e.is("attributeElement"))):s,o=e.toModelElement(n);t.preventDefault(),this.editor.model.change((e=>{e.setSelection(o,"in")}))}return}if(!pg(s)&&(s=s.findAncestor(pg),!s))return;Yt.ZP.isAndroid&&t.preventDefault(),o.isFocused||n.focus();const r=i.editing.mapper.toModelElement(s);this._setSelectionOverElement(r)}_handleSelectionChangeOnArrowKeyPress(e,t){const i=t.keyCode,n=this.editor.model,o=n.schema,s=n.document.selection,r=s.getSelectedElement(),a=(0,ct.mA)(i,this.editor.locale.contentLanguageDirection),l="down"==a||"right"==a,c="up"==a||"down"==a;if(r&&o.isObject(r)){const i=l?s.getLastPosition():s.getFirstPosition(),r=o.getNearestSelectionRange(i,l?"forward":"backward");return void(r&&(n.change((e=>{e.setSelection(r)})),t.preventDefault(),e.stop()))}if(!s.isCollapsed&&!t.shiftKey){const i=s.getFirstPosition(),r=s.getLastPosition(),a=i.nodeAfter,c=r.nodeBefore;return void((a&&o.isObject(a)||c&&o.isObject(c))&&(n.change((e=>{e.setSelection(l?r:i)})),t.preventDefault(),e.stop()))}if(!s.isCollapsed)return;const d=this._getObjectElementNextToSelection(l);if(d&&o.isObject(d)){if(o.isInline(d)&&c)return;this._setSelectionOverElement(d),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const i=this.editor.model,n=i.schema,o=i.document.selection.getSelectedElement();o&&n.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){if(this.editor.isReadOnly)return;const t=this.editor.model.document,i=t.selection;if(!i.isCollapsed)return;const n=this._getObjectElementNextToSelection(e);return n?(this.editor.model.change((e=>{let t=i.anchor.parent;while(t.isEmpty){const i=t;t=i.parent,e.remove(i)}this._setSelectionOverElement(n)})),!0):void 0}_setSelectionOverElement(e){this.editor.model.change((t=>{t.setSelection(t.createRangeOn(e))}))}_getObjectElementNextToSelection(e){const t=this.editor.model,i=t.schema,n=t.document.selection,o=t.createSelection(n);if(t.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(n))return null;const s=e?o.focus.nodeBefore:o.focus.nodeAfter;return s&&i.isObject(s)?s:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(gg,t);this._previouslySelected.clear()}}function jg(e){while(e){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(pg(e))return!1;e=e.parent}return!1}function Kg(e,t){return!!t&&Array.from(e.getAncestors()).includes(t)}var Jg=i(111);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yg extends a.Z{static get pluginName(){return"DragDrop"}static get requires(){return[ag,Gg]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,this._updateDropMarkerThrottled=(0,Jg.Z)((e=>this._updateDropMarker(e)),40),this._removeDropMarkerDelayed=sp((()=>this._removeDropMarker()),40),this._clearDraggableAttributesDelayed=sp((()=>this._clearDraggableAttributes()),40),t.addObserver(tg),t.addObserver(bh),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDropMarker(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",((e,t,i)=>{i?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})),this.on("change:isEnabled",((e,t,i)=>{i||this._finalizeDragging(!1)})),Yt.ZP.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._updateDropMarkerThrottled.cancel(),this._removeDropMarkerDelayed.cancel(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,i=t.document,n=e.editing.view,o=n.document;this.listenTo(o,"dragstart",((n,s)=>{const r=i.selection;if(s.target&&s.target.is("editableElement"))return void s.preventDefault();const a=s.target?rp(s.target):null;if(a){const i=e.editing.mapper.toModelElement(a);this._draggedRange=qn.fromRange(t.createRangeOn(i)),e.plugins.has("WidgetToolbarRepository")&&e.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop")}else if(!o.selection.isCollapsed){const e=o.selection.getSelectedElement();e&&pg(e)||(this._draggedRange=qn.fromRange(r.getFirstRange()))}if(!this._draggedRange)return void s.preventDefault();this._draggingUid=(0,on.Z)(),s.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",s.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const l=t.createSelection(this._draggedRange.toRange()),c=e.data.toView(t.getSelectedContent(l));o.fire("clipboardOutput",{dataTransfer:s.dataTransfer,content:c,method:n.name}),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")}),{priority:"low"}),this.listenTo(o,"dragend",((e,t)=>{this._finalizeDragging(!t.dataTransfer.isCanceled&&"move"==t.dataTransfer.dropEffect)}),{priority:"low"}),this.listenTo(o,"dragenter",(()=>{this.isEnabled&&n.focus()})),this.listenTo(o,"dragleave",(()=>{this._removeDropMarkerDelayed()})),this.listenTo(o,"dragging",((t,i)=>{if(!this.isEnabled)return void(i.dataTransfer.dropEffect="none");this._removeDropMarkerDelayed.cancel();const n=Qg(e,i.targetRanges,i.target);this._draggedRange||(i.dataTransfer.dropEffect="copy"),Yt.ZP.isGecko||("copy"==i.dataTransfer.effectAllowed?i.dataTransfer.dropEffect="copy":["all","copyMove"].includes(i.dataTransfer.effectAllowed)&&(i.dataTransfer.dropEffect="move")),n&&this._updateDropMarkerThrottled(n)}),{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"clipboardInput",((t,i)=>{if("drop"!=i.method)return;const n=Qg(e,i.targetRanges,i.target);if(this._removeDropMarker(),!n)return this._finalizeDragging(!1),void t.stop();this._draggedRange&&this._draggingUid!=i.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="");const o="move"==op(i.dataTransfer);if(o&&this._draggedRange&&this._draggedRange.containsRange(n,!0))return this._finalizeDragging(!1),void t.stop();i.targetRanges=[e.editing.mapper.toViewRange(n)]}),{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(ag);e.on("contentInsertion",((e,t)=>{if(!this.isEnabled||"drop"!==t.method)return;const i=t.targetRanges.map((e=>this.editor.editing.mapper.toModelRange(e)));this.editor.model.change((e=>e.setSelection(i)))}),{priority:"high"}),e.on("contentInsertion",((e,t)=>{if(!this.isEnabled||"drop"!==t.method)return;const i="move"==op(t.dataTransfer),n=!t.resultRange||!t.resultRange.isCollapsed;this._finalizeDragging(n&&i)}),{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"mousedown",((n,o)=>{if(Yt.ZP.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let s=rp(o.target);if(Yt.ZP.isBlink&&!e.isReadOnly&&!s&&!i.selection.isCollapsed){const e=i.selection.getSelectedElement();e&&pg(e)||(s=i.selection.editableElement)}s&&(t.change((e=>{e.setAttribute("draggable","true",s)})),this._draggableElement=e.editing.mapper.toModelElement(s))})),this.listenTo(i,"mouseup",(()=>{Yt.ZP.isAndroid||this._clearDraggableAttributesDelayed()}))}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change((t=>{this._draggableElement&&"$graveyard"!=this._draggableElement.root.rootName&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null}))}_setupDropMarker(){const e=this.editor;e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:i})=>{const n=e.model.schema.checkChild(t.markerRange.start,"$text");if(n)return i.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},(function(e){const t=this.toDomElement(e);return t.innerHTML="&NoBreak;<span></span>&NoBreak;",t}))}})}_updateDropMarker(e){const t=this.editor,i=t.model.markers;t.model.change((t=>{i.has("drop-target")?i.get("drop-target").getRange().isEqual(e)||t.updateMarker("drop-target",{range:e}):t.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})}))}_removeDropMarker(){const e=this.editor.model;this._removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),e.markers.has("drop-target")&&e.change((e=>{e.removeMarker("drop-target")}))}_finalizeDragging(e){const t=this.editor,i=t.model;this._removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._draggedRange&&(e&&this.isEnabled&&i.deleteContent(i.createSelection(this._draggedRange),{doNotAutoparagraph:!0}),this._draggedRange.detach(),this._draggedRange=null)}}function Qg(e,t,i){const n=e.model,o=e.editing.mapper;let s=null;const r=t?t[0].start:null;if(i.is("uiElement")&&(i=i.parent),s=Xg(e,i),s)return s;const a=np(e,i),l=r?o.toModelPosition(r):null;return l?(s=tp(e,l,a),s||(s=n.schema.getNearestSelectionRange(l,Yt.ZP.isGecko?"forward":"backward"),s||ip(e,l.parent))):ep(e,a)}function Xg(e,t){const i=e.model,n=e.editing.mapper;if(pg(t))return i.createRangeOn(n.toModelElement(t));if(!t.is("editableElement")){const e=t.findAncestor((e=>pg(e)||e.is("editableElement")));if(pg(e))return i.createRangeOn(n.toModelElement(e))}return null}function ep(e,t){const i=e.model,n=i.schema,o=i.createPositionAt(t,0);return n.getNearestSelectionRange(o,"forward")}function tp(e,t,i){const n=e.model;if(!n.schema.checkChild(i,"$block"))return null;const o=n.createPositionAt(i,0),s=t.path.slice(0,o.path.length),r=n.createPositionFromPath(t.root,s),a=r.nodeAfter;return a&&n.schema.isObject(a)?n.createRangeOn(a):null}function ip(e,t){const i=e.model;while(t){if(i.schema.isObject(t))return i.createRangeOn(t);t=t.parent}}function np(e,t){const i=e.editing.mapper,n=e.editing.view,o=i.toModelElement(t);if(o)return o;const s=n.createPositionBefore(t),r=i.findMappedViewAncestor(s);return i.toModelElement(r)}function op(e){return Yt.ZP.isGecko?e.dropEffect:["all","copyMove"].includes(e.effectAllowed)?"move":"copy"}function sp(e,t){let i;function n(...o){n.cancel(),i=setTimeout((()=>e(...o)),t)}return n.cancel=()=>{clearTimeout(i)},n}function rp(e){if(e.is("editableElement"))return null;if(e.hasClass("ck-widget__selection-handle"))return e.findAncestor(pg);if(pg(e))return e;const t=e.findAncestor((e=>pg(e)||e.is("editableElement")));return pg(t)?t:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ap extends a.Z{static get pluginName(){return"PastePlainText"}static get requires(){return[ag]}init(){const e=this.editor,t=e.model,i=e.editing.view,n=i.document,o=t.document.selection;let s=!1;i.addObserver(tg),this.listenTo(n,"keydown",((e,t)=>{s=t.shiftKey})),e.plugins.get(ag).on("contentInsertion",((e,i)=>{(s||lp(i.content,t.schema))&&t.change((e=>{const n=Array.from(o.getAttributes()).filter((([e])=>t.schema.getAttributeProperties(e).isFormatting));o.isCollapsed||t.deleteContent(o,{doNotAutoparagraph:!0}),n.push(...o.getAttributes());const s=e.createRangeIn(i.content);for(const t of s.getItems())t.is("$textProxy")&&e.setAttributes(n,t)}))}))}}function lp(e,t){if(e.childCount>1)return!1;const i=e.getChild(0);return!t.isObject(i)&&0==[...i.getAttributeKeys()].length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cp extends a.Z{static get pluginName(){return"Clipboard"}static get requires(){return[ag,Yg,ap]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dp extends b.Z{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let i=e.schema.getLimitElement(t);if(t.containsEntireContent(i)||!hp(e.schema,i))do{if(i=i.parent,!i)return}while(!hp(e.schema,i));e.change((e=>{e.setSelection(i,"in")}))}}function hp(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const up=(0,ct.Zz)("Ctrl+A");class mp extends a.Z{static get pluginName(){return"SelectAllEditing"}init(){const e=this.editor,t=e.editing.view,i=t.document;e.commands.add("selectAll",new dp(e)),this.listenTo(i,"keydown",((t,i)=>{(0,ct.Cq)(i)===up&&(e.execute("selectAll"),i.preventDefault())}))}}var gp='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pp extends a.Z{static get pluginName(){return"SelectAllUI"}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",(t=>{const i=e.commands.get("selectAll"),n=new l.Z(t),o=t.t;return n.set({label:o("Select all"),icon:gp,keystroke:"Ctrl+A",tooltip:!0}),n.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute("selectAll"),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fp extends a.Z{static get requires(){return[mp,pp]}static get pluginName(){return"SelectAll"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wp extends b.Z{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this.listenTo(e.data,"set",((e,t)=>{t[1]={...t[1]};const i=t[1];i.batchType||(i.batchType="transparent")}),{priority:"high"}),this.listenTo(e.data,"set",((e,t)=>{const i=t[1];"transparent"===i.batchType&&this.clearStack()}))}refresh(){this.isEnabled=this._stack.length>0}addBatch(e){const t=this.editor.model.document.selection,i={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:i}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,i){const n=this.editor.model,o=n.document,s=[],r=e.map((e=>e.getTransformedByOperations(i))),a=r.flat();for(const l of r){const e=l.filter((e=>e.root!=o.graveyard)).filter((e=>!vp(e,a)));e.length&&(bp(e),s.push(e[0]))}s.length&&n.change((e=>{e.setSelection(s,{backward:t})}))}_undo(e,t){const i=this.editor.model,n=i.document;this._createdBatches.add(t);const o=e.operations.slice().filter((e=>e.isDocumentOperation));o.reverse();for(const s of o){const e=s.baseVersion+1,o=Array.from(n.history.getOperations(e)),r=ch([s.getReversed()],o,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}),a=r.operationsA;for(const l of a)t.addOperation(l),i.applyOperation(l),n.history.setOperationAsUndone(s,l)}}}function bp(e){e.sort(((e,t)=>e.start.isBefore(t.start)?-1:1));for(let t=1;t<e.length;t++){const i=e[t-1],n=i.getJoined(e[t],!0);n&&(t--,e.splice(t,2,n))}}function vp(e,t){return t.some((t=>t!==e&&t.containsRange(e,!0)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _p extends wp{execute(e=null){const t=e?this._stack.findIndex((t=>t.batch==e)):this._stack.length-1,i=this._stack.splice(t,1)[0],n=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(n,(()=>{this._undo(i.batch,n);const e=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,e),this.fire("revert",i.batch,n)})),this.refresh()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yp extends wp{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(t,(()=>{const i=e.batch.operations[e.batch.operations.length-1],n=i.baseVersion+1,o=this.editor.model.document.history.getOperations(n);this._restoreSelection(e.selection.ranges,e.selection.isBackward,o),this._undo(e.batch,t)})),this.refresh()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kp extends a.Z{static get pluginName(){return"UndoEditing"}constructor(e){super(e),this._batchRegistry=new WeakSet}init(){const e=this.editor;this._undoCommand=new _p(e),this._redoCommand=new yp(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",((e,t)=>{const i=t[0];if(!i.isDocumentOperation)return;const n=i.batch,o=this._redoCommand._createdBatches.has(n),s=this._undoCommand._createdBatches.has(n),r=this._batchRegistry.has(n);r||"transparent"==n.type&&!o&&!s||(o?this._undoCommand.addBatch(n):s||(this._undoCommand.addBatch(n),this._redoCommand.clearStack()),this._batchRegistry.add(n))}),{priority:"highest"}),this.listenTo(this._undoCommand,"revert",((e,t,i)=>{this._redoCommand.addBatch(i)})),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}var Cp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',xp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vp extends a.Z{static get pluginName(){return"UndoUI"}init(){const e=this.editor,t=e.locale,i=e.t,n="ltr"==t.uiLanguageDirection?Cp:xp,o="ltr"==t.uiLanguageDirection?xp:Cp;this._addButton("undo",i("Undo"),"CTRL+Z",n),this._addButton("redo",i("Redo"),"CTRL+Y",o)}_addButton(e,t,i,n){const o=this.editor;o.ui.componentFactory.add(e,(s=>{const r=o.commands.get(e),a=new l.Z(s);return a.set({label:t,icon:n,keystroke:i,tooltip:!0}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",(()=>{o.execute(e),o.editing.view.focus()})),a}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ap extends a.Z{static get requires(){return[kp,Vp]}static get pluginName(){return"Undo"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ep extends a.Z{static get requires(){return[cp,lm,fp,gm,Cd,Ap]}static get pluginName(){return"Essentials"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tp extends cl.Z{constructor(e){super(e);const t=e.t;this.set("matchCount",0),this.set("highlightOffset",0),this.set("isDirty",!1),this.set("_areCommandsEnabled",{}),this.set("_resultsCounterText",""),this.set("_matchCase",!1),this.set("_wholeWordsOnly",!1),this.bind("_searchResultsFound").to(this,"matchCount",this,"isDirty",((e,t)=>e>0&&!t)),this._findInputView=this._createInputField(t("Find in text…")),this._replaceInputView=this._createInputField(t("Replace with…")),this._findButtonView=this._createButton({label:t("Find"),class:"ck-button-find ck-button-action",withText:!0}),this._findPrevButtonView=this._createButton({label:t("Previous result"),class:"ck-button-prev",icon:Uc,keystroke:"Shift+F3",tooltip:!0}),this._findNextButtonView=this._createButton({label:t("Next result"),class:"ck-button-next",icon:Uc,keystroke:"F3",tooltip:!0}),this._optionsDropdown=this._createOptionsDropdown(),this._replaceButtonView=this._createButton({label:t("Replace"),class:"ck-button-replace",withText:!0}),this._replaceAllButtonView=this._createButton({label:t("Replace all"),class:"ck-button-replaceall",withText:!0}),this._findFieldsetView=this._createFindFieldset(),this._replaceFieldsetView=this._createReplaceFieldset(),this._focusTracker=new en,this._keystrokes=new tn,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this._keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-find-and-replace-form"],tabindex:"-1"},children:[new Ic(e,{label:t("Find and replace")}),this._findFieldsetView,this._replaceFieldsetView]}),Dl(this)}render(){super.render(),Ml({view:this}),this._initFocusCycling(),this._initKeystrokeHandling()}destroy(){super.destroy(),this._focusTracker.destroy(),this._keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}reset(){this._findInputView.errorText=null,this.isDirty=!0}get _textToFind(){return this._findInputView.fieldView.element.value}get _textToReplace(){return this._replaceInputView.fieldView.element.value}_createFindFieldset(){const e=this.locale,t=new cl.Z(e);return this._findInputView.fieldView.on("input",(()=>{this.isDirty=!0})),this._findButtonView.on("execute",this._onFindButtonExecute.bind(this)),this._findPrevButtonView.delegate("execute").to(this,"findPrevious"),this._findNextButtonView.delegate("execute").to(this,"findNext"),this._findPrevButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",(({findPrevious:e})=>e)),this._findNextButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",(({findNext:e})=>e)),this._injectFindResultsCounter(),t.setTemplate({tag:"fieldset",attributes:{class:["ck","ck-find-and-replace-form__find"]},children:[this._findInputView,this._findButtonView,this._findPrevButtonView,this._findNextButtonView]}),t}_onFindButtonExecute(){if(this._textToFind)this.isDirty=!1,this.fire("findNext",{searchText:this._textToFind,matchCase:this._matchCase,wholeWords:this._wholeWordsOnly});else{const e=this.t;this._findInputView.errorText=e("Text to find must not be empty.")}}_injectFindResultsCounter(){const e=this.locale,t=e.t,i=this.bindTemplate,n=new cl.Z(e);this.bind("_resultsCounterText").to(this,"highlightOffset",this,"matchCount",((e,i)=>t("%0 of %1",[e,i]))),n.setTemplate({tag:"span",attributes:{class:["ck","ck-results-counter",i.if("isDirty","ck-hidden")]},children:[{text:i.to("_resultsCounterText")}]});const o=()=>{const t=this._findInputView.fieldView.element;if(!t||!t.offsetParent)return;const i=new Gi(n.element).width,o="ltr"===e.uiLanguageDirection?"paddingRight":"paddingLeft";t.style[o]=i?`calc( 2 * var(--ck-spacing-standard) + ${i}px )`:null};this.on("change:_resultsCounterText",o,{priority:"low"}),this.on("change:isDirty",o,{priority:"low"}),this._findInputView.template.children[0].children.push(n)}_createReplaceFieldset(){const e=this.locale,t=e.t,i=new cl.Z(e);return this._replaceButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replace:e},t)=>e&&t)),this._replaceAllButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replaceAll:e},t)=>e&&t)),this._replaceInputView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replace:e},t)=>e&&t)),this._replaceInputView.bind("infoText").to(this._replaceInputView,"isEnabled",this._replaceInputView,"isFocused",((e,i)=>e||!i?"":t("Tip: Find some text first in order to replace it."))),this._replaceButtonView.on("execute",(()=>{this.fire("replace",{searchText:this._textToFind,replaceText:this._textToReplace})})),this._replaceAllButtonView.on("execute",(()=>{this.fire("replaceAll",{searchText:this._textToFind,replaceText:this._textToReplace}),this.focus()})),i.setTemplate({tag:"fieldset",attributes:{class:["ck","ck-find-and-replace-form__replace"]},children:[this._replaceInputView,this._optionsDropdown,this._replaceButtonView,this._replaceAllButtonView]}),i}_createOptionsDropdown(){const e=this.locale,t=e.t,i=vc(e);i.class="ck-options-dropdown",i.buttonView.set({withText:!1,label:t("Show options"),icon:sl.cog,tooltip:!0});const n=new Lc({withText:!0,label:t("Match case"),_isMatchCaseSwitch:!0}),o=new Lc({withText:!0,label:t("Whole words only")});return n.bind("isOn").to(this,"_matchCase"),o.bind("isOn").to(this,"_wholeWordsOnly"),i.on("execute",(e=>{e.source._isMatchCaseSwitch?this._matchCase=!this._matchCase:this._wholeWordsOnly=!this._wholeWordsOnly,this.isDirty=!0})),yc(i,new T.Z([{type:"switchbutton",model:n},{type:"switchbutton",model:o}])),i}_initFocusCycling(){const e=[this._findInputView,this._findButtonView,this._findPrevButtonView,this._findNextButtonView,this._replaceInputView,this._optionsDropdown,this._replaceButtonView,this._replaceAllButtonView];e.forEach((e=>{this._focusables.add(e),this._focusTracker.add(e.element)}))}_initKeystrokeHandling(){const e=e=>e.stopPropagation(),t=e=>{e.stopPropagation(),e.preventDefault()};this._keystrokes.listenTo(this.element),this._keystrokes.set("f3",(e=>{t(e),this._findNextButtonView.fire("execute")})),this._keystrokes.set("shift+f3",(e=>{t(e),this._findPrevButtonView.fire("execute")})),this._keystrokes.set("enter",(e=>{const i=e.target;i===this._findInputView.fieldView.element?(this._areCommandsEnabled.findNext?this._findNextButtonView.fire("execute"):this._findButtonView.fire("execute"),t(e)):i!==this._replaceInputView.fieldView.element||this.isDirty||(this._replaceButtonView.fire("execute"),t(e))})),this._keystrokes.set("shift+enter",(e=>{const i=e.target;i===this._findInputView.fieldView.element&&(this._areCommandsEnabled.findPrevious?this._findPrevButtonView.fire("execute"):this._findButtonView.fire("execute"),t(e))})),this._keystrokes.set("arrowright",e),this._keystrokes.set("arrowleft",e),this._keystrokes.set("arrowup",e),this._keystrokes.set("arrowdown",e),this.listenTo(this._findInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"}),this.listenTo(this._replaceInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}_createButton(e){const t=new l.Z(this.locale);return t.set(e),t}_createInputField(e){const t=new Rc(this.locale,Dc);return t.label=e,t}}var Pp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 13.786 1.532-1.286 3.857 4.596a1 1 0 1 1-1.532 1.286l-3.857-4.596z"/><path d="M16.004 8.5a6.5 6.5 0 0 1-9.216 5.905c-1.154-.53-.863-1.415-.663-1.615.194-.194.564-.592 1.635-.141a4.5 4.5 0 0 0 5.89-5.904l-.104-.227 1.332-1.331c.045-.046.196-.041.224.007a6.47 6.47 0 0 1 .902 3.306zm-3.4-5.715c.562.305.742 1.106.354 1.494-.388.388-.995.414-1.476.178a4.5 4.5 0 0 0-6.086 5.882l.114.236-1.348 1.349c-.038.037-.17.022-.198-.023a6.5 6.5 0 0 1 5.54-9.9 6.469 6.469 0 0 1 3.1.784z"/><path d="M4.001 11.93.948 8.877a.2.2 0 0 1 .141-.341h6.106a.2.2 0 0 1 .141.341L4.283 11.93a.2.2 0 0 1-.282 0zm11.083-6.789 3.053 3.053a.2.2 0 0 1-.14.342H11.89a.2.2 0 0 1-.14-.342l3.052-3.053a.2.2 0 0 1 .282 0z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sp extends a.Z{static get pluginName(){return"FindAndReplaceUI"}constructor(e){super(e),this.formView=null}init(){const e=this.editor;e.ui.componentFactory.add("findAndReplace",(t=>{const i=vc(t),n=this.formView=new Tp(e.locale);return i.bind("isEnabled").to(e.commands.get("find")),i.panelView.children.add(n),i.on("change:isOpen",((e,t,i)=>{i?(n.disableCssTransitions(),n.reset(),n._findInputView.fieldView.select(),n.focus(),n.enableCssTransitions()):(n.focus(),this.fire("searchReseted"))}),{priority:"low"}),this._setupDropdownButton(i),this._setupFormView(n),i}))}_setupDropdownButton(e){const t=this.editor,i=t.locale.t;e.buttonView.set({icon:Pp,label:i("Find and replace"),keystroke:"CTRL+F",tooltip:!0}),t.keystrokes.set("Ctrl+F",((t,i)=>{e.isOpen=!0,i()}))}_setupFormView(e){const t=this.editor,i=t.commands,n=this.editor.plugins.get("FindAndReplaceEditing"),o=n.state,s={before:-1,same:0,after:1};e.bind("highlightOffset").to(o,"highlightedResult",(e=>e?Array.from(o.results).sort(((e,t)=>s[e.marker.getStart().compareWith(t.marker.getStart())])).indexOf(e)+1:0)),e.listenTo(o.results,"change",(()=>{e.matchCount=o.results.length})),e.bind("_areCommandsEnabled").to(i.get("findNext"),"isEnabled",i.get("findPrevious"),"isEnabled",i.get("replace"),"isEnabled",i.get("replaceAll"),"isEnabled",((e,t,i,n)=>({findNext:e,findPrevious:t,replace:i,replaceAll:n}))),e.delegate("findNext","findPrevious","replace","replaceAll").to(this),e.on("change:isDirty",((e,t,i)=>{i&&this.fire("searchReseted")}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ip(e,t,i,n){const o=n||new T.Z;return t.change((n=>{[...e].forEach((({type:e,item:s})=>{if("elementStart"===e&&t.schema.checkChild(s,"$text")){const e=i({item:s,text:Np(t.createRangeIn(s))});if(!e)return;e.forEach((e=>{const t=`findResult:${(0,on.Z)()}`,i=n.addMarker(t,{usingOperation:!1,affectsData:!1,range:n.createRange(n.createPositionAt(s,e.start),n.createPositionAt(s,e.end))}),r=Bp(o,i);o.add({id:t,label:e.label,marker:i},r)}))}}))})),o}function Np(e){return Array.from(e.getItems()).reduce(((e,t)=>t.is("text")||t.is("textProxy")?e+t.data:`${e}\n`),"")}function Bp(e,t){const i=e.find((({marker:e})=>t.getStart().isBefore(e.getStart())));return i?e.getIndex(i):e.length}function Rp(e){const t=e.length-1;let i=e.index;return 3===e.length&&(i+=e[1].length),{label:e[t],start:i,end:i+e[t].length}}function Dp(e,t){let i="gu";t.matchCase||(i+="i");let n=`(${Md(e)})`;if(t.wholeWords){const t="[^a-zA-ZÀ-ɏḀ-ỿ]";new RegExp("^"+t).test(e)||(n=`(^|${t}|_)${n}`),new RegExp(t+"$").test(e)||(n=`${n}(?=_|${t}|$)`)}const o=new RegExp(n,i);function s({text:e}){const t=[...e.matchAll(o)];return t.map(Rp)}return s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mp extends b.Z{constructor(e,t){super(e),this.isEnabled=!0,this.affectsData=!1,this._state=t}execute(e,{matchCase:t,wholeWords:i}={}){const{editor:n}=this,{model:o}=n;let s;"string"===typeof e?(s=Dp(e,{matchCase:t,wholeWords:i}),this._state.searchText=e):s=e;const r=o.document.getRootNames().reduce(((e,t)=>Ip(o.createRangeIn(o.document.getRoot(t)),o,s,e)),null);return this._state.clear(o),this._state.results.addMany(Array.from(r)),this._state.highlightedResult=r.get(0),"string"===typeof e&&(this._state.searchText=e),this._state.matchCase=!!t,this._state.matchWholeWords=!!i,{results:r,findCallback:s}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Op extends b.Z{constructor(e,t){super(e),this.isEnabled=!0,this._state=t}execute(e,t){const{model:i}=this.editor;i.change((n=>{const o=t.marker.getRange();if("$graveyard"===o.root.rootName)return void this._state.results.remove(t);let s={};for(const e of o.getItems())if(e.is("$text")||e.is("$textProxy")){s=e.getAttributes();break}i.insertContent(n.createText(e,s),o),this._state.results.has(t)&&this._state.results.remove(t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lp extends Op{execute(e,t){const{editor:i}=this,{model:n}=i,o=t instanceof T.Z?t:n.document.getRootNames().reduce(((e,i)=>Ip(n.createRangeIn(n.document.getRoot(i)),n,Dp(t,this._state),e)),null);o.length&&n.change((()=>{[...o].forEach((t=>{super.execute(e,t)}))}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fp extends b.Z{constructor(e,t){super(e),this.affectsData=!1,this._state=t,this.isEnabled=!1,this.listenTo(this._state.results,"change",(()=>{this.isEnabled=this._state.results.length>1}))}refresh(){this.isEnabled=this._state.results.length>1}execute(){const e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t+1>=e.length?0:t+1;this._state.highlightedResult=this._state.results.get(i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zp extends Fp{execute(){const e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t-1<0?this._state.results.length-1:t-1;this._state.highlightedResult=this._state.results.get(i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $p{constructor(e){this.set("results",new T.Z),this.set("highlightedResult",null),this.set("searchText",""),this.set("replaceText",""),this.set("matchCase",!1),this.set("matchWholeWords",!1),this.results.on("change",((t,{removed:i,index:n})=>{if(i=Array.from(i),i.length){let t=!1;if(e.change((n=>{for(const o of i)this.highlightedResult===o&&(t=!0),e.markers.has(o.marker.name)&&n.removeMarker(o.marker)})),t){const e=n>=this.results.length?0:n;this.highlightedResult=this.results.get(e)}}}))}clear(e){this.searchText="",e.change((t=>{if(this.highlightedResult){const i=this.highlightedResult.marker.name.split(":")[1],n=e.markers.get(`findResultHighlighted:${i}`);n&&t.removeMarker(n)}[...this.results].forEach((({marker:e})=>{t.removeMarker(e)}))})),this.results.clear()}}(0,I.Z)($p,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Zp="ck-find-result_selected";function Wp(e,t,i){const n=new Set,o=new Set,s=t.document.differ.getChanges();s.forEach((e=>{"$text"===e.name||t.schema.isInline(e.position.nodeAfter)?(n.add(e.position.parent),[...t.markers.getMarkersAtPosition(e.position)].forEach((e=>{o.add(e.name)}))):"insert"===e.type&&n.add(e.position.nodeAfter)})),t.document.differ.getChangedMarkers().forEach((({name:e,data:{newRange:t}})=>{t&&"$graveyard"===t.start.root.rootName&&o.add(e)})),n.forEach((e=>{const i=[...t.markers.getMarkersIntersectingRange(t.createRangeIn(e))];i.forEach((e=>o.add(e.name)))})),t.change((t=>{o.forEach((i=>{e.has(i)&&e.remove(i),t.removeMarker(i)}))})),n.forEach((n=>{Ip(t.createRangeOn(n),t,i,e)}))}class Hp extends a.Z{static get pluginName(){return"FindAndReplaceEditing"}init(){this._activeResults=null,this.state=new $p(this.editor.model),this._defineConverters(),this._defineCommands(),this.listenTo(this.state,"change:highlightedResult",((e,t,i,n)=>{const{model:o}=this.editor;o.change((e=>{if(n){const t=n.marker.name.split(":")[1],i=o.markers.get(`findResultHighlighted:${t}`);i&&e.removeMarker(i)}if(i){const t=i.marker.name.split(":")[1];e.addMarker(`findResultHighlighted:${t}`,{usingOperation:!1,affectsData:!1,range:i.marker.getRange()})}}))}));const e=(0,Pi.Z)(t.bind(this),32);function t(e,t,i){if(i){const e=this.editor.editing.view.domConverter,t=this.editor.editing.mapper.toViewRange(i.marker.getRange());an({target:e.viewRangeToDom(t),viewportOffset:40})}}this.listenTo(this.state,"change:highlightedResult",e,{priority:"low"}),this.listenTo(this.editor,"destroy",e.cancel)}find(e){const{editor:t}=this,{model:i}=t,{findCallback:n,results:o}=t.execute("find",e);return this._activeResults=o,this.listenTo(i.document,"change:data",(()=>Wp(this._activeResults,i,n))),this._activeResults}stop(){this._activeResults&&(this.stopListening(this.editor.model.document),this.state.clear(this.editor.model),this._activeResults=null)}_defineCommands(){this.editor.commands.add("find",new Mp(this.editor,this.state)),this.editor.commands.add("findNext",new Fp(this.editor,this.state)),this.editor.commands.add("findPrevious",new zp(this.editor,this.state)),this.editor.commands.add("replace",new Op(this.editor,this.state)),this.editor.commands.add("replaceAll",new Lp(this.editor,this.state))}_defineConverters(){const{editor:e}=this;e.conversion.for("editingDowncast").markerToHighlight({model:"findResult",view:({markerName:e})=>{const[,t]=e.split(":");return{name:"span",classes:["ck-find-result"],attributes:{"data-find-result":t}}}}),e.conversion.for("editingDowncast").markerToHighlight({model:"findResultHighlighted",view:({markerName:e})=>{const[,t]=e.split(":");return{name:"span",classes:[Zp],attributes:{"data-find-result":t}}}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Up extends a.Z{static get requires(){return[Hp,Sp]}static get pluginName(){return"FindAndReplace"}init(){const e=this.editor.plugins.get("FindAndReplaceUI"),t=this.editor.plugins.get("FindAndReplaceEditing"),i=t.state;e.on("findNext",((e,t)=>{t?(i.searchText=t.searchText,this.editor.execute("find",t.searchText,t)):this.editor.execute("findNext")})),e.on("findPrevious",((e,t)=>{t&&i.searchText!==t.searchText?this.editor.execute("find",t.searchText):this.editor.execute("findPrevious")})),e.on("replace",((e,t)=>{i.searchText!==t.searchText&&this.editor.execute("find",t.searchText);const n=i.highlightedResult;n&&this.editor.execute("replace",t.replaceText,n)})),e.on("replaceAll",((e,t)=>{i.searchText!==t.searchText&&this.editor.execute("find",t.searchText),this.editor.execute("replaceAll",t.replaceText,i.results)})),e.on("searchReseted",(()=>{i.clear(this.editor.model),t.stop()}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qp extends b.Z{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document,n=i.selection,o=e.value;t.change((e=>{if(n.isCollapsed)o?e.setSelectionAttribute(this.attributeKey,o):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const t of i)o?e.setAttribute(this.attributeKey,o,t):e.removeAttribute(this.attributeKey,t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gp extends T.Z{constructor(e){super(e),this.set("isEmpty",!0),this.on("change",(()=>{this.set("isEmpty",0===this.length)}))}add(e,t){this.find((t=>t.color===e.color))||super.add(e,t)}hasColor(e){return!!this.find((t=>t.color===e))}}(0,I.Z)(Gp,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jp extends cl.Z{constructor(e,{colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:s}){super(e),this.items=this.createCollection(),this.colorDefinitions=t,this.focusTracker=new en,this.keystrokes=new tn,this.set("selectedColor"),this.removeButtonLabel=n,this.columns=i,this.documentColors=new Gp,this.documentColorsCount=s,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-table"]},children:this.items}),this.items.add(this._removeColorButton())}updateDocumentColors(e,t){const i=e.document,n=this.documentColorsCount;this.documentColors.clear();for(const o of i.getRootNames()){const s=i.getRoot(o),r=e.createRangeIn(s);for(const e of r.getItems())if(e.is("$textProxy")&&e.hasAttribute(t)&&(this._addColorToDocumentColors(e.getAttribute(t)),this.documentColors.length>=n))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,i=this.selectedColor;t.selectedColor=i,e&&(e.selectedColor=i)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendGrids(){if(!this.staticColorsGrid&&(this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount)){const e=Ol.ZP.bind(this.documentColors,this.documentColors),t=new Ec(this.locale);t.text=this._documentColorsLabel,t.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_removeColorButton(){const e=new l.Z;return e.set({withText:!0,icon:sl.eraser,tooltip:!0,label:this.removeButtonLabel}),e.class="ck-color-table__remove-color",e.on("execute",(()=>{this.fire("execute",{value:null})})),e}_createStaticColorsGrid(){const e=new jl(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.delegate("execute").to(this),e}_createDocumentColorsGrid(){const e=Ol.ZP.bind(this.documentColors,this.documentColors),t=new jl(this.locale,{columns:this.columns});return t.delegate("execute").to(this),t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using((e=>{const t=new Ul;return t.set({color:e.color,hasBorder:e.options&&e.options.hasBorder}),e.label&&t.set({label:e.label,tooltip:!0}),t.on("execute",(()=>{this.fire("execute",{value:e.color})})),t})),this.documentColors.on("change:isEmpty",((e,i,n)=>{n&&(t.selectedColor=null)})),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find((t=>t.color===e));t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Kp="fontSize",Jp="fontFamily",Yp="fontColor",Qp="fontBackgroundColor";function Xp(e,t){const i={model:{key:e,values:[]},view:{},upcastAlso:{}};for(const n of t)i.model.values.push(n.model),i.view[n.model]=n.view,n.upcastAlso&&(i.upcastAlso[n.model]=n.upcastAlso);return i}function ef(e){return t=>of(t.getStyle(e))}function tf(e){return(t,{writer:i})=>i.createAttributeElement("span",{style:`${e}:${t}`},{priority:7})}function nf({dropdownView:e,colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:s}){const r=e.locale,a=new jp(r,{colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:s});return e.colorTableView=a,e.panelView.children.add(a),a.delegate("execute").to(e,"execute"),a}function of(e){return e.replace(/\s/g,"")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sf extends qp{constructor(e){super(e,Jp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function rf(e){return e.map(af).filter((e=>!!e))}function af(e){return"object"===typeof e?e:"default"===e?{title:"Default",model:void 0}:"string"===typeof e?lf(e):void 0}function lf(e){const t=e.replace(/"|'/g,"").split(","),i=t[0],n=t.map(cf).join(", ");return{title:i,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}function cf(e){return e=e.trim(),e.indexOf(" ")>0&&(e=`'${e}'`),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class df extends a.Z{static get pluginName(){return"FontFamilyEditing"}constructor(e){super(e),e.config.define(Jp,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Jp}),e.model.schema.setAttributeProperties(Jp,{isFormatting:!0,copyOnEnter:!0});const t=rf(e.config.get("fontFamily.options")).filter((e=>e.model)),i=Xp(Jp,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(i),e.commands.add(Jp,new sf(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:Jp,view:(e,{writer:t})=>t.createAttributeElement("span",{style:"font-family:"+e},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:Jp,value:e=>e.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){const e=this.editor;e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:Jp,value:e=>e.getAttribute("face")}})}}var hf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uf extends a.Z{static get pluginName(){return"FontFamilyUI"}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),n=e.commands.get(Jp);e.ui.componentFactory.add(Jp,(o=>{const s=vc(o);return yc(s,mf(i,n)),s.buttonView.set({label:t("Font Family"),icon:hf,tooltip:!0}),s.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),s.bind("isEnabled").to(n),this.listenTo(s,"execute",(t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()})),s}))}_getLocalizedOptions(){const e=this.editor,t=e.t,i=rf(e.config.get(Jp).options);return i.map((e=>("Default"===e.title&&(e.title=t("Default")),e)))}}function mf(e,t){const i=new T.Z;for(const n of e){const e={type:"button",model:new Lc({commandName:Jp,commandParam:n.model,label:n.title,withText:!0})};e.model.bind("isOn").to(t,"value",(e=>e===n.model||!(!e||!n.model)&&e.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase())),n.view&&n.view.styles&&e.model.set("labelStyle",`font-family: ${n.view.styles["font-family"]}`),i.add(e)}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gf extends a.Z{static get requires(){return[df,uf]}static get pluginName(){return"FontFamily"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pf extends qp{constructor(e){super(e,Kp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ff(e){return e.map((e=>bf(e))).filter((e=>!!e))}const wf={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function bf(e){if(kf(e))return _f(e);const t=yf(e);return t?_f(t):"default"===e?{model:void 0,title:"Default"}:Cf(e)?void 0:vf(e)}function vf(e){return"number"!==typeof e&&"string"!==typeof e||(e={title:String(e),model:`${parseFloat(e)}px`}),e.view={name:"span",styles:{"font-size":e.model}},_f(e)}function _f(e){return e.view.priority||(e.view.priority=7),e}function yf(e){return wf[e]||wf[e.model]}function kf(e){return"object"===typeof e&&e.title&&e.model&&e.view}function Cf(e){let t;if("object"===typeof e){if(!e.model)throw new P.ZP("font-size-invalid-definition",null,e);t=parseFloat(e.model)}else t=parseFloat(e);return isNaN(t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xf=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class Vf extends a.Z{static get pluginName(){return"FontSizeEditing"}constructor(e){super(e),e.config.define(Kp,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Kp}),e.model.schema.setAttributeProperties(Kp,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),i=ff(this.editor.config.get("fontSize.options")).filter((e=>e.model)),n=Xp(Kp,i);t?(this._prepareAnyValueConverters(n),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(n),e.commands.add(Kp,new pf(e))}_prepareAnyValueConverters(e){const t=this.editor,i=e.model.values.filter((e=>!Sh(String(e))&&!Nh(String(e))));if(i.length)throw new P.ZP("font-size-invalid-use-of-named-presets",null,{presets:i});t.conversion.for("downcast").attributeToElement({model:Kp,view:(e,{writer:t})=>{if(e)return t.createAttributeElement("span",{style:"font-size:"+e},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:Kp,value:e=>e.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){const e=this.editor;e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:Kp,value:e=>{const t=e.getAttribute("size"),i="-"===t[0]||"+"===t[0];let n=parseInt(t,10);i&&(n=3+n);const o=xf.length-1,s=Math.min(Math.max(n,0),o);return xf[s]}}})}}var Af='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ef extends a.Z{static get pluginName(){return"FontSizeUI"}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),n=e.commands.get(Kp);e.ui.componentFactory.add(Kp,(o=>{const s=vc(o);return yc(s,Tf(i,n)),s.buttonView.set({label:t("Font Size"),icon:Af,tooltip:!0}),s.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),s.bind("isEnabled").to(n),this.listenTo(s,"execute",(t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()})),s}))}_getLocalizedOptions(){const e=this.editor,t=e.t,i={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")},n=ff(e.config.get(Kp).options);return n.map((e=>{const t=i[e.title];return t&&t!=e.title&&(e=Object.assign({},e,{title:t})),e}))}}function Tf(e,t){const i=new T.Z;for(const n of e){const e={type:"button",model:new Lc({commandName:Kp,commandParam:n.model,label:n.title,class:"ck-fontsize-option",withText:!0})};n.view&&n.view.styles&&e.model.set("labelStyle",`font-size:${n.view.styles["font-size"]}`),n.view&&n.view.classes&&e.model.set("class",`${e.model.class} ${n.view.classes}`),e.model.bind("isOn").to(t,"value",(e=>e===n.model)),i.add(e)}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pf extends a.Z{static get requires(){return[Vf,Ef]}static get pluginName(){return"FontSize"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sf extends qp{constructor(e){super(e,Yp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class If extends a.Z{static get pluginName(){return"FontColorEditing"}constructor(e){super(e),e.config.define(Yp,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:Yp,value:ef("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:Yp,value:e=>e.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:Yp,view:tf("color")}),e.commands.add(Yp,new Sf(e)),e.model.schema.extend("$text",{allowAttributes:Yp}),e.model.schema.setAttributeProperties(Yp,{isFormatting:!0,copyOnEnter:!0})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nf extends a.Z{constructor(e,{commandName:t,icon:i,componentName:n,dropdownLabel:o}){super(e),this.commandName=t,this.componentName=n,this.icon=i,this.dropdownLabel=o,this.columns=e.config.get(`${this.componentName}.columns`),this.colorTableView=void 0}init(){const e=this.editor,t=e.locale,i=t.t,n=e.commands.get(this.commandName),o=Zl(e.config.get(this.componentName).colors),s=$l(t,o),r=e.config.get(`${this.componentName}.documentColors`);e.ui.componentFactory.add(this.componentName,(t=>{const o=vc(t);return this.colorTableView=nf({dropdownView:o,colors:s.map((e=>({label:e.label,color:e.model,options:{hasBorder:e.hasBorder}}))),columns:this.columns,removeButtonLabel:i("Remove color"),documentColorsLabel:0!==r?i("Document colors"):void 0,documentColorsCount:void 0===r?this.columns:r}),this.colorTableView.bind("selectedColor").to(n,"value"),o.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),o.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),o.bind("isEnabled").to(n),o.on("execute",((t,i)=>{e.execute(this.commandName,i),e.editing.view.focus()})),o.on("change:isOpen",((t,i,n)=>{o.colorTableView.appendGrids(),n&&(0!==r&&this.colorTableView.updateDocumentColors(e.model,this.componentName),this.colorTableView.updateSelectedColors())})),o}))}}var Bf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rf extends Nf{constructor(e){const t=e.locale.t;super(e,{commandName:Yp,componentName:Yp,icon:Bf,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Df extends a.Z{static get requires(){return[If,Rf]}static get pluginName(){return"FontColor"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mf extends qp{constructor(e){super(e,Qp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Of extends a.Z{static get pluginName(){return"FontBackgroundColorEditing"}constructor(e){super(e),e.config.define(Qp,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(qh),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:Qp,value:ef("background-color")}}),e.conversion.for("downcast").attributeToElement({model:Qp,view:tf("background-color")}),e.commands.add(Qp,new Mf(e)),e.model.schema.extend("$text",{allowAttributes:Qp}),e.model.schema.setAttributeProperties(Qp,{isFormatting:!0,copyOnEnter:!0})}}var Lf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ff extends Nf{constructor(e){const t=e.locale.t;super(e,{commandName:Qp,componentName:Qp,icon:Lf,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zf extends a.Z{static get requires(){return[Of,Ff]}static get pluginName(){return"FontBackgroundColor"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $f extends a.Z{static get requires(){return[gf,Pf,Df,zf]}static get pluginName(){return"Font"}}var Zf=i(52012);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wf extends b.Z{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some((t=>Hf(e,t,this.editor.model.schema)))}execute(e){const t=this.editor.model,i=t.document,n=e.value;t.change((e=>{const o=Array.from(i.selection.getSelectedBlocks()).filter((e=>Hf(e,n,t.schema)));for(const t of o)t.is("element",n)||e.rename(t,n)}))}}function Hf(e,t,i){return i.checkChild(e.parent,t)&&!i.isObject(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Uf="paragraph";class qf extends a.Z{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Zf.Paragraph]}init(){const e=this.editor,t=e.config.get("heading.options"),i=[];for(const n of t)n.model!==Uf&&(e.model.schema.register(n.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(n),i.push(n.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new Wf(e,i))}afterInit(){const e=this.editor,t=e.commands.get("enter"),i=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",((t,n)=>{const o=e.model.document.selection.getFirstPosition().parent,s=i.some((e=>o.is("element",e.model)));s&&!o.is("element",Uf)&&0===o.childCount&&n.writer.rename(o,Uf)}))}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:nn.Z.get("low")+1})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gf(e){const t=e.t,i={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return e.config.get("heading.options").map((e=>{const t=i[e.title];return t&&t!=e.title&&(e.title=t),e}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jf extends a.Z{static get pluginName(){return"HeadingUI"}init(){const e=this.editor,t=e.t,i=Gf(e),n=t("Choose heading"),o=t("Heading");e.ui.componentFactory.add("heading",(t=>{const s={},r=new T.Z,a=e.commands.get("heading"),l=e.commands.get("paragraph"),c=[a];for(const e of i){const t={type:"button",model:new Lc({label:e.title,class:e.class,withText:!0})};"paragraph"===e.model?(t.model.bind("isOn").to(l,"value"),t.model.set("commandName","paragraph"),c.push(l)):(t.model.bind("isOn").to(a,"value",(t=>t===e.model)),t.model.set({commandName:"heading",commandValue:e.model})),r.add(t),s[e.model]=e.title}const d=vc(t);return yc(d,r),d.buttonView.set({isOn:!1,withText:!0,tooltip:o}),d.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),d.bind("isEnabled").toMany(c,"isEnabled",((...e)=>e.some((e=>e)))),d.buttonView.bind("label").to(a,"value",l,"value",((e,t)=>{const i=e||t&&"paragraph";return s[i]?s[i]:n})),this.listenTo(d,"execute",(t=>{e.execute(t.source.commandName,t.source.commandValue?{value:t.source.commandValue}:void 0),e.editing.view.focus()})),d}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kf extends a.Z{static get requires(){return[qf,jf]}static get pluginName(){return"Heading"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jf extends a.Z{static get requires(){return[jc]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",(t=>{Xf(e.editing.view.document.selection)&&t.stop()}),{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui,"update",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui.focusTracker,"change:isFocused",(()=>{this._updateToolbarsVisibility()}),{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:i,getRelatedElement:n,balloonClassName:o="ck-toolbar-container"}){if(!i.length)return void(0,P.KE)("widget-toolbar-no-items",{toolbarId:e});const s=this.editor,r=s.t,a=new uc(s.locale);if(a.ariaLabel=t||r("Widget toolbar"),this._toolbarDefinitions.has(e))throw new P.ZP("widget-toolbar-duplicated",this,{toolbarId:e});a.fillFromConfig(i,s.ui.componentFactory),this._toolbarDefinitions.set(e,{view:a,getRelatedElement:n,balloonClassName:o})}_updateToolbarsVisibility(){let e=0,t=null,i=null;for(const n of this._toolbarDefinitions.values()){const o=n.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&o)if(this.editor.ui.focusTracker.isFocused){const s=o.getAncestors().length;s>e&&(e=s,t=o,i=n)}else this._isToolbarVisible(n)&&this._hideToolbar(n);else this._isToolbarInBalloon(n)&&this._hideToolbar(n)}i&&this._showToolbar(i,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?Yf(this.editor,t):this._isToolbarInBalloon(e)||(this._balloon.add({view:e.view,position:Qf(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",(()=>{for(const e of this._toolbarDefinitions.values())if(this._isToolbarVisible(e)){const t=e.getRelatedElement(this.editor.editing.view.document.selection);Yf(this.editor,t)}})))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function Yf(e,t){const i=e.plugins.get("ContextualBalloon"),n=Qf(e,t);i.updatePosition(n)}function Qf(e,t){const i=e.editing.view,n=Zc.defaultPositions;return{target:i.domConverter.mapViewToDom(t),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}function Xf(e){const t=e.getSelectedElement();return!(!t||!pg(t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ew{constructor(e){this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}begin(e,t,i){const n=new Gi(t);this.activeHandlePosition=ow(e),this._referenceCoordinates=iw(t,sw(this.activeHandlePosition)),this.originalWidth=n.width,this.originalHeight=n.height,this.aspectRatio=n.width/n.height;const o=i.style.width;o&&o.match(/^\d+(\.\d*)?%$/)?this.originalWidthPercents=parseFloat(o):this.originalWidthPercents=tw(i,n)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function tw(e,t){const i=e.parentElement,n=parseFloat(i.ownerDocument.defaultView.getComputedStyle(i).width);return t.width/n*100}function iw(e,t){const i=new Gi(e),n=t.split("-"),o={x:"right"==n[1]?i.right:i.left,y:"bottom"==n[0]?i.bottom:i.top};return o.x+=e.ownerDocument.defaultView.scrollX,o.y+=e.ownerDocument.defaultView.scrollY,o}function nw(e){return`ck-widget__resizer__handle-${e}`}function ow(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const i of t)if(e.classList.contains(nw(i)))return i}function sw(e){const t=e.split("-"),i={top:"bottom",bottom:"top",left:"right",right:"left"};return`${i[t[0]]}-${i[t[1]]}`}(0,I.Z)(ew,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rw extends cl.Z{constructor(){super();const e=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",e.to("_viewPosition",(e=>e?`ck-orientation-${e}`:""))],style:{display:e.if("_isVisible","none",(e=>!e))}},children:[{text:e.to("_label")}]})}_bindToState(e,t){this.bind("_isVisible").to(t,"proposedWidth",t,"proposedHeight",((e,t)=>null!==e&&null!==t)),this.bind("_label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",((t,i,n)=>"px"===e.unit?`${t}×${i}`:`${n}%`)),this.bind("_viewPosition").to(t,"activeHandlePosition",t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",((e,t,i)=>t<50||i<50?"above-center":e))}_dismiss(){this.unbind(),this._isVisible=!1}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class aw{constructor(e){this._options=e,this._viewResizerWrapper=null,this.set("isEnabled",!0),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",(e=>{this.state.proposedWidth||this.state.proposedWidthPercents||(this._cleanup(),e.stop())}),{priority:"high"}),this.on("change:isEnabled",(()=>{this.isEnabled&&this.redraw()}))}attach(){const e=this,t=this._options.viewElement,i=this._options.editor.editing.view;i.change((i=>{const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},(function(t){const i=this.toDomElement(t);return e._appendHandles(i),e._appendSizeUI(i),e.on("change:isEnabled",((e,t,n)=>{i.style.display=n?"":"none"})),i.style.display=e.isEnabled?"":"none",i}));i.insert(i.createPositionAt(t,"end"),n),i.addClass("ck-widget_with-resizer",t),this._viewResizerWrapper=n}))}begin(e){this.state=new ew(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const t=this._proposeNewSize(e),i=this._options.editor.editing.view;i.change((e=>{const i=this._options.unit||"%",n=("%"===i?t.widthPercents:t.width)+i;e.setStyle("width",n,this._options.viewElement)}));const n=this._getHandleHost(),o=new Gi(n);t.handleHostWidth=Math.round(o.width),t.handleHostHeight=Math.round(o.height);const s=new Gi(n);t.width=Math.round(s.width),t.height=Math.round(s.height),this.redraw(o),this.state.update(t)}commit(){const e=this._options.unit||"%",t=("%"===e?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change((()=>{this._cleanup(),this._options.onCommit(t)}))}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const t=this._domResizerWrapper;if(!dw(t))return;const i=t.parentElement,n=this._getHandleHost(),o=this._viewResizerWrapper,s=[o.getStyle("width"),o.getStyle("height"),o.getStyle("left"),o.getStyle("top")];let r;if(i.isSameNode(n)){const t=e||new Gi(n);r=[t.width+"px",t.height+"px",void 0,void 0]}else r=[n.offsetWidth+"px",n.offsetHeight+"px",n.offsetLeft+"px",n.offsetTop+"px"];"same"!==H(s,r)&&this._options.editor.editing.view.change((e=>{e.setStyle({width:r[0],height:r[1],left:r[2],top:r[3]},o)}))}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss();const e=this._options.editor.editing.view;e.change((e=>{e.setStyle("width",this._initialViewWidth,this._options.viewElement)}))}_proposeNewSize(e){const t=this.state,i=cw(e),n=!this._options.isCentered||this._options.isCentered(this),o={x:t._referenceCoordinates.x-(i.x+t.originalWidth),y:i.y-t.originalHeight-t._referenceCoordinates.y};n&&t.activeHandlePosition.endsWith("-right")&&(o.x=i.x-(t._referenceCoordinates.x+t.originalWidth)),n&&(o.x*=2);const s={width:Math.abs(t.originalWidth+o.x),height:Math.abs(t.originalHeight+o.y)};s.dominant=s.width/t.aspectRatio>s.height?"width":"height",s.max=s[s.dominant];const r={width:s.width,height:s.height};return"width"==s.dominant?r.height=r.width/t.aspectRatio:r.width=r.height*t.aspectRatio,{width:Math.round(r.width),height:Math.round(r.height),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*r.width*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const i of t)e.appendChild(new Ol.ZP({tag:"div",attributes:{class:`ck-widget__resizer__handle ${lw(i)}`}}).render())}_appendSizeUI(e){this._sizeView=new rw,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function lw(e){return`ck-widget__resizer__handle-${e}`}function cw(e){return{x:e.pageX,y:e.pageY}}function dw(e){return e&&e.ownerDocument&&e.ownerDocument.contains(e)}(0,I.Z)(aw,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hw extends a.Z{static get pluginName(){return"WidgetResize"}init(){const e=this.editor.editing,t=ri.window.document;this.set("visibleResizer",null),this.set("_activeResizer",null),this._resizers=new Map,e.view.addObserver(bh),this._observer=Object.create(vi.Z),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this));const i=()=>{this.visibleResizer&&this.visibleResizer.redraw()};this._redrawFocusedResizerThrottled=(0,Jg.Z)(i,200),this.on("change:visibleResizer",i),this.editor.ui.on("update",this._redrawFocusedResizerThrottled),this.editor.model.document.on("change",(()=>{for(const[e,t]of this._resizers)e.isAttached()||(this._resizers.delete(e),t.destroy())}),{priority:"lowest"}),this._observer.listenTo(ri.window,"resize",this._redrawFocusedResizerThrottled);const n=this.editor.editing.view.document.selection;n.on("change",(()=>{const e=n.getSelectedElement();this.visibleResizer=this.getResizerByViewElement(e)||null}))}destroy(){this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawFocusedResizerThrottled.cancel()}attachTo(e){const t=new aw(e),i=this.editor.plugins;if(t.attach(),i.has("WidgetToolbarRepository")){const e=i.get("WidgetToolbarRepository");t.on("begin",(()=>{e.forceDisabled("resize")}),{priority:"lowest"}),t.on("cancel",(()=>{e.clearForceDisabled("resize")}),{priority:"highest"}),t.on("commit",(()=>{e.clearForceDisabled("resize")}),{priority:"highest"})}this._resizers.set(e.viewElement,t);const n=this.editor.editing.view.document.selection,o=n.getSelectedElement();return this.getResizerByViewElement(o)==t&&(this.visibleResizer=t),t}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const t of this._resizers.values())if(t.containsHandle(e))return t}_mouseDownListener(e,t){const i=t.domTarget;aw.isResizeHandle(i)&&(this._activeResizer=this._getResizerByHandle(i),this._activeResizer&&(this._activeResizer.begin(i),e.stop(),t.preventDefault()))}_mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}(0,I.Z)(hw,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uw extends b.Z{refresh(){const e=this.editor.model,t=e.schema,i=e.document.selection;this.isEnabled=mw(i,t,e)}execute(){const e=this.editor.model;e.change((t=>{const i=t.createElement("horizontalLine");e.insertContent(i);let n=i.nextSibling;const o=n&&e.schema.checkChild(n,"$text");!o&&e.schema.checkChild(i.parent,"paragraph")&&(n=t.createElement("paragraph"),e.insertContent(n,t.createPositionAfter(i))),n&&t.setSelection(n,0)}))}}function mw(e,t,i){const n=gw(e,i);return t.checkChild(n,"horizontalLine")}function gw(e,t){const i=Cg(e,t),n=i.start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pw extends a.Z{static get pluginName(){return"HorizontalLineEditing"}init(){const e=this.editor,t=e.model.schema,i=e.t,n=e.conversion;t.register("horizontalLine",{isObject:!0,allowWhere:"$block"}),n.for("dataDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>t.createEmptyElement("hr")}),n.for("editingDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>{const n=i("Horizontal line"),o=t.createContainerElement("div"),s=t.createEmptyElement("hr");return t.addClass("ck-horizontal-line",o),t.setCustomProperty("hr",!0,o),t.insert(t.createPositionAt(o,0),s),fw(o,t,n)}}),n.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),e.commands.add("horizontalLine",new uw(e))}}function fw(e,t,i){return t.setCustomProperty("horizontalLine",!0,e),fg(e,t,{label:i})}var ww='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bw extends a.Z{static get pluginName(){return"HorizontalLineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("horizontalLine",(i=>{const n=e.commands.get("horizontalLine"),o=new l.Z(i);return o.set({label:t("Horizontal line"),icon:ww,tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",(()=>{e.execute("horizontalLine"),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vw extends a.Z{static get requires(){return[pw,bw,Gg]}static get pluginName(){return"HorizontalLine"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _w extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled&&i.hasAttribute("alt")?this.value=i.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor,i=t.plugins.get("ImageUtils"),n=t.model,o=i.getClosestSelectedImageElement(n.document.selection);n.change((t=>{t.setAttribute("alt",e.newValue,o)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function yw(e,t){const i=e.createEmptyElement("img"),n="imageBlock"===t?e.createContainerElement("figure",{class:"image"}):e.createContainerElement("span",{class:"image-inline"},{isAllowedInsideAttributeElement:!0});return e.insert(e.createPositionAt(n,0),i),n}function kw(e,t){if(e.plugins.has("ImageInlineEditing")!==e.plugins.has("ImageBlockEditing"))return{name:"img"};const i=e.plugins.get("ImageUtils");return e=>{if(!i.isInlineImageView(e))return null;const n=e.findAncestor(i.isBlockImageView)?"imageBlock":"imageInline";return n!==t?null:{name:!0}}}function Cw(e,t){const i=(0,Xi.Z)(t.getSelectedBlocks());return!i||e.isObject(i)||i.isEmpty&&"listItem"!=i.name?"imageBlock":"imageInline"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xw extends a.Z{static get pluginName(){return"ImageUtils"}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},t=null,i=null){const n=this.editor,o=n.model,s=o.document.selection;i=Tw(n,t||s,i),e={...Object.fromEntries(s.getAttributes()),...e};for(const r in e)o.schema.checkAttribute(i,r)||delete e[r];return o.change((n=>{const r=n.createElement(i,e);return t||"imageInline"==i||(t=Cg(s,o)),o.insertContent(r,t),r.parent?(n.setSelection(r,"on"),r):null}))}getClosestSelectedImageWidget(e){const t=e.getSelectedElement();if(t&&this.isImageWidget(t))return t;let i=e.getFirstPosition().parent;while(i){if(i.is("element")&&this.isImageWidget(i))return i;i=i.parent}return null}getClosestSelectedImageElement(e){const t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock")}isImageAllowed(){const e=this.editor.model,t=e.document.selection;return Vw(this.editor,t)&&Aw(t)}toImageWidget(e,t,i){t.setCustomProperty("image",!0,e);const n=()=>{const t=this.findViewImgElement(e),n=t.getAttribute("alt");return n?`${n} ${i}`:i};return fg(e,t,{label:n})}isImageWidget(e){return!!e.getCustomProperty("image")&&pg(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const t=this.editor.editing.view;for(const{item:i}of t.createRangeIn(e))if(this.isInlineImageView(i))return i}}function Vw(e,t){const i=Tw(e,t);if("imageBlock"==i){const i=Ew(t,e.model);if(e.model.schema.checkChild(i,"imageBlock"))return!0}else if(e.model.schema.checkChild(t.focus,"imageInline"))return!0;return!1}function Aw(e){return[...e.focus.getAncestors()].every((e=>!e.is("element","imageBlock")))}function Ew(e,t){const i=Cg(e,t),n=i.start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}function Tw(e,t,i){const n=e.model.schema,o=e.config.get("image.insert.type");return e.plugins.has("ImageBlockEditing")?e.plugins.has("ImageInlineEditing")?i||("inline"===o?"imageInline":"block"===o?"imageBlock":t.is("selection")?Cw(n,t):n.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new _w(this.editor))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sw extends cl.Z{constructor(e){super(e);const t=this.locale.t;this.focusTracker=new en,this.keystrokes=new tn,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(t("Save"),sl.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(t("Cancel"),sl.cancel,"ck-button-cancel","cancel"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),Dl(this)}render(){super.render(),this.keystrokes.listenTo(this.element),Ml({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(e,t,i,n){const o=new l.Z(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:i}}),n&&o.delegate("execute").to(this,n),o}_createLabeledInputView(){const e=this.locale.t,t=new Rc(this.locale,Dc);return t.label=e("Text alternative"),t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Iw(e){const t=e.plugins.get("ContextualBalloon");if(e.plugins.get("ImageUtils").getClosestSelectedImageWidget(e.editing.view.document.selection)){const i=Nw(e);t.updatePosition(i)}}function Nw(e){const t=e.editing.view,i=Zc.defaultPositions,n=e.plugins.get("ImageUtils");return{target:t.domConverter.viewToDom(n.getClosestSelectedImageWidget(t.document.selection)),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bw extends a.Z{static get requires(){return[jc]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",(i=>{const n=e.commands.get("imageTextAlternative"),o=new l.Z(i);return o.set({label:t("Change image text alternative"),icon:sl.lowVision,tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",(()=>{this._showForm()})),o}))}_createForm(){const e=this.editor,t=e.editing.view,i=t.document,n=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Sw(e.locale),this._form.render(),this.listenTo(this._form,"submit",(()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)})),this.listenTo(this._form,"cancel",(()=>{this._hideForm(!0)})),this._form.keystrokes.set("Esc",((e,t)=>{this._hideForm(!0),t()})),this.listenTo(e.ui,"update",(()=>{n.getClosestSelectedImageWidget(i.selection)?this._isVisible&&Iw(e):this._hideForm(!0)})),Rl({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const e=this.editor,t=e.commands.get("imageTextAlternative"),i=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Nw(e)}),i.fieldView.value=i.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rw extends a.Z{static get requires(){return[Pw,Bw]}static get pluginName(){return"ImageTextAlternative"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dw(e){return e=>{e.on("element:figure",t)};function t(t,i,n){if(!n.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const o=e.findViewImgElement(i.viewItem);if(!o||!n.consumable.test(o,{name:!0}))return;n.consumable.consume(i.viewItem,{name:!0,classes:"image"});const s=n.convertItem(o,i.modelCursor),r=(0,Xi.Z)(s.modelRange.getItems());r?(n.convertChildren(i.viewItem,r),n.updateConversionResult(r,i)):n.consumable.revert(i.viewItem,{name:!0,classes:"image"})}}function Mw(e,t){return e=>{e.on(`attribute:srcset:${t}`,i)};function i(t,i,n){if(!n.consumable.consume(i.item,t.name))return;const o=n.writer,s=n.mapper.toViewElement(i.item),r=e.findViewImgElement(s);if(null===i.attributeNewValue){const e=i.attributeOldValue;e.data&&(o.removeAttribute("srcset",r),o.removeAttribute("sizes",r),e.width&&o.removeAttribute("width",r))}else{const e=i.attributeNewValue;e.data&&(o.setAttribute("srcset",e.data,r),o.setAttribute("sizes","100vw",r),e.width&&o.setAttribute("width",e.width,r))}}}function Ow(e,t,i){return e=>{e.on(`attribute:${i}:${t}`,n)};function n(t,i,n){if(!n.consumable.consume(i.item,t.name))return;const o=n.writer,s=n.mapper.toViewElement(i.item),r=e.findViewImgElement(s);o.setAttribute(i.attributeKey,i.attributeNewValue||"",r)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lw extends _i{observe(e){this.listenTo(e,"load",((e,t)=>{const i=t.target;this.checkShouldIgnoreEventFromTarget(i)||"IMG"==i.tagName&&this._fireEvents(t)}),{useCapture:!0})}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fw extends b.Z{constructor(e){super(e);const t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||"block"===t&&(0,P.KE)("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||"inline"===t&&(0,P.KE)("image-inline-plugin-required")}refresh(){this.isEnabled=this.editor.plugins.get("ImageUtils").isImageAllowed()}execute(e){const t=(0,B.Z)(e.source),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(i.getAttributes());t.forEach(((e,t)=>{const s=i.getSelectedElement();if("string"===typeof e&&(e={src:e}),t&&s&&n.isImage(s)){const t=this.editor.model.createPositionAfter(s);n.insertImage({...e,...o},t)}else n.insertImage({...e,...o})}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.conversion;e.editing.view.addObserver(Lw),t.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:e=>{const t={data:e.getAttribute("srcset")};return e.hasAttribute("width")&&(t.width=e.getAttribute("width")),t}}});const i=new Fw(e);e.commands.add("insertImage",i),e.commands.add("imageInsert",i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $w extends b.Z{constructor(e,t){super(e),this._modelElementName=t}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);"imageBlock"===this._modelElementName?this.isEnabled=t.isInlineImage(i):this.isEnabled=t.isBlockImage(i)}execute(){const e=this.editor,t=this.editor.model,i=e.plugins.get("ImageUtils"),n=i.getClosestSelectedImageElement(t.document.selection),o=Object.fromEntries(n.getAttributes());return o.src||o.uploadId?t.change((e=>{const s=Array.from(t.markers).filter((e=>e.getRange().containsItem(n))),r=i.insertImage(o,t.createSelection(n,"on"),this._modelElementName);if(!r)return null;const a=e.createRangeOn(r);for(const t of s){const i=t.getRange(),n="$graveyard"!=i.root.rootName?i.getJoined(a,!0):a;e.updateMarker(t,{range:n})}return{oldElement:n,newElement:r}})):null}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Zw extends a.Z{static get requires(){return[zw,xw,ag]}static get pluginName(){return"ImageBlockEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageBlock",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new $w(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,i=e.conversion,n=e.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageBlock",view:(e,{writer:t})=>yw(t,"imageBlock")}),i.for("editingDowncast").elementToElement({model:"imageBlock",view:(e,{writer:i})=>n.toImageWidget(yw(i,"imageBlock"),i,t("image widget"))}),i.for("downcast").add(Ow(n,"imageBlock","src")).add(Ow(n,"imageBlock","alt")).add(Mw(n,"imageBlock")),i.for("upcast").elementToElement({view:kw(e,"imageBlock"),model:(e,{writer:t})=>t.createElement("imageBlock",e.hasAttribute("src")?{src:e.getAttribute("src")}:null)}).add(Dw(n))}_setupClipboardIntegration(){const e=this.editor,t=e.model,i=e.editing.view,n=e.plugins.get("ImageUtils");this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((o,s)=>{const r=Array.from(s.content.getChildren());let a;if(!r.every(n.isInlineImageView))return;a=s.targetRanges?e.editing.mapper.toModelRange(s.targetRanges[0]):t.document.selection.getFirstRange();const l=t.createSelection(a);if("imageBlock"===Cw(t.schema,l)){const e=new vh(i.document),t=r.map((t=>e.createElement("figure",{class:"image"},t)));s.content=e.createDocumentFragment(t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ww extends a.Z{static get requires(){return[Zw,Gg,Rw]}static get pluginName(){return"ImageBlock"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hw extends a.Z{static get requires(){return[zw,xw,ag]}static get pluginName(){return"ImageInlineEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageInline",{isObject:!0,isInline:!0,allowWhere:"$text",allowAttributesOf:"$text",allowAttributes:["alt","src","srcset"]}),t.addChildCheck(((e,t)=>{if(e.endsWith("caption")&&"imageInline"===t.name)return!1})),this._setupConversion(),e.plugins.has("ImageBlockEditing")&&(e.commands.add("imageTypeInline",new $w(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,i=e.conversion,n=e.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageInline",view:(e,{writer:t})=>t.createEmptyElement("img")}),i.for("editingDowncast").elementToElement({model:"imageInline",view:(e,{writer:i})=>n.toImageWidget(yw(i,"imageInline"),i,t("image widget"))}),i.for("downcast").add(Ow(n,"imageInline","src")).add(Ow(n,"imageInline","alt")).add(Mw(n,"imageInline")),i.for("upcast").elementToElement({view:kw(e,"imageInline"),model:(e,{writer:t})=>t.createElement("imageInline",e.hasAttribute("src")?{src:e.getAttribute("src")}:null)})}_setupClipboardIntegration(){const e=this.editor,t=e.model,i=e.editing.view,n=e.plugins.get("ImageUtils");this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((o,s)=>{const r=Array.from(s.content.getChildren());let a;if(!r.every(n.isBlockImageView))return;a=s.targetRanges?e.editing.mapper.toModelRange(s.targetRanges[0]):t.document.selection.getFirstRange();const l=t.createSelection(a);if("imageInline"===Cw(t.schema,l)){const e=new vh(i.document),t=r.map((t=>1===t.childCount?(Array.from(t.getAttributes()).forEach((i=>e.setAttribute(...i,n.findViewImgElement(t)))),t.getChild(0)):t));s.content=e.createDocumentFragment(t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Uw extends a.Z{static get requires(){return[Hw,Gg,Rw]}static get pluginName(){return"ImageInline"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qw extends a.Z{static get requires(){return[Ww,Uw]}static get pluginName(){return"Image"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gw(e){for(const t of e.getChildren())if(t&&t.is("element","caption"))return t;return null}function jw(e,t){const i=t.getFirstPosition().findAncestor("caption");return i&&e.isBlockImage(i.parent)?i:null}function Kw(e,t){return"figcaption"==t.name&&e.isBlockImageView(t.parent)?{name:!0}:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jw extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils");if(!e.plugins.has(Zw))return this.isEnabled=!1,void(this.value=!1);const i=e.model.document.selection,n=i.getSelectedElement();if(!n){const e=jw(t,i);return this.isEnabled=!!e,void(this.value=!!e)}this.isEnabled=this.editor.plugins.get("ImageUtils").isImage(n),this.isEnabled?this.value=!!Gw(n):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change((e=>{this.value?this._hideImageCaption(e):this._showImageCaption(e,t)}))}_showImageCaption(e,t){const i=this.editor.model,n=i.document.selection,o=this.editor.plugins.get("ImageCaptionEditing");let s=n.getSelectedElement();const r=o._getSavedCaption(s);this.editor.plugins.get("ImageUtils").isInlineImage(s)&&(this.editor.execute("imageTypeBlock"),s=n.getSelectedElement());const a=r||e.createElement("caption");e.append(a,s),t&&e.setSelection(a,"in")}_hideImageCaption(e){const t=this.editor,i=t.model.document.selection,n=t.plugins.get("ImageCaptionEditing"),o=t.plugins.get("ImageUtils");let s,r=i.getSelectedElement();r?s=Gw(r):(s=jw(o,i),r=s.parent),n._saveCaption(r,s),e.setSelection(r,"on"),e.remove(s)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema;t.isRegistered("caption")?t.extend("caption",{allowIn:"imageBlock"}):t.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new Jw(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration()}_setupConversion(){const e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),n=e.t;e.conversion.for("upcast").elementToElement({view:e=>Kw(i,e),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>i.isBlockImage(e.parent)?t.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(e,{writer:o})=>{if(!i.isBlockImage(e.parent))return null;const s=o.createEditableElement("figcaption");return o.setCustomProperty("imageCaption",!0,s),Yd({view:t,element:s,text:n("Enter image caption"),keepOnFocus:!0}),kg(s,o)}}),e.editing.mapper.on("modelToViewPosition",Qw(t)),e.data.mapper.on("modelToViewPosition",Qw(t))}_setupImageTypeCommandsIntegration(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=e.commands.get("imageTypeInline"),n=e.commands.get("imageTypeBlock"),o=e=>{if(!e.return)return;const{oldElement:i,newElement:n}=e.return;if(!i)return;if(t.isBlockImage(i)){const e=Gw(i);if(e)return void this._saveCaption(n,e)}const o=this._getSavedCaption(i);o&&this._saveCaption(n,o)};i&&this.listenTo(i,"execute",o,{priority:"low"}),n&&this.listenTo(n,"execute",o,{priority:"low"})}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?Cn.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}function Qw(e){return(t,i)=>{const n=i.modelPosition,o=n.parent;if(!o.is("element","imageBlock"))return;const s=i.mapper.toViewElement(o);i.viewPosition=e.createPositionAt(s,n.offset+1)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageCaptionUI"}init(){const e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),n=e.t;e.ui.componentFactory.add("toggleImageCaption",(o=>{const s=e.commands.get("toggleImageCaption"),r=new l.Z(o);return r.set({icon:sl.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(s,"value","isEnabled"),r.bind("label").to(s,"value",(e=>n(e?"Toggle caption off":"Toggle caption on"))),this.listenTo(r,"execute",(()=>{e.execute("toggleImageCaption",{focusCaptionOnShow:!0});const n=jw(i,e.model.document.selection);if(n){const i=e.editing.mapper.toViewElement(n);t.scrollToTheSelection(),t.change((e=>{e.addClass("image__caption_highlighted",i)}))}})),r}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eb extends a.Z{static get requires(){return[Yw,Xw]}static get pluginName(){return"ImageCaption"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tb extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!i,i&&i.hasAttribute("width")?this.value={width:i.getAttribute("width"),height:null}:this.value=null}execute(e){const t=this.editor,i=t.model,n=t.plugins.get("ImageUtils"),o=n.getClosestSelectedImageElement(i.document.selection);this.value={width:e.width,height:null},o&&i.change((t=>{t.setAttribute("width",e.width,o)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ib extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageResizeEditing"}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new tb(e);this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t)}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:"width"}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:"width"})}_registerConverters(e){const t=this.editor;t.conversion.for("downcast").add((t=>t.on(`attribute:width:${e}`,((e,t,i)=>{if(!i.consumable.consume(t.item,e.name))return;const n=i.writer,o=i.mapper.toViewElement(t.item);null!==t.attributeNewValue?(n.setStyle("width",t.attributeNewValue,o),n.addClass("image_resized",o)):(n.removeStyle("width",o),n.removeClass("image_resized",o))})))),t.conversion.for("upcast").attributeToAttribute({view:{name:"imageBlock"===e?"figure":"img",styles:{width:/.+/}},model:{key:"width",value:e=>e.getStyle("width")}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const nb={small:sl.objectSizeSmall,medium:sl.objectSizeMedium,large:sl.objectSizeLarge,original:sl.objectSizeFull};class ob extends a.Z{static get requires(){return[ib]}static get pluginName(){return"ImageResizeButtons"}constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),i=e.commands.get("resizeImage");this.bind("isEnabled").to(i);for(const n of t)this._registerImageResizeButton(n);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:i,value:n,icon:o}=e,s=n?n+this._resizeUnit:null;t.ui.componentFactory.add(i,(i=>{const n=new l.Z(i),r=t.commands.get("resizeImage"),a=this._getOptionLabelValue(e,!0);if(!nb[o])throw new P.ZP("imageresizebuttons-missing-icon",t,e);return n.set({label:a,icon:nb[o],tooltip:a,isToggleable:!0}),n.bind("isEnabled").to(this),n.bind("isOn").to(r,"value",sb(s)),this.listenTo(n,"execute",(()=>{t.execute("resizeImage",{width:s})})),n}))}_registerImageResizeDropdown(e){const t=this.editor,i=t.t,n=e.find((e=>!e.value)),o=o=>{const s=t.commands.get("resizeImage"),r=vc(o,Yl),a=r.buttonView;return a.set({tooltip:i("Resize image"),commandValue:n.value,icon:nb.medium,isToggleable:!0,label:this._getOptionLabelValue(n),withText:!0,class:"ck-resize-image-button"}),a.bind("label").to(s,"value",(e=>e&&e.width?e.width:this._getOptionLabelValue(n))),r.bind("isOn").to(s),r.bind("isEnabled").to(this),yc(r,this._getResizeDropdownListItemDefinitions(e,s)),r.listView.ariaLabel=i("Image resize list"),this.listenTo(r,"execute",(e=>{t.execute(e.source.commandName,{width:e.source.commandValue}),t.editing.view.focus()})),r};t.ui.componentFactory.add("resizeImage",o),t.ui.componentFactory.add("imageResize",o)}_getOptionLabelValue(e,t){const i=this.editor.t;return e.label?e.label:t?e.value?i("Resize image to %0",e.value+this._resizeUnit):i("Resize image to the original size"):e.value?e.value+this._resizeUnit:i("Original")}_getResizeDropdownListItemDefinitions(e,t){const i=new T.Z;return e.map((e=>{const n=e.value?e.value+this._resizeUnit:null,o={type:"button",model:new Lc({commandName:"resizeImage",commandValue:n,label:this._getOptionLabelValue(e),withText:!0,icon:null})};o.model.bind("isOn").to(t,"value",sb(n)),i.add(o)})),i}}function sb(e){return t=>null===e&&t===e||t&&t.width===e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const rb="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",ab=/(image|image-inline)/,lb="image_resized";class cb extends a.Z{static get requires(){return[hw]}static get pluginName(){return"ImageResizeHandles"}init(){const e=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(e),this._setupResizerCreator()}_setupResizerCreator(){const e=this.editor,t=e.editing.view;t.addObserver(Lw),this.listenTo(t.document,"imageLoaded",((i,n)=>{if(!n.target.matches(rb))return;const o=e.editing.view.domConverter,s=o.domToView(n.target),r=s.findAncestor({classes:ab});let a=this.editor.plugins.get(hw).getResizerByViewElement(r);if(a)return void a.redraw();const l=e.editing.mapper,c=l.toModelElement(r);a=e.plugins.get(hw).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:c,viewElement:r,editor:e,getHandleHost(e){return e.querySelector("img")},getResizeHost(){return o.viewToDom(l.toViewElement(c.parent))},isCentered(){const e=c.getAttribute("imageStyle");return!e||"block"==e||"alignCenter"==e},onCommit(i){t.change((e=>{e.removeClass(lb,r)})),e.execute("resizeImage",{width:i})}}),a.on("updateSize",(()=>{r.hasClass(lb)||t.change((e=>{e.addClass(lb,r)}))})),a.bind("isEnabled").to(this)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class db extends a.Z{static get requires(){return[ib,cb,ob]}static get pluginName(){return"ImageResize"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hb extends b.Z{constructor(e,t){super(e),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(t.map((e=>{if(e.isDefault)for(const t of e.modelElements)this._defaultStyles[t]=e.name;return[e.name,e]})))}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled?i.hasAttribute("imageStyle")?this.value=i.getAttribute("imageStyle"):this.value=this._defaultStyles[i.name]:this.value=!1}execute(e={}){const t=this.editor,i=t.model,n=t.plugins.get("ImageUtils");i.change((t=>{const o=e.value;let s=n.getClosestSelectedImageElement(i.document.selection);o&&this.shouldConvertImageType(o,s)&&(this.editor.execute(n.isBlockImage(s)?"imageTypeInline":"imageTypeBlock"),s=n.getClosestSelectedImageElement(i.document.selection)),!o||this._styles.get(o).isDefault?t.removeAttribute("imageStyle",s):t.setAttribute("imageStyle",o,s)}))}shouldConvertImageType(e,t){const i=this._styles.get(e).modelElements;return!i.includes(t.name)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const{objectFullWidth:ub,objectInline:mb,objectLeft:gb,objectRight:pb,objectCenter:fb,objectBlockLeft:wb,objectBlockRight:bb}=sl,vb={inline:{name:"inline",title:"In line",icon:mb,modelElements:["imageInline"],isDefault:!0},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:gb,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"},alignBlockLeft:{name:"alignBlockLeft",title:"Left aligned image",icon:wb,modelElements:["imageBlock"],className:"image-style-block-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:fb,modelElements:["imageBlock"],className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:pb,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"},alignBlockRight:{name:"alignBlockRight",title:"Right aligned image",icon:bb,modelElements:["imageBlock"],className:"image-style-block-align-right"},block:{name:"block",title:"Centered image",icon:fb,modelElements:["imageBlock"],isDefault:!0},side:{name:"side",title:"Side image",icon:pb,modelElements:["imageBlock"],className:"image-style-side"}},_b={full:ub,left:wb,right:bb,center:fb,inlineLeft:gb,inlineRight:pb,inline:mb},yb=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function kb(e){const t=e.configuredStyles.options||[],i=t.map((e=>Vb(e))).filter((t=>Ab(t,e)));return i}function Cb(e,t){return e&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:e?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{}}function xb(e){return e.has("ImageBlockEditing")&&e.has("ImageInlineEditing")?[...yb]:[]}function Vb(e){return e="string"===typeof e?vb[e]?{...vb[e]}:{name:e}:Eb(vb[e.name],e),"string"===typeof e.icon&&(e.icon=_b[e.icon]||e.icon),e}function Ab(e,{isBlockPluginLoaded:t,isInlinePluginLoaded:i}){const{modelElements:n,name:o}=e;if(!(n&&n.length&&o))return Tb({style:e}),!1;{const o=[t?"imageBlock":null,i?"imageInline":null];if(!n.some((e=>o.includes(e))))return(0,P.KE)("image-style-missing-dependency",{style:e,missingPlugins:n.map((e=>"imageBlock"===e?"ImageBlockEditing":"ImageInlineEditing"))}),!1}return!0}function Eb(e,t){const i={...t};for(const n in e)Object.prototype.hasOwnProperty.call(t,n)||(i[n]=e[n]);return i}function Tb(e){(0,P.KE)("image-style-configuration-definition-invalid",e)}var Pb={normalizeStyles:kb,getDefaultStylesConfiguration:Cb,getDefaultDropdownDefinitions:xb,warnInvalidStyle:Tb,DEFAULT_OPTIONS:vb,DEFAULT_ICONS:_b,DEFAULT_DROPDOWN_DEFINITIONS:yb};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Sb(e){return(t,i,n)=>{if(!n.consumable.consume(i.item,t.name))return;const o=Nb(i.attributeNewValue,e),s=Nb(i.attributeOldValue,e),r=n.mapper.toViewElement(i.item),a=n.writer;s&&a.removeClass(s.className,r),o&&a.addClass(o.className,r)}}function Ib(e){const t={imageInline:e.filter((e=>!e.isDefault&&e.modelElements.includes("imageInline"))),imageBlock:e.filter((e=>!e.isDefault&&e.modelElements.includes("imageBlock")))};return(e,i,n)=>{if(!i.modelRange)return;const o=i.viewItem,s=(0,Xi.Z)(i.modelRange.getItems());if(s&&n.schema.checkAttribute(s,"imageStyle"))for(const r of t[s.name])n.consumable.consume(o,{classes:r.className})&&n.writer.setAttribute("imageStyle",r.name,s)}}function Nb(e,t){for(const i of t)if(i.name===e)return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bb extends a.Z{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[xw]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:t}=Pb,i=this.editor,n=i.plugins.has("ImageBlockEditing"),o=i.plugins.has("ImageInlineEditing");i.config.define("image.styles",t(n,o)),this.normalizedStyles=e({configuredStyles:i.config.get("image.styles"),isBlockPluginLoaded:n,isInlinePluginLoaded:o}),this._setupConversion(n,o),this._setupPostFixer(),i.commands.add("imageStyle",new hb(i,this.normalizedStyles))}_setupConversion(e,t){const i=this.editor,n=i.model.schema,o=Sb(this.normalizedStyles),s=Ib(this.normalizedStyles);i.editing.downcastDispatcher.on("attribute:imageStyle",o),i.data.downcastDispatcher.on("attribute:imageStyle",o),e&&(n.extend("imageBlock",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:figure",s,{priority:"low"})),t&&(n.extend("imageInline",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:img",s,{priority:"low"}))}_setupPostFixer(){const e=this.editor,t=e.model.document,i=e.plugins.get(xw),n=new Map(this.normalizedStyles.map((e=>[e.name,e])));t.registerPostFixer((e=>{let o=!1;for(const s of t.differ.getChanges())if("insert"==s.type||"attribute"==s.type&&"imageStyle"==s.attributeKey){let t="insert"==s.type?s.position.nodeAfter:s.range.start.nodeAfter;if(t&&t.is("element","paragraph")&&t.childCount>0&&(t=t.getChild(0)),!i.isImage(t))continue;const r=t.getAttribute("imageStyle");if(!r)continue;const a=n.get(r);a&&a.modelElements.includes(t.name)||(e.removeAttribute("imageStyle",t),o=!0)}return o}))}}var Rb=i(69203);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Db extends a.Z{static get requires(){return[Bb]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],i=Mb(e.get("ImageStyleEditing").normalizedStyles,this.localizedDefaultStylesTitles);for(const o of i)this._createButton(o);const n=Mb([...t.filter(le.Z),...Pb.getDefaultDropdownDefinitions(e)],this.localizedDefaultStylesTitles);for(const o of n)this._createDropdown(o,i)}_createDropdown(e,t){const i=this.editor.ui.componentFactory;i.add(e.name,(n=>{let o;const{defaultItem:s,items:r,title:a}=e,l=r.filter((e=>t.find((({name:t})=>Ob(t)===e)))).map((e=>{const t=i.create(e);return e===s&&(o=t),t}));r.length!==l.length&&Pb.warnInvalidStyle({dropdown:e});const c=vc(n,Ql),d=c.buttonView;return _c(c,l),d.set({label:Lb(a,o.label),class:null,tooltip:!0}),d.bind("icon").toMany(l,"isOn",((...e)=>{const t=e.findIndex(Rb.Z);return t<0?o.icon:l[t].icon})),d.bind("label").toMany(l,"isOn",((...e)=>{const t=e.findIndex(Rb.Z);return Lb(a,t<0?o.label:l[t].label)})),d.bind("isOn").toMany(l,"isOn",((...e)=>e.some(Rb.Z))),d.bind("class").toMany(l,"isOn",((...e)=>e.some(Rb.Z)?"ck-splitbutton_flatten":null)),d.on("execute",(()=>{l.some((({isOn:e})=>e))?c.isOpen=!c.isOpen:o.fire("execute")})),c.bind("isEnabled").toMany(l,"isEnabled",((...e)=>e.some(Rb.Z))),c}))}_createButton(e){const t=e.name;this.editor.ui.componentFactory.add(Ob(t),(i=>{const n=this.editor.commands.get("imageStyle"),o=new l.Z(i);return o.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(n,"isEnabled"),o.bind("isOn").to(n,"value",(e=>e===t)),o.on("execute",this._executeCommand.bind(this,t)),o}))}_executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus()}}function Mb(e,t){for(const i of e)t[i.title]&&(i.title=t[i.title]);return e}function Ob(e){return`imageStyle:${e}`}function Lb(e,t){return(e?e+": ":"")+t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fb extends a.Z{static get requires(){return[Bb,Db]}static get pluginName(){return"ImageStyle"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zb extends a.Z{static get requires(){return[Jf,xw]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t,i=e.plugins.get(Jf),n=e.plugins.get("ImageUtils");i.register("image",{ariaLabel:t("Image toolbar"),items:$b(e.config.get("image.toolbar")||[]),getRelatedElement:e=>n.getClosestSelectedImageWidget(e)})}}function $b(e){return e.map((e=>(0,le.Z)(e)?e.name:e))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zb(e){const t=e.map((e=>e.replace("+","\\+")));return new RegExp(`^image\\/(${t.join("|")})$`)}function Wb(e){return new Promise(((t,i)=>{const n=e.getAttribute("src");fetch(n).then((e=>e.blob())).then((e=>{const i=Ub(e,n),o=i.replace("image/",""),s=`image.${o}`,r=new File([e],s,{type:i});t(r)})).catch((e=>e&&"TypeError"===e.name?qb(n).then(t).catch(i):i(e)))}))}function Hb(e,t){return!(!e.isInlineImageView(t)||!t.getAttribute("src"))&&(t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||t.getAttribute("src").match(/^blob:/g))}function Ub(e,t){return e.type?e.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function qb(e){return Gb(e).then((t=>{const i=Ub(t,e),n=i.replace("image/",""),o=`image.${n}`;return new File([t],o,{type:i})}))}function Gb(e){return new Promise(((t,i)=>{const n=ri.document.createElement("img");n.addEventListener("load",(()=>{const e=ri.document.createElement("canvas");e.width=n.width,e.height=n.height;const o=e.getContext("2d");o.drawImage(n,0,0),e.toBlob((e=>e?t(e):i()))})),n.addEventListener("error",(()=>i())),n.src=e}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jb extends a.Z{static get pluginName(){return"ImageUploadUI"}init(){const e=this.editor,t=e.t,i=i=>{const n=new dl(i),o=e.commands.get("uploadImage"),s=e.config.get("image.upload.types"),r=Zb(s);return n.set({acceptedType:s.map((e=>`image/${e}`)).join(","),allowMultipleFiles:!0}),n.buttonView.set({label:t("Insert image"),icon:sl.image,tooltip:!0}),n.buttonView.bind("isEnabled").to(o),n.on("done",((t,i)=>{const n=Array.from(i).filter((e=>r.test(e.type)));n.length&&e.execute("uploadImage",{file:n})})),n};e.ui.componentFactory.add("uploadImage",i),e.ui.componentFactory.add("imageUpload",i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kb extends a.Z{static get pluginName(){return"ImageUploadProgress"}constructor(e){super(e),this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",((...e)=>this.uploadStatusChange(...e))),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",((...e)=>this.uploadStatusChange(...e)))}uploadStatusChange(e,t,i){const n=this.editor,o=t.item,s=o.getAttribute("uploadId");if(!i.consumable.consume(t.item,e.name))return;const r=n.plugins.get("ImageUtils"),a=n.plugins.get(al),l=s?t.attributeNewValue:null,c=this.placeholder,d=n.editing.mapper.toViewElement(o),h=i.writer;if("reading"==l)return Jb(d,h),void Qb(r,c,d,h);if("uploading"==l){const e=a.loaders.get(s);return Jb(d,h),void(e?(Xb(d,h),ev(d,h,e,n.editing.view),av(r,d,h,e)):Qb(r,c,d,h))}"complete"==l&&a.loaders.get(s)&&iv(d,h,n.editing.view),tv(d,h),Xb(d,h),Yb(d,h)}}function Jb(e,t){e.hasClass("ck-appear")||t.addClass("ck-appear",e)}function Yb(e,t){t.removeClass("ck-appear",e)}function Qb(e,t,i,n){i.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",i);const o=e.findViewImgElement(i);o.getAttribute("src")!==t&&n.setAttribute("src",t,o),sv(i,"placeholder")||n.insert(n.createPositionAfter(o),ov(n))}function Xb(e,t){e.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",e),rv(e,t,"placeholder")}function ev(e,t,i,n){const o=nv(t);t.insert(t.createPositionAt(e,"end"),o),i.on("change:uploadedPercent",((e,t,i)=>{n.change((e=>{e.setStyle("width",i+"%",o)}))}))}function tv(e,t){rv(e,t,"progressBar")}function iv(e,t,i){const n=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(e,"end"),n),setTimeout((()=>{i.change((e=>e.remove(e.createRangeOn(n))))}),3e3)}function nv(e){const t=e.createUIElement("div",{class:"ck-progress-bar"});return e.setCustomProperty("progressBar",!0,t),t}function ov(e){const t=e.createUIElement("div",{class:"ck-upload-placeholder-loader"});return e.setCustomProperty("placeholder",!0,t),t}function sv(e,t){for(const i of e.getChildren())if(i.getCustomProperty(t))return i}function rv(e,t,i){const n=sv(e,i);n&&t.remove(t.createRangeOn(n))}function av(e,t,i,n){if(n.data){const o=e.findViewImgElement(t);i.setAttribute("src",n.data,o)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lv extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=e.model.document.selection.getSelectedElement();this.isEnabled=t.isImageAllowed()||t.isImage(i)}execute(e){const t=(0,B.Z)(e.file),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(i.getAttributes());t.forEach(((e,t)=>{const s=i.getSelectedElement();if(t&&s&&n.isImage(s)){const t=this.editor.model.createPositionAfter(s);this._uploadImage(e,o,t)}else this._uploadImage(e,o)}))}_uploadImage(e,t,i){const n=this.editor,o=n.plugins.get(al),s=o.createLoader(e),r=n.plugins.get("ImageUtils");s&&r.insertImage({...t,uploadId:s.id},i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cv extends a.Z{static get requires(){return[al,Oc,ag,xw]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const e=this.editor,t=e.model.document,i=e.conversion,n=e.plugins.get(al),o=e.plugins.get("ImageUtils"),s=Zb(e.config.get("image.upload.types")),r=new lv(e);e.commands.add("uploadImage",r),e.commands.add("imageUpload",r),i.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",((t,i)=>{if(dv(i.dataTransfer))return;const n=Array.from(i.dataTransfer.files).filter((e=>!!e&&s.test(e.type)));n.length&&(t.stop(),e.model.change((t=>{i.targetRanges&&t.setSelection(i.targetRanges.map((t=>e.editing.mapper.toModelRange(t)))),e.model.enqueueChange("default",(()=>{e.execute("uploadImage",{file:n})}))})))})),this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((t,i)=>{const s=Array.from(e.editing.view.createRangeIn(i.content)).filter((e=>Hb(o,e.item)&&!e.item.getAttribute("uploadProcessed"))).map((e=>({promise:Wb(e.item),imageElement:e.item})));if(!s.length)return;const r=new vh(e.editing.view.document);for(const e of s){r.setAttribute("uploadProcessed",!0,e.imageElement);const t=n.createLoader(e.promise);t&&(r.setAttribute("src","",e.imageElement),r.setAttribute("uploadId",t.id,e.imageElement))}})),e.editing.view.document.on("dragover",((e,t)=>{t.preventDefault()})),t.on("change",(()=>{const i=t.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),o=new Set;for(const t of i)if("insert"==t.type&&"$text"!=t.name){const i=t.position.nodeAfter,s="$graveyard"==t.position.root.rootName;for(const t of hv(e,i)){const e=t.getAttribute("uploadId");if(!e)continue;const i=n.loaders.get(e);i&&(s?o.has(e)||i.abort():(o.add(e),this._uploadImageElements.set(e,t),"idle"==i.status&&this._readAndUpload(i)))}}})),this.on("uploadComplete",((e,{imageElement:t,data:i})=>{const n=i.urls?i.urls:i;this.editor.model.change((e=>{e.setAttribute("src",n.default,t),this._parseAndSetSrcsetAttributeOnImage(n,t,e)}))}),{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(e){const t=this.editor,i=t.model,n=t.locale.t,o=t.plugins.get(al),s=t.plugins.get(Oc),r=t.plugins.get("ImageUtils"),a=this._uploadImageElements;return i.enqueueChange("transparent",(t=>{t.setAttribute("uploadStatus","reading",a.get(e.id))})),e.read().then((()=>{const n=e.upload(),o=a.get(e.id);if(Yt.ZP.isSafari){const e=t.editing.mapper.toViewElement(o),i=r.findViewImgElement(e);t.editing.view.once("render",(()=>{if(!i.parent)return;const e=t.editing.view.domConverter.mapViewToDom(i.parent);if(!e)return;const n=e.style.display;e.style.display="none",e._ckHack=e.offsetHeight,e.style.display=n}))}return i.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","uploading",o)})),n})).then((t=>{i.enqueueChange("transparent",(i=>{const n=a.get(e.id);i.setAttribute("uploadStatus","complete",n),this.fire("uploadComplete",{data:t,imageElement:n})})),l()})).catch((t=>{if("error"!==e.status&&"aborted"!==e.status)throw t;"error"==e.status&&t&&s.showWarning(t,{title:n("Upload failed"),namespace:"upload"}),i.enqueueChange("transparent",(t=>{t.remove(a.get(e.id))})),l()}));function l(){i.enqueueChange("transparent",(t=>{const i=a.get(e.id);t.removeAttribute("uploadId",i),t.removeAttribute("uploadStatus",i),a.delete(e.id)})),o.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,i){let n=0;const o=Object.keys(e).filter((e=>{const t=parseInt(e,10);if(!isNaN(t))return n=Math.max(n,t),!0})).map((t=>`${e[t]} ${t}w`)).join(", ");""!=o&&i.setAttribute("srcset",{data:o,width:n},t)}}function dv(e){return Array.from(e.types).includes("text/html")&&""!==e.getData("text/html")}function hv(e,t){const i=e.plugins.get("ImageUtils");return Array.from(e.model.createRangeOn(t)).filter((e=>i.isImage(e.item))).map((e=>e.item))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uv extends a.Z{static get pluginName(){return"ImageUpload"}static get requires(){return[cv,jb,Kb]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mv extends a.Z{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new v(e)),e.commands.add("outdent",new v(e))}}var gv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',pv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fv extends a.Z{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,i=e.t,n="ltr"==t.uiLanguageDirection?gv:pv,o="ltr"==t.uiLanguageDirection?pv:gv;this._defineButton("indent",i("Increase indent"),n),this._defineButton("outdent",i("Decrease indent"),o)}_defineButton(e,t,i){const n=this.editor;n.ui.componentFactory.add(e,(o=>{const s=n.commands.get(e),r=new l.Z(o);return r.set({label:t,icon:i,tooltip:!0}),r.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(r,"execute",(()=>{n.execute(e),n.editing.view.focus()})),r}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wv extends a.Z{static get pluginName(){return"Indent"}static get requires(){return[mv,fv]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
class bv{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach((e=>this._definitions.add(e))):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",((e,t,i)=>{if(!i.consumable.test(t.item,"attribute:linkHref"))return;const n=i.writer,o=n.document.selection;for(const s of this._definitions){const e=n.createAttributeElement("a",s.attributes,{priority:5});s.classes&&n.addClass(s.classes,e);for(const t in s.styles)n.setStyle(t,s.styles[t],e);n.setCustomProperty("link",!0,e),s.callback(t.attributeNewValue)?t.item.is("selection")?n.wrap(o.getFirstRange(),e):n.wrap(i.mapper.toViewRange(t.range),e):n.unwrap(i.mapper.toViewRange(t.range),e)}}),{priority:"high"})}}getDispatcherForLinkedImage(){return e=>{e.on("attribute:linkHref:imageBlock",((e,t,{writer:i,mapper:n})=>{const o=n.toViewElement(t.item),s=Array.from(o.getChildren()).find((e=>"a"===e.name));for(const r of this._definitions){const e=Y(r.attributes);if(r.callback(t.attributeNewValue)){for(const[t,n]of e)"class"===t?i.addClass(n,s):i.setAttribute(t,n,s);r.classes&&i.addClass(r.classes,s);for(const e in r.styles)i.setStyle(e,r.styles[e],s)}else{for(const[t,n]of e)"class"===t?i.removeClass(n,s):i.removeAttribute(t,s);r.classes&&i.removeClass(r.classes,s);for(const e in r.styles)i.removeStyle(e,s)}}}))}}}function vv(e,t,i){var n=e.length;return i=void 0===i?n:i,!t&&i>=n?e:ge(e,t,i)}var _v=vv,yv="\\ud800-\\udfff",kv="\\u0300-\\u036f",Cv="\\ufe20-\\ufe2f",xv="\\u20d0-\\u20ff",Vv=kv+Cv+xv,Av="\\ufe0e\\ufe0f",Ev="\\u200d",Tv=RegExp("["+Ev+yv+Vv+Av+"]");function Pv(e){return Tv.test(e)}var Sv=Pv;function Iv(e){return e.split("")}var Nv=Iv,Bv="\\ud800-\\udfff",Rv="\\u0300-\\u036f",Dv="\\ufe20-\\ufe2f",Mv="\\u20d0-\\u20ff",Ov=Rv+Dv+Mv,Lv="\\ufe0e\\ufe0f",Fv="["+Bv+"]",zv="["+Ov+"]",$v="\\ud83c[\\udffb-\\udfff]",Zv="(?:"+zv+"|"+$v+")",Wv="[^"+Bv+"]",Hv="(?:\\ud83c[\\udde6-\\uddff]){2}",Uv="[\\ud800-\\udbff][\\udc00-\\udfff]",qv="\\u200d",Gv=Zv+"?",jv="["+Lv+"]?",Kv="(?:"+qv+"(?:"+[Wv,Hv,Uv].join("|")+")"+jv+Gv+")*",Jv=jv+Gv+Kv,Yv="(?:"+[Wv+zv+"?",zv,Hv,Uv,Fv].join("|")+")",Qv=RegExp($v+"(?="+$v+")|"+Yv+Jv,"g");function Xv(e){return e.match(Qv)||[]}var e_=Xv;function t_(e){return Sv(e)?e_(e):Nv(e)}var i_=t_;function n_(e){return function(t){t=(0,Nd.Z)(t);var i=Sv(t)?i_(t):void 0,n=i?i[0]:t.charAt(0),o=i?_v(i,1).join(""):t.slice(1);return n[e]()+o}}var o_=n_,s_=o_("toUpperCase"),r_=s_;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const a_=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,l_=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,c_=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,d_=/^((\w+:(\/{2,})?)|(\W))/i,h_="Ctrl+K";function u_(e){return e.is("attributeElement")&&!!e.getCustomProperty("link")}function m_(e,{writer:t}){const i=t.createAttributeElement("a",{href:e},{priority:5});return t.setCustomProperty("link",!0,i),i}function g_(e){return e=String(e),p_(e)?e:"#"}function p_(e){const t=e.replace(a_,"");return t.match(l_)}function f_(e,t){const i={"Open in a new tab":e("Open in a new tab"),Downloadable:e("Downloadable")};return t.forEach((e=>(e.label&&i[e.label]&&(e.label=i[e.label]),e))),t}function w_(e){const t=[];if(e)for(const[i,n]of Object.entries(e)){const e=Object.assign({},n,{id:`link${r_(i)}`});t.push(e)}return t}function b_(e,t){return!!e&&t.checkAttribute(e.name,"linkHref")}function v_(e){return c_.test(e)}function __(e,t){const i=v_(e)?"mailto:":t,n=!!i&&!d_.test(e);return e&&n?i+e:e}function y_(e){window.open(e,"_blank","noopener")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class k_ extends b.Z{constructor(e){super(e),this.manualDecorators=new T.Z,this.automaticDecorators=new bv}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement()||(0,Xi.Z)(t.getSelectedBlocks());b_(i,e.schema)?(this.value=i.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(i,"linkHref")):(this.value=t.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref"));for(const n of this.manualDecorators)n.value=this._getDecoratorStateFromModel(n.id)}execute(e,t={}){const i=this.editor.model,n=i.document.selection,o=[],s=[];for(const r in t)t[r]?o.push(r):s.push(r);i.change((t=>{if(n.isCollapsed){const r=n.getFirstPosition();if(n.hasAttribute("linkHref")){const a=Gd(r,"linkHref",n.getAttribute("linkHref"),i);t.setAttribute("linkHref",e,a),o.forEach((e=>{t.setAttribute(e,!0,a)})),s.forEach((e=>{t.removeAttribute(e,a)})),t.setSelection(t.createPositionAfter(a.end.nodeBefore))}else if(""!==e){const s=Y(n.getAttributes());s.set("linkHref",e),o.forEach((e=>{s.set(e,!0)}));const{end:a}=i.insertContent(t.createText(e,s),r);t.setSelection(a)}["linkHref",...o,...s].forEach((e=>{t.removeSelectionAttribute(e)}))}else{const r=i.schema.getValidRanges(n.getRanges(),"linkHref"),a=[];for(const e of n.getSelectedBlocks())i.schema.checkAttribute(e,"linkHref")&&a.push(t.createRangeOn(e));const l=a.slice();for(const e of r)this._isRangeToUpdate(e,a)&&l.push(e);for(const i of l)t.setAttribute("linkHref",e,i),o.forEach((e=>{t.setAttribute(e,!0,i)})),s.forEach((e=>{t.removeAttribute(e,i)}))}}))}_getDecoratorStateFromModel(e){const t=this.editor.model,i=t.document.selection,n=i.getSelectedElement();return b_(n,t.schema)?n.getAttribute(e):i.getAttribute(e)}_isRangeToUpdate(e,t){for(const i of t)if(i.containsRange(e))return!1;return!0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class C_ extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement();b_(i,e.schema)?this.isEnabled=e.schema.checkAttribute(i,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref")}execute(){const e=this.editor,t=this.editor.model,i=t.document.selection,n=e.commands.get("link");t.change((e=>{const o=i.isCollapsed?[Gd(i.getFirstPosition(),"linkHref",i.getAttribute("linkHref"),t)]:t.schema.getValidRanges(i.getRanges(),"linkHref");for(const t of o)if(e.removeAttribute("linkHref",t),n)for(const i of n.manualDecorators)e.removeAttribute(i.id,t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class x_{constructor({id:e,label:t,attributes:i,classes:n,styles:o,defaultValue:s}){this.id=e,this.set("value"),this.defaultValue=s,this.label=t,this.attributes=i,this.classes=n,this.styles=o}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}(0,I.Z)(x_,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const V_="ck-link_selected",A_="automatic",E_="manual",T_=/^(https?:)?\/\//;class P_ extends a.Z{static get pluginName(){return"LinkEditing"}static get requires(){return[Ad,vd,ag]}constructor(e){super(e),e.config.define("link",{addTargetToExternalLinks:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:m_}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(e,t)=>m_(g_(e),t)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:e=>e.getAttribute("href")}}),e.commands.add("link",new k_(e)),e.commands.add("unlink",new C_(e));const t=f_(e.t,w_(e.config.get("link.decorators")));this._enableAutomaticDecorators(t.filter((e=>e.mode===A_))),this._enableManualDecorators(t.filter((e=>e.mode===E_)));const i=e.plugins.get(Ad);i.registerAttribute("linkHref"),Kd(e,"linkHref","a",V_),this._enableLinkOpen(),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterLink(),this._enableTypingOverLink(),this._handleDeleteContentAfterLink()}_enableAutomaticDecorators(e){const t=this.editor,i=t.commands.get("link"),n=i.automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&n.add({id:"linkIsExternal",mode:A_,callback:e=>T_.test(e),attributes:{target:"_blank",rel:"noopener noreferrer"}}),n.add(e),n.length&&t.conversion.for("downcast").add(n.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,i=t.commands.get("link"),n=i.manualDecorators;e.forEach((e=>{t.model.schema.extend("$text",{allowAttributes:e.id}),e=new x_(e),n.add(e),t.conversion.for("downcast").attributeToElement({model:e.id,view:(t,{writer:i})=>{if(t){const t=i.createAttributeElement("a",e.attributes,{priority:5});e.classes&&i.addClass(e.classes,t);for(const n in e.styles)i.setStyle(n,e.styles[n],t);return i.setCustomProperty("link",!0,t),t}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",...e._createPattern()},model:{key:e.id}})}))}_enableLinkOpen(){const e=this.editor,t=e.editing.view,i=t.document,n=e.model.document;this.listenTo(i,"click",((e,t)=>{const i=Yt.ZP.isMac?t.domEvent.metaKey:t.domEvent.ctrlKey;if(!i)return;let n=t.domTarget;if("a"!=n.tagName.toLowerCase()&&(n=n.closest("a")),!n)return;const o=n.getAttribute("href");o&&(e.stop(),t.preventDefault(),y_(o))}),{context:"$capture"}),this.listenTo(i,"enter",((e,t)=>{const i=n.selection,o=i.getSelectedElement(),s=o?o.getAttribute("linkHref"):i.getAttribute("linkHref"),r=s&&t.domEvent.altKey;r&&(e.stop(),y_(s))}),{context:"a"})}_enableInsertContentSelectionAttributesFixer(){const e=this.editor,t=e.model,i=t.document.selection;this.listenTo(t,"insertContent",(()=>{const e=i.anchor.nodeBefore,n=i.anchor.nodeAfter;i.hasAttribute("linkHref")&&e&&e.hasAttribute("linkHref")&&(n&&n.hasAttribute("linkHref")||t.change((e=>{S_(e,B_(t.schema))})))}),{priority:"low"})}_enableClickingAfterLink(){const e=this.editor,t=e.model;e.editing.view.addObserver(bh);let i=!1;this.listenTo(e.editing.view.document,"mousedown",(()=>{i=!0})),this.listenTo(e.editing.view.document,"selectionChange",(()=>{if(!i)return;i=!1;const e=t.document.selection;if(!e.isCollapsed)return;if(!e.hasAttribute("linkHref"))return;const n=e.getFirstPosition(),o=Gd(n,"linkHref",e.getAttribute("linkHref"),t);(n.isTouching(o.start)||n.isTouching(o.end))&&t.change((e=>{S_(e,B_(t.schema))}))}))}_enableTypingOverLink(){const e=this.editor,t=e.editing.view;let i,n;this.listenTo(t.document,"delete",(()=>{n=!0}),{priority:"high"}),this.listenTo(e.model,"deleteContent",(()=>{const t=e.model.document.selection;t.isCollapsed||(n?n=!1:N_(e)&&I_(e.model)&&(i=t.getAttributes()))}),{priority:"high"}),this.listenTo(e.model,"insertContent",((t,[o])=>{n=!1,N_(e)&&i&&(e.model.change((e=>{for(const[t,n]of i)e.setAttribute(t,n,o)})),i=null)}),{priority:"high"})}_handleDeleteContentAfterLink(){const e=this.editor,t=e.model,i=t.document.selection,n=e.editing.view;let o=!1,s=!1;this.listenTo(n.document,"delete",((e,t)=>{s=t.domEvent.keyCode===ct.Do.backspace}),{priority:"high"}),this.listenTo(t,"deleteContent",(()=>{o=!1;const e=i.getFirstPosition(),n=i.getAttribute("linkHref");if(!n)return;const s=Gd(e,"linkHref",n,t);o=s.containsPosition(e)||s.end.isEqual(e)}),{priority:"high"}),this.listenTo(t,"deleteContent",(()=>{s&&(s=!1,o||e.model.enqueueChange((e=>{S_(e,B_(t.schema))})))}),{priority:"low"})}}function S_(e,t){e.removeSelectionAttribute("linkHref");for(const i of t)e.removeSelectionAttribute(i)}function I_(e){const t=e.document.selection,i=t.getFirstPosition(),n=t.getLastPosition(),o=i.nodeAfter;if(!o)return!1;if(!o.is("$text"))return!1;if(!o.hasAttribute("linkHref"))return!1;const s=n.textNode||n.nodeBefore;if(o===s)return!0;const r=Gd(i,"linkHref",o.getAttribute("linkHref"),e);return r.containsRange(e.createRange(i,n),!0)}function N_(e){const t=e.plugins.get("Input");return t.isInput(e.model.change((e=>e.batch)))}function B_(e){const t=e.getDefinition("$text").allowAttributes;return t.filter((e=>e.startsWith("link")))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class R_ extends cl.Z{constructor(e,t){super(e);const i=e.t;this.focusTracker=new en,this.keystrokes=new tn,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),sl.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(i("Cancel"),sl.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t.manualDecorators),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const n=["ck","ck-link-form","ck-responsive-form"];t.manualDecorators.length&&n.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:n,tabindex:"-1"},children:this.children}),Dl(this)}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce(((e,t)=>(e[t.name]=t.isOn,e)),{})}render(){super.render(),Ml({view:this});const e=[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,t=new Rc(this.locale,Dc);return t.label=e("Link URL"),t}_createButton(e,t,i,n){const o=new l.Z(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:i}}),n&&o.delegate("execute").to(this,n),o}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const i of e.manualDecorators){const n=new zl(this.locale);n.set({name:i.id,label:i.label,withText:!0}),n.bind("isOn").toMany([i,e],"value",((e,t)=>void 0===t&&void 0===e?i.defaultValue:e)),n.on("execute",(()=>{i.set("value",!n.isOn)})),t.add(n)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const e=new cl.Z;e.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map((e=>({tag:"li",children:[e],attributes:{class:["ck","ck-list__item"]}}))),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(e)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}}var D_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class M_ extends cl.Z{constructor(e){super(e);const t=e.t;this.focusTracker=new en,this.keystrokes=new tn,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(t("Unlink"),D_,"unlink"),this.editButtonView=this._createButton(t("Edit link"),sl.pencil,"edit"),this.set("href"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render();const e=[this.previewButtonView,this.editButtonView,this.unlinkButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(e,t,i){const n=new l.Z(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.delegate("execute").to(this,i),n}_createPreviewButton(){const e=new l.Z(this.locale),t=this.bindTemplate,i=this.t;return e.set({withText:!0,tooltip:i("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:t.to("href",(e=>e&&g_(e))),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",(e=>e||i("This link has no URL"))),e.bind("isEnabled").to(this,"href",(e=>!!e)),e.template.tag="a",e.template.eventListeners={},e}}var O_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const L_="link-ui";class F_ extends a.Z{static get requires(){return[jc]}static get pluginName(){return"LinkUI"}init(){const e=this.editor;e.editing.view.addObserver(wh),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get(jc),this._createToolbarLinkButton(),this._enableUserBalloonInteractions(),e.conversion.for("editingDowncast").markerToHighlight({model:L_,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:L_,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,t=new M_(e.locale),i=e.commands.get("link"),n=e.commands.get("unlink");return t.bind("href").to(i,"value"),t.editButtonView.bind("isEnabled").to(i),t.unlinkButtonView.bind("isEnabled").to(n),this.listenTo(t,"edit",(()=>{this._addFormView()})),this.listenTo(t,"unlink",(()=>{e.execute("unlink"),this._hideUI()})),t.keystrokes.set("Esc",((e,t)=>{this._hideUI(),t()})),t.keystrokes.set(h_,((e,t)=>{this._addFormView(),t()})),t}_createFormView(){const e=this.editor,t=e.commands.get("link"),i=e.config.get("link.defaultProtocol"),n=new R_(e.locale,t);return n.urlInputView.fieldView.bind("value").to(t,"value"),n.urlInputView.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),n.saveButtonView.bind("isEnabled").to(t),this.listenTo(n,"submit",(()=>{const{value:t}=n.urlInputView.fieldView.element,o=__(t,i);e.execute("link",o,n.getDecoratorSwitchesState()),this._closeFormView()})),this.listenTo(n,"cancel",(()=>{this._closeFormView()})),n.keystrokes.set("Esc",((e,t)=>{this._closeFormView(),t()})),n}_createToolbarLinkButton(){const e=this.editor,t=e.commands.get("link"),i=e.t;e.keystrokes.set(h_,((e,i)=>{i(),t.isEnabled&&this._showUI(!0)})),e.ui.componentFactory.add("link",(e=>{const n=new l.Z(e);return n.isEnabled=!0,n.label=i("Link"),n.icon=O_,n.keystroke=h_,n.tooltip=!0,n.isToggleable=!0,n.bind("isEnabled").to(t,"isEnabled"),n.bind("isOn").to(t,"value",(e=>!!e)),this.listenTo(n,"execute",(()=>this._showUI(!0))),n}))}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",(()=>{const e=this._getSelectedLinkElement();e&&this._showUI()})),this.editor.keystrokes.set("Tab",((e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())}),{priority:"high"}),this.editor.keystrokes.set("Esc",((e,t)=>{this._isUIVisible&&(this._hideUI(),t())})),Rl({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const e=this.editor,t=e.commands.get("link");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=t.value||""}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let i=this._getSelectedLinkElement(),n=s();const o=()=>{const e=this._getSelectedLinkElement(),t=s();i&&!e||!i&&t!==n?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),i=e,n=t};function s(){return t.selection.focus.getAncestors().reverse().find((e=>e.is("element")))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){const e=this._balloon.visibleView;return e==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model,i=e.document;let n=null;if(t.markers.has(L_)){const t=Array.from(this.editor.editing.mapper.markerNameToElements(L_)),i=e.createRange(e.createPositionBefore(t[0]),e.createPositionAfter(t[t.length-1]));n=e.domConverter.viewRangeToDom(i)}else n=()=>{const t=this._getSelectedLinkElement();return t?e.domConverter.mapViewToDom(t):e.domConverter.viewRangeToDom(i.selection.getFirstRange())};return{target:n}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection,i=t.getSelectedElement();if(t.isCollapsed||i&&pg(i))return z_(t.getFirstPosition());{const i=t.getFirstRange().getTrimmed(),n=z_(i.start),o=z_(i.end);return n&&n==o&&e.createRangeIn(n).getTrimmed().isEqual(i)?n:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change((t=>{const i=e.document.selection.getFirstRange();if(e.markers.has(L_))t.updateMarker(L_,{range:i});else if(i.start.isAtEnd){const n=i.start.getLastMatchingPosition((({item:t})=>!e.schema.isContent(t)),{boundaries:i});t.addMarker(L_,{usingOperation:!1,affectsData:!1,range:t.createRange(n,i.end)})}else t.addMarker(L_,{usingOperation:!1,affectsData:!1,range:i})}))}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(L_)&&e.change((e=>{e.removeMarker(L_)}))}}function z_(e){return e.getAncestors().find((e=>u_(e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const $_=4,Z_=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),W_=2;class H_ extends a.Z{static get requires(){return[kd]}static get pluginName(){return"AutoLink"}init(){const e=this.editor,t=e.model.document.selection;t.on("change:range",(()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")})),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling()}_enableTypingHandling(){const e=this.editor,t=new Vd(e.model,(e=>{if(!U_(e))return;const t=q_(e.substr(0,e.length-1));return t?{url:t}:void 0})),i=e.plugins.get("Input");t.on("matched:data",((t,n)=>{const{batch:o,range:s,url:r}=n;if(!i.isInput(o))return;const a=s.end.getShiftedBy(-1),l=a.getShiftedBy(-r.length),c=e.model.createRange(l,a);this._applyAutoLink(r,c)})),t.bind("isEnabled").to(this)}_enableEnterHandling(){const e=this.editor,t=e.model,i=e.commands.get("enter");i&&i.on("execute",(()=>{const e=t.document.selection.getFirstPosition();if(!e.parent.previousSibling)return;const i=t.createRangeIn(e.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(i)}))}_enableShiftEnterHandling(){const e=this.editor,t=e.model,i=e.commands.get("shiftEnter");i&&i.on("execute",(()=>{const e=t.document.selection.getFirstPosition(),i=t.createRange(t.createPositionAt(e.parent,0),e.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(i)}))}_checkAndApplyAutoLinkOnRange(e){const t=this.editor.model,{text:i,range:n}=xd(e,t),o=q_(i);if(o){const e=t.createRange(n.end.getShiftedBy(-o.length),n.end);this._applyAutoLink(o,e)}}_applyAutoLink(e,t){const i=this.editor.model,n=this.editor.plugins.get("Delete");this.isEnabled&&G_(t,i)&&i.enqueueChange((o=>{const s=this.editor.config.get("link.defaultProtocol"),r=__(e,s);o.setAttribute("linkHref",r,t),i.enqueueChange((()=>{n.requestUndoOnBackspace()}))}))}}function U_(e){return e.length>$_&&" "===e[e.length-1]&&" "!==e[e.length-2]}function q_(e){const t=Z_.exec(e);return t?t[W_]:null}function G_(e,t){return t.schema.checkAttributeInSelection(t.createSelection(e),"linkHref")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class j_ extends a.Z{static get requires(){return[P_,F_,H_]}static get pluginName(){return"Link"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class K_ extends b.Z{constructor(e,t){super(e),this.type=t}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.document,n=Array.from(i.selection.getSelectedBlocks()).filter((e=>Y_(e,t.schema))),o=void 0!==e.forceValue?!e.forceValue:this.value;t.change((e=>{if(o){let t=n[n.length-1].nextSibling,i=Number.POSITIVE_INFINITY,o=[];while(t&&"listItem"==t.name&&0!==t.getAttribute("listIndent")){const e=t.getAttribute("listIndent");e<i&&(i=e);const n=e-i;o.push({element:t,listIndent:n}),t=t.nextSibling}o=o.reverse();for(const n of o)e.setAttribute("listIndent",n.listIndent,n.element)}if(!o){let e=Number.POSITIVE_INFINITY;for(const t of n)t.is("element","listItem")&&t.getAttribute("listIndent")<e&&(e=t.getAttribute("listIndent"));e=0===e?1:e,J_(n,!0,e),J_(n,!1,e)}for(const t of n.reverse())o&&"listItem"==t.name?e.rename(t,"paragraph"):o||"listItem"==t.name?o||"listItem"!=t.name||t.getAttribute("listType")==this.type||e.setAttribute("listType",this.type,t):(e.setAttributes({listType:this.type,listIndent:0},t),e.rename(t,"listItem"));this.fire("_executeCleanup",n)}))}_getValue(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("element","listItem")&&e.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&Y_(i,t)}}function J_(e,t,i){const n=t?e[0]:e[e.length-1];if(n.is("element","listItem")){let o=n[t?"previousSibling":"nextSibling"],s=n.getAttribute("listIndent");while(o&&o.is("element","listItem")&&o.getAttribute("listIndent")>=i)s>o.getAttribute("listIndent")&&(s=o.getAttribute("listIndent")),o.getAttribute("listIndent")==s&&e[t?"unshift":"push"](o),o=o[t?"previousSibling":"nextSibling"]}}function Y_(e,t){return t.checkChild(e.parent,"listItem")&&!t.isObject(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Q_ extends b.Z{constructor(e,t){super(e),this._indentBy="forward"==t?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document;let i=Array.from(t.selection.getSelectedBlocks());e.change((e=>{const t=i[i.length-1];let n=t.nextSibling;while(n&&"listItem"==n.name&&n.getAttribute("listIndent")>t.getAttribute("listIndent"))i.push(n),n=n.nextSibling;this._indentBy<0&&(i=i.reverse());for(const o of i){const t=o.getAttribute("listIndent")+this._indentBy;t<0?e.rename(o,"paragraph"):e.setAttribute("listIndent",t,o)}this.fire("_executeCleanup",i)}))}_checkEnabled(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("element","listItem"))return!1;if(this._indentBy>0){const t=e.getAttribute("listIndent"),i=e.getAttribute("listType");let n=e.previousSibling;while(n&&n.is("element","listItem")&&n.getAttribute("listIndent")>=t){if(n.getAttribute("listIndent")==t)return n.getAttribute("listType")==i;n=n.previousSibling}return!1}return!0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function X_(e){const t=e.createContainerElement("li");return t.getFillerOffset=ay,t}function ey(e,t){const i=t.mapper,n=t.writer,o="numbered"==e.getAttribute("listType")?"ol":"ul",s=X_(n),r=n.createContainerElement(o,null);return n.insert(n.createPositionAt(r,0),s),i.bindElements(e,s),s}function ty(e,t,i,n){const o=t.parent,s=i.mapper,r=i.writer;let a=s.toViewPosition(n.createPositionBefore(e));const l=oy(e.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:e.getAttribute("listIndent")}),c=e.previousSibling;if(l&&l.getAttribute("listIndent")==e.getAttribute("listIndent")){const e=s.toViewElement(l);a=r.breakContainer(r.createPositionAfter(e))}else if(c&&"listItem"==c.name){a=s.toViewPosition(n.createPositionAt(c,"end"));const e=s.findMappedViewAncestor(a),t=ry(e);a=t?r.createPositionBefore(t):r.createPositionAt(e,"end")}else a=s.toViewPosition(n.createPositionBefore(e));if(a=ny(a),r.insert(a,o),c&&"listItem"==c.name){const e=s.toViewElement(c),i=r.createRange(r.createPositionAt(e,0),a),n=i.getWalker({ignoreElementEnd:!0});for(const o of n)if(o.item.is("element","li")){const e=r.breakContainer(r.createPositionBefore(o.item)),i=o.item.parent,s=r.createPositionAt(t,"end");iy(r,s.nodeBefore,s.nodeAfter),r.move(r.createRangeOn(i),s),n.position=e}}else{const i=o.nextSibling;if(i&&(i.is("element","ul")||i.is("element","ol"))){let n=null;for(const t of i.getChildren()){const i=s.toModelElement(t);if(!(i&&i.getAttribute("listIndent")>e.getAttribute("listIndent")))break;n=t}n&&(r.breakContainer(r.createPositionAfter(n)),r.move(r.createRangeOn(n.parent),r.createPositionAt(t,"end")))}}iy(r,o,o.nextSibling),iy(r,o.previousSibling,o)}function iy(e,t,i){return!t||!i||"ul"!=t.name&&"ol"!=t.name||t.name!=i.name||t.getAttribute("class")!==i.getAttribute("class")?null:e.mergeContainers(e.createPositionAfter(t))}function ny(e){return e.getLastMatchingPosition((e=>e.item.is("uiElement")))}function oy(e,t){const i=!!t.sameIndent,n=!!t.smallerIndent,o=t.listIndent;let s=e;while(s&&"listItem"==s.name){const e=s.getAttribute("listIndent");if(i&&o==e||n&&o>e)return s;s="forward"===t.direction?s.nextSibling:s.previousSibling}return null}function sy(e,t,i,n){e.ui.componentFactory.add(t,(o=>{const s=e.commands.get(t),r=new l.Z(o);return r.set({label:i,icon:n,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(s,"value","isEnabled"),r.on("execute",(()=>{e.execute(t),e.editing.view.focus()})),r}))}function ry(e){for(const t of e.getChildren())if("ul"==t.name||"ol"==t.name)return t;return null}function ay(){const e=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||e?0:De.call(this)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ly(e){return(t,i,n)=>{const o=n.consumable;if(!o.test(i.item,"insert")||!o.test(i.item,"attribute:listType")||!o.test(i.item,"attribute:listIndent"))return;o.consume(i.item,"insert"),o.consume(i.item,"attribute:listType"),o.consume(i.item,"attribute:listIndent");const s=i.item,r=ey(s,n);ty(s,r,n,e)}}function cy(e){return(t,i,n)=>{const o=n.mapper.toViewPosition(i.position),s=o.getLastMatchingPosition((e=>!e.item.is("element","li"))),r=s.nodeAfter,a=n.writer;a.breakContainer(a.createPositionBefore(r)),a.breakContainer(a.createPositionAfter(r));const l=r.parent,c=l.previousSibling,d=a.createRangeOn(l),h=a.remove(d);c&&c.nextSibling&&iy(a,c,c.nextSibling);const u=n.mapper.toModelElement(r);xy(u.getAttribute("listIndent")+1,i.position,d.start,r,n,e);for(const e of a.createRangeIn(h).getItems())n.mapper.unbindViewElement(e);t.stop()}}function dy(e,t,i){if(!i.consumable.consume(t.item,"attribute:listType"))return;const n=i.mapper.toViewElement(t.item),o=i.writer;o.breakContainer(o.createPositionBefore(n)),o.breakContainer(o.createPositionAfter(n));const s=n.parent,r="numbered"==t.attributeNewValue?"ol":"ul";o.rename(r,s)}function hy(e,t,i){const n=i.mapper.toViewElement(t.item),o=n.parent,s=i.writer;iy(s,o,o.nextSibling),iy(s,o.previousSibling,o);for(const r of t.item.getChildren())i.consumable.consume(r,"insert")}function uy(e){return(t,i,n)=>{if(!n.consumable.consume(i.item,"attribute:listIndent"))return;const o=n.mapper.toViewElement(i.item),s=n.writer;s.breakContainer(s.createPositionBefore(o)),s.breakContainer(s.createPositionAfter(o));const r=o.parent,a=r.previousSibling,l=s.createRangeOn(r);s.remove(l),a&&a.nextSibling&&iy(s,a,a.nextSibling),xy(i.attributeOldValue+1,i.range.start,l.start,o,n,e),ty(i.item,o,n,e);for(const e of i.item.getChildren())n.consumable.consume(e,"insert")}}function my(e,t,i){if("listItem"!=t.item.name){let e=i.mapper.toViewPosition(t.range.start);const n=i.writer,o=[];while("ul"==e.parent.name||"ol"==e.parent.name){if(e=n.breakContainer(e),"li"!=e.parent.name)break;const t=e,i=n.createPositionAt(e.parent,"end");if(!t.isEqual(i)){const e=n.remove(n.createRange(t,i));o.push(e)}e=n.createPositionAfter(e.parent)}if(o.length>0){for(let t=0;t<o.length;t++){const i=e.nodeBefore,s=n.insert(e,o[t]);if(e=s.end,t>0){const t=iy(n,i,i.nextSibling);t&&t.parent==i&&e.offset--}}iy(n,e.nodeBefore,e.nodeAfter)}}}function gy(e,t,i){const n=i.mapper.toViewPosition(t.position),o=n.nodeBefore,s=n.nodeAfter;iy(i.writer,o,s)}function py(e,t,i){if(i.consumable.consume(t.viewItem,{name:!0})){const e=i.writer,n=e.createElement("listItem"),o=Ay(t.viewItem);e.setAttribute("listIndent",o,n);const s=t.viewItem.parent&&"ol"==t.viewItem.parent.name?"numbered":"bulleted";if(e.setAttribute("listType",s,n),!i.safeInsert(n,t.modelCursor))return;const r=ky(n,t.viewItem.getChildren(),i);t.modelRange=e.createRange(t.modelCursor,r),i.updateConversionResult(n,t)}}function fy(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){const e=Array.from(t.viewItem.getChildren());for(const t of e){const e=!(t.is("element","li")||Vy(t));e&&t._remove()}}}function wy(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){if(0===t.viewItem.childCount)return;const e=[...t.viewItem.getChildren()];let i=!1;for(const t of e)i&&!Vy(t)&&t._remove(),Vy(t)&&(i=!0)}}function by(e){return(t,i)=>{if(i.isPhantom)return;const n=i.modelPosition.nodeBefore;if(n&&n.is("element","listItem")){const t=i.mapper.toViewElement(n),o=t.getAncestors().find(Vy),s=e.createPositionAt(t,0).getWalker();for(const e of s){if("elementStart"==e.type&&e.item.is("element","li")){i.viewPosition=e.previousPosition;break}if("elementEnd"==e.type&&e.item==o){i.viewPosition=e.nextPosition;break}}}}}function vy(e){return(t,i)=>{const n=i.viewPosition,o=n.parent,s=i.mapper;if("ul"==o.name||"ol"==o.name){if(n.isAtEnd){const t=s.toModelElement(n.nodeBefore),o=s.getModelLength(n.nodeBefore);i.modelPosition=e.createPositionBefore(t).getShiftedBy(o)}else{const t=s.toModelElement(n.nodeAfter);i.modelPosition=e.createPositionBefore(t)}t.stop()}else if("li"==o.name&&n.nodeBefore&&("ul"==n.nodeBefore.name||"ol"==n.nodeBefore.name)){const r=s.toModelElement(o);let a=1,l=n.nodeBefore;while(l&&Vy(l))a+=s.getModelLength(l),l=l.previousSibling;i.modelPosition=e.createPositionBefore(r).getShiftedBy(a),t.stop()}}}function _y(e,t){const i=e.document.differ.getChanges(),n=new Map;let o=!1;for(const l of i)if("insert"==l.type&&"listItem"==l.name)s(l.position);else if("insert"==l.type&&"listItem"!=l.name){if("$text"!=l.name){const i=l.position.nodeAfter;i.hasAttribute("listIndent")&&(t.removeAttribute("listIndent",i),o=!0),i.hasAttribute("listType")&&(t.removeAttribute("listType",i),o=!0),i.hasAttribute("listStyle")&&(t.removeAttribute("listStyle",i),o=!0);for(const t of Array.from(e.createRangeIn(i)).filter((e=>e.item.is("element","listItem"))))s(t.previousPosition)}const i=l.position.getShiftedBy(l.length);s(i)}else"remove"==l.type&&"listItem"==l.name?s(l.position):("attribute"==l.type&&"listIndent"==l.attributeKey||"attribute"==l.type&&"listType"==l.attributeKey)&&s(l.range.start);for(const l of n.values())r(l),a(l);return o;function s(e){const t=e.nodeBefore;if(t&&t.is("element","listItem")){let e=t;if(n.has(e))return;for(let t=e.previousSibling;t&&t.is("element","listItem");t=e.previousSibling)if(e=t,n.has(e))return;n.set(t,e)}else{const t=e.nodeAfter;t&&t.is("element","listItem")&&n.set(t,t)}}function r(e){let i=0,n=null;while(e&&e.is("element","listItem")){const s=e.getAttribute("listIndent");if(s>i){let r;null===n?(n=s-i,r=i):(n>s&&(n=s),r=s-n),t.setAttribute("listIndent",r,e),o=!0}else n=null,i=e.getAttribute("listIndent")+1;e=e.nextSibling}}function a(e){let i=[],n=null;while(e&&e.is("element","listItem")){const s=e.getAttribute("listIndent");if(n&&n.getAttribute("listIndent")>s&&(i=i.slice(0,s+1)),0!=s)if(i[s]){const n=i[s];e.getAttribute("listType")!=n&&(t.setAttribute("listType",n,e),o=!0)}else i[s]=e.getAttribute("listType");n=e,e=e.nextSibling}}}function yy(e,[t,i]){let n,o=t.is("documentFragment")?t.getChild(0):t;if(n=i?this.createSelection(i):this.document.selection,o&&o.is("element","listItem")){const e=n.getFirstPosition();let t=null;if(e.parent.is("element","listItem")?t=e.parent:e.nodeBefore&&e.nodeBefore.is("element","listItem")&&(t=e.nodeBefore),t){const e=t.getAttribute("listIndent");if(e>0)while(o&&o.is("element","listItem"))o._setAttribute("listIndent",o.getAttribute("listIndent")+e),o=o.nextSibling}}}function ky(e,t,i){const{writer:n,schema:o}=i;let s=n.createPositionAfter(e);for(const r of t)if("ul"==r.name||"ol"==r.name)s=i.convertItem(r,s).modelCursor;else{const t=i.convertItem(r,n.createPositionAt(e,"end")),a=t.modelRange.start.nodeAfter,l=a&&a.is("element")&&!o.checkChild(e,a.name);l&&(e=t.modelCursor.parent.is("element","listItem")?t.modelCursor.parent:Cy(t.modelCursor),s=n.createPositionAfter(e))}return s}function Cy(e){const t=new Vn({startPosition:e});let i;do{i=t.next()}while(!i.value.item.is("element","listItem"));return i.value.item}function xy(e,t,i,n,o,s){const r=oy(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:e,foo:"b"}),a=o.mapper,l=o.writer,c=r?r.getAttribute("listIndent"):null;let d;if(r)if(c==e){const e=a.toViewElement(r).parent;d=l.createPositionAfter(e)}else{const e=s.createPositionAt(r,"end");d=a.toViewPosition(e)}else d=i;d=ny(d);for(const h of[...n.getChildren()])Vy(h)&&(d=l.move(l.createRangeOn(h),d).end,iy(l,h,h.nextSibling),iy(l,h.previousSibling,h))}function Vy(e){return e.is("element","ol")||e.is("element","ul")}function Ay(e){let t=0,i=e.parent;while(i){if(i.is("element","li"))t++;else{const e=i.previousSibling;e&&e.is("element","li")&&t++}i=i.parent}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ey extends a.Z{static get pluginName(){return"ListEditing"}static get requires(){return[lm,kd]}init(){const e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const t=e.data,i=e.editing;e.model.document.registerPostFixer((t=>_y(e.model,t))),i.mapper.registerViewToModelLength("li",Ty),t.mapper.registerViewToModelLength("li",Ty),i.mapper.on("modelToViewPosition",by(i.view)),i.mapper.on("viewToModelPosition",vy(e.model)),t.mapper.on("modelToViewPosition",by(i.view)),e.conversion.for("editingDowncast").add((t=>{t.on("insert",my,{priority:"high"}),t.on("insert:listItem",ly(e.model)),t.on("attribute:listType:listItem",dy,{priority:"high"}),t.on("attribute:listType:listItem",hy,{priority:"low"}),t.on("attribute:listIndent:listItem",uy(e.model)),t.on("remove:listItem",cy(e.model)),t.on("remove",gy,{priority:"low"})})),e.conversion.for("dataDowncast").add((t=>{t.on("insert",my,{priority:"high"}),t.on("insert:listItem",ly(e.model))})),e.conversion.for("upcast").add((e=>{e.on("element:ul",fy,{priority:"high"}),e.on("element:ol",fy,{priority:"high"}),e.on("element:li",wy,{priority:"high"}),e.on("element:li",py)})),e.model.on("insertContent",yy,{priority:"high"}),e.commands.add("numberedList",new K_(e,"numbered")),e.commands.add("bulletedList",new K_(e,"bulleted")),e.commands.add("indentList",new Q_(e,"forward")),e.commands.add("outdentList",new Q_(e,"backward"));const n=i.view.document;this.listenTo(n,"enter",((e,t)=>{const i=this.editor.model.document,n=i.selection.getLastPosition().parent;i.selection.isCollapsed&&"listItem"==n.name&&n.isEmpty&&(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),{context:"li"}),this.listenTo(n,"delete",((e,t)=>{if("backward"!==t.direction)return;const i=this.editor.model.document.selection;if(!i.isCollapsed)return;const n=i.getFirstPosition();if(!n.isAtStart)return;const o=n.parent;if("listItem"!==o.name)return;const s=o.previousSibling&&"listItem"===o.previousSibling.name;s||(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),{context:"li"});const o=e=>(t,i)=>{const n=this.editor.commands.get(e);n.isEnabled&&(this.editor.execute(e),i())};e.keystrokes.set("Tab",o("indentList")),e.keystrokes.set("Shift+Tab",o("outdentList"))}afterInit(){const e=this.editor.commands,t=e.get("indent"),i=e.get("outdent");t&&t.registerChildCommand(e.get("indentList")),i&&i.registerChildCommand(e.get("outdentList"))}}function Ty(e){let t=1;for(const i of e.getChildren())if("ul"==i.name||"ol"==i.name)for(const e of i.getChildren())t+=Ty(e);return t}var Py='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Sy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Iy extends a.Z{static get pluginName(){return"ListUI"}init(){const e=this.editor.t;sy(this.editor,"numberedList",e("Numbered List"),Py),sy(this.editor,"bulletedList",e("Bulleted List"),Sy)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ny extends a.Z{static get requires(){return[Ey,Iy]}static get pluginName(){return"List"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const By="todoListChecked";class Ry extends b.Z{constructor(e){super(e),this._selectedElements=[],this.on("execute",(()=>{this.refresh()}),{priority:"highest"})}refresh(){this._selectedElements=this._getSelectedItems(),this.value=this._selectedElements.every((e=>!!e.getAttribute("todoListChecked"))),this.isEnabled=!!this._selectedElements.length}_getSelectedItems(){const e=this.editor.model,t=e.schema,i=e.document.selection.getFirstRange(),n=i.start.parent,o=[];t.checkAttribute(n,By)&&o.push(n);for(const s of i.getItems())t.checkAttribute(s,By)&&!o.includes(s)&&o.push(s);return o}execute(e={}){this.editor.model.change((t=>{for(const i of this._selectedElements){const n=void 0===e.forceValue?!this.value:e.forceValue;n?t.setAttribute(By,!0,i):t.removeAttribute(By,i)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Dy(e,t){return(i,n,o)=>{const s=o.consumable;if(!s.test(n.item,"insert")||!s.test(n.item,"attribute:listType")||!s.test(n.item,"attribute:listIndent"))return;if("todo"!=n.item.getAttribute("listType"))return;const r=n.item;s.consume(r,"insert"),s.consume(r,"attribute:listType"),s.consume(r,"attribute:listIndent"),s.consume(r,"attribute:todoListChecked");const a=o.writer,l=ey(r,o),c=!!r.getAttribute("todoListChecked"),d=$y(r,a,c,t),h=a.createContainerElement("span",{class:"todo-list__label__description"});a.addClass("todo-list",l.parent),a.insert(a.createPositionAt(l,0),d),a.insert(a.createPositionAfter(d),h),ty(r,l,o,e)}}function My(e){return(t,i,n)=>{const o=n.consumable;if(!o.test(i.item,"insert")||!o.test(i.item,"attribute:listType")||!o.test(i.item,"attribute:listIndent"))return;if("todo"!=i.item.getAttribute("listType"))return;const s=i.item;o.consume(s,"insert"),o.consume(s,"attribute:listType"),o.consume(s,"attribute:listIndent"),o.consume(s,"attribute:todoListChecked");const r=n.writer,a=ey(s,n);r.addClass("todo-list",a.parent);const l=r.createContainerElement("label",{class:"todo-list__label"}),c=r.createEmptyElement("input",{type:"checkbox",disabled:"disabled"}),d=r.createContainerElement("span",{class:"todo-list__label__description"});s.getAttribute("todoListChecked")&&r.setAttribute("checked","checked",c),r.insert(r.createPositionAt(a,0),l),r.insert(r.createPositionAt(l,0),c),r.insert(r.createPositionAfter(c),d),ty(s,a,n,e)}}function Oy(e,t,i){const n=t.modelCursor,o=n.parent,s=t.viewItem;if("checkbox"!=s.getAttribute("type")||"listItem"!=o.name||!n.isAtStart)return;if(!i.consumable.consume(s,{name:!0}))return;const r=i.writer;r.setAttribute("listType","todo",o),t.viewItem.hasAttribute("checked")&&r.setAttribute("todoListChecked",!0,o),t.modelRange=r.createRange(n)}function Ly(e,t){return(i,n,o)=>{const s=o.mapper.toViewElement(n.item),r=o.writer,a=Zy(s,t);if("todo"==n.attributeNewValue){const t=!!n.item.getAttribute("todoListChecked"),i=$y(n.item,r,t,e),o=r.createContainerElement("span",{class:"todo-list__label__description"}),a=r.createRangeIn(s),l=ry(s),c=ny(a.start),d=l?r.createPositionBefore(l):a.end,h=r.createRange(c,d);r.addClass("todo-list",s.parent),r.move(h,r.createPositionAt(o,0)),r.insert(r.createPositionAt(s,0),i),r.insert(r.createPositionAfter(i),o)}else if("todo"==n.attributeOldValue){const e=Wy(s,t);r.removeClass("todo-list",s.parent),r.remove(a),r.move(r.createRangeIn(e),r.createPositionBefore(e)),r.remove(e)}}}function Fy(e){return(t,i,n)=>{if("todo"!=i.item.getAttribute("listType"))return;if(!n.consumable.consume(i.item,"attribute:todoListChecked"))return;const{mapper:o,writer:s}=n,r=!!i.item.getAttribute("todoListChecked"),a=o.toViewElement(i.item),l=a.getChild(0),c=$y(i.item,s,r,e);s.insert(s.createPositionAfter(l),c),s.remove(l)}}function zy(e){return(t,i)=>{const n=i.modelPosition,o=n.parent;if(!o.is("element","listItem")||"todo"!=o.getAttribute("listType"))return;const s=i.mapper.toViewElement(o),r=Wy(s,e);r&&(i.viewPosition=i.mapper.findPositionIn(r,n.offset))}}function $y(e,t,i,n){const o=t.createUIElement("label",{class:"todo-list__label",contenteditable:!1},(function(t){const o=$i(document,"input",{type:"checkbox"});i&&o.setAttribute("checked","checked"),o.addEventListener("change",(()=>n(e)));const s=this.toDomElement(t);return s.appendChild(o),s}));return o}function Zy(e,t){const i=t.createRangeIn(e);for(const n of i)if(n.item.is("uiElement","label"))return n.item}function Wy(e,t){const i=t.createRangeIn(e);for(const n of i)if(n.item.is("containerElement","span")&&n.item.hasClass("todo-list__label__description"))return n.item}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Hy=(0,ct.Zz)("Ctrl+Enter");class Uy extends a.Z{static get pluginName(){return"TodoListEditing"}static get requires(){return[Ey]}init(){const e=this.editor,{editing:t,data:i,model:n}=e;n.schema.extend("listItem",{allowAttributes:["todoListChecked"]}),n.schema.addAttributeCheck(((e,t)=>{const i=e.last;if("todoListChecked"==t&&"listItem"==i.name&&"todo"!=i.getAttribute("listType"))return!1})),e.commands.add("todoList",new K_(e,"todo"));const o=new Ry(e);e.commands.add("checkTodoList",o),e.commands.add("todoListCheck",o),i.downcastDispatcher.on("insert:listItem",My(n),{priority:"high"}),i.upcastDispatcher.on("element:input",Oy,{priority:"high"}),t.downcastDispatcher.on("insert:listItem",Dy(n,(e=>this._handleCheckmarkChange(e))),{priority:"high"}),t.downcastDispatcher.on("attribute:listType:listItem",Ly((e=>this._handleCheckmarkChange(e)),t.view)),t.downcastDispatcher.on("attribute:todoListChecked:listItem",Fy((e=>this._handleCheckmarkChange(e)))),t.mapper.on("modelToViewPosition",zy(t.view)),i.mapper.on("modelToViewPosition",zy(t.view)),this.listenTo(t.view.document,"arrowKey",qy(n,e.locale),{context:"li"}),this.listenTo(t.view.document,"keydown",((t,i)=>{(0,ct.Cq)(i)===Hy&&(e.execute("checkTodoList"),t.stop())}),{priority:"high"});const s=new Set;this.listenTo(n,"applyOperation",((e,t)=>{const i=t[0];if("rename"==i.type&&"listItem"==i.oldName){const e=i.position.nodeAfter;e.hasAttribute("todoListChecked")&&s.add(e)}else if("changeAttribute"==i.type&&"listType"==i.key&&"todo"===i.oldValue)for(const n of i.range.getItems())n.hasAttribute("todoListChecked")&&"todo"!==n.getAttribute("listType")&&s.add(n)})),n.document.registerPostFixer((e=>{let t=!1;for(const i of s)e.removeAttribute("todoListChecked",i),t=!0;return s.clear(),t}))}_handleCheckmarkChange(e){const t=this.editor,i=t.model,n=Array.from(i.document.selection.getRanges());i.change((i=>{i.setSelection(e,"end"),t.execute("checkTodoList"),i.setSelection(n)}))}}function qy(e,t){return(i,n)=>{const o=(0,ct.mA)(n.keyCode,t.contentLanguageDirection);if("left"!=o)return;const s=e.schema,r=e.document.selection;if(!r.isCollapsed)return;const a=r.getFirstPosition(),l=a.parent;if("listItem"===l.name&&"todo"==l.getAttribute("listType")&&a.isAtStart){const t=s.getNearestSelectionRange(e.createPositionBefore(l),"backward");t&&e.change((e=>e.setSelection(t))),n.preventDefault(),n.stopPropagation(),i.stop()}}}var Gy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jy extends a.Z{static get pluginName(){return"TodoListUI"}init(){const e=this.editor.t;sy(this.editor,"todoList",e("To-do List"),Gy)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ky extends a.Z{static get requires(){return[Uy,jy]}static get pluginName(){return"TodoList"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Jy(e,t){return e=>{e.on("attribute:url:media",i)};function i(i,n,o){if(!o.consumable.consume(n.item,i.name))return;const s=n.attributeNewValue,r=o.writer,a=o.mapper.toViewElement(n.item),l=[...a.getChildren()].find((e=>e.getCustomProperty("media-content")));r.remove(l);const c=e.getMediaViewElement(r,s,t);r.insert(r.createPositionAt(a,0),c)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Yy(e,t,i){return t.setCustomProperty("media",!0,e),fg(e,t,{label:i})}function Qy(e,t,i,n){const o=e.createContainerElement("figure",{class:"media"});return e.insert(e.createPositionAt(o,0),t.getMediaViewElement(e,i,n)),o}function Xy(e){const t=e.getSelectedElement();return t&&t.is("element","media")?t:null}function ek(e,t,i){e.change((n=>{const o=n.createElement("media",{url:t});e.insertContent(o,i),n.setSelection(o,"on")}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tk extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=Xy(t);this.value=i?i.getAttribute("url"):null,this.isEnabled=nk(t)||ik(t,e)}execute(e){const t=this.editor.model,i=t.document.selection,n=Xy(i);n?t.change((t=>{t.setAttribute("url",e,n)})):ek(t,e,Cg(i,t))}}function ik(e,t){const i=Cg(e,t);let n=i.start.parent;return n.isEmpty&&!t.schema.isLimit(n)&&(n=n.parent),t.schema.checkChild(n,"media")}function nk(e){const t=e.getSelectedElement();return!!t&&"media"===t.name}var ok='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sk="0 0 64 42";class rk{constructor(e,t){const i=t.providers,n=t.extraProviders||[],o=new Set(t.removeProviders),s=i.concat(n).filter((e=>{const t=e.name;return t?!o.has(t):((0,P.KE)("media-embed-no-provider-name",{provider:e}),!1)}));this.locale=e,this.providerDefinitions=s}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,i){return this._getMedia(t).getViewElement(e,i)}_getMedia(e){if(!e)return new ak(this.locale);e=e.trim();for(const t of this.providerDefinitions){const i=t.html,n=(0,B.Z)(t.url);for(const t of n){const n=this._getUrlMatches(e,t);if(n)return new ak(this.locale,e,n,i)}}return null}_getUrlMatches(e,t){let i=e.match(t);if(i)return i;let n=e.replace(/^https?:\/\//,"");return i=n.match(t),i||(n=n.replace(/^www\./,""),i=n.match(t),i||null)}}class ak{constructor(e,t,i,n){this.url=this._getValidUrl(t),this._t=e.t,this._match=i,this._previewRenderer=n}getViewElement(e,t){const i={};let n;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(i["data-oembed-url"]=this.url),t.renderForEditingView&&(i.class="ck-media__wrapper");const o=this._getPreviewHtml(t);n=e.createRawElement("div",i,((e,t)=>{t.setContentOf(e,o)}))}else this.url&&(i.url=this.url),n=e.createEmptyElement(t.elementName,i);return e.setCustomProperty("media-content",!0,n),n}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new Xc.Z,t=new Jl.Z;e.text=this._t("Open media in new tab"),t.content=ok,t.viewBox=sk;const i=new Ol.ZP({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[t]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},e]}]}).render();return i.outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lk extends a.Z{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`}},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`}},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`}},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new rk(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,i=e.t,n=e.conversion,o=e.config.get("mediaEmbed.previewsInData"),s=e.config.get("mediaEmbed.elementName"),r=this.registry;e.commands.add("mediaEmbed",new tk(e)),t.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),n.for("dataDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const i=e.getAttribute("url");return Qy(t,r,i,{elementName:s,renderMediaPreview:i&&o})}}),n.for("dataDowncast").add(Jy(r,{elementName:s,renderMediaPreview:o})),n.for("editingDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const n=e.getAttribute("url"),o=Qy(t,r,n,{elementName:s,renderForEditingView:!0});return Yy(o,t,i("media widget"))}}),n.for("editingDowncast").add(Jy(r,{elementName:s,renderForEditingView:!0})),n.for("upcast").elementToElement({view:e=>["oembed",s].includes(e.name)&&e.getAttribute("url")?{name:!0}:null,model:(e,{writer:t})=>{const i=e.getAttribute("url");if(r.hasMedia(i))return t.createElement("media",{url:i})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(e,{writer:t})=>{const i=e.getAttribute("data-oembed-url");if(r.hasMedia(i))return t.createElement("media",{url:i})}}).add((e=>{function t(e,t,i){if(!i.consumable.consume(t.viewItem,{name:!0,classes:"media"}))return;const{modelRange:n,modelCursor:o}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=n,t.modelCursor=o;const s=(0,Xi.Z)(n.getItems());s||i.consumable.revert(t.viewItem,{name:!0,classes:"media"})}e.on("element:figure",t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ck=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class dk extends a.Z{static get requires(){return[cp,kd,Ap]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document;this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",(()=>{const e=t.selection.getFirstRange(),i=Ir.fromPosition(e.start);i.stickiness="toPrevious";const n=Ir.fromPosition(e.end);n.stickiness="toNext",t.once("change:data",(()=>{this._embedMediaBetweenPositions(i,n),i.detach(),n.detach()}),{priority:"high"})})),e.commands.get("undo").on("execute",(()=>{this._timeoutId&&(ri.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)}),{priority:"high"})}_embedMediaBetweenPositions(e,t){const i=this.editor,n=i.plugins.get(lk).registry,o=new qn(e,t),s=o.getWalker({ignoreElementEnd:!0});let r="";for(const l of s)l.item.is("$textProxy")&&(r+=l.item.data);if(r=r.trim(),!r.match(ck))return void o.detach();if(!n.hasMedia(r))return void o.detach();const a=i.commands.get("mediaEmbed");a.isEnabled?(this._positionToInsert=Ir.fromPosition(e),this._timeoutId=ri.window.setTimeout((()=>{i.model.change((e=>{let t;this._timeoutId=null,e.remove(o),o.detach(),"$graveyard"!==this._positionToInsert.root.rootName&&(t=this._positionToInsert),ek(i.model,r,t),this._positionToInsert.detach(),this._positionToInsert=null})),i.plugins.get("Delete").requestUndoOnBackspace()}),100)):o.detach()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hk extends cl.Z{constructor(e,t){super(t);const i=t.t;this.focusTracker=new en,this.keystrokes=new tn,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),sl.check,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",(e=>!!e)),this.cancelButtonView=this._createButton(i("Cancel"),sl.cancel,"ck-button-cancel","cancel"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]}),Dl(this)}render(){super.render(),Ml({view:this});const e=[this.urlInputView,this.saveButtonView,this.cancelButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element);const t=e=>e.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t),this.listenTo(this.urlInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new Rc(this.locale,Dc),i=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,i.on("input",(()=>{t.infoText=i.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=i.element.value.trim()})),t}_createButton(e,t,i,n){const o=new l.Z(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:i}}),n&&o.delegate("execute").to(this,n),o}}var uk='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mk extends a.Z{static get requires(){return[lk]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,t=e.commands.get("mediaEmbed"),i=e.plugins.get(lk).registry;e.ui.componentFactory.add("mediaEmbed",(n=>{const o=vc(n),s=new hk(gk(e.t,i),e.locale);return this._setUpDropdown(o,s,t,e),this._setUpForm(o,s,t),o}))}_setUpDropdown(e,t,i){const n=this.editor,o=n.t,s=e.buttonView;function r(){n.editing.view.focus(),e.isOpen=!1}e.bind("isEnabled").to(i),e.panelView.children.add(t),s.set({label:o("Insert media"),icon:uk,tooltip:!0}),s.on("open",(()=>{t.disableCssTransitions(),t.url=i.value||"",t.urlInputView.fieldView.select(),t.focus(),t.enableCssTransitions()}),{priority:"low"}),e.on("submit",(()=>{t.isValid()&&(n.execute("mediaEmbed",t.url),r())})),e.on("change:isOpen",(()=>t.resetFormStatus())),e.on("cancel",(()=>r()))}_setUpForm(e,t,i){t.delegate("submit","cancel").to(e),t.urlInputView.bind("value").to(i,"value"),t.urlInputView.bind("isReadOnly").to(i,"isEnabled",(e=>!e))}}function gk(e,t){return[t=>{if(!t.url.length)return e("The URL must not be empty.")},i=>{if(!t.hasMedia(i.url))return e("This media URL is not supported.")}]}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pk extends a.Z{static get requires(){return[lk,mk,dk,Gg]}static get pluginName(){return"MediaEmbed"}}var fk=i(76920),wk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const bk="removeFormat";class vk extends a.Z{static get pluginName(){return"RemoveFormatUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(bk,(i=>{const n=e.commands.get(bk),o=new l.Z(i);return o.set({label:t("Remove Format"),icon:wk,tooltip:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute(bk),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _k extends b.Z{refresh(){const e=this.editor.model;this.isEnabled=!!(0,Xi.Z)(this._getFormattingItems(e.document.selection,e.schema))}execute(){const e=this.editor.model,t=e.schema;e.change((i=>{for(const n of this._getFormattingItems(e.document.selection,t))if(n.is("selection"))for(const e of this._getFormattingAttributes(n,t))i.removeSelectionAttribute(e);else{const e=i.createRangeOn(n);for(const o of this._getFormattingAttributes(n,t))i.removeAttribute(o,e)}}))}*_getFormattingItems(e,t){const i=e=>!!(0,Xi.Z)(this._getFormattingAttributes(e,t));for(const n of e.getRanges())for(const e of n.getItems())!t.isBlock(e)&&i(e)&&(yield e);for(const n of e.getSelectedBlocks())i(n)&&(yield n);i(e)&&(yield e)}*_getFormattingAttributes(e,t){for(const[i]of e.getAttributes()){const e=t.getAttributeProperties(i);e&&e.isFormatting&&(yield i)}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yk extends a.Z{static get pluginName(){return"RemoveFormatEditing"}init(){const e=this.editor;e.commands.add("removeFormat",new _k(e))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kk extends a.Z{static get requires(){return[yk,vk]}static get pluginName(){return"RemoveFormat"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ck(e){const t=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"br",isVoid:!0},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"input",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"pre",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"textarea",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],i=t.map((e=>e.name)).join("|"),n=e.replace(new RegExp(`</?(${i})( .*?)?>`,"g"),"\n$&\n").split("\n");let o=0;return n.filter((e=>e.length)).map((e=>xk(e,t)?Ak(e,o++):Vk(e,t)?Ak(e,--o):Ak(e,o))).join("\n")}function xk(e,t){return t.some((t=>!t.isVoid&&!!new RegExp(`<${t.name}( .*?)?>`).test(e)))}function Vk(e,t){return t.some((t=>new RegExp(`</${t.name}>`).test(e)))}function Ak(e,t,i="    "){return`${i.repeat(t)}${e}`}var Ek='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Tk="SourceEditingMode";class Pk extends a.Z{static get pluginName(){return"SourceEditing"}static get requires(){return[Pa]}constructor(e){super(e),this.set("isSourceEditingMode",!1),this._elementReplacer=new Di,this._replacedRoots=new Map,this._dataFromRoots=new Map}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("sourceEditing",(i=>{const n=new l.Z(i);return n.set({label:t("Source"),icon:Ek,tooltip:!0,withText:!0,class:"ck-source-editing-button"}),n.bind("isOn").to(this,"isSourceEditingMode"),n.bind("isEnabled").to(this,"isEnabled",e,"isReadOnly",e.plugins.get(Pa),"hasAny",((e,t,i)=>!!e&&(!t&&!i))),this.listenTo(n,"execute",(()=>{this.isSourceEditingMode=!this.isSourceEditingMode})),n})),this._isAllowedToHandleSourceEditingMode()&&(this.on("change:isSourceEditingMode",((e,t,i)=>{i?(this._showSourceEditing(),this._disableCommands()):(this._hideSourceEditing(),this._enableCommands())})),this.on("change:isEnabled",((e,t,i)=>this._handleReadOnlyMode(!i))),this.listenTo(e,"change:isReadOnly",((e,t,i)=>this._handleReadOnlyMode(i)))),e.data.on("get",(()=>{this.isSourceEditingMode&&this._updateEditorData()}),{priority:"high"})}afterInit(){const e=this.editor,t=["RealTimeCollaborativeEditing","CommentsEditing","TrackChangesEditing","RevisionHistory"];t.some((t=>e.plugins.has(t)))&&console.warn("You initialized the editor with the source editing feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing feature and restricted editing feature. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.")}_showSourceEditing(){const e=this.editor,t=e.editing.view,i=e.model;i.change((e=>{e.setSelection(null),e.removeSelectionAttribute(i.document.selection.getAttributeKeys())}));for(const[n,o]of t.domRoots){const i=Sk(e.data.get({rootName:n})),s=$i(o.ownerDocument,"textarea",{rows:"1"}),r=$i(o.ownerDocument,"div",{class:"ck-source-editing-area","data-value":i},[s]);s.value=i,s.setSelectionRange(0,0),s.addEventListener("input",(()=>{r.dataset.value=s.value})),t.change((e=>{const i=t.document.getRoot(n);e.addClass("ck-hidden",i)})),this._replacedRoots.set(n,r),this._elementReplacer.replace(o,r),this._dataFromRoots.set(n,i)}this._focusSourceEditing()}_hideSourceEditing(){const e=this.editor,t=e.editing.view;this._updateEditorData(),t.change((e=>{for(const[i]of this._replacedRoots)e.removeClass("ck-hidden",t.document.getRoot(i))})),this._elementReplacer.restore(),this._replacedRoots.clear(),this._dataFromRoots.clear(),t.focus()}_updateEditorData(){const e=this.editor,t={};for(const[i,n]of this._replacedRoots){const e=this._dataFromRoots.get(i),o=n.dataset.value;e!==o&&(t[i]=o)}Object.keys(t).length&&e.data.set(t,{batchType:"default"})}_focusSourceEditing(){const[e]=this._replacedRoots.values(),t=e.querySelector("textarea");t.focus()}_disableCommands(){const e=this.editor;for(const t of e.commands.commands())t.forceDisabled(Tk)}_enableCommands(){const e=this.editor;for(const t of e.commands.commands())t.clearForceDisabled(Tk)}_handleReadOnlyMode(e){if(this.isSourceEditingMode)for(const[,t]of this._replacedRoots)t.querySelector("textarea").readOnly=e}_isAllowedToHandleSourceEditingMode(){const e=this.editor,t=e.ui.view.editable;return t&&!t._hasExternalElement}}function Sk(e){return Ik(e)?Ck(e):e}function Ik(e){return e.startsWith("<")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nk extends Ic{constructor(e,t){super(e);const i=e.t;this.set("class","ck-special-characters-navigation"),this.groupDropdownView=this._createGroupDropdown(t),this.groupDropdownView.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",this.label=i("Special characters"),this.children.add(this.groupDropdownView)}get currentGroupName(){return this.groupDropdownView.value}_createGroupDropdown(e){const t=this.locale,i=t.t,n=vc(t),o=this._getCharacterGroupListItemDefinitions(n,e);return n.set("value",o.first.model.label),n.buttonView.bind("label").to(n,"value"),n.buttonView.set({isOn:!1,withText:!0,tooltip:i("Character categories"),class:["ck-dropdown__button_label-width_auto"]}),n.on("execute",(e=>{n.value=e.source.label})),n.delegate("execute").to(this),yc(n,o),n}_getCharacterGroupListItemDefinitions(e,t){const i=new T.Z;for(const n of t){const t={type:"button",model:new Lc({label:n,withText:!0})};t.model.bind("isOn").to(e,"value",(e=>e===t.model.label)),i.add(t)}return i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bk extends cl.Z{constructor(e){super(e),this.tiles=this.createCollection(),this.setTemplate({tag:"div",children:[{tag:"div",attributes:{class:["ck","ck-character-grid__tiles"]},children:this.tiles}],attributes:{class:["ck","ck-character-grid"]}})}createTile(e,t){const i=new l.Z(this.locale);return i.set({label:e,withText:!0,class:"ck-character-grid__tile"}),i.extendTemplate({attributes:{title:t},on:{mouseover:i.bindTemplate.to("mouseover")}}),i.on("mouseover",(()=>{this.fire("tileHover",{name:t,character:e})})),i.on("execute",(()=>{this.fire("execute",{name:t,character:e})})),i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rk extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("character",null),this.set("name",null),this.bind("code").to(this,"character",Dk),this.setTemplate({tag:"div",children:[{tag:"span",attributes:{class:["ck-character-info__name"]},children:[{text:t.to("name",(e=>e||"​"))}]},{tag:"span",attributes:{class:["ck-character-info__code"]},children:[{text:t.to("code")}]}],attributes:{class:["ck","ck-character-info"]}})}}function Dk(e){if(null===e)return"";const t=e.codePointAt(0).toString(16);return"U+"+("0000"+t).slice(-4)}var Mk='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2.5a7.47 7.47 0 0 1 4.231 1.31 7.268 7.268 0 0 1 2.703 3.454 7.128 7.128 0 0 1 .199 4.353c-.39 1.436-1.475 2.72-2.633 3.677h2.013c0-.226.092-.443.254-.603a.876.876 0 0 1 1.229 0c.163.16.254.377.254.603v.853c0 .209-.078.41-.22.567a.873.873 0 0 1-.547.28l-.101.006h-4.695a.517.517 0 0 1-.516-.518v-1.265c0-.21.128-.398.317-.489a5.601 5.601 0 0 0 2.492-2.371 5.459 5.459 0 0 0 .552-3.693 5.53 5.53 0 0 0-1.955-3.2A5.71 5.71 0 0 0 10 4.206 5.708 5.708 0 0 0 6.419 5.46 5.527 5.527 0 0 0 4.46 8.663a5.457 5.457 0 0 0 .554 3.695 5.6 5.6 0 0 0 2.497 2.37.55.55 0 0 1 .317.49v1.264c0 .286-.23.518-.516.518H2.618a.877.877 0 0 1-.614-.25.845.845 0 0 1-.254-.603v-.853c0-.226.091-.443.254-.603a.876.876 0 0 1 1.228 0c.163.16.255.377.255.603h1.925c-1.158-.958-2.155-2.241-2.545-3.678a7.128 7.128 0 0 1 .199-4.352 7.268 7.268 0 0 1 2.703-3.455A7.475 7.475 0 0 1 10 2.5z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ok="All";class Lk extends a.Z{static get requires(){return[Cd]}static get pluginName(){return"SpecialCharacters"}constructor(e){super(e),this._characters=new Map,this._groups=new Map}init(){const e=this.editor,t=e.t,i=e.commands.get("input");e.ui.componentFactory.add("specialCharacters",(n=>{const o=vc(n);let s;return o.buttonView.set({label:t("Special characters"),icon:Mk,tooltip:!0}),o.bind("isEnabled").to(i),o.on("execute",((t,i)=>{e.execute("input",{text:i.character}),e.editing.view.focus()})),o.on("change:isOpen",(()=>{s||(s=this._createDropdownPanelContent(n,o),o.panelView.children.add(s.navigationView),o.panelView.children.add(s.gridView),o.panelView.children.add(s.infoView)),s.infoView.set({character:null,name:null})})),o}))}addItems(e,t){if(e===Ok)throw new P.ZP(`special-character-invalid-group-name: The name "${Ok}" is reserved and cannot be used.`);const i=this._getGroup(e);for(const n of t)i.add(n.title),this._characters.set(n.title,n.character)}getGroups(){return this._groups.keys()}getCharactersForGroup(e){return e===Ok?new Set(this._characters.keys()):this._groups.get(e)}getCharacter(e){return this._characters.get(e)}_getGroup(e){return this._groups.has(e)||this._groups.set(e,new Set),this._groups.get(e)}_updateGrid(e,t){t.tiles.clear();const i=this.getCharactersForGroup(e);for(const n of i){const e=this.getCharacter(n);t.tiles.add(t.createTile(e,n))}}_createDropdownPanelContent(e,t){const i=[...this.getGroups()];i.unshift(Ok);const n=new Nk(e,i),o=new Bk(e),s=new Rk(e);return o.delegate("execute").to(t),o.on("tileHover",((e,t)=>{s.set(t)})),n.on("execute",(()=>{this._updateGrid(n.currentGroupName,o)})),this._updateGrid(n.currentGroupName,o),{navigationView:n,gridView:o,infoView:s}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fk extends a.Z{static get pluginName(){return"SpecialCharactersCurrency"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Currency",[{character:"$",title:t("Dollar sign")},{character:"€",title:t("Euro sign")},{character:"¥",title:t("Yen sign")},{character:"£",title:t("Pound sign")},{character:"¢",title:t("Cent sign")},{character:"₠",title:t("Euro-currency sign")},{character:"₡",title:t("Colon sign")},{character:"₢",title:t("Cruzeiro sign")},{character:"₣",title:t("French franc sign")},{character:"₤",title:t("Lira sign")},{character:"¤",title:t("Currency sign")},{character:"₿",title:t("Bitcoin sign")},{character:"₥",title:t("Mill sign")},{character:"₦",title:t("Naira sign")},{character:"₧",title:t("Peseta sign")},{character:"₨",title:t("Rupee sign")},{character:"₩",title:t("Won sign")},{character:"₪",title:t("New sheqel sign")},{character:"₫",title:t("Dong sign")},{character:"₭",title:t("Kip sign")},{character:"₮",title:t("Tugrik sign")},{character:"₯",title:t("Drachma sign")},{character:"₰",title:t("German penny sign")},{character:"₱",title:t("Peso sign")},{character:"₲",title:t("Guarani sign")},{character:"₳",title:t("Austral sign")},{character:"₴",title:t("Hryvnia sign")},{character:"₵",title:t("Cedi sign")},{character:"₶",title:t("Livre tournois sign")},{character:"₷",title:t("Spesmilo sign")},{character:"₸",title:t("Tenge sign")},{character:"₹",title:t("Indian rupee sign")},{character:"₺",title:t("Turkish lira sign")},{character:"₻",title:t("Nordic mark sign")},{character:"₼",title:t("Manat sign")},{character:"₽",title:t("Ruble sign")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zk extends a.Z{static get pluginName(){return"SpecialCharactersMathematical"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Mathematical",[{character:"<",title:t("Less-than sign")},{character:">",title:t("Greater-than sign")},{character:"≤",title:t("Less-than or equal to")},{character:"≥",title:t("Greater-than or equal to")},{character:"–",title:t("En dash")},{character:"—",title:t("Em dash")},{character:"¯",title:t("Macron")},{character:"‾",title:t("Overline")},{character:"°",title:t("Degree sign")},{character:"−",title:t("Minus sign")},{character:"±",title:t("Plus-minus sign")},{character:"÷",title:t("Division sign")},{character:"⁄",title:t("Fraction slash")},{character:"×",title:t("Multiplication sign")},{character:"ƒ",title:t("Latin small letter f with hook")},{character:"∫",title:t("Integral")},{character:"∑",title:t("N-ary summation")},{character:"∞",title:t("Infinity")},{character:"√",title:t("Square root")},{character:"∼",title:t("Tilde operator")},{character:"≅",title:t("Approximately equal to")},{character:"≈",title:t("Almost equal to")},{character:"≠",title:t("Not equal to")},{character:"≡",title:t("Identical to")},{character:"∈",title:t("Element of")},{character:"∉",title:t("Not an element of")},{character:"∋",title:t("Contains as member")},{character:"∏",title:t("N-ary product")},{character:"∧",title:t("Logical and")},{character:"∨",title:t("Logical or")},{character:"¬",title:t("Not sign")},{character:"∩",title:t("Intersection")},{character:"∪",title:t("Union")},{character:"∂",title:t("Partial differential")},{character:"∀",title:t("For all")},{character:"∃",title:t("There exists")},{character:"∅",title:t("Empty set")},{character:"∇",title:t("Nabla")},{character:"∗",title:t("Asterisk operator")},{character:"∝",title:t("Proportional to")},{character:"∠",title:t("Angle")},{character:"¼",title:t("Vulgar fraction one quarter")},{character:"½",title:t("Vulgar fraction one half")},{character:"¾",title:t("Vulgar fraction three quarters")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $k extends a.Z{static get pluginName(){return"SpecialCharactersArrows"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Arrows",[{title:t("leftwards double arrow"),character:"⇐"},{title:t("rightwards double arrow"),character:"⇒"},{title:t("upwards double arrow"),character:"⇑"},{title:t("downwards double arrow"),character:"⇓"},{title:t("leftwards dashed arrow"),character:"⇠"},{title:t("rightwards dashed arrow"),character:"⇢"},{title:t("upwards dashed arrow"),character:"⇡"},{title:t("downwards dashed arrow"),character:"⇣"},{title:t("leftwards arrow to bar"),character:"⇤"},{title:t("rightwards arrow to bar"),character:"⇥"},{title:t("upwards arrow to bar"),character:"⤒"},{title:t("downwards arrow to bar"),character:"⤓"},{title:t("up down arrow with base"),character:"↨"},{title:t("back with leftwards arrow above"),character:"🔙"},{title:t("end with leftwards arrow above"),character:"🔚"},{title:t("on with exclamation mark with left right arrow above"),character:"🔛"},{title:t("soon with rightwards arrow above"),character:"🔜"},{title:t("top with upwards arrow above"),character:"🔝"}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Zk extends a.Z{static get pluginName(){return"SpecialCharactersLatin"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Latin",[{character:"Ā",title:t("Latin capital letter a with macron")},{character:"ā",title:t("Latin small letter a with macron")},{character:"Ă",title:t("Latin capital letter a with breve")},{character:"ă",title:t("Latin small letter a with breve")},{character:"Ą",title:t("Latin capital letter a with ogonek")},{character:"ą",title:t("Latin small letter a with ogonek")},{character:"Ć",title:t("Latin capital letter c with acute")},{character:"ć",title:t("Latin small letter c with acute")},{character:"Ĉ",title:t("Latin capital letter c with circumflex")},{character:"ĉ",title:t("Latin small letter c with circumflex")},{character:"Ċ",title:t("Latin capital letter c with dot above")},{character:"ċ",title:t("Latin small letter c with dot above")},{character:"Č",title:t("Latin capital letter c with caron")},{character:"č",title:t("Latin small letter c with caron")},{character:"Ď",title:t("Latin capital letter d with caron")},{character:"ď",title:t("Latin small letter d with caron")},{character:"Đ",title:t("Latin capital letter d with stroke")},{character:"đ",title:t("Latin small letter d with stroke")},{character:"Ē",title:t("Latin capital letter e with macron")},{character:"ē",title:t("Latin small letter e with macron")},{character:"Ĕ",title:t("Latin capital letter e with breve")},{character:"ĕ",title:t("Latin small letter e with breve")},{character:"Ė",title:t("Latin capital letter e with dot above")},{character:"ė",title:t("Latin small letter e with dot above")},{character:"Ę",title:t("Latin capital letter e with ogonek")},{character:"ę",title:t("Latin small letter e with ogonek")},{character:"Ě",title:t("Latin capital letter e with caron")},{character:"ě",title:t("Latin small letter e with caron")},{character:"Ĝ",title:t("Latin capital letter g with circumflex")},{character:"ĝ",title:t("Latin small letter g with circumflex")},{character:"Ğ",title:t("Latin capital letter g with breve")},{character:"ğ",title:t("Latin small letter g with breve")},{character:"Ġ",title:t("Latin capital letter g with dot above")},{character:"ġ",title:t("Latin small letter g with dot above")},{character:"Ģ",title:t("Latin capital letter g with cedilla")},{character:"ģ",title:t("Latin small letter g with cedilla")},{character:"Ĥ",title:t("Latin capital letter h with circumflex")},{character:"ĥ",title:t("Latin small letter h with circumflex")},{character:"Ħ",title:t("Latin capital letter h with stroke")},{character:"ħ",title:t("Latin small letter h with stroke")},{character:"Ĩ",title:t("Latin capital letter i with tilde")},{character:"ĩ",title:t("Latin small letter i with tilde")},{character:"Ī",title:t("Latin capital letter i with macron")},{character:"ī",title:t("Latin small letter i with macron")},{character:"Ĭ",title:t("Latin capital letter i with breve")},{character:"ĭ",title:t("Latin small letter i with breve")},{character:"Į",title:t("Latin capital letter i with ogonek")},{character:"į",title:t("Latin small letter i with ogonek")},{character:"İ",title:t("Latin capital letter i with dot above")},{character:"ı",title:t("Latin small letter dotless i")},{character:"Ĳ",title:t("Latin capital ligature ij")},{character:"ĳ",title:t("Latin small ligature ij")},{character:"Ĵ",title:t("Latin capital letter j with circumflex")},{character:"ĵ",title:t("Latin small letter j with circumflex")},{character:"Ķ",title:t("Latin capital letter k with cedilla")},{character:"ķ",title:t("Latin small letter k with cedilla")},{character:"ĸ",title:t("Latin small letter kra")},{character:"Ĺ",title:t("Latin capital letter l with acute")},{character:"ĺ",title:t("Latin small letter l with acute")},{character:"Ļ",title:t("Latin capital letter l with cedilla")},{character:"ļ",title:t("Latin small letter l with cedilla")},{character:"Ľ",title:t("Latin capital letter l with caron")},{character:"ľ",title:t("Latin small letter l with caron")},{character:"Ŀ",title:t("Latin capital letter l with middle dot")},{character:"ŀ",title:t("Latin small letter l with middle dot")},{character:"Ł",title:t("Latin capital letter l with stroke")},{character:"ł",title:t("Latin small letter l with stroke")},{character:"Ń",title:t("Latin capital letter n with acute")},{character:"ń",title:t("Latin small letter n with acute")},{character:"Ņ",title:t("Latin capital letter n with cedilla")},{character:"ņ",title:t("Latin small letter n with cedilla")},{character:"Ň",title:t("Latin capital letter n with caron")},{character:"ň",title:t("Latin small letter n with caron")},{character:"ŉ",title:t("Latin small letter n preceded by apostrophe")},{character:"Ŋ",title:t("Latin capital letter eng")},{character:"ŋ",title:t("Latin small letter eng")},{character:"Ō",title:t("Latin capital letter o with macron")},{character:"ō",title:t("Latin small letter o with macron")},{character:"Ŏ",title:t("Latin capital letter o with breve")},{character:"ŏ",title:t("Latin small letter o with breve")},{character:"Ő",title:t("Latin capital letter o with double acute")},{character:"ő",title:t("Latin small letter o with double acute")},{character:"Œ",title:t("Latin capital ligature oe")},{character:"œ",title:t("Latin small ligature oe")},{character:"Ŕ",title:t("Latin capital letter r with acute")},{character:"ŕ",title:t("Latin small letter r with acute")},{character:"Ŗ",title:t("Latin capital letter r with cedilla")},{character:"ŗ",title:t("Latin small letter r with cedilla")},{character:"Ř",title:t("Latin capital letter r with caron")},{character:"ř",title:t("Latin small letter r with caron")},{character:"Ś",title:t("Latin capital letter s with acute")},{character:"ś",title:t("Latin small letter s with acute")},{character:"Ŝ",title:t("Latin capital letter s with circumflex")},{character:"ŝ",title:t("Latin small letter s with circumflex")},{character:"Ş",title:t("Latin capital letter s with cedilla")},{character:"ş",title:t("Latin small letter s with cedilla")},{character:"Š",title:t("Latin capital letter s with caron")},{character:"š",title:t("Latin small letter s with caron")},{character:"Ţ",title:t("Latin capital letter t with cedilla")},{character:"ţ",title:t("Latin small letter t with cedilla")},{character:"Ť",title:t("Latin capital letter t with caron")},{character:"ť",title:t("Latin small letter t with caron")},{character:"Ŧ",title:t("Latin capital letter t with stroke")},{character:"ŧ",title:t("Latin small letter t with stroke")},{character:"Ũ",title:t("Latin capital letter u with tilde")},{character:"ũ",title:t("Latin small letter u with tilde")},{character:"Ū",title:t("Latin capital letter u with macron")},{character:"ū",title:t("Latin small letter u with macron")},{character:"Ŭ",title:t("Latin capital letter u with breve")},{character:"ŭ",title:t("Latin small letter u with breve")},{character:"Ů",title:t("Latin capital letter u with ring above")},{character:"ů",title:t("Latin small letter u with ring above")},{character:"Ű",title:t("Latin capital letter u with double acute")},{character:"ű",title:t("Latin small letter u with double acute")},{character:"Ų",title:t("Latin capital letter u with ogonek")},{character:"ų",title:t("Latin small letter u with ogonek")},{character:"Ŵ",title:t("Latin capital letter w with circumflex")},{character:"ŵ",title:t("Latin small letter w with circumflex")},{character:"Ŷ",title:t("Latin capital letter y with circumflex")},{character:"ŷ",title:t("Latin small letter y with circumflex")},{character:"Ÿ",title:t("Latin capital letter y with diaeresis")},{character:"Ź",title:t("Latin capital letter z with acute")},{character:"ź",title:t("Latin small letter z with acute")},{character:"Ż",title:t("Latin capital letter z with dot above")},{character:"ż",title:t("Latin small letter z with dot above")},{character:"Ž",title:t("Latin capital letter z with caron")},{character:"ž",title:t("Latin small letter z with caron")},{character:"ſ",title:t("Latin small letter long s")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wk extends a.Z{static get pluginName(){return"SpecialCharactersText"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Text",[{character:"‹",title:t("Single left-pointing angle quotation mark")},{character:"›",title:t("Single right-pointing angle quotation mark")},{character:"«",title:t("Left-pointing double angle quotation mark")},{character:"»",title:t("Right-pointing double angle quotation mark")},{character:"‘",title:t("Left single quotation mark")},{character:"’",title:t("Right single quotation mark")},{character:"“",title:t("Left double quotation mark")},{character:"”",title:t("Right double quotation mark")},{character:"‚",title:t("Single low-9 quotation mark")},{character:"„",title:t("Double low-9 quotation mark")},{character:"¡",title:t("Inverted exclamation mark")},{character:"¿",title:t("Inverted question mark")},{character:"‥",title:t("Two dot leader")},{character:"…",title:t("Horizontal ellipsis")},{character:"‡",title:t("Double dagger")},{character:"‰",title:t("Per mille sign")},{character:"‱",title:t("Per ten thousand sign")},{character:"‼",title:t("Double exclamation mark")},{character:"⁈",title:t("Question exclamation mark")},{character:"⁉",title:t("Exclamation question mark")},{character:"⁇",title:t("Double question mark")},{character:"©",title:t("Copyright sign")},{character:"®",title:t("Registered sign")},{character:"™",title:t("Trade mark sign")},{character:"§",title:t("Section sign")},{character:"¶",title:t("Paragraph sign")},{character:"⁋",title:t("Reversed paragraph sign")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hk extends a.Z{static get requires(){return[Fk,Wk,zk,$k,Zk]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Uk(e,t,i,n,o=1){t>o?n.setAttribute(e,t,i):n.removeAttribute(e,i)}function qk(e,t,i={}){const n=e.createElement("tableCell",i);return e.insertElement("paragraph",n),e.insert(n,t),n}function Gk(e,t){const i=t.parent.parent,n=parseInt(i.getAttribute("headingColumns")||0),{column:o}=e.getCellLocation(t);return!!n&&o<n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jk(){return e=>{e.on("element:figure",((e,t,i)=>{if(!i.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;const n=Qk(t.viewItem);if(!n||!i.consumable.test(n,{name:!0}))return;i.consumable.consume(t.viewItem,{name:!0,classes:"table"});const o=i.convertItem(n,t.modelCursor),s=(0,Xi.Z)(o.modelRange.getItems());s?(i.convertChildren(t.viewItem,i.writer.createPositionAt(s,"end")),i.updateConversionResult(s,t)):i.consumable.revert(t.viewItem,{name:!0,classes:"table"})}))}}function Kk(){return e=>{e.on("element:table",((e,t,i)=>{const n=t.viewItem;if(!i.consumable.test(n,{name:!0}))return;const{rows:o,headingRows:s,headingColumns:r}=Xk(n),a={};r&&(a.headingColumns=r),s&&(a.headingRows=s);const l=i.writer.createElement("table",a);if(i.safeInsert(l,t.modelCursor)){if(i.consumable.consume(n,{name:!0}),o.forEach((e=>i.convertItem(e,i.writer.createPositionAt(l,"end")))),i.convertChildren(n,i.writer.createPositionAt(l,"end")),l.isEmpty){const e=i.writer.createElement("tableRow");i.writer.insert(e,i.writer.createPositionAt(l,"end")),qk(i.writer,i.writer.createPositionAt(e,"end"))}i.updateConversionResult(l,t)}}))}}function Jk(){return e=>{e.on("element:tr",((e,t)=>{t.viewItem.isEmpty&&0==t.modelCursor.index&&e.stop()}),{priority:"high"})}}function Yk(e){return t=>{t.on(`element:${e}`,((e,t,i)=>{if(t.modelRange&&t.viewItem.isEmpty){const e=t.modelRange.start.nodeAfter,n=i.writer.createPositionAt(e,0);i.writer.insertElement("paragraph",n)}}),{priority:"low"})}}function Qk(e){for(const t of e.getChildren())if(t.is("element","table"))return t}function Xk(e){const t={headingRows:0,headingColumns:0},i=[],n=[];let o;for(const s of Array.from(e.getChildren()))if("tbody"===s.name||"thead"===s.name||"tfoot"===s.name){"thead"!==s.name||o||(o=s);const e=Array.from(s.getChildren()).filter((e=>e.is("element","tr")));for(const s of e)if("thead"===s.parent.name&&s.parent===o)t.headingRows++,i.push(s);else{n.push(s);const e=eC(s,t,o);e>t.headingColumns&&(t.headingColumns=e)}}return t.rows=[...i,...n],t}function eC(e){let t=0,i=0;const n=Array.from(e.getChildren()).filter((e=>"th"===e.name||"td"===e.name));while(i<n.length&&"th"===n[i].name){const e=n[i],o=parseInt(e.getAttribute("colspan")||1);t+=o,i++}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tC{constructor(e,t={}){this._table=e,this._startRow=void 0!==t.row?t.row:t.startRow||0,this._endRow=void 0!==t.row?t.row:t.endRow,this._startColumn=void 0!==t.column?t.column:t.startColumn||0,this._endColumn=void 0!==t.column?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(i.cell,i.row,i.column));else{const i=e.getChild(this._cellIndex);if(!i)return this._advanceToNextRow();const n=parseInt(i.getAttribute("colspan")||1),o=parseInt(i.getAttribute("rowspan")||1);(n>1||o>1)&&this._recordSpans(i,o,n),this._shouldSkipSlot()||(t=this._formatOutValue(i)),this._nextCellAtColumn=this._column+n}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return void 0!==this._endRow&&this._row>this._endRow}_isOverEndColumn(){return void 0!==this._endColumn&&this._column>this._endColumn}_formatOutValue(e,t=this._row,i=this._column){return{done:!1,value:new iC(this,e,t,i)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,i=this._column<this._startColumn,n=void 0!==this._endColumn&&this._column>this._endColumn;return e||t||i||n}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,i){const n={cell:e,row:this._row,column:this._column};for(let o=this._row;o<this._row+t;o++)for(let e=this._column;e<this._column+i;e++)o==this._row&&e==this._column||this._markSpannedCell(o,e,n)}_markSpannedCell(e,t,i){this._spannedCells.has(e)||this._spannedCells.set(e,new Map);const n=this._spannedCells.get(e);n.set(t,i)}}class iC{constructor(e,t,i,n){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=i,this.cellAnchorColumn=n,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||1)}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||1)}get rowIndex(){return this._rowIndex}getPositionBefore(){const e=this._table.root.document.model;return e.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function nC(e={}){return t=>t.on("insert:table",((t,i,n)=>{const o=i.item;if(!n.consumable.consume(o,"insert"))return;n.consumable.consume(o,"attribute:headingRows:table"),n.consumable.consume(o,"attribute:headingColumns:table");const s=e&&e.asWidget,r=n.writer.createContainerElement("figure",{class:"table"}),a=n.writer.createContainerElement("table");let l;n.writer.insert(n.writer.createPositionAt(r,0),a),s&&(l=dC(r,n.writer));const c=new tC(o),d={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},h=new Map;for(const m of c){const{row:t,cell:i}=m,s=o.getChild(t),r=h.get(t)||gC(a,s,t,d,n);h.set(t,r),n.consumable.consume(i,"insert");const l=n.writer.createPositionAt(r,"end");mC(m,d,l,n,e)}for(const e of o.getChildren()){const t=e.index;e.is("element","tableRow")&&!h.has(t)&&h.set(t,gC(a,e,t,d,n))}const u=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(o,s?l:r),n.writer.insert(u,s?l:r)}))}function oC(){return e=>e.on("insert:tableRow",((e,t,i)=>{const n=t.item;if(!i.consumable.consume(n,"insert"))return;const o=n.parent,s=i.mapper.toViewElement(o),r=yC(s),a=o.getChildIndex(n),l=new tC(o,{row:a}),c={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},d=new Map;for(const h of l){const e=d.get(a)||gC(r,n,a,c,i);d.set(a,e),i.consumable.consume(h.cell,"insert");const t=i.writer.createPositionAt(e,"end");mC(h,c,t,i,{asWidget:!0})}}))}function sC(){return e=>e.on("insert:tableCell",((e,t,i)=>{const n=t.item;if(!i.consumable.consume(n,"insert"))return;const o=n.parent,s=o.parent,r=s.getChildIndex(o),a=new tC(s,{row:r}),l={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0};for(const c of a)if(c.cell===n){const e=i.mapper.toViewElement(o),t=i.writer.createPositionAt(e,o.getChildIndex(n));return void mC(c,l,t,i,{asWidget:!0})}}))}function rC(){return e=>e.on("attribute:headingColumns:table",((e,t,i)=>{const n=t.item;if(!i.consumable.consume(t.item,e.name))return;const o={headingRows:n.getAttribute("headingRows")||0,headingColumns:n.getAttribute("headingColumns")||0},s=t.attributeOldValue,r=t.attributeNewValue,a=(s>r?s:r)-1;for(const l of new tC(n,{endColumn:a}))uC(l,o,i)}))}function aC(){return e=>e.on("remove:tableRow",((e,t,i)=>{e.stop();const n=i.writer,o=i.mapper,s=o.toViewPosition(t.position).getLastMatchingPosition((e=>!e.item.is("element","tr"))),r=s.nodeAfter,a=r.parent,l=a.parent,c=n.createRangeOn(r),d=n.remove(c);for(const h of n.createRangeIn(d).getItems())o.unbindViewElement(h);_C("thead",l,i),_C("tbody",l,i)}),{priority:"higher"})}function lC(e,t){const{writer:i}=t;if(e.parent.is("element","tableCell"))return cC(e)?i.createContainerElement("span",{class:"ck-table-bogus-paragraph"}):i.createContainerElement("p")}function cC(e){const t=e.parent,i=1===t.childCount;return i&&!kC(e)}function dC(e,t){return t.setCustomProperty("table",!0,e),fg(e,t,{hasSelectionHandle:!0})}function hC(e,t,i){const n=i.writer,o=i.mapper.toViewElement(e),s=n.createEditableElement(t,o.getAttributes()),r=kg(s,n);n.insert(n.createPositionAfter(o),r),n.move(n.createRangeIn(o),n.createPositionAt(r,0)),n.remove(n.createRangeOn(o)),i.mapper.unbindViewElement(o),i.mapper.bindElements(e,r)}function uC(e,t,i){const{cell:n}=e,o=pC(e,t),s=i.mapper.toViewElement(n);s&&s.name!==o&&hC(n,o,i)}function mC(e,t,i,n,o){const s=o&&o.asWidget,r=pC(e,t),a=s?kg(n.writer.createEditableElement(r),n.writer):n.writer.createContainerElement(r),l=e.cell,c=l.getChild(0),d=1===l.childCount&&"paragraph"===c.name;if(n.writer.insert(i,a),n.mapper.bindElements(l,a),!s&&d&&!kC(c)){const e=l.getChild(0);n.consumable.consume(e,"insert"),n.mapper.bindElements(e,a)}}function gC(e,t,i,n,o){o.consumable.consume(t,"insert");const s=t.isEmpty?o.writer.createEmptyElement("tr"):o.writer.createContainerElement("tr");o.mapper.bindElements(t,s);const r=n.headingRows,a=wC(fC(i,n),e,o),l=r>0&&i>=r?i-r:i,c=o.writer.createPositionAt(a,l);return o.writer.insert(c,s),s}function pC(e,t){const{row:i,column:n}=e,{headingColumns:o,headingRows:s}=t,r=s&&s>i;if(r)return"th";const a=o&&o>n;return a?"th":"td"}function fC(e,t){return e<t.headingRows?"thead":"tbody"}function wC(e,t,i){const n=bC(e,t);return n||vC(e,t,i)}function bC(e,t){for(const i of t.getChildren())if(i.name==e)return i}function vC(e,t,i){const n=i.writer.createContainerElement(e),o=i.writer.createPositionAt(t,"tbody"==e?"end":0);return i.writer.insert(o,n),n}function _C(e,t,i){const n=bC(e,t);n&&0===n.childCount&&i.writer.remove(i.writer.createRangeOn(n))}function yC(e){for(const t of e.getChildren())if("table"===t.name)return t}function kC(e){return!![...e.getAttributeKeys()].length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class CC extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=e.schema;this.isEnabled=xC(t,i)}execute(e={}){const t=this.editor.model,i=t.document.selection,n=this.editor.plugins.get("TableUtils"),o=this.editor.config.get("table"),s=Cg(i,t),r=o.defaultHeadings.rows,a=o.defaultHeadings.columns;void 0===e.headingRows&&r&&(e.headingRows=r),void 0===e.headingColumns&&a&&(e.headingColumns=a),t.change((i=>{const o=n.createTable(i,e);t.insertContent(o,s),i.setSelection(i.createPositionAt(o.getNodeByPath([0,0,0]),0))}))}}function xC(e,t){const i=e.getFirstPosition().parent,n=i===i.root?i:i.parent;return t.checkChild(n,"table")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function VC(e){const t=[];for(const i of IC(e.getRanges())){const e=i.getContainedElement();e&&e.is("element","tableCell")&&t.push(e)}return t}function AC(e){const t=[];for(const i of e.getRanges()){const e=i.start.findAncestor("tableCell");e&&t.push(e)}return t}function EC(e){const t=VC(e);return t.length?t:AC(e)}function TC(e){const t=e.map((e=>e.parent.index));return NC(t)}function PC(e){const t=e[0].findAncestor("table"),i=[...new tC(t)],n=i.filter((t=>e.includes(t.cell))).map((e=>e.column));return NC(n)}function SC(e,t){if(e.length<2||!DC(e))return!1;const i=new Set,n=new Set;let o=0;for(const r of e){const{row:e,column:s}=t.getCellLocation(r),a=parseInt(r.getAttribute("rowspan")||1),l=parseInt(r.getAttribute("colspan")||1);i.add(e),n.add(s),a>1&&i.add(e+a-1),l>1&&n.add(s+l-1),o+=a*l}const s=RC(i,n);return s==o}function IC(e){return Array.from(e).sort(BC)}function NC(e){const t=e.sort(((e,t)=>e-t)),i=t[0],n=t[t.length-1];return{first:i,last:n}}function BC(e,t){const i=e.start,n=t.start;return i.isBefore(n)?-1:1}function RC(e,t){const i=Array.from(e.values()),n=Array.from(t.values()),o=Math.max(...i),s=Math.min(...i),r=Math.max(...n),a=Math.min(...n);return(o-s+1)*(r-a+1)}function DC(e){const t=e[0].findAncestor("table"),i=TC(e),n=parseInt(t.getAttribute("headingRows")||0);if(!MC(i,n))return!1;const o=parseInt(t.getAttribute("headingColumns")||0),s=PC(e);return MC(s,o)}function MC({first:e,last:t},i){const n=e<i,o=t<i;return n===o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class OC extends b.Z{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection,t=!!EC(e).length;this.isEnabled=t}execute(){const e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),n="above"===this.order,o=EC(t),s=TC(o),r=n?s.first:s.last,a=o[0].findAncestor("table");i.insertRows(a,{at:n?r:r+1,copyStructureFromAbove:!n})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class LC extends b.Z{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection,t=!!EC(e).length;this.isEnabled=t}execute(){const e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),n="left"===this.order,o=EC(t),s=PC(o),r=n?s.first:s.last,a=o[0].findAncestor("table");i.insertColumns(a,{columns:1,at:n?r:r+1})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class FC extends b.Z{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const e=EC(this.editor.model.document.selection);this.isEnabled=1===e.length}execute(){const e=EC(this.editor.model.document.selection)[0],t="horizontally"===this.direction,i=this.editor.plugins.get("TableUtils");t?i.splitCellHorizontally(e,2):i.splitCellVertically(e,2)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zC(e,t,i){const{startRow:n,startColumn:o,endRow:s,endColumn:r}=t,a=i.createElement("table"),l=s-n+1;for(let d=0;d<l;d++)i.insertElement("tableRow",a,"end");const c=[...new tC(e,{startRow:n,endRow:s,startColumn:o,endColumn:r,includeAllSlots:!0})];for(const{row:d,column:h,cell:u,isAnchor:m,cellAnchorRow:g,cellAnchorColumn:p}of c){const e=d-n,t=a.getChild(e);if(m){const e=i.cloneElement(u);i.append(e,t),UC(e,d,h,s,r,i)}else(g<n||p<o)&&qk(i,i.createPositionAt(t,"end"))}return qC(a,e,n,o,i),a}function $C(e,t,i=0){const n=[],o=new tC(e,{startRow:i,endRow:t-1});for(const s of o){const{row:e,cellHeight:i}=s,o=e+i-1;e<t&&t<=o&&n.push(s)}return n}function ZC(e,t,i){const n=e.parent,o=n.parent,s=n.index,r=parseInt(e.getAttribute("rowspan")),a=t-s,l={},c=r-a;c>1&&(l.rowspan=c);const d=parseInt(e.getAttribute("colspan")||1);d>1&&(l.colspan=d);const h=s,u=h+a,m=[...new tC(o,{startRow:h,endRow:u,includeAllSlots:!0})];let g,p=null;for(const f of m){const{row:t,column:n,cell:o}=f;o===e&&void 0===g&&(g=n),void 0!==g&&g===n&&t===u&&(p=qk(i,f.getPositionBefore(),l))}return Uk("rowspan",a,e,i),p}function WC(e,t){const i=[],n=new tC(e);for(const o of n){const{column:e,cellWidth:n}=o,s=e+n-1;e<t&&t<=s&&i.push(o)}return i}function HC(e,t,i,n){const o=parseInt(e.getAttribute("colspan")),s=i-t,r={},a=o-s;a>1&&(r.colspan=a);const l=parseInt(e.getAttribute("rowspan")||1);l>1&&(r.rowspan=l);const c=qk(n,n.createPositionAfter(e),r);return Uk("colspan",s,e,n),c}function UC(e,t,i,n,o,s){const r=parseInt(e.getAttribute("colspan")||1),a=parseInt(e.getAttribute("rowspan")||1),l=i+r-1;if(l>o){const t=o-i+1;Uk("colspan",t,e,s,1)}const c=t+a-1;if(c>n){const i=n-t+1;Uk("rowspan",i,e,s,1)}}function qC(e,t,i,n,o){const s=parseInt(t.getAttribute("headingRows")||0);if(s>0){const t=s-i;Uk("headingRows",t,e,o,0)}const r=parseInt(t.getAttribute("headingColumns")||0);if(r>0){const t=r-n;Uk("headingColumns",t,e,o,0)}}function GC(e,t){const i=t.getColumns(e),n=new Array(i).fill(0);for(const{column:s}of new tC(e))n[s]++;const o=n.reduce(((e,t,i)=>t?e:[...e,i]),[]);if(o.length>0){const i=o[o.length-1];return t.removeColumns(e,{at:i}),!0}return!1}function jC(e,t){const i=[],n=t.getRows(e);for(let o=0;o<n;o++){const t=e.getChild(o);t.isEmpty&&i.push(o)}if(i.length>0){const n=i[i.length-1];return t.removeRows(e,{at:n}),!0}return!1}function KC(e,t){const i=GC(e,t);i||jC(e,t)}function JC(e,t){const i=Array.from(new tC(e,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow})),n=i.every((({cellHeight:e})=>1===e));if(n)return t.lastRow;const o=i[0].cellHeight-1;return t.lastRow+o}function YC(e,t){const i=Array.from(new tC(e,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn})),n=i.every((({cellWidth:e})=>1===e));if(n)return t.lastColumn;const o=i[0].cellWidth-1;return t.lastColumn+o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class QC extends b.Z{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=e.document,i=AC(t.selection)[0],n=this.value,o=this.direction;e.change((e=>{const t="right"==o||"down"==o,s=t?i:n,r=t?n:i,a=r.parent;tx(r,s,e);const l=this.isHorizontal?"colspan":"rowspan",c=parseInt(i.getAttribute(l)||1),d=parseInt(n.getAttribute(l)||1);e.setAttribute(l,c+d,s),e.setSelection(e.createRangeIn(s));const h=this.editor.plugins.get("TableUtils"),u=a.findAncestor("table");KC(u,h)}))}_getMergeableCell(){const e=this.editor.model,t=e.document,i=AC(t.selection)[0];if(!i)return;const n=this.editor.plugins.get("TableUtils"),o=this.isHorizontal?XC(i,this.direction,n):ex(i,this.direction,n);if(!o)return;const s=this.isHorizontal?"rowspan":"colspan",r=parseInt(i.getAttribute(s)||1),a=parseInt(o.getAttribute(s)||1);return a===r?o:void 0}}function XC(e,t,i){const n=e.parent,o=n.parent,s="right"==t?e.nextSibling:e.previousSibling,r=(o.getAttribute("headingColumns")||0)>0;if(!s)return;const a="right"==t?e:s,l="right"==t?s:e,{column:c}=i.getCellLocation(a),{column:d}=i.getCellLocation(l),h=parseInt(a.getAttribute("colspan")||1),u=Gk(i,a,o),m=Gk(i,l,o);if(r&&u!=m)return;const g=c+h===d;return g?s:void 0}function ex(e,t,i){const n=e.parent,o=n.parent,s=o.getChildIndex(n);if("down"==t&&s===i.getRows(o)-1||"up"==t&&0===s)return;const r=parseInt(e.getAttribute("rowspan")||1),a=o.getAttribute("headingRows")||0,l="down"==t&&s+r===a,c="up"==t&&s===a;if(a&&(l||c))return;const d=parseInt(e.getAttribute("rowspan")||1),h="down"==t?s+d:s,u=[...new tC(o,{endRow:h})],m=u.find((t=>t.cell===e)),g=m.column,p=u.find((({row:e,cellHeight:i,column:n})=>n===g&&("down"==t?e===h:h===e+i)));return p&&p.cell}function tx(e,t,i){ix(e)||(ix(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e)}function ix(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nx extends b.Z{refresh(){const e=EC(this.editor.model.document.selection),t=e[0];if(t){const i=t.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getRows(i),o=n-1,s=TC(e),r=0===s.first&&s.last===o;this.isEnabled=!r}else this.isEnabled=!1}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),i=EC(e.document.selection),n=TC(i),o=i[0],s=o.findAncestor("table"),r=t.getCellLocation(o).column;e.change((e=>{const i=n.last-n.first+1;t.removeRows(s,{at:n.first,rows:i});const o=ox(s,n.first,r,t.getRows(s));e.setSelection(e.createPositionAt(o,0))}))}}function ox(e,t,i,n){const o=e.getChild(Math.min(t,n-1));let s=o.getChild(0),r=0;for(const a of o.getChildren()){if(r>i)return s;s=a,r+=parseInt(a.getAttribute("colspan")||1)}return s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sx extends b.Z{refresh(){const e=EC(this.editor.model.document.selection),t=e[0];if(t){const i=t.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getColumns(i),{first:o,last:s}=PC(e);this.isEnabled=s-o<n-1}else this.isEnabled=!1}execute(){const[e,t]=ax(this.editor.model.document.selection),i=e.parent.parent,n=[...new tC(i)],o={first:n.find((t=>t.cell===e)).column,last:n.find((e=>e.cell===t)).column},s=rx(n,e,t,o);this.editor.model.change((e=>{const t=o.last-o.first+1;this.editor.plugins.get("TableUtils").removeColumns(i,{at:o.first,columns:t}),e.setSelection(e.createPositionAt(s,0))}))}}function rx(e,t,i,n){const o=parseInt(i.getAttribute("colspan")||1);return o>1?i:t.previousSibling||i.nextSibling?i.nextSibling||t.previousSibling:n.first?e.reverse().find((({column:e})=>e<n.first)).cell:e.reverse().find((({column:e})=>e>n.last)).cell}function ax(e){const t=EC(e),i=t[0],n=t.pop(),o=[i,n];return i.isBefore(n)?o:o.reverse()}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lx extends b.Z{refresh(){const e=this.editor.model,t=EC(e.document.selection),i=t.length>0;this.isEnabled=i,this.value=i&&t.every((e=>this._isInHeading(e,e.parent.parent)))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,i=EC(t.document.selection),n=i[0].findAncestor("table"),{first:o,last:s}=TC(i),r=this.value?o:s+1,a=n.getAttribute("headingRows")||0;t.change((e=>{if(r){const t=r>a?a:0,i=$C(n,r,t);for(const{cell:n}of i)ZC(n,r,e)}Uk("headingRows",r,n,e,0)}))}_isInHeading(e,t){const i=parseInt(t.getAttribute("headingRows")||0);return!!i&&e.parent.index<i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cx extends b.Z{refresh(){const e=this.editor.model,t=EC(e.document.selection),i=this.editor.plugins.get("TableUtils"),n=t.length>0;this.isEnabled=n,this.value=n&&t.every((e=>Gk(i,e)))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,i=EC(t.document.selection),n=i[0].findAncestor("table"),{first:o,last:s}=PC(i),r=this.value?o:s+1;t.change((e=>{if(r){const t=WC(n,r);for(const{cell:i,column:n}of t)HC(i,n,r,e)}Uk("headingColumns",r,n,e,0)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dx extends a.Z{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,i=t.parent,n=i.getChildIndex(t),o=new tC(i,{row:n});for(const{cell:s,row:r,column:a}of o)if(s===e)return{row:r,column:a}}createTable(e,t){const i=e.createElement("table"),n=parseInt(t.rows)||2,o=parseInt(t.columns)||2;return hx(e,i,0,n,o),t.headingRows&&Uk("headingRows",Math.min(t.headingRows,n),i,e,0),t.headingColumns&&Uk("headingColumns",Math.min(t.headingColumns,o),i,e,0),i}insertRows(e,t={}){const i=this.editor.model,n=t.at||0,o=t.rows||1,s=void 0!==t.copyStructureFromAbove,r=t.copyStructureFromAbove?n-1:n,a=this.getRows(e),l=this.getColumns(e);if(n>a)throw new P.ZP("tableutils-insertrows-insert-out-of-range",this,{options:t});i.change((t=>{const i=e.getAttribute("headingRows")||0;if(i>n&&Uk("headingRows",i+o,e,t,0),!s&&(0===n||n===a))return void hx(t,e,n,o,l);const c=s?Math.max(n,r):n,d=new tC(e,{endRow:c}),h=new Array(l).fill(1);for(const{row:e,column:a,cellHeight:l,cellWidth:u,cell:m}of d){const i=e+l-1,c=e<n&&n<=i,d=e<=r&&r<=i;c?(t.setAttribute("rowspan",l+o,m),h[a]=-u):s&&d&&(h[a]=u)}for(let s=0;s<o;s++){const i=t.createElement("tableRow");t.insert(i,e,n);for(let e=0;e<h.length;e++){const n=h[e],o=t.createPositionAt(i,"end");n>0&&qk(t,o,n>1?{colspan:n}:null),e+=Math.abs(n)-1}}}))}insertColumns(e,t={}){const i=this.editor.model,n=t.at||0,o=t.columns||1;i.change((t=>{const i=e.getAttribute("headingColumns");n<i&&t.setAttribute("headingColumns",i+o,e);const s=this.getColumns(e);if(0===n||s===n){for(const i of e.getChildren())i.is("element","tableRow")&&ux(o,t,t.createPositionAt(i,n?"end":0));return}const r=new tC(e,{column:n,includeAllSlots:!0});for(const e of r){const{row:i,cell:s,cellAnchorColumn:a,cellAnchorRow:l,cellWidth:c,cellHeight:d}=e;if(a<n){t.setAttribute("colspan",c+o,s);const e=l+d-1;for(let t=i;t<=e;t++)r.skipRow(t)}else ux(o,t,e.getPositionBefore())}}))}removeRows(e,t){const i=this.editor.model,n=t.rows||1,o=this.getRows(e),s=t.at,r=s+n-1;if(r>o-1)throw new P.ZP("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});i.change((t=>{const{cellsToMove:i,cellsToTrim:n}=fx(e,s,r);if(i.size){const n=r+1;wx(e,n,i,t)}for(let o=r;o>=s;o--)t.remove(e.getChild(o));for(const{rowspan:e,cell:o}of n)Uk("rowspan",e,o,t);px(e,s,r,t),GC(e,this)||jC(e,this)}))}removeColumns(e,t){const i=this.editor.model,n=t.at,o=t.columns||1,s=t.at+o-1;i.change((t=>{gx(e,{first:n,last:s},t);for(let i=s;i>=n;i--)for(const{cell:n,column:o,cellWidth:s}of[...new tC(e)])o<=i&&s>1&&o+s>i?Uk("colspan",s-1,n,t):o===i&&t.remove(n);jC(e,this)||GC(e,this)}))}splitCellVertically(e,t=2){const i=this.editor.model,n=e.parent,o=n.parent,s=parseInt(e.getAttribute("rowspan")||1),r=parseInt(e.getAttribute("colspan")||1);i.change((i=>{if(r>1){const{newCellsSpan:n,updatedSpan:o}=mx(r,t);Uk("colspan",o,e,i);const a={};n>1&&(a.colspan=n),s>1&&(a.rowspan=s);const l=r>t?t-1:r-1;ux(l,i,i.createPositionAfter(e),a)}if(r<t){const n=t-r,a=[...new tC(o)],{column:l}=a.find((({cell:t})=>t===e)),c=a.filter((({cell:t,cellWidth:i,column:n})=>{const o=t!==e&&n===l,s=n<l&&n+i>l;return o||s}));for(const{cell:e,cellWidth:t}of c)i.setAttribute("colspan",t+n,e);const d={};s>1&&(d.rowspan=s),ux(n,i,i.createPositionAfter(e),d);const h=o.getAttribute("headingColumns")||0;h>l&&Uk("headingColumns",h+n,o,i)}}))}splitCellHorizontally(e,t=2){const i=this.editor.model,n=e.parent,o=n.parent,s=o.getChildIndex(n),r=parseInt(e.getAttribute("rowspan")||1),a=parseInt(e.getAttribute("colspan")||1);i.change((i=>{if(r>1){const n=[...new tC(o,{startRow:s,endRow:s+r-1,includeAllSlots:!0})],{newCellsSpan:l,updatedSpan:c}=mx(r,t);Uk("rowspan",c,e,i);const{column:d}=n.find((({cell:t})=>t===e)),h={};l>1&&(h.rowspan=l),a>1&&(h.colspan=a);for(const e of n){const{column:t,row:n}=e,o=n>=s+c,r=t===d,a=(n+s+c)%l===0;o&&r&&a&&ux(1,i,e.getPositionBefore(),h)}}if(r<t){const n=t-r,l=[...new tC(o,{startRow:0,endRow:s})];for(const{cell:t,cellHeight:o,row:r}of l)if(t!==e&&r+o>s){const e=o+n;i.setAttribute("rowspan",e,t)}const c={};a>1&&(c.colspan=a),hx(i,o,s+1,n,1,c);const d=o.getAttribute("headingRows")||0;d>s&&Uk("headingRows",d+n,o,i)}}))}getColumns(e){const t=e.getChild(0);return[...t.getChildren()].reduce(((e,t)=>{const i=parseInt(t.getAttribute("colspan")||1);return e+i}),0)}getRows(e){return Array.from(e.getChildren()).reduce(((e,t)=>t.is("element","tableRow")?e+1:e),0)}}function hx(e,t,i,n,o,s={}){for(let r=0;r<n;r++){const n=e.createElement("tableRow");e.insert(n,t,i),ux(o,e,e.createPositionAt(n,"end"),s)}}function ux(e,t,i,n={}){for(let o=0;o<e;o++)qk(t,i,n)}function mx(e,t){if(e<t)return{newCellsSpan:1,updatedSpan:1};const i=Math.floor(e/t),n=e-i*t+i;return{newCellsSpan:i,updatedSpan:n}}function gx(e,t,i){const n=e.getAttribute("headingColumns")||0;if(n&&t.first<n){const o=Math.min(n-1,t.last)-t.first+1;i.setAttribute("headingColumns",n-o,e)}}function px(e,t,i,n){const o=e.getAttribute("headingRows")||0;if(t<o){const s=i<o?o-(i-t+1):t;Uk("headingRows",s,e,n,0)}}function fx(e,t,i){const n=new Map,o=[];for(const{row:s,column:r,cellHeight:a,cell:l}of new tC(e,{endRow:i})){const e=s+a-1,c=s>=t&&s<=i&&e>i;if(c){const e=i-s+1,t=a-e;n.set(r,{cell:l,rowspan:t})}const d=s<t&&e>=t;if(d){let n;n=e>=i?i-t+1:e-t+1,o.push({cell:l,rowspan:a-n})}}return{cellsToMove:n,cellsToTrim:o}}function wx(e,t,i,n){const o=new tC(e,{includeAllSlots:!0,row:t}),s=[...o],r=e.getChild(t);let a;for(const{column:l,cell:c,isAnchor:d}of s)if(i.has(l)){const{cell:e,rowspan:t}=i.get(l),o=a?n.createPositionAfter(a):n.createPositionAt(r,0);n.move(n.createRangeOn(e),o),Uk("rowspan",t,e,n),a=e}else d&&(a=c)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bx extends b.Z{refresh(){const e=VC(this.editor.model.document.selection);this.isEnabled=SC(e,this.editor.plugins.get(dx))}execute(){const e=this.editor.model,t=this.editor.plugins.get(dx);e.change((i=>{const n=VC(e.document.selection),o=n.shift(),{mergeWidth:s,mergeHeight:r}=yx(o,n,t);Uk("colspan",s,o,i),Uk("rowspan",r,o,i);for(const e of n)vx(e,o,i);const a=o.findAncestor("table");KC(a,t),i.setSelection(o,"in")}))}}function vx(e,t,i){_x(e)||(_x(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e)}function _x(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}function yx(e,t,i){let n=0,o=0;for(const c of t){const{row:e,column:t}=i.getCellLocation(c);n=kx(c,t,n,"colspan"),o=kx(c,e,o,"rowspan")}const{row:s,column:r}=i.getCellLocation(e),a=n-r,l=o-s;return{mergeWidth:a,mergeHeight:l}}function kx(e,t,i,n){const o=parseInt(e.getAttribute(n)||1);return Math.max(i,t+o)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cx extends b.Z{constructor(e){super(e),this.affectsData=!1}refresh(){const e=EC(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=EC(e.document.selection),i=TC(t),n=t[0].findAncestor("table"),o=[];for(let s=i.first;s<=i.last;s++)for(const t of n.getChild(s).getChildren())o.push(e.createRangeOn(t));e.change((e=>{e.setSelection(o)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xx extends b.Z{constructor(e){super(e),this.affectsData=!1}refresh(){const e=EC(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=EC(e.document.selection),i=t[0],n=t.pop(),o=i.findAncestor("table"),s=this.editor.plugins.get("TableUtils"),r=s.getCellLocation(i),a=s.getCellLocation(n),l=Math.min(r.column,a.column),c=Math.max(r.column,a.column),d=[];for(const h of new tC(o,{startColumn:l,endColumn:c}))d.push(e.createRangeOn(h.cell));e.change((e=>{e.setSelection(d)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Vx(e){e.document.registerPostFixer((t=>Ax(t,e)))}function Ax(e,t){const i=t.document.differ.getChanges();let n=!1;const o=new Set;for(const s of i){let t;"table"==s.name&&"insert"==s.type&&(t=s.position.nodeAfter),"tableRow"!=s.name&&"tableCell"!=s.name||(t=s.position.findAncestor("table")),Ix(s)&&(t=s.range.start.findAncestor("table")),t&&!o.has(t)&&(n=Ex(t,e)||n,n=Tx(t,e)||n,o.add(t))}return n}function Ex(e,t){let i=!1;const n=Px(e);if(n.length){i=!0;for(const e of n)Uk("rowspan",e.rowspan,e.cell,t,1)}return i}function Tx(e,t){let i=!1;const n=Sx(e),o=[];for(const[l,c]of n.entries())!c&&e.getChild(l).is("element","tableRow")&&o.push(l);if(o.length){i=!0;for(const i of o.reverse())t.remove(e.getChild(i)),n.splice(i,1)}const s=n.filter(((t,i)=>e.getChild(i).is("element","tableRow"))),r=s[0],a=s.every((e=>e===r));if(!a){const n=s.reduce(((e,t)=>t>e?t:e),0);for(const[o,r]of s.entries()){const s=n-r;if(s){for(let i=0;i<s;i++)qk(t,t.createPositionAt(e.getChild(o),"end"));i=!0}}}return i}function Px(e){const t=parseInt(e.getAttribute("headingRows")||0),i=Array.from(e.getChildren()).reduce(((e,t)=>t.is("element","tableRow")?e+1:e),0),n=[];for(const{row:o,cell:s,cellHeight:r}of new tC(e)){if(r<2)continue;const e=o<t,a=e?t:i;if(o+r>a){const e=a-o;n.push({cell:s,rowspan:e})}}return n}function Sx(e){const t=new Array(e.childCount).fill(0);for(const{rowIndex:i}of new tC(e,{includeAllSlots:!0}))t[i]++;return t}function Ix(e){const t="attribute"===e.type,i=e.attributeKey;return t&&("headingRows"===i||"colspan"===i||"rowspan"===i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Nx(e){e.document.registerPostFixer((t=>Bx(t,e)))}function Bx(e,t){const i=t.document.differ.getChanges();let n=!1;for(const o of i)"insert"==o.type&&"table"==o.name&&(n=Rx(o.position.nodeAfter,e)||n),"insert"==o.type&&"tableRow"==o.name&&(n=Dx(o.position.nodeAfter,e)||n),"insert"==o.type&&"tableCell"==o.name&&(n=Mx(o.position.nodeAfter,e)||n),Ox(o)&&(n=Mx(o.position.parent,e)||n);return n}function Rx(e,t){let i=!1;for(const n of e.getChildren())n.is("element","tableRow")&&(i=Dx(n,t)||i);return i}function Dx(e,t){let i=!1;for(const n of e.getChildren())i=Mx(n,t)||i;return i}function Mx(e,t){if(0==e.childCount)return t.insertElement("paragraph",e),!0;const i=Array.from(e.getChildren()).filter((e=>e.is("$text")));for(const n of i)t.wrap(t.createRangeOn(n),"paragraph");return!!i.length}function Ox(e){return!(!e.position||!e.position.parent.is("element","tableCell"))&&("insert"==e.type&&"$text"==e.name||"remove"==e.type)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Lx(e,t){e.document.registerPostFixer((()=>Fx(e.document.differ,t)))}function Fx(e,t){const i=new Set;for(const n of e.getChanges()){const e="attribute"==n.type?n.range.start.parent:n.position.parent;e.is("element","tableCell")&&i.add(e)}for(const n of i.values())for(const i of[...n.getChildren()].filter((e=>zx(e,t))))e.refreshItem(i);return!1}function zx(e,t){if(!e.is("element","paragraph"))return!1;const i=t.toViewElement(e);return!!i&&cC(e)!==i.is("element","span")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $x(e){e.document.registerPostFixer((()=>Zx(e)))}function Zx(e){const t=e.document.differ,i=new Set;for(const n of t.getChanges())if("attribute"===n.type){const e=n.range.start.nodeAfter;e&&e.is("element","table")&&"headingRows"===n.attributeKey&&i.add(e)}else if("insert"===n.type||"remove"===n.type)if("tableRow"===n.name){const e=n.position.findAncestor("table"),t=e.getAttribute("headingRows")||0;n.position.offset<t&&i.add(e)}else if("tableCell"===n.name){const e=n.position.findAncestor("table"),t=e.getAttribute("headingColumns")||0;n.position.offset<t&&i.add(e)}if(i.size){for(const e of i.values())t.refreshItem(e);return!0}return!1}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wx extends a.Z{static get pluginName(){return"TableEditing"}init(){const e=this.editor,t=e.model,i=t.schema,n=e.conversion;i.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isObject:!0,isBlock:!0}),i.register("tableRow",{allowIn:"table",isLimit:!0}),i.register("tableCell",{allowIn:"tableRow",allowChildren:"$block",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),n.for("upcast").add(jk()),n.for("upcast").add(Kk()),n.for("editingDowncast").add(nC({asWidget:!0})),n.for("dataDowncast").add(nC()),n.for("upcast").elementToElement({model:"tableRow",view:"tr"}),n.for("upcast").add(Jk()),n.for("editingDowncast").add(oC()),n.for("editingDowncast").add(aC()),n.for("upcast").elementToElement({model:"tableCell",view:"td"}),n.for("upcast").elementToElement({model:"tableCell",view:"th"}),n.for("upcast").add(Yk("td")),n.for("upcast").add(Yk("th")),n.for("editingDowncast").add(sC()),n.for("editingDowncast").elementToElement({model:"paragraph",view:lC,converterPriority:"high"}),n.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),n.for("upcast").attributeToAttribute({model:{key:"colspan",value:Ux("colspan")},view:"colspan"}),n.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),n.for("upcast").attributeToAttribute({model:{key:"rowspan",value:Ux("rowspan")},view:"rowspan"}),n.for("editingDowncast").add(rC()),e.data.mapper.on("modelToViewPosition",Hx()),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new CC(e)),e.commands.add("insertTableRowAbove",new OC(e,{order:"above"})),e.commands.add("insertTableRowBelow",new OC(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new LC(e,{order:"left"})),e.commands.add("insertTableColumnRight",new LC(e,{order:"right"})),e.commands.add("removeTableRow",new nx(e)),e.commands.add("removeTableColumn",new sx(e)),e.commands.add("splitTableCellVertically",new FC(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new FC(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new bx(e)),e.commands.add("mergeTableCellRight",new QC(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new QC(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new QC(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new QC(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new cx(e)),e.commands.add("setTableRowHeader",new lx(e)),e.commands.add("selectTableRow",new Cx(e)),e.commands.add("selectTableColumn",new xx(e)),$x(t),Vx(t),Lx(t,e.editing.mapper),Nx(t)}static get requires(){return[dx]}}function Hx(){return(e,t)=>{const i=t.modelPosition.parent,n=t.modelPosition.nodeBefore;if(!i.is("element","tableCell"))return;if(!n||!n.is("element","paragraph"))return;const o=t.mapper.toViewElement(n),s=t.mapper.toViewElement(i);o===s&&(t.viewPosition=t.mapper.findPositionIn(s,n.maxOffset))}}function Ux(e){return t=>{const i=parseInt(t.getAttribute(e));return Number.isNaN(i)||i<=0?null:i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qx extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",((e,t)=>`${t} × ${e}`)),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:t.to("label")}]}],on:{mousedown:t.to((e=>{e.preventDefault()})),click:t.to((()=>{this.fire("execute")}))}}),this.on("boxover",((e,t)=>{const{row:i,column:n}=t.target.dataset;this.set({rows:parseInt(i),columns:parseInt(n)})})),this.on("change:columns",(()=>{this._highlightGridBoxes()})),this.on("change:rows",(()=>{this._highlightGridBoxes()}))}focus(){}focusLast(){}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map(((i,n)=>{const o=Math.floor(n/10),s=n%10,r=o<e&&s<t;i.set("isOn",r)}))}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const i=Math.floor(t/10),n=t%10;e.push(new Gx(this.locale,i+1,n+1))}return this.createCollection(e)}}class Gx extends cl.Z{constructor(e,t,i){super(e);const n=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",n.if("isOn","ck-on")],"data-row":t,"data-column":i}})}}var jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',Kx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',Jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',Yx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qx extends a.Z{static get pluginName(){return"TableUI"}init(){const e=this.editor,t=this.editor.t,i=e.locale.contentLanguageDirection,n="ltr"===i;e.ui.componentFactory.add("insertTable",(i=>{const n=e.commands.get("insertTable"),o=vc(i);let s;return o.bind("isEnabled").to(n),o.buttonView.set({icon:jx,label:t("Insert table"),tooltip:!0}),o.on("change:isOpen",(()=>{s||(s=new qx(i),o.panelView.children.add(s),s.delegate("execute").to(o),o.buttonView.on("open",(()=>{s.rows=0,s.columns=0})),o.on("execute",(()=>{e.execute("insertTable",{rows:s.rows,columns:s.columns}),e.editing.view.focus()})))})),o})),e.ui.componentFactory.add("tableColumn",(e=>{const i=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:n?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:n?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),Kx,i,e)})),e.ui.componentFactory.add("tableRow",(e=>{const i=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),Jx,i,e)})),e.ui.componentFactory.add("mergeTableCells",(e=>{const i=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:n?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:n?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),Yx,i,e)}))}_prepareDropdown(e,t,i,n){const o=this.editor,s=vc(n),r=this._fillDropdownWithListOptions(s,i);return s.buttonView.set({label:e,icon:t,tooltip:!0}),s.bind("isEnabled").toMany(r,"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(s,"execute",(e=>{o.execute(e.source.commandName),o.editing.view.focus()})),s}_prepareMergeSplitButtonDropdown(e,t,i,n){const o=this.editor,s=vc(n,Ql),r="mergeTableCells",a=o.commands.get(r),l=this._fillDropdownWithListOptions(s,i);return s.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),s.bind("isEnabled").toMany([a,...l],"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(s.buttonView,"execute",(()=>{o.execute(r),o.editing.view.focus()})),this.listenTo(s,"execute",(e=>{o.execute(e.source.commandName),o.editing.view.focus()})),s}_fillDropdownWithListOptions(e,t){const i=this.editor,n=[],o=new T.Z;for(const s of t)Xx(s,i,n,o);return yc(e,o,i.ui.componentFactory),n}}function Xx(e,t,i,n){const o=e.model=new Lc(e.model),{commandName:s,bindIsOn:r}=e.model;if("button"===e.type||"switchbutton"===e.type){const e=t.commands.get(s);i.push(e),o.set({commandName:s}),o.bind("isEnabled").to(e),r&&o.bind("isOn").to(e,"value")}o.set({withText:!0}),n.add(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eV extends a.Z{static get pluginName(){return"TableSelection"}static get requires(){return[dx]}init(){const e=this.editor,t=e.model;this.listenTo(t,"deleteContent",((e,t)=>this._handleDeleteContent(e,t)),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=this.editor.model.document.selection,t=VC(e);return 0==t.length?null:t}getSelectionAsFragment(){const e=this.getSelectedTableCells();return e?this.editor.model.change((t=>{const i=t.createDocumentFragment(),n=this.editor.plugins.get("TableUtils"),{first:o,last:s}=PC(e),{first:r,last:a}=TC(e),l=e[0].findAncestor("table");let c=a,d=s;if(SC(e,n)){const e={firstColumn:o,lastColumn:s,firstRow:r,lastRow:a};c=JC(l,e),d=YC(l,e)}const h={startRow:r,startColumn:o,endRow:c,endColumn:d},u=zC(l,h,t);return t.insert(u,i,0),i})):null}setCellSelection(e,t){const i=this._getCellsToSelect(e,t);this.editor.model.change((e=>{e.setSelection(i.cells.map((t=>e.createRangeOn(t))),{backward:i.backward})}))}getFocusCell(){const e=this.editor.model.document.selection,t=[...e.getRanges()].pop(),i=t.getContainedElement();return i&&i.is("element","tableCell")?i:null}getAnchorCell(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getRanges()),i=t.getContainedElement();return i&&i.is("element","tableCell")?i:null}_defineSelectionConverter(){const e=this.editor,t=new Set;function i(e){for(const i of t)e.removeClass("ck-editor__editable_selected",i);t.clear()}e.conversion.for("editingDowncast").add((e=>e.on("selection",((e,n,o)=>{const s=o.writer;i(s);const r=this.getSelectedTableCells();if(!r)return;for(const i of r){const e=o.mapper.toViewElement(i);s.addClass("ck-editor__editable_selected",e),t.add(e)}const a=o.mapper.toViewElement(r[r.length-1]);s.setSelection(a,0)}),{priority:"lowest"})))}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",(()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change((i=>{const n=i.createPositionAt(t[0],0),o=e.model.schema.getNearestSelectionRange(n);i.setSelection(o)}))}}))}_handleDeleteContent(e,t){const[i,n]=t,o=this.editor.model,s=!n||"backward"==n.direction,r=VC(i);r.length&&(e.stop(),o.change((e=>{const t=r[s?r.length-1:0];o.change((e=>{for(const t of r)o.deleteContent(e.createSelection(t,"in"))}));const n=o.schema.getNearestSelectionRange(e.createPositionAt(t,0));i.is("documentSelection")?e.setSelection(n):i.setTo(n)})))}_getCellsToSelect(e,t){const i=this.editor.plugins.get("TableUtils"),n=i.getCellLocation(e),o=i.getCellLocation(t),s=Math.min(n.row,o.row),r=Math.max(n.row,o.row),a=Math.min(n.column,o.column),l=Math.max(n.column,o.column),c=new Array(r-s+1).fill(null).map((()=>[])),d={startRow:s,endRow:r,startColumn:a,endColumn:l};for(const{row:m,cell:g}of new tC(e.findAncestor("table"),d))c[m-s].push(g);const h=o.row<n.row,u=o.column<n.column;return h&&c.reverse(),u&&c.forEach((e=>e.reverse())),{cells:c.flat(),backward:h||u}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tV extends a.Z{static get pluginName(){return"TableClipboard"}static get requires(){return[eV,dx]}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",((e,t)=>this._onCopyCut(e,t))),this.listenTo(t,"cut",((e,t)=>this._onCopyCut(e,t))),this.listenTo(e.model,"insertContent",((e,t)=>this._onInsertContent(e,...t)),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(e,t){const i=this.editor.plugins.get(eV);if(!i.getSelectedTableCells())return;if("cut"==e.name&&this.editor.isReadOnly)return;t.preventDefault(),e.stop();const n=this.editor.data,o=this.editor.editing.view.document,s=n.toView(i.getSelectionAsFragment());o.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:s,method:e.name})}_onInsertContent(e,t,i){if(i&&!i.is("documentSelection"))return;const n=this.editor.model,o=this.editor.plugins.get(dx);let s=iV(t,n);if(!s)return;const r=EC(n.document.selection);r.length?(e.stop(),n.change((e=>{const t={width:o.getColumns(s),height:o.getRows(s)},i=nV(r,t,e,o),n=i.lastRow-i.firstRow+1,a=i.lastColumn-i.firstColumn+1,l={startRow:0,startColumn:0,endRow:Math.min(n,t.height)-1,endColumn:Math.min(a,t.width)-1};s=zC(s,l,e);const c=r[0].findAncestor("table"),d=this._replaceSelectedCellsWithPasted(s,t,c,i,e);if(this.editor.plugins.get("TableSelection").isEnabled){const t=IC(d.map((t=>e.createRangeOn(t))));e.setSelection(t)}else e.setSelection(d[0],0)}))):KC(s,o)}_replaceSelectedCellsWithPasted(e,t,i,n,o){const{width:s,height:r}=t,a=sV(e,s,r),l=[...new tC(i,{startRow:n.firstRow,endRow:n.lastRow,startColumn:n.firstColumn,endColumn:n.lastColumn,includeAllSlots:!0})],c=[];let d;for(const p of l){const{row:e,column:t}=p;t===n.firstColumn&&(d=p.getPositionBefore());const i=e-n.firstRow,l=t-n.firstColumn,h=a[i%r][l%s],u=h?o.cloneElement(h):null,m=this._replaceTableSlotCell(p,u,d,o);m&&(UC(m,e,t,n.lastRow,n.lastColumn,o),c.push(m),d=o.createPositionAfter(m))}const h=parseInt(i.getAttribute("headingRows")||0),u=parseInt(i.getAttribute("headingColumns")||0),m=n.firstRow<h&&h<=n.lastRow,g=n.firstColumn<u&&u<=n.lastColumn;if(m){const e={first:n.firstColumn,last:n.lastColumn},t=aV(i,h,e,o,n.firstRow);c.push(...t)}if(g){const e={first:n.firstRow,last:n.lastRow},t=lV(i,u,e,o);c.push(...t)}return c}_replaceTableSlotCell(e,t,i,n){const{cell:o,isAnchor:s}=e;return s&&n.remove(o),t?(n.insert(t,i),t):null}}function iV(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(1==e.childCount&&e.getChild(0).is("element","table"))return e.getChild(0);const i=t.createRangeIn(e);for(const n of i.getItems())if(n.is("element","table")){const e=t.createRange(i.start,t.createPositionBefore(n));if(t.hasContent(e,{ignoreWhitespaces:!0}))return null;const o=t.createRange(t.createPositionAfter(n),i.end);return t.hasContent(o,{ignoreWhitespaces:!0})?null:n}return null}function nV(e,t,i,n){const o=e[0].findAncestor("table"),s=PC(e),r=TC(e),a={firstColumn:s.first,lastColumn:s.last,firstRow:r.first,lastRow:r.last},l=1===e.length;return l&&(a.lastRow+=t.height-1,a.lastColumn+=t.width-1,oV(o,a.lastRow+1,a.lastColumn+1,n)),l||!SC(e,n)?rV(o,a,i):(a.lastRow=JC(o,a),a.lastColumn=YC(o,a)),a}function oV(e,t,i,n){const o=n.getColumns(e),s=n.getRows(e);i>o&&n.insertColumns(e,{at:o,columns:i-o}),t>s&&n.insertRows(e,{at:s,rows:t-s})}function sV(e,t,i){const n=new Array(i).fill(null).map((()=>new Array(t).fill(null)));for(const{column:o,row:s,cell:r}of new tC(e))n[s][o]=r;return n}function rV(e,t,i){const{firstRow:n,lastRow:o,firstColumn:s,lastColumn:r}=t,a={first:n,last:o},l={first:s,last:r};lV(e,s,a,i),lV(e,r+1,a,i),aV(e,n,l,i),aV(e,o+1,l,i,n)}function aV(e,t,i,n,o=0){if(t<1)return;const s=$C(e,t,o),r=s.filter((({column:e,cellWidth:t})=>cV(e,t,i)));return r.map((({cell:e})=>ZC(e,t,n)))}function lV(e,t,i,n){if(t<1)return;const o=WC(e,t),s=o.filter((({row:e,cellHeight:t})=>cV(e,t,i)));return s.map((({cell:e,column:i})=>HC(e,i,t,n)))}function cV(e,t,i){const n=e+t-1,{first:o,last:s}=i,r=e>=o&&e<=s,a=e<o&&n>=o;return r||a}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dV extends a.Z{static get pluginName(){return"TableKeyboard"}static get requires(){return[eV]}init(){const e=this.editor.editing.view,t=e.document;this.editor.keystrokes.set("Tab",((...e)=>this._handleTabOnSelectedTable(...e)),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(t,"arrowKey",((...e)=>this._onArrowKey(...e)),{context:"table"})}_handleTabOnSelectedTable(e,t){const i=this.editor,n=i.model.document.selection,o=n.getSelectedElement();o&&o.is("element","table")&&(t(),i.model.change((e=>{e.setSelection(e.createRangeIn(o.getChild(0).getChild(0)))})))}_getTabHandler(e){const t=this.editor;return(i,n)=>{const o=t.model.document.selection;let s=AC(o)[0];if(s||(s=this.editor.plugins.get("TableSelection").getFocusCell()),!s)return;n();const r=s.parent,a=r.parent,l=a.getChildIndex(r),c=r.getChildIndex(s),d=0===c;if(!e&&d&&0===l)return void t.model.change((e=>{e.setSelection(e.createRangeOn(a))}));const h=this.editor.plugins.get("TableUtils"),u=c===r.childCount-1,m=l===h.getRows(a)-1;if(e&&m&&u&&(t.execute("insertTableRowBelow"),l===h.getRows(a)-1))return void t.model.change((e=>{e.setSelection(e.createRangeOn(a))}));let g;if(e&&u){const e=a.getChild(l+1);g=e.getChild(0)}else if(!e&&d){const e=a.getChild(l-1);g=e.getChild(e.childCount-1)}else g=r.getChild(c+(e?1:-1));t.model.change((e=>{e.setSelection(e.createRangeIn(g))}))}}_onArrowKey(e,t){const i=this.editor,n=t.keyCode,o=(0,ct.mA)(n,i.locale.contentLanguageDirection),s=this._handleArrowKeys(o,t.shiftKey);s&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const i=this.editor.model,n=i.document.selection,o=["right","down"].includes(e),s=VC(n);if(s.length){let i;return i=t?this.editor.plugins.get("TableSelection").getFocusCell():o?s[s.length-1]:s[0],this._navigateFromCellInDirection(i,e,t),!0}const r=n.focus.findAncestor("tableCell");if(!r)return!1;if(!n.isCollapsed)if(t){if(n.isBackward==o&&!n.containsEntireContent(r))return!1}else{const e=n.getSelectedElement();if(!e||!i.schema.isObject(e))return!1}return!!this._isSelectionAtCellEdge(n,r,o)&&(this._navigateFromCellInDirection(r,e,t),!0)}_isSelectionAtCellEdge(e,t,i){const n=this.editor.model,o=this.editor.model.schema,s=i?e.getLastPosition():e.getFirstPosition();if(!o.getLimitElement(s).is("element","tableCell")){const e=n.createPositionAt(t,i?"end":0);return e.isTouching(s)}const r=n.createSelection(s);return n.modifySelection(r,{direction:i?"forward":"backward"}),s.isEqual(r.focus)}_navigateFromCellInDirection(e,t,i=!1){const n=this.editor.model,o=e.findAncestor("table"),s=[...new tC(o,{includeAllSlots:!0})],{row:r,column:a}=s[s.length-1],l=s.find((({cell:t})=>t==e));let{row:c,column:d}=l;switch(t){case"left":d--;break;case"up":c--;break;case"right":d+=l.cellWidth;break;case"down":c+=l.cellHeight;break}const h=c<0||c>r,u=d<0&&c<=0,m=d>a&&c>=r;if(h||u||m)return void n.change((e=>{e.setSelection(e.createRangeOn(o))}));d<0?(d=i?0:a,c--):d>a&&(d=i?a:0,c++);const g=s.find((e=>e.row==c&&e.column==d)).cell,p=["right","down"].includes(t),f=this.editor.plugins.get("TableSelection");if(i&&f.isEnabled){const t=f.getAnchorCell()||e;f.setCellSelection(t,g)}else{const e=n.createPositionAt(g,p?0:"end");n.change((t=>{t.setSelection(e)}))}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hV extends Ei{constructor(e){super(e),this.domEventType=["mousemove","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uV extends a.Z{static get pluginName(){return"TableMouse"}static get requires(){return[eV]}init(){const e=this.editor;e.editing.view.addObserver(hV),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor;let t=!1;const i=e.plugins.get(eV);this.listenTo(e.editing.view.document,"mousedown",((n,o)=>{if(!this.isEnabled||!i.isEnabled)return;if(!o.domEvent.shiftKey)return;const s=i.getAnchorCell()||AC(e.model.document.selection)[0];if(!s)return;const r=this._getModelTableCellFromDomEvent(o);r&&mV(s,r)&&(t=!0,i.setCellSelection(s,r),o.preventDefault())})),this.listenTo(e.editing.view.document,"mouseup",(()=>{t=!1})),this.listenTo(e.editing.view.document,"selectionChange",(e=>{t&&e.stop()}),{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,i,n=!1,o=!1;const s=e.plugins.get(eV);this.listenTo(e.editing.view.document,"mousedown",((e,i)=>{this.isEnabled&&s.isEnabled&&(i.domEvent.shiftKey||i.domEvent.ctrlKey||i.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(i)))})),this.listenTo(e.editing.view.document,"mousemove",((e,r)=>{if(!r.domEvent.buttons)return;if(!t)return;const a=this._getModelTableCellFromDomEvent(r);a&&mV(t,a)&&(i=a,n||i==t||(n=!0)),n&&(o=!0,s.setCellSelection(t,i),r.preventDefault())})),this.listenTo(e.editing.view.document,"mouseup",(()=>{n=!1,o=!1,t=null,i=null})),this.listenTo(e.editing.view.document,"selectionChange",(e=>{o&&e.stop()}),{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,i=this.editor.editing.view.createPositionAt(t,0),n=this.editor.editing.mapper.toModelPosition(i),o=n.parent;return o.findAncestor("tableCell",{includeSelf:!0})}}function mV(e,t){return e.parent.parent==t.parent.parent}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gV extends a.Z{static get requires(){return[Wx,Qx,eV,uV,dV,tV,Gg]}static get pluginName(){return"Table"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function pV(e){e.document.registerPostFixer((t=>fV(t,e)))}function fV(e,t){const i=t.document.differ.getChanges();let n=!1;for(const o of i){if("insert"!=o.type)continue;const t=o.position.parent;if(t.is("element","table")||"table"==o.name){const t="table"==o.name?o.position.nodeAfter:o.position.parent,i=Array.from(t.getChildren()).filter((e=>e.is("element","caption"))),s=i.shift();if(!s)continue;for(const n of i)e.move(e.createRangeIn(n),s,"end"),e.remove(n);s.nextSibling&&(e.move(e.createRangeOn(s),t,"end"),n=!0),n=!!i.length||n}}return n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function wV(e){return!!e&&e.is("element","table")}function bV(e){for(const t of e.getChildren())if(t.is("element","caption"))return t;return null}function vV(e){const t=yV(e);return t?bV(t):null}function _V(e){const t=e.parent;return"figcaption"==e.name&&t&&"figure"==t.name&&t.hasClass("table")||"caption"==e.name&&t&&"table"==t.name?{name:!0}:null}function yV(e){const t=e.getSelectedElement();return t&&t.is("element","table")?t:e.getFirstPosition().findAncestor("table")}
/**
* @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
class kV extends b.Z{refresh(){const e=this.editor,t=yV(e.model.document.selection);this.isEnabled=!!t,this.isEnabled?this.value=!!bV(t):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change((e=>{this.value?this._hideTableCaption(e):this._showTableCaption(e,t)}))}_showTableCaption(e,t){const i=this.editor.model,n=yV(i.document.selection),o=this.editor.plugins.get("TableCaptionEditing"),s=o._getSavedCaption(n),r=s||e.createElement("caption");e.append(r,n),t&&e.setSelection(r,"in")}_hideTableCaption(e){const t=this.editor.model,i=yV(t.document.selection),n=this.editor.plugins.get("TableCaptionEditing"),o=bV(i);n._saveCaption(i,o),e.setSelection(e.createRangeIn(i.getChild(0).getChild(0))),e.remove(o)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class CV extends a.Z{static get pluginName(){return"TableCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema,i=e.editing.view,n=e.t;t.isRegistered("caption")?t.extend("caption",{allowIn:"table"}):t.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new kV(this.editor)),e.conversion.for("upcast").elementToElement({view:_V,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>wV(e.parent)?t.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>{if(!wV(e.parent))return null;const o=t.createEditableElement("figcaption");return t.setCustomProperty("tableCaption",!0,o),Yd({view:i,element:o,text:n("Enter table caption"),keepOnFocus:!0}),kg(o,t)}}),pV(e.model)}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?Cn.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}
/**
* @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
class xV extends a.Z{static get pluginName(){return"TableCaptionUI"}init(){const e=this.editor,t=e.editing.view,i=e.t;e.ui.componentFactory.add("toggleTableCaption",(n=>{const o=e.commands.get("toggleTableCaption"),s=new l.Z(n);return s.set({icon:sl.caption,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(o,"value","isEnabled"),s.bind("label").to(o,"value",(e=>i(e?"Toggle caption off":"Toggle caption on"))),this.listenTo(s,"execute",(()=>{if(e.execute("toggleTableCaption",{focusCaptionOnShow:!0}),o.value){const i=vV(e.model.document.selection),n=e.editing.mapper.toViewElement(i);if(!n)return;t.scrollToTheSelection(),t.change((e=>{e.addClass("table__caption_highlighted",n)}))}})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class VV extends a.Z{static get pluginName(){return"TableCaption"}static get requires(){return[CV,xV]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class AV extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate;this.set("value",""),this.set("id"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.set("ariaDescribedById"),this.options=t,this._dropdownView=this._createDropdownView(),this._inputView=this._createInputTextView(),this._stillTyping=!1,this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color",i.if("hasError","ck-error")],id:i.to("id"),"aria-invalid":i.if("hasError",!0),"aria-describedby":i.to("ariaDescribedById")},children:[this._dropdownView,this._inputView]}),this.on("change:value",((e,t,i)=>this._setInputValue(i)))}focus(){this._inputView.focus()}_createDropdownView(){const e=this.locale,t=e.t,i=this.bindTemplate,n=this._createColorGrid(e),o=vc(e),s=new cl.Z,r=this._createRemoveColorButton();return s.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:i.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",i.if("value","ck-hidden",(e=>""!=e))]}}]}),o.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),o.buttonView.children.add(s),o.buttonView.tooltip=t("Color picker"),o.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",o.panelView.children.add(r),o.panelView.children.add(n),o.bind("isEnabled").to(this,"isReadOnly",(e=>!e)),o}_createInputTextView(){const e=this.locale,t=new Nc(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",(()=>{const e=t.element.value,i=this.options.colorDefinitions.find((t=>e===t.label));this._stillTyping=!0,this.value=i&&i.color||e})),t.on("blur",(()=>{this._stillTyping=!1,this._setInputValue(t.element.value)})),t.delegate("input").to(this),t}_createRemoveColorButton(){const e=this.locale,t=e.t,i=new l.Z(e),n=this.options.defaultColorValue||"",o=t(n?"Restore default":"Remove color");return i.class="ck-input-color__remove-color",i.withText=!0,i.icon=sl.eraser,i.label=o,i.on("execute",(()=>{this.value=n,this._dropdownView.isOpen=!1,this.fire("input")})),i}_createColorGrid(e){const t=new jl(e,{colorDefinitions:this.options.colorDefinitions,columns:this.options.columns});return t.on("execute",((e,t)=>{this.value=t.value,this._dropdownView.isOpen=!1,this.fire("input")})),t.bind("selectedColor").to(this,"value"),t}_setInputValue(e){if(!this._stillTyping){const t=EV(e),i=this.options.colorDefinitions.find((e=>t===EV(e.color)));this._inputView.value=i?i.label:e||""}}}function EV(e){return e.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const TV=e=>""===e;function PV(e){return{none:e("None"),solid:e("Solid"),dotted:e("Dotted"),dashed:e("Dashed"),double:e("Double"),groove:e("Groove"),ridge:e("Ridge"),inset:e("Inset"),outset:e("Outset")}}function SV(e){return e('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function IV(e){return e('The value is invalid. Try "10px" or "2em" or simply "2".')}function NV(e){return e=e.trim(),TV(e)||Ah(e)}function BV(e){return e=e.trim(),TV(e)||FV(e)||Sh(e)||Nh(e)}function RV(e){return e=e.trim(),TV(e)||FV(e)||Sh(e)}function DV(e,t){const i=new T.Z,n=PV(e.t);for(const o in n){const s={type:"button",model:new Lc({_borderStyleValue:o,label:n[o],withText:!0})};"none"===o?s.model.bind("isOn").to(e,"borderStyle",(e=>"none"===t?!e:e===o)):s.model.bind("isOn").to(e,"borderStyle",(e=>e===o)),i.add(s)}return i}function MV(e){const{view:t,icons:i,toolbar:n,labels:o,propertyName:s,nameToValue:r,defaultValue:a}=e;for(const c in o){const e=new l.Z(t.locale);e.set({label:o[c],icon:i[c],tooltip:o[c]});const d=r?r(c):c;e.bind("isOn").to(t,s,(e=>{let t=e;return""===e&&a&&(t=a),d===t})),e.on("execute",(()=>{t[s]=d})),n.items.add(e)}}const OV=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function LV(e){return(t,i,n)=>{const o=new AV(t.locale,{colorDefinitions:zV(e.colorConfig),columns:e.columns,defaultColorValue:e.defaultColorValue});return o.set({id:i,ariaDescribedById:n}),o.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),o.bind("hasError").to(t,"errorText",(e=>!!e)),o.on("input",(()=>{t.errorText=null})),t.bind("isEmpty","isFocused").to(o),o}}function FV(e){const t=parseFloat(e);return!Number.isNaN(t)&&e===String(t)}function zV(e){return e.map((e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}})))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $V extends cl.Z{constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("class",t.class||null),this.children=this.createCollection(),t.children&&t.children.forEach((e=>this.children.add(e))),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",i.to("class")],role:i.to("_role"),"aria-labelledby":i.to("_ariaLabelledBy")},children:this.children})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ZV={left:sl.alignLeft,center:sl.alignCenter,right:sl.alignRight,justify:sl.alignJustify,top:sl.alignTop,middle:sl.alignMiddle,bottom:sl.alignBottom};class WV extends cl.Z{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:i,borderWidthInput:n,borderColorInput:o,borderRowLabel:s}=this._createBorderFields(),{backgroundRowLabel:r,backgroundInput:a}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{horizontalAlignmentToolbar:u,verticalAlignmentToolbar:m,alignmentLabel:g}=this._createAlignmentFields();this.focusTracker=new en,this.keystrokes=new tn,this.children=this.createCollection(),this.borderStyleDropdown=i,this.borderWidthInput=n,this.borderColorInput=o,this.backgroundInput=a,this.paddingInput=this._createPaddingField(),this.widthInput=l,this.heightInput=d,this.horizontalAlignmentToolbar=u,this.verticalAlignmentToolbar=m;const{saveButtonView:p,cancelButtonView:f}=this._createActionButtons();this.saveButtonView=p,this.cancelButtonView=f,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Ic(e,{label:this.t("Cell properties")})),this.children.add(new $V(e,{labelView:s,children:[s,i,o,n],class:"ck-table-form__border-row"})),this.children.add(new $V(e,{labelView:r,children:[r,a],class:"ck-table-form__background-row"})),this.children.add(new $V(e,{children:[new $V(e,{labelView:h,children:[h,l,c,d],class:"ck-table-form__dimensions-row"}),new $V(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new $V(e,{labelView:g,children:[g,u,m],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new $V(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ml({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=LV({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color}),n=this.locale,o=this.t,s=new Ec(n);s.text=o("Border");const r=PV(o),a=new Rc(n,Mc);a.set({label:o("Style"),class:"ck-table-form__border-style"}),a.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:o("Style")}),a.fieldView.buttonView.bind("label").to(this,"borderStyle",(e=>r[e||"none"])),a.fieldView.on("execute",(e=>{this.borderStyle=e.source._borderStyleValue})),a.bind("isEmpty").to(this,"borderStyle",(e=>!e)),yc(a.fieldView,DV(this,t.style));const l=new Rc(n,Dc);l.set({label:o("Width"),class:"ck-table-form__border-width"}),l.fieldView.bind("value").to(this,"borderWidth"),l.bind("isEnabled").to(this,"borderStyle",HV),l.fieldView.on("input",(()=>{this.borderWidth=l.fieldView.element.value}));const c=new Rc(n,i);return c.set({label:o("Color"),class:"ck-table-form__border-color"}),c.fieldView.bind("value").to(this,"borderColor"),c.bind("isEnabled").to(this,"borderStyle",HV),c.fieldView.on("input",(()=>{this.borderColor=c.fieldView.value})),this.on("change:borderStyle",((e,i,n,o)=>{HV(n)||(this.borderColor="",this.borderWidth=""),HV(o)||(this.borderColor=t.color,this.borderWidth=t.width)})),{borderRowLabel:s,borderStyleDropdown:a,borderColorInput:c,borderWidthInput:l}}_createBackgroundFields(){const e=this.locale,t=this.t,i=new Ec(e);i.text=t("Background");const n=LV({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor}),o=new Rc(e,n);return o.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",(()=>{this.backgroundColor=o.fieldView.value})),{backgroundRowLabel:i,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,i=new Ec(e);i.text=t("Dimensions");const n=new Rc(e,Dc);n.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",(()=>{this.width=n.fieldView.element.value}));const o=new cl.Z(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const s=new Rc(e,Dc);return s.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),s.fieldView.bind("value").to(this,"height"),s.fieldView.on("input",(()=>{this.height=s.fieldView.element.value})),{dimensionsLabel:i,widthInput:n,operatorLabel:o,heightInput:s}}_createPaddingField(){const e=this.locale,t=this.t,i=new Rc(e,Dc);return i.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),i.fieldView.bind("value").to(this,"padding"),i.fieldView.on("input",(()=>{this.padding=i.fieldView.element.value})),i}_createAlignmentFields(){const e=this.locale,t=this.t,i=new Ec(e);i.text=t("Table cell text alignment");const n=new uc(e),o="rtl"===this.locale.contentLanguageDirection;n.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),MV({view:this,icons:ZV,toolbar:n,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:e=>{if(o){if("left"===e)return"right";if("right"===e)return"left"}return e},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const s=new uc(e);return s.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),MV({view:this,icons:ZV,toolbar:s,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:n,verticalAlignmentToolbar:s,alignmentLabel:i}}_createActionButtons(){const e=this.locale,t=this.t,i=new l.Z(e),n=new l.Z(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return i.set({label:t("Save"),icon:sl.check,class:"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(o,"errorText",((...e)=>e.every((e=>!e)))),n.set({label:t("Cancel"),icon:sl.cancel,class:"ck-button-cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:n}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,i=t("Align cell text to the left"),n=t("Align cell text to the center"),o=t("Align cell text to the right"),s=t("Justify cell text");return"rtl"===e.uiLanguageDirection?{right:o,center:n,left:i,justify:s}:{left:i,center:n,right:o,justify:s}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function HV(e){return"none"!==e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function UV(e){const t=e.getSelectedElement();return t&&GV(t)?t:null}function qV(e){let t=e.getFirstPosition().parent;while(t){if(t.is("element")&&GV(t))return t;t=t.parent}return null}function GV(e){return!!e.getCustomProperty("table")&&pg(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const jV=Zc.defaultPositions,KV=[jV.northArrowSouth,jV.northArrowSouthWest,jV.northArrowSouthEast,jV.southArrowNorth,jV.southArrowNorthWest,jV.southArrowNorthEast,jV.viewportStickyNorth];function JV(e,t){const i=e.plugins.get("ContextualBalloon");if(qV(e.editing.view.document.selection)){let n;n="cell"===t?QV(e):YV(e),i.updatePosition(n)}}function YV(e){const t=e.model.document.selection.getFirstPosition(),i=t.findAncestor("table"),n=e.editing.mapper.toViewElement(i);return{target:e.editing.view.domConverter.viewToDom(n),positions:KV}}function QV(e){const t=e.editing.mapper,i=e.editing.view.domConverter,n=e.model.document.selection;if(n.rangeCount>1)return{target:()=>eA(n.getRanges(),e),positions:KV};const o=XV(n.getFirstPosition()),s=t.toViewElement(o);return{target:i.viewToDom(s),positions:KV}}function XV(e){const t=e.nodeAfter&&e.nodeAfter.is("element","tableCell");return t?e.nodeAfter:e.findAncestor("tableCell")}function eA(e,t){const i=t.editing.mapper,n=t.editing.view.domConverter,o=Array.from(e).map((e=>{const t=XV(e.start),o=i.toViewElement(t);return new Gi(n.viewToDom(o))}));return Gi.getBoundingRect(o)}var tA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function iA(e){if(!e||!(0,le.Z)(e))return e;const{top:t,right:i,bottom:n,left:o}=e;return t==i&&i==n&&n==o?t:void 0}function nA(e,t){const i=parseFloat(e);return Number.isNaN(i)||String(i)!==String(e)?e:`${i}${t}`}function oA(e,t={}){const i=Object.assign({borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:""},e);return t.includeAlignmentProperty&&!i.alignment&&(i.alignment="center"),t.includePaddingProperty&&!i.padding&&(i.padding=""),t.includeVerticalAlignmentProperty&&!i.verticalAlignment&&(i.verticalAlignment="middle"),t.includeHorizontalAlignmentProperty&&!i.horizontalAlignment&&(i.horizontalAlignment=t.isRightToLeftContent?"right":"left"),i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sA=500,rA={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",width:"tableCellWidth",height:"tableCellHeight",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class aA extends a.Z{static get requires(){return[jc]}static get pluginName(){return"TableCellPropertiesUI"}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:OV,backgroundColors:OV})}init(){const e=this.editor,t=e.t;this._defaultTableCellProperties=oA(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection}),this._balloon=e.plugins.get(jc),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableCellProperties",(i=>{const n=new l.Z(i);n.set({label:t("Cell properties"),icon:tA,tooltip:!0}),this.listenTo(n,"execute",(()=>this._showView()));const o=Object.values(rA).map((t=>e.commands.get(t)));return n.bind("isEnabled").toMany(o,"isEnabled",((...e)=>e.some((e=>e)))),n}))}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.editing.view.document,i=e.config.get("table.tableCellProperties"),n=Zl(i.borderColors),o=$l(e.locale,n),s=Zl(i.backgroundColors),r=$l(e.locale,s),a=new WV(e.locale,{borderColors:o,backgroundColors:r,defaultTableCellProperties:this._defaultTableCellProperties}),l=e.t;a.render(),this.listenTo(a,"submit",(()=>{this._hideView()})),this.listenTo(a,"cancel",(()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()})),a.keystrokes.set("Esc",((e,t)=>{this._hideView(),t()})),this.listenTo(e.ui,"update",(()=>{qV(t.selection)?this._isViewVisible&&JV(e,"cell"):this._hideView()})),Rl({emitter:a,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const c=SV(l),d=IV(l);return a.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle",this._defaultTableCellProperties.borderStyle)),a.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:a.borderColorInput,commandName:"tableCellBorderColor",errorText:c,validator:NV,defaultValue:this._defaultTableCellProperties.borderColor})),a.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:a.borderWidthInput,commandName:"tableCellBorderWidth",errorText:d,validator:RV,defaultValue:this._defaultTableCellProperties.borderWidth})),a.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:a.paddingInput,commandName:"tableCellPadding",errorText:d,validator:BV,defaultValue:this._defaultTableCellProperties.padding})),a.on("change:width",this._getValidatedPropertyChangeCallback({viewField:a.widthInput,commandName:"tableCellWidth",errorText:d,validator:BV,defaultValue:this._defaultTableCellProperties.width})),a.on("change:height",this._getValidatedPropertyChangeCallback({viewField:a.heightInput,commandName:"tableCellHeight",errorText:d,validator:BV,defaultValue:this._defaultTableCellProperties.height})),a.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:a.backgroundInput,commandName:"tableCellBackgroundColor",errorText:c,validator:NV,defaultValue:this._defaultTableCellProperties.backgroundColor})),a.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment",this._defaultTableCellProperties.horizontalAlignment)),a.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment",this._defaultTableCellProperties.verticalAlignment)),a}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(rA).map((([t,i])=>{const n=this._defaultTableCellProperties[t]||"";return[t,e.get(i).value||n]})).forEach((([e,i])=>{("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&this.view.set(e,i)}))}_showView(){const e=this.editor;this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:QV(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){if(!this._isViewInBalloon)return;const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e,t){return(i,n,o,s)=>{(s||t!==o)&&this.editor.execute(e,{value:o,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:i,validator:n,errorText:o,defaultValue:s}=e,r=(0,Pi.Z)((()=>{i.errorText=o}),sA);return(e,o,a,l)=>{r.cancel(),(l||s!==a)&&(n(a)?(this.editor.execute(t,{value:a,batch:this._undoStepBatch}),i.errorText=null):r())}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function lA(e,t){const{viewElement:i,defaultValue:n,modelAttribute:o,styleName:s,reduceBoxSides:r=!1}=t;e.for("upcast").attributeToAttribute({view:{name:i,styles:{[s]:/[\s\S]+/}},model:{key:o,value:e=>{const t=e.getNormalizedStyle(s),i=r?uA(t):t;if(n!==i)return i}}})}function cA(e,t,i,n){e.for("upcast").add((e=>e.on("element:"+t,((e,t,o)=>{if(!t.modelRange)return;const s=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter((e=>t.viewItem.hasStyle(e)));if(!s.length)return;const r={styles:s};if(!o.consumable.test(t.viewItem,r))return;const a=[...t.modelRange.getItems({shallow:!0})].pop();o.consumable.consume(t.viewItem,r);const l={style:t.viewItem.getNormalizedStyle("border-style"),color:t.viewItem.getNormalizedStyle("border-color"),width:t.viewItem.getNormalizedStyle("border-width")},c={style:uA(l.style),color:uA(l.color),width:uA(l.width)};c.style!==n.style&&o.writer.setAttribute(i.style,c.style,a),c.color!==n.color&&o.writer.setAttribute(i.color,c.color,a),c.width!==n.width&&o.writer.setAttribute(i.width,c.width,a)}))))}function dA(e,{modelElement:t,modelAttribute:i,styleName:n}){e.for("downcast").attributeToAttribute({model:{name:t,key:i},view:e=>({key:"style",value:{[n]:e}})})}function hA(e,{modelAttribute:t,styleName:i}){e.for("downcast").add((e=>e.on(`attribute:${t}:table`,((e,t,n)=>{const{item:o,attributeNewValue:s}=t,{mapper:r,writer:a}=n;if(!n.consumable.consume(t.item,e.name))return;const l=[...r.toViewElement(o).getChildren()].find((e=>e.is("element","table")));s?a.setStyle(i,s,l):a.removeStyle(i,l)}))))}function uA(e){if(!e)return;const t=["top","right","bottom","left"].map((t=>e[t])).reduce(((e,t)=>e==t?e:null));return t||e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mA extends b.Z{constructor(e,t,i){super(e),this.attributeName=t,this._defaultValue=i}refresh(){const e=this.editor,t=EC(e.model.document.selection);this.isEnabled=!!t.length,this.value=this._getSingleValue(t)}execute(e={}){const{value:t,batch:i}=e,n=this.editor.model,o=EC(n.document.selection),s=this._getValueToSet(t);n.enqueueChange(i||"default",(e=>{s?o.forEach((t=>e.setAttribute(this.attributeName,s,t))):o.forEach((t=>e.removeAttribute(this.attributeName,t)))}))}_getAttribute(e){if(!e)return;const t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const t=this._getAttribute(e[0]),i=e.every((e=>this._getAttribute(e)===t));return i?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gA extends mA{constructor(e,t){super(e,"tableCellPadding",t)}_getAttribute(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=nA(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pA extends mA{constructor(e,t){super(e,"tableCellWidth",t)}_getValueToSet(e){if(e=nA(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fA extends mA{constructor(e,t){super(e,"tableCellHeight",t)}_getValueToSet(e){return e=nA(e,"px"),e===this._defaultValue?null:e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wA extends mA{constructor(e,t){super(e,"tableCellBackgroundColor",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bA extends mA{constructor(e,t){super(e,"tableCellVerticalAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vA extends mA{constructor(e,t){super(e,"tableCellHorizontalAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _A extends mA{constructor(e,t){super(e,"tableCellBorderStyle",t)}_getAttribute(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yA extends mA{constructor(e,t){super(e,"tableCellBorderColor",t)}_getAttribute(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kA extends mA{constructor(e,t){super(e,"tableCellBorderWidth",t)}_getAttribute(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=nA(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const CA=/^(top|middle|bottom)$/,xA=/^(left|center|right|justify)$/;class VA extends a.Z{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[Wx]}init(){const e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});const n=oA(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection});e.data.addStyleProcessorRules(jh),AA(t,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),e.commands.add("tableCellBorderStyle",new _A(e,n.borderStyle)),e.commands.add("tableCellBorderColor",new yA(e,n.borderColor)),e.commands.add("tableCellBorderWidth",new kA(e,n.borderWidth)),PA(t,i,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:n.width}),e.commands.add("tableCellWidth",new pA(e,n.width)),PA(t,i,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:n.height}),e.commands.add("tableCellHeight",new fA(e,n.height)),e.data.addStyleProcessorRules(ru),PA(t,i,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:n.padding}),e.commands.add("tableCellPadding",new gA(e,n.padding)),e.data.addStyleProcessorRules(qh),PA(t,i,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),e.commands.add("tableCellBackgroundColor",new wA(e,n.backgroundColor)),EA(t,i,n.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new vA(e,n.horizontalAlignment)),TA(t,i,n.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new bA(e,n.verticalAlignment))}}function AA(e,t,i){const n={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};e.extend("tableCell",{allowAttributes:Object.values(n)}),cA(t,"td",n,i),cA(t,"th",n,i),dA(t,{modelElement:"tableCell",modelAttribute:n.style,styleName:"border-style"}),dA(t,{modelElement:"tableCell",modelAttribute:n.color,styleName:"border-color"}),dA(t,{modelElement:"tableCell",modelAttribute:n.width,styleName:"border-width"})}function EA(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:e=>({key:"style",value:{"text-align":e}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":xA}},model:{key:"tableCellHorizontalAlignment",value:e=>{const t=e.getStyle("text-align");return t===i?null:t}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:xA}},model:{key:"tableCellHorizontalAlignment",value:e=>{const t=e.getAttribute("align");return t===i?null:t}}})}function TA(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:e=>({key:"style",value:{"vertical-align":e}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":CA}},model:{key:"tableCellVerticalAlignment",value:e=>{const t=e.getStyle("vertical-align");return t===i?null:t}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:CA}},model:{key:"tableCellVerticalAlignment",value:e=>{const t=e.getAttribute("valign");return t===i?null:t}}})}function PA(e,t,i){const{modelAttribute:n}=i;e.extend("tableCell",{allowAttributes:[n]}),lA(t,{viewElement:/^(td|th)$/,...i}),dA(t,{modelElement:"tableCell",...i})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class SA extends a.Z{static get pluginName(){return"TableCellProperties"}static get requires(){return[VA,aA]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class IA extends b.Z{constructor(e,t,i){super(e),this.attributeName=t,this._defaultValue=i}refresh(){const e=this.editor,t=e.model.document.selection,i=t.getFirstPosition().findAncestor("table");this.isEnabled=!!i,this.value=this._getValue(i)}execute(e={}){const t=this.editor.model,i=t.document.selection,{value:n,batch:o}=e,s=i.getFirstPosition().findAncestor("table"),r=this._getValueToSet(n);t.enqueueChange(o||"default",(e=>{r?e.setAttribute(this.attributeName,r,s):e.removeAttribute(this.attributeName,s)}))}_getValue(e){if(!e)return;const t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class NA extends IA{constructor(e,t){super(e,"tableBackgroundColor",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class BA extends IA{constructor(e,t){super(e,"tableBorderColor",t)}_getValue(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class RA extends IA{constructor(e,t){super(e,"tableBorderStyle",t)}_getValue(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class DA extends IA{constructor(e,t){super(e,"tableBorderWidth",t)}_getValue(e){if(!e)return;const t=iA(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=nA(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class MA extends IA{constructor(e,t){super(e,"tableWidth",t)}_getValueToSet(e){if(e=nA(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class OA extends IA{constructor(e,t){super(e,"tableHeight",t)}_getValueToSet(e){return e=nA(e,"px"),e===this._defaultValue?null:e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class LA extends IA{constructor(e,t){super(e,"tableAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const FA=/^(left|center|right)$/,zA=/^(left|none|right)$/;class $A extends a.Z{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[Wx]}init(){const e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});const n=oA(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});e.data.addStyleProcessorRules(jh),ZA(t,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),e.commands.add("tableBorderColor",new BA(e,n.borderColor)),e.commands.add("tableBorderStyle",new RA(e,n.borderStyle)),e.commands.add("tableBorderWidth",new DA(e,n.borderWidth)),WA(t,i,n.alignment),e.commands.add("tableAlignment",new LA(e,n.alignment)),UA(t,i,{modelAttribute:"tableWidth",styleName:"width",defaultValue:n.width}),e.commands.add("tableWidth",new MA(e,n.width)),UA(t,i,{modelAttribute:"tableHeight",styleName:"height",defaultValue:n.height}),e.commands.add("tableHeight",new OA(e,n.height)),e.data.addStyleProcessorRules(qh),HA(t,i,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),e.commands.add("tableBackgroundColor",new NA(e,n.backgroundColor))}}function ZA(e,t,i){const n={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};e.extend("table",{allowAttributes:Object.values(n)}),cA(t,"table",n,i),hA(t,{modelAttribute:n.color,styleName:"border-color"}),hA(t,{modelAttribute:n.style,styleName:"border-style"}),hA(t,{modelAttribute:n.width,styleName:"border-width"})}function WA(e,t,i){e.extend("table",{allowAttributes:["tableAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:e=>({key:"style",value:{float:"center"===e?"none":e}}),converterPriority:"high"}),t.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:zA}},model:{key:"tableAlignment",value:e=>{let t=e.getStyle("float");return"none"===t&&(t="center"),t===i?null:t}}}).attributeToAttribute({view:{attributes:{align:FA}},model:{name:"table",key:"tableAlignment",value:e=>{const t=e.getAttribute("align");return t===i?null:t}}})}function HA(e,t,i){const{modelAttribute:n}=i;e.extend("table",{allowAttributes:[n]}),lA(t,{viewElement:"table",...i}),hA(t,i)}function UA(e,t,i){const{modelAttribute:n}=i;e.extend("table",{allowAttributes:[n]}),lA(t,{viewElement:/^(table|figure)$/,...i}),dA(t,{modelElement:"table",...i})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const qA={left:sl.objectLeft,center:sl.objectCenter,right:sl.objectRight};class GA extends cl.Z{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:i,borderWidthInput:n,borderColorInput:o,borderRowLabel:s}=this._createBorderFields(),{backgroundRowLabel:r,backgroundInput:a}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{alignmentToolbar:u,alignmentLabel:m}=this._createAlignmentFields();this.focusTracker=new en,this.keystrokes=new tn,this.children=this.createCollection(),this.borderStyleDropdown=i,this.borderWidthInput=n,this.borderColorInput=o,this.backgroundInput=a,this.widthInput=l,this.heightInput=d,this.alignmentToolbar=u;const{saveButtonView:g,cancelButtonView:p}=this._createActionButtons();this.saveButtonView=g,this.cancelButtonView=p,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Ic(e,{label:this.t("Table properties")})),this.children.add(new $V(e,{labelView:s,children:[s,i,o,n],class:"ck-table-form__border-row"})),this.children.add(new $V(e,{labelView:r,children:[r,a],class:"ck-table-form__background-row"})),this.children.add(new $V(e,{children:[new $V(e,{labelView:h,children:[h,l,c,d],class:"ck-table-form__dimensions-row"}),new $V(e,{labelView:m,children:[m,u],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new $V(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ml({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=LV({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color}),n=this.locale,o=this.t,s=new Ec(n);s.text=o("Border");const r=PV(this.t),a=new Rc(n,Mc);a.set({label:o("Style"),class:"ck-table-form__border-style"}),a.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:o("Style")}),a.fieldView.buttonView.bind("label").to(this,"borderStyle",(e=>r[e||"none"])),a.fieldView.on("execute",(e=>{this.borderStyle=e.source._borderStyleValue})),a.bind("isEmpty").to(this,"borderStyle",(e=>!e)),yc(a.fieldView,DV(this,t.style));const l=new Rc(n,Dc);l.set({label:o("Width"),class:"ck-table-form__border-width"}),l.fieldView.bind("value").to(this,"borderWidth"),l.bind("isEnabled").to(this,"borderStyle",jA),l.fieldView.on("input",(()=>{this.borderWidth=l.fieldView.element.value}));const c=new Rc(n,i);return c.set({label:o("Color"),class:"ck-table-form__border-color"}),c.fieldView.bind("value").to(this,"borderColor"),c.bind("isEnabled").to(this,"borderStyle",jA),c.fieldView.on("input",(()=>{this.borderColor=c.fieldView.value})),this.on("change:borderStyle",((e,i,n,o)=>{jA(n)||(this.borderColor="",this.borderWidth=""),jA(o)||(this.borderColor=t.color,this.borderWidth=t.width)})),{borderRowLabel:s,borderStyleDropdown:a,borderColorInput:c,borderWidthInput:l}}_createBackgroundFields(){const e=this.locale,t=this.t,i=new Ec(e);i.text=t("Background");const n=LV({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor}),o=new Rc(e,n);return o.set({label:t("Color"),class:"ck-table-properties-form__background"}),o.fieldView.bind("value").to(this,"backgroundColor"),o.fieldView.on("input",(()=>{this.backgroundColor=o.fieldView.value})),{backgroundRowLabel:i,backgroundInput:o}}_createDimensionFields(){const e=this.locale,t=this.t,i=new Ec(e);i.text=t("Dimensions");const n=new Rc(e,Dc);n.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",(()=>{this.width=n.fieldView.element.value}));const o=new cl.Z(e);o.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const s=new Rc(e,Dc);return s.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),s.fieldView.bind("value").to(this,"height"),s.fieldView.on("input",(()=>{this.height=s.fieldView.element.value})),{dimensionsLabel:i,widthInput:n,operatorLabel:o,heightInput:s}}_createAlignmentFields(){const e=this.locale,t=this.t,i=new Ec(e);i.text=t("Alignment");const n=new uc(e);return n.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),MV({view:this,icons:qA,toolbar:n,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:i,alignmentToolbar:n}}_createActionButtons(){const e=this.locale,t=this.t,i=new l.Z(e),n=new l.Z(e),o=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return i.set({label:t("Save"),icon:sl.check,class:"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(o,"errorText",((...e)=>e.every((e=>!e)))),n.set({label:t("Cancel"),icon:sl.cancel,class:"ck-button-cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:n}}get _alignmentLabels(){const e=this.locale,t=this.t,i=t("Align table to the left"),n=t("Center table"),o=t("Align table to the right");return"rtl"===e.uiLanguageDirection?{right:o,center:n,left:i}:{left:i,center:n,right:o}}}function jA(e){return"none"!==e}var KA='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const JA=500,YA={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class QA extends a.Z{static get requires(){return[jc]}static get pluginName(){return"TablePropertiesUI"}constructor(e){super(e),e.config.define("table.tableProperties",{borderColors:OV,backgroundColors:OV})}init(){const e=this.editor,t=e.t;this._defaultTableProperties=oA(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(jc),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableProperties",(i=>{const n=new l.Z(i);n.set({label:t("Table properties"),icon:KA,tooltip:!0}),this.listenTo(n,"execute",(()=>this._showView()));const o=Object.values(YA).map((t=>e.commands.get(t)));return n.bind("isEnabled").toMany(o,"isEnabled",((...e)=>e.some((e=>e)))),n}))}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableProperties"),i=Zl(t.borderColors),n=$l(e.locale,i),o=Zl(t.backgroundColors),s=$l(e.locale,o),r=new GA(e.locale,{borderColors:n,backgroundColors:s,defaultTableProperties:this._defaultTableProperties}),a=e.t;r.render(),this.listenTo(r,"submit",(()=>{this._hideView()})),this.listenTo(r,"cancel",(()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()})),r.keystrokes.set("Esc",((e,t)=>{this._hideView(),t()})),Rl({emitter:r,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const l=SV(a),c=IV(a);return r.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle",this._defaultTableProperties.borderStyle)),r.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:r.borderColorInput,commandName:"tableBorderColor",errorText:l,validator:NV,defaultValue:this._defaultTableProperties.borderColor})),r.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:r.borderWidthInput,commandName:"tableBorderWidth",errorText:c,validator:RV,defaultValue:this._defaultTableProperties.borderWidth})),r.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:r.backgroundInput,commandName:"tableBackgroundColor",errorText:l,validator:NV,defaultValue:this._defaultTableProperties.backgroundColor})),r.on("change:width",this._getValidatedPropertyChangeCallback({viewField:r.widthInput,commandName:"tableWidth",errorText:c,validator:BV,defaultValue:this._defaultTableProperties.width})),r.on("change:height",this._getValidatedPropertyChangeCallback({viewField:r.heightInput,commandName:"tableHeight",errorText:c,validator:BV,defaultValue:this._defaultTableProperties.height})),r.on("change:alignment",this._getPropertyChangeCallback("tableAlignment",this._defaultTableProperties.alignment)),r}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(YA).map((([t,i])=>{const n=this._defaultTableProperties[t]||"";return[t,e.get(i).value||n]})).forEach((([e,i])=>{("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&this.view.set(e,i)}))}_showView(){const e=this.editor;this.listenTo(e.ui,"update",(()=>{this._updateView()})),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:YV(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;qV(t.selection)?this._isViewVisible&&JV(e,"table"):this._hideView()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e,t){return(i,n,o,s)=>{(s||t!==o)&&this.editor.execute(e,{value:o,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:i,validator:n,errorText:o,defaultValue:s}=e,r=(0,Pi.Z)((()=>{i.errorText=o}),JA);return(e,o,a,l)=>{r.cancel(),(l||s!==a)&&(n(a)?(this.editor.execute(t,{value:a,batch:this._undoStepBatch}),i.errorText=null):r())}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class XA extends a.Z{static get pluginName(){return"TableProperties"}static get requires(){return[$A,QA]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eE extends a.Z{static get requires(){return[Jf]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,i=e.plugins.get(Jf),n=e.config.get("table.contentToolbar"),o=e.config.get("table.tableToolbar");n&&i.register("tableContent",{ariaLabel:t("Table toolbar"),items:n,getRelatedElement:qV}),o&&i.register("table",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:UV})}}var tE={name:"CustomCKEditor",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1},tagName:{type:String,default:"div"},placeholder:{type:String,default:""},lang:{type:String,default:null},shouldNotGroupWhenFull:{type:Boolean,default:!0},toolbarItems:{type:Array,default:()=>["heading","|","bold","italic","underline","strikethrough","code","codeBlock","subscript","superscript","removeFormat","selectAll","specialCharacters","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","todoList","alignment","|","outdent","indent","|","link","uploadImage","insertTable","mediaEmbed","findAndReplace","|","undo","redo","|","sourceEditing","addBreezeMedias","|","fullScreen"]},imageToolbarItems:{type:Array,default:()=>["imageStyle:inline","imageStyle:block","imageStyle:side","|","toggleImageCaption","imageTextAlternative","|","resizeImage:50","resizeImage:75","resizeImage:original"]},tableContentToolbar:{type:Array,default:()=>["toggleTableCaption","tableColumn","tableRow","mergeTableCells"]}},emits:["update:modelValue","ready","focus","blur","destroy"],data(){return{editor:Ym,editorConfig:{language:this.lang||this.$i18n.locale,placeholder:this.placeholder,plugins:[Ep,vl,hu,vu,Nu,im,Lu,Au,Hu,Ju,ym,Kf,qw,eb,Fb,zb,uv,db,j_,Ny,fk.Z,nd,gV,eE,VV,XA,SA,pk,wv,zd,jm,Up,$f,gf,vw,Ky,kk,fp,Pk,Lk,Hk,h,p],toolbar:{items:this.toolbarItems,shouldNotGroupWhenFull:this.shouldNotGroupWhenFull},image:{toolbar:this.imageToolbarItems,resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]},table:{contentToolbar:this.tableContentToolbar}},mediaPickerVisible:!1,STORAGE_API_BASE_URL:f.STORAGE_API_BASE_URL,BASE_URL_MUSTACHE:"{{BASE_URL}}"}},created(){document.addEventListener("add-breeze-medias",this.onAddMediaBtnClick)},beforeUnmount(){document.removeEventListener("add-breeze-medias",this.onAddMediaBtnClick)},methods:{onAddMediaBtnClick(){this.mediaPickerVisible=!0},onMediasSelected(e){if(e){let t=this.modelValue||"";e.forEach((e=>{e.type==w.Tr.IMAGE.value&&(t+=`<p><img src="${this.resolveMediaLink(e.link)}" /></p>`),e.type==w.Tr.DOCUMENT.value&&(t+=`<p><a href="${this.resolveMediaLink(e.link)}">${e.name}</a></p>`),e.type==w.Tr.AUDIO.value&&(t+=`<p style="text-align:center">[audio]${e.name}[/audio]</p>`),e.type==w.Tr.VIDEO.value&&(t+=`<p style="text-align:center">[video]${e.name}[/video]</p>`),e.type==w.Tr.OTHERS.value&&(t+=`<p><a href="${this.resolveMediaLink(e.link)}">${e.name}</a></p>`)})),this.$emit("update:modelValue",t?.replace(new RegExp(f.STORAGE_API_BASE_URL,"g"),this.BASE_URL_MUSTACHE))}this.mediaPickerVisible=!1}}},iE=i(83744);const nE=(0,iE.Z)(tE,[["render",s],["__scopeId","data-v-64323a7e"]]);var oE=nE},71561:function(e,t,i){"use strict";i.d(t,{Z:function(){return y}});var n=i(89948),o=i(82234),s=i(75979);const r=e=>((0,o.pushScopeId)("data-v-725fb0c0"),e=e(),(0,o.popScopeId)(),e),a={class:"picker-container"},l={class:"picker-content"},c={key:0},d={class:"cropper-container"},h={class:"vertical-buttons"},u=r((()=>(0,o.createElementVNode)("br",null,null,-1))),m={class:"preview-container"},g={key:1,class:"text-center"},p={class:"picker-action"},f={class:"dialog-footer"},w={name:"ImageEditor",inheritAttrs:!1};var b=Object.assign(w,{props:{cropperAutoZoom:{type:Boolean,default:!0},cropperScalable:{type:Boolean,default:!1},cropperMovable:{type:Boolean,default:!1},cropperRatio:{type:Number,default:null},roundPreview:{type:Boolean,default:!1},previewWidth:{type:Number,default:null},previewHeight:{type:Number,default:120},src:{type:String,default:null}},emits:["croppedFileChange","save","cancel"],setup(e,{emit:t}){const i=e,{t:r}=(0,n.useI18n)(),w=(0,o.ref)(null),b=(0,o.ref)({coordinates:null,image:null}),v=(0,o.computed)((()=>i.previewWidth?i.previewWidth:b.value&&b.value.coordinates?b.value.coordinates.width/b.value.coordinates.height*i.previewHeight:i.previewHeight)),_=({coordinates:e,image:i})=>{b.value={coordinates:e,image:i};const{canvas:n}=w.value.getResult();t("croppedFileChange",b.value,n.toDataURL())},y=(e,t)=>{w.value.customImageTransforms.rotate%180!==0?w.value.flip(!e,!t):w.value.flip(e,t)},k=e=>{w.value.rotate(e)},C=()=>{const{canvas:e}=w.value.getResult();t("save",b.value,e.toDataURL())};return(e,n)=>{const x=(0,o.resolveComponent)("font-awesome-icon"),V=(0,o.resolveComponent)("n-alert"),A=(0,o.resolveComponent)("n-button");return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[(0,o.createElementVNode)("div",l,[i.src?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)((0,o.unref)(s.Cropper),{ref_key:"cropper",ref:w,class:"cropper",src:i.src,"auto-zoom":i.cropperAutoZoom,"stencil-props":{movable:i.cropperMovable,scalable:i.cropperScalable,aspectRatio:i.cropperRatio,previewClass:i.roundPreview?"circle-stencil-preview":""},"image-restriction":"stencil","background-class":"cropper-background","stencil-component":i.roundPreview?(0,o.unref)(s.CircleStencil):(0,o.unref)(s.RectangleStencil),onChange:_},null,8,["src","auto-zoom","stencil-props","stencil-component"]),(0,o.createElementVNode)("div",h,[(0,o.createElementVNode)("div",{class:"square-button",title:"Flip Horizontal",onClick:n[0]||(n[0]=e=>y(!0,!1))},[(0,o.createVNode)(x,{icon:["fas","arrows-alt-h"],size:"1x",style:{color:"white"}})]),(0,o.createElementVNode)("div",{class:"square-button",title:"Flip Vertical",onClick:n[1]||(n[1]=e=>y(!1,!0))},[(0,o.createVNode)(x,{icon:["fas","arrows-alt-v"],size:"1x",style:{color:"white"}})]),(0,o.createElementVNode)("div",{class:"square-button",title:"Rotate Clockwise",onClick:n[2]||(n[2]=e=>k(90))},[(0,o.createVNode)(x,{icon:["fas","redo"],size:"1x",style:{color:"white"}})]),(0,o.createElementVNode)("div",{class:"square-button",title:"Rotate Counter-Clockwise",onClick:n[3]||(n[3]=e=>k(-90))},[(0,o.createVNode)(x,{icon:["fas","undo"],size:"1x",style:{color:"white"}})])])]),u,(0,o.createElementVNode)("div",m,[(0,o.createVNode)((0,o.unref)(s.Preview),{ref:"preview",class:(0,o.normalizeClass)(["preview",{round:i.roundPreview}]),image:(0,o.unref)(b).image,width:(0,o.unref)(v),height:i.previewHeight,coordinates:(0,o.unref)(b).coordinates},null,8,["image","width","height","class","coordinates"])])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createVNode)(V,{title:(0,o.unref)(r)("noSrcFileWarning"),type:"warning","show-icon":""},null,8,["title"])])),(0,o.createElementVNode)("div",p,[(0,o.createElementVNode)("span",f,[(0,o.createVNode)(A,{onClick:n[4]||(n[4]=e=>t("cancel"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(r)("close")),1)])),_:1}),i.src?((0,o.openBlock)(),(0,o.createBlock)(A,{key:0,type:"primary",onClick:n[5]||(n[5]=e=>C())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(r)("save")),1)])),_:1})):(0,o.createCommentVNode)("",!0)])])])])}}}),v=i(83744);const _=(0,v.Z)(b,[["__scopeId","data-v-725fb0c0"]]);var y=_},68716:function(e,t,i){"use strict";i.d(t,{Z:function(){return ce}});var n=i(82234);function o(e,t,i,o,s,r){const a=(0,n.resolveComponent)("el-button"),l=(0,n.resolveComponent)("el-col"),c=(0,n.resolveComponent)("el-input"),d=(0,n.resolveComponent)("el-row"),h=(0,n.resolveComponent)("el-card");return(0,n.openBlock)(),(0,n.createBlock)(h,null,{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(s.items,((o,h)=>((0,n.openBlock)(),(0,n.createBlock)(d,{key:h,gutter:10,class:"mb-10 urls-container"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{span:2},{default:(0,n.withCtx)((()=>[i.multiple?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,type:"primary",disabled:0===h&&i.multiple&&i.limit>0&&s.items.length>=i.limit,icon:0===h?"plus":"minus",onClick:e=>r.manageItems(h)},null,8,["disabled","icon","onClick"])):(0,n.createCommentVNode)("",!0)])),_:2},1024),(0,n.createVNode)(l,{span:20},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{modelValue:o.url,"onUpdate:modelValue":e=>o.url=e,placeholder:e.$t("insertLink"),style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1024),(0,n.createVNode)(l,{span:2},{default:(0,n.withCtx)((()=>[0===h?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,type:"primary",disabled:!r.isUrlsValid,onClick:t[0]||(t[0]=e=>r.validate())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("validate")),1)])),_:1},8,["disabled"])):(0,n.createCommentVNode)("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})}i(57658);var s=i(14340),r={name:"AddFromAnUrl",props:{multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},acceptImages:{type:Boolean,default:!0},acceptVideos:{type:Boolean,default:!0},acceptAudios:{type:Boolean,default:!0},acceptDocuments:{type:Boolean,default:!0},acceptOtherTypes:{type:Boolean,default:!0}},emits:["validate"],data(){return{items:[{url:"http://"}],docExtList:["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],vidExtList:["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"],audExtList:["MP3","WAV","M4A","WMA","AAC","FLAC"]}},computed:{isUrlsValid(){const e=this.items.filter((e=>e.url&&this.$validator.isURL(e.url)));return e.length===this.items.length}},methods:{manageItems(e){e>0?this.items.splice(e,1):this.items.push({url:"http://"})},getFileTypeByUrl(e){const t=e.split(".").pop();if(t){if(this.docExtList.includes(t.toUpperCase()))return s.Tr.DOCUMENT.value;if(this.vidExtList.includes(t.toUpperCase()))return s.Tr.VIDEO.value;if(this.imgExtList.includes(t.toUpperCase()))return s.Tr.IMAGE.value;if(this.audExtList.includes(t.toUpperCase()))return s.Tr.AUDIO.value}return s.Tr.OTHERS.value},validate(){if(this.isUrlsValid){let e=!0;const t=[];for(let i=0;i<this.items.length;i++){const n=this.getFileTypeByUrl(this.items[i].url),o=!this.acceptImages&&n==s.Tr.IMAGE.value||!this.acceptVideos&&n==s.Tr.VIDEO.value||!this.acceptAudios&&n==s.Tr.AUDIO.value||!this.acceptDocuments&&n==s.Tr.DOCUMENT.value||!this.acceptOtherTypes&&n==s.Tr.OTHERS.value;o&&this.$message.error(this.$t("fileFormatNotAllowed",[this.items[i].url])),e&&o&&(e=!1),t.push(this.items[i].url)}if(!e)return;this.$emit("validate",this.multiple?t:t[0],this.multiple)}}}},a=i(83744);const l=(0,a.Z)(r,[["render",o],["__scopeId","data-v-47880409"]]);var c=l,d=i(71561),h=i(39494);const u={class:"text-left"},m={class:"text-right"},g={key:0,class:"mt-5 text-center"},p={class:"item-selector"},f={class:"image-slot"},w={key:1,class:"item-doc"},b={class:"item-doc-center"},v={class:"item-doc-footer"},_={key:2,class:"item-aud"},y={class:"item-aud-center"},k={class:"item-aud-footer"},C={key:3,class:"item-vid"},x={class:"item-vid-center"},V={class:"item-vid-footer"},A={key:4,class:"item-oth"},E={class:"item-oth-center"},T={class:"item-oth-footer"},P={class:"text-center"},S={key:1,class:"no-medias-container mt-5"},I={class:"text-center"},N={class:"text-left item-actions-container"},B={class:"text-center"},R={id:"music",preload:"all",autoplay:"",controls:"",style:{width:"100%"}},D=["src"],M={id:"video",autoplay:"",controls:"",style:{width:"100%"}},O=["src"],L={class:"dialog-footer"};function F(e,t,i,o,s,r){const a=(0,n.resolveComponent)("el-option"),l=(0,n.resolveComponent)("el-select"),c=(0,n.resolveComponent)("el-input"),F=(0,n.resolveComponent)("el-col"),z=(0,n.resolveComponent)("el-button"),$=(0,n.resolveComponent)("el-row"),Z=(0,n.resolveComponent)("el-card"),W=(0,n.resolveComponent)("loading"),H=(0,n.resolveComponent)("el-icon"),U=(0,n.resolveComponent)("el-checkbox"),q=(0,n.resolveComponent)("Picture"),G=(0,n.resolveComponent)("el-image"),j=(0,n.resolveComponent)("font-awesome-icon"),K=(0,n.resolveComponent)("infinite-loading"),J=h.Z,Y=(0,n.resolveComponent)("el-divider"),Q=(0,n.resolveComponent)("el-table-column"),X=(0,n.resolveComponent)("el-table"),ee=(0,n.resolveComponent)("el-image-viewer"),te=(0,n.resolveComponent)("el-dialog"),ie=d.Z;return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(Z,{shadow:"never",class:"mb-10 header-card"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)($,{align:"middle"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(F,{span:16},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",u,[(0,n.createVNode)(l,{modelValue:s.mediaType,"onUpdate:modelValue":t[0]||(t[0]=e=>s.mediaType=e),placeholder:e.$t("mediaType"),style:{width:"165px"},class:"mr-10"},{default:(0,n.withCtx)((()=>[i.showImages&&i.showVideos&&i.showAudios&&i.showDocuments&&i.showOtherTypes?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,label:e.$t("allMedias"),value:0},null,8,["label"])):(0,n.createCommentVNode)("",!0),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(s.mediaTypes,(e=>((0,n.openBlock)(),(0,n.createBlock)(a,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder"]),(0,n.createVNode)(l,{modelValue:s.mediaDate,"onUpdate:modelValue":t[1]||(t[1]=e=>s.mediaDate=e),style:{width:"165px"},class:"mr-10"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(a,{label:e.$t("allDates"),value:0},null,8,["label"]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(s.mediaDates,(e=>((0,n.openBlock)(),(0,n.createBlock)(a,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,n.createVNode)(c,{modelValue:s.mediaSearch,"onUpdate:modelValue":t[2]||(t[2]=e=>s.mediaSearch=e),class:"mr-10",style:{width:"185px"},placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])])),_:1}),(0,n.createVNode)(F,{span:8},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",m,[(0,n.createVNode)(z,{size:"default",icon:"refresh-right",onClick:t[3]||(t[3]=e=>r.reset())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("reload")),1)])),_:1}),(0,n.createVNode)(z,{class:"ml-10",size:"default",type:"primary",icon:"check",disabled:!s.selectedMedias.length,onClick:t[4]||(t[4]=e=>r.validate())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("validateSelection")),1)])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1}),(0,n.createVNode)($,{gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(F,{span:16},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Z,{shadow:"never",class:"medias-card"},{default:(0,n.withCtx)((()=>[s.isLoading?((0,n.openBlock)(),(0,n.createElementBlock)("div",g,[(0,n.createVNode)(H,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(W)])),_:1},8,["color"])])):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[r.filteredMedias&&r.filteredMedias.length>0?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)($,{gutter:10,class:"mt-5"},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(r.filteredMedias,((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(F,{key:i,span:4,class:"mb-10 item-container",onClick:e=>r.updateSelectedMedias(t,i)},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",p,[(0,n.createVNode)(U,{size:"default","model-value":s.selectedMedias.findIndex((e=>e.id===t.id))>-1,onChange:e=>r.updateSelectedMedias(t,i)},null,8,["model-value","onChange"])]),t.type==s.MediaTypes.IMAGE.value?((0,n.openBlock)(),(0,n.createBlock)(G,{key:0,class:"item-img",src:e.resolveMediaLink(t.link),fit:"cover"},{error:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",f,[(0,n.createVNode)(H,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(q)])),_:1})])])),_:2},1032,["src"])):t.type==s.MediaTypes.DOCUMENT.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",w,[(0,n.createElementVNode)("div",b,[(0,n.createVNode)(j,{icon:"file",class:"item-doc-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",v,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])])):t.type==s.MediaTypes.AUDIO.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",_,[(0,n.createElementVNode)("div",y,[(0,n.createVNode)(j,{icon:"music",class:"item-aud-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",k,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])])):t.type==s.MediaTypes.VIDEO.value?((0,n.openBlock)(),(0,n.createElementBlock)("div",C,[(0,n.createElementVNode)("div",x,[(0,n.createVNode)(j,{icon:"video",class:"item-vid-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",V,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])])):((0,n.openBlock)(),(0,n.createElementBlock)("div",A,[(0,n.createElementVNode)("div",E,[(0,n.createVNode)(j,{icon:"question-circle",class:"item-oth-icon",size:"4x"}),(0,n.createElementVNode)("b",null,(0,n.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,n.createElementVNode)("div",T,[(0,n.createElementVNode)("small",null,(0,n.toDisplayString)(t.name),1)])]))])),_:2},1032,["onClick"])))),128))])),_:1}),(0,n.createVNode)(K,{onInfinite:r.infiniteHandler},{"no-more":(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("noOtherMediaFound")),1)])),"no-results":(0,n.withCtx)((()=>[(0,n.createTextVNode)(".")])),spinner:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",P,[(0,n.createVNode)(H,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(W)])),_:1},8,["color"])])])),error:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("somethingWrong"))+". ",1),(0,n.createElementVNode)("a",{href:"javascript:;",onClick:t[5]||(t[5]=t=>e.location.reload())},(0,n.toDisplayString)(e.$t("retry")),1)])),_:1},8,["onInfinite"])],64)):((0,n.openBlock)(),(0,n.createElementBlock)("div",S,[(0,n.createElementVNode)("div",I,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.$t("noMediaFound")),1)])]))],64))])),_:1})])),_:1}),(0,n.createVNode)(F,{span:8},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Z,{shadow:"never",class:"media-info-card"},{default:(0,n.withCtx)((()=>[s.detailsData.length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createElementVNode)("div",N,[(0,n.createVNode)(z,{icon:"view",size:"small",type:"primary",onClick:t[6]||(t[6]=e=>r.showPreview(s.currentItem,s.currentItemIndex))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("preview")),1)])),_:1}),(0,n.createVNode)(J,{"to-copy":e.resolveMediaLink(s.currentItem.link),class:"link-copy-btn",onCopy:r.copyLink},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(z,{icon:"link",size:"small",type:"success"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("copyLink")),1)])),_:1})])),_:1},8,["to-copy","onCopy"]),s.currentItem.type==s.MediaTypes.IMAGE.value?((0,n.openBlock)(),(0,n.createBlock)(z,{key:0,icon:"edit",size:"small",type:"warning",onClick:t[7]||(t[7]=e=>s.imageEditorVisible=!0)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("edit")),1)])),_:1})):(0,n.createCommentVNode)("",!0)]),(0,n.createVNode)(Y),(0,n.createVNode)(X,{data:s.detailsData,"show-header":!1,stripe:"",size:"default",style:{width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(Q,{prop:"name",label:"",width:"100"}),(0,n.createVNode)(Q,{prop:"value",label:""})])),_:1},8,["data"]),(0,n.createVNode)(Y),(0,n.createElementVNode)("div",B,[(0,n.createVNode)(z,{icon:"delete",size:"default",type:"danger",onClick:t[8]||(t[8]=e=>r.deleteItem())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("delete")),1)])),_:1})])],64)):(0,n.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),s.showViewer?((0,n.openBlock)(),(0,n.createBlock)(ee,{key:0,infinite:!1,"hide-on-click-modal":!0,"url-list":r.filteredMediaLinks,"initial-index":s.currentItemIndex,onClose:t[9]||(t[9]=e=>s.showViewer=!1)},null,8,["url-list","initial-index"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(te,{modelValue:s.showAudioReaderDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>s.showAudioReaderDialog=e),width:"35%","show-close":"","destroy-on-close":"",title:s.currentItem?s.currentItem.name:"",top:"30vh"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("audio",R,[(0,n.createElementVNode)("source",{src:e.resolveMediaLink(s.currentItem.link)},null,8,D)])])),_:1},8,["modelValue","title"]),(0,n.createVNode)(te,{modelValue:s.showVideoReaderDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>s.showVideoReaderDialog=e),width:"45%","show-close":"","destroy-on-close":"",title:s.currentItem?s.currentItem.name:"",top:"10vh"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("video",M,[(0,n.createElementVNode)("source",{src:e.resolveMediaLink(s.currentItem.link)},null,8,O)])])),_:1},8,["modelValue","title"]),(0,n.createVNode)(te,{modelValue:s.imageEditorVisible,"onUpdate:modelValue":t[17]||(t[17]=e=>s.imageEditorVisible=e),"destroy-on-close":"",top:"1vh"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(ie,{"cropper-ratio":null,"round-preview":!1,src:s.currentItem?e.resolveMediaLink(s.currentItem.link):null,onCancel:t[12]||(t[12]=e=>s.imageEditorVisible=!1),onSave:r.storeEditedPicture},null,8,["src","onSave"]),(0,n.createVNode)(te,{modelValue:s.imageEditorConfirmVisible,"onUpdate:modelValue":t[16]||(t[16]=e=>s.imageEditorConfirmVisible=e),width:"50%",title:e.$t("confirmation"),"append-to-body":""},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("span",L,[(0,n.createVNode)(z,{size:"default",onClick:t[13]||(t[13]=e=>s.imageEditorConfirmVisible=!1)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,n.createVNode)(z,{type:"primary",size:"default",onClick:t[14]||(t[14]=e=>r.saveEditedPicture(!1))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("saveNewFile")),1)])),_:1}),(0,n.createVNode)(z,{type:"danger",size:"default",onClick:t[15]||(t[15]=e=>r.saveEditedPicture(!0))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("overwriteExistingFile")),1)])),_:1})])])),default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("whatDoYouWantToDo"))+" ",1)])),_:1},8,["modelValue","title"])])),_:1},8,["modelValue"])],64)}var z=i(39355),$=i(11165),Z=i(92829),W=i(98761),H=i(64713),U=i(21101),q={name:"MediaLibrary",mixins:[W.Z],props:{multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},showImages:{type:Boolean,default:!0},showVideos:{type:Boolean,default:!0},showAudios:{type:Boolean,default:!0},showDocuments:{type:Boolean,default:!0},showOtherTypes:{type:Boolean,default:!0},baseUrl:{type:String,default:$.STORAGE_API_BASE_URL},folder:{type:String,default:"medias"},initSelectedMedias:{type:Array,default:null}},emits:["validate"],data(){return{MediaTypes:s.Tr,users:[],medias:[],mediaDate:0,mediaType:0,mediaTypes:[],mediaDates:[],detailsData:[],mediaSearch:"",isLoading:!0,showViewer:!1,currentItem:null,lastMediaRowId:0,selectedMedias:[],currentItemIndex:0,imageEditorVisible:!1,currentEditorDataUrl:null,showAudioReaderDialog:!1,showVideoReaderDialog:!1,imageEditorConfirmVisible:!1}},computed:{filteredMedias(){let e=[];const t=this.medias.filter((e=>0==this.mediaType||e.type==this.mediaType));e=this.mediaSearch?t.filter((e=>e.name.toLowerCase().includes(this.mediaSearch.toLowerCase()))):t;const i=e.filter((e=>0==this.mediaDate||this.extractDatetimeMonthYear(e.insert_datetime)==this.mediaDate));return i},filteredMediaLinks(){const e=[];return this.filteredMedias.forEach((t=>{t.type==s.Tr.IMAGE.value&&e.push(this.resolveMediaLink(t.link))})),e}},watch:{medias:{handler(e,t){this.loadMediaDates()},deep:!0}},created(){this.$_.forIn(s.Tr,((e,t)=>{this.showImages&&e.value==s.Tr.IMAGE.value&&this.mediaTypes.push(e),this.showAudios&&e.value==s.Tr.AUDIO.value&&this.mediaTypes.push(e),this.showVideos&&e.value==s.Tr.VIDEO.value&&this.mediaTypes.push(e),this.showOtherTypes&&e.value==s.Tr.OTHERS.value&&this.mediaTypes.push(e),this.showDocuments&&e.value==s.Tr.DOCUMENT.value&&this.mediaTypes.push(e)})),this.mediaType=this.showImages&&this.showVideos&&this.showAudios&&this.showDocuments&&this.showOtherTypes?0:this.mediaTypes[0].value,this.init()},methods:{...(0,U.mapActions)("media",["getMediasPage","deleteMedia","generateThumbnail"]),...(0,U.mapActions)("user",["getAllUsers"]),async init(){const e=await this.getAllUsers();e.data&&(this.users=e.data);let t=null;const i=await this.getMediasPage({offset:this.lastMediaRowId,limit:18});return i.success&&i.data?(t=i.data,this.lastMediaRowId+=t.length,this.medias.push(...t),t.forEach((e=>{this.initSelectedMedias&&this.initSelectedMedias.includes(e.link)&&this.selectedMedias.push(e)}))):this.$message.error(this.$t("anErrorOccured")),this.isLoading&&(this.isLoading=!1),t?t.length:0},async infiniteHandler(e){const t=await this.init();t>0?e.loaded():e.complete()},loadMediaDates(){this.mediaDates=[],this.medias.forEach((e=>{const t=this.extractDatetimeMonthYear(e.insert_datetime);this.mediaDates.includes(t)||this.mediaDates.push(t)}))},extractDatetimeMonthYear(e){if(!e)return"";let t=(0,z.bK)(e.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale});return t=t.split(" "),(0,Z.fm)(t[1])+" "+t[2]},showPreview(e,t){this.currentItem=e,this.currentItemIndex=t,e.type==s.Tr.IMAGE.value&&(this.showViewer=!0),e.type==s.Tr.DOCUMENT.value&&window.open(this.resolveMediaLink(e.link)),e.type==s.Tr.AUDIO.value&&(this.showAudioReaderDialog=!0),e.type==s.Tr.VIDEO.value&&(this.showVideoReaderDialog=!0),e.type==s.Tr.OTHERS.value&&this.$message.warning(this.$t("cannotOpenThisFile"))},loadDetails(e,t){this.currentItem=e,this.currentItemIndex=t;const i=this.mediaTypes.find((t=>t.value==e.type)),n=(0,z.bK)(e.insert_datetime.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale}),o=this.users.find((t=>t.id==e.sender));if(this.detailsData=[{name:this.$t("name"),value:e.name},{name:this.$t("url"),value:this.resolveMediaLink(e.link)},{name:this.$t("type"),value:i?i.label:""},{name:this.$t("size"),value:(0,Z.gB)(e.size,!0)},{name:this.$t("mimeType"),value:e.mime},{name:this.$t("sentBy"),value:o?o.name:""},{name:this.$t("date"),value:n}],e.type==s.Tr.IMAGE.value){var r=new Image;r.onload=()=>{const e=r.naturalHeight,t=r.naturalWidth;t&&e&&this.detailsData.length&&this.detailsData.push({name:this.$t("dimensions"),value:t+" x "+e})},r.src=this.resolveMediaLink(e.link)}},async reset(){this.isLoading=!0,this.medias=[],this.detailsData=[],this.selectedMedias=[],this.lastMediaRowId=0,await this.init()},copyLink(e,t){t&&this.$message.success(this.$t("mediaLinkCopied"))},updateSelectedMedias(e,t){const i=this.selectedMedias.findIndex((t=>t.id===e.id));i>-1?(this.selectedMedias.splice(i,1),this.detailsData=[]):(this.multiple?this.selectedMedias.push(e):this.selectedMedias=[e],this.loadDetails(e,t))},deleteItem(){this.$confirm(this.$t("deleteMediaQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteMedia({id:this.currentItem.id});e.success?(this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},validate(){this.$emit("validate",this.multiple?this.selectedMedias:this.selectedMedias[0],this.multiple)},storeEditedPicture(e,t){this.currentEditorDataUrl=t,this.imageEditorConfirmVisible=!0},async saveEditedPicture(e){if(this.currentEditorDataUrl){var t=(0,Z.Bo)(this.currentEditorDataUrl,{filename:this.$uuidv4()+".png",type:"image/png"});this.compressImages&&(t=await(0,Z.hv)(t,{maxSizeMB:this.compressThreshold}));const n=e?this.currentItem.name:t.name,o=new FormData;o.append("folder",this.folder),o.append("overwrite",e),o.append("file",t,n);try{const i=await this.axios.post(this.baseUrl,o,{headers:$.API_REQUEST_HEADERS});i.data&&"success"==i.data["status"]?(e&&await this.deleteMedia({id:this.currentItem.id}),await this.addItemInDB({context:H.R,data:{name:n,link:"root/"+this.folder+"/"+n,type:s.Tr.IMAGE.value,size:t.size||0,mime:t.type||"",sender:this.userData.id}}),await this.generateThumbnail({autoWidth:this.thumbnailsFormat==s.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==s.vh.AUTOHEIGHT.value,folder:this.folder,file:n,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))}),this.imageEditorConfirmVisible=!1,this.imageEditorVisible=!1,await this.reset()):this.$message.error(this.$t("anErrorOccured"))}catch(i){this.$message.error(this.$t("anErrorOccured"))}}}}};const G=(0,a.Z)(q,[["render",F],["__scopeId","data-v-0bb993f2"]]);var j=G;const K={class:"text-right"},J={class:"mr-10"},Y={class:"mr-5"},Q={key:0,class:"mb-10"},X={key:0,class:"text-left"},ee={class:"text-right"},te={class:"el-upload__text mt-10"};function ie(e,t,i,o,s,r){const a=(0,n.resolveComponent)("el-switch"),l=(0,n.resolveComponent)("el-button"),c=(0,n.resolveComponent)("el-col"),d=(0,n.resolveComponent)("el-row"),h=(0,n.resolveComponent)("el-card"),u=(0,n.resolveComponent)("el-progress"),m=(0,n.resolveComponent)("UploadFilled"),g=(0,n.resolveComponent)("el-icon"),p=(0,n.resolveComponent)("el-upload");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[s.fileList&&s.fileList.length?((0,n.openBlock)(),(0,n.createBlock)(h,{key:0,class:"mb-10 header-card",shadow:"never"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{span:24},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",K,[(0,n.createElementVNode)("span",J,[(0,n.createElementVNode)("b",Y,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.$t("overwriteDuplicateFiles")),1)]),(0,n.createVNode)(a,{modelValue:s.overwrite,"onUpdate:modelValue":t[0]||(t[0]=e=>s.overwrite=e),"active-color":e.appPrimaryColor,size:"default"},null,8,["modelValue","active-color"])]),(0,n.createVNode)(l,{size:"default",icon:"close",disabled:s.isUploading,class:"ml-10",onClick:t[1]||(t[1]=e=>r.clearFileList())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("clearList")),1)])),_:1},8,["disabled"]),(0,n.createVNode)(l,{size:"default",type:"primary",icon:"upload",disabled:s.isUploading,onClick:t[2]||(t[2]=e=>r.send())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("send")+" ("+s.fileList.length+")"),1)])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1})):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(h,{shadow:"never"},{default:(0,n.withCtx)((()=>[s.isUploading?((0,n.openBlock)(),(0,n.createElementBlock)("div",Q,[(0,n.createVNode)(d,{gutter:10,class:"mb-10"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{span:12},{default:(0,n.withCtx)((()=>[s.uploadedFileName?((0,n.openBlock)(),(0,n.createElementBlock)("div",X,(0,n.toDisplayString)(e.$t("sendingInProgress")+": "+s.uploadedFileName),1)):(0,n.createCommentVNode)("",!0)])),_:1}),(0,n.createVNode)(c,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",ee,(0,n.toDisplayString)(s.uploadedList.length+s.failedList.length+" / "+s.fileList.length),1)])),_:1})])),_:1}),(0,n.createVNode)(u,{percentage:s.percentage,format:r.format},null,8,["percentage","format"])])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(p,{ref:"upload",class:"upload-box","auto-upload":!1,"file-list":s.fileList,"on-change":r.handleChange,"on-remove":r.handleChange,headers:i.headers,action:i.baseUrl,multiple:"",drag:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(g,{class:"upload-icon",size:64},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(m)])),_:1}),(0,n.createElementVNode)("div",te,(0,n.toDisplayString)(e.$t("uploadFilesOrClickToSend")),1)])),_:1},8,["file-list","on-change","on-remove","headers","action"])])),_:1})],64)}var ne={name:"UploadFiles",mixins:[W.Z],props:{folder:{type:String,default:"medias"},maxUploadSize:{type:Number,default:256},baseUrl:{type:String,default:$.STORAGE_API_BASE_URL},headers:{type:Object,default:$.API_REQUEST_HEADERS},acceptImages:{type:Boolean,default:!0},acceptVideos:{type:Boolean,default:!0},acceptAudios:{type:Boolean,default:!0},acceptDocuments:{type:Boolean,default:!0},acceptOtherTypes:{type:Boolean,default:!0}},data(){return{fileList:[],percentage:0,failedList:[],uploadedList:[],overwrite:!0,isUploading:!1,uploadedFileName:"",docExtList:["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],vidExtList:["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"],audExtList:["MP3","WAV","M4A","WMA","AAC","FLAC"]}},computed:{acceptedExtensions(){const e=[];return this.acceptImages&&this.acceptAudios&&this.acceptVideos&&this.acceptDocuments&&this.acceptOtherTypes?"*":(this.acceptImages&&this.imgExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptAudios&&this.audExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptVideos&&this.vidExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptDocuments&&this.docExtList.forEach((t=>{e.push("."+t.toLowerCase())})),e.join(", "))}},methods:{...(0,U.mapActions)("media",["generateThumbnail"]),format(e){return 100===e?this.$t("completed"):`${e}%`},handleChange(e,t){this.fileList=t},getFileTypeByName(e){const t=e.split(".").pop();if(t){if(this.docExtList.includes(t.toUpperCase()))return s.Tr.DOCUMENT.value;if(this.vidExtList.includes(t.toUpperCase()))return s.Tr.VIDEO.value;if(this.imgExtList.includes(t.toUpperCase()))return s.Tr.IMAGE.value;if(this.audExtList.includes(t.toUpperCase()))return s.Tr.AUDIO.value}return s.Tr.OTHERS.value},async send(){let e=!0;for(let n=0;n<this.fileList.length;n++){const t=this.fileList[n].size/1024/1024<this.maxUploadSize;t||(e=!1,this.$message.error(this.$t("uploadFileSizeWarning",[this.fileList[n].name,this.maxUploadSize])));const i=this.getFileTypeByName(this.fileList[n].name),o=!this.acceptImages&&i==s.Tr.IMAGE.value||!this.acceptVideos&&i==s.Tr.VIDEO.value||!this.acceptAudios&&i==s.Tr.AUDIO.value||!this.acceptDocuments&&i==s.Tr.DOCUMENT.value||!this.acceptOtherTypes&&i==s.Tr.OTHERS.value;o&&this.$message.error(this.$t("fileFormatNotAllowed",[this.fileList[n].name])),e&&o&&(e=!1)}if(e){this.isUploading=!0;for(let e=0;e<this.fileList.length;e++){const n=this.fileList[e].name;var t=this.fileList[e].raw;this.compressImages&&(t=await(0,Z.hv)(t,{maxSizeMB:this.compressThreshold}));const o=new FormData;o.append("folder",this.folder),o.append("overwrite",this.overwrite),o.append("file",t,n);try{this.percentage=0,this.uploadedFileName=this.fileList[e].name;const i=await this.axios.post(this.baseUrl,o,{headers:this.headers,onUploadProgress:e=>{null!==e.total&&(this.percentage=Math.round(100*e.loaded/e.total))}});i.data&&"success"==i.data["status"]?(this.uploadedList.push(this.fileList[e].name),await this.addItemInDB({context:H.R,data:{name:n,link:"root/"+this.folder+"/"+n,type:this.getFileTypeByName(n),size:t.size||0,mime:t.type||"",sender:this.userData.id}}),this.getFileTypeByName(n)==s.Tr.IMAGE.value&&await this.generateThumbnail({autoWidth:this.thumbnailsFormat==s.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==s.vh.AUTOHEIGHT.value,folder:this.folder,file:n,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))})):i.data&&"exists"==i.data["status"]?(this.failedList.push(this.fileList[e].name),this.$message({type:"error",duration:5e3,showClose:!0,message:this.$t("fileExistsError",[this.fileList[e].name])})):(this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name])))}catch(i){this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name]))}this.uploadedFileName=""}setTimeout((()=>{this.$message({showClose:!0,duration:5e3,message:this.$t("sendingCompleted",[this.uploadedList.length,this.failedList.length])}),this.clearFileList(),this.isUploading=!1}),1e3)}},clearFileList(){this.fileList=[],this.failedList=[],this.uploadedList=[]}}};const oe=(0,a.Z)(ne,[["render",ie],["__scopeId","data-v-66d0394a"]]);var se=oe;function re(e,t,i,o,s,r){const a=se,l=(0,n.resolveComponent)("el-tab-pane"),d=j,h=c,u=(0,n.resolveComponent)("el-tabs");return(0,n.openBlock)(),(0,n.createBlock)(u,{modelValue:s.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>s.tab=e),type:"card",onTabClick:r.handleClick},{default:(0,n.withCtx)((()=>[i.enableUploadFiles?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,label:e.$t("uploadFiles"),name:"1"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(a,{"max-upload-size":i.uploadConfig.maxUploadSize,"base-url":i.uploadConfig.baseUrl,folder:i.uploadConfig.folder,"accept-images":i.displayImages,"accept-videos":i.displayVideos,"accept-audios":i.displayAudios,"accept-documents":i.displayDocuments,"accept-other-types":i.displayOtherTypes},null,8,["max-upload-size","base-url","folder","accept-images","accept-videos","accept-audios","accept-documents","accept-other-types"])])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0),i.enableMediaLibrary?((0,n.openBlock)(),(0,n.createBlock)(l,{key:1,label:e.$t("mediaLibrary"),name:"2"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{limit:i.limit,multiple:i.multiple,"show-images":i.displayImages,"show-videos":i.displayVideos,"show-audios":i.displayAudios,"show-documents":i.displayDocuments,"show-other-types":i.displayOtherTypes,"init-selected-medias":i.initSelectedMedias,onValidate:r.validateSelection},null,8,["limit","multiple","show-images","show-videos","show-audios","show-documents","show-other-types","init-selected-medias","onValidate"])])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0),i.enableAddFromAnUrl?((0,n.openBlock)(),(0,n.createBlock)(l,{key:2,label:e.$t("addFromAnUrl"),name:"3"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(h,{limit:i.limit,multiple:i.multiple,"accept-images":i.displayImages,"accept-videos":i.displayVideos,"accept-audios":i.displayAudios,"accept-documents":i.displayDocuments,"accept-other-types":i.displayOtherTypes,onValidate:r.validateLinks},null,8,["limit","multiple","accept-images","accept-videos","accept-audios","accept-documents","accept-other-types","onValidate"])])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0)])),_:1},8,["modelValue","onTabClick"])}var ae={name:"MediaPicker",components:{UploadFiles:se,MediaLibrary:j,AddFromAnUrl:c},props:{enableUploadFiles:{type:Boolean,default:!0},enableMediaLibrary:{type:Boolean,default:!0},enableAddFromAnUrl:{type:Boolean,default:!0},displayImages:{type:Boolean,default:!0},displayVideos:{type:Boolean,default:!0},displayAudios:{type:Boolean,default:!0},displayDocuments:{type:Boolean,default:!0},displayOtherTypes:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},uploadConfig:{type:Object,default:()=>({folder:"medias",maxUploadSize:256,baseUrl:$.STORAGE_API_BASE_URL})},currentTab:{type:String,default:"2"},initSelectedMedias:{type:Array,default:null},enableSelectionDetails:{type:Boolean,default:!1}},emits:["selected"],data(){return{tab:this.currentTab}},methods:{handleClick(){},validateSelection(e,t){if(t){const t=[];e.forEach((e=>{this.enableSelectionDetails?t.push(e):t.push(e.link)})),this.$emit("selected",t)}else this.$emit("selected",this.enableSelectionDetails?e:e.link)},validateLinks(e,t){t?this.$emit("selected",e):this.$emit("selected",e[0])}}};const le=(0,a.Z)(ae,[["render",re],["__scopeId","data-v-ce9c6404"]]);var ce=le},12670:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var n=i(31377),o=i(82234);const s={style:{float:"left"}},r={style:{float:"left"}};function a(e,t,i,a,l,c){const d=(0,o.resolveComponent)("country-flag"),h=(0,o.resolveComponent)("el-option"),u=(0,o.resolveComponent)("el-select"),m=(0,o.resolveComponent)("el-col"),g=n.Z,p=(0,o.resolveComponent)("el-input"),f=(0,o.resolveComponent)("el-row");return i.reverse?((0,o.openBlock)(),(0,o.createBlock)(f,{key:0,gutter:2,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{span:i.selectorSpan},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{modelValue:l.langCode,"onUpdate:modelValue":t[0]||(t[0]=e=>l.langCode=e),size:i.size,style:{width:"100%"},placeholder:e.$t("code"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,o.createSlots)({default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.langList,(e=>((0,o.openBlock)(),(0,o.createBlock)(h,{key:e.code,value:e.code,label:i.displayCode?e.code:" "},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",s," [ "+(0,o.toDisplayString)(e.code)+" ] "+(0,o.toDisplayString)(e.label),1)])),_:2},1032,["value","label"])))),128))])),_:2},[i.displayFlag?{name:"prefix",fn:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{iso:l.langCode.replace("EN","GB"),class:"ml-5 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","size","placeholder","no-data-text","no-match-text"])])),_:1},8,["span"]),(0,o.createVNode)(m,{span:24-i.selectorSpan},{default:(0,o.withCtx)((()=>["editor"==i.type?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0,modelValue:c.content,"onUpdate:modelValue":t[1]||(t[1]=e=>c.content=e),style:(0,o.normalizeStyle)(i.inputStyles),placeholder:i.placeholder,"toolbar-items":i.contentEditorItems,"should-not-group-when-full":!1},null,8,["modelValue","style","placeholder","toolbar-items"])):(0,o.createCommentVNode)("",!0),"text"==i.type?((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,modelValue:c.content,"onUpdate:modelValue":t[2]||(t[2]=e=>c.content=e),size:i.size,type:i.type,style:(0,o.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","style","placeholder"])):(0,o.createCommentVNode)("",!0),"textarea"==i.type?((0,o.openBlock)(),(0,o.createBlock)(p,{key:2,modelValue:c.content,"onUpdate:modelValue":t[3]||(t[3]=e=>c.content=e),size:i.size,type:i.type,rows:i.rows,style:(0,o.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","rows","style","placeholder"])):(0,o.createCommentVNode)("",!0)])),_:1},8,["span"])])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(f,{key:1,gutter:2,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{span:24-i.selectorSpan},{default:(0,o.withCtx)((()=>["editor"==i.type?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0,modelValue:c.content,"onUpdate:modelValue":t[4]||(t[4]=e=>c.content=e),style:(0,o.normalizeStyle)(i.inputStyles),placeholder:i.placeholder,"toolbar-items":i.contentEditorItems,"should-not-group-when-full":!1},null,8,["modelValue","style","placeholder","toolbar-items"])):(0,o.createCommentVNode)("",!0),"text"==i.type?((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,modelValue:c.content,"onUpdate:modelValue":t[5]||(t[5]=e=>c.content=e),size:i.size,type:i.type,style:(0,o.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","style","placeholder"])):(0,o.createCommentVNode)("",!0),"textarea"==i.type?((0,o.openBlock)(),(0,o.createBlock)(p,{key:2,modelValue:c.content,"onUpdate:modelValue":t[6]||(t[6]=e=>c.content=e),size:i.size,type:i.type,rows:i.rows,style:(0,o.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","rows","style","placeholder"])):(0,o.createCommentVNode)("",!0)])),_:1},8,["span"]),(0,o.createVNode)(m,{span:i.selectorSpan},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{modelValue:l.langCode,"onUpdate:modelValue":t[7]||(t[7]=e=>l.langCode=e),size:i.size,style:{width:"100%"},placeholder:e.$t("code"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,o.createSlots)({default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.langList,(e=>((0,o.openBlock)(),(0,o.createBlock)(h,{key:e.code,value:e.code,label:i.displayCode?e.code:" "},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",r,(0,o.toDisplayString)(e.label),1)])),_:2},1032,["value","label"])))),128))])),_:2},[i.displayFlag?{name:"prefix",fn:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{iso:l.langCode.replace("EN","GB"),class:"ml-5 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","size","placeholder","no-data-text","no-match-text"])])),_:1},8,["span"])])),_:1}))}var l=i(2258);const c=()=>({langCode:""}),d={},h={},u=(0,l.defineStore)("mltlang",{state:c,getters:d,actions:h});var m=i(98761),g={name:"MltlangInput",mixins:[m.Z],props:{type:{type:String,default:"text"},size:{type:String,default:"default"},placeholder:{type:String,default:""},inputStyles:{type:Object,default:()=>({width:"100%"})},selectorSpan:{type:Number,default:3},modelValue:{type:String,required:!0},displayCode:{type:Boolean,default:!1},displayFlag:{type:Boolean,default:!0},reverse:{type:Boolean,default:!1},synchro:{type:Boolean,default:!1},rows:{type:Number,default:2},contentEditorItems:{type:Array,default:()=>["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"]}},emits:["update:modelValue","codeChange"],setup(){const e=u();return{mltlangStore:e}},data(){return{langCode:""}},computed:{content:{get(){let e;try{e=JSON.parse(this.modelValue)}catch(t){e={}}return e[this.langCode]||""},set(e){let t;try{t=JSON.parse(this.modelValue)}catch(i){t={}}t[this.langCode]=e,this.$emit("update:modelValue",JSON.stringify(t))}}},watch:{langCode:{handler(e,t){this.$emit("codeChange",e),this.mltlangStore.langCode=e}},"mltlangStore.langCode":{handler(e,t){this.synchro&&(this.langCode=e)}}},created(){this.mltlangStore.langCode&&(this.langCode=this.mltlangStore.langCode),this.langList?.length&&!this.langCode&&(this.langCode=this.langList[0]?.code)}},p=i(83744);const f=(0,p.Z)(g,[["render",a],["__scopeId","data-v-494e3f59"]]);var w=f},97200:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var n=i(82234);const o=(0,n.createElementVNode)("div",null,"Sticky Top",-1);function s(e,t,i,s,r,a){return(0,n.openBlock)(),(0,n.createElementBlock)("div",{style:(0,n.normalizeStyle)({height:r.height+"px",zIndex:i.zIndex})},[(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)(i.className),style:(0,n.normalizeStyle)({top:r.isSticky?i.top+"px":"",zIndex:i.zIndex,position:r.position,width:r.width,height:r.height+"px"})},[(0,n.renderSlot)(e.$slots,"default",{},(()=>[o]))],6)],4)}var r={name:"Sticky",props:{top:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated(){this.handleScroll()},unmounted(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset(){this.active&&this.reset()},reset(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll(){const e=this.$el.getBoundingClientRect().width;this.width=e||"auto";const t=this.$el.getBoundingClientRect().top;t<this.top?this.sticky():this.handleReset()},handleResize(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},a=i(83744);const l=(0,a.Z)(r,[["render",s]]);var c=l},75976:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return M}});var n=i(12670),o=i(82234);const s={style:{"line-height":"36px","font-size":"18px"}},r={key:0},a={key:1},l={key:0},c={key:1},d={style:{"text-align":"center","margin-top":"20px",display:"flex"}},h={key:0,style:{color:"#000"}},u={key:1},m={style:{float:"left"}},g={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"12px"}},p={class:"image-slot"},f={class:"dialog-footer"},w={key:0,style:{color:"#000"}},b={key:1},v={style:{float:"left"}},_={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"12px"}},y={class:"image-slot"},k={class:"dialog-footer"};function C(e,t,i,C,x,V){const A=(0,o.resolveComponent)("el-col"),E=(0,o.resolveComponent)("el-button"),T=(0,o.resolveComponent)("el-row"),P=(0,o.resolveComponent)("el-card"),S=(0,o.resolveComponent)("el-table-column"),I=(0,o.resolveComponent)("el-tag"),N=(0,o.resolveComponent)("el-input"),B=(0,o.resolveComponent)("el-table"),R=(0,o.resolveComponent)("el-pagination"),D=n.Z,M=(0,o.resolveComponent)("el-form-item"),O=(0,o.resolveComponent)("el-input-number"),L=(0,o.resolveComponent)("el-option"),F=(0,o.resolveComponent)("el-select"),z=(0,o.resolveComponent)("InfoFilled"),$=(0,o.resolveComponent)("el-icon"),Z=(0,o.resolveComponent)("el-tooltip"),W=(0,o.resolveComponent)("el-alert"),H=(0,o.resolveComponent)("Picture"),U=(0,o.resolveComponent)("el-image"),q=(0,o.resolveComponent)("el-radio-button"),G=(0,o.resolveComponent)("el-radio-group"),j=(0,o.resolveComponent)("el-form"),K=(0,o.resolveComponent)("el-dialog"),J=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[x.menu?((0,o.openBlock)(),(0,o.createBlock)(P,{key:0,class:"mb-10 header-card",shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",s,(0,o.toDisplayString)(e.tr(x.menu.name)),1)])),_:1}),(0,o.createVNode)(A,{span:12,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(E,{size:"default",type:"primary",icon:"plus",onClick:t[0]||(t[0]=e=>V.addItem())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1})])),_:1})])),_:1})])),_:1})):(0,o.createCommentVNode)("",!0),x.menu?((0,o.openBlock)(),(0,o.createBlock)(P,{key:1,shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(B,{border:"","row-key":"id","default-expand-all":"",data:V.pagedTableData,"empty-text":e.$t("noData"),"row-class-name":V.tableRowClassName,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(S,{width:"50",fixed:""},{header:(0,o.withCtx)((()=>[])),_:1}),(0,o.createVNode)(S,{sortable:"",label:e.$t("name"),prop:"name",width:"150",fixed:""},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.tr(t.row.name)),1)])),_:1},8,["label"]),(0,o.createVNode)(S,{sortable:"",label:e.$t("target"),prop:"target",width:"150",fixed:""},{default:(0,o.withCtx)((e=>[e.row.type==x.MenuItemTypes.EXTERNAL_LINK.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createTextVNode)((0,o.toDisplayString)(e.row.target),1)],64)):(0,o.createCommentVNode)("",!0),e.row.type==x.MenuItemTypes.MEGA.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createTextVNode)((0,o.toDisplayString)(V.getCategoryName(e.row.target)),1)],64)):(0,o.createCommentVNode)("",!0),e.row.type==x.MenuItemTypes.INTERNAL_LINK.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createTextVNode)((0,o.toDisplayString)(V.getPageTitle(e.row.target))+" ",1),V.getPageTitle(e.row.target)&&e.row.path?((0,o.openBlock)(),(0,o.createElementBlock)("br",r)):(0,o.createCommentVNode)("",!0),e.row.path?((0,o.openBlock)(),(0,o.createElementBlock)("small",a,(0,o.toDisplayString)(e.row.path),1)):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0),e.row.type==x.MenuItemTypes.ANCHOR.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:3},[(0,o.createTextVNode)(" #"+(0,o.toDisplayString)(V.getSectionSid(e.row.target))+" ",1),V.getPageTitle(e.row.path)?((0,o.openBlock)(),(0,o.createElementBlock)("br",l)):(0,o.createCommentVNode)("",!0),V.getPageTitle(e.row.path)?((0,o.openBlock)(),(0,o.createElementBlock)("small",c,(0,o.toDisplayString)(V.getPageTitle(e.row.path)),1)):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,o.createVNode)(S,{sortable:"",label:e.$t("type"),prop:"type",width:"150"},{default:(0,o.withCtx)((e=>[(0,o.createTextVNode)((0,o.toDisplayString)(V.getTypeLabel(e.row.type)),1)])),_:1},8,["label"]),(0,o.createVNode)(S,{sortable:"",label:e.$t("status"),prop:"publish",width:"125"},{default:(0,o.withCtx)((t=>[parseInt(t.row.publish)?((0,o.openBlock)(),(0,o.createBlock)(I,{key:0,type:"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(I,{key:1,type:"danger"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}))])),_:1},8,["label"]),(0,o.createVNode)(S,{sortable:"",label:e.$t("visibility"),prop:"display",width:"125"},{default:(0,o.withCtx)((t=>[parseInt(t.row.display)?((0,o.openBlock)(),(0,o.createBlock)(I,{key:0,type:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("visible")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(I,{key:1,type:"info"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("hidden")),1)])),_:1}))])),_:1},8,["label"]),(0,o.createVNode)(S,{sortable:"",label:e.$t("position"),prop:"position",width:"175"},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(I,{type:e.row.isParent?"":"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.row.position),1)])),_:2},1032,["type"])])),_:1},8,["label"]),(0,o.createVNode)(S,{align:"right",width:"250",fixed:"right"},{header:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{modelValue:x.search,"onUpdate:modelValue":t[1]||(t[1]=e=>x.search=e),size:"small",placeholder:e.$t("search"),style:{width:"230px"}},null,8,["modelValue","placeholder"])])),default:(0,o.withCtx)((t=>[t.row.isParent?((0,o.openBlock)(),(0,o.createBlock)(E,{key:0,size:"small",type:"primary",icon:"plus",onClick:e=>V.addSubItem(t.$index,t.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("subMenu")),1)])),_:2},1032,["onClick"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(E,{size:"small",type:"warning",icon:"edit",onClick:e=>V.editItem(t.$index,t.row)},null,8,["onClick"]),(0,o.createVNode)(E,{size:"small",type:"danger",icon:"delete",onClick:e=>V.deleteItem(t.$index,t.row)},null,8,["onClick"])])),_:1})])),_:1},8,["data","empty-text","row-class-name"])),[[J,x.isLoading]]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(R,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":x.pageSize,total:x.total,onCurrentChange:V.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(K,{modelValue:x.addDialog,"onUpdate:modelValue":t[19]||(t[19]=e=>x.addDialog=e),title:e.$t("addMenuItem"),width:"50%",top:"1vh"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",f,[(0,o.createVNode)(E,{onClick:t[17]||(t[17]=e=>V.cancelForm(x.addMenuItemForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(E,{type:"primary",onClick:t[18]||(t[18]=e=>V.submitForm(x.addMenuItemForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(j,{ref:x.addMenuItemForm,rules:x.rules,model:x.addMenuItemData,"label-width":"100px","label-position":"left","hide-required-asterisk":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{prop:"name",label:e.$t("name")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:x.addMenuItemData.name,"onUpdate:modelValue":t[2]||(t[2]=e=>x.addMenuItemData.name=e),synchro:!0,"selector-span":4,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(T,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{prop:"position",label:e.$t("position")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(O,{modelValue:x.addMenuItemData.position,"onUpdate:modelValue":t[3]||(t[3]=e=>x.addMenuItemData.position=e),style:{width:"100%"},"controls-position":"right",placeholder:e.$t("position")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,o.createVNode)(A,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{prop:"type",label:e.$t("type")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(F,{modelValue:x.addMenuItemData.type,"onUpdate:modelValue":t[4]||(t[4]=e=>x.addMenuItemData.type=e),filterable:"",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),onChange:t[5]||(t[5]=e=>{x.addMenuItemData.target="",x.addMenuItemData.path=""})},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.menuItemTypes,(e=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1},8,["label"])])),_:1})])),_:1}),(0,o.createVNode)(o.Transition,{class:"el-fade-in-linear"},{default:(0,o.withCtx)((()=>[x.addMenuItemData.type?((0,o.openBlock)(),(0,o.createBlock)(M,{key:0,prop:"target",label:e.$t("target")},{default:(0,o.withCtx)((()=>[x.addMenuItemData.type==x.MenuItemTypes.EXTERNAL_LINK.value?((0,o.openBlock)(),(0,o.createBlock)(N,{key:0,modelValue:x.addMenuItemData.target,"onUpdate:modelValue":t[6]||(t[6]=e=>x.addMenuItemData.target=e),style:{width:"100%"},placeholder:e.$t("targetUrl")},null,8,["modelValue","placeholder"])):x.addMenuItemData.type==x.MenuItemTypes.MEGA.value?((0,o.openBlock)(),(0,o.createBlock)(F,{key:1,modelValue:x.addMenuItemData.target,"onUpdate:modelValue":t[7]||(t[7]=e=>x.addMenuItemData.target=e),filterable:"",style:{width:"100%"},placeholder:e.$t("chooseCategory"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.categories,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.id,label:e.tr(t.name),value:t.id},{default:(0,o.withCtx)((()=>[t.isParent?((0,o.openBlock)(),(0,o.createElementBlock)("b",h,(0,o.toDisplayString)(e.tr(t.name)),1)):((0,o.openBlock)(),(0,o.createElementBlock)("span",u,(0,o.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):x.addMenuItemData.type==x.MenuItemTypes.INTERNAL_LINK.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createVNode)(F,{modelValue:x.addMenuItemData.target,"onUpdate:modelValue":t[8]||(t[8]=e=>x.addMenuItemData.target=e),filterable:"",class:"mb-5",style:{width:"100%"},placeholder:e.$t("choosePage"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),onChange:t[9]||(t[9]=e=>x.addMenuItemData.path=V.getPageTitle(x.addMenuItemData.target).toLowerCase())},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.pages,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.id,label:e.tr(t.title),value:t.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,o.createVNode)(N,{modelValue:x.addMenuItemData.path,"onUpdate:modelValue":t[10]||(t[10]=e=>x.addMenuItemData.path=e),style:{width:"100%"},placeholder:e.$t("pagePath")},(0,o.createSlots)({append:(0,o.withCtx)((()=>[(0,o.createVNode)(Z,{content:e.$t("menuPathInfo"),effect:"light",placement:"bottom",class:"mr-2"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)($,{style:(0,o.normalizeStyle)(`font-size: 12px; color: ${e.appPrimaryColor}`)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(z)])),_:1},8,["style"])])),_:1},8,["content"])])),_:2},[V.pathBase?{name:"prepend",fn:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(V.pathBase),1)])),key:"0"}:void 0]),1032,["modelValue","placeholder"])],64)):x.addMenuItemData.type==x.MenuItemTypes.ANCHOR.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:3},[x.addMenuItemData.path&&-1==x.tableData.findIndex((e=>e.type==x.MenuItemTypes.INTERNAL_LINK.value&&e.target==x.addMenuItemData.path))?((0,o.openBlock)(),(0,o.createBlock)(W,{key:0,title:e.$t("anchorMenuPageWarning"),closable:!1,type:"warning",class:"mb-5","show-icon":""},null,8,["title"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(F,{modelValue:x.addMenuItemData.path,"onUpdate:modelValue":t[11]||(t[11]=e=>x.addMenuItemData.path=e),filterable:"",class:"mb-5",style:{width:"100%"},placeholder:e.$t("choosePage"),"no-data-text":e.$t("noPageRegistered"),"no-match-text":e.$t("noMatchingData")},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.pages,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.id,label:e.tr(t.title),value:t.id},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",m,(0,o.toDisplayString)(e.tr(t.title)),1),(0,o.createElementVNode)("span",g,(0,o.toDisplayString)(t.path),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,o.createVNode)(F,{modelValue:x.addMenuItemData.target,"onUpdate:modelValue":t[12]||(t[12]=e=>x.addMenuItemData.target=e),filterable:"",style:{width:"100%"},placeholder:e.$t("chooseSection"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(V.filteredSections,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.uid,label:t["name_"+e.$i18n.locale],value:t.uid,class:"section-select-option"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(U,{fit:"cover","append-to-body":"",class:"section-select-preview",src:e.resolveSectionPreview(t.sid)},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",p,[(0,o.createVNode)($,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(H)])),_:1})])])),_:2},1032,["src"]),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t["name_"+e.$i18n.locale]),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])],64)):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1}),(0,o.createVNode)(M,{prop:"description",label:e.$t("description")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:x.addMenuItemData.description,"onUpdate:modelValue":t[13]||(t[13]=e=>x.addMenuItemData.description=e),type:"textarea",synchro:!0,"selector-span":4,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(M,{label:e.$t("status")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{span:12,class:"text-left",style:{"padding-right":"3px"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(G,{modelValue:x.addMenuItemData.publish,"onUpdate:modelValue":t[14]||(t[14]=e=>x.addMenuItemData.publish=e),style:{width:"100%"},onChange:t[15]||(t[15]=e=>x.addMenuItemData.display=0)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(q,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.createVNode)(A,{span:12,class:"text-right",style:{"padding-left":"3px"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(G,{modelValue:x.addMenuItemData.display,"onUpdate:modelValue":t[16]||(t[16]=e=>x.addMenuItemData.display=e),disabled:!x.addMenuItemData.publish,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("hidden")),1)])),_:1}),(0,o.createVNode)(q,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("visible")),1)])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1},8,["label"])])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(K,{modelValue:x.editDialog,"onUpdate:modelValue":t[37]||(t[37]=e=>x.editDialog=e),title:e.$t("editMenuItem"),width:"50%",top:"1vh"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",k,[(0,o.createVNode)(E,{onClick:t[35]||(t[35]=e=>V.cancelForm(x.editMenuItemForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(E,{type:"primary",onClick:t[36]||(t[36]=e=>V.submitForm(x.editMenuItemForm))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(j,{ref:x.editMenuItemForm,rules:x.rules,model:x.editMenuItemData,"label-width":"100px","label-position":"left","hide-required-asterisk":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{prop:"name",label:e.$t("name")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:x.editMenuItemData.name,"onUpdate:modelValue":t[20]||(t[20]=e=>x.editMenuItemData.name=e),synchro:!0,"selector-span":4,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(T,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{prop:"position",label:e.$t("position")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(O,{modelValue:x.editMenuItemData.position,"onUpdate:modelValue":t[21]||(t[21]=e=>x.editMenuItemData.position=e),style:{width:"100%"},"controls-position":"right",placeholder:e.$t("position")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,o.createVNode)(A,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{prop:"type",label:e.$t("type")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(F,{modelValue:x.editMenuItemData.type,"onUpdate:modelValue":t[22]||(t[22]=e=>x.editMenuItemData.type=e),filterable:"",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),onChange:t[23]||(t[23]=e=>{x.editMenuItemData.target="",x.editMenuItemData.path=""})},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.menuItemTypes,(e=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1},8,["label"])])),_:1})])),_:1}),(0,o.createVNode)(o.Transition,{class:"el-fade-in-linear"},{default:(0,o.withCtx)((()=>[x.editMenuItemData.type?((0,o.openBlock)(),(0,o.createBlock)(M,{key:0,prop:"target",label:e.$t("target")},{default:(0,o.withCtx)((()=>[x.editMenuItemData.type==x.MenuItemTypes.EXTERNAL_LINK.value?((0,o.openBlock)(),(0,o.createBlock)(N,{key:0,modelValue:x.editMenuItemData.target,"onUpdate:modelValue":t[24]||(t[24]=e=>x.editMenuItemData.target=e),style:{width:"100%"},placeholder:e.$t("targetUrl")},null,8,["modelValue","placeholder"])):x.editMenuItemData.type==x.MenuItemTypes.MEGA.value?((0,o.openBlock)(),(0,o.createBlock)(F,{key:1,modelValue:x.editMenuItemData.target,"onUpdate:modelValue":t[25]||(t[25]=e=>x.editMenuItemData.target=e),filterable:"",style:{width:"100%"},placeholder:e.$t("chooseCategory"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.categories,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.id,label:e.tr(t.name),value:t.id},{default:(0,o.withCtx)((()=>[t.isParent?((0,o.openBlock)(),(0,o.createElementBlock)("b",w,(0,o.toDisplayString)(e.tr(t.name)),1)):((0,o.openBlock)(),(0,o.createElementBlock)("span",b,(0,o.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):x.editMenuItemData.type==x.MenuItemTypes.INTERNAL_LINK.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createVNode)(F,{modelValue:x.editMenuItemData.target,"onUpdate:modelValue":t[26]||(t[26]=e=>x.editMenuItemData.target=e),filterable:"",class:"mb-5",style:{width:"100%"},placeholder:e.$t("choosePage"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),onChange:t[27]||(t[27]=e=>x.editMenuItemData.path=V.getPageTitle(x.editMenuItemData.target).toLowerCase())},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.pages,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.id,label:e.tr(t.title),value:t.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,o.createVNode)(N,{modelValue:x.editMenuItemData.path,"onUpdate:modelValue":t[28]||(t[28]=e=>x.editMenuItemData.path=e),style:{width:"100%"},placeholder:e.$t("pagePath")},(0,o.createSlots)({append:(0,o.withCtx)((()=>[(0,o.createVNode)(Z,{content:e.$t("menuPathInfo"),effect:"light",placement:"bottom",class:"mr-2"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)($,{style:(0,o.normalizeStyle)(`font-size: 12px; color: ${e.appPrimaryColor}`)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(z)])),_:1},8,["style"])])),_:1},8,["content"])])),_:2},[V.pathBase?{name:"prepend",fn:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(V.pathBase),1)])),key:"0"}:void 0]),1032,["modelValue","placeholder"])],64)):x.editMenuItemData.type==x.MenuItemTypes.ANCHOR.value?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:3},[x.editMenuItemData.path&&-1==x.tableData.findIndex((e=>e.type==x.MenuItemTypes.INTERNAL_LINK.value&&e.target==x.editMenuItemData.path&&e.id!=x.currentEditItem.id))?((0,o.openBlock)(),(0,o.createBlock)(W,{key:0,title:e.$t("anchorMenuPageWarning"),closable:!1,type:"warning",class:"mb-5","show-icon":""},null,8,["title"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(F,{modelValue:x.editMenuItemData.path,"onUpdate:modelValue":t[29]||(t[29]=e=>x.editMenuItemData.path=e),filterable:"",class:"mb-5",style:{width:"100%"},placeholder:e.$t("choosePage"),"no-data-text":e.$t("noPageRegistered"),"no-match-text":e.$t("noMatchingData")},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(x.pages,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.id,label:e.tr(t.title),value:t.id},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",v,(0,o.toDisplayString)(e.tr(t.title)),1),(0,o.createElementVNode)("span",_,(0,o.toDisplayString)(t.path),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,o.createVNode)(F,{modelValue:x.editMenuItemData.target,"onUpdate:modelValue":t[30]||(t[30]=e=>x.editMenuItemData.target=e),filterable:"",style:{width:"100%"},placeholder:e.$t("chooseSection"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(V.filteredSections,(t=>((0,o.openBlock)(),(0,o.createBlock)(L,{key:t.uid,label:t["name_"+e.$i18n.locale],value:t.uid,class:"section-select-option"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(U,{fit:"cover","append-to-body":"",class:"section-select-preview",src:e.resolveSectionPreview(t.sid)},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",y,[(0,o.createVNode)($,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(H)])),_:1})])])),_:2},1032,["src"]),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t["name_"+e.$i18n.locale]),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])],64)):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1}),(0,o.createVNode)(M,{prop:"description",label:e.$t("description")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:x.editMenuItemData.description,"onUpdate:modelValue":t[31]||(t[31]=e=>x.editMenuItemData.description=e),type:"textarea",synchro:!0,"selector-span":4,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(M,{label:e.$t("status")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{gutter:10,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{span:12,class:"text-left",style:{"padding-right":"3px"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(G,{modelValue:x.editMenuItemData.publish,"onUpdate:modelValue":t[32]||(t[32]=e=>x.editMenuItemData.publish=e),style:{width:"100%"},onChange:t[33]||(t[33]=e=>x.editMenuItemData.display=0)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(q,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.createVNode)(A,{span:12,class:"text-right",style:{"padding-left":"3px"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(G,{modelValue:x.editMenuItemData.display,"onUpdate:modelValue":t[34]||(t[34]=e=>x.editMenuItemData.display=e),disabled:!x.editMenuItemData.publish,style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("hidden")),1)])),_:1}),(0,o.createVNode)(q,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("visible")),1)])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1},8,["label"])])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"])],64)}i(57658);var x=i(11165),V=i(14340),A=i(92829),E=i(31567),T=i(98761),P=i(38855),S=i(66060),I=i(43188),N=i(21101),B={name:"MenuStructure",mixins:[P.Z,E.Z,S.Z,T.Z],data(){return{MenuItemTypes:V.m8,menuItemTypes:[],categories:[],sections:[],pages:[],menu:null,editMenuItemData:{name:"",position:null,parent:"",target:"",description:"",publish:"",display:0,type:"",path:""},addMenuItemData:{name:"",position:null,parent:"",target:"",description:"",publish:"",display:0,type:"",path:""},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],position:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],target:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],type:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],publish:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},addMenuItemForm:"addMenuItemForm",editMenuItemForm:"editMenuItemForm",currentEditItem:null,editDialog:!1,addDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)},pathBase(){const e=this.websiteMoreInfo.websiteUrl||x.APP_BASE_URL;return e?(0,A.Qj)(e)+"/":""},registeredPages(){const e=[];return this.tableData.forEach((t=>{t.type==V.m8.INTERNAL_LINK.value&&t.path&&-1==e.findIndex((e=>e.id==t.target))&&e.push({id:t.target,title:this.pages.find((e=>e.id==t.target))?.title,path:t.path})})),e},filteredSections(){const e=this.addDialog?this.addMenuItemData.path:this.editMenuItemData.path,t=this.pages.find((t=>t.id==e));let i,n;const o=[];try{i=JSON.parse(t.top_sections),n=JSON.parse(t.bottom_sections)}catch(s){i=[],n=[]}return this.sections.forEach((e=>{(i.includes(e.uid)||n.includes(e.uid))&&o.push(e)})),o}},watch:{"addMenuItemData.path":{handler(e,t){this.addMenuItemData.path=e.trim().replace(/\s+/g,"-").toLowerCase()}},"editMenuItemData.path":{handler(e,t){this.editMenuItemData.path=e.trim().replace(/\s+/g,"-").toLowerCase()}}},async created(){if(this.$route.params&&this.$route.params.menu){const e=await this.getItemFromDB({context:I.D,id:this.$route.params.menu});e.data&&e.success&&(this.menu=e.data,this.init())}this.$_.forIn(V.m8,((e,t)=>{this.menuItemTypes.push(e)})),this.$_.forIn(this.sectionsJSONData,((e,t)=>{this.sections.push(e)}))},methods:{...(0,N.mapActions)("menu",["getMenuItemsByParent","addMenuItem","updateMenuItem","deleteMenuItem"]),...(0,N.mapActions)("newsCategory",["getCategoriesByParent"]),...(0,N.mapActions)("page",["getAllPages"]),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},getTypeLabel(e){const t=this.menuItemTypes.find((t=>t.value==e));return t?t.label:""},getPageTitle(e){const t=this.pages.find((t=>t.id==e));return t?this.tr(t.title):""},getSectionSid(e){const t=this.sections.find((t=>t.uid==e));return t?t.sid:""},getSectionName(e){const t=this.sections.find((t=>t.sid==e));return t?t["name_"+this.$i18n.locale]:""},getCategoryName(e){const t=this.categories.find((t=>t.id==e));return t?this.tr(t.name):""},tableRowClassName({row:e,rowIndex:t}){return e.isParent?"":"info-row"},async init(){this.isLoading=!0;const e=await this.getAllPages();e.data&&(this.pages=e.data),this.categories=[];const t=await this.getCategoriesByParent(0);if(t.success&&t.data){const e=t.data;for(let t=0;t<e.length;t++){const i=await this.getCategoriesByParent(e[t].id);e[t].isParent=!0,this.categories.push(e[t]),i.success&&i.data&&i.data.forEach((e=>{this.categories.push(e)}))}}const i=await this.getMenuItemsByParent(0);if(i.success&&i.data){this.tableData=i.data.filter((e=>e.menu==this.menu.id));for(let e=0;e<this.tableData.length;e++){const t=await this.getMenuItemsByParent(this.tableData[e].id);if(this.tableData[e].isParent=!0,t.success&&t.data){const i=[];t.data.forEach((e=>{e.menu==this.menu.id&&i.push(e)})),this.tableData[e].children=i}}}else this.$message.error(this.$t("anErrorOccured"));this.isLoading=!1},addItem(){this.addMenuItemData.parent=0,this.addDialog=!0},addSubItem(e,t){this.addMenuItemData.parent=t.id,this.addDialog=!0},async editItem(e,t){this.currentEditItem=t,this.editMenuItemData.name=t.name,this.editMenuItemData.target=t.target,this.editMenuItemData.position=parseInt(t.position),this.editMenuItemData.description=t.description,this.editMenuItemData.publish=parseInt(t.publish),this.editMenuItemData.display=parseInt(t.display),this.editMenuItemData.type=parseInt(t.type),this.editMenuItemData.path=(0,A.FY)(t.path),this.editDialog=!0},deleteItem(e,t){this.$confirm(this.$t("deleteMenuItemQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteMenuItem(t.id);e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;if(e===this.addMenuItemForm)if(this.menu){if(this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.addMenuItemData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;const e=await this.addMenuItem({name:this.addMenuItemData.name,position:this.addMenuItemData.position||0,parent:this.addMenuItemData.parent,target:this.addMenuItemData.target,description:this.addMenuItemData.description,publish:this.addMenuItemData.publish,display:this.addMenuItemData.display,type:this.addMenuItemData.type,path:this.addMenuItemData.type==V.m8.INTERNAL_LINK.value?"/"+(0,A.FY)(this.addMenuItemData.path):this.addMenuItemData.path,menu:this.menu.id});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}else this.$message.error(this.$t("anErrorOccured"));else if(e===this.editMenuItemForm){const e={};if(this.tr(this.currentEditItem.name)!==this.tr(this.editMenuItemData.name)&&this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.editMenuItemData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(e["name"]=this.editMenuItemData.name,this.currentEditItem.position!==this.editMenuItemData.position&&(e["position"]=this.editMenuItemData.position),this.currentEditItem.target!==this.editMenuItemData.target&&(e["target"]=this.editMenuItemData.target),this.currentEditItem.description!==this.editMenuItemData.description&&(e["description"]=this.editMenuItemData.description),this.currentEditItem.publish!==this.editMenuItemData.publish&&(e["publish"]=this.editMenuItemData.publish),this.currentEditItem.display!==this.editMenuItemData.display&&(e["display"]=this.editMenuItemData.display),this.currentEditItem.type!==this.editMenuItemData.type&&(e["type"]=this.editMenuItemData.type),this.currentEditItem.path!==this.editMenuItemData.path&&(e["path"]=this.editMenuItemData.type==V.m8.INTERNAL_LINK.value?"/"+(0,A.FY)(this.editMenuItemData.path):this.editMenuItemData.path),!this.$_.isEmpty(e)){const t=await this.updateMenuItem({id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.cancelForm(e),this.init()}))},cancelForm(e){this.$refs[e].resetFields(),this.addDialog=this.editDialog=!1}}},R=i(83744);const D=(0,R.Z)(B,[["render",C],["__scopeId","data-v-a2fdb6d8"]]);var M=D},85478:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return _}});var n=i(12670),o=i(82234);const s={class:"text-left"},r={class:"text-right"},a={style:{"text-align":"center","margin-top":"20px",display:"flex"}},l={class:"dialog-footer"},c={class:"dialog-footer"};function d(e,t,i,d,h,u){const m=(0,o.resolveComponent)("el-alert"),g=(0,o.resolveComponent)("el-col"),p=(0,o.resolveComponent)("el-button"),f=(0,o.resolveComponent)("el-row"),w=(0,o.resolveComponent)("el-table-column"),b=(0,o.resolveComponent)("el-input"),v=(0,o.resolveComponent)("el-table"),_=(0,o.resolveComponent)("el-pagination"),y=(0,o.resolveComponent)("el-card"),k=n.Z,C=(0,o.resolveComponent)("el-form-item"),x=(0,o.resolveComponent)("el-option"),V=(0,o.resolveComponent)("el-select"),A=(0,o.resolveComponent)("el-form"),E=(0,o.resolveComponent)("el-dialog"),T=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[h.isLoading||h.menuLocations.length||!h.tableData.length?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(m,{key:0,title:e.$t("menuLocationsWarning"),closable:!1,effect:"dark",class:"mb-5",type:"info","show-icon":""},null,8,["title"])),(0,o.createVNode)(y,{shadow:"hover"},{header:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{align:"middle"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.$t("menus")),1)])])),_:1}),(0,o.createVNode)(g,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(p,{size:"default",type:"warning",icon:"scale-to-original",onClick:t[0]||(t[0]=e=>u.manageLocations())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("manageLocations")),1)])),_:1}),(0,o.createVNode)(p,{size:"default",type:"primary",icon:"plus",onClick:t[1]||(t[1]=e=>u.addItem())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("addMenu")),1)])),_:1})])])),_:1})])),_:1})])),default:(0,o.withCtx)((()=>[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(v,{data:u.pagedTableData,"empty-text":e.$t("noData"),border:"",stripe:"",style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{type:"index",index:u.indexMethod,fixed:""},null,8,["index"]),(0,o.createVNode)(w,{sortable:"",label:e.$t("name"),prop:"name",width:"200",fixed:""},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.tr(t.row.name)),1)])),_:1},8,["label"]),(0,o.createVNode)(w,{sortable:"",label:e.$t("authorizedLocations"),prop:"locations",width:"225"},{default:(0,o.withCtx)((e=>[(0,o.createTextVNode)((0,o.toDisplayString)(u.showLocations(e.row.locations)),1)])),_:1},8,["label"]),(0,o.createVNode)(w,{sortable:"",label:e.$t("insertBy"),prop:"insert_by",width:"175"},{default:(0,o.withCtx)((e=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.row.insert_by_name),1)])),_:1},8,["label"]),(0,o.createVNode)(w,{align:"right",width:"300",fixed:"right"},{header:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{modelValue:h.search,"onUpdate:modelValue":t[2]||(t[2]=e=>h.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,o.withCtx)((t=>[(0,o.createVNode)(p,{size:"small",type:"info",icon:"fold",onClick:e=>u.openMenuStructure(t.$index,t.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("menuStructure")),1)])),_:2},1032,["onClick"]),(0,o.createVNode)(p,{size:"small",type:"warning",icon:"edit",onClick:e=>u.editItem(t.$index,t.row)},null,8,["onClick"]),(0,o.createVNode)(p,{size:"small",type:"danger",icon:"delete",onClick:e=>u.deleteItem(t.$index,t.row)},null,8,["onClick"])])),_:1})])),_:1},8,["data","empty-text"])),[[T,h.isLoading]]),(0,o.createElementVNode)("div",a,[(0,o.createVNode)(_,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":h.pageSize,total:h.total,onCurrentChange:u.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,o.createVNode)(E,{modelValue:h.menuDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>h.menuDialog=e),title:h.currentEditItem?e.$t("editMenu"):e.$t("addMenu"),width:"45%"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",l,[(0,o.createVNode)(p,{onClick:t[5]||(t[5]=e=>u.cancelForm(h.currentEditItem?"editForm":"addForm"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(p,{type:"primary",onClick:t[6]||(t[6]=e=>u.submitForm(h.currentEditItem?"editForm":"addForm"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{ref:h.currentEditItem?"editForm":"addForm",model:h.menu,rules:h.rules,"label-width":"200px","label-position":"left","hide-required-asterisk":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(C,{prop:"name",label:e.$t("name")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{modelValue:h.menu.name,"onUpdate:modelValue":t[3]||(t[3]=e=>h.menu.name=e),"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,o.createVNode)(C,{prop:"locations",label:e.$t("authorizedLocations")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V,{modelValue:h.menu.locations,"onUpdate:modelValue":t[4]||(t[4]=e=>h.menu.locations=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(h.locations,(e=>((0,o.openBlock)(),(0,o.createBlock)(x,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(E,{modelValue:h.menuLocationDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>h.menuLocationDialog=e),title:e.$t("manageLocations"),width:"35%"},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",c,[(0,o.createVNode)(p,{onClick:t[8]||(t[8]=e=>h.menuLocationDialog=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(p,{type:"primary",onClick:t[9]||(t[9]=e=>u.saveMenuLocation())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(u.getLocations,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)(f,{key:i,gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(t.label),1)])),_:2},1024),(0,o.createVNode)(g,{span:14},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V,{modelValue:t.menu,"onUpdate:modelValue":e=>t.menu=e,clearable:"",filterable:"","no-data-text":e.$t("noData"),placeholder:e.$t("chooseMenu"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(u.getLocationMenus(t.value),(t=>((0,o.openBlock)(),(0,o.createBlock)(x,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","no-data-text","placeholder","no-match-text"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue","title"])],64)}i(57658);var h=i(14340),u=i(31567),m=i(98761),g=i(38855),p=i(43188),f=i(21101),w={name:"Menus",mixins:[g.Z,u.Z,m.Z],data(){return{Routes:h.Z5,locations:[],menuLocations:[],menu:{name:"",locations:[]},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],locations:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},menuLocationDialog:!1,currentEditItem:null,menuDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)},getLocations(){return this.locations.forEach(((e,t)=>{const i=this.menuLocations.find((t=>t.location==e.value));i&&(this.locations[t].menu=i.menu)})),this.locations}},created(){this.init(),this.$_.forIn(h.Xe,((e,t)=>{this.locations.push(e)}))},methods:{...(0,f.mapActions)("menu",["getAllMenus","getAllMenuLocations","updateMenuLocations"]),...(0,f.mapActions)("user",["getAllUsers"]),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},showLocations(e){if(e){let t="";const i=e.split(";");for(let e=0;e<i.length;e++){const n=this.locations.find((t=>t.value==i[e]));n&&(t+=n.label,e+1<i.length&&(t+=" / "))}return t}return""},getLocationMenus(e){return this.tableData.filter((t=>t.locations.split(";").map(Number).includes(parseInt(e))))},async init(){this.isLoading=!0;const e=await this.getAllMenuLocations();e.data&&(this.menuLocations=e.data);const t=await this.getAllMenus();t.data&&(this.tableData=t.data),t.failure&&this.$message.error(this.$t("anErrorOccured")),this.isLoading=!1},addItem(){this.currentEditItem=null,this.menu.name="",this.menu.locations=[],this.menuDialog=!0},editItem(e,t){this.currentEditItem=t,this.menu.name=t.name,this.menu.locations=t.locations?t.locations.split(";").map(Number):[],this.menuDialog=!0},deleteItem(e,t){this.$confirm(this.$t("deleteMenuQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteItemInDB({context:p.D,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;if("addForm"===e){const e=await this.addItemInDB({context:p.D,data:{name:this.menu.name,locations:this.menu.locations.join(";"),insert_by:this.userData.id}});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}else{const e={};if(this.currentEditItem.name!==this.menu.name&&(e["name"]=this.menu.name),this.currentEditItem.locations!==this.menu.locations&&(e["locations"]=this.menu.locations.join(";")),!this.$_.isEmpty(e)){const t=await this.updateItemInDB({context:p.D,id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.cancelForm(e),this.init()}))},cancelForm(e){this.$refs[e].resetFields(),this.menuDialog=!1},manageLocations(){this.menuLocationDialog=!0},async saveMenuLocation(){const e=await this.updateMenuLocations({locations:this.locations.filter((e=>!!e.menu)),insert_by:this.userData.id});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured")),this.menuLocationDialog=!1,this.init()},openMenuStructure(e,t){this.$router.push({name:"MenuStructure"+h.Z5.APPEARANCE.NAME,params:{menu:t.id}})}}},b=i(83744);const v=(0,b.Z)(w,[["render",d]]);var _=v},6979:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return x}});var n=i(82234);const o={class:"text-left"},s={class:"table-header-overflow"},r={class:"table-header-overflow"},a={key:0,style:{color:"#000"}},l={key:1},c={class:"table-header-overflow"},d={key:0,style:{color:"#000"}},h={key:1},u={key:0},m={style:{"text-align":"center","margin-top":"20px",display:"flex"}};function g(e,t,i,g,p,f){const w=(0,n.resolveComponent)("el-col"),b=(0,n.resolveComponent)("el-row"),v=(0,n.resolveComponent)("el-table-column"),_=(0,n.resolveComponent)("el-tooltip"),y=(0,n.resolveComponent)("el-option"),k=(0,n.resolveComponent)("el-select"),C=(0,n.resolveComponent)("el-tag"),x=(0,n.resolveComponent)("el-popover"),V=(0,n.resolveComponent)("el-input"),A=(0,n.resolveComponent)("el-button"),E=(0,n.resolveComponent)("el-table"),T=(0,n.resolveComponent)("el-pagination"),P=(0,n.resolveComponent)("el-card"),S=(0,n.resolveComponent)("el-image-viewer"),I=(0,n.resolveDirective)("loading");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(P,{shadow:"hover"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(b,{align:"middle"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{span:24},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",o,[(0,n.createElementVNode)("h3",null,(0,n.toDisplayString)(e.$t("sections")),1)])])),_:1})])),_:1})])),default:(0,n.withCtx)((()=>[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createBlock)(E,{data:f.pagedTableData,"empty-text":e.$t("noData"),border:"",stripe:"","header-cell-class-name":"el-table-header",style:{width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(v,{type:"index",index:f.indexMethod,width:"50",fixed:""},null,8,["index"]),(0,n.createVNode)(v,{sortable:"",label:e.$t("name"),width:"175",fixed:""},{default:(0,n.withCtx)((t=>[(0,n.createTextVNode)((0,n.toDisplayString)(t.row["name_"+e.$i18n.locale]),1)])),_:1},8,["label"]),e.devMode?((0,n.openBlock)(),(0,n.createBlock)(v,{key:0,label:e.$t("widgets"),width:"225"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(_,{content:e.$t("widgets"),placement:"top"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("small",s,(0,n.toDisplayString)(e.$t("widgets")),1)])),_:1},8,["content"])])),default:(0,n.withCtx)((i=>[p.currentEditItem&&p.currentEditItem.uid===i.row.uid?((0,n.openBlock)(),(0,n.createBlock)(b,{key:0,gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{span:24},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(k,{modelValue:p.currentEditItem.widgets,"onUpdate:modelValue":t[0]||(t[0]=e=>p.currentEditItem.widgets=e),style:{width:"100%"},size:"default",multiple:"",clearable:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(p.widgets,(t=>((0,n.openBlock)(),(0,n.createBlock)(y,{key:t.uid,label:t["name_"+e.$i18n.locale],value:t.uid},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1})])),_:1})):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[f.getWidgets(i.row.uid).length?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(f.getWidgets(i.row.uid),((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(C,{key:i,type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(t["name_"+e.$i18n.locale]),1)])),_:2},1024)))),128)):((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,type:"info",effect:"dark"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("none")),1)])),_:1}))],64))])),_:1},8,["label"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(v,{label:e.$t("linkedNewsCategories"),width:"225"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(_,{content:e.$t("linkedNewsCategories"),placement:"top"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("small",r,(0,n.toDisplayString)(e.$t("linkedNewsCategories")),1)])),_:1},8,["content"])])),default:(0,n.withCtx)((i=>[p.currentEditItem&&p.currentEditItem.uid===i.row.uid?((0,n.openBlock)(),(0,n.createBlock)(b,{key:0,gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{span:24},{default:(0,n.withCtx)((()=>[parseInt(i.row.news_categories)?((0,n.openBlock)(),(0,n.createBlock)(k,{key:0,modelValue:p.currentEditItem.newsCategories,"onUpdate:modelValue":t[1]||(t[1]=e=>p.currentEditItem.newsCategories=e),style:{width:"100%"},size:"default",multiple:"",clearable:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),"multiple-limit":i.row.news_categories},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(p.newsCategories,(t=>((0,n.openBlock)(),(0,n.createBlock)(y,{key:t.id,label:e.tr(t.name),value:t.id},{default:(0,n.withCtx)((()=>[t.isParent?((0,n.openBlock)(),(0,n.createElementBlock)("b",a,(0,n.toDisplayString)(e.tr(t.name)),1)):((0,n.openBlock)(),(0,n.createElementBlock)("span",l,(0,n.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","placeholder","no-data-text","no-match-text","multiple-limit"])):((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,type:"info",effect:"dark"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("notAllowed")),1)])),_:1}))])),_:2},1024)])),_:2},1024)):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[f.getNewsCategories(i.row.uid).length?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(f.getNewsCategories(i.row.uid),((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(C,{key:i,type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(t?.name)),1)])),_:2},1024)))),128)):((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,type:"info",effect:"dark"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("none")),1)])),_:1}))],64))])),_:1},8,["label"]),(0,n.createVNode)(v,{label:e.$t("linkedECommerceCategories"),width:"225"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(_,{content:e.$t("linkedECommerceCategories"),placement:"top"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("small",c,(0,n.toDisplayString)(e.$t("linkedECommerceCategories")),1)])),_:1},8,["content"])])),default:(0,n.withCtx)((i=>[p.currentEditItem&&p.currentEditItem.uid===i.row.uid?((0,n.openBlock)(),(0,n.createBlock)(b,{key:0,gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{span:24},{default:(0,n.withCtx)((()=>[parseInt(i.row.e_commerce_categories)?((0,n.openBlock)(),(0,n.createBlock)(k,{key:0,modelValue:p.currentEditItem.eCommerceCategories,"onUpdate:modelValue":t[2]||(t[2]=e=>p.currentEditItem.eCommerceCategories=e),style:{width:"100%"},size:"default",multiple:"",clearable:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),"multiple-limit":i.row.e_commerce_categories},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(p.eCommerceCategories,(t=>((0,n.openBlock)(),(0,n.createBlock)(y,{key:t.id,label:e.tr(t.name),value:t.id},{default:(0,n.withCtx)((()=>[t.isParent?((0,n.openBlock)(),(0,n.createElementBlock)("b",d,(0,n.toDisplayString)(e.tr(t.name)),1)):((0,n.openBlock)(),(0,n.createElementBlock)("span",h,(0,n.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["label","value"])))),128))])),_:2},1032,["modelValue","placeholder","no-data-text","no-match-text","multiple-limit"])):((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,type:"info",effect:"dark"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("notAllowed")),1)])),_:1}))])),_:2},1024)])),_:2},1024)):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[f.getECommerceCategories(i.row.uid).length?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(f.getECommerceCategories(i.row.uid),((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(C,{key:i,type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(t?.name)),1)])),_:2},1024)))),128)):((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,type:"info",effect:"dark"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("none")),1)])),_:1}))],64))])),_:1},8,["label"]),(0,n.createVNode)(v,{label:e.$t("pages"),width:"200"},{default:(0,n.withCtx)((t=>[f.getSectionPages(t.row.uid).length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[f.getSectionPages(t.row.uid).length>2?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(f.getSectionPages(t.row.uid),((i,o)=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:o},[0==o?((0,n.openBlock)(),(0,n.createBlock)(C,{key:0,type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(i?.title)),1)])),_:2},1024)):(0,n.createCommentVNode)("",!0),1==o?((0,n.openBlock)(),(0,n.createBlock)(x,{key:1,placement:"top-start",width:600,trigger:"hover"},{reference:(0,n.withCtx)((()=>[(0,n.createVNode)(C,{type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" + "+(0,n.toDisplayString)(f.getSectionPages(t.row.uid).length-1),1)])),_:2},1024)])),default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(f.getSectionPages(t.row.uid),((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(C,{key:i,type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(t?.title)),1)])),_:2},1024)))),128))])),_:2},1024)):(0,n.createCommentVNode)("",!0)],64)))),128)):((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:1},(0,n.renderList)(f.getSectionPages(t.row.uid),((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(C,{key:i,type:"danger",effect:"dark",class:"mr-5 mb-5"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(t?.title)),1)])),_:2},1024)))),128))],64)):((0,n.openBlock)(),(0,n.createBlock)(C,{key:1,type:"info",effect:"dark"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("none")),1)])),_:1}))])),_:1},8,["label"]),(0,n.createVNode)(v,{sortable:"",label:e.$t("lastEdition"),width:"200"},{default:(0,n.withCtx)((t=>[f.getLastUpdate(t.row.uid)?((0,n.openBlock)(),(0,n.createElementBlock)("span",u,(0,n.toDisplayString)(f.reformatDate(f.getLastUpdate(t.row.uid),{inPattern:"YYYY-MM-DD",outPattern:e.dateFormat,locale:e.$i18n.locale})),1)):(0,n.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,n.createVNode)(v,{align:"right",width:"175",fixed:"right"},{header:(0,n.withCtx)((()=>[(0,n.createVNode)(V,{modelValue:p.search,"onUpdate:modelValue":t[3]||(t[3]=e=>p.search=e),size:"small",placeholder:e.$t("search"),style:{width:"100%"}},null,8,["modelValue","placeholder"])])),default:(0,n.withCtx)((e=>[p.currentEditItem&&p.currentEditItem.uid===e.row.uid?((0,n.openBlock)(),(0,n.createBlock)(b,{key:0,gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{size:"small",icon:"close",type:"default",style:{width:"100%"},onClick:t[4]||(t[4]=e=>p.currentEditItem=null)})])),_:1}),(0,n.createVNode)(w,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{size:"small",icon:"check",type:"success",style:{width:"100%"},onClick:t=>f.submitEdit(e.$index,e.row)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)):((0,n.openBlock)(),(0,n.createBlock)(b,{key:1,gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{size:"small",icon:"edit",type:"warning",style:{width:"100%"},onClick:t=>f.editItem(e.$index,e.row)},null,8,["onClick"])])),_:2},1024),(0,n.createVNode)(w,{span:12},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A,{size:"small",icon:"view",type:"default",style:{width:"100%"},onClick:t=>f.showPreview(e.$index,e.row)},null,8,["onClick"])])),_:2},1024)])),_:2},1024))])),_:1})])),_:1},8,["data","empty-text"])),[[I,p.isLoading]]),(0,n.createElementVNode)("div",m,[(0,n.createVNode)(T,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":p.pageSize,total:p.total,onCurrentChange:f.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),p.showViewer?((0,n.openBlock)(),(0,n.createBlock)(S,{key:0,"hide-on-click-modal":"","url-list":[e.resolveSectionPreview(p.preview)],onClose:t[5]||(t[5]=e=>p.showViewer=!1)},null,8,["url-list"])):(0,n.createCommentVNode)("",!0)],64)}i(57658);var p=i(39355),f=i(31567),w=i(98761),b=i(38855),v=i(16950),_=i(21101),y={name:"Sections",mixins:[b.Z,f.Z,w.Z],data(){return{pages:[],widgets:[],sections:[],newsCategories:[],eCommerceCategories:[],preview:null,currentEditItem:null,showViewer:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name_fr.toLowerCase().includes(this.search.toLowerCase())||e.name_en.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},created(){this.$_.forIn(this.sectionsJSONData,((e,t)=>{this.tableData.push(e)})),this.$_.forIn(this.widgetsJSONData,((e,t)=>{this.widgets.push(e)})),this.init()},methods:{...(0,_.mapActions)("page",["getAllPages"]),...(0,_.mapActions)("section",["getAllSections"]),...(0,_.mapActions)({getNewsCategoriesByParent:"newsCategory/getCategoriesByParent"}),...(0,_.mapActions)({getECommerceCategoriesByParent:"eCommerceCategory/getCategoriesByParent"}),reformatDate:p.bK,setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},getSectionPages(e){const t=[];return this.pages.forEach((i=>{let n,o;try{n=JSON.parse(i.top_sections)}catch(s){n=[]}try{o=JSON.parse(i.bottom_sections)}catch(s){o=[]}(n.includes(e)||o.includes(e))&&t.push(i)})),t},getWidgets(e){const t=this.sections.find((t=>t.uid==e));if(t){let e;const n=[];try{e=JSON.parse(t.widgets)}catch(i){e=[]}return e.forEach((e=>{const t=this.widgets.find((t=>t.uid==e));n.push(t)})),n}return[]},getNewsCategories(e){const t=this.sections.find((t=>t.uid==e));if(t){let e;const n=[];try{e=JSON.parse(t.news_categories)}catch(i){e=[]}return e.forEach((e=>{const t=this.newsCategories.find((t=>t.id==e));n.push(t)})),n}return[]},getECommerceCategories(e){const t=this.sections.find((t=>t.uid==e));if(t){let e;const n=[];try{e=JSON.parse(t.e_commerce_categories)}catch(i){e=[]}return e.forEach((e=>{const t=this.eCommerceCategories.find((t=>t.id==e));n.push(t)})),n}return[]},getLastUpdate(e){const t=this.sections.find((t=>t.uid==e));return t?t.last_update:null},async init(){this.isLoading=!0;const e=await this.getAllPages();e.data&&(this.pages=e.data);const t=await this.getAllSections();t.data&&(this.sections=t.data),this.newsCategories=[];const i=await this.getNewsCategoriesByParent(0);if(i.success&&i.data){const e=i.data;for(let t=0;t<e.length;t++){const i=await this.getNewsCategoriesByParent(e[t].id);e[t].isParent=!0,this.newsCategories.push(e[t]),i.success&&i.data&&i.data.forEach((e=>{this.newsCategories.push(e)}))}}this.eCommerceCategories=[];const n=await this.getECommerceCategoriesByParent(0);if(n.success&&n.data){const e=n.data;for(let t=0;t<e.length;t++){const i=await this.getECommerceCategoriesByParent(e[t].id);e[t].isParent=!0,this.eCommerceCategories.push(e[t]),i.success&&i.data&&i.data.forEach((e=>{this.eCommerceCategories.push(e)}))}}this.isLoading=!1},showPreview(e,t){this.preview=t.sid,this.showViewer=!0},editItem(e,t){this.currentEditItem={uid:t.uid,widgets:this.getWidgets(t.uid).map((e=>e.uid)),newsCategories:this.getNewsCategories(t.uid).map((e=>e.id)),eCommerceCategories:this.getECommerceCategories(t.uid).map((e=>e.id))}},async submitEdit(e,t){let i;const n=this.sections.find((e=>e.uid==t.uid));i=n?await this.updateItemInDB({context:v.H,id:n.id,data:{widgets:JSON.stringify(this.currentEditItem.widgets),news_categories:JSON.stringify(this.currentEditItem.newsCategories),e_commerce_categories:JSON.stringify(this.currentEditItem.eCommerceCategories),last_update:(0,p.p6)(new Date,{outPattern:"YYYY-MM-DD",locale:this.$i18n.locale})}}):await this.addItemInDB({context:v.H,data:{uid:t.uid,widgets:JSON.stringify(this.currentEditItem.widgets),news_categories:JSON.stringify(this.currentEditItem.newsCategories),e_commerce_categories:JSON.stringify(this.currentEditItem.eCommerceCategories),last_update:(0,p.p6)(new Date,{outPattern:"YYYY-MM-DD",locale:this.$i18n.locale})}}),i.success?(this.currentEditItem=null,this.init()):this.$message.error(this.$t("anErrorOccured"))}}},k=i(83744);const C=(0,k.Z)(y,[["render",g]]);var x=C},81635:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return lt}});var n=i(97200),o=i(82234);function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-page-header"),c=(0,o.resolveComponent)("el-col"),d=(0,o.resolveComponent)("el-radio-button"),h=(0,o.resolveComponent)("el-radio-group"),u=(0,o.resolveComponent)("el-button"),m=(0,o.resolveComponent)("el-input"),g=(0,o.resolveComponent)("el-checkbox"),p=(0,o.resolveComponent)("el-row"),f=(0,o.resolveComponent)("el-tab-pane"),w=(0,o.resolveComponent)("el-tabs"),b=n.Z,v=(0,o.resolveComponent)("unique-widgets"),_=(0,o.resolveComponent)("duplicable-widgets");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(b,{"z-index":1e3,top:50,"class-name":"sticky-header",class:"mb-10",style:{height:"auto"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{gutter:5,class:"mb-5 mt-5",align:"middle"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{span:3,style:{"padding-bottom":"12px"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{title:e.$t("back"),onBack:t[0]||(t[0]=t=>e.$router.back())},null,8,["title"])])),_:1}),(0,o.createVNode)(c,{span:8,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{modelValue:r.currentTab,"onUpdate:modelValue":t[1]||(t[1]=e=>r.currentTab=e),size:"small"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{label:"u-w"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("uniqueWidgets")),1)])),_:1}),(0,o.createVNode)(d,{label:"r-w"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("duplicableWidgets")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.createVNode)(c,{span:6},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{modelValue:r.searchQuery,"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchQuery=e),size:"small",placeholder:e.$t("search")},{append:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{icon:"search",size:"small",style:{cursor:"auto"}})])),_:1},8,["modelValue","placeholder"])])),_:1}),(0,o.createVNode)(c,{span:4},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{modelValue:r.enableMultiselect,"onUpdate:modelValue":t[3]||(t[3]=e=>r.enableMultiselect=e),border:"",size:"small",class:"multiselectToggler",disabled:"r-w"!==r.currentTab||"r-w"===r.currentTab&&!r.currentSubTab},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("groupedSelection")),1)])),_:1},8,["modelValue","disabled"])])),_:1}),(0,o.createVNode)(c,{span:3},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{size:"small",type:"primary",style:{width:"100%"},icon:"document-add",disabled:"r-w"!==r.currentTab||"r-w"===r.currentTab&&!r.currentSubTab,onClick:t[4]||(t[4]=t=>e.addWidgetDialog=!0)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),"r-w"===r.currentTab&&a.duplicableWidgets.length?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,class:"mt-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{span:24},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{modelValue:r.currentSubTab,"onUpdate:modelValue":t[5]||(t[5]=e=>r.currentSubTab=e),type:"card",class:"sub-header"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.duplicableWidgets,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)(f,{key:i,label:t["name_"+e.$i18n.locale],name:t.wid},null,8,["label","name"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1}),"u-w"==r.currentTab?((0,o.openBlock)(),(0,o.createBlock)(v,{key:0,widgets:a.uniqueWidgets,"widgets-data":r.widgetsData,onRefreshData:t[6]||(t[6]=e=>a.init())},null,8,["widgets","widgets-data"])):(0,o.createCommentVNode)("",!0),"r-w"==r.currentTab?((0,o.openBlock)(),(0,o.createBlock)(_,{key:1,"enable-multiselect":r.enableMultiselect,"current-sub-tab":r.currentSubTab,widgets:a.duplicableWidgets,"widgets-data":r.widgetsData,"search-query":r.searchQuery,onRefreshData:t[7]||(t[7]=e=>a.init()),onCloseAddWidgetDialog:t[8]||(t[8]=t=>e.addWidgetDialog=!1)},null,8,["enable-multiselect","current-sub-tab","widgets","widgets-data","search-query"])):(0,o.createCommentVNode)("",!0)],64)}i(57658);var r=i(48527),a=i(31567),l=i(38855),c=i(2258),d=i(21101),h=i(31377),u=i(68716),m=i(12670);const g={key:0},p={key:0,class:"mb-5"},f={class:"card-header"},w={class:"text-center"},b={class:"img-preview-container"},v={class:"image-slot"},_={key:1},y={class:"card-header"},k={class:"text-center"},C={class:"vid-preview-container"},x={key:0,autoplay:"",controls:"",style:{height:"100%"}},V=["src"],A={key:1},E={class:"card-header"},T={class:"text-center"},P={key:1},S={class:"card-header"},I={class:"text-center"},N=["onClick"],B=["src"],R=["onClick"],D={key:1},M={class:"vid-preview",style:{width:"100%",height:"300px"}},O={key:0,autoplay:"",controls:"",style:{height:"100%"}},L=["src"],F={key:1},z={key:11,class:"inline-item"},$={key:12,class:"inline-item"};function Z(e,t,i,n,s,r){const a=(0,o.resolveComponent)("el-input"),l=m.Z,c=(0,o.resolveComponent)("el-input-number"),d=(0,o.resolveComponent)("Delete"),Z=(0,o.resolveComponent)("el-icon"),W=(0,o.resolveComponent)("Picture"),H=(0,o.resolveComponent)("el-image"),U=(0,o.resolveComponent)("el-card"),q=u.Z,G=(0,o.resolveComponent)("el-dialog"),j=(0,o.resolveComponent)("Film"),K=(0,o.resolveComponent)("el-button"),J=(0,o.resolveComponent)("el-col"),Y=(0,o.resolveComponent)("vue-draggable-next"),Q=(0,o.resolveComponent)("el-image-viewer"),X=(0,o.resolveComponent)("VideoPlay"),ee=(0,o.resolveComponent)("el-color-picker"),te=(0,o.resolveComponent)("el-date-picker"),ie=h.Z,ne=(0,o.resolveComponent)("el-checkbox"),oe=(0,o.resolveComponent)("el-select"),se=(0,o.resolveComponent)("Vue3IconPicker"),re=(0,o.resolveComponent)("el-option");return i.item?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[i.showLabel&&"image"!=i.item.type&&"video"!=i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(i.item["label_"+e.$i18n.locale]),1)])])):(0,o.createCommentVNode)("",!0),"text"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(a,{key:1,modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),style:{width:"100%"},placeholder:i.item["label_"+e.$i18n.locale]},null,8,["modelValue","placeholder"])):(0,o.createCommentVNode)("",!0),"text-multilingual"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(l,{key:2,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),synchro:!0,"selector-span":4,placeholder:i.item["label_"+e.$i18n.locale]},null,8,["modelValue","placeholder"])):(0,o.createCommentVNode)("",!0),"textarea"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(a,{key:3,modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value=e),type:"textarea",style:{width:"100%"},placeholder:i.item["label_"+e.$i18n.locale]},null,8,["modelValue","placeholder"])):(0,o.createCommentVNode)("",!0),"textarea-multilingual"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(l,{key:4,modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=e=>s.value=e),type:"textarea",synchro:!0,"selector-span":4,placeholder:i.item["label_"+e.$i18n.locale]},null,8,["modelValue","placeholder"])):(0,o.createCommentVNode)("",!0),"number"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(c,{key:5,modelValue:s.value,"onUpdate:modelValue":t[4]||(t[4]=e=>s.value=e),modelModifiers:{number:!0},style:{width:"100%"},"controls-position":"right",min:i.item.min?i.item.min:-1/0,max:i.item.max?i.item.max:1/0,step:i.item.step?i.item.step:1,placeholder:i.item["label_"+e.$i18n.locale]},null,8,["modelValue","min","max","step","placeholder"])):(0,o.createCommentVNode)("",!0),"image"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:6},[(0,o.createVNode)(U,{shadow:"never",class:"image-card mb-5"},{header:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",f,[(0,o.createElementVNode)("h4",null,(0,o.toDisplayString)(i.item["label_"+e.$i18n.locale]),1),s.value?((0,o.openBlock)(),(0,o.createBlock)(Z,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:t[5]||(t[5]=e=>s.value="")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d)])),_:1},8,["title"])):((0,o.openBlock)(),(0,o.createBlock)(Z,{key:1,title:e.$t("pickImage"),class:"picture-icon",onClick:t[6]||(t[6]=e=>s.imgPickerVisible=!0)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(W)])),_:1},8,["title"]))])])),default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("div",b,[(0,o.createElementVNode)("div",{class:"img-preview",style:{width:"100%","aspect-ratio":"16 / 9"},onClick:t[7]||(t[7]=e=>s.imgPickerVisible=!0)},[s.value?((0,o.openBlock)(),(0,o.createBlock)(H,{key:0,fit:"contain",style:{height:"100%",width:"100%"},src:e.resolveMediaLink(s.value)},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(Z,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(W)])),_:1})])])),_:1},8,["src"])):((0,o.openBlock)(),(0,o.createElementBlock)("span",_,(0,o.toDisplayString)(i.item["label_"+e.$i18n.locale]),1))])])])])),_:1}),(0,o.createVNode)(G,{modelValue:s.imgPickerVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>s.imgPickerVisible=e),title:i.item["label_"+e.$i18n.locale],"destroy-on-close":"",fullscreen:""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{"display-videos":!1,"display-audios":!1,"display-documents":!1,"display-other-types":!1,onSelected:r.onImageSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)):(0,o.createCommentVNode)("",!0),"video"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:7},[(0,o.createVNode)(U,{shadow:"never",class:"video-card mb-5"},{header:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",y,[(0,o.createElementVNode)("h4",null,(0,o.toDisplayString)(i.item["label_"+e.$i18n.locale]),1),s.value?((0,o.openBlock)(),(0,o.createBlock)(Z,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:t[9]||(t[9]=e=>s.value="")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d)])),_:1},8,["title"])):((0,o.openBlock)(),(0,o.createBlock)(Z,{key:1,title:e.$t("pickVideo"),class:"film-icon",onClick:t[10]||(t[10]=e=>s.vidPickerVisible=!0)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(j)])),_:1},8,["title"]))])])),default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",k,[(0,o.createElementVNode)("div",C,[(0,o.createElementVNode)("div",{class:"vid-preview",style:{width:"100%","aspect-ratio":"16 / 9"},onClick:t[11]||(t[11]=e=>s.vidPickerVisible=!0)},[s.value?((0,o.openBlock)(),(0,o.createElementBlock)("video",x,[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(s.value)},null,8,V)])):((0,o.openBlock)(),(0,o.createElementBlock)("span",A,(0,o.toDisplayString)(i.item["label_"+e.$i18n.locale]),1))])])])])),_:1}),(0,o.createVNode)(G,{modelValue:s.vidPickerVisible,"onUpdate:modelValue":t[12]||(t[12]=e=>s.vidPickerVisible=e),title:i.item["label_"+e.$i18n.locale],"destroy-on-close":"",fullscreen:""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{"display-videos":!0,"display-audios":!1,"display-images":!1,"display-documents":!1,"display-other-types":!1,onSelected:r.onVideoSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)):(0,o.createCommentVNode)("",!0),"file"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:8},[(0,o.withDirectives)((0,o.createVNode)(a,{modelValue:s.value,"onUpdate:modelValue":t[13]||(t[13]=e=>s.value=e),type:"hidden"},null,8,["modelValue"]),[[o.vShow,!1]]),(0,o.createVNode)(a,{modelValue:s.fileValue,"onUpdate:modelValue":t[16]||(t[16]=e=>s.fileValue=e),placeholder:i.item["label_"+e.$i18n.locale],readonly:""},(0,o.createSlots)({append:(0,o.withCtx)((()=>[(0,o.createVNode)(K,{icon:"document",onClick:t[15]||(t[15]=e=>s.filePickerVisible=!0)})])),_:2},[s.value?{name:"prepend",fn:(0,o.withCtx)((()=>[(0,o.createVNode)(K,{icon:"delete",onClick:t[14]||(t[14]=e=>{s.value="",s.fileValue=""})})])),key:"0"}:void 0]),1032,["modelValue","placeholder"]),(0,o.createVNode)(G,{modelValue:s.filePickerVisible,"onUpdate:modelValue":t[17]||(t[17]=e=>s.filePickerVisible=e),title:i.item["label_"+e.$i18n.locale],"destroy-on-close":"",fullscreen:""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{onSelected:r.onFileSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)):(0,o.createCommentVNode)("",!0),"image-gallery"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:9},[(0,o.createVNode)(U,{shadow:"hover",class:"previews-card mb-10"},{header:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",E,[(0,o.createElementVNode)("h5",null,(0,o.toDisplayString)(e.$t("images")),1),(0,o.createVNode)(K,{size:"default",type:"primary",onClick:t[18]||(t[18]=e=>s.imgGalleryPickerVisible=!0)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",T,[s.value&&s.value.length?((0,o.openBlock)(),(0,o.createBlock)(Y,{key:0,list:s.value,class:"el-row mr-5 ml-5"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.value,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)(J,{key:i,span:6,class:"preview-item mb-5 mt-5"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(H,{fit:"cover",class:"preview-item-img",src:e.resolveMediaLink(t),onClick:e=>r.openViewer(i)},null,8,["src","onClick"]),(0,o.createVNode)(K,{icon:"delete",class:"delete-btn",type:"danger",size:"default",circle:"",onClick:e=>r.removeImgGalleryItem(i)},null,8,["onClick"])])),_:2},1024)))),128))])),_:1},8,["list"])):((0,o.openBlock)(),(0,o.createElementBlock)("h5",P,(0,o.toDisplayString)(e.$t("noImageAdded")),1))])])),_:1}),s.showViewer?((0,o.openBlock)(),(0,o.createBlock)(Q,{key:0,"hide-on-click-modal":"","initial-index":s.currentViewerIndex,"url-list":s.value.map((t=>e.resolveMediaLink(t))),onClose:t[19]||(t[19]=e=>s.showViewer=!1)},null,8,["initial-index","url-list"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(G,{modelValue:s.imgGalleryPickerVisible,"onUpdate:modelValue":t[20]||(t[20]=e=>s.imgGalleryPickerVisible=e),title:e.$t("images"),"destroy-on-close":"",fullscreen:"",top:"1vh"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{multiple:!0,"display-videos":!1,"display-audios":!1,"display-documents":!1,"display-other-types":!1,"init-selected-medias":s.value,onSelected:r.onImgGallerySelected},null,8,["init-selected-medias","onSelected"])])),_:1},8,["modelValue","title"])],64)):(0,o.createCommentVNode)("",!0),"video-gallery"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:10},[(0,o.createVNode)(U,{shadow:"hover",class:"previews-card mb-10"},{header:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",S,[(0,o.createElementVNode)("h5",null,(0,o.toDisplayString)(e.$t("videos")),1),(0,o.createVNode)(K,{size:"default",type:"primary",onClick:t[21]||(t[21]=e=>s.vidGalleryPickerVisible=!0)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",I,[s.value&&s.value.length?((0,o.openBlock)(),(0,o.createBlock)(Y,{key:0,list:s.value,class:"el-row mr-5 ml-5"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.value,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)(J,{key:i,span:6,class:"preview-item mb-5 mt-5"},{default:(0,o.withCtx)((()=>[e.resolveMediaLink(t)?((0,o.openBlock)(),(0,o.createElementBlock)("video",{key:0,muted:"",style:{height:"100%"},class:"preview-item-vid",onClick:e=>r.openViewer(i)},[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(t)},null,8,B)],8,N)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",{class:"play-btn-container",onClick:e=>r.openViewer(i)},[(0,o.createVNode)(Z,{class:"play-btn"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(X)])),_:1})],8,R),(0,o.createVNode)(K,{icon:"delete",class:"delete-btn",type:"danger",size:"default",circle:"",onClick:e=>r.removeVidGalleryItem(i)},null,8,["onClick"])])),_:2},1024)))),128))])),_:1},8,["list"])):((0,o.openBlock)(),(0,o.createElementBlock)("h5",D,(0,o.toDisplayString)(e.$t("noVideoAdded")),1))])])),_:1}),(0,o.createVNode)(G,{modelValue:s.showViewer,"onUpdate:modelValue":t[22]||(t[22]=e=>s.showViewer=e),title:e.$t("preview"),"destroy-on-close":"",top:"5vh"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",M,[s.value[s.currentViewerIndex]?((0,o.openBlock)(),(0,o.createElementBlock)("video",O,[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(s.value[s.currentViewerIndex])},null,8,L)])):((0,o.openBlock)(),(0,o.createElementBlock)("span",F,(0,o.toDisplayString)(e.$t("noPreview")),1))])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(G,{modelValue:s.vidGalleryPickerVisible,"onUpdate:modelValue":t[23]||(t[23]=e=>s.vidGalleryPickerVisible=e),title:e.$t("videos"),"destroy-on-close":"",fullscreen:"",top:"1vh"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{multiple:!0,"display-videos":!0,"display-audios":!1,"display-images":!1,"display-documents":!1,"display-other-types":!1,onSelected:r.onVidGallerySelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)):(0,o.createCommentVNode)("",!0),"color"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)("div",z,[(0,o.createVNode)(ee,{modelValue:s.value,"onUpdate:modelValue":t[24]||(t[24]=e=>s.value=e),predefine:s.predefineColors,style:{width:"100%"}},null,8,["modelValue","predefine"])])):(0,o.createCommentVNode)("",!0),"date"==i.item.type?((0,o.openBlock)(),(0,o.createElementBlock)("div",$,[(0,o.createVNode)(te,{modelValue:s.value,"onUpdate:modelValue":t[25]||(t[25]=e=>s.value=e),"value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])):(0,o.createCommentVNode)("",!0),"html"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(ie,{key:13,modelValue:s.value,"onUpdate:modelValue":t[26]||(t[26]=e=>s.value=e),"should-not-group-when-full":!1,placeholder:i.item["label_"+e.$i18n.locale],"toolbar-items":s.contentEditorItems,class:"page-content-editor"},null,8,["modelValue","placeholder","toolbar-items"])):(0,o.createCommentVNode)("",!0),"html-multilingual"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(l,{key:14,modelValue:s.value,"onUpdate:modelValue":t[27]||(t[27]=e=>s.value=e),type:"editor",synchro:!0,"selector-span":4,placeholder:i.item["label_"+e.$i18n.locale],class:"page-content-editor"},null,8,["modelValue","placeholder"])):(0,o.createCommentVNode)("",!0),"checkbox"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(ne,{key:15,modelValue:s.value,"onUpdate:modelValue":t[28]||(t[28]=e=>s.value=e),label:i.item["label_"+e.$i18n.locale],style:{width:"100%"},border:""},null,8,["modelValue","label"])):(0,o.createCommentVNode)("",!0),"list"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:16,modelValue:s.value,"onUpdate:modelValue":t[29]||(t[29]=e=>s.value=e),style:{width:"100%"},multiple:"",filterable:"","allow-create":"","tag-type":"warning","default-first-option":"","suffix-icon":"setting","reserve-keyword":!1,placeholder:i.item["label_"+e.$i18n.locale],"no-data-text":e.$t("addAndClickOnEnter"),"no-match-text":e.$t("addAndClickOnEnter")},null,8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"slug"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(a,{key:17,modelValue:s.value,"onUpdate:modelValue":t[30]||(t[30]=e=>s.value=e),style:{width:"100%"},placeholder:i.item["label_"+e.$i18n.locale]},null,8,["modelValue","placeholder"])):(0,o.createCommentVNode)("",!0),"icon"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(se,{key:18,modelValue:s.value,"onUpdate:modelValue":t[31]||(t[31]=e=>s.value=e),"icon-library":s.presetValues,"selected-icon-bg-color":e.appPrimaryColor,"selected-icon-color":"white",clearable:"","empty-text":e.$t("nothingToShow"),placeholder:e.$t("selectIcon"),"search-placeholder":e.$t("search")},null,8,["modelValue","icon-library","selected-icon-bg-color","empty-text","placeholder","search-placeholder"])):(0,o.createCommentVNode)("",!0),"multipleicon"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(se,{key:19,modelValue:s.value,"onUpdate:modelValue":t[32]||(t[32]=e=>s.value=e),"icon-library":s.presetValues,"selected-icon-bg-color":e.appPrimaryColor,"selected-icon-color":"white",multiple:"","empty-text":e.$t("nothingToShow"),placeholder:e.$t("selectIcons"),"search-placeholder":e.$t("search")},null,8,["modelValue","icon-library","selected-icon-bg-color","empty-text","placeholder","search-placeholder"])):(0,o.createCommentVNode)("",!0),"select"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:20,modelValue:s.value,"onUpdate:modelValue":t[33]||(t[33]=e=>s.value=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.presetValues,(e=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"multiselect"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:21,modelValue:s.value,"onUpdate:modelValue":t[34]||(t[34]=e=>s.value=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.presetValues,(e=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"linkedwidget"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:22,modelValue:s.value,"onUpdate:modelValue":t[35]||(t[35]=e=>s.value=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.presetValues,(e=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"e-commerce-single-product"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:23,modelValue:s.value,"onUpdate:modelValue":t[36]||(t[36]=e=>s.value=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.products,(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"e-commerce-multiple-products"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:24,modelValue:s.value,"onUpdate:modelValue":t[37]||(t[37]=e=>s.value=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.products,(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"e-commerce-single-category"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:25,modelValue:s.value,"onUpdate:modelValue":t[38]||(t[38]=e=>s.value=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.eCommerceCategories.filter((e=>!parseInt(s.includeSubCategories)&&!parseInt(e.parent)||parseInt(s.includeSubCategories))),(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"e-commerce-multiple-categories"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:26,modelValue:s.value,"onUpdate:modelValue":t[39]||(t[39]=e=>s.value=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.eCommerceCategories.filter((e=>!parseInt(s.includeSubCategories)&&!parseInt(e.parent)||parseInt(s.includeSubCategories))),(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"news-single-article"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:27,modelValue:s.value,"onUpdate:modelValue":t[40]||(t[40]=e=>s.value=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.articles,(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.title)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"news-multiple-articles"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:28,modelValue:s.value,"onUpdate:modelValue":t[41]||(t[41]=e=>s.value=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.articles,(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.title)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"news-single-category"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:29,modelValue:s.value,"onUpdate:modelValue":t[42]||(t[42]=e=>s.value=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.newsCategories.filter((e=>!parseInt(s.includeSubCategories)&&!parseInt(e.parent)||parseInt(s.includeSubCategories))),(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0),"news-multiple-categories"==i.item.type?((0,o.openBlock)(),(0,o.createBlock)(oe,{key:30,modelValue:s.value,"onUpdate:modelValue":t[43]||(t[43]=e=>s.value=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.newsCategories.filter((e=>!parseInt(s.includeSubCategories)&&!parseInt(e.parent)||parseInt(s.includeSubCategories))),(t=>((0,o.openBlock)(),(0,o.createBlock)(re,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0)}var W=i(46962),H=i.n(W),U=i(21276),q={name:"FormItem",components:{VueDraggableNext:U.VueDraggableNext},props:{item:{type:Object,default:null},initialValue:{default:null},showLabel:{type:Boolean}},emits:["change"],data(){return{includeSubCategories:"1",presetValues:[],value:void 0,fileValue:null,articles:[],products:[],vidGalleryPickerVisible:!1,imgGalleryPickerVisible:!1,filePickerVisible:!1,vidPickerVisible:!1,imgPickerVisible:!1,currentViewerIndex:0,showViewer:!1,contentEditorItems:["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"],predefineColors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"]}},computed:{...(0,d.mapState)({newsCategories:e=>e.newsCategory.categories,eCommerceCategories:e=>e.eCommerceCategory.categories})},watch:{value:{handler(e,t){let i=null;switch(this.item.type){case"slug":this.value=H()(e,{trim:!0,lower:!0,strict:!0}),i=this.value;break;case"list":case"multiselect":case"multipleicon":case"video-gallery":case"image-gallery":case"news-multiple-articles":case"news-multiple-categories":case"e-commerce-multiple-products":case"e-commerce-multiple-categories":i=JSON.stringify(e&&e.length?e:[]);break;default:i=e;break}this.$emit("change",i,t,this.item.id)},deep:!0}},async created(){if(this.item)switch(this.item.type){case"number":this.value=this.initialValue?parseFloat(this.initialValue):void 0;break;case"file":this.fileValue=this.resolveMediaLink(this.initialValue),this.value=this.initialValue;break;case"list":{let t;try{t=JSON.parse(this.initialValue)}catch(e){t=[]}this.value=t.filter((e=>e))}break;case"slug":this.value=this.initialValue?this.initialValue:"";break;case"icon":try{this.presetValues=JSON.parse(this.item.option)}catch(e){this.presetValues=[]}console.log(this.presetValues),this.value=this.initialValue?this.initialValue:"";break;case"multipleicon":try{this.presetValues=JSON.parse(this.item.option)}catch(e){this.presetValues=[]}try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}break;case"select":try{this.presetValues=JSON.parse(this.item.option)}catch(e){this.presetValues=[]}this.value=this.initialValue?this.initialValue:"";break;case"multiselect":try{this.presetValues=JSON.parse(this.item.option)}catch(e){this.presetValues=[]}try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}break;case"linkedwidget":this.presetValues=[];try{const e=JSON.parse(this.item?.option),t=this.$store.state.widget.widgets;t.forEach((t=>{if(t.wid==e.wid){const i={id:t.id,label:""},n=JSON.parse(t.data);i.label=n[e.label],this.presetValues.push(i)}}))}catch(e){}this.value=this.initialValue?this.initialValue:"";break;case"text-multilingual":case"html-multilingual":case"textarea-multilingual":this.value=this.initialValue?this.initialValue:"";break;case"video-gallery":case"image-gallery":try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}break;case"e-commerce-single-product":{this.value=this.initialValue;const e=await this.getAllProducts();e.success&&e.data&&(this.products=e.data)}break;case"e-commerce-multiple-products":{try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}const t=await this.getAllProducts();t.success&&t.data&&(this.products=t.data)}break;case"e-commerce-single-category":this.value=this.initialValue,this.getAllECommerceCategories(),this.includeSubCategories=this.item?.option;break;case"e-commerce-multiple-categories":try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}this.getAllECommerceCategories(),this.includeSubCategories=this.item?.option;break;case"news-single-article":{this.value=this.initialValue;const e=await this.getAllArticles();e.success&&e.data&&(this.articles=e.data)}break;case"news-multiple-articles":{try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}const t=await this.getAllArticles();t.success&&t.data&&(this.articles=t.data)}break;case"news-single-category":this.value=this.initialValue,this.getAllNewsCategories(),this.includeSubCategories=this.item?.option;break;case"news-multiple-categories":try{this.value=JSON.parse(this.initialValue)}catch(e){this.value=[]}this.getAllNewsCategories(),this.includeSubCategories=this.item?.option;break;default:this.value=this.initialValue;break}},methods:{...(0,d.mapActions)("newsArticle",["getAllArticles"]),...(0,d.mapActions)("eCommerceProduct",["getAllProducts"]),...(0,d.mapActions)("newsCategory",{getAllNewsCategories:"getAllCategories"}),...(0,d.mapActions)("eCommerceCategory",{getAllECommerceCategories:"getAllCategories"}),onImageSelected(e){this.value=e,this.imgPickerVisible=!1},onVideoSelected(e){this.value=e,this.vidPickerVisible=!1},onFileSelected(e){this.value=e,this.fileValue=this.resolveMediaLink(e),this.filePickerVisible=!1},onImgGallerySelected(e){this.value&&this.$_.isArray(this.value)?e.forEach((e=>{this.value.includes(e)||this.value.push(e)})):this.value=e,this.imgGalleryPickerVisible=!1},removeImgGalleryItem(e){this.value.splice(e,1)},onVidGallerySelected(e){this.value&&this.$_.isArray(this.value)?e.forEach((e=>{this.value.includes(e)||this.value.push(e)})):this.value=e,this.vidGalleryPickerVisible=!1},removeVidGalleryItem(e){this.value.splice(e,1)},openViewer(e){this.currentViewerIndex=e,this.showViewer=!0}}},G=i(83744);const j=(0,G.Z)(q,[["render",Z],["__scopeId","data-v-0361be98"]]);var K=j;const J={key:0};function Y(e,t,i,n,s,r){const a=K,l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-row");return i.data&&e.$_.isArray(i.data)?((0,o.openBlock)(),(0,o.createElementBlock)("div",J,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.data,((t,n)=>((0,o.openBlock)(),(0,o.createBlock)(c,{key:n+"A",gutter:10},{default:(0,o.withCtx)((()=>[e.$_.isArray(t)?((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,{key:0},(0,o.renderList)(t,((e,n)=>((0,o.openBlock)(),(0,o.createBlock)(l,{key:n+"B",span:e.width?e.width:parseInt(24/t.length),class:"mb-10"},{default:(0,o.withCtx)((()=>[e&&e.id?((0,o.openBlock)(),(0,o.createBlock)(a,{key:0,item:e,"show-label":i.showLabels,"initial-value":i.formValue&&i.formValue[e.id]?i.formValue[e.id]:null,onChange:r.updateItemValue},null,8,["item","show-label","initial-value","onChange"])):(0,o.createCommentVNode)("",!0)])),_:2},1032,["span"])))),128)):((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createVNode)(l,{span:t.width?t.width:24,class:"mb-10"},{default:(0,o.withCtx)((()=>[t&&t.id?((0,o.openBlock)(),(0,o.createBlock)(a,{key:0,item:t,"show-label":i.showLabels,"initial-value":i.formValue&&i.formValue[t.id]?i.formValue[t.id]:null,onChange:r.updateItemValue},null,8,["item","show-label","initial-value","onChange"])):(0,o.createCommentVNode)("",!0)])),_:2},1032,["span"]),t.width&&parseInt(t.width)<24?((0,o.openBlock)(),(0,o.createBlock)(l,{key:0,span:24-parseInt(t.width)},null,8,["span"])):(0,o.createCommentVNode)("",!0)],64))])),_:2},1024)))),128))])):(0,o.createCommentVNode)("",!0)}var Q={name:"FormGenerator",components:{FormItem:K},props:{data:{type:Array,default:null},formValue:{type:Object,default:null},showLabels:{type:Boolean,default:!0}},emits:["change"],data(){return{result:{}}},watch:{result:{handler(e,t){this.$emit("change",e)},immediate:!0,deep:!0}},created(){this.data&&this.$_.isArray(this.data)&&this.data.forEach((e=>{this.$_.isArray(e)?e.forEach((e=>{this.result[e.id]=this.formValue&&this.formValue[e.id]?this.formValue[e.id]:null})):this.result[e.id]=this.formValue&&this.formValue[e.id]?this.formValue[e.id]:null}))},methods:{updateItemValue(e,t,i){this.result[i]=e}}};const X=(0,G.Z)(Q,[["render",Y]]);var ee=X;const te=(0,o.createElementVNode)("div",null,"Sticky Bottom",-1);function ie(e,t,i,n,s,r){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{style:(0,o.normalizeStyle)({height:s.height+"px",zIndex:i.zIndex})},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(i.className),style:(0,o.normalizeStyle)({bottom:s.isSticky?i.bottom+"px":"",zIndex:i.zIndex,position:s.position,width:s.width,height:s.height+"px"})},[(0,o.renderSlot)(e.$slots,"default",{},(()=>[te]))],6)],4)}var ne={name:"Sticky",props:{bottom:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize),this.handleScroll()},activated(){this.handleScroll()},unmounted(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset(){this.active&&this.reset()},reset(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll(){const e=this.$el.getBoundingClientRect().width;this.width=e||"auto";const t=this.$el.getBoundingClientRect().bottom;t>this.bottom?this.sticky():this.handleReset()},handleResize(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}};const oe=(0,G.Z)(ne,[["render",ie]]);var se=oe;const re={class:"image-slot"},ae={key:0,class:"widget-item-select"},le={class:"widget-item-status"},ce={key:0},de={style:{padding:"14px"}},he=["title"],ue={class:"widget-item-actions"},me={key:1,class:"text-center"},ge={key:0,style:{"line-height":"2.2"}},pe={key:1,style:{"line-height":"2.2"}},fe={class:"mb-5"},we={class:"mb-5"},be={class:"mb-10"},ve={class:"image-slot"},_e={class:"dialog-footer"},ye={class:"mb-5"},ke={class:"mb-5"},Ce={class:"mb-10"},xe={class:"image-slot"},Ve={class:"dialog-footer"};function Ae(e,t,i,n,s,r){const a=(0,o.resolveComponent)("Picture"),l=(0,o.resolveComponent)("el-icon"),c=(0,o.resolveComponent)("el-image"),d=(0,o.resolveComponent)("el-checkbox"),h=(0,o.resolveComponent)("el-tag"),u=(0,o.resolveComponent)("el-button"),m=(0,o.resolveComponent)("el-card"),g=(0,o.resolveComponent)("el-col"),p=(0,o.resolveComponent)("el-row"),f=se,w=ee,b=(0,o.resolveComponent)("el-radio-button"),v=(0,o.resolveComponent)("el-radio-group"),_=(0,o.resolveComponent)("el-dialog");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(m,{shadow:"never",class:"mt-10"},{default:(0,o.withCtx)((()=>[r.widgetsItems.length?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,gutter:10},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(r.widgetsItems,((t,n)=>((0,o.openBlock)(),(0,o.createBlock)(g,{key:n,span:6},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{class:"widget-item",shadow:"hover","body-style":{padding:"0px",border:"none"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{fit:"cover",class:"widget-item-preview",src:r.getWidgetPreview(t.data),"preview-src-list":r.getWidgetPreview(t.data)==s.WidgetPreview?[]:[r.getWidgetPreview(t.data)]},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",re,[(0,o.createVNode)(l,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a)])),_:1})])])),_:2},1032,["src","preview-src-list"]),i.enableMultiselect?((0,o.openBlock)(),(0,o.createElementBlock)("div",ae,[(0,o.createVNode)(d,{size:"default","model-value":s.selectedWidgets.findIndex((e=>e.id==t.id))>-1,onChange:e=>r.updateSelectedWidgets(t,n)},null,8,["model-value","onChange"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",le,[r.getWidgetData(t)?((0,o.openBlock)(),(0,o.createElementBlock)("div",ce,[parseInt(r.getWidgetData(t).display)?((0,o.openBlock)(),(0,o.createBlock)(h,{key:0,type:"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(h,{key:1,type:"danger"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}))])):((0,o.openBlock)(),(0,o.createBlock)(h,{key:1,type:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("noData")),1)])),_:1}))]),(0,o.createElementVNode)("div",de,[(0,o.createElementVNode)("div",{class:"widget-item-title",title:r.getWidgetTitle(t.data)},(0,o.toDisplayString)(r.getWidgetTitle(t.data)),9,he),(0,o.createElementVNode)("div",ue,[(0,o.createVNode)(u,{type:"text",size:"small",icon:"edit",onClick:e=>r.editItem(t,n)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("edit")),1)])),_:2},1032,["onClick"]),(0,o.createVNode)(u,{type:"text",size:"small",icon:"delete",onClick:e=>r.deleteItem(t,n)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("delete")),1)])),_:2},1032,["onClick"])])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):((0,o.openBlock)(),(0,o.createElementBlock)("div",me,(0,o.toDisplayString)(e.$t("noData")),1))])),_:1}),(0,o.createElementVNode)("div",{style:(0,o.normalizeStyle)(i.enableMultiselect&&r.widgetsItems.length?"height: 60px":"height: 0")},[(0,o.createVNode)(o.Transition,{class:"el-fade-in-linear"},{default:(0,o.withCtx)((()=>[i.enableMultiselect&&r.widgetsItems.length?((0,o.openBlock)(),(0,o.createBlock)(f,{key:0,"z-index":1e3,bottom:0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{shadow:"never",class:"multiselect-card"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{span:8,class:"text-left"},{default:(0,o.withCtx)((()=>[s.selectedWidgets.length?((0,o.openBlock)(),(0,o.createElementBlock)("small",ge,(0,o.toDisplayString)(e.$t("xSelectedItems",[s.selectedWidgets.length])),1)):((0,o.openBlock)(),(0,o.createElementBlock)("small",pe,(0,o.toDisplayString)(e.$t("noItemSelected")),1))])),_:1}),(0,o.createVNode)(g,{span:16,class:"text-right",style:{display:"flex","justify-content":"right","align-items":"center"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{border:"",size:"small",class:"mr-5",indeterminate:s.isSelectAllIndeterminate,"model-value":s.selectedWidgets.length==r.widgetsItems.length,label:e.$t("selectAll"),onChange:r.handleSelectAll},null,8,["indeterminate","model-value","label","onChange"]),(0,o.createVNode)(u,{size:"default",type:"danger",icon:"delete",disabled:!s.selectedWidgets.length,onClick:t[0]||(t[0]=e=>r.deleteMultipleItems())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("delete")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1})],4),(0,o.createVNode)(_,{modelValue:e.addWidgetDialog,"onUpdate:modelValue":t[4]||(t[4]=t=>e.addWidgetDialog=t),top:"2vh",width:"60%","append-to-body":"","destroy-on-close":"",title:e.$t("addWidget"),"close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:r.currentWidget&&r.currentWidget.fullscreen,onClose:t[5]||(t[5]=t=>e.$emit("closeAddWidgetDialog",!0))},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",_e,[(0,o.createVNode)(u,{onClick:t[2]||(t[2]=t=>e.$emit("closeAddWidgetDialog",!0))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(u,{type:"primary",onClick:t[3]||(t[3]=e=>r.submitAddData())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{gutter:25},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{span:14},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{data:r.currentWidget?r.currentWidget.data:null,onChange:r.changeAddWidgetData},null,8,["data","onChange"])])),_:1}),(0,o.createVNode)(g,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",fe,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("widgetStatus")),1)])]),(0,o.createVNode)(v,{modelValue:s.addWidget.display,"onUpdate:modelValue":t[1]||(t[1]=e=>s.addWidget.display=e),class:"mb-10 widget-display",style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(b,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"]),r.currentWidget?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",we,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("preview")),1)])]),(0,o.createElementVNode)("div",be,[(0,o.createVNode)(c,{class:"widget-preview",src:e.resolveWidgetPreview(r.currentWidget.wid),fit:"fill"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",ve,[(0,o.createVNode)(l,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a)])),_:1})])])),_:1},8,["src"])])],64)):(0,o.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","title","fullscreen"]),(0,o.createVNode)(_,{modelValue:s.editWidgetDialog,"onUpdate:modelValue":t[9]||(t[9]=e=>s.editWidgetDialog=e),top:"2vh",width:"60%","destroy-on-close":"",title:e.$t("editWidget"),"close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:r.currentWidget&&r.currentWidget.fullscreen},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",Ve,[(0,o.createVNode)(u,{onClick:t[7]||(t[7]=e=>s.editWidgetDialog=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(u,{type:"primary",onClick:t[8]||(t[8]=e=>r.submitEditData())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{gutter:25},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{span:14},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{data:r.currentWidget?r.currentWidget.data:null,"form-value":s.currentEditWidgetData?JSON.parse(s.currentEditWidgetData.data):null,onChange:r.changeEditWidgetData},null,8,["data","form-value","onChange"])])),_:1}),(0,o.createVNode)(g,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",ye,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("widgetStatus")),1)])]),(0,o.createVNode)(v,{modelValue:s.editWidget.display,"onUpdate:modelValue":t[6]||(t[6]=e=>s.editWidget.display=e),class:"mb-10 widget-display",style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(b,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"]),r.currentWidget?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",ke,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("preview")),1)])]),(0,o.createElementVNode)("div",Ce,[(0,o.createVNode)(c,{class:"widget-preview",src:e.resolveWidgetPreview(r.currentWidget.wid),fit:"fill"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",xe,[(0,o.createVNode)(l,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a)])),_:1})])])),_:1},8,["src"])])],64)):(0,o.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","title","fullscreen"])],64)}var Ee=i.p+"assets/img/duplicate-widget.fb19400c.svg",Te=i(14340),Pe=i(92829),Se=i(24044);const Ie={name:"DuplicableWidgets",props:{widgets:{type:Array,default:()=>[]},widgetsData:{type:Array,default:()=>[]},currentSubTab:{type:String,default:null},enableMultiselect:{type:Boolean,default:!1},searchQuery:{type:String,default:null}},emits:["refreshData","closeAddWidgetDialog"],data(){return{WidgetPreview:Ee,addWidget:null,editWidget:{result:null,display:0},selectAll:!1,selectedWidgets:[],editWidgetDialog:!1,currentEditWidgetData:null,isSelectAllIndeterminate:!1,imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"]}},computed:{...(0,c.mapWritableState)(r.d,["addWidgetDialog"]),widgetsItems(){return this.widgetsData.filter((e=>e.wid==this.currentSubTab&&!this.searchQuery))},currentWidget(){return this.widgets.find((e=>e.wid==this.currentSubTab))},widgetItemBgColor(){return this.pickByTheme("whitesmoke","black")}},watch:{addWidgetDialog:{handler(e,t){this.addWidget={result:null,display:0}},immediate:!0},enableMultiselect:{handler(e,t){this.selectedWidgets=[]}},currentSubTab:{handler(e,t){this.selectedWidgets=[]}},searchQuery:{handler(e,t){this.selectedWidgets=[]}}},methods:{...(0,d.mapActions)({addReplicableWidget:"widget/addReplicableWidget"}),getWidgetData(e){return this.widgetsData.find((t=>t.id==e.id))},changeAddWidgetData(e){this.addWidget.result=e},changeEditWidgetData(e){this.editWidget.result=e},getWidgetTitle(e){const t=JSON.parse(e);if(t){if(t.title)return this.tr(t.title);if(t.label)return this.tr(t.label);if(t.name)return this.tr(t.name);const e=[];if(this.$_.forIn(t,((t,i)=>{t&&e.push(this.tr(t))})),e.length&&e[0]){const t=e[0].toString();return t.split(".").pop()&&t.startsWith("root/")?(0,Pe.v$)(t)?.split(".")[0]:t}}return this.$t("widget")},getWidgetPreview(e){const t=JSON.parse(e);let i=null;return this.$_.forIn(t,((e,t)=>{if(e){const t=this.tr(e.toString()),n=t.split(".").pop();n&&this.imgExtList.includes(n.toUpperCase())&&t.startsWith("root/")&&(i||(i=t))}})),i?this.resolveMediaLink(i):Ee},deleteItem(e,t){this.$confirm(this.$t("deleteWidgetQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const t=await this.deleteItemInDB({context:Se.X,id:e.id});t.success?(this.$message.success(this.$t("success")),this.$emit("refreshData"),this.selectedWidgets=[]):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},editItem(e,t){this.currentEditWidgetData=e,this.editWidget.display=parseInt(e.display),this.editWidgetDialog=!0},async submitEditData(){if(this.editWidget.result&&this.currentEditWidgetData&&this.currentWidget&&this.currentWidget.data){const e={};this.currentWidget.data.forEach((t=>{this.$_.isArray(t)?t.forEach((t=>{e[t.id]=t.required})):e[t.id]=t.required}));let t=!0;if(this.$_.forIn(this.editWidget.result,(function(i,n){e[n]&&!i&&(t=!1)})),t){const e=await this.updateItemInDB({context:Se.X,id:this.currentEditWidgetData.id,data:{data:JSON.stringify(this.editWidget.result),display:this.editWidget.display}});e.success&&e.data?(this.editWidgetDialog=!1,this.$emit("refreshData"),this.$message.success(this.$t("success"))):this.$message.error(this.$t("anErrorOccured"))}else this.$message.warning(this.$t("missingData"))}},async submitAddData(){if(this.addWidget.result&&this.currentWidget&&this.currentWidget.data){const e={};this.currentWidget.data.forEach((t=>{this.$_.isArray(t)?t.forEach((t=>{e[t.id]=t.required})):e[t.id]=t.required}));let t=!0;if(this.$_.forIn(this.addWidget.result,(function(i,n){e[n]&&!i&&(t=!1)})),t){const e=await this.addReplicableWidget({uid:this.currentWidget.uid,wid:this.currentWidget.wid,title:"",description:"",data:JSON.stringify(this.addWidget.result),type:Te.y8.REPLICABLE,display:this.addWidget.display});e.success&&e.data?(this.$emit("closeAddWidgetDialog",!0),this.$emit("refreshData"),this.$message.success(this.$t("success"))):this.$message.error(this.$t("anErrorOccured"))}else this.$message.warning(this.$t("missingData"))}},deleteMultipleItems(){this.$confirm(1===this.selectedWidgets.length?this.$t("deleteWidgetQuestion"):this.$t("deleteMultipleItems",[this.selectedWidgets.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.selectedWidgets.length;t++)await this.deleteItemInDB({context:Se.X,id:this.selectedWidgets[t].id});e.close(),this.$message.success(this.$t("success")),this.$emit("refreshData"),this.selectedWidgets=[]})).catch((()=>{}))},updateSelectedWidgets(e,t){const i=this.selectedWidgets.findIndex((t=>t.id===e.id));i>-1?(this.selectedWidgets.length==this.widgetsItems.length&&(this.isSelectAllIndeterminate=!0),this.selectedWidgets.splice(i,1)):this.selectedWidgets.push(e)},handleSelectAll(){this.widgetsItems.length>this.selectedWidgets.length?this.selectedWidgets=this.$_.cloneDeep(this.widgetsItems):this.selectedWidgets=[],this.isSelectAllIndeterminate=!1}}},Ne=()=>{(0,o.useCssVars)((e=>({"92bbbce0":e.widgetItemBgColor})))},Be=Ie.setup;Ie.setup=Be?(e,t)=>(Ne(),Be(e,t)):Ne;var Re=Ie;const De=(0,G.Z)(Re,[["render",Ae],["__scopeId","data-v-e8fa3ede"]]);var Me=De;const Oe={class:"image-slot"},Le={class:"widget-item-status"},Fe={key:0},ze={style:{padding:"14px"}},$e=["title"],Ze={class:"widget-item-actions"},We={key:1,class:"text-center"},He={class:"mb-5"},Ue={class:"mb-5"},qe={class:"mb-10"},Ge={class:"image-slot"},je={class:"dialog-footer"};function Ke(e,t,i,n,s,r){const a=(0,o.resolveComponent)("Picture"),l=(0,o.resolveComponent)("el-icon"),c=(0,o.resolveComponent)("el-image"),d=(0,o.resolveComponent)("el-tag"),h=(0,o.resolveComponent)("el-button"),u=(0,o.resolveComponent)("el-card"),m=(0,o.resolveComponent)("el-col"),g=(0,o.resolveComponent)("el-row"),p=ee,f=(0,o.resolveComponent)("el-radio-button"),w=(0,o.resolveComponent)("el-radio-group"),b=(0,o.resolveComponent)("el-dialog");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(u,{shadow:"never",class:"mt-10"},{default:(0,o.withCtx)((()=>[i.widgets.length?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0,gutter:10},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.widgets,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)(m,{key:i,span:6},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{class:"widget-item",shadow:"hover","body-style":{padding:"0px",border:"none"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{fit:"cover",class:"widget-item-preview",src:r.getWidgetPreview(t),"preview-src-list":r.getWidgetPreview(t)==s.WidgetPreview?[]:[r.getWidgetPreview(t)]},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",Oe,[(0,o.createVNode)(l,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a)])),_:1})])])),_:2},1032,["src","preview-src-list"]),(0,o.createElementVNode)("div",Le,[r.getWidgetData(t)?((0,o.openBlock)(),(0,o.createElementBlock)("div",Fe,[parseInt(r.getWidgetData(t).display)?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,type:"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(d,{key:1,type:"danger"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}))])):((0,o.openBlock)(),(0,o.createBlock)(d,{key:1,type:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("noData")),1)])),_:1}))]),(0,o.createElementVNode)("div",ze,[(0,o.createElementVNode)("div",{class:"widget-item-title",title:t["name_"+e.$i18n.locale]},(0,o.toDisplayString)(t["name_"+e.$i18n.locale]),9,$e),(0,o.createElementVNode)("div",Ze,[(0,o.createVNode)(h,{type:"text",size:"small",icon:"edit",onClick:e=>r.editWidgetData(t,i)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("editData")),1)])),_:2},1032,["onClick"])])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):((0,o.openBlock)(),(0,o.createElementBlock)("div",We,(0,o.toDisplayString)(e.$t("noData")),1))])),_:1}),(0,o.createVNode)(b,{modelValue:s.editWidgetDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>s.editWidgetDialog=e),top:"2vh",width:"60%","append-to-body":"","destroy-on-close":"",title:e.$t("editData"),"close-on-click-modal":!1,"close-on-press-escape":!1,fullscreen:s.currentWidget&&s.currentWidget.fullscreen},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",je,[(0,o.createVNode)(h,{onClick:t[1]||(t[1]=e=>s.editWidgetDialog=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(h,{type:"primary",onClick:t[2]||(t[2]=e=>r.submitData())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{gutter:25},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{span:14},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{data:s.currentWidget?s.currentWidget.data:null,"form-value":r.getFormValue,onChange:r.changeWidgetData},null,8,["data","form-value","onChange"])])),_:1}),(0,o.createVNode)(m,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",He,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("widgetStatus")),1)])]),(0,o.createVNode)(w,{modelValue:s.display,"onUpdate:modelValue":t[0]||(t[0]=e=>s.display=e),class:"mb-10 widget-display",style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{label:0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,o.createVNode)(f,{label:1},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"]),s.currentWidget?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",Ue,[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.$t("preview")),1)])]),(0,o.createElementVNode)("div",qe,[(0,o.createVNode)(c,{class:"widget-preview",src:e.resolveWidgetPreview(s.currentWidget.wid),fit:"fill"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",Ge,[(0,o.createVNode)(l,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a)])),_:1})])])),_:1},8,["src"])])],64)):(0,o.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","title","fullscreen"])],64)}var Je=i.p+"assets/img/unique-widget.cdf1ea95.svg";const Ye={name:"UniqueWidgets",props:{widgets:{type:Array,default:()=>[]},widgetsData:{type:Array,default:()=>[]}},emits:["refreshData"],data(){return{WidgetPreview:Je,display:0,currentWidget:null,currentResult:null,editWidgetDialog:!1,imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"]}},computed:{getFormValue(){if(this.currentWidget){const e=this.widgetsData.find((e=>e.wid==this.currentWidget.wid));return e?JSON.parse(e.data):null}return null},widgetItemBgColor(){return this.pickByTheme("whitesmoke","black")}},methods:{...(0,d.mapActions)({addUniqueWidget:"widget/addUniqueWidget"}),getWidgetData(e){return this.widgetsData.find((t=>t.wid==e.wid))},editWidgetData(e,t){this.currentWidget=e;const i=this.getWidgetData(e);this.display=i?parseInt(i.display):0,this.editWidgetDialog=!0},changeWidgetData(e){this.currentResult=e},getWidgetPreview(e){const t=this.getWidgetData(e);let i=null;if(t){const e=JSON.parse(t["data"]);e&&this.$_.forIn(e,((e,t)=>{if(e){const t=e.toString(),n=t.split(".").pop();n&&this.imgExtList.includes(n.toUpperCase())&&t.startsWith("root/")&&(i||(i=t))}}))}return i?this.resolveMediaLink(i):Je},async submitData(){if(this.currentResult&&this.currentWidget){const e={};this.currentWidget.data.forEach((t=>{this.$_.isArray(t)?t.forEach((t=>{e[t.id]=t.required})):e[t.id]=t.required}));let t=!0;if(this.$_.forIn(this.currentResult,(function(i,n){e[n]&&!i&&(t=!1)})),t){const e=await this.addUniqueWidget({uid:this.currentWidget.uid,wid:this.currentWidget.wid,title:"",description:"",data:JSON.stringify(this.currentResult),type:Te.y8.UNIQUE,display:this.display});e.success&&e.data?(this.editWidgetDialog=!1,this.$emit("refreshData",!0),this.$message.success(this.$t("success"))):this.$message.error(this.$t("anErrorOccured"))}else this.$message.warning(this.$t("missingData"))}}}},Qe=()=>{(0,o.useCssVars)((e=>({"06418eac":e.widgetItemBgColor})))},Xe=Ye.setup;Ye.setup=Xe?(e,t)=>(Qe(),Xe(e,t)):Qe;var et=Ye;const tt=(0,G.Z)(et,[["render",Ke],["__scopeId","data-v-04668614"]]);var it=tt;const nt={name:"Widgets",components:{UniqueWidgets:it,DuplicableWidgets:Me},mixins:[l.Z,a.Z],data(){return{widgets:[],widgetsData:[],searchQuery:"",currentTab:"u-w",currentSubTab:null,enableMultiselect:!1}},computed:{...(0,c.mapWritableState)(r.d,["widgetsTab","addWidgetDialog"]),uniqueWidgets(){return this.searchQuery?this.widgets.filter((e=>!e.duplicable&&e["name_"+this.$i18n.locale].toLowerCase().includes(this.searchQuery.toLowerCase()))):this.widgets.filter((e=>!e.duplicable))},duplicableWidgets(){return this.searchQuery?this.widgets.filter((e=>e.duplicable&&e["name_"+this.$i18n.locale].toLowerCase().includes(this.searchQuery.toLowerCase()))):this.widgets.filter((e=>e.duplicable))},stickyBgColor(){return this.pickByTheme("white","black")}},watch:{currentTab:{handler(e,t){this.widgetsTab=e}}},created(){this.currentTab=this.widgetsTab,this.addWidgetDialog=!1,this.$_.forIn(this.widgetsJSONData,((e,t)=>{this.widgets.push(e)})),this.duplicableWidgets.length&&(this.currentSubTab=this.duplicableWidgets[0].wid),this.init()},methods:{...(0,d.mapActions)({getAllWidgets:"widget/getAllWidgets"}),async init(){const e=await this.getAllWidgets();e.data&&(this.widgetsData=e.data)}}},ot=()=>{(0,o.useCssVars)((e=>({"0af6fe22":e.stickyBgColor})))},st=nt.setup;nt.setup=st?(e,t)=>(ot(),st(e,t)):ot;var rt=nt;const at=(0,G.Z)(rt,[["render",s],["__scopeId","data-v-c33baee2"]]);var lt=at},31567:function(e,t,i){"use strict";var n=i(14340),o=i(21101);t["Z"]={created(){const e=-1===this.restrictedScopes.findIndex((e=>this.$route.name.includes(e.value)));e||this.$router.replace(n.Z5.LOGIN.PATH)},computed:{...(0,o.mapState)({userData:e=>e.session.userData,accessList:e=>e.access.accessList}),...(0,o.mapGetters)({userScopes:"access/getUserScopes",restrictedScopes:"access/getUserRestrictedScopes",disabledModuleScopes:"access/getDisabledModuleScopes",userPageScopes:"access/getUserPageScopes",userActionScopes:"access/getUserActionScopes",userSectionScopes:"access/getUserSectionScopes",userPageScope:"access/getUserPageScope",userActionScope:"access/getUserActionScope",userSectionScope:"access/getUserSectionScope"})},methods:{...(0,o.mapActions)("access",["getAllAccess"]),getAccessName(e){const t=this.accessList.find((t=>t.id==e));return t?t.name:""}}}},38855:function(e,t,i){"use strict";i(57658);var n=i(39355),o=i(14340),s=i(20747),r=i(21101);t["Z"]={data(){return{Routes:o.Z5,Currencies:o.Kt,WebsiteInfo:o.a,currencies:[]}},async created(){this.$_.forIn(o.Kt,((e,t)=>{this.currencies.push(e)})),this.$store.commit("global/updateCurrentPanelPath",this.$route.path,{root:!0});const e=await this.getItemFromDB({context:s.A,id:this.userData?.id});e.success&&e.data&&e.data.status==o.dp.DISABLED&&(this.destroySession(),this.$router.replace(o.Z5.LOGIN.PATH))},computed:{...(0,r.mapState)({userData:e=>e.session.userData}),...(0,r.mapGetters)({isUserConnected:"session/isUserConnected",getSettingValue:"setting/getSettingValue"})},methods:{formatDate:n.p6,reformatDate:n.bK,...(0,r.mapMutations)({destroySession:"session/destroySession"})}}}}]);
//# sourceMappingURL=group-appearance.d814d4c3.js.map