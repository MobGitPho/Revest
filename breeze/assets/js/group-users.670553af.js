"use strict";(self["webpackChunkbreeze"]=self["webpackChunkbreeze"]||[]).push([[773],{89772:function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var a=s(82234);const i={class:"text-left"},o={style:{"text-align":"center","margin-top":"20px",display:"flex"}},r={style:{float:"left"}},l={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"12px"}},c={class:"dialog-footer"};function n(e,t,s,n,d,u){const h=(0,a.resolveComponent)("el-col"),m=(0,a.resolveComponent)("el-button"),p=(0,a.resolveComponent)("el-row"),g=(0,a.resolveComponent)("el-table-column"),w=(0,a.resolveComponent)("el-input"),f=(0,a.resolveComponent)("el-table"),C=(0,a.resolveComponent)("el-pagination"),$=(0,a.resolveComponent)("el-card"),x=(0,a.resolveComponent)("el-form-item"),V=(0,a.resolveComponent)("el-option"),N=(0,a.resolveComponent)("el-select"),b=(0,a.resolveComponent)("el-form"),y=(0,a.resolveComponent)("el-dialog"),v=(0,a.resolveDirective)("loading");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createVNode)($,{shadow:"hover"},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{align:"middle"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(h,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(e.$t("accessManagement")),1)])])),_:1}),(0,a.createVNode)(h,{span:12,class:"text-right"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{size:"default",type:"primary",icon:"plus",onClick:t[0]||(t[0]=e=>u.addItem())},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("add")),1)])),_:1})])),_:1})])),_:1})])),default:(0,a.withCtx)((()=>[(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(f,{data:u.pagedTableData,"empty-text":e.$t("noData"),border:"",stripe:"",style:{width:"100%"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{type:"index",index:u.indexMethod},null,8,["index"]),(0,a.createVNode)(g,{sortable:"",label:e.$t("name"),prop:"name"},null,8,["label"]),(0,a.createVNode)(g,{label:e.$t("scopes"),prop:"scopes"},{default:(0,a.withCtx)((e=>[(0,a.createTextVNode)((0,a.toDisplayString)(u.showAccessScopes(e.row.scopes)),1)])),_:1},8,["label"]),(0,a.createVNode)(g,{label:e.$t("users")},{default:(0,a.withCtx)((e=>[(0,a.createTextVNode)((0,a.toDisplayString)(u.showAccessUsers(e.row.id)),1)])),_:1},8,["label"]),(0,a.createVNode)(g,{align:"right",width:"250"},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(w,{modelValue:d.search,"onUpdate:modelValue":t[1]||(t[1]=e=>d.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,a.withCtx)((t=>[(0,a.createVNode)(p,{gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(h,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{size:"small",type:"warning",icon:"edit",onClick:e=>u.editItem(t.$index,t.row)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("edit")),1)])),_:2},1032,["onClick"])])),_:2},1024),(0,a.createVNode)(h,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(m,{size:"small",type:"danger",icon:"delete",onClick:e=>u.deleteItem(t.$index,t.row)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("delete")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:1})])),_:1},8,["data","empty-text"])),[[v,d.isLoading]]),(0,a.createElementVNode)("div",o,[(0,a.createVNode)(C,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":d.pageSize,total:d.total,onCurrentChange:u.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,a.createVNode)(y,{modelValue:d.accessDialog,"onUpdate:modelValue":t[6]||(t[6]=e=>d.accessDialog=e),title:d.currentEditItem?e.$t("editAccess"):e.$t("addAccess"),width:"35%"},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",c,[(0,a.createVNode)(m,{onClick:t[4]||(t[4]=e=>u.cancelForm(d.currentEditItem?"editForm":"addForm"))},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,a.createVNode)(m,{type:"primary",onClick:t[5]||(t[5]=e=>u.submitForm(d.currentEditItem?"editForm":"addForm"))},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(b,{ref:d.currentEditItem?"editForm":"addForm",model:d.access,rules:d.rules,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{prop:"name",label:e.$t("accessName")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(w,{modelValue:d.access.name,"onUpdate:modelValue":t[2]||(t[2]=e=>d.access.name=e),placeholder:e.$t("accessName")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,a.createVNode)(x,{prop:"scopes",label:e.$t("scopes")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(N,{modelValue:d.access.scopes,"onUpdate:modelValue":t[3]||(t[3]=e=>d.access.scopes=e),multiple:"",filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(d.appScopes,(e=>((0,a.openBlock)(),(0,a.createBlock)(V,{key:e.value,value:e.value,label:e.label},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",r,(0,a.toDisplayString)(e.label),1),(0,a.createElementVNode)("span",l,(0,a.toDisplayString)(u.getAppScopeType(e)),1)])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}s(57658);var d=s(14340),u=s(31567),h=s(38855),m=s(52885),p=s(21101),g={name:"AccessManagement",mixins:[h.Z,u.Z],data(){return{Routes:d.Z5,users:[],appScopes:[],access:{name:"",scopes:[]},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],scopes:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},currentEditItem:null,accessDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{...(0,p.mapGetters)({disabledModuleScopes:"access/getDisabledModuleScopes"}),pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},created(){this.init(),this.$_.forIn(d.C8,((e,t)=>{e.display&&-1===this.disabledModuleScopes.findIndex((t=>t.value==e.value))&&this.appScopes.push(e)}))},methods:{...(0,p.mapActions)({getAllUsers:"user/getAllUsers",getAllAccess:"access/getAllAccess",getUserByCredentials:"authentication/getUserByCredentials"}),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},showAccessScopes(e){if(e){let t="";const s=e.split(";");for(let e=0;e<s.length;e++){const a=this.appScopes.find((t=>t.value==s[e]));a&&(t+=a.label,e+1<s.length&&(t+=" / "))}return t}return""},showAccessUsers(e){if(e){let t="";const s=this.users.filter((t=>t.access==e));for(let e=0;e<s.length;e++)t+=s[e].name,e+1<s.length&&(t+=" / ");return t}return""},getAppScopeType(e){return e.section?this.$t("section"):e.action?this.$t("action"):e.module?this.$t("module"):e.page?this.$t("pages"):void 0},async init(){this.isLoading=!0;const e=await this.getAllUsers();e.data&&(this.users=e.data);const t=await this.getAllAccess();t.data&&(this.tableData=t.data),this.isLoading=!1},addItem(){this.currentEditItem=null,this.access.name="",this.access.scopes=[],this.accessDialog=!0},async editItem(e,t){this.currentEditItem=t,this.access.name=t.name,this.access.scopes=t.scopes?t.scopes.split(";"):[],this.accessDialog=!0},deleteItem(e,t){this.$prompt(this.$t("deleteAccessWarning"),this.$t("deleteAccess"),{inputPlaceholder:this.$t("confirmWithPassword"),confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),inputType:"password"}).then((async({value:e})=>{if(e){const s=await this.getUserByCredentials({username:this.userData.uid,password:e});if(s.success)if(s.data.username&&s.data.password&&s.data.user){const e=await this.deleteItemInDB({context:m.X,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))}else this.$message.error(this.$t("wrongPassword"));else this.$message.error(this.$t("anErrorOccured"))}})).catch((()=>{}))},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;if("addForm"===e){if(this.tableData.findIndex((e=>e.name==this.access.name))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;const e=await this.addItemInDB({context:m.X,data:{name:this.access.name,scopes:this.access.scopes.join(";")}});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}else{const e={};if(this.currentEditItem.name!==this.access.name&&(e["name"]=this.access.name),this.currentEditItem.scopes!==this.access.scopes&&(e["scopes"]=this.access.scopes.join(";")),!this.$_.isEmpty(e)){const t=await this.updateItemInDB({context:m.X,id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.cancelForm(e),this.init()}))},cancelForm(e){this.$refs[e].resetFields(),this.accessDialog=!1}}},w=s(83744);const f=(0,w.Z)(g,[["render",n],["__scopeId","data-v-5ac898ba"]]);var C=f},85048:function(e,t,s){s.r(t),s.d(t,{default:function(){return I}});s(57658);var a=s(82234);const i={class:"text-left"},o={class:"text-right"},r={class:"table-header-overflow"},l={key:0},c={style:{"text-align":"center","margin-top":"20px",display:"flex"}},n={key:0},d={class:"dialog-footer"};function u(e,t,s,u,h,m){const p=(0,a.resolveComponent)("el-col"),g=(0,a.resolveComponent)("el-button"),w=(0,a.resolveComponent)("el-row"),f=(0,a.resolveComponent)("el-table-column"),C=(0,a.resolveComponent)("el-avatar"),$=(0,a.resolveComponent)("el-tag"),x=(0,a.resolveComponent)("el-tooltip"),V=(0,a.resolveComponent)("el-input"),N=(0,a.resolveComponent)("el-table"),b=(0,a.resolveComponent)("el-pagination"),y=(0,a.resolveComponent)("el-card"),v=(0,a.resolveComponent)("el-form-item"),D=(0,a.resolveComponent)("el-checkbox"),S=(0,a.resolveComponent)("el-option"),k=(0,a.resolveComponent)("el-select"),I=(0,a.resolveComponent)("el-switch"),E=(0,a.resolveComponent)("el-form"),_=(0,a.resolveComponent)("el-dialog"),B=(0,a.resolveDirective)("loading");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createVNode)(y,{shadow:"hover"},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(w,{align:"middle"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("h3",null,(0,a.toDisplayString)(e.$t("usersList")),1)])])),_:1}),(0,a.createVNode)(p,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",o,[e.userData&&!parseInt(e.userData.access)?((0,a.openBlock)(),(0,a.createBlock)(g,{key:0,size:"default",icon:"key",type:"info",onClick:t[0]||(t[0]=t=>e.$router.push(h.Routes.USERS.PATH+"/access-management"))},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("accessManagement")),1)])),_:1})):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(g,{size:"default",type:"primary",icon:"plus",onClick:t[1]||(t[1]=e=>m.addItem())},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("add")),1)])),_:1})])])),_:1})])),_:1})])),default:(0,a.withCtx)((()=>[(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)(N,{data:m.pagedTableData,"empty-text":e.$t("noData"),border:"",stripe:"","header-cell-class-name":"el-table-header",style:{width:"100%"}},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(f,{type:"index",index:m.indexMethod},null,8,["index"]),(0,a.createVNode)(f,{label:e.$t("avatar"),prop:"avatar",width:"70"},{default:(0,a.withCtx)((e=>[e.row.avatar?((0,a.openBlock)(),(0,a.createBlock)(C,{key:0,src:e.row.avatar},null,8,["src"])):((0,a.openBlock)(),(0,a.createBlock)(C,{key:1},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(m.getNameInitials(e.row.name||"")),1)])),_:2},1024))])),_:1},8,["label"]),(0,a.createVNode)(f,{sortable:"",label:e.$t("id"),prop:"uid"},null,8,["label"]),(0,a.createVNode)(f,{sortable:"",label:e.$t("name"),prop:"name","show-overflow-tooltip":""},null,8,["label"]),(0,a.createVNode)(f,{sortable:"",label:e.$t("access"),prop:"access"},{default:(0,a.withCtx)((t=>[(0,a.createElementVNode)("small",null,[(0,a.createElementVNode)("b",null,(0,a.toDisplayString)(parseInt(t.row.access)?e.getAccessName(t.row.access):e.$t("administrator")),1)])])),_:1},8,["label"]),(0,a.createVNode)(f,{sortable:"",prop:"status",label:e.$t("status")},{default:(0,a.withCtx)((t=>[parseInt(t.row.status)?((0,a.openBlock)(),(0,a.createBlock)($,{key:0,type:"success"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("active")),1)])),_:1})):((0,a.openBlock)(),(0,a.createBlock)($,{key:1,type:"danger"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("inactive")),1)])),_:1}))])),_:1},8,["label"]),(0,a.createVNode)(f,{sortable:"",prop:"last_login",label:e.$t("lastLogin")},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{content:e.$t("lastLogin"),placement:"top"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",r,(0,a.toDisplayString)(e.$t("lastLogin")),1)])),_:1},8,["content"])])),default:(0,a.withCtx)((t=>[t.row.last_login?((0,a.openBlock)(),(0,a.createElementBlock)("small",l,(0,a.toDisplayString)(e.reformatDate(t.row.last_login)),1)):(0,a.createCommentVNode)("",!0)])),_:1},8,["label"]),e.showUsersPasswords?((0,a.openBlock)(),(0,a.createBlock)(f,{key:0,label:e.$t("password")},{default:(0,a.withCtx)((t=>[e.userData&&parseInt(t.row.access)&&t.row.id!=e.userData.id?((0,a.openBlock)(),(0,a.createBlock)(w,{key:0,gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{size:"small",type:"info",icon:"view",style:{width:"100%"},onClick:e=>m.viewPassword(t.row.password)},null,8,["onClick"])])),_:2},1024),(0,a.createVNode)(p,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{size:"small",type:"primary",icon:"document-copy",style:{width:"100%"},onClick:e=>m.copyPassword(t.row.password)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:1},8,["label"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(f,{align:"right",width:"150"},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{modelValue:h.search,"onUpdate:modelValue":t[2]||(t[2]=e=>h.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,a.withCtx)((t=>[e.userData&&parseInt(t.row.access)&&t.row.id!=e.userData.id?((0,a.openBlock)(),(0,a.createBlock)(w,{key:0,gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(p,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{size:"small",type:"warning",icon:"edit",style:{width:"100%"},onClick:e=>m.editItem(t.$index,t.row)},null,8,["onClick"])])),_:2},1024),(0,a.createVNode)(p,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{size:"small",type:"danger",icon:"delete",style:{width:"100%"},onClick:e=>m.deleteItem(t.$index,t.row)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1},8,["data","empty-text"])),[[B,h.isLoading]]),(0,a.createElementVNode)("div",c,[(0,a.createVNode)(b,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":h.pageSize,total:h.total,onCurrentChange:m.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,a.createVNode)(_,{modelValue:h.userDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>h.userDialog=e),title:h.currentEditItem?e.$t("editUser"):e.$t("addUser"),width:"45%",top:"6vh"},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",d,[(0,a.createVNode)(g,{onClick:t[8]||(t[8]=e=>m.cancelForm(h.currentEditItem?"editForm":"addForm"))},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,a.createVNode)(g,{type:"primary",onClick:t[9]||(t[9]=e=>m.submitForm(h.currentEditItem?"editForm":"addForm"))},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(E,{ref:h.currentEditItem?"editForm":"addForm",model:h.user,rules:h.rules,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(v,{prop:"name",label:e.$t("lastAndFirstNames")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{modelValue:h.user.name,"onUpdate:modelValue":t[3]||(t[3]=e=>h.user.name=e),placeholder:e.$t("lastAndFirstNames")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,a.createVNode)(v,{prop:"email",label:e.$t("emailAddress")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{modelValue:h.user.email,"onUpdate:modelValue":t[4]||(t[4]=e=>h.user.email=e),placeholder:e.$t("emailAddress")},null,8,["modelValue","placeholder"]),m.isEmailValid?((0,a.openBlock)(),(0,a.createElementBlock)("div",n,[(0,a.createVNode)(D,{modelValue:h.sendLoginInfo,"onUpdate:modelValue":t[5]||(t[5]=e=>h.sendLoginInfo=e),label:e.$t("sendLoginInfoToUserMail"),size:"default"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("small",null,(0,a.toDisplayString)(e.$t("sendLoginInfoToUserMail")),1)])),_:1},8,["modelValue","label"])])):(0,a.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,a.createVNode)(v,{prop:"access",label:e.$t("access")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(k,{modelValue:h.user.access,"onUpdate:modelValue":t[6]||(t[6]=e=>h.user.access=e),filterable:"",placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),style:{width:"100%"}},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.accessList,(e=>((0,a.openBlock)(),(0,a.createBlock)(S,{key:e.id,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1},8,["label"]),(0,a.createVNode)(v,{prop:"status"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{modelValue:h.user.status,"onUpdate:modelValue":t[7]||(t[7]=e=>h.user.status=e),width:50,"active-text":e.$t("activeAccount"),"inactive-text":e.$t("inactiveAccount"),"active-color":"limegreen","inactive-color":"red"},null,8,["modelValue","active-text","inactive-text"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}var h=s(14340),m=s(92829),p=s(31567),g=s(66354),w=s(69),f=s(98761),C=s(38855),$=s(66060),x=s(20747),V=s(115),N=s.n(V),b=s(76109),y=s.n(b),v=s(21101),D={name:"Users",mixins:[C.Z,p.Z,g.Z,f.Z,$.Z,w.Z],data(){return{Routes:h.Z5,user:{name:"",email:"",access:"",status:!1},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],access:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},currentEditItem:null,sendLoginInfo:!1,userDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)},isEmailValid(){const e=this.$validator.isEmail(this.user.email);return e||(this.sendLoginInfo=!1),e}},created(){this.init()},methods:{getNameInitials:m.Jt,...(0,v.mapActions)({getUserByCredentials:"authentication/getUserByCredentials"}),...(0,v.mapActions)("user",["getAllUsers","checkUser"]),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},async init(){this.isLoading=!0,await this.getAllAccess();const e=await this.getAllUsers();e.success?e.data&&(this.tableData=e.data):this.$message.error(this.$t("anErrorOccured")),this.isLoading=!1},async genUid(e,t){var s=N().sanitize(e.toLowerCase()).substring(0,10);t&&(s+=this.$_.random(1,99,!1));var a=await this.checkUser(s);return a.success&&!a.data?s:await this.genUid(e,!0)},addItem(){this.currentEditItem=null,this.user.name="",this.user.email="",this.user.access="",this.user.status=!1,this.userDialog=!0},async editItem(e,t){this.currentEditItem=t,this.user.name=t.name,this.user.email=t.email,this.user.access=t.access,this.user.status=!!parseInt(t.status),this.userDialog=!0},deleteItem(e,t){this.$prompt(this.$t("deleteUserQuestion"),this.$t("delete"),{inputPlaceholder:this.$t("confirmWithPassword"),confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel"),inputType:"password"}).then((async({value:e})=>{if(e){const s=await this.getUserByCredentials({username:this.userData.uid,password:e});if(s.success)if(s.data.username&&s.data.password&&s.data.user){const e=await this.deleteItemInDB({context:x.A,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))}else this.$message.error(this.$t("wrongPassword"));else this.$message.error(this.$t("anErrorOccured"))}})).catch((()=>{}))},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;{if(this.user.email&&!this.isEmailValid)return this.$message.warning(this.$t("invalidEmail")),!1;let t={};if("addForm"===e){const e=await this.genUid(this.user.name,!1);t={uid:e,name:this.user.name,email:this.user.email,access:this.user.access,status:this.user.status?h.dp.ENABLED:h.dp.DISABLED,hash_id:this.$uuidv4(),password:(0,m.PM)()};const s=await this.addItemInDB({context:x.A,data:t});s.success?(this.addNotification({type:this.NotificationTypes.WELCOME,recipients:[s.data],params:{},source:this.NotificationSources.SYSTEM,target:"",removable:!0}),this.$message.success(this.$t("success"))):this.$message.error(this.$t("anErrorOccured"))}else{const e={};if(t=this.currentEditItem,this.currentEditItem.name!==this.user.name&&(e["name"]=this.user.name),this.currentEditItem.email!==this.user.email&&(e["email"]=this.user.email),this.currentEditItem.access!==this.user.access&&(e["access"]=this.user.access),!!parseInt(this.currentEditItem.status)!==this.user.status&&(e["status"]=this.user.status?h.dp.ENABLED:h.dp.DISABLED),!this.$_.isEmpty(e)){const t=await this.updateItemInDB({context:x.A,id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.sendLoginInfo&&this.sendEmail(null,`${this.$t("loginInfo")} - ${this.tr(this.websiteInfo.title)} - Breeze`,`${this.$t("loginInfo")} - ${this.tr(this.websiteInfo.title)} - Breeze`,`<small><b>${this.$t("id")}</b> : ${t.uid} <br> <b>${this.$t("password")}</b> : ${t.password}</small>`,t.email),this.cancelForm(e),this.init()}}))},cancelForm(e){this.$refs[e].resetFields(),this.userDialog=!1},viewPassword(e){this.$alert(e,{center:!0,showClose:!0,closeOnClickModal:!0,showCancelButton:!1,showConfirmButton:!1,closeOnPressEscape:!0,icon:"lock"})},async copyPassword(e){const{toClipboard:t}=y()();try{await t(e),this.$message.success(this.$t("success"))}catch(s){console.error(s),this.$message.error(this.$t("anErrorOccured"))}}}},S=s(83744);const k=(0,S.Z)(D,[["render",u]]);var I=k},31567:function(e,t,s){var a=s(14340),i=s(21101);t["Z"]={created(){const e=-1===this.restrictedScopes.findIndex((e=>this.$route.name.includes(e.value)));e||this.$router.replace(a.Z5.LOGIN.PATH)},computed:{...(0,i.mapState)({userData:e=>e.session.userData,accessList:e=>e.access.accessList}),...(0,i.mapGetters)({userScopes:"access/getUserScopes",restrictedScopes:"access/getUserRestrictedScopes",disabledModuleScopes:"access/getDisabledModuleScopes",userPageScopes:"access/getUserPageScopes",userActionScopes:"access/getUserActionScopes",userSectionScopes:"access/getUserSectionScopes",userPageScope:"access/getUserPageScope",userActionScope:"access/getUserActionScope",userSectionScope:"access/getUserSectionScope"})},methods:{...(0,i.mapActions)("access",["getAllAccess"]),getAccessName(e){const t=this.accessList.find((t=>t.id==e));return t?t.name:""}}}},38855:function(e,t,s){s(57658);var a=s(39355),i=s(14340),o=s(20747),r=s(21101);t["Z"]={data(){return{Routes:i.Z5,Currencies:i.Kt,WebsiteInfo:i.a,currencies:[]}},async created(){this.$_.forIn(i.Kt,((e,t)=>{this.currencies.push(e)})),this.$store.commit("global/updateCurrentPanelPath",this.$route.path,{root:!0});const e=await this.getItemFromDB({context:o.A,id:this.userData?.id});e.success&&e.data&&e.data.status==i.dp.DISABLED&&(this.destroySession(),this.$router.replace(i.Z5.LOGIN.PATH))},computed:{...(0,r.mapState)({userData:e=>e.session.userData}),...(0,r.mapGetters)({isUserConnected:"session/isUserConnected",getSettingValue:"setting/getSettingValue"})},methods:{formatDate:a.p6,reformatDate:a.bK,...(0,r.mapMutations)({destroySession:"session/destroySession"})}}}}]);
//# sourceMappingURL=group-users.670553af.js.map