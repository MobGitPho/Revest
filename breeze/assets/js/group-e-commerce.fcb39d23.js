(self["webpackChunkbreeze"]=self["webpackChunkbreeze"]||[]).push([[837],{99726:function(){!function(e){const t=e.fr=e.fr||{};t.dictionary=Object.assign(t.dictionary||{},{"%0 of %1":"%0 sur %1",Aquamarine:"Bleu vert",Black:"Noir","Block quote":"Citation",Blue:"Bleu",Bold:"Gras","Break text":"","Bulleted List":"Liste à puces",Cancel:"Annuler","Cannot upload file:":"Envoi du fichier échoué :","Centered image":"Image centrée","Change image text alternative":"Changer le texte alternatif à l’image","Choose heading":"Choisir l'en-tête",Column:"Colonne","Could not insert image at the current position.":"Impossible d'insérer l'image à la position courante.","Could not obtain resized image URL.":"Impossible d'obtenir l'image redimensionnée","Decrease indent":"Diminuer le retrait","Delete column":"Supprimer la colonne","Delete row":"Supprimer la ligne","Dim grey":"Gris pâle",Downloadable:"Fichier téléchargeable","Dropdown toolbar":"Barre d'outils dans un menu déroulant","Edit block":"Modifier le bloc","Edit link":"Modifier le lien","Editor toolbar":"Barre d'outils de l'éditeur","Enter image caption":"Saisir la légende de l’image","Full size image":"Image taille réelle",Green:"Vert",Grey:"Gris","Header column":"Colonne d'entête","Header row":"Ligne d'entête",Heading:"En-tête","Heading 1":"Titre 1","Heading 2":"Titre 2","Heading 3":"Titre 3","Heading 4":"Titre 4","Heading 5":"Titre 5","Heading 6":"Titre 6","Image toolbar":"Barre d'outils des images","image widget":"Objet image","In line":"","Increase indent":"Augmenter le retrait","Insert column left":"Insérer une colonne à gauche","Insert column right":"Insérer une colonne à droite","Insert image":"Insérer une image","Insert image or file":"Insérer une image ou un fichier","Insert media":"Insérer un média","Insert paragraph after block":"Insérer du texte après ce bloc","Insert paragraph before block":"Insérer du texte avant ce bloc","Insert row above":"Insérer une ligne au-dessus","Insert row below":"Insérer une ligne en-dessous","Insert table":"Insérer un tableau","Inserting image failed":"L'insertion d'image a échoué.",Italic:"Italique","Left aligned image":"Image alignée à gauche","Light blue":"Bleu clair","Light green":"Vert clair","Light grey":"Gris clair",Link:"Lien","Link URL":"URL du lien","Media URL":"URL de média","media widget":"Widget média","Merge cell down":"Fusionner la cellule en-dessous","Merge cell left":"Fusionner la cellule à gauche","Merge cell right":"Fusionner la cellule à droite","Merge cell up":"Fusionner la cellule au-dessus","Merge cells":"Fusionner les cellules",Next:"Suivant","Numbered List":"Liste numérotée","Open in a new tab":"Ouvrir dans un nouvel onglet","Open link in new tab":"Ouvrir le lien dans un nouvel onglet",Orange:"Orange",Paragraph:"Paragraphe","Paste the media URL in the input.":"Coller l'URL du média",Previous:"Précedent",Purple:"Violet",Red:"Rouge",Redo:"Restaurer","Rich Text Editor":"Éditeur de texte enrichi","Rich Text Editor, %0":"Éditeur de texte enrichi, %0","Right aligned image":"Image alignée à droite",Row:"Ligne",Save:"Enregistrer","Select all":"Sélectionner tout","Select column":"Sélectionner la colonne","Select row":"Sélectionner la ligne","Selecting resized image failed":"La sélection de l'image redimensionnée a échoué.","Show more items":"Montrer plus d'éléments","Side image":"Image latérale","Split cell horizontally":"Scinder la cellule horizontalement","Split cell vertically":"Scinder la cellule verticalement","Table toolbar":"Barre d'outils des tableaux","Text alternative":"Texte alternatif","The URL must not be empty.":"L'URL ne doit pas être vide.","This link has no URL":"Ce lien n'a pas d'URL","This media URL is not supported.":"Cette URL de média n'est pas supportée.","Tip: Paste the URL into the content to embed faster.":"Astuce : Copier l'URL du média dans le contenu pour l'insérer plus rapidement","Toggle caption off":"","Toggle caption on":"",Turquoise:"Turquoise",Undo:"Annuler",Unlink:"Supprimer le lien","Upload failed":"Échec de l'envoi","Upload in progress":"Téléchargement en cours",White:"Blanc","Widget toolbar":"Barre d'outils du widget","Wrap text":"",Yellow:"Jaune"}),t.getPluralForm=function(e){return e>1}}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={}))},39494:function(e,t,i){"use strict";i.d(t,{Z:function(){return d}});var o=i(82234);function n(e,t,i,n,s,r){return(0,o.openBlock)(),(0,o.createElementBlock)("button",{onClick:t[0]||(t[0]=(...e)=>n.copy&&n.copy(...e))},[(0,o.renderSlot)(e.$slots,"default")])}var s=i(76109),r=i.n(s),a={name:"Copy",props:{toCopy:{type:String,default:""}},emits:["copy"],setup(e,t){const{toClipboard:i}=r()(),o=async()=>{try{await i(e.toCopy),t.emit("copy",e.toCopy,!0)}catch(o){console.error(o),t.emit("copy",e.toCopy,!1)}};return{copy:o}}},l=i(83744);const c=(0,l.Z)(a,[["render",n]]);var d=c},31377:function(e,t,i){"use strict";i.d(t,{Z:function(){return nA}});var o=i(68716),n=i(82234);function s(e,t,i,s,r,a){const l=(0,n.resolveComponent)("ckeditor"),c=o.Z,d=(0,n.resolveComponent)("el-dialog");return(0,n.openBlock)(),(0,n.createElementBlock)("section",null,[(0,n.createVNode)(l,{editor:r.editor,"tag-name":i.tagName,disabled:i.disabled,config:r.editorConfig,"model-value":i.modelValue?.replace(new RegExp(r.BASE_URL_MUSTACHE,"g"),r.STORAGE_API_BASE_URL),class:"page-content-editor",onInput:t[0]||(t[0]=t=>e.$emit("update:modelValue",t?.replace(new RegExp(r.STORAGE_API_BASE_URL,"g"),r.BASE_URL_MUSTACHE))),onDestroy:t[1]||(t[1]=t=>e.$emit("destroy",t)),onReady:t[2]||(t[2]=t=>e.$emit("ready",t)),onFocus:t[3]||(t[3]=t=>e.$emit("focus",t)),onBlur:t[4]||(t[4]=t=>e.$emit("blur",t))},null,8,["editor","tag-name","disabled","config","model-value"]),(0,n.createVNode)(d,{modelValue:r.mediaPickerVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>r.mediaPickerVisible=e),title:e.$t("add"),"destroy-on-close":"",fullscreen:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{multiple:!0,"display-videos":!0,"display-audios":!0,"display-images":!0,"display-documents":!0,"display-other-types":!0,"enable-add-from-an-url":!1,"enable-selection-details":!0,onSelected:a.onMediasSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])])}var r=i(75010),a=i(41371),l=i(45642),c='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M7 19L12 14L13.88 15.88C13.33 16.79 13 17.86 13 19H7M10 10.5C10 9.67 9.33 9 8.5 9S7 9.67 7 10.5 7.67 12 8.5 12 10 11.33 10 10.5M13.09 20H6V4H13V9H18V13.09C18.33 13.04 18.66 13 19 13C19.34 13 19.67 13.04 20 13.09V8L14 2H6C4.89 2 4 2.9 4 4V20C4 21.11 4.89 22 6 22H13.81C13.46 21.39 13.21 20.72 13.09 20M18 15V18H15V20H18V23H20V20H23V18H20V15H18Z" /></svg>';const{t:d}=r.Z.global;class h extends a.Z{init(){const e=this.editor;e.ui.componentFactory.add("addBreezeMedias",(e=>{const t=new l.Z(e);return t.set({label:d("add"),icon:c,withText:!1,tooltip:!0}),t.on("execute",(()=>{const e=new Event("add-breeze-medias");document.dispatchEvent(e)})),t}))}}var u='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z" /></svg>',m='<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z" /></svg>';const{t:g}=r.Z.global;class p extends a.Z{init(){const e=this.editor;e.ui.componentFactory.add("fullScreen",(t=>{const i=new l.Z(t);let o=0;return i.set({label:g("fullscreen"),icon:m,withText:!1,tooltip:!0}),i.on("execute",(()=>{1==o?(e.sourceElement.nextElementSibling.removeAttribute("id"),document.body.removeAttribute("id"),i.set({label:g("fullscreen"),icon:m,withText:!1,tooltip:!0}),o=0):(e.sourceElement.nextElementSibling.setAttribute("id","fullscreeneditor"),document.body.setAttribute("id","fullscreenoverlay"),i.set({label:g("normalSize"),icon:u,withText:!1,tooltip:!0}),o=1)})),i}))}}var f=i(11165),w=i(14340),b=i(7397);i(57658);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _ extends b.Z{constructor(e){super(e),this._childCommands=[]}refresh(){}execute(...e){const t=this._getFirstEnabledCommand();return null!=t&&t.execute(e)}registerChildCommand(e){this._childCommands.push(e),e.on("change:isEnabled",(()=>this._checkEnabled())),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find((e=>e.isEnabled))}}var v=i(37514),y=i(24612),C=i(18533);function k(e){return(0,C.Z)(e)&&1===e.nodeType&&!(0,v.Z)(e)}var x=k;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class V{constructor(e,t){this._config={},t&&this.define(E(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){const i=!0;this._setToTarget(this._config,e,t,i)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,i,o=!1){if((0,v.Z)(t))return void this._setObjectToTarget(e,t,o);const n=t.split(".");t=n.pop();for(const s of n)(0,v.Z)(e[s])||(e[s]={}),e=e[s];if((0,v.Z)(i))return(0,v.Z)(e[t])||(e[t]={}),e=e[t],void this._setObjectToTarget(e,i,o);o&&"undefined"!=typeof e[t]||(e[t]=i)}_getFromSource(e,t){const i=t.split(".");t=i.pop();for(const o of i){if(!(0,v.Z)(e[o])){e=null;break}e=e[o]}return e?E(e[t]):void 0}_setObjectToTarget(e,t,i){Object.keys(t).forEach((o=>{this._setToTarget(e,o,t[o],i)}))}}function E(e){return(0,y.Z)(e,A)}function A(e){return x(e)?e:void 0}var P=i(32364),S=i(13117),T=i(3026),N=i(61409);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class I{constructor(e,t=[],i=[]){this._context=e,this._plugins=new Map,this._availablePlugins=new Map;for(const o of t)o.pluginName&&this._availablePlugins.set(o.pluginName,o);this._contextPlugins=new Map;for(const[o,n]of i)this._contextPlugins.set(o,n),this._contextPlugins.set(n,o),o.pluginName&&this._availablePlugins.set(o.pluginName,o)}*[Symbol.iterator](){for(const e of this._plugins)"function"==typeof e[0]&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let t=e;throw"function"==typeof e&&(t=e.pluginName||e.name),new S.ZP("plugincollection-plugin-not-loaded",this._context,{plugin:t})}return t}has(e){return this._plugins.has(e)}init(e,t=[],i=[]){const o=this,n=this._context;u(e),g(e);const s=e.filter((e=>!d(e,t))),r=[...m(s)];v(r,i);const a=b(r);return _(a,"init").then((()=>_(a,"afterInit"))).then((()=>a));function l(e){return"function"===typeof e}function c(e){return l(e)&&e.isContextPlugin}function d(e,t){return t.some((t=>t===e||(h(e)===t||h(t)===e)))}function h(e){return l(e)?e.pluginName||e.name:e}function u(e,t=new Set){e.forEach((e=>{l(e)&&(t.has(e)||(t.add(e),e.pluginName&&!o._availablePlugins.has(e.pluginName)&&o._availablePlugins.set(e.pluginName,e),e.requires&&u(e.requires,t)))}))}function m(e,t=new Set){return e.map((e=>l(e)?e:o._availablePlugins.get(e))).reduce(((e,i)=>t.has(i)?e:(t.add(i),i.requires&&(g(i.requires,i),m(i.requires,t).forEach((t=>e.add(t)))),e.add(i))),new Set)}function g(e,t=null){e.map((e=>l(e)?e:o._availablePlugins.get(e)||e)).forEach((e=>{p(e,t),f(e,t),w(e,t)}))}function p(e,t){if(!l(e)){if(t)throw new S.ZP("plugincollection-soft-required",n,{missingPlugin:e,requiredBy:h(t)});throw new S.ZP("plugincollection-plugin-not-found",n,{plugin:e})}}function f(e,t){if(c(t)&&!c(e))throw new S.ZP("plugincollection-context-required",n,{plugin:h(e),requiredBy:h(t)})}function w(e,i){if(i&&d(e,t))throw new S.ZP("plugincollection-required",n,{plugin:h(e),requiredBy:h(i)})}function b(e){return e.map((e=>{const t=o._contextPlugins.get(e)||new e(n);return o._add(e,t),t}))}function _(e,t){return e.reduce(((e,i)=>i[t]?o._contextPlugins.has(i)?e:e.then(i[t].bind(i)):e),Promise.resolve())}function v(e,t){for(const i of t){if("function"!=typeof i)throw new S.ZP("plugincollection-replace-plugin-invalid-type",null,{pluginItem:i});const t=i.pluginName;if(!t)throw new S.ZP("plugincollection-replace-plugin-missing-name",null,{pluginItem:i});if(i.requires&&i.requires.length)throw new S.ZP("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:t});const n=o._availablePlugins.get(t);if(!n)throw new S.ZP("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:t});const s=e.indexOf(n);if(-1===s){if(o._contextPlugins.has(n))return;throw new S.ZP("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:t})}if(n.requires&&n.requires.length)throw new S.ZP("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:t});e.splice(s,1,i),o._availablePlugins.set(t,i)}}}destroy(){const e=[];for(const[,t]of this)"function"!=typeof t.destroy||this._contextPlugins.has(t)||e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const i=e.pluginName;if(i){if(this._plugins.has(i))throw new S.ZP("plugincollection-plugin-name-conflict",null,{pluginName:i,plugin1:this._plugins.get(i).constructor,plugin2:e});this._plugins.set(i,t)}}}(0,N.Z)(I,T.ZP);var D=i(77125);function R(e,t,i=1){if("number"!==typeof i)throw new S.ZP("translation-service-quantity-not-a-number",null,{quantity:i});const o=M();1===o&&(e=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const n=t.id||t.string;if(0===o||!B(e,n))return 1!==i?t.plural:t.string;const s=window.CKEDITOR_TRANSLATIONS[e].dictionary,r=window.CKEDITOR_TRANSLATIONS[e].getPluralForm||(e=>1===e?0:1);if("string"===typeof s[n])return s[n];const a=Number(r(i));return s[n][a]}function B(e,t){return!!window.CKEDITOR_TRANSLATIONS[e]&&!!window.CKEDITOR_TRANSLATIONS[e].dictionary[t]}function M(){return Object.keys(window.CKEDITOR_TRANSLATIONS).length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const O=["ar","ara","fa","per","fas","he","heb","ku","kur","ug","uig"];function L(e){return O.includes(e)?"rtl":"ltr"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ${constructor(e={}){this.uiLanguage=e.uiLanguage||"en",this.contentLanguage=e.contentLanguage||this.uiLanguage,this.uiLanguageDirection=L(this.uiLanguage),this.contentLanguageDirection=L(this.contentLanguage),this.t=(e,t)=>this._t(e,t)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=(0,D.Z)(t),"string"===typeof e&&(e={string:e});const i=!!e.plural,o=i?t[0]:1,n=R(this.uiLanguage,e,o);return F(n,t)}}function F(e,t){return e.replace(/%(\d+)/g,((e,i)=>i<t.length?t[i]:e))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class z{constructor(e){this.config=new V(e,this.constructor.defaultConfig);const t=this.constructor.builtinPlugins;this.config.define("plugins",t),this.plugins=new I(this,t);const i=this.config.get("language")||{};this.locale=new $({uiLanguage:"string"===typeof i?i:i.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new P.Z,this._contextOwner=null}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const i of e.concat(t)){if("function"!=typeof i)throw new S.ZP("context-initplugins-constructor-only",null,{Plugin:i});if(!0!==i.isContextPlugin)throw new S.ZP("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,(e=>e.destroy()))).then((()=>this.plugins.destroy()))}_addEditor(e,t){if(this._contextOwner)throw new S.ZP("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise((t=>{const i=new this(e);t(i.initPlugins().then((()=>i)))}))}}var Z=i(75880);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class H{constructor(e){this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}(0,N.Z)(H,Z.Z);i(30541);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function U(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++)if(e[o]!=t[o])return o;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}var W=i(92346);i(92310);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class q{constructor(e){this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new S.ZP("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;while(e.parent)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;while(t.parent)e.unshift(t.index),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}getCommonAncestor(e,t={}){const i=this.getAncestors(t),o=e.getAncestors(t);let n=0;while(i[n]==o[n]&&i[n])n++;return 0===n?null:i[n-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),i=e.getPath(),o=U(t,i);switch(o){case"prefix":return!0;case"extension":return!1;default:return t[o]<i[o]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire("change:"+e,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=(0,W.Z)(this);return delete e.parent,e}is(e){return"node"===e||"view:node"===e}}(0,N.Z)(q,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class G extends q{constructor(e,t){super(e),this._textData=t}is(e){return"$text"===e||"view:$text"===e||"text"===e||"view:text"===e||"node"===e||"view:node"===e}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof G&&(this===e||this.data===e.data)}_clone(){return new G(this.document,this.data)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class j{constructor(e,t,i){if(this.textNode=e,t<0||t>e.data.length)throw new S.ZP("view-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.data.length)throw new S.ZP("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return"$textProxy"===e||"view:$textProxy"===e||"textProxy"===e||"view:textProxy"===e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this.textNode:this.parent;while(null!==i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function K(e){const t=new Map;for(const i in e)t.set(i,e[i]);return t}var J=i(34665);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Y(e){return(0,J.Z)(e)?new Map(e):K(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Q{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)("string"==typeof t||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const e of this._patterns){const i=X(t,e);if(i)return{element:t,pattern:e,match:i}}return null}matchAll(...e){const t=[];for(const i of e)for(const e of this._patterns){const o=X(i,e);o&&t.push({element:i,pattern:e,match:o})}return t.length>0?t:null}getElementName(){if(1!==this._patterns.length)return null;const e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t}}function X(e,t){if("function"==typeof t)return t(e);const i={};return t.name&&(i.name=ee(t.name,e.name),!i.name)||t.attributes&&(i.attributes=se(t.attributes,e),!i.attributes)?null:!(t.classes&&(i.classes=re(t.classes,e),!i.classes))&&(!(t.styles&&(i.styles=ae(t.styles,e),!i.styles))&&i)}function ee(e,t){return e instanceof RegExp?!!t.match(e):e===t}function te(e,t,i){const o=ie(e),n=Array.from(t),s=[];return o.forEach((([e,t])=>{n.forEach((o=>{oe(e,o)&&ne(t,o,i)&&s.push(o)}))})),!o.length||s.length<o.length?null:s}function ie(e){return Array.isArray(e)?e.map((e=>(0,v.Z)(e)?(void 0!==e.key&&void 0!==e.value||(0,S.KE)("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0])):(0,v.Z)(e)?Object.entries(e):[[e,!0]]}function oe(e,t){return!0===e||e===t||e instanceof RegExp&&t.match(e)}function ne(e,t,i){if(!0===e)return!0;const o=i(t);return e===o||e instanceof RegExp&&!!String(o).match(e)}function se(e,t){const i=new Set(t.getAttributeKeys());return(0,v.Z)(e)?(void 0!==e.style&&(0,S.KE)("matcher-pattern-deprecated-attributes-style-key",e),void 0!==e.class&&(0,S.KE)("matcher-pattern-deprecated-attributes-class-key",e)):(i.delete("style"),i.delete("class")),te(e,i,(e=>t.getAttribute(e)))}function re(e,t){return te(e,t.getClassNames())}function ae(e,t){return te(e,t.getStyleNames(!0),(e=>t.getStyle(e)))}var le=i(77226),ce=i(22823);function de(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var he=de,ue=i(13317);function me(e,t,i){var o=-1,n=e.length;t<0&&(t=-t>n?0:n+t),i=i>n?n:i,i<0&&(i+=n),n=t>i?0:i-t>>>0,t>>>=0;var s=Array(n);while(++o<n)s[o]=e[o+t];return s}var ge=me;function pe(e,t){return t.length<2?e:(0,ue.Z)(e,ge(t,0,-1))}var fe=pe,we=i(62281);function be(e,t){return t=(0,ce.Z)(t,e),e=fe(e,t),null==e||delete e[(0,we.Z)(he(t))]}var _e=be;function ve(e,t){return null==e||_e(e,t)}var ye=ve,Ce=i(16423),ke=i(40987),xe=i(48707);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ve{constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){const e=Object.entries(this._styles),t=Array.from(e);return!t.length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=Array.from(Ae(e).entries());for(const[i,o]of t)this._styleProcessor.toNormalizedForm(i,o,this._styles)}has(e){if(this.isEmpty)return!1;const t=this._styleProcessor.getReducedForm(e,this._styles),i=t.find((([t])=>t===e));return Array.isArray(i)}set(e,t){if((0,le.Z)(e))for(const[i,o]of Object.entries(e))this._styleProcessor.toNormalizedForm(i,o,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t=Pe(e);ye(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map((e=>e.join(":"))).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!(0,le.Z)(this._styles[e]))return this._styles[e];const t=this._styleProcessor.getReducedForm(e,this._styles),i=t.find((([t])=>t===e));return Array.isArray(i)?i[1]:void 0}getStyleNames(e=!1){if(this.isEmpty)return[];if(e)return this._styleProcessor.getStyleNames(this._styles);const t=this._getStylesEntries();return t.map((([e])=>e))}clear(){this._styles={}}_getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const i of t)e.push(...this._styleProcessor.getReducedForm(i,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split("."),i=t.length>1;if(!i)return;const o=t.splice(0,t.length-1).join("."),n=(0,Ce.Z)(this._styles,o);if(!n)return;const s=!Array.from(Object.keys(n)).length;s&&this.remove(o)}}class Ee{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,i){if((0,le.Z)(t))Se(i,Pe(e),t);else if(this._normalizers.has(e)){const o=this._normalizers.get(e),{path:n,value:s}=o(t);Se(i,n,s)}else Se(i,e,t)}getNormalized(e,t){if(!e)return(0,ke.Z)({},t);if(void 0!==t[e])return t[e];if(this._extractors.has(e)){const i=this._extractors.get(e);if("string"===typeof i)return(0,Ce.Z)(t,i);const o=i(e,t);if(o)return o}return(0,Ce.Z)(t,Pe(e))}getReducedForm(e,t){const i=this.getNormalized(e,t);if(void 0===i)return[];if(this._reducers.has(e)){const t=this._reducers.get(e);return t(i)}return[[e,i]]}getStyleNames(e){const t=Array.from(this._consumables.keys()).filter((t=>{const i=this.getNormalized(t,e);return i&&"object"==typeof i?Object.keys(i).length:i})),i=new Set([...t,...Object.keys(e)]);return Array.from(i.values())}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const i of t)this._mapStyleNames(i,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function Ae(e){let t=null,i=0,o=0,n=null;const s=new Map;if(""===e)return s;";"!=e.charAt(e.length-1)&&(e+=";");for(let r=0;r<e.length;r++){const a=e.charAt(r);if(null===t)switch(a){case":":n||(n=e.substr(i,r-i),o=r+1);break;case'"':case"'":t=a;break;case";":{const t=e.substr(o,r-o);n&&s.set(n.trim(),t.trim()),n=null,i=r+1;break}}else a===t&&(t=null)}return s}function Pe(e){return e.replace("-",".")}function Se(e,t,i){let o=i;(0,le.Z)(i)&&(o=(0,ke.Z)({},(0,Ce.Z)(e,t),i)),(0,xe.Z)(e,t,o)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Te extends q{constructor(e,t,i,o){if(super(e),this.name=t,this._attrs=Ne(i),this._children=[],o&&this._insertChild(0,o),this._classes=new Set,this._attrs.has("class")){const e=this._attrs.get("class");Ie(this._classes,e),this._attrs.delete("class")}this._styles=new Ve(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map,this._isAllowedInsideAttributeElement=!1,this._unsafeAttributesToRender=[]}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}get isAllowedInsideAttributeElement(){return this._isAllowedInsideAttributeElement}is(e,t=null){return t?t===this.name&&("element"===e||"view:element"===e):"element"===e||"view:element"===e||"node"===e||"view:node"===e}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if("class"==e)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==e){const e=this._styles.toString();return""==e?void 0:e}return this._attrs.get(e)}hasAttribute(e){return"class"==e?this._classes.size>0:"style"==e?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof Te))return!1;if(this===e)return!0;if(this.name!=e.name)return!1;if(this.isAllowedInsideAttributeElement!=e.isAllowedInsideAttributeElement)return!1;if(this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,i]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==i)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const t of this._styles.getStyleNames())if(!e._styles.has(t)||e._styles.getAsString(t)!==this._styles.getAsString(t))return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e=!1){return this._styles.getStyleNames(e)}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new Q(...e);let i=this.parent;while(i){if(t.match(i))return i;i=i.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=this._styles.toString(),i=Array.from(this._attrs).map((e=>`${e[0]}="${e[1]}"`)).sort().join(" ");return this.name+(""==e?"":` class="${e}"`)+(t?` style="${t}"`:"")+(""==i?"":` ${i}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const t=[];if(e)for(const o of this.getChildren())t.push(o._clone(e));const i=new this.constructor(this.document,this.name,this._attrs,t);return i._classes=new Set(this._classes),i._styles.set(this._styles.getNormalized()),i._customProperties=new Map(this._customProperties),i.getFillerOffset=this.getFillerOffset,i._isAllowedInsideAttributeElement=this.isAllowedInsideAttributeElement,i}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let i=0;const o=De(this.document,t);for(const n of o)null!==n.parent&&n._remove(),n.parent=this,n.document=this.document,this._children.splice(e,0,n),e++,i++;return i}_removeChildren(e,t=1){this._fireChange("children",this);for(let i=e;i<e+t;i++)this._children[i].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){t=String(t),this._fireChange("attributes",this),"class"==e?Ie(this._classes,t):"style"==e?this._styles.setTo(t):this._attrs.set(e,t)}_removeAttribute(e){return this._fireChange("attributes",this),"class"==e?this._classes.size>0&&(this._classes.clear(),!0):"style"==e?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const t of(0,D.Z)(e))this._classes.add(t)}_removeClass(e){this._fireChange("attributes",this);for(const t of(0,D.Z)(e))this._classes.delete(t)}_setStyle(e,t){this._fireChange("attributes",this),this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this);for(const t of(0,D.Z)(e))this._styles.remove(t)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}function Ne(e){e=Y(e);for(const[t,i]of e)null===i?e.delete(t):"string"!=typeof i&&e.set(t,String(i));return e}function Ie(e,t){const i=t.split(/\s+/);e.clear(),i.forEach((t=>e.add(t)))}function De(e,t){return"string"==typeof t?[new G(e,t)]:((0,J.Z)(t)||(t=[t]),Array.from(t).map((t=>"string"==typeof t?new G(e,t):t instanceof j?new G(e,t.data):t)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Re extends Te{constructor(e,t,i,o){super(e,t,i,o),this.getFillerOffset=Be}is(e,t=null){return t?t===this.name&&("containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}}function Be(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const i of e)if(!i.is("uiElement"))return null;return this.childCount}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Me extends Re{constructor(e,t,i,o){super(e,t,i,o),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",(t=>t&&e.selection.editableElement==this)),this.listenTo(e.selection,"change",(()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this}))}is(e,t=null){return t?t===this.name&&("editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}destroy(){this.stopListening()}}(0,N.Z)(Me,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Oe=Symbol("rootName");class Le extends Me{constructor(e,t){super(e,t),this.rootName="main"}is(e,t=null){return t?t===this.name&&("rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}get rootName(){return this.getCustomProperty(Oe)}set rootName(e){this._setCustomProperty(Oe,e)}set _name(e){this.name=e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $e{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new S.ZP("view-tree-walker-no-start-position",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new S.ZP("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=Fe._createAt(e.startPosition):this.position=Fe._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(e){let t,i,o;do{o=this.position,({done:t,value:i}=this.next())}while(!t&&e(i));t||(this.position=o)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,i=e.parent;if(null===i.parent&&e.offset===i.childCount)return{done:!0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};let o;if(i instanceof G){if(e.isAtEnd)return this.position=Fe._createAfter(i),this._next();o=i.data[e.offset]}else o=i.getChild(e.offset);if(o instanceof Te)return this.shallow?e.offset++:e=new Fe(o,0),this.position=e,this._formatReturnValue("elementStart",o,t,e,1);if(o instanceof G){if(this.singleCharacters)return e=new Fe(o,0),this.position=e,this._next();{let i,n=o.data.length;return o==this._boundaryEndParent?(n=this.boundaries.end.offset,i=new j(o,0,n),e=Fe._createAfter(i)):(i=new j(o,0,o.data.length),e.offset++),this.position=e,this._formatReturnValue("text",i,t,e,n)}}if("string"==typeof o){let o;if(this.singleCharacters)o=1;else{const t=i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length;o=t-e.offset}const n=new j(i,e.offset,o);return e.offset+=o,this.position=e,this._formatReturnValue("text",n,t,e,o)}return e=Fe._createAfter(i),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,t,e)}_previous(){let e=this.position.clone();const t=this.position,i=e.parent;if(null===i.parent&&0===e.offset)return{done:!0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};let o;if(i instanceof G){if(e.isAtStart)return this.position=Fe._createBefore(i),this._previous();o=i.data[e.offset-1]}else o=i.getChild(e.offset-1);if(o instanceof Te)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",o,t,e,1)):(e=new Fe(o,o.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",o,t,e));if(o instanceof G){if(this.singleCharacters)return e=new Fe(o,o.data.length),this.position=e,this._previous();{let i,n=o.data.length;if(o==this._boundaryStartParent){const t=this.boundaries.start.offset;i=new j(o,t,o.data.length-t),n=i.data.length,e=Fe._createBefore(i)}else i=new j(o,0,o.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",i,t,e,n)}}if("string"==typeof o){let o;if(this.singleCharacters)o=1;else{const t=i===this._boundaryStartParent?this.boundaries.start.offset:0;o=e.offset-t}e.offset-=o;const n=new j(i,e.offset,o);return this.position=e,this._formatReturnValue("text",n,t,e,o)}return e=Fe._createBefore(i),this.position=e,this._formatReturnValue("elementStart",i,t,e,1)}_formatReturnValue(e,t,i,o,n){return t instanceof j&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?i=Fe._createAfter(t.textNode):(o=Fe._createAfter(t.textNode),this.position=o)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?i=Fe._createBefore(t.textNode):(o=Fe._createBefore(t.textNode),this.position=o))),{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:o,length:n}}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fe{constructor(e,t){this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;while(!(e instanceof Me)){if(!e.parent)return null;e=e.parent}return e}getShiftedBy(e){const t=Fe._createAt(this),i=t.offset+e;return t.offset=i<0?0:i,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const i=new $e(t);return i.skip(e),i.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),i=e.getAncestors();let o=0;while(t[o]==i[o]&&t[o])o++;return 0===o?null:t[o-1]}is(e){return"position"===e||"view:position"===e}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return"before"==this.compareWith(e)}isAfter(e){return"after"==this.compareWith(e)}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],i=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),i.push(e.offset);const o=U(t,i);switch(o){case"prefix":return"before";case"extension":return"after";default:return t[o]<i[o]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new $e(e)}clone(){return new Fe(this.parent,this.offset)}static _createAt(e,t){if(e instanceof Fe)return new this(e.parent,e.offset);{const i=e;if("end"==t)t=i.is("$text")?i.data.length:i.childCount;else{if("before"==t)return this._createBefore(i);if("after"==t)return this._createAfter(i);if(0!==t&&!t)throw new S.ZP("view-createpositionat-offset-required",i)}return new Fe(i,t)}}static _createAfter(e){if(e.is("$textProxy"))return new Fe(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new S.ZP("view-position-after-root",e,{root:e});return new Fe(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new Fe(e.textNode,e.offsetInText);if(!e.parent)throw new S.ZP("view-position-before-root",e,{root:e});return new Fe(e.parent,e.index)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ze{constructor(e,t=null){this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new $e({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Ze,{direction:"backward"}),t=this.end.getLastMatchingPosition(Ze);return e.parent.is("$text")&&e.isAtStart&&(e=Fe._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=Fe._createAfter(t.parent)),new ze(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(Ze);if(e.isAfter(this.end)||e.isEqual(this.end))return new ze(e,e);let t=this.end.getLastMatchingPosition(Ze,{direction:"backward"});const i=e.nodeAfter,o=t.nodeBefore;return i&&i.is("$text")&&(e=new Fe(i,0)),o&&o.is("$text")&&(t=new Fe(o,o.data.length)),new ze(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),o=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&o}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new ze(this.start,e.start)),this.containsPosition(e.end)&&t.push(new ze(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,i=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(i=e.end),new ze(t,i)}return null}getWalker(e={}){return e.boundaries=this,new $e(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new ze(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new $e(e);for(const i of t)yield i.item}*getPositions(e={}){e.boundaries=this;const t=new $e(e);yield t.position;for(const i of t)yield i.nextPosition}is(e){return"range"===e||"view:range"===e}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,i,o){return new this(new Fe(e,t),new Fe(i,o))}static _createFromPositionAndShift(e,t){const i=e,o=e.getShiftedBy(t);return t>0?new this(i,o):new this(o,i)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Fe._createBefore(e),t)}}function Ze(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function He(e){let t=0;for(const i of e)t++;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ue{constructor(e=null,t,i){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,t,i)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1],t=this._lastRangeBackward?e.end:e.start;return t.clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1],t=this._lastRangeBackward?e.start:e.end;return t.clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel)return!1;if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let i=!1;for(const o of e._ranges)if(t.isEqual(o)){i=!0;break}if(!i)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=He(this.getRanges()),i=He(e.getRanges());if(t!=i)return!1;if(0==t)return!0;for(let o of this.getRanges()){o=o.getTrimmed();let t=!1;for(let i of e.getRanges())if(i=i.getTrimmed(),o.start.isEqual(i.start)&&o.end.isEqual(i.end)){t=!0;break}if(!t)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(e,t,i){if(null===e)this._setRanges([]),this._setFakeOptions(t);else if(e instanceof Ue||e instanceof We)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof ze)this._setRanges([e],t&&t.backward),this._setFakeOptions(t);else if(e instanceof Fe)this._setRanges([new ze(e)]),this._setFakeOptions(t);else if(e instanceof q){const o=!!i&&!!i.backward;let n;if(void 0===t)throw new S.ZP("view-selection-setto-required-second-parameter",this);n="in"==t?ze._createIn(e):"on"==t?ze._createOn(e):new ze(Fe._createAt(e,t)),this._setRanges([n],o),this._setFakeOptions(i)}else{if(!(0,J.Z)(e))throw new S.ZP("view-selection-setto-not-selectable",this);this._setRanges(e,t&&t.backward),this._setFakeOptions(t)}this.fire("change")}setFocus(e,t){if(null===this.anchor)throw new S.ZP("view-selection-setfocus-no-ranges",this);const i=Fe._createAt(e,t);if("same"==i.compareWith(this.focus))return;const o=this.anchor;this._ranges.pop(),"before"==i.compareWith(o)?this._addRange(new ze(i,o),!0):this._addRange(new ze(o,i)),this.fire("change")}is(e){return"selection"===e||"view:selection"===e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const i of e)this._addRange(i);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof ze))throw new S.ZP("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new S.ZP("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new ze(e.start,e.end))}}(0,N.Z)(Ue,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class We{constructor(e=null,t,i){this._selection=new Ue,this._selection.delegate("change").to(this),this._selection.setTo(e,t,i)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}is(e){return"selection"===e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e}_setTo(e,t,i){this._selection.setTo(e,t,i)}_setFocus(e,t){this._selection.setFocus(e,t)}}(0,N.Z)(We,T.ZP);var qe=i(48810);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ge extends qe.Z{constructor(e,t,i){super(e,t),this.startRange=i,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const je=Symbol("bubbling contexts"),Ke={fire(e,...t){try{const i=e instanceof qe.Z?e:new qe.Z(this,e),o=et(this);if(!o.size)return;if(Ye(i,"capturing",this),Qe(o,"$capture",i,...t))return i.return;const n=i.startRange||this.selection.getFirstRange(),s=n?n.getContainedElement():null,r=!!s&&Boolean(Xe(o,s));let a=s||tt(n);if(Ye(i,"atTarget",a),!r){if(Qe(o,"$text",i,...t))return i.return;Ye(i,"bubbling",a)}while(a){if(a.is("rootElement")){if(Qe(o,"$root",i,...t))return i.return}else if(a.is("element")&&Qe(o,a.name,i,...t))return i.return;if(Qe(o,a,i,...t))return i.return;a=a.parent,Ye(i,"bubbling",a)}return Ye(i,"bubbling",this),Qe(o,"$document",i,...t),i.return}catch(i){S.ZP.rethrowUnexpectedError(i,this)}},_addEventListener(e,t,i){const o=(0,D.Z)(i.context||"$document"),n=et(this);for(const s of o){let o=n.get(s);o||(o=Object.create(T.ZP),n.set(s,o)),this.listenTo(o,e,t,i)}},_removeEventListener(e,t){const i=et(this);for(const o of i.values())this.stopListening(o,e,t)}};var Je=Ke;function Ye(e,t,i){e instanceof Ge&&(e._eventPhase=t,e._currentTarget=i)}function Qe(e,t,i,...o){const n="string"==typeof t?e.get(t):Xe(e,t);return!!n&&(n.fire(i,...o),i.stop.called)}function Xe(e,t){for(const[i,o]of e)if("function"==typeof i&&i(t))return o;return null}function et(e){return e[je]||(e[je]=new Map),e[je]}function tt(e){if(!e)return null;const t=e.start.parent,i=e.end.parent,o=t.getPath(),n=i.getPath();return o.length>n.length?t:i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class it{constructor(e){this.selection=new We,this.roots=new P.Z({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map((e=>e.destroy())),this.stopListening()}_callPostFixers(e){let t=!1;do{for(const i of this._postFixers)if(t=i(e),t)break}while(t)}}(0,N.Z)(it,Je),(0,N.Z)(it,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ot=10;class nt extends Te{constructor(e,t,i,o){super(e,t,i,o),this.getFillerOffset=st,this._priority=ot,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new S.ZP("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}is(e,t=null){return t?t===this.name&&("attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e):"attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}function st(){if(rt(this))return null;let e=this.parent;while(e&&e.is("attributeElement")){if(rt(e)>1)return null;e=e.parent}return!e||rt(e)>1?null:this.childCount}function rt(e){return Array.from(e.getChildren()).filter((e=>!e.is("uiElement"))).length}nt.DEFAULT_PRIORITY=ot;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class at extends Te{constructor(e,t,i,o){super(e,t,i,o),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=lt}is(e,t=null){return t?t===this.name&&("emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e):"emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new S.ZP("view-emptyelement-cannot-add",[this,t])}}function lt(){return null}var ct=i(41700);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dt extends Te{constructor(e,t,i,o){super(e,t,i,o),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=ut}is(e,t=null){return t?t===this.name&&("uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e):"uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new S.ZP("view-uielement-cannot-add",this)}render(e){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const i of this.getAttributeKeys())t.setAttribute(i,this.getAttribute(i));return t}}function ht(e){e.document.on("arrowKey",((t,i)=>mt(t,i,e.domConverter)),{priority:"low"})}function ut(){return null}function mt(e,t,i){if(t.keyCode==ct.Do.arrowright){const e=t.domTarget.ownerDocument.defaultView.getSelection(),o=1==e.rangeCount&&e.getRangeAt(0).collapsed;if(o||t.shiftKey){const t=e.focusNode,n=e.focusOffset,s=i.domPositionToView(t,n);if(null===s)return;let r=!1;const a=s.getLastMatchingPosition((e=>(e.item.is("uiElement")&&(r=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement")))));if(r){const t=i.viewPositionToDom(a);o?e.collapse(t.parent,t.offset):e.extend(t.parent,t.offset)}}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gt extends Te{constructor(e,t,i,o){super(e,t,i,o),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=pt}is(e,t=null){return t?t===this.name&&("rawElement"===e||"view:rawElement"===e||"element"===e||"view:element"===e):"rawElement"===e||"view:rawElement"===e||e===this.name||e==="view:"+this.name||"element"===e||"view:element"===e||"node"===e||"view:node"===e}_insertChild(e,t){if(t&&(t instanceof q||Array.from(t).length>0))throw new S.ZP("view-rawelement-cannot-add",[this,t])}}function pt(){return null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ft{constructor(e,t){this.document=e,this._children=[],t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"view:documentFragment"===e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let i=0;const o=wt(this.document,t);for(const n of o)null!==n.parent&&n._remove(),n.parent=this,this._children.splice(e,0,n),e++,i++;return i}_removeChildren(e,t=1){this._fireChange("children",this);for(let i=e;i<e+t;i++)this._children[i].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}}function wt(e,t){return"string"==typeof t?[new G(e,t)]:((0,J.Z)(t)||(t=[t]),Array.from(t).map((t=>"string"==typeof t?new G(e,t):t instanceof j?new G(e,t.data):t)))}(0,N.Z)(ft,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bt{constructor(e){this.document=e,this._cloneGroups=new Map}setSelection(e,t,i){this.document.selection._setTo(e,t,i)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new ft(this.document,e)}createText(e){return new G(this.document,e)}createAttributeElement(e,t,i={}){const o=new nt(this.document,e,t);return"number"===typeof i.priority&&(o._priority=i.priority),i.id&&(o._id=i.id),i.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),o}createContainerElement(e,t,i={}){const o=new Re(this.document,e,t);return void 0!==i.isAllowedInsideAttributeElement&&(o._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),i.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),o}createEditableElement(e,t,i={}){const o=new Me(this.document,e,t);return o._document=this.document,i.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),o}createEmptyElement(e,t,i={}){const o=new at(this.document,e,t);return void 0!==i.isAllowedInsideAttributeElement&&(o._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),i.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),o}createUIElement(e,t,i,o={}){const n=new dt(this.document,e,t);return i&&(n.render=i),void 0!==o.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=o.isAllowedInsideAttributeElement),n}createRawElement(e,t,i,o={}){const n=new gt(this.document,e,t);return n.render=i||(()=>{}),void 0!==o.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=o.isAllowedInsideAttributeElement),o.renderUnsafeAttributes&&n._unsafeAttributesToRender.push(...o.renderUnsafeAttributes),n}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){(0,v.Z)(e)&&void 0===i&&(i=t),i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Fe?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new S.ZP("view-writer-break-non-container-element",this.document);if(!t.parent)throw new S.ZP("view-writer-break-root",this.document);if(e.isAtStart)return Fe._createBefore(t);if(!e.isAtEnd){const i=t._clone(!1);this.insert(Fe._createAfter(t),i);const o=new ze(e,Fe._createAt(t,"end")),n=new Fe(i,0);this.move(o,n)}return Fe._createAfter(t)}mergeAttributes(e){const t=e.offset,i=e.parent;if(i.is("$text"))return e;if(i.is("attributeElement")&&0===i.childCount){const e=i.parent,t=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new Fe(e,t))}const o=i.getChild(t-1),n=i.getChild(t);if(!o||!n)return e;if(o.is("$text")&&n.is("$text"))return xt(o,n);if(o.is("attributeElement")&&n.is("attributeElement")&&o.isSimilar(n)){const e=o.childCount;return o._appendChild(n.getChildren()),n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Fe(o,e))}return e}mergeContainers(e){const t=e.nodeBefore,i=e.nodeAfter;if(!t||!i||!t.is("containerElement")||!i.is("containerElement"))throw new S.ZP("view-writer-merge-containers-invalid-position",this.document);const o=t.getChild(t.childCount-1),n=o instanceof G?Fe._createAt(o,"end"):Fe._createAt(t,"end");return this.move(ze._createIn(i),Fe._createAt(t,"end")),this.remove(ze._createOn(i)),n}insert(e,t){t=(0,J.Z)(t)?[...t]:[t],Vt(t,this.document);const i=t.reduce(((e,t)=>{const i=e[e.length-1],o=!(t.is("uiElement")&&t.isAllowedInsideAttributeElement);return i&&i.breakAttributes==o?i.nodes.push(t):e.push({breakAttributes:o,nodes:[t]}),e}),[]);let o=null,n=e;for(const{nodes:s,breakAttributes:r}of i){const e=this._insertNodes(n,s,r);o||(o=e.start),n=e.end}return o?new ze(o,n):new ze(e)}remove(e){const t=e instanceof ze?e:ze._createOn(e);if(Pt(t,this.document),t.isCollapsed)return new ft(this.document);const{start:i,end:o}=this._breakAttributesRange(t,!0),n=i.parent,s=o.offset-i.offset,r=n._removeChildren(i.offset,s);for(const l of r)this._removeFromClonedElementsGroup(l);const a=this.mergeAttributes(i);return t.start=a,t.end=a.clone(),new ft(this.document,r)}clear(e,t){Pt(e,this.document);const i=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const o of i){const i=o.item;let n;if(i.is("element")&&t.isSimilar(i))n=ze._createOn(i);else if(!o.nextPosition.isAfter(e.start)&&i.is("$textProxy")){const e=i.getAncestors().find((e=>e.is("element")&&t.isSimilar(e)));e&&(n=ze._createIn(e))}n&&(n.end.isAfter(e.end)&&(n.end=e.end),n.start.isBefore(e.start)&&(n.start=e.start),this.remove(n))}}move(e,t){let i;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const o=t.parent,n=o.childCount;e=this._breakAttributesRange(e,!0),i=this.remove(e),t.offset+=o.childCount-n}else i=this.remove(e);return this.insert(t,i)}wrap(e,t){if(!(t instanceof nt))throw new S.ZP("view-writer-wrap-invalid-attribute",this.document);if(Pt(e,this.document),e.isCollapsed){let i=e.start;i.parent.is("element")&&!_t(i.parent)&&(i=i.getLastMatchingPosition((e=>e.item.is("uiElement")))),i=this._wrapPosition(i,t);const o=this.document.selection;return o.isCollapsed&&o.getFirstPosition().isEqual(e.start)&&this.setSelection(i),new ze(i)}return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof nt))throw new S.ZP("view-writer-unwrap-invalid-attribute",this.document);if(Pt(e,this.document),e.isCollapsed)return e;const{start:i,end:o}=this._breakAttributesRange(e,!0),n=i.parent,s=this._unwrapChildren(n,i.offset,o.offset,t),r=this.mergeAttributes(s.start);r.isEqual(s.start)||s.end.offset--;const a=this.mergeAttributes(s.end);return new ze(r,a)}rename(e,t){const i=new Re(this.document,e,t.getAttributes());return this.insert(Fe._createAfter(t),i),this.move(ze._createIn(t),Fe._createAt(i,0)),this.remove(ze._createOn(t)),i}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Fe._createAt(e,t)}createPositionAfter(e){return Fe._createAfter(e)}createPositionBefore(e){return Fe._createBefore(e)}createRange(e,t){return new ze(e,t)}createRangeOn(e){return ze._createOn(e)}createRangeIn(e){return ze._createIn(e)}createSelection(e,t,i){return new Ue(e,t,i)}_insertNodes(e,t,i){let o,n;if(o=i?vt(e):e.parent.is("$text")?e.parent.parent:e.parent,!o)throw new S.ZP("view-writer-invalid-position-container",this.document);n=i?this._breakAttributes(e,!0):e.parent.is("$text")?kt(e):e;const s=o._insertChild(n.offset,t);for(const c of t)this._addToClonedElementsGroup(c);const r=n.getShiftedBy(s),a=this.mergeAttributes(n);a.isEqual(n)||r.offset--;const l=this.mergeAttributes(r);return new ze(a,l)}_wrapChildren(e,t,i,o){let n=t;const s=[];while(n<i){const t=e.getChild(n),i=t.is("$text"),r=t.is("attributeElement"),a=t.isAllowedInsideAttributeElement;if(r&&this._wrapAttributeElement(o,t))s.push(new Fe(e,n));else if(i||a||r&&yt(o,t)){const i=o._clone();t._remove(),i._appendChild(t),e._insertChild(n,i),this._addToClonedElementsGroup(i),s.push(new Fe(e,n))}else r&&this._wrapChildren(t,0,t.childCount,o);n++}let r=0;for(const a of s){if(a.offset-=r,a.offset==t)continue;const e=this.mergeAttributes(a);e.isEqual(a)||(r++,i--)}return ze._createFromParentsAndOffsets(e,t,e,i)}_unwrapChildren(e,t,i,o){let n=t;const s=[];while(n<i){const t=e.getChild(n);if(t.is("attributeElement"))if(t.isSimilar(o)){const o=t.getChildren(),r=t.childCount;t._remove(),e._insertChild(n,o),this._removeFromClonedElementsGroup(t),s.push(new Fe(e,n),new Fe(e,n+r)),n+=r,i+=r-1}else this._unwrapAttributeElement(o,t)?(s.push(new Fe(e,n),new Fe(e,n+1)),n++):(this._unwrapChildren(t,0,t.childCount,o),n++);else n++}let r=0;for(const a of s){if(a.offset-=r,a.offset==t||a.offset==i)continue;const e=this.mergeAttributes(a);e.isEqual(a)||(r++,i--)}return ze._createFromParentsAndOffsets(e,t,e,i)}_wrapRange(e,t){const{start:i,end:o}=this._breakAttributesRange(e,!0),n=i.parent,s=this._wrapChildren(n,i.offset,o.offset,t),r=this.mergeAttributes(s.start);r.isEqual(s.start)||s.end.offset--;const a=this.mergeAttributes(s.end);return new ze(r,a)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return Ct(e.clone());e.parent.is("$text")&&(e=kt(e));const i=this.createAttributeElement();i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,e.parent._insertChild(e.offset,i);const o=new ze(e,e.getShiftedBy(1));this.wrap(o,t);const n=new Fe(i.parent,i.index);i._remove();const s=n.nodeBefore,r=n.nodeAfter;return s instanceof G&&r instanceof G?xt(s,r):Ct(n)}_wrapAttributeElement(e,t){if(!St(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if("class"!==i&&"style"!==i&&t.hasAttribute(i)&&t.getAttribute(i)!==e.getAttribute(i))return!1;for(const i of e.getStyleNames())if(t.hasStyle(i)&&t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())"class"!==i&&"style"!==i&&(t.hasAttribute(i)||this.setAttribute(i,e.getAttribute(i),t));for(const i of e.getStyleNames())t.hasStyle(i)||this.setStyle(i,e.getStyle(i),t);for(const i of e.getClassNames())t.hasClass(i)||this.addClass(i,t);return!0}_unwrapAttributeElement(e,t){if(!St(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if("class"!==i&&"style"!==i&&(!t.hasAttribute(i)||t.getAttribute(i)!==e.getAttribute(i)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const i of e.getStyleNames())if(!t.hasStyle(i)||t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())"class"!==i&&"style"!==i&&this.removeAttribute(i,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const i=e.start,o=e.end;if(Pt(e,this.document),e.isCollapsed){const i=this._breakAttributes(e.start,t);return new ze(i,i)}const n=this._breakAttributes(o,t),s=n.parent.childCount,r=this._breakAttributes(i,t);return n.offset+=n.parent.childCount-s,new ze(r,n)}_breakAttributes(e,t=!1){const i=e.offset,o=e.parent;if(e.parent.is("emptyElement"))throw new S.ZP("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new S.ZP("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new S.ZP("view-writer-cannot-break-raw-element",this.document);if(!t&&o.is("$text")&&At(o.parent))return e.clone();if(At(o))return e.clone();if(o.is("$text"))return this._breakAttributes(kt(e),t);const n=o.childCount;if(i==n){const e=new Fe(o.parent,o.index+1);return this._breakAttributes(e,t)}if(0===i){const e=new Fe(o.parent,o.index);return this._breakAttributes(e,t)}{const e=o.index+1,n=o._clone();o.parent._insertChild(e,n),this._addToClonedElementsGroup(n);const s=o.childCount-i,r=o._removeChildren(i,s);n._appendChild(r);const a=new Fe(o.parent,e);return this._breakAttributes(a,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const o of e.getChildren())this._addToClonedElementsGroup(o);const t=e.id;if(!t)return;let i=this._cloneGroups.get(t);i||(i=new Set,this._cloneGroups.set(t,i)),i.add(e),e._clonesGroup=i}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const o of e.getChildren())this._removeFromClonedElementsGroup(o);const t=e.id;if(!t)return;const i=this._cloneGroups.get(t);i&&i.delete(e)}}function _t(e){return Array.from(e.getChildren()).some((e=>!e.is("uiElement")))}function vt(e){let t=e.parent;while(!At(t)){if(!t)return;t=t.parent}return t}function yt(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity()}function Ct(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new Fe(t,t.data.length);const i=e.nodeAfter;return i&&i.is("$text")?new Fe(i,0):e}function kt(e){if(e.offset==e.parent.data.length)return new Fe(e.parent.parent,e.parent.index+1);if(0===e.offset)return new Fe(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new G(e.root.document,t)),new Fe(e.parent.parent,e.parent.index+1)}function xt(e,t){const i=e.data.length;return e._data+=t.data,t._remove(),new Fe(e,i)}function Vt(e,t){for(const i of e){if(!Et.some((e=>i instanceof e)))throw new S.ZP("view-writer-insert-invalid-node-type",t);i.is("$text")||Vt(i.getChildren(),t)}}const Et=[G,nt,Re,at,gt,dt];function At(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function Pt(e,t){const i=vt(e.start),o=vt(e.end);if(!i||!o||i!==o)throw new S.ZP("view-writer-invalid-range-container",t)}function St(e,t){return null===e.id&&null===t.id}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Tt(e){return"[object Text]"==Object.prototype.toString.call(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Nt=e=>e.createTextNode(" "),It=e=>{const t=e.createElement("span");return t.dataset.ckeFiller=!0,t.innerHTML=" ",t},Dt=e=>{const t=e.createElement("br");return t.dataset.ckeFiller=!0,t},Rt=7,Bt="⁠".repeat(Rt);function Mt(e){return Tt(e)&&e.data.substr(0,Rt)===Bt}function Ot(e){return e.data.length==Rt&&Mt(e)}function Lt(e){return Mt(e)?e.data.slice(Rt):e.data}function $t(e){e.document.on("arrowKey",Ft,{priority:"low"})}function Ft(e,t){if(t.keyCode==ct.Do.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(1==e.rangeCount&&e.getRangeAt(0).collapsed){const t=e.getRangeAt(0).startContainer,i=e.getRangeAt(0).startOffset;Mt(t)&&i<=Rt&&e.collapse(t,0)}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zt(e,t,i,o=!1){i=i||function(e,t){return e===t},Array.isArray(e)||(e=Array.prototype.slice.call(e)),Array.isArray(t)||(t=Array.prototype.slice.call(t));const n=Zt(e,t,i);return o?qt(n,t.length):Wt(t,n)}function Zt(e,t,i){const o=Ht(e,t,i);if(-1===o)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const n=Ut(e,o),s=Ut(t,o),r=Ht(n,s,i),a=e.length-r,l=t.length-r;return{firstIndex:o,lastIndexOld:a,lastIndexNew:l}}function Ht(e,t,i){for(let o=0;o<Math.max(e.length,t.length);o++)if(void 0===e[o]||void 0===t[o]||!i(e[o],t[o]))return o;return-1}function Ut(e,t){return e.slice(t).reverse()}function Wt(e,t){const i=[],{firstIndex:o,lastIndexOld:n,lastIndexNew:s}=t;return s-o>0&&i.push({index:o,type:"insert",values:e.slice(o,s)}),n-o>0&&i.push({index:o+(s-o),type:"delete",howMany:n-o}),i}function qt(e,t){const{firstIndex:i,lastIndexOld:o,lastIndexNew:n}=e;if(-1===i)return Array(t).fill("equal");let s=[];return i>0&&(s=s.concat(Array(i).fill("equal"))),n-i>0&&(s=s.concat(Array(n-i).fill("insert"))),o-i>0&&(s=s.concat(Array(o-i).fill("delete"))),n<t&&(s=s.concat(Array(t-n).fill("equal"))),s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gt(e,t,i){i=i||function(e,t){return e===t};const o=e.length,n=t.length;if(o>200||n>200||o+n>300)return Gt.fastDiff(e,t,i,!0);let s,r;if(n<o){const i=e;e=t,t=i,s="delete",r="insert"}else s="insert",r="delete";const a=e.length,l=t.length,c=l-a,d={},h={};function u(o){const n=(void 0!==h[o-1]?h[o-1]:-1)+1,c=void 0!==h[o+1]?h[o+1]:-1,u=n>c?-1:1;d[o+u]&&(d[o]=d[o+u].slice(0)),d[o]||(d[o]=[]),d[o].push(n>c?s:r);let m=Math.max(n,c),g=m-o;while(g<a&&m<l&&i(e[g],t[m]))g++,m++,d[o].push("equal");return m}let m,g=0;do{for(m=-g;m<c;m++)h[m]=u(m);for(m=c+g;m>c;m--)h[m]=u(m);h[c]=u(c),g++}while(h[c]!==l);return d[c].slice(1)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jt(e,t,i){e.insertBefore(i,e.childNodes[t]||null)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Kt(e){const t=e.parentNode;t&&t.removeChild(e)}Gt.fastDiff=zt;var Jt=i(4817),Yt=i(91704);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qt{constructor(e,t){this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),Yt.ZP.isBlink&&!Yt.ZP.isAndroid&&this.on("change:isSelecting",(()=>{this.isSelecting||this.render()})),this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new S.ZP("view-renderer-unknown-type",this);this.markedChildren.add(t)}}}render(){let e;const t=!(Yt.ZP.isBlink&&!Yt.ZP.isAndroid)||!this.isSelecting;for(const i of this.markedChildren)this._updateChildrenMappings(i);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller));for(const i of this.markedAttributes)this._updateAttrs(i);for(const i of this.markedChildren)this._updateChildren(i,{inlineFillerPosition:e});for(const i of this.markedTexts)!this.markedChildren.has(i.parent)&&this.domConverter.mapViewToDom(i.parent)&&this._updateText(i,{inlineFillerPosition:e});if(t)if(e){const t=this.domConverter.viewPositionToDom(e),i=t.parent.ownerDocument;Mt(t.parent)?this._inlineFiller=t.parent:this._inlineFiller=ei(i,t.parent,t.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(this.domConverter.mapViewToDom(e).childNodes),o=Array.from(this.domConverter.viewChildrenToDom(e,t.ownerDocument,{withChildren:!1})),n=this._diffNodeLists(i,o),s=this._findReplaceActions(n,i,o);if(-1!==s.indexOf("replace")){const t={equal:0,insert:0,delete:0};for(const n of s)if("replace"===n){const n=t.equal+t.insert,s=t.equal+t.delete,r=e.getChild(n);!r||r.is("uiElement")||r.is("rawElement")||this._updateElementMappings(r,i[s]),Kt(o[n]),t.equal++}else t[n]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Fe._createBefore(this.selection.getFirstPosition().parent):e}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&Tt(t.parent)&&Mt(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Mt(e))throw new S.ZP("view-renderer-filler-was-lost",this);Ot(e)?e.remove():e.data=e.data.substr(Rt),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,i=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!Xt(t))return!1;if(i===t.getFillerOffset())return!1;const o=e.nodeBefore,n=e.nodeAfter;return!(o instanceof G||n instanceof G)}_updateText(e,t){const i=this.domConverter.findCorrespondingDomText(e),o=this.domConverter.viewToDom(e,i.ownerDocument),n=i.data;let s=o.data;const r=t.inlineFillerPosition;if(r&&r.parent==e.parent&&r.offset==e.index&&(s=Bt+s),n!=s){const e=zt(n,s);for(const t of e)"insert"===t.type?i.insertData(t.index,t.values.join("")):i.deleteData(t.index,t.howMany)}}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(t.attributes).map((e=>e.name)),o=e.getAttributeKeys();for(const n of o)this.domConverter.setDomElementAttribute(t,n,e.getAttribute(n),e);for(const n of i)e.hasAttribute(n)||this.domConverter.removeDomElementAttribute(t,n)}_updateChildren(e,t){const i=this.domConverter.mapViewToDom(e);if(!i)return;const o=t.inlineFillerPosition,n=this.domConverter.mapViewToDom(e).childNodes,s=Array.from(this.domConverter.viewChildrenToDom(e,i.ownerDocument,{bind:!0}));o&&o.parent===e&&ei(i.ownerDocument,s,o.offset);const r=this._diffNodeLists(n,s);let a=0;const l=new Set;for(const c of r)"delete"===c?(l.add(n[a]),Kt(n[a])):"equal"===c&&a++;a=0;for(const c of r)"insert"===c?(jt(i,a,s[a]),a++):"equal"===c&&(this._markDescendantTextToSync(this.domConverter.domToView(s[a])),a++);for(const c of l)c.parentNode||this.domConverter.unbindDomElement(c)}_diffNodeLists(e,t){return e=ni(e,this._fakeSelectionContainer),Gt(e,t,ii.bind(null,this.domConverter))}_findReplaceActions(e,t,i){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;let o=[],n=[],s=[];const r={equal:0,insert:0,delete:0};for(const a of e)"insert"===a?s.push(i[r.equal+r.insert]):"delete"===a?n.push(t[r.equal+r.delete]):(o=o.concat(Gt(n,s,ti).map((e=>"equal"===e?"replace":e))),o.push("equal"),n=[],s=[]),r[a]++;return o.concat(Gt(n,s,ti).map((e=>"equal"===e?"replace":e)))}_markDescendantTextToSync(e){if(e)if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}_updateSelection(){if(Yt.ZP.isBlink&&!Yt.ZP.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e&&(this.selection.isFake?this._updateFakeSelection(e):(this._removeFakeSelection(),this._updateDomSelection(e)))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=si(t));const i=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(i,this.selection),!this._fakeSelectionNeedsUpdate(e))return;i.parentElement&&i.parentElement==e||e.appendChild(i),i.textContent=this.selection.fakeSelectionLabel||" ";const o=t.getSelection(),n=t.createRange();o.removeAllRanges(),n.selectNodeContents(i),o.addRange(n)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const i=this.domConverter.viewPositionToDom(this.selection.anchor),o=this.domConverter.viewPositionToDom(this.selection.focus);t.collapse(i.parent,i.offset),t.extend(o.parent,o.offset),Yt.ZP.isGecko&&oi(o,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return(!t||!this.selection.isEqual(t))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,i=e.ownerDocument.getSelection();return!t||t.parentElement!==e||(i.anchorNode!==t&&!t.contains(i.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel)}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const t=e.activeElement,i=this.domConverter.mapDomToView(t);t&&i&&e.getSelection().removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function Xt(e){if("false"==e.getAttribute("contenteditable"))return!1;const t=e.findAncestor((e=>e.hasAttribute("contenteditable")));return!t||"true"==t.getAttribute("contenteditable")}function ei(e,t,i){const o=t instanceof Array?t:t.childNodes,n=o[i];if(Tt(n))return n.data=Bt+n.data,n;{const n=e.createTextNode(Bt);return Array.isArray(t)?o.splice(i,0,n):jt(t,i,n),n}}function ti(e,t){return(0,Jt.Z)(e)&&(0,Jt.Z)(t)&&!Tt(e)&&!Tt(t)&&e.nodeType!==Node.COMMENT_NODE&&t.nodeType!==Node.COMMENT_NODE&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function ii(e,t,i){return t===i||(Tt(t)&&Tt(i)?t.data===i.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(i)))}function oi(e,t){const i=e.parent;if(i.nodeType!=Node.ELEMENT_NODE||e.offset!=i.childNodes.length-1)return;const o=i.childNodes[e.offset];o&&"BR"==o.tagName&&t.addRange(t.getRangeAt(0))}function ni(e,t){const i=Array.from(e);if(0==i.length||!t)return i;const o=i[i.length-1];return o==t&&i.pop(),i}function si(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}(0,N.Z)(Qt,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */var ri={window:window,document:document};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ai(e){let t=0;while(e.previousSibling)e=e.previousSibling,t++;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function li(e){const t=[];while(e&&e.nodeType!=Node.DOCUMENT_NODE)t.unshift(e),e=e.parentNode;return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ci=Dt(document),di=Nt(document),hi=It(document),ui="data-ck-unsafe-attribute-",mi="data-ck-unsafe-element";class gi{constructor(e,t={}){this.document=e,this.renderingMode=t.renderingMode||"editing",this.blockFillerMode=t.blockFillerMode||("editing"===this.renderingMode?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new Q,this._encounteredRawContentDomNodes=new WeakSet}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Ue(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const t of e.childNodes)this.unbindDomElement(t)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,i){return"data"===this.renderingMode||(e=e.toLowerCase(),!e.startsWith("on")&&(("srcdoc"!==e||!t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i))&&("img"===i&&("src"===e||"srcset"===e)||("source"===i&&"srcset"===e||!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i)))))}setContentOf(e,t){if("data"===this.renderingMode)return void(e.innerHTML=t);const i=(new DOMParser).parseFromString(t,"text/html"),o=i.createDocumentFragment(),n=i.body.childNodes;while(n.length>0)o.appendChild(n[0]);const s=i.createTreeWalker(o,NodeFilter.SHOW_ELEMENT),r=[];let a;while(a=s.nextNode())r.push(a);for(const l of r){for(const t of l.getAttributeNames())this.setDomElementAttribute(l,t,l.getAttribute(t));const e=l.tagName.toLowerCase();this._shouldRenameElement(e)&&((0,S.KE)("domconverter-unsafe-element-detected",{unsafeElement:l}),l.replaceWith(this._createReplacementDomElement(e,l)))}while(e.firstChild)e.firstChild.remove();e.append(o)}viewToDom(e,t,i={}){if(e.is("$text")){const i=this._processDataFromViewText(e);return t.createTextNode(i)}{if(this.mapViewToDom(e))return this.mapViewToDom(e);let o;if(e.is("documentFragment"))o=t.createDocumentFragment(),i.bind&&this.bindDocumentFragments(o,e);else{if(e.is("uiElement"))return o="$comment"===e.name?t.createComment(e.getCustomProperty("$rawContent")):e.render(t,this),i.bind&&this.bindElements(o,e),o;this._shouldRenameElement(e.name)?((0,S.KE)("domconverter-unsafe-element-detected",{unsafeElement:e}),o=this._createReplacementDomElement(e.name)):o=e.hasAttribute("xmlns")?t.createElementNS(e.getAttribute("xmlns"),e.name):t.createElement(e.name),e.is("rawElement")&&e.render(o,this),i.bind&&this.bindElements(o,e);for(const t of e.getAttributeKeys())this.setDomElementAttribute(o,t,e.getAttribute(t),e)}if(!1!==i.withChildren)for(const n of this.viewChildrenToDom(e,t,i))o.appendChild(n);return o}}setDomElementAttribute(e,t,i,o=null){const n=this.shouldRenderAttribute(t,i,e.tagName.toLowerCase())||o&&o.shouldRenderUnsafeAttribute(t);n||(0,S.KE)("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:i}),e.hasAttribute(t)&&!n?e.removeAttribute(t):e.hasAttribute(ui+t)&&n&&e.removeAttribute(ui+t),e.setAttribute(n?t:ui+t,i)}removeDomElementAttribute(e,t){t!=mi&&(e.removeAttribute(t),e.removeAttribute(ui+t))}*viewChildrenToDom(e,t,i={}){const o=e.getFillerOffset&&e.getFillerOffset();let n=0;for(const s of e.getChildren())o===n&&(yield this._getBlockFiller(t)),yield this.viewToDom(s,t,i),n++;o===n&&(yield this._getBlockFiller(t))}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),i=this.viewPositionToDom(e.end),o=document.createRange();return o.setStart(t.parent,t.offset),o.setEnd(i.parent,i.offset),o}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const i=this.findCorrespondingDomText(t);if(!i)return null;let o=e.offset;return Mt(i)&&(o+=Rt),{parent:i,offset:o}}{let i,o,n;if(0===e.offset){if(i=this.mapViewToDom(t),!i)return null;n=i.childNodes[0]}else{const t=e.nodeBefore;if(o=t.is("$text")?this.findCorrespondingDomText(t):this.mapViewToDom(e.nodeBefore),!o)return null;i=o.parentNode,n=o.nextSibling}if(Tt(n)&&Mt(n))return{parent:n,offset:Rt};const s=o?ai(o)+1:0;return{parent:i,offset:s}}}domToView(e,t={}){if(this.isBlockFiller(e))return null;const i=this.getHostViewElement(e);if(i)return i;if(this.isComment(e)&&t.skipComments)return null;if(Tt(e)){if(Ot(e))return null;{const t=this._processDataFromDomText(e);return""===t?null:new G(this.document,t)}}{if(this.mapDomToView(e))return this.mapDomToView(e);let i;if(this.isDocumentFragment(e))i=new ft(this.document),t.bind&&this.bindDocumentFragments(e,i);else{i=this._createViewElement(e,t),t.bind&&this.bindElements(e,i);const o=e.attributes;if(o)for(let e=o.length-1;e>=0;e--)i._setAttribute(o[e].name,o[e].value);if(this._isViewElementWithRawContent(i,t)||this.isComment(e)){const t=this.isComment(e)?e.data:e.innerHTML;return i._setCustomProperty("$rawContent",t),this._encounteredRawContentDomNodes.add(e),i}}if(!1!==t.withChildren)for(const o of this.domChildrenToView(e,t))i._appendChild(o);return i}}*domChildrenToView(e,t={}){for(let i=0;i<e.childNodes.length;i++){const o=e.childNodes[i],n=this.domToView(o,t);null!==n&&(yield n)}}domSelectionToView(e){if(1===e.rangeCount){let t=e.getRangeAt(0).startContainer;Tt(t)&&(t=t.parentNode);const i=this.fakeSelectionToView(t);if(i)return i}const t=this.isDomSelectionBackward(e),i=[];for(let o=0;o<e.rangeCount;o++){const t=e.getRangeAt(o),n=this.domRangeToView(t);n&&i.push(n)}return new Ue(i,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),i=this.domPositionToView(e.endContainer,e.endOffset);return t&&i?new ze(t,i):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,ai(e));const i=this.mapDomToView(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return Fe._createBefore(i);if(Tt(e)){if(Ot(e))return this.domPositionToView(e.parentNode,ai(e));const i=this.findCorrespondingViewText(e);let o=t;return i?(Mt(e)&&(o-=Rt,o=o<0?0:o),new Fe(i,o)):null}if(0===t){const t=this.mapDomToView(e);if(t)return new Fe(t,0)}else{const i=e.childNodes[t-1],o=Tt(i)?this.findCorrespondingViewText(i):this.mapDomToView(i);if(o&&o.parent)return new Fe(o.parent,o.index+1)}return null}mapDomToView(e){const t=this.getHostViewElement(e);return t||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(Ot(e))return null;const t=this.getHostViewElement(e);if(t)return t;const i=e.previousSibling;if(i){if(!this.isElement(i))return null;const e=this.mapDomToView(i);if(e){const t=e.nextSibling;return t instanceof G?e.nextSibling:null}}else{const t=this.mapDomToView(e.parentNode);if(t){const e=t.getChild(0);return e instanceof G?e:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:e,scrollY:i}=ri.window,o=[];fi(t,(e=>{const{scrollLeft:t,scrollTop:i}=e;o.push([t,i])})),t.focus(),fi(t,(e=>{const[t,i]=o.shift();e.scrollLeft=t,e.scrollTop=i})),ri.window.scrollTo(e,i)}}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(e){return e&&e.nodeType==Node.COMMENT_NODE}isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(ci):!("BR"!==e.tagName||!bi(e,this.blockElements)||1!==e.parentNode.childNodes.length)||(e.isEqualNode(hi)||wi(e,this.blockElements))}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=document.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);const i=t.collapsed;return t.detach(),i}getHostViewElement(e){const t=li(e);t.pop();while(t.length){const e=t.pop(),i=this._domToViewMapping.get(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return i}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}_getBlockFiller(e){switch(this.blockFillerMode){case"nbsp":return Nt(e);case"markedNbsp":return It(e);case"br":return Dt(e)}}_isDomSelectionPositionCorrect(e,t){if(Tt(e)&&Mt(e)&&t<Rt)return!1;if(this.isElement(e)&&Mt(e.childNodes[t]))return!1;const i=this.mapDomToView(e);return!i||!i.is("uiElement")&&!i.is("rawElement")}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return t;if(" "==t.charAt(0)){const i=this._getTouchingInlineViewNode(e,!1),o=i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i);!o&&i||(t=" "+t.substr(1))}if(" "==t.charAt(t.length-1)){const i=this._getTouchingInlineViewNode(e,!0),o=i&&i.is("$textProxy")&&" "==i.data.charAt(0);" "!=t.charAt(t.length-2)&&i&&!o||(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return!1;const t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1)}_processDataFromDomText(e){let t=e.data;if(pi(e,this.preElements))return Lt(e);t=t.replace(/[ \n\t\r]{1,}/g," ");const i=this._getTouchingInlineDomNode(e,!1),o=this._getTouchingInlineDomNode(e,!0),n=this._checkShouldLeftTrimDomText(e,i),s=this._checkShouldRightTrimDomText(e,o);n&&(t=t.replace(/^ /,"")),s&&(t=t.replace(/ $/,"")),t=Lt(new Text(t)),t=t.replace(/ \u00A0/g,"  ");const r=o&&this.isElement(o)&&"BR"!=o.tagName,a=o&&Tt(o)&&" "==o.data.charAt(0);return(/( |\u00A0)\u00A0$/.test(t)||!o||r||a)&&(t=t.replace(/\u00A0$/," ")),(n||i&&this.isElement(i)&&"BR"!=i.tagName)&&(t=t.replace(/^\u00A0/," ")),t}_checkShouldLeftTrimDomText(e,t){return!t||(this.isElement(t)?"BR"===t.tagName:!this._encounteredRawContentDomNodes.has(e.previousSibling)&&/[^\S\u00A0]/.test(t.data.charAt(t.data.length-1)))}_checkShouldRightTrimDomText(e,t){return!t&&!Mt(e)}_getTouchingInlineViewNode(e,t){const i=new $e({startPosition:t?Fe._createAfter(e):Fe._createBefore(e),direction:t?"forward":"backward"});for(const o of i){if(o.item.is("element")&&this.inlineObjectElements.includes(o.item.name))return o.item;if(o.item.is("containerElement"))return null;if(o.item.is("element","br"))return null;if(o.item.is("$textProxy"))return o.item}return null}_getTouchingInlineDomNode(e,t){if(!e.parentNode)return null;const i=t?"firstChild":"lastChild",o=t?"nextSibling":"previousSibling";let n=!0;do{if(!n&&e[i]?e=e[i]:e[o]?(e=e[o],n=!1):(e=e.parentNode,n=!0),!e||this._isBlockElement(e))return null}while(!Tt(e)&&"BR"!=e.tagName&&!this._isInlineObjectElement(e));return e}_isBlockElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isInlineObjectElement(e){return this.isElement(e)&&this.inlineObjectElements.includes(e.tagName.toLowerCase())}_createViewElement(e,t){if(this.isComment(e))return new dt(this.document,"$comment");const i=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Te(this.document,i)}_isViewElementWithRawContent(e,t){return!1!==t.withChildren&&this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){return"editing"==this.renderingMode&&"script"==e.toLowerCase()}_createReplacementDomElement(e,t=null){const i=document.createElement("span");if(i.setAttribute(mi,e),t){while(t.firstChild)i.appendChild(t.firstChild);for(const e of t.getAttributeNames())i.setAttribute(e,t.getAttribute(e))}return i}}function pi(e,t){const i=li(e);return i.some((e=>e.tagName&&t.includes(e.tagName.toLowerCase())))}function fi(e,t){while(e&&e!=ri.document)t(e),e=e.parentNode}function wi(e,t){const i=e.isEqualNode(di);return i&&bi(e,t)&&1===e.parentNode.childNodes.length}function bi(e,t){const i=e.parentNode;return i&&i.tagName&&t.includes(i.tagName.toLowerCase())}var _i=i(49981);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vi{constructor(e){this.view=e,this.document=e.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&3===e.nodeType&&(e=e.parentNode),!(!e||1!==e.nodeType)&&e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}(0,N.Z)(vi,_i.Z);var yi=i(2674);function Ci(e,t,i){i="function"==typeof i?i:void 0;var o=i?i(e,t):void 0;return void 0===o?(0,yi.Z)(e,t,void 0,i):!!o}var ki=Ci;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xi extends vi{constructor(e){super(e),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.push(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(0===e.length)return;const t=this.domConverter,i=new Map,o=new Set;for(const l of e)if("childList"===l.type){const e=t.mapDomToView(l.target);if(e&&(e.is("uiElement")||e.is("rawElement")))continue;e&&!this._isBogusBrMutation(l)&&o.add(e)}for(const l of e){const e=t.mapDomToView(l.target);if((!e||!e.is("uiElement")&&!e.is("rawElement"))&&"characterData"===l.type){const e=t.findCorrespondingViewText(l.target);e&&!o.has(e.parent)?i.set(e,{type:"text",oldText:e.data,newText:Lt(l.target),node:e}):!e&&Mt(l.target)&&o.add(t.mapDomToView(l.target.parentNode))}}const n=[];for(const l of i.values())this.renderer.markToSync("text",l.node),n.push(l);for(const l of o){const e=t.mapViewToDom(l),i=Array.from(l.getChildren()),o=Array.from(t.domChildrenToView(e,{withChildren:!1}));ki(i,o,a)||(this.renderer.markToSync("children",l),n.push({type:"children",oldChildren:i,newChildren:o,node:l}))}const s=e[0].target.ownerDocument.getSelection();let r=null;if(s&&s.anchorNode){const e=t.domPositionToView(s.anchorNode,s.anchorOffset),i=t.domPositionToView(s.focusNode,s.focusOffset);e&&i&&(r=new Ue(e),r.setFocus(i))}function a(e,t){if(!Array.isArray(e))return e===t||!(!e.is("$text")||!t.is("$text"))&&e.data===t.data}n.length&&(this.document.fire("mutations",n,r),this.view.forceRender())}_isBogusBrMutation(e){let t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}var Vi=i(80207);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ei{constructor(e,t,i){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,(0,Vi.Z)(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ai extends vi{constructor(e){super(e),this.useCapture=!1}observe(e){const t="string"==typeof this.domEventType?[this.domEventType]:this.domEventType;t.forEach((t=>{this.listenTo(e,t,((e,t)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(t.target)&&this.onDomEvent(t)}),{useCapture:this.useCapture})}))}fire(e,t,i){this.isEnabled&&this.document.fire(e,new Ei(this.view,t,i))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pi extends Ai{constructor(e){super(e),this.domEventType=["keydown","keyup"]}onDomEvent(e){this.fire(e.type,e,{keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return(0,ct.Cq)(this)}})}}var Si=i(8891);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ti extends vi{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=(0,Si.Z)((e=>this.document.fire("selectionChangeDone",e)),200)}observe(){const e=this.document;e.on("arrowKey",((t,i)=>{const o=e.selection;o.isFake&&this.isEnabled&&i.preventDefault()}),{context:"$capture"}),e.on("arrowKey",((t,i)=>{const o=e.selection;o.isFake&&this.isEnabled&&this._handleSelectionMove(i.keyCode)}),{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,i=new Ue(t.getRanges(),{backward:t.isBackward,fake:!1});e!=ct.Do.arrowleft&&e!=ct.Do.arrowup||i.setTo(i.getFirstPosition()),e!=ct.Do.arrowright&&e!=ct.Do.arrowdown||i.setTo(i.getLastPosition());const o={oldSelection:t,newSelection:i,domSelection:null};this.document.fire("selectionChange",o),this._fireSelectionChangeDoneDebounced(o)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ni extends vi{constructor(e){super(e),this.mutationObserver=e.getObserver(xi),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=(0,Si.Z)((e=>this.document.fire("selectionChangeDone",e)),200),this._clearInfiniteLoopInterval=setInterval((()=>this._clearInfiniteLoop()),1e3),this._documentIsSelectingInactivityTimeoutDebounced=(0,Si.Z)((()=>this.document.isSelecting=!1),5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,i=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},o=()=>{this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel()};this.listenTo(e,"selectstart",i,{priority:"highest"}),this.listenTo(e,"keydown",o,{priority:"highest"}),this.listenTo(e,"keyup",o,{priority:"highest"}),this._documents.has(t)||(this.listenTo(t,"mouseup",o,{priority:"highest"}),this.listenTo(t,"selectionchange",((e,i)=>{this._handleSelectionChange(i,t),this._documentIsSelectingInactivityTimeoutDebounced()})),this._documents.add(t))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_handleSelectionChange(e,t){if(!this.isEnabled)return;const i=t.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(i.anchorNode))return;this.mutationObserver.flush();const o=this.domConverter.domSelectionToView(i);if(0!=o.rangeCount){if(this.view.hasDomSelection=!0,(!this.selection.isEqual(o)||!this.domConverter.isDomSelectionCorrect(i))&&!(++this._loopbackCounter>60))if(this.selection.isSimilar(o))this.view.forceRender();else{const e={oldSelection:this.selection,newSelection:o,domSelection:i};this.document.fire("selectionChange",e),this._fireSelectionChangeDoneDebounced(e)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ii extends Ai{constructor(e){super(e),this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",(()=>{t.isFocused=!0,this._renderTimeoutId=setTimeout((()=>e.change((()=>{}))),50)})),t.on("blur",((i,o)=>{const n=t.selection.editableElement;null!==n&&n!==o.target||(t.isFocused=!1,e.change((()=>{})))}))}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Di extends Ai{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",(()=>{t.isComposing=!0})),t.on("compositionend",(()=>{t.isComposing=!1}))}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
class Ri extends Ai{constructor(e){super(e),this.domEventType=["beforeinput"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bi{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach((({element:e,newElement:t})=>{e.style.display="",t&&t.remove()})),this._replacedElements=[]}}var Mi=i(93589),Oi=i(27771),Li="[object String]";function $i(e){return"string"==typeof e||!(0,Oi.Z)(e)&&(0,C.Z)(e)&&(0,Mi.Z)(e)==Li}var Fi=$i;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zi(e,t,i={},o=[]){const n=i&&i.xmlns,s=n?e.createElementNS(n,t):e.createElement(t);for(const r in i)s.setAttribute(r,i[r]);!Fi(o)&&(0,J.Z)(o)||(o=[o]);for(let r of o)Fi(r)&&(r=e.createTextNode(r)),s.appendChild(r);return s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zi(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Hi(e){return"[object Range]"==Object.prototype.toString.apply(e)}var Ui=i(56272);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Wi(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const qi=["top","right","bottom","left","width","height"];class Gi{constructor(e){const t=Hi(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),x(e)||t)if(t){const t=Gi.getDomRangeRects(e);ji(this,Gi.getBoundingRect(t))}else ji(this,e.getBoundingClientRect());else if((0,Ui.Z)(e)){const{innerWidth:t,innerHeight:i}=e;ji(this,{top:0,right:t,bottom:i,left:0,width:t,height:i})}else ji(this,e)}clone(){return new Gi(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0?null:new Gi(t)}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(!Ki(e)){let i=e.parentNode||e.commonAncestorContainer;while(i&&!Ki(i)){const e=new Gi(i),o=t.getIntersection(e);if(!o)return null;o.getArea()<t.getArea()&&(t=o),i=i.parentNode}}return t}isEqual(e){for(const t of qi)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!(!t||!t.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let t,i,o;if((0,Ui.Z)(e))t=e.innerWidth-e.document.documentElement.clientWidth,i=e.innerHeight-e.document.documentElement.clientHeight,o=e.getComputedStyle(e.document.documentElement).direction;else{const n=Wi(this._source);t=e.offsetWidth-e.clientWidth-n.left-n.right,i=e.offsetHeight-e.clientHeight-n.top-n.bottom,o=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=n.left,this.top+=n.top,this.right-=n.right,this.bottom-=n.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,"ltr"===o?this.right-=t:this.left+=t,this.height-=i,this.bottom-=i,this}static getDomRangeRects(e){const t=[],i=Array.from(e.getClientRects());if(i.length)for(const o of i)t.push(new Gi(o));else{let i=e.startContainer;Tt(i)&&(i=i.parentNode);const o=new Gi(i.getBoundingClientRect());o.right=o.left,o.width=0,t.push(o)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY};let i=0;for(const o of e)i++,t.left=Math.min(t.left,o.left),t.top=Math.min(t.top,o.top),t.right=Math.max(t.right,o.right),t.bottom=Math.max(t.bottom,o.bottom);return 0==i?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new Gi(t))}}function ji(e,t){for(const i of qi)e[i]=t[i]}function Ki(e){return!!x(e)&&e===e.ownerDocument.body}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Ji=100;class Yi{constructor(e,t){Yi._observerInstance||Yi._createObserver(),this._element=e,this._callback=t,Yi._addElementCallback(e,t),Yi._observerInstance.observe(e)}destroy(){Yi._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){Yi._elementCallbacks||(Yi._elementCallbacks=new Map);let i=Yi._elementCallbacks.get(e);i||(i=new Set,Yi._elementCallbacks.set(e,i)),i.add(t)}static _deleteElementCallback(e,t){const i=Yi._getElementCallbacks(e);i&&(i.delete(t),i.size||(Yi._elementCallbacks.delete(e),Yi._observerInstance.unobserve(e))),Yi._elementCallbacks&&!Yi._elementCallbacks.size&&(Yi._observerInstance=null,Yi._elementCallbacks=null)}static _getElementCallbacks(e){return Yi._elementCallbacks?Yi._elementCallbacks.get(e):null}static _createObserver(){let e;e="function"===typeof ri.window.ResizeObserver?ri.window.ResizeObserver:Qi,Yi._observerInstance=new e((e=>{for(const t of e){const e=Yi._getElementCallbacks(t.target);if(e)for(const i of e)i(t)}}))}}Yi._observerInstance=null,Yi._elementCallbacks=null;class Qi{constructor(e){this._callback=e,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(e){this._elements.add(e),this._checkElementRectsAndExecuteCallback(),1===this._elements.size&&this._startPeriodicCheck()}unobserve(e){this._elements.delete(e),this._previousRects.delete(e),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const e=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(e,Ji)};this.listenTo(ri.window,"resize",(()=>{this._checkElementRectsAndExecuteCallback()})),this._periodicCheckTimeout=setTimeout(e,Ji)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const e=[];for(const t of this._elements)this._hasRectChanged(t)&&e.push({target:t,contentRect:this._previousRects.get(t)});e.length&&this._callback(e)}_hasRectChanged(e){if(!e.ownerDocument.body.contains(e))return!1;const t=new Gi(e),i=this._previousRects.get(e),o=!i||!i.isEqual(t);return this._previousRects.set(e,t),o}}(0,N.Z)(Qi,_i.Z);var Xi=i(81759);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eo{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(e){if(this._elements.has(e))throw new S.ZP("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",(()=>this._focus(e)),{useCapture:!0}),this.listenTo(e,"blur",(()=>this._blur()),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(e),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout((()=>{this.focusedElement=null,this.isFocused=!1}),0)}}(0,N.Z)(eo,_i.Z),(0,N.Z)(eo,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class to{constructor(){this._listener=Object.create(_i.Z)}listenTo(e){this._listener.listenTo(e,"keydown",((e,t)=>{this._listener.fire("_keydown:"+(0,ct.Cq)(t),t)}))}set(e,t,i={}){const o=(0,ct.Zz)(e),n=i.priority;this._listener.listenTo(this._listener,"_keydown:"+o,((e,i)=>{t(i,(()=>{i.preventDefault(),i.stopPropagation(),e.stop()})),e.return=!0}),{priority:n})}press(e){return!!this._listener.fire("_keydown:"+(0,ct.Cq)(e),e)}destroy(){this._listener.stopListening()}}var io=i(13719),oo=i(18481);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class no extends vi{constructor(e){super(e),this.document.on("keydown",((e,t)=>{if(this.isEnabled&&(0,ct.dj)(t.keyCode)){const i=new Ge(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(i,t),i.stop.called&&e.stop()}}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const so={};function ro({target:e,viewportOffset:t=0}){const i=po(e);let o=i,n=null;while(o){let s;s=fo(o==i?e:n),co(s,(()=>wo(e,o)));const r=wo(e,o);if(lo(o,r,t),o.parent!=o){if(n=o.frameElement,o=o.parent,!n)return}else o=null}}function ao(e){const t=fo(e);co(t,(()=>new Gi(e)))}function lo(e,t,i){const o=t.clone().moveBy(0,i),n=t.clone().moveBy(0,-i),s=new Gi(e).excludeScrollbarsAndBorders(),r=[n,o];if(!r.every((e=>s.contains(e)))){let{scrollX:r,scrollY:a}=e;uo(n,s)?a-=s.top-t.top+i:ho(o,s)&&(a+=t.bottom-s.bottom+i),mo(t,s)?r-=s.left-t.left+i:go(t,s)&&(r+=t.right-s.right+i),e.scrollTo(r,a)}}function co(e,t){const i=po(e);let o,n;while(e!=i.document.body)n=t(),o=new Gi(e).excludeScrollbarsAndBorders(),o.contains(n)||(uo(n,o)?e.scrollTop-=o.top-n.top:ho(n,o)&&(e.scrollTop+=n.bottom-o.bottom),mo(n,o)?e.scrollLeft-=o.left-n.left:go(n,o)&&(e.scrollLeft+=n.right-o.right)),e=e.parentNode}function ho(e,t){return e.bottom>t.bottom}function uo(e,t){return e.top<t.top}function mo(e,t){return e.left<t.left}function go(e,t){return e.right>t.right}function po(e){return Hi(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function fo(e){if(Hi(e)){let t=e.commonAncestorContainer;return Tt(t)&&(t=t.parentNode),t}return e.parentNode}function wo(e,t){const i=po(e),o=new Gi(e);if(i===t)return o;{let e=i;while(e!=t){const t=e.frameElement,i=new Gi(t).excludeScrollbarsAndBorders();o.moveBy(i.left,i.top),e=e.parent}}return o}Object.assign(so,{scrollViewportToShowTarget:ro,scrollAncestorsToShowTarget:ao});
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bo{constructor(e){this.document=new it(e),this.domConverter=new gi(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Qt(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new bt(this.document),this.addObserver(xi),this.addObserver(Ni),this.addObserver(Ii),this.addObserver(Pi),this.addObserver(Ti),this.addObserver(Di),this.addObserver(no),Yt.ZP.isAndroid&&this.addObserver(Ri),$t(this),ht(this),this.on("render",(()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1})),this.listenTo(this.document.selection,"change",(()=>{this._hasChangedSinceTheLastRendering=!0})),this.listenTo(this.document,"change:isFocused",(()=>{this._hasChangedSinceTheLastRendering=!0}))}attachDomRoot(e,t="main"){const i=this.document.getRoot(t);i._name=e.tagName.toLowerCase();const o={};for(const{name:s,value:r}of Array.from(e.attributes))o[s]=r,"class"===s?this._writer.addClass(r.split(" "),i):this._writer.setAttribute(s,r,i);this._initialDomRootAttributes.set(e,o);const n=()=>{this._writer.setAttribute("contenteditable",!i.isReadOnly,i),i.isReadOnly?this._writer.addClass("ck-read-only",i):this._writer.removeClass("ck-read-only",i)};n(),this.domRoots.set(t,e),this.domConverter.bindElements(e,i),this._renderer.markToSync("children",i),this._renderer.markToSync("attributes",i),this._renderer.domDocuments.add(e.ownerDocument),i.on("change:children",((e,t)=>this._renderer.markToSync("children",t))),i.on("change:attributes",((e,t)=>this._renderer.markToSync("attributes",t))),i.on("change:text",((e,t)=>this._renderer.markToSync("text",t))),i.on("change:isReadOnly",(()=>this.change(n))),i.on("change",(()=>{this._hasChangedSinceTheLastRendering=!0}));for(const s of this._observers.values())s.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach((({name:e})=>t.removeAttribute(e)));const i=this._initialDomRootAttributes.get(t);for(const o in i)t.setAttribute(o,i[o]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[i,o]of this.domRoots)t.observe(o,i);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection(){const e=this.document.selection.getFirstRange();e&&ro({target:this.domConverter.viewRangeToDom(e),viewportOffset:20})}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new S.ZP("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){S.ZP.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change((()=>{}))}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Fe._createAt(e,t)}createPositionAfter(e){return Fe._createAfter(e)}createPositionBefore(e){return Fe._createBefore(e)}createRange(e,t){return new ze(e,t)}createRangeOn(e){return ze._createOn(e)}createRangeIn(e){return ze._createIn(e)}createSelection(e,t,i){return new Ue(e,t,i)}_disableRendering(e){this._renderingDisabled=e,0==e&&this.change((()=>{}))}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}(0,N.Z)(bo,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _o{constructor(e){this.parent=null,this._attrs=Y(e)}get index(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildIndex(this)))throw new S.ZP("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildStartOffset(this)))throw new S.ZP("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;while(e.parent)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;while(t.parent)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}getCommonAncestor(e,t={}){const i=this.getAncestors(t),o=e.getAncestors(t);let n=0;while(i[n]==o[n]&&i[n])n++;return 0===n?null:i[n-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),i=e.getPath(),o=U(t,i);switch(o){case"prefix":return!0;case"extension":return!1;default:return t[o]<i[o]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce(((e,t)=>(e[t[0]]=t[1],e)),{})),e}is(e){return"node"===e||"model:node"===e}_clone(){return new _o(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=Y(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vo extends _o{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}is(e){return"$text"===e||"model:$text"===e||"text"===e||"model:text"===e||"node"===e||"model:node"===e}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new vo(this.data,this.getAttributes())}static fromJSON(e){return new vo(e.data,e.attributes)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yo{constructor(e,t,i){if(this.textNode=e,t<0||t>e.offsetSize)throw new S.ZP("model-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.offsetSize)throw new S.ZP("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(e){return"$textProxy"===e||"model:$textProxy"===e||"textProxy"===e||"model:textProxy"===e}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let i=e.includeSelf?this:this.parent;while(i)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Co{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce(((e,t)=>e+t.offsetSize),0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return-1==t?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return null===t?null:this._nodes.slice(0,t).reduce(((e,t)=>e+t.offsetSize),0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new S.ZP("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const i of this._nodes){if(e>=t&&e<t+i.offsetSize)return this.getNodeIndex(i);t+=i.offsetSize}if(t!=e)throw new S.ZP("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const i of t)if(!(i instanceof _o))throw new S.ZP("model-nodelist-insertnodes-not-node",this);this._nodes.splice(e,0,...t)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map((e=>e.toJSON()))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ko extends _o{constructor(e,t,i){super(t),this.name=e,this._children=new Co,i&&this._insertChild(0,i)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(e,t=null){return t?t===this.name&&("element"===e||"model:element"===e):"element"===e||"model:element"===e||"node"===e||"model:node"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const i of e)t=t.getChild(t.offsetToIndex(i));return t}findAncestor(e,t={includeSelf:!1}){let i=t.includeSelf?this:this.parent;while(i){if(i.name===e)return i;i=i.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map((e=>e._clone(!0))):null;return new ko(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const i=xo(t);for(const o of i)null!==o.parent&&o._remove(),o.parent=this;this._children._insertNodes(e,i)}_removeChildren(e,t=1){const i=this._children._removeNodes(e,t);for(const o of i)o.parent=null;return i}static fromJSON(e){let t=null;if(e.children){t=[];for(const i of e.children)i.name?t.push(ko.fromJSON(i)):t.push(vo.fromJSON(i))}return new ko(e.name,e.attributes,t)}}function xo(e){return"string"==typeof e?[new vo(e)]:((0,J.Z)(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new vo(e):e instanceof yo?new vo(e.data,e.getAttributes()):e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vo{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new S.ZP("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new S.ZP("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=Ao._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(e){let t,i,o,n;do{o=this.position,n=this._visitedParent,({done:t,value:i}=this.next())}while(!t&&e(i));t||(this.position=o,this._visitedParent=n)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&t.offset===i.maxOffset)return{done:!0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};const o=t.parent,n=Po(t,o),s=n||So(t,o,n);if(s instanceof ko)return this.shallow?t.offset++:(t.path.push(0),this._visitedParent=s),this.position=t,Eo("elementStart",s,e,t,1);if(s instanceof vo){let o;if(this.singleCharacters)o=1;else{let e=s.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<e&&(e=this.boundaries.end.offset),o=e-t.offset}const n=t.offset-s.startOffset,r=new yo(s,n,o);return t.offset+=o,this.position=t,Eo("text",r,e,t,o)}return t.path.pop(),t.offset++,this.position=t,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():Eo("elementEnd",i,e,t)}_previous(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&0===t.offset)return{done:!0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};const o=t.parent,n=Po(t,o),s=n||To(t,o,n);if(s instanceof ko)return t.offset--,this.shallow?(this.position=t,Eo("elementStart",s,e,t,1)):(t.path.push(s.maxOffset),this.position=t,this._visitedParent=s,this.ignoreElementEnd?this._previous():Eo("elementEnd",s,e,t));if(s instanceof vo){let o;if(this.singleCharacters)o=1;else{let e=s.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>e&&(e=this.boundaries.start.offset),o=t.offset-e}const n=t.offset-s.startOffset,r=new yo(s,n-o,o);return t.offset-=o,this.position=t,Eo("text",r,e,t,o)}return t.path.pop(),this.position=t,this._visitedParent=i.parent,Eo("elementStart",i,e,t,1)}}function Eo(e,t,i,o,n){return{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:o,length:n}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ao{constructor(e,t,i="toNone"){if(!e.is("element")&&!e.is("documentFragment"))throw new S.ZP("model-position-root-invalid",e);if(!(t instanceof Array)||0===t.length)throw new S.ZP("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=i}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new S.ZP("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new S.ZP("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Po(this,this.parent)}get nodeAfter(){const e=this.parent;return So(this,e,Po(this,e))}get nodeBefore(){const e=this.parent;return To(this,e,Po(this,e))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=U(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const i=new Vo(t);return i.skip(e),i.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=U(this.path,e.path),i="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,i)}getCommonAncestor(e){const t=this.getAncestors(),i=e.getAncestors();let o=0;while(t[o]==i[o]&&t[o])o++;return 0===o?null:t[o-1]}getShiftedBy(e){const t=this.clone(),i=t.offset+e;return t.offset=i<0?0:i,t}isAfter(e){return"after"==this.compareWith(e)}isBefore(e){return"before"==this.compareWith(e)}isEqual(e){return"same"==this.compareWith(e)}isTouching(e){let t=null,i=null;const o=this.compareWith(e);switch(o){case"same":return!0;case"before":t=Ao._createAt(this),i=Ao._createAt(e);break;case"after":t=Ao._createAt(e),i=Ao._createAt(this);break;default:return!1}let n=t.parent;while(t.path.length+i.path.length){if(t.isEqual(i))return!0;if(t.path.length>i.path.length){if(t.offset!==n.maxOffset)return!1;t.path=t.path.slice(0,-1),n=n.parent,t.offset++}else{if(0!==i.offset)return!1;i.path=i.path.slice(0,-1)}}}is(e){return"position"===e||"model:position"===e}hasSameParentAs(e){if(this.root!==e.root)return!1;const t=this.getParentPath(),i=e.getParentPath();return"same"==U(t,i)}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=Ao._createAt(this);break}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange,i=t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness;return i?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange,i=t.containsPosition(this)||t.start.isEqual(this);let o;return i?(o=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(o=o._getTransformedByDeletion(e.deletionPosition,1))):o=this.isEqual(e.deletionPosition)?Ao._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),o}_getTransformedByDeletion(e,t){const i=Ao._createAt(this);if(this.root!=e.root)return i;if("same"==U(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;i.offset-=t}}else if("prefix"==U(e.getParentPath(),this.getParentPath())){const o=e.path.length-1;if(e.offset<=this.path[o]){if(e.offset+t>this.path[o])return null;i.path[o]-=t}}return i}_getTransformedByInsertion(e,t){const i=Ao._createAt(this);if(this.root!=e.root)return i;if("same"==U(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(i.offset+=t);else if("prefix"==U(e.getParentPath(),this.getParentPath())){const o=e.path.length-1;e.offset<=this.path[o]&&(i.path[o]+=t)}return i}_getTransformedByMove(e,t,i){if(t=t._getTransformedByDeletion(e,i),e.isEqual(t))return Ao._createAt(this);const o=this._getTransformedByDeletion(e,i),n=null===o||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(i).isEqual(this)&&"toPrevious"==this.stickiness;return n?this._getCombined(e,t):o._getTransformedByInsertion(t,i)}_getCombined(e,t){const i=e.path.length-1,o=Ao._createAt(t);return o.stickiness=this.stickiness,o.offset=o.offset+this.path[i]-e.offset,o.path=[...o.path,...this.path.slice(i+1)],o}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,i="toNone"){if(e instanceof Ao)return new Ao(e.root,e.path,e.stickiness);{const o=e;if("end"==t)t=o.maxOffset;else{if("before"==t)return this._createBefore(o,i);if("after"==t)return this._createAfter(o,i);if(0!==t&&!t)throw new S.ZP("model-createpositionat-offset-required",[this,e])}if(!o.is("element")&&!o.is("documentFragment"))throw new S.ZP("model-position-parent-incorrect",[this,e]);const n=o.getPath();return n.push(t),new this(o.root,n,i)}}static _createAfter(e,t){if(!e.parent)throw new S.ZP("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new S.ZP("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if("$graveyard"===e.root){const i=new Ao(t.graveyard,e.path);return i.stickiness=e.stickiness,i}if(!t.getRoot(e.root))throw new S.ZP("model-position-fromjson-no-root",t,{rootName:e.root});return new Ao(t.getRoot(e.root),e.path,e.stickiness)}}function Po(e,t){const i=t.getChild(t.offsetToIndex(e.offset));return i&&i.is("$text")&&i.startOffset<e.offset?i:null}function So(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset))}function To(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset)-1)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class No{constructor(e,t=null){this.start=Ao._createAt(e),this.end=t?Ao._createAt(t):Ao._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Vo({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),t=this.end.getParentPath();return"same"==U(e,t)}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),o=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&o}containsItem(e){const t=Ao._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}is(e){return"range"===e||"model:range"===e}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new No(this.start,e.start)),this.containsPosition(e.end)&&t.push(new No(e.end,this.end))):t.push(new No(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,i=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(i=e.end),new No(t,i)}return null}getJoined(e,t=!1){let i=this.isIntersecting(e);if(i||(i=this.start.isBefore(e.start)?t?this.end.isTouching(e.start):this.end.isEqual(e.start):t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!i)return null;let o=this.start,n=this.end;return e.start.isBefore(o)&&(o=e.start),e.end.isAfter(n)&&(n=e.end),new No(o,n)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,i=Ao._createAt(this.start);let o=i.parent;while(i.path.length>t+1){const t=o.maxOffset-i.offset;0!==t&&e.push(new No(i,i.getShiftedBy(t))),i.path=i.path.slice(0,-1),i.offset++,o=o.parent}while(i.path.length<=this.end.path.length){const t=this.end.path[i.path.length-1],o=t-i.offset;0!==o&&e.push(new No(i,i.getShiftedBy(o))),i.offset=t,i.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Vo(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Vo(e);for(const i of t)yield i.item}*getPositions(e={}){e.boundaries=this;const t=new Vo(e);yield t.position;for(const i of t)yield i.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new No(this.start,this.end)]}getTransformedByOperations(e){const t=[new No(this.start,this.end)];for(const i of e)for(let e=0;e<t.length;e++){const o=t[e].getTransformedByOperation(i);t.splice(e,1,...o),e+=o.length-1}for(let i=0;i<t.length;i++){const e=t[i];for(let o=i+1;o<t.length;o++){const i=t[o];(e.containsRange(i)||i.containsRange(e)||e.isEqual(i))&&t.splice(o,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const i=e.sourcePosition,o=e.howMany,n=e.targetPosition;return this._getTransformedByMove(i,n,o,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let i=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(i=this.end.getShiftedBy(1)),t.root!=i.root&&(i=this.end.getShiftedBy(-1)),new No(t,i)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new No(this.start);let t=this.start._getTransformedByMergeOperation(e),i=this.end._getTransformedByMergeOperation(e);return t.root!=i.root&&(i=this.end.getShiftedBy(-1)),t.isAfter(i)?(e.sourcePosition.isBefore(e.targetPosition)?(t=Ao._createAt(i),t.offset=0):(e.deletionPosition.isEqual(t)||(i=e.deletionPosition),t=e.targetPosition),new No(t,i)):new No(t,i)}_getTransformedByInsertion(e,t,i=!1){if(i&&this.containsPosition(e))return[new No(this.start,e),new No(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const i=new No(this.start,this.end);return i.start=i.start._getTransformedByInsertion(e,t),i.end=i.end._getTransformedByInsertion(e,t),[i]}}_getTransformedByMove(e,t,i,o=!1){if(this.isCollapsed){const o=this.start._getTransformedByMove(e,t,i);return[new No(o)]}const n=No._createFromPositionAndShift(e,i),s=t._getTransformedByDeletion(e,i);if(this.containsPosition(t)&&!o&&(n.containsPosition(this.start)||n.containsPosition(this.end))){const o=this.start._getTransformedByMove(e,t,i),n=this.end._getTransformedByMove(e,t,i);return[new No(o,n)]}let r;const a=this.getDifference(n);let l=null;const c=this.getIntersection(n);if(1==a.length?l=new No(a[0].start._getTransformedByDeletion(e,i),a[0].end._getTransformedByDeletion(e,i)):2==a.length&&(l=new No(this.start,this.end._getTransformedByDeletion(e,i))),r=l?l._getTransformedByInsertion(s,i,null!==c||o):[],c){const e=new No(c.start._getCombined(n.start,s),c.end._getCombined(n.start,s));2==r.length?r.splice(1,0,e):r.push(e)}return r}_getTransformedByDeletion(e,t){let i=this.start._getTransformedByDeletion(e,t),o=this.end._getTransformedByDeletion(e,t);return null==i&&null==o?null:(null==i&&(i=e),null==o&&(o=e),new No(i,o))}static _createFromPositionAndShift(e,t){const i=e,o=e.getShiftedBy(t);return t>0?new this(i,o):new this(o,i)}static _createIn(e){return new this(Ao._createAt(e,0),Ao._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(Ao._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(0===e.length)throw new S.ZP("range-create-from-ranges-empty-array",null);if(1==e.length)return e[0].clone();const t=e[0];e.sort(((e,t)=>e.start.isAfter(t.start)?1:-1));const i=e.indexOf(t),o=new this(t.start,t.end);if(i>0)for(let n=i-1;1;n++){if(!e[n].end.isEqual(o.start))break;o.start=Ao._createAt(e[n].start)}for(let n=i+1;n<e.length;n++){if(!e[n].start.isEqual(o.end))break;o.end=Ao._createAt(e[n].end)}return o}static fromJSON(e,t){return new this(Ao.fromJSON(e.start,t),Ao.fromJSON(e.end,t))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Io{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",((e,t)=>{if(t.viewPosition)return;const i=this._modelToViewMapping.get(t.modelPosition.parent);t.viewPosition=this.findPositionIn(i,t.modelPosition.offset)}),{priority:"low"}),this.on("viewToModelPosition",((e,t)=>{if(t.modelPosition)return;const i=this.findMappedViewAncestor(t.viewPosition),o=this._viewToModelMapping.get(i),n=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,i);t.modelPosition=Ao._createAt(o,n)}),{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e){const t=this.toModelElement(e);if(this._viewToModelMapping.delete(e),this._elementToMarkerNames.has(e))for(const i of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(i);this._modelToViewMapping.get(t)==e&&this._modelToViewMapping.delete(t)}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const i=this._markerNameToElements.get(t)||new Set;i.add(e);const o=this._elementToMarkerNames.get(e)||new Set;o.add(t),this._markerNameToElements.set(t,i),this._elementToMarkerNames.set(e,o)}unbindElementFromMarkerName(e,t){const i=this._markerNameToElements.get(t);i&&(i.delete(e),0==i.size&&this._markerNameToElements.delete(t));const o=this._elementToMarkerNames.get(e);o&&(o.delete(t),0==o.size&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new No(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new ze(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={isPhantom:!1}){const i={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",i),i.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const i=new Set;for(const o of t)if(o.is("attributeElement"))for(const e of o.getElementsWithSameId())i.add(e);else i.add(o);return i}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;while(!this._viewToModelMapping.has(t))t=t.parent;return t}_toModelOffset(e,t,i){if(i!=e){const o=this._toModelOffset(e.parent,e.index,i),n=this._toModelOffset(e,t,e);return o+n}if(e.is("$text"))return t;let o=0;for(let n=0;n<t;n++)o+=this.getModelLength(e.getChild(n));return o}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name)){const t=this._viewToModelLengthCallbacks.get(e.name);return t(e)}if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const i of e.getChildren())t+=this.getModelLength(i);return t}}findPositionIn(e,t){let i,o=0,n=0,s=0;if(e.is("$text"))return new Fe(e,t);while(n<t)i=e.getChild(s),o=this.getModelLength(i),n+=o,s++;return n==t?this._moveViewPositionToTextNode(new Fe(e,s)):this.findPositionIn(i,t-(n-o))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,i=e.nodeAfter;return t instanceof G?new Fe(t,t.data.length):i instanceof G?new Fe(i,0):e}}(0,N.Z)(Io,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Do{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=Ro(t),e instanceof yo&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=Ro(t),e instanceof yo&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0)}test(e,t){t=Ro(t),e instanceof yo&&(e=this._getSymbolForTextProxy(e));const i=this._consumable.get(e);if(void 0===i)return null;const o=i.get(t);return void 0===o?null:o}revert(e,t){t=Ro(t),e instanceof yo&&(e=this._getSymbolForTextProxy(e));const i=this.test(e,t);return!1===i?(this._consumable.get(e).set(t,!0),!0):!0!==i&&null}_getSymbolForTextProxy(e){let t=null;const i=this._textProxyRegistry.get(e.startOffset);if(i){const o=i.get(e.endOffset);o&&(t=o.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e.startOffset,e.endOffset,e.parent)),t}_addSymbolForTextProxy(e,t,i){const o=Symbol("textProxySymbol");let n,s;return n=this._textProxyRegistry.get(e),n||(n=new Map,this._textProxyRegistry.set(e,n)),s=n.get(t),s||(s=new Map,n.set(t,s)),s.set(i,o),o}}function Ro(e){const t=e.split(":");return"addMarker"==t[0]||"removeMarker"==t[0]?e:t.length>1?t[0]+":"+t[1]:t[0]}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bo{constructor(e){this.conversionApi=Object.assign({dispatcher:this},e),this._reconversionEventsMapping=new Map}convertChanges(e,t,i){for(const n of e.getMarkersToRemove())this.convertMarkerRemove(n.name,n.range,i);const o=this._mapChangesWithAutomaticReconversion(e);for(const n of o)"insert"===n.type?this.convertInsert(No._createFromPositionAndShift(n.position,n.length),i):"remove"===n.type?this.convertRemove(n.position,n.length,n.name,i):"reconvert"===n.type?this.reconvertElement(n.element,i):this.convertAttribute(n.range,n.attributeKey,n.attributeOldValue,n.attributeNewValue,i);for(const n of this.conversionApi.mapper.flushUnboundMarkerNames()){const e=t.get(n).getRange();this.convertMarkerRemove(n,e,i),this.convertMarkerAdd(n,e,i)}for(const n of e.getMarkersToAdd())this.convertMarkerAdd(n.name,n.range,i)}convertInsert(e,t){this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(e);for(const i of Array.from(e).map(Lo))this._convertInsertWithAttributes(i);this._clearConversionApi()}convertRemove(e,t,i,o){this.conversionApi.writer=o,this.fire("remove:"+i,{position:e,length:t},this.conversionApi),this._clearConversionApi()}convertAttribute(e,t,i,o,n){this.conversionApi.writer=n,this.conversionApi.consumable=this._createConsumableForRange(e,`attribute:${t}`);for(const s of e){const e=s.item,n=No._createFromPositionAndShift(s.previousPosition,s.length),r={item:e,range:n,attributeKey:t,attributeOldValue:i,attributeNewValue:o};this._testAndFire(`attribute:${t}`,r)}this._clearConversionApi()}reconvertElement(e,t){const i=No._createOn(e);this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(i);const o=this.conversionApi.mapper,n=o.toViewElement(e);t.remove(n),this._convertInsertWithAttributes({item:e,range:i});const s=o.toViewElement(e);for(const r of No._createIn(e)){const{item:e}=r,i=$o(e,o);i?i.root!==s.root&&t.move(t.createRangeOn(i),o.toViewPosition(Ao._createBefore(e))):this._convertInsertWithAttributes(Lo(r))}o.unbindViewElement(n),this._clearConversionApi()}convertSelection(e,t,i){const o=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this.conversionApi.writer=i,this.conversionApi.consumable=this._createSelectionConsumable(e,o),this.fire("selection",{selection:e},this.conversionApi),e.isCollapsed){for(const t of o){const i=t.getRange();if(!Mo(e.getFirstPosition(),t,this.conversionApi.mapper))continue;const o={item:e,markerName:t.name,markerRange:i};this.conversionApi.consumable.test(e,"addMarker:"+t.name)&&this.fire("addMarker:"+t.name,o,this.conversionApi)}for(const t of e.getAttributeKeys()){const i={item:e,range:e.getFirstRange(),attributeKey:t,attributeOldValue:null,attributeNewValue:e.getAttribute(t)};this.conversionApi.consumable.test(e,"attribute:"+i.attributeKey)&&this.fire("attribute:"+i.attributeKey+":$text",i,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerAdd(e,t,i){if("$graveyard"==t.root.rootName)return;this.conversionApi.writer=i;const o="addMarker:"+e,n=new Do;if(n.add(t,o),this.conversionApi.consumable=n,this.fire(o,{markerName:e,markerRange:t},this.conversionApi),n.test(t,o)){this.conversionApi.consumable=this._createConsumableForRange(t,o);for(const i of t.getItems()){if(!this.conversionApi.consumable.test(i,o))continue;const n={item:i,range:No._createOn(i),markerName:e,markerRange:t};this.fire(o,n,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerRemove(e,t,i){"$graveyard"!=t.root.rootName&&(this.conversionApi.writer=i,this.fire("removeMarker:"+e,{markerName:e,markerRange:t},this.conversionApi),this._clearConversionApi())}_mapReconversionTriggerEvent(e,t){this._reconversionEventsMapping.set(t,e)}_createInsertConsumable(e){const t=new Do;for(const i of e){const e=i.item;t.add(e,"insert");for(const i of e.getAttributeKeys())t.add(e,"attribute:"+i)}return t}_createConsumableForRange(e,t){const i=new Do;for(const o of e.getItems())i.add(o,t);return i}_createSelectionConsumable(e,t){const i=new Do;i.add(e,"selection");for(const o of t)i.add(e,"addMarker:"+o.name);for(const o of e.getAttributeKeys())i.add(e,"attribute:"+o);return i}_testAndFire(e,t){this.conversionApi.consumable.test(t.item,e)&&this.fire(Oo(e,t),t,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}_convertInsertWithAttributes(e){this._testAndFire("insert",e);for(const t of e.item.getAttributeKeys())e.attributeKey=t,e.attributeOldValue=null,e.attributeNewValue=e.item.getAttribute(t),this._testAndFire(`attribute:${t}`,e)}_mapChangesWithAutomaticReconversion(e){const t=new Set,i=[];for(const o of e.getChanges()){const e=o.position||o.range.start,n=e.parent,s=Po(e,n);if(s){i.push(o);continue}const r="attribute"===o.type?So(e,n,null):n;if(r.is("$text")){i.push(o);continue}let a;if(a="attribute"===o.type?`attribute:${o.attributeKey}:${r.name}`:`${o.type}:${o.name}`,this._isReconvertTriggerEvent(a,r.name)){if(t.has(r))continue;t.add(r),i.push({type:"reconvert",element:r})}else i.push(o)}return i}_isReconvertTriggerEvent(e,t){return this._reconversionEventsMapping.get(e)===t}}function Mo(e,t,i){const o=t.getRange(),n=Array.from(e.getAncestors());n.shift(),n.reverse();const s=n.some((e=>{if(o.containsItem(e)){const t=i.toViewElement(e);return!!t.getCustomProperty("addHighlight")}}));return!s}function Oo(e,t){const i=t.item.name||"$text";return`${e}:${i}`}function Lo(e){const t=e.item,i=No._createFromPositionAndShift(e.previousPosition,e.length);return{item:t,range:i}}function $o(e,t){if(e.is("textProxy")){const i=t.toViewPosition(Ao._createBefore(e)),o=i.parent;return o.is("$text")?o:null}return t.toViewElement(e)}(0,N.Z)(Bo,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fo{constructor(e,t,i){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,e&&this.setTo(e,t,i)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){const e=this._ranges.length;return 1===e&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let i=!1;for(const o of e._ranges)if(t.isEqual(o)){i=!0;break}if(!i)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new No(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?new No(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?new No(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(e,t,i){if(null===e)this._setRanges([]);else if(e instanceof Fo)this._setRanges(e.getRanges(),e.isBackward);else if(e&&"function"==typeof e.getRanges)this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof No)this._setRanges([e],!!t&&!!t.backward);else if(e instanceof Ao)this._setRanges([new No(e)]);else if(e instanceof _o){const o=!!i&&!!i.backward;let n;if("in"==t)n=No._createIn(e);else if("on"==t)n=No._createOn(e);else{if(void 0===t)throw new S.ZP("model-selection-setto-required-second-parameter",[this,e]);n=new No(Ao._createAt(e,t))}this._setRanges([n],o)}else{if(!(0,J.Z)(e))throw new S.ZP("model-selection-setto-not-selectable",[this,e]);this._setRanges(e,t&&!!t.backward)}}_setRanges(e,t=!1){e=Array.from(e);const i=e.some((t=>{if(!(t instanceof No))throw new S.ZP("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every((e=>!e.isEqual(t)))}));if(e.length!==this._ranges.length||i){this._removeAllRanges();for(const t of e)this._pushRange(t);this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0})}}setFocus(e,t){if(null===this.anchor)throw new S.ZP("model-selection-setfocus-no-ranges",[this,e]);const i=Ao._createAt(e,t);if("same"==i.compareWith(this.focus))return;const o=this.anchor;this._ranges.length&&this._popRange(),"before"==i.compareWith(o)?(this._pushRange(new No(i,o)),this._lastRangeBackward=!0):(this._pushRange(new No(o,i)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}is(e){return"selection"===e||"model:selection"===e}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const i=Ho(t.start,e);i&&Uo(i,t)&&(yield i);for(const n of t.getWalker()){const i=n.item;"elementEnd"==n.type&&Zo(i,e,t)&&(yield i)}const o=Ho(t.end,e);o&&!t.end.isTouching(Ao._createAt(o,0))&&Uo(o,t)&&(yield o)}}containsEntireContent(e=this.anchor.root){const t=Ao._createAt(e,0),i=Ao._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&i.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new No(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new S.ZP("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_removeAllRanges(){while(this._ranges.length>0)this._popRange()}_popRange(){this._ranges.pop()}}function zo(e,t){return!t.has(e)&&(t.add(e),e.root.document.model.schema.isBlock(e)&&e.parent)}function Zo(e,t,i){return zo(e,t)&&Uo(e,i)}function Ho(e,t){const i=e.parent,o=i.root.document.model.schema,n=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let s=!1;const r=n.find((e=>!s&&(s=o.isLimit(e),!s&&zo(e,t))));return n.forEach((e=>t.add(e))),r}function Uo(e,t){const i=Wo(e);if(!i)return!0;const o=t.containsRange(No._createOn(i),!0);return!o}function Wo(e){const t=e.root.document.model.schema;let i=e.parent;while(i){if(t.isBlock(i))return i;i=i.parent}}(0,N.Z)(Fo,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qo extends No{constructor(e,t){super(e,t),Go.call(this)}detach(){this.stopListening()}is(e){return"liveRange"===e||"model:liveRange"===e||"range"==e||"model:range"===e}toRange(){return new No(this.start,this.end)}static fromRange(e){return new qo(e.start,e.end)}}function Go(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&jo.call(this,i)}),{priority:"low"})}function jo(e){const t=this.getTransformedByOperation(e),i=No._createFromRanges(t),o=!i.isEqual(this),n=Ko(this,e);let s=null;if(o){"$graveyard"==i.root.rootName&&(s="remove"==e.type?e.sourcePosition:e.deletionPosition);const t=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",t,{deletionPosition:s})}else n&&this.fire("change:content",this.toRange(),{deletionPosition:s})}function Ko(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}(0,N.Z)(qo,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Jo="selection:";class Yo{constructor(e){this._selection=new Qo(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}is(e){return"selection"===e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(e,t,i){this._selection.setTo(e,t,i)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return Jo+e}static _isStoreAttributeKey(e){return e.startsWith(Jo)}}(0,N.Z)(Yo,T.ZP);class Qo extends Fo{constructor(e){super(),this.markers=new P.Z({idProperty:"name"}),this._model=e.model,this._document=e,this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this.listenTo(this._model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&"marker"!=i.type&&"rename"!=i.type&&"noop"!=i.type&&(0==this._ranges.length&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))}),{priority:"lowest"}),this.on("change:range",(()=>{for(const e of this.getRanges())if(!this._document._validateSelectionRange(e))throw new S.ZP("document-selection-wrong-position",this,{range:e})})),this.listenTo(this._model.markers,"update",((e,t,i,o)=>{this._updateMarker(t,o)})),this.listenTo(this._document,"change",((e,t)=>{en(this._model,t)}))}get isCollapsed(){const e=this._ranges.length;return 0===e?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(e,t,i){super.setTo(e,t,i),this._updateAttributes(!0),this._updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this._updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=(0,oo.Z)();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new S.ZP("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this._updateMarkers()}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=qo.fromRange(e);return t.on("change:range",((e,i,o)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const e=this._ranges.indexOf(t);this._ranges.splice(e,1),t.detach()}})),t}_updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const o of this._model.markers){const t=o.name.split(":",1)[0];if(!this._observedMarkers.has(t))continue;const i=o.getRange();for(const n of this.getRanges())i.containsRange(n,!n.isCollapsed)&&e.push(o)}const i=Array.from(this.markers);for(const o of e)this.markers.has(o)||(this.markers.add(o),t=!0);for(const o of Array.from(this.markers))e.includes(o)||(this.markers.remove(o),t=!0);t&&this.fire("change:marker",{oldMarkers:i,directChange:!1})}_updateMarker(e,t){const i=e.name.split(":",1)[0];if(!this._observedMarkers.has(i))return;let o=!1;const n=Array.from(this.markers),s=this.markers.has(e);if(t){let i=!1;for(const e of this.getRanges())if(t.containsRange(e,!e.isCollapsed)){i=!0;break}i&&!s?(this.markers.add(e),o=!0):!i&&s&&(this.markers.remove(e),o=!0)}else s&&(this.markers.remove(e),o=!0);o&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateAttributes(e){const t=Y(this._getSurroundingAttributes()),i=Y(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[n,s]of this._attributePriority)"low"==s&&(this._attrs.delete(n),this._attributePriority.delete(n));this._setAttributesTo(t);const o=[];for(const[n,s]of this.getAttributes())i.has(n)&&i.get(n)===s||o.push(n);for(const[n]of i)this.hasAttribute(n)||o.push(n);o.length>0&&this.fire("change:attribute",{attributeKeys:o,directChange:!1})}_setAttribute(e,t,i=!0){const o=i?"normal":"low";if("low"==o&&"normal"==this._attributePriority.get(e))return!1;const n=super.getAttribute(e);return n!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,o),!0)}_removeAttribute(e,t=!0){const i=t?"normal":"low";return("low"!=i||"normal"!=this._attributePriority.get(e))&&(this._attributePriority.set(e,i),!!super.hasAttribute(e)&&(this._attrs.delete(e),!0))}_setAttributesTo(e){const t=new Set;for(const[i,o]of this.getAttributes())e.get(i)!==o&&this._removeAttribute(i,!1);for(const[i,o]of e){const e=this._setAttribute(i,o,!1);e&&t.add(i)}return t}*_getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())if(t.startsWith(Jo)){const i=t.substr(Jo.length);yield[i,e.getAttribute(t)]}}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;let i=null;if(this.isCollapsed){const o=e.textNode?e.textNode:e.nodeBefore,n=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(i=Xo(o)),i||(i=Xo(n)),!this.isGravityOverridden&&!i){let e=o;while(e&&!t.isInline(e)&&!i)e=e.previousSibling,i=Xo(e)}if(!i){let e=n;while(e&&!t.isInline(e)&&!i)e=e.nextSibling,i=Xo(e)}i||(i=this._getStoredAttributes())}else{const e=this.getFirstRange();for(const o of e){if(o.item.is("element")&&t.isObject(o.item))break;if("text"==o.type){i=o.item.getAttributes();break}}}return i}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function Xo(e){return e instanceof yo||e instanceof vo?e.getAttributes():null}function en(e,t){const i=e.document.differ;for(const o of i.getChanges()){if("insert"!=o.type)continue;const i=o.position.parent,n=o.length===i.maxOffset;n&&e.enqueueChange(t,(e=>{const t=Array.from(i.getAttributeKeys()).filter((e=>e.startsWith(Jo)));for(const o of t)e.removeAttribute(o,i)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tn{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}var on=i(68652);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nn extends tn{elementToElement(e){return this.add(xn(e))}attributeToElement(e){return this.add(Vn(e))}attributeToAttribute(e){return this.add(En(e))}markerToElement(e){return this.add(An(e))}markerToHighlight(e){return this.add(Sn(e))}markerToData(e){return this.add(Pn(e))}}function sn(){return(e,t,i)=>{if(!i.consumable.consume(t.item,"insert"))return;const o=i.writer,n=i.mapper.toViewPosition(t.range.start),s=o.createText(t.item.data);o.insert(n,s)}}function rn(){return(e,t,i)=>{const o=i.mapper.toViewPosition(t.position),n=t.position.getShiftedBy(t.length),s=i.mapper.toViewPosition(n,{isPhantom:!0}),r=i.writer.createRange(o,s),a=i.writer.remove(r.getTrimmed());for(const l of i.writer.createRangeIn(a).getItems())i.mapper.unbindViewElement(l)}}function an(e,t){const i=e.createAttributeElement("span",t.attributes);return t.classes&&i._addClass(t.classes),"number"===typeof t.priority&&(i._priority=t.priority),i._id=t.id,i}function ln(){return(e,t,i)=>{const o=t.selection;if(o.isCollapsed)return;if(!i.consumable.consume(o,"selection"))return;const n=[];for(const s of o.getRanges()){const e=i.mapper.toViewRange(s);n.push(e)}i.writer.setSelection(n,{backward:o.isBackward})}}function cn(){return(e,t,i)=>{const o=t.selection;if(!o.isCollapsed)return;if(!i.consumable.consume(o,"selection"))return;const n=i.writer,s=o.getFirstPosition(),r=i.mapper.toViewPosition(s),a=n.breakAttributes(r);n.setSelection(a)}}function dn(){return(e,t,i)=>{const o=i.writer,n=o.document.selection;for(const s of n.getRanges())s.isCollapsed&&s.end.parent.isAttached()&&i.writer.mergeAttributes(s.start);o.setSelection(null)}}function hn(e){return(t,i,o)=>{const n=e(i.attributeOldValue,o),s=e(i.attributeNewValue,o);if(!n&&!s)return;if(!o.consumable.consume(i.item,t.name))return;const r=o.writer,a=r.document.selection;if(i.item instanceof Fo||i.item instanceof Yo)r.wrap(a.getFirstRange(),s);else{let e=o.mapper.toViewRange(i.range);null!==i.attributeOldValue&&n&&(e=r.unwrap(e,n)),null!==i.attributeNewValue&&s&&r.wrap(e,s)}}}function un(e){return(t,i,o)=>{const n=e(i.item,o);if(!n)return;if(!o.consumable.consume(i.item,"insert"))return;const s=o.mapper.toViewPosition(i.range.start);o.mapper.bindElements(i.item,n),o.writer.insert(s,n)}}function mn(e){return(t,i,o)=>{i.isOpening=!0;const n=e(i,o);i.isOpening=!1;const s=e(i,o);if(!n||!s)return;const r=i.markerRange;if(r.isCollapsed&&!o.consumable.consume(r,t.name))return;for(const e of r)if(!o.consumable.consume(e.item,t.name))return;const a=o.mapper,l=o.writer;l.insert(a.toViewPosition(r.start),n),o.mapper.bindElementToMarker(n,i.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),s),o.mapper.bindElementToMarker(s,i.markerName)),t.stop()}}function gn(){return(e,t,i)=>{const o=i.mapper.markerNameToElements(t.markerName);if(o){for(const e of o)i.mapper.unbindElementFromMarkerName(e,t.markerName),i.writer.clear(i.writer.createRangeOn(e),e);i.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function pn(e){return(t,i,o)=>{const n=e(i.markerName,o);if(!n)return;const s=i.markerRange;o.consumable.consume(s,t.name)&&(fn(s,!1,o,i,n),fn(s,!0,o,i,n),t.stop())}}function fn(e,t,i,o,n){const s=t?e.start:e.end,r=s.nodeAfter&&s.nodeAfter.is("element")?s.nodeAfter:null,a=s.nodeBefore&&s.nodeBefore.is("element")?s.nodeBefore:null;if(r||a){let e,s;t&&r||!t&&!a?(e=r,s=!0):(e=a,s=!1);const l=i.mapper.toViewElement(e);if(l)return void wn(l,t,s,i,o,n)}const l=i.mapper.toViewPosition(s);bn(l,t,i,o,n)}function wn(e,t,i,o,n,s){const r=`data-${s.group}-${t?"start":"end"}-${i?"before":"after"}`,a=e.hasAttribute(r)?e.getAttribute(r).split(","):[];a.unshift(s.name),o.writer.setAttribute(r,a.join(","),e),o.mapper.bindElementToMarker(e,n.markerName)}function bn(e,t,i,o,n){const s=`${n.group}-${t?"start":"end"}`,r=n.name?{name:n.name}:null,a=i.writer.createUIElement(s,r);i.writer.insert(e,a),i.mapper.bindElementToMarker(a,o.markerName)}function _n(e){return(t,i,o)=>{const n=e(i.markerName,o);if(!n)return;const s=o.mapper.markerNameToElements(i.markerName);if(s){for(const e of s)o.mapper.unbindElementFromMarkerName(e,i.markerName),e.is("containerElement")?(r(`data-${n.group}-start-before`,e),r(`data-${n.group}-start-after`,e),r(`data-${n.group}-end-before`,e),r(`data-${n.group}-end-after`,e)):o.writer.clear(o.writer.createRangeOn(e),e);o.writer.clearClonedElementsGroup(i.markerName),t.stop()}function r(e,t){if(t.hasAttribute(e)){const i=new Set(t.getAttribute(e).split(","));i.delete(n.name),0==i.size?o.writer.removeAttribute(e,t):o.writer.setAttribute(e,Array.from(i).join(","),t)}}}}function vn(e){return(t,i,o)=>{const n=e(i.attributeOldValue,o),s=e(i.attributeNewValue,o);if(!n&&!s)return;if(!o.consumable.consume(i.item,t.name))return;const r=o.mapper.toViewElement(i.item),a=o.writer;if(!r)throw new S.ZP("conversion-attribute-to-attribute-on-text",[i,o]);if(null!==i.attributeOldValue&&n)if("class"==n.key){const e=(0,D.Z)(n.value);for(const t of e)a.removeClass(t,r)}else if("style"==n.key){const e=Object.keys(n.value);for(const t of e)a.removeStyle(t,r)}else a.removeAttribute(n.key,r);if(null!==i.attributeNewValue&&s)if("class"==s.key){const e=(0,D.Z)(s.value);for(const t of e)a.addClass(t,r)}else if("style"==s.key){const e=Object.keys(s.value);for(const t of e)a.setStyle(t,s.value[t],r)}else a.setAttribute(s.key,s.value,r)}}function yn(e){return(t,i,o)=>{if(!i.item)return;if(!(i.item instanceof Fo||i.item instanceof Yo)&&!i.item.is("$textProxy"))return;const n=Rn(e,i,o);if(!n)return;if(!o.consumable.consume(i.item,t.name))return;const s=o.writer,r=an(s,n),a=s.document.selection;if(i.item instanceof Fo||i.item instanceof Yo)s.wrap(a.getFirstRange(),r,a);else{const e=o.mapper.toViewRange(i.range),t=s.wrap(e,r);for(const n of t.getItems())if(n.is("attributeElement")&&n.isSimilar(r)){o.mapper.bindElementToMarker(n,i.markerName);break}}}}function Cn(e){return(t,i,o)=>{if(!i.item)return;if(!(i.item instanceof ko))return;const n=Rn(e,i,o);if(!n)return;if(!o.consumable.test(i.item,t.name))return;const s=o.mapper.toViewElement(i.item);if(s&&s.getCustomProperty("addHighlight")){o.consumable.consume(i.item,t.name);for(const e of No._createIn(i.item))o.consumable.consume(e.item,t.name);s.getCustomProperty("addHighlight")(s,n,o.writer),o.mapper.bindElementToMarker(s,i.markerName)}}}function kn(e){return(t,i,o)=>{if(i.markerRange.isCollapsed)return;const n=Rn(e,i,o);if(!n)return;const s=an(o.writer,n),r=o.mapper.markerNameToElements(i.markerName);if(r){for(const e of r)o.mapper.unbindElementFromMarkerName(e,i.markerName),e.is("attributeElement")?o.writer.unwrap(o.writer.createRangeOn(e),s):e.getCustomProperty("removeHighlight")(e,n.id,o.writer);o.writer.clearClonedElementsGroup(i.markerName),t.stop()}}}function xn(e){return e=(0,on.Z)(e),e.view=Tn(e.view,"container"),t=>{if(t.on("insert:"+e.model,un(e.view),{priority:e.converterPriority||"normal"}),e.triggerBy){if(e.triggerBy.attributes)for(const i of e.triggerBy.attributes)t._mapReconversionTriggerEvent(e.model,`attribute:${i}:${e.model}`);if(e.triggerBy.children)for(const i of e.triggerBy.children)t._mapReconversionTriggerEvent(e.model,`insert:${i}`),t._mapReconversionTriggerEvent(e.model,`remove:${i}`)}}}function Vn(e){e=(0,on.Z)(e);const t=e.model.key?e.model.key:e.model;let i="attribute:"+t;if(e.model.name&&(i+=":"+e.model.name),e.model.values)for(const n of e.model.values)e.view[n]=Tn(e.view[n],"attribute");else e.view=Tn(e.view,"attribute");const o=In(e);return t=>{t.on(i,hn(o),{priority:e.converterPriority||"normal"})}}function En(e){e=(0,on.Z)(e);const t=e.model.key?e.model.key:e.model;let i="attribute:"+t;if(e.model.name&&(i+=":"+e.model.name),e.model.values)for(const n of e.model.values)e.view[n]=Dn(e.view[n]);else e.view=Dn(e.view);const o=In(e);return t=>{t.on(i,vn(o),{priority:e.converterPriority||"normal"})}}function An(e){return e=(0,on.Z)(e),e.view=Tn(e.view,"ui"),t=>{t.on("addMarker:"+e.model,mn(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,gn(e.view),{priority:e.converterPriority||"normal"})}}function Pn(e){e=(0,on.Z)(e);const t=e.model;return e.view||(e.view=i=>({group:t,name:i.substr(e.model.length+1)})),i=>{i.on("addMarker:"+t,pn(e.view),{priority:e.converterPriority||"normal"}),i.on("removeMarker:"+t,_n(e.view),{priority:e.converterPriority||"normal"})}}function Sn(e){return t=>{t.on("addMarker:"+e.model,yn(e.view),{priority:e.converterPriority||"normal"}),t.on("addMarker:"+e.model,Cn(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,kn(e.view),{priority:e.converterPriority||"normal"})}}function Tn(e,t){return"function"==typeof e?e:(i,o)=>Nn(e,o,t)}function Nn(e,t,i){let o;"string"==typeof e&&(e={name:e});const n=t.writer,s=Object.assign({},e.attributes);if("container"==i)o=n.createContainerElement(e.name,s);else if("attribute"==i){const t={priority:e.priority||nt.DEFAULT_PRIORITY};o=n.createAttributeElement(e.name,s,t)}else o=n.createUIElement(e.name,s);if(e.styles){const t=Object.keys(e.styles);for(const i of t)n.setStyle(i,e.styles[i],o)}if(e.classes){const t=e.classes;if("string"==typeof t)n.addClass(t,o);else for(const e of t)n.addClass(e,o)}return o}function In(e){return e.model.values?(t,i)=>{const o=e.view[t];return o?o(t,i):null}:e.view}function Dn(e){return"string"==typeof e?t=>({key:e,value:t}):"object"==typeof e?e.value?()=>e:t=>({key:e.key,value:t}):e}function Rn(e,t,i){const o="function"==typeof e?e(t,i):e;return o?(o.priority||(o.priority=10),o.id||(o.id=t.markerName),o):null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bn(e){const{schema:t,document:i}=e.model;for(const o of i.getRootNames()){const n=i.getRoot(o);if(n.isEmpty&&!t.checkChild(n,"$text")&&t.checkChild(n,"paragraph"))return e.insertElement("paragraph",n),!0}return!1}function Mn(e,t,i){const o=i.createContext(e);return!!i.checkChild(o,"paragraph")&&!!i.checkChild(o.push("paragraph"),t)}function On(e,t){const i=t.createElement("paragraph");return t.insert(i,e),t.createPositionAt(i,0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ln extends tn{elementToElement(e){return this.add(Zn(e))}elementToAttribute(e){return this.add(Hn(e))}attributeToAttribute(e){return this.add(Un(e))}elementToMarker(e){return this.add(Wn(e))}dataToMarker(e){return this.add(qn(e))}}function $n(){return(e,t,i)=>{if(!t.modelRange&&i.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:o}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=o}}}function Fn(){return(e,t,{schema:i,consumable:o,writer:n})=>{let s=t.modelCursor;if(!o.test(t.viewItem))return;if(!i.checkChild(s,"$text")){if(!Mn(s,"$text",i))return;s=On(s,n)}o.consume(t.viewItem);const r=n.createText(t.viewItem.data);n.insert(r,s),t.modelRange=n.createRange(s,s.getShiftedBy(r.offsetSize)),t.modelCursor=t.modelRange.end}}function zn(e,t){return(i,o)=>{const n=o.newSelection,s=[];for(const e of n.getRanges())s.push(t.toModelRange(e));const r=e.createSelection(s,{backward:n.isBackward});r.isEqual(e.document.selection)||e.change((e=>{e.setSelection(r)}))}}function Zn(e){e=(0,on.Z)(e);const t=Kn(e),i=jn(e.view),o=i?"element:"+i:"element";return i=>{i.on(o,t,{priority:e.converterPriority||"normal"})}}function Hn(e){e=(0,on.Z)(e),Qn(e);const t=Xn(e,!1),i=jn(e.view),o=i?"element:"+i:"element";return i=>{i.on(o,t,{priority:e.converterPriority||"low"})}}function Un(e){e=(0,on.Z)(e);let t=null;("string"==typeof e.view||e.view.key)&&(t=Yn(e)),Qn(e,t);const i=Xn(e,!0);return t=>{t.on("element",i,{priority:e.converterPriority||"low"})}}function Wn(e){return e=(0,on.Z)(e),is(e),Zn(e)}function qn(e){e=(0,on.Z)(e),e.model||(e.model=t=>t?e.view+":"+t:e.view);const t=Kn(os(e,"start")),i=Kn(os(e,"end"));return o=>{o.on("element:"+e.view+"-start",t,{priority:e.converterPriority||"normal"}),o.on("element:"+e.view+"-end",i,{priority:e.converterPriority||"normal"});const n=io.Z.get("low"),s=io.Z.get("highest"),r=io.Z.get(e.converterPriority)/s;o.on("element",Gn(e),{priority:n+r})}}function Gn(e){return(t,i,o)=>{const n=`data-${e.view}`;function s(t,n){for(const s of n){const n=e.model(s,o),r=o.writer.createElement("$marker",{"data-name":n});o.writer.insert(r,t),i.modelCursor.isEqual(t)?i.modelCursor=i.modelCursor.getShiftedBy(1):i.modelCursor=i.modelCursor._getTransformedByInsertion(t,1),i.modelRange=i.modelRange._getTransformedByInsertion(t,1)[0]}}(o.consumable.test(i.viewItem,{attributes:n+"-end-after"})||o.consumable.test(i.viewItem,{attributes:n+"-start-after"})||o.consumable.test(i.viewItem,{attributes:n+"-end-before"})||o.consumable.test(i.viewItem,{attributes:n+"-start-before"}))&&(i.modelRange||Object.assign(i,o.convertChildren(i.viewItem,i.modelCursor)),o.consumable.consume(i.viewItem,{attributes:n+"-end-after"})&&s(i.modelRange.end,i.viewItem.getAttribute(n+"-end-after").split(",")),o.consumable.consume(i.viewItem,{attributes:n+"-start-after"})&&s(i.modelRange.end,i.viewItem.getAttribute(n+"-start-after").split(",")),o.consumable.consume(i.viewItem,{attributes:n+"-end-before"})&&s(i.modelRange.start,i.viewItem.getAttribute(n+"-end-before").split(",")),o.consumable.consume(i.viewItem,{attributes:n+"-start-before"})&&s(i.modelRange.start,i.viewItem.getAttribute(n+"-start-before").split(",")))}}function jn(e){return"string"==typeof e?e:"object"==typeof e&&"string"==typeof e.name?e.name:null}function Kn(e){const t=new Q(e.view);return(i,o,n)=>{const s=t.match(o.viewItem);if(!s)return;const r=s.match;if(r.name=!0,!n.consumable.test(o.viewItem,r))return;const a=Jn(e.model,o.viewItem,n);a&&n.safeInsert(a,o.modelCursor)&&(n.consumable.consume(o.viewItem,r),n.convertChildren(o.viewItem,a),n.updateConversionResult(a,o))}}function Jn(e,t,i){return e instanceof Function?e(t,i):i.writer.createElement(e)}function Yn(e){"string"==typeof e.view&&(e.view={key:e.view});const t=e.view.key;let i;if("class"==t||"style"==t){const o="class"==t?"classes":"styles";i={[o]:e.view.value}}else{const o="undefined"==typeof e.view.value?/[\s\S]*/:e.view.value;i={attributes:{[t]:o}}}return e.view.name&&(i.name=e.view.name),e.view=i,t}function Qn(e,t=null){const i=null===t||(e=>e.getAttribute(t)),o="object"!=typeof e.model?e.model:e.model.key,n="object"!=typeof e.model||"undefined"==typeof e.model.value?i:e.model.value;e.model={key:o,value:n}}function Xn(e,t){const i=new Q(e.view);return(o,n,s)=>{const r=i.match(n.viewItem);if(!r)return;if(es(e.view,n.viewItem)?r.match.name=!0:delete r.match.name,!s.consumable.test(n.viewItem,r.match))return;const a=e.model.key,l="function"==typeof e.model.value?e.model.value(n.viewItem,s):e.model.value;if(null===l)return;n.modelRange||Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor));const c=ts(n.modelRange,{key:a,value:l},t,s);c&&s.consumable.consume(n.viewItem,r.match)}}function es(e,t){const i="function"==typeof e?e(t):e;return!("object"==typeof i&&!jn(i))&&(!i.classes&&!i.attributes&&!i.styles)}function ts(e,t,i,o){let n=!1;for(const s of Array.from(e.getItems({shallow:i})))o.schema.checkAttribute(s,t.key)&&(n=!0,s.hasAttribute(t.key)||o.writer.setAttribute(t.key,t.value,s));return n}function is(e){const t=e.model;e.model=(e,i)=>{const o="string"==typeof t?t:t(e,i);return i.writer.createElement("$marker",{"data-name":o})}}function os(e,t){const i={};return i.view=e.view+"-"+t,i.model=(t,i)=>{const o=t.getAttribute("name"),n=e.model(o,i);return i.writer.createElement("$marker",{"data-name":n})},i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ns{constructor(e,t){this.model=e,this.view=new bo(t),this.mapper=new Io,this.downcastDispatcher=new Bo({mapper:this.mapper,schema:e.schema});const i=this.model.document,o=i.selection,n=this.model.markers;this.listenTo(this.model,"_beforeChanges",(()=>{this.view._disableRendering(!0)}),{priority:"highest"}),this.listenTo(this.model,"_afterChanges",(()=>{this.view._disableRendering(!1)}),{priority:"lowest"}),this.listenTo(i,"change",(()=>{this.view.change((e=>{this.downcastDispatcher.convertChanges(i.differ,n,e),this.downcastDispatcher.convertSelection(o,n,e)}))}),{priority:"low"}),this.listenTo(this.view.document,"selectionChange",zn(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",sn(),{priority:"lowest"}),this.downcastDispatcher.on("remove",rn(),{priority:"low"}),this.downcastDispatcher.on("selection",dn(),{priority:"high"}),this.downcastDispatcher.on("selection",ln(),{priority:"low"}),this.downcastDispatcher.on("selection",cn(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using((e=>{if("$graveyard"==e.rootName)return null;const t=new Le(this.view.document,e.name);return t.rootName=e.rootName,this.mapper.bindElements(e,t),t}))}destroy(){this.view.destroy(),this.stopListening()}}(0,N.Z)(ns,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ss{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const i=this.get(e);if(!i)throw new S.ZP("commandcollection-command-not-found",this,{commandName:e});return i.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rs{constructor(){this._consumables=new Map}add(e,t){let i;e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?i=this._consumables.get(e):(i=new as(e),this._consumables.set(e,i)),i.add(t))}test(e,t){const i=this._consumables.get(e);return void 0===i?null:e.is("$text")||e.is("documentFragment")?i:i.test(t)}consume(e,t){return!!this.test(e,t)&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0)}revert(e,t){const i=this._consumables.get(e);void 0!==i&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):i.revert(t))}static consumablesFromElement(e){const t={element:e,name:!0,attributes:[],classes:[],styles:[]},i=e.getAttributeKeys();for(const s of i)"style"!=s&&"class"!=s&&t.attributes.push(s);const o=e.getClassNames();for(const s of o)t.classes.push(s);const n=e.getStyleNames();for(const s of n)t.styles.push(s);return t}static createFrom(e,t){if(t||(t=new rs(e)),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,rs.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const i of e.getChildren())t=rs.createFrom(i,t);return t}}class as{constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t in this._consumables)if(t in e){const i=this._test(t,e[t]);if(!0!==i)return i}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t in this._consumables)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._revert(t,e[t])}_add(e,t){const i=(0,Oi.Z)(t)?t:[t],o=this._consumables[e];for(const n of i){if("attributes"===e&&("class"===n||"style"===n))throw new S.ZP("viewconsumable-invalid-attribute",this);if(o.set(n,!0),"styles"===e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(n))o.set(e,!0)}}_test(e,t){const i=(0,Oi.Z)(t)?t:[t],o=this._consumables[e];for(const n of i)if("attributes"!==e||"class"!==n&&"style"!==n){const e=o.get(n);if(void 0===e)return null;if(!e)return!1}else{const e="class"==n?"classes":"styles",t=this._test(e,[...this._consumables[e].keys()]);if(!0!==t)return t}return!0}_consume(e,t){const i=(0,Oi.Z)(t)?t:[t],o=this._consumables[e];for(const n of i)if("attributes"!==e||"class"!==n&&"style"!==n){if(o.set(n,!1),"styles"==e)for(const e of this.element.document.stylesProcessor.getRelatedStyles(n))o.set(e,!1)}else{const e="class"==n?"classes":"styles";this._consume(e,[...this._consumables[e].keys()])}}_revert(e,t){const i=(0,Oi.Z)(t)?t:[t],o=this._consumables[e];for(const n of i)if("attributes"!==e||"class"!==n&&"style"!==n){const e=o.get(n);!1===e&&o.set(n,!0)}else{const e="class"==n?"classes":"styles";this._revert(e,[...this._consumables[e].keys()])}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ls{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",((e,t)=>{t[0]=new cs(t[0])}),{priority:"highest"}),this.on("checkChild",((e,t)=>{t[0]=new cs(t[0]),t[1]=this.getDefinition(t[1])}),{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new S.ZP("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new S.ZP("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return t="string"==typeof e?e:e.is&&(e.is("$text")||e.is("$textProxy"))?"$text":e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!(!t||!t.isBlock)}isLimit(e){const t=this.getDefinition(e);return!!t&&!(!t.isLimit&&!t.isObject)}isObject(e){const t=this.getDefinition(e);return!!t&&!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent)}isInline(e){const t=this.getDefinition(e);return!(!t||!t.isInline)}isSelectable(e){const t=this.getDefinition(e);return!!t&&!(!t.isSelectable&&!t.isObject)}isContent(e){const t=this.getDefinition(e);return!!t&&!(!t.isContent&&!t.isObject)}checkChild(e,t){return!!t&&this._checkContextMatch(t,e)}checkAttribute(e,t){const i=this.getDefinition(e.last);return!!i&&i.allowAttributes.includes(t)}checkMerge(e,t=null){if(e instanceof Ao){const t=e.nodeBefore,i=e.nodeAfter;if(!(t instanceof ko))throw new S.ZP("schema-check-merge-no-element-before",this);if(!(i instanceof ko))throw new S.ZP("schema-check-merge-no-element-after",this);return this.checkMerge(t,i)}for(const i of t.getChildren())if(!this.checkChild(e,i))return!1;return!0}addChildCheck(e){this.on("checkChild",((t,[i,o])=>{if(!o)return;const n=e(i,o);"boolean"==typeof n&&(t.stop(),t.return=n)}),{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",((t,[i,o])=>{const n=e(i,o);"boolean"==typeof n&&(t.stop(),t.return=n)}),{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;if(e instanceof Ao)t=e.parent;else{const i=e instanceof No?[e]:Array.from(e.getRanges());t=i.reduce(((e,t)=>{const i=t.getCommonAncestor();return e?e.getCommonAncestor(i,{includeSelf:!0}):i}),null)}while(!this.isLimit(t)){if(!t.parent)break;t=t.parent}return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const i=e.getFirstPosition(),o=[...i.getAncestors(),new vo("",e.getAttributes())];return this.checkAttribute(o,t)}{const i=e.getRanges();for(const e of i)for(const i of e)if(this.checkAttribute(i.item,t))return!0}return!1}*getValidRanges(e,t){e=Es(e);for(const i of e)yield*this._getValidRangesForRange(i,t)}getNearestSelectionRange(e,t="both"){if(this.checkChild(e,"$text"))return new No(e);let i,o;const n=e.getAncestors().reverse().find((e=>this.isLimit(e)))||e.root;"both"!=t&&"backward"!=t||(i=new Vo({boundaries:No._createIn(n),startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(o=new Vo({boundaries:No._createIn(n),startPosition:e}));for(const s of Vs(i,o)){const e=s.walker==i?"elementEnd":"elementStart",t=s.value;if(t.type==e&&this.isObject(t.item))return No._createOn(t.item);if(this.checkChild(t.nextPosition,"$text"))return new No(t.nextPosition)}return null}findAllowedParent(e,t){let i=e.parent;while(i){if(this.checkChild(i,t))return i;if(this.isLimit(i))return null;i=i.parent}return null}removeDisallowedAttributes(e,t){for(const i of e)if(i.is("$text"))As(this,i,t);else{const e=No._createIn(i),o=e.getPositions();for(const i of o){const e=i.nodeBefore||i.parent;As(this,e,t)}}}createContext(e){return new cs(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,i=Object.keys(t);for(const o of i)e[o]=ds(t[o],o);for(const o of i)hs(e,o);for(const o of i)us(e,o);for(const o of i)ms(e,o);for(const o of i)gs(e,o),ps(e,o);for(const o of i)fs(e,o),ws(e,o),bs(e,o);this._compiledDefinitions=e}_checkContextMatch(e,t,i=t.length-1){const o=t.getItem(i);if(e.allowIn.includes(o.name)){if(0==i)return!0;{const e=this.getDefinition(o);return this._checkContextMatch(e,t,i-1)}}return!1}*_getValidRangesForRange(e,t){let i=e.start,o=e.start;for(const n of e.getItems({shallow:!0}))n.is("element")&&(yield*this._getValidRangesForRange(No._createIn(n),t)),this.checkAttribute(n,t)||(i.isEqual(o)||(yield new No(i,o)),i=Ao._createAfter(n)),o=Ao._createAfter(n);i.isEqual(o)||(yield new No(i,o))}}(0,N.Z)(ls,Z.Z);class cs{constructor(e){if(e instanceof cs)return e;"string"==typeof e?e=[e]:Array.isArray(e)||(e=e.getAncestors({includeSelf:!0})),this._items=e.map(xs)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new cs([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map((e=>e.name))}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function ds(e,t){const i={name:t,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return _s(e,i),vs(e,i,"allowIn"),vs(e,i,"allowContentOf"),vs(e,i,"allowWhere"),vs(e,i,"allowAttributes"),vs(e,i,"allowAttributesOf"),vs(e,i,"allowChildren"),vs(e,i,"inheritTypesFrom"),ys(e,i),i}function hs(e,t){const i=e[t];for(const o of i.allowChildren){const i=e[o];i&&i.allowIn.push(t)}i.allowChildren.length=0}function us(e,t){for(const i of e[t].allowContentOf)if(e[i]){const o=Cs(e,i);o.forEach((e=>{e.allowIn.push(t)}))}delete e[t].allowContentOf}function ms(e,t){for(const i of e[t].allowWhere){const o=e[i];if(o){const i=o.allowIn;e[t].allowIn.push(...i)}}delete e[t].allowWhere}function gs(e,t){for(const i of e[t].allowAttributesOf){const o=e[i];if(o){const i=o.allowAttributes;e[t].allowAttributes.push(...i)}}delete e[t].allowAttributesOf}function ps(e,t){const i=e[t];for(const o of i.inheritTypesFrom){const t=e[o];if(t){const e=Object.keys(t).filter((e=>e.startsWith("is")));for(const o of e)o in i||(i[o]=t[o])}}delete i.inheritTypesFrom}function fs(e,t){const i=e[t],o=i.allowIn.filter((t=>e[t]));i.allowIn=Array.from(new Set(o))}function ws(e,t){const i=e[t];for(const o of i.allowIn){const i=e[o];i.allowChildren.push(t)}}function bs(e,t){const i=e[t];i.allowAttributes=Array.from(new Set(i.allowAttributes))}function _s(e,t){for(const i of e){const e=Object.keys(i).filter((e=>e.startsWith("is")));for(const o of e)t[o]=i[o]}}function vs(e,t,i){for(const o of e)"string"==typeof o[i]?t[i].push(o[i]):Array.isArray(o[i])&&t[i].push(...o[i])}function ys(e,t){for(const i of e){const e=i.inheritAllFrom;e&&(t.allowContentOf.push(e),t.allowWhere.push(e),t.allowAttributesOf.push(e),t.inheritTypesFrom.push(e))}}function Cs(e,t){const i=e[t];return ks(e).filter((e=>e.allowIn.includes(i.name)))}function ks(e){return Object.keys(e).map((t=>e[t]))}function xs(e){return"string"==typeof e||e.is("documentFragment")?{name:"string"==typeof e?e:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute(t){return e.getAttribute(t)}}}function*Vs(e,t){let i=!1;while(!i){if(i=!0,e){const t=e.next();t.done||(i=!1,yield{walker:e,value:t.value})}if(t){const e=t.next();e.done||(i=!1,yield{walker:t,value:e.value})}}}function*Es(e){for(const t of e)yield*t.getMinimalFlatRanges()}function As(e,t,i){for(const o of t.getAttributeKeys())e.checkAttribute(t,o)||i.removeAttribute(o,t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ps{constructor(e={}){this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.safeInsert=this._safeInsert.bind(this),this.conversionApi.updateConversionResult=this._updateConversionResult.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(e,t,i=["$root"]){this.fire("viewCleanup",e),this._modelCursor=Ts(i,t),this.conversionApi.writer=t,this.conversionApi.consumable=rs.createFrom(e),this.conversionApi.store={};const{modelRange:o}=this._convertItem(e,this._modelCursor),n=t.createDocumentFragment();if(o){this._removeEmptyElements();for(const e of Array.from(this._modelCursor.parent.getChildren()))t.append(e,n);n.markers=Ss(n,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,n}_convertItem(e,t){const i=Object.assign({viewItem:e,modelCursor:t,modelRange:null});if(e.is("element")?this.fire("element:"+e.name,i,this.conversionApi):e.is("$text")?this.fire("text",i,this.conversionApi):this.fire("documentFragment",i,this.conversionApi),i.modelRange&&!(i.modelRange instanceof No))throw new S.ZP("view-conversion-dispatcher-incorrect-result",this);return{modelRange:i.modelRange,modelCursor:i.modelCursor}}_convertChildren(e,t){let i=t.is("position")?t:Ao._createAt(t,0);const o=new No(i);for(const n of Array.from(e.getChildren())){const e=this._convertItem(n,i);e.modelRange instanceof No&&(o.end=e.modelRange.end,i=e.modelCursor)}return{modelRange:o,modelCursor:i}}_safeInsert(e,t){const i=this._splitToAllowedParent(e,t);return!!i&&(this.conversionApi.writer.insert(e,i.position),!0)}_updateConversionResult(e,t){const i=this._getSplitParts(e),o=this.conversionApi.writer;t.modelRange||(t.modelRange=o.createRange(o.createPositionBefore(e),o.createPositionAfter(i[i.length-1])));const n=this._cursorParents.get(e);t.modelCursor=n?o.createPositionAt(n,0):t.modelRange.end}_splitToAllowedParent(e,t){const{schema:i,writer:o}=this.conversionApi;let n=i.findAllowedParent(t,e);if(n){if(n===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(n)&&(n=null)}if(!n)return Mn(t,e,i)?{position:On(t,o)}:null;const s=this.conversionApi.writer.split(t,n),r=[];for(const l of s.range.getWalker())if("elementEnd"==l.type)r.push(l.item);else{const e=r.pop(),t=l.item;this._registerSplitPair(e,t)}const a=s.range.end.parent;return this._cursorParents.set(e,a),{position:s.position,cursorParent:a}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const i=this._splitParts.get(e);this._splitParts.set(t,i),i.push(t)}_getSplitParts(e){let t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}function Ss(e,t){const i=new Set,o=new Map,n=No._createIn(e).getItems();for(const s of n)"$marker"==s.name&&i.add(s);for(const s of i){const e=s.getAttribute("data-name"),i=t.createPositionBefore(s);o.has(e)?o.get(e).end=i.clone():o.set(e,new No(i.clone())),t.remove(s)}return o}function Ts(e,t){let i;for(const o of new cs(e)){const e={};for(const t of o.getAttributeKeys())e[t]=o.getAttribute(t);const n=t.createElement(o.name,e);i&&t.append(n,i),i=Ao._createAt(n,0)}return i}(0,N.Z)(Ps,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ns{getHtml(e){const t=document.implementation.createHTMLDocument(""),i=t.createElement("div");return i.appendChild(e),i.innerHTML}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Is{constructor(e){this.domParser=new DOMParser,this.domConverter=new gi(e,{renderingMode:"data"}),this.htmlWriter=new Ns}toData(e){const t=this.domConverter.viewToDom(e,document);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t)}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode="marked"==e?"markedNbsp":"nbsp"}_toDom(e){const t=this.domParser.parseFromString(e,"text/html"),i=t.createDocumentFragment();let o=t.firstChild;while(!o.isSameNode(t.documentElement)){const e=o;o=o.nextSibling,e.nodeType==Node.COMMENT_NODE&&i.appendChild(e)}const n=t.body.childNodes;while(n.length>0)i.appendChild(n[0]);return i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ds{constructor(e,t){this.model=e,this.mapper=new Io,this.downcastDispatcher=new Bo({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",sn(),{priority:"lowest"}),this.upcastDispatcher=new Ps({schema:e.schema}),this.viewDocument=new it(t),this.stylesProcessor=t,this.htmlProcessor=new Is(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new bt(this.viewDocument),this.upcastDispatcher.on("text",Fn(),{priority:"lowest"}),this.upcastDispatcher.on("element",$n(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",$n(),{priority:"lowest"}),this.decorate("init"),this.decorate("set"),this.decorate("get"),this.on("init",(()=>{this.fire("ready")}),{priority:"lowest"}),this.on("ready",(()=>{this.model.enqueueChange("transparent",Bn)}),{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:i="empty"}=e;if(!this._checkIfRootsExists([t]))throw new S.ZP("datacontroller-get-non-existent-root",this);const o=this.model.document.getRoot(t);return"empty"!==i||this.model.hasContent(o,{ignoreWhitespaces:!0})?this.stringify(o,e):""}stringify(e,t={}){const i=this.toView(e,t);return this.processor.toData(i)}toView(e,t={}){const i=this.viewDocument,o=this._viewWriter;this.mapper.clearBindings();const n=No._createIn(e),s=new ft(i);this.mapper.bindElements(e,s),this.downcastDispatcher.conversionApi.options=t,this.downcastDispatcher.convertInsert(n,o);const r=e.is("documentFragment")?Array.from(e.markers):Rs(e);for(const[a,l]of r)this.downcastDispatcher.convertMarkerAdd(a,l,o);return delete this.downcastDispatcher.conversionApi.options,s}init(e){if(this.model.document.version)throw new S.ZP("datacontroller-init-document-not-empty",this);let t={};if("string"===typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new S.ZP("datacontroller-init-non-existent-root",this);return this.model.enqueueChange("transparent",(e=>{for(const i of Object.keys(t)){const o=this.model.document.getRoot(i);e.insert(this.parse(t[i],o),o,0)}})),Promise.resolve()}set(e,t={}){let i={};if("string"===typeof e?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new S.ZP("datacontroller-set-non-existent-root",this);const o=t.batchType||"default";this.model.enqueueChange(o,(e=>{e.setSelection(null),e.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const t of Object.keys(i)){const o=this.model.document.getRoot(t);e.remove(e.createRangeIn(o)),e.insert(this.parse(i[t],o),o,0)}}))}parse(e,t="$root"){const i=this.processor.toView(e);return this.toModel(i,t)}toModel(e,t="$root"){return this.model.change((i=>this.upcastDispatcher.convert(e,i,t)))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRootNames().includes(t))return!1;return!0}}function Rs(e){const t=[],i=e.root.document;if(!i)return[];const o=No._createIn(e);for(const n of i.model.markers){const e=n.getRange(),i=e.isCollapsed,s=e.start.isEqual(o.start)||e.end.isEqual(o.end);if(i&&s)t.push([n.name,e]);else{const i=o.getIntersection(e);i&&t.push([n.name,i])}}return t.sort((([e,t],[i,o])=>{if("after"!==t.end.compareWith(o.start))return 1;if("before"!==t.start.compareWith(o.end))return-1;switch(t.start.compareWith(o.start)){case"before":return 1;case"after":return-1;default:switch(t.end.compareWith(o.end)){case"before":return 1;case"after":return-1;default:return i.localeCompare(e)}}}))}(0,N.Z)(Ds,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bs{constructor(e,t){this._helpers=new Map,this._downcast=(0,D.Z)(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=(0,D.Z)(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const i=this._downcast.includes(t),o=this._upcast.includes(t);if(!o&&!i)throw new S.ZP("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:i})}for(e){if(!this._helpers.has(e))throw new S.ZP("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:i}of Ms(e))this.for("upcast").elementToElement({model:t,view:i,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:i}of Ms(e))this.for("upcast").elementToAttribute({view:i,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:i}of Ms(e))this.for("upcast").attributeToAttribute({view:i,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:i}){if(this._helpers.has(e))throw new S.ZP("conversion-group-exists",this);const o=i?new nn(t):new Ln(t);this._helpers.set(e,o)}}function*Ms(e){if(e.model.values)for(const t of e.model.values){const i={key:e.model.key,value:t},o=e.view[t],n=e.upcastAlso?e.upcastAlso[t]:void 0;yield*Os(i,o,n)}else yield*Os(e.model,e.view,e.upcastAlso)}function*Os(e,t,i){if(yield{model:e,view:t},i)for(const o of(0,D.Z)(i))yield{model:e,view:o}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ls{constructor(e="default"){this.operations=[],this.type=e}get baseVersion(){for(const e of this.operations)if(null!==e.baseVersion)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $s{constructor(e){this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e){return new this(e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fs{constructor(e){this.markers=new Map,this._children=new Co,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"===e||"model:documentFragment"===e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const i of e)t=t.getChild(t.offsetToIndex(i));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const i of e)i.name?t.push(ko.fromJSON(i)):t.push(vo.fromJSON(i));return new Fs(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const i=zs(t);for(const o of i)null!==o.parent&&o._remove(),o.parent=this;this._children._insertNodes(e,i)}_removeChildren(e,t=1){const i=this._children._removeNodes(e,t);for(const o of i)o.parent=null;return i}}function zs(e){return"string"==typeof e?[new vo(e)]:((0,J.Z)(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new vo(e):e instanceof yo?new vo(e.data,e.getAttributes()):e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zs(e,t){t=qs(t);const i=t.reduce(((e,t)=>e+t.offsetSize),0),o=e.parent;js(e);const n=e.index;return o._insertChild(n,t),Gs(o,n+t.length),Gs(o,n),new No(e,e.getShiftedBy(i))}function Hs(e){if(!e.isFlat)throw new S.ZP("operation-utils-remove-range-not-flat",this);const t=e.start.parent;js(e.start),js(e.end);const i=t._removeChildren(e.start.index,e.end.index-e.start.index);return Gs(t,e.start.index),i}function Us(e,t){if(!e.isFlat)throw new S.ZP("operation-utils-move-range-not-flat",this);const i=Hs(e);return t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),Zs(t,i)}function Ws(e,t,i){js(e.start),js(e.end);for(const o of e.getItems({shallow:!0})){const e=o.is("$textProxy")?o.textNode:o;null!==i?e._setAttribute(t,i):e._removeAttribute(t),Gs(e.parent,e.index)}Gs(e.end.parent,e.end.index)}function qs(e){const t=[];e instanceof Array||(e=[e]);for(let i=0;i<e.length;i++)if("string"==typeof e[i])t.push(new vo(e[i]));else if(e[i]instanceof yo)t.push(new vo(e[i].data,e[i].getAttributes()));else if(e[i]instanceof Fs||e[i]instanceof Co)for(const o of e[i])t.push(o);else e[i]instanceof _o&&t.push(e[i]);for(let i=1;i<t.length;i++){const e=t[i],o=t[i-1];e instanceof vo&&o instanceof vo&&Ks(e,o)&&(t.splice(i-1,2,new vo(o.data+e.data,o.getAttributes())),i--)}return t}function Gs(e,t){const i=e.getChild(t-1),o=e.getChild(t);if(i&&o&&i.is("$text")&&o.is("$text")&&Ks(i,o)){const n=new vo(i.data+o.data,i.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,n)}}function js(e){const t=e.textNode,i=e.parent;if(t){const o=e.offset-t.startOffset,n=t.index;i._removeChildren(n,1);const s=new vo(t.data.substr(0,o),t.getAttributes()),r=new vo(t.data.substr(o),t.getAttributes());i._insertChild(n,[s,r])}}function Ks(e,t){const i=e.getAttributes(),o=t.getAttributes();for(const n of i){if(n[1]!==t.getAttribute(n[0]))return!1;o.next()}return o.next().done}var Js=i(50576);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ys extends $s{constructor(e,t,i,o,n){super(n),this.range=e.clone(),this.key=t,this.oldValue=void 0===i?null:i,this.newValue=void 0===o?null:o}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new Ys(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Ys(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new S.ZP("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!(0,Js.Z)(e.getAttribute(this.key),this.oldValue))throw new S.ZP("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&e.hasAttribute(this.key))throw new S.ZP("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){(0,Js.Z)(this.oldValue,this.newValue)||Ws(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new Ys(No.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qs extends $s{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new S.ZP("detach-operation-on-document-node",this)}_execute(){Hs(No._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xs extends $s{constructor(e,t,i,o){super(o),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,i=this.sourcePosition.offset,o=this.targetPosition.offset;if(i+this.howMany>e.maxOffset)throw new S.ZP("move-operation-nodes-do-not-exist",this);if(e===t&&i<o&&o<i+this.howMany)throw new S.ZP("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==U(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const e=this.sourcePosition.path.length-1;if(this.targetPosition.path[e]>=i&&this.targetPosition.path[e]<i+this.howMany)throw new S.ZP("move-operation-node-into-itself",this)}}_execute(){Us(No._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const i=Ao.fromJSON(e.sourcePosition,t),o=Ao.fromJSON(e.targetPosition,t);return new this(i,e.howMany,o,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class er extends $s{constructor(e,t,i){super(i),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Co(qs(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const e=new Co([...this.nodes].map((e=>e._clone(!0)))),t=new er(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new Ao(e,[0]);return new Xs(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new S.ZP("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Co([...e].map((e=>e._clone(!0)))),Zs(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const i=[];for(const n of e.nodes)n.name?i.push(ko.fromJSON(n)):i.push(vo.fromJSON(n));const o=new er(Ao.fromJSON(e.position,t),i,e.baseVersion);return o.shouldReceiveAttributes=e.shouldReceiveAttributes,o}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tr extends $s{constructor(e,t,i,o,n,s){super(s),this.name=e,this.oldRange=t?t.clone():null,this.newRange=i?i.clone():null,this.affectsData=n,this._markers=o}get type(){return"marker"}clone(){return new tr(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new tr(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const e=this.newRange?"_set":"_remove";this._markers[e](this.name,this.newRange,!0,this.affectsData)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new tr(e.name,e.oldRange?No.fromJSON(e.oldRange,t):null,e.newRange?No.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ir extends $s{constructor(e,t,i,o){super(o),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=i}get type(){return"rename"}clone(){return new ir(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new ir(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(!(e instanceof ko))throw new S.ZP("rename-operation-wrong-position",this);if(e.name!==this.oldName)throw new S.ZP("rename-operation-wrong-name",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new ir(Ao.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class or extends $s{constructor(e,t,i,o,n){super(n),this.root=e,this.key=t,this.oldValue=i,this.newValue=o}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new or(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new or(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new S.ZP("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new S.ZP("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new S.ZP("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new S.ZP("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new or(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nr extends $s{constructor(e,t,i,o,n){super(n),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=o.clone()}get type(){return"merge"}get deletionPosition(){return new Ao(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new No(this.sourcePosition,e)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),i=new Ao(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new sr(e,this.howMany,i,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new S.ZP("merge-operation-source-position-invalid",this);if(!t.parent)throw new S.ZP("merge-operation-target-position-invalid",this);if(this.howMany!=e.maxOffset)throw new S.ZP("merge-operation-how-many-invalid",this)}_execute(){const e=this.sourcePosition.parent,t=No._createIn(e);Us(t,this.targetPosition),Us(No._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const i=Ao.fromJSON(e.sourcePosition,t),o=Ao.fromJSON(e.targetPosition,t),n=Ao.fromJSON(e.graveyardPosition,t);return new this(i,e.howMany,o,n,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sr extends $s{constructor(e,t,i,o,n){super(n),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=i,this.graveyardPosition=o?o.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new Ao(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new No(this.splitPosition,e)}clone(){return new this.constructor(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new Ao(e,[0]);return new nr(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new S.ZP("split-operation-position-invalid",this);if(!e.parent)throw new S.ZP("split-operation-split-in-root",this);if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new S.ZP("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new S.ZP("split-operation-graveyard-position-invalid",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)Us(No._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const t=e._clone();Zs(this.insertionPosition,t)}const t=new No(Ao._createAt(e,this.splitPosition.offset),Ao._createAt(e,e.maxOffset));Us(t,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new Ao(e.root,t,"toPrevious")}static fromJSON(e,t){const i=Ao.fromJSON(e.splitPosition,t),o=Ao.fromJSON(e.insertionPosition,t),n=e.graveyardPosition?Ao.fromJSON(e.graveyardPosition,t):null;return new this(i,e.howMany,o,n,e.baseVersion)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rr extends ko{constructor(e,t,i="main"){super(t),this._document=e,this.rootName=i}get document(){return this._document}is(e,t){return t?t===this.name&&("rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e):"rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e||"node"===e||"model:node"===e}toJSON(){return this.rootName}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ar{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new vo(e,t)}createElement(e,t){return new ko(e,t)}createDocumentFragment(){return new Fs}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,i=0){if(this._assertWriterUsedCorrectly(),e instanceof vo&&""==e.data)return;const o=Ao._createAt(t,i);if(e.parent){if(ur(e.root,o.root))return void this.move(No._createOn(e),o);if(e.root.document)throw new S.ZP("model-writer-insert-forbidden-move",this);this.remove(e)}const n=o.root.document?o.root.document.version:null,s=new er(o,e,n);if(e instanceof vo&&(s.shouldReceiveAttributes=!0),this.batch.addOperation(s),this.model.applyOperation(s),e instanceof Fs)for(const[r,a]of e.markers){const e=Ao._createAt(a.root,0),t=new No(a.start._getCombined(e,o),a.end._getCombined(e,o)),i={range:t,usingOperation:!0,affectsData:!0};this.model.markers.has(r)?this.updateMarker(r,i):this.addMarker(r,i)}}insertText(e,t,i,o){t instanceof Fs||t instanceof ko||t instanceof Ao?this.insert(this.createText(e),t,i):this.insert(this.createText(e,t),i,o)}insertElement(e,t,i,o){t instanceof Fs||t instanceof ko||t instanceof Ao?this.insert(this.createElement(e),t,i):this.insert(this.createElement(e,t),i,o)}append(e,t){this.insert(e,t,"end")}appendText(e,t,i){t instanceof Fs||t instanceof ko?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),i,"end")}appendElement(e,t,i){t instanceof Fs||t instanceof ko?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),i,"end")}setAttribute(e,t,i){if(this._assertWriterUsedCorrectly(),i instanceof No){const o=i.getMinimalFlatRanges();for(const i of o)lr(this,e,t,i)}else cr(this,e,t,i)}setAttributes(e,t){for(const[i,o]of Y(e))this.setAttribute(i,o,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof No){const i=t.getMinimalFlatRanges();for(const t of i)lr(this,e,null,t)}else cr(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=e=>{for(const t of e.getAttributeKeys())this.removeAttribute(t,e)};if(e instanceof No)for(const i of e.getItems())t(i);else t(e)}move(e,t,i){if(this._assertWriterUsedCorrectly(),!(e instanceof No))throw new S.ZP("writer-move-invalid-range",this);if(!e.isFlat)throw new S.ZP("writer-move-range-not-flat",this);const o=Ao._createAt(t,i);if(o.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!ur(e.root,o.root))throw new S.ZP("writer-move-different-document",this);const n=e.root.document?e.root.document.version:null,s=new Xs(e.start,e.end.offset-e.start.offset,o,n);this.batch.addOperation(s),this.model.applyOperation(s)}remove(e){this._assertWriterUsedCorrectly();const t=e instanceof No?e:No._createOn(e),i=t.getMinimalFlatRanges().reverse();for(const o of i)this._addOperationForAffectedMarkers("move",o),hr(o.start,o.end.offset-o.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,i=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof ko))throw new S.ZP("writer-merge-no-element-before",this);if(!(i instanceof ko))throw new S.ZP("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,i){return this.model.createPositionFromPath(e,t,i)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(e,t,i){return this.model.createSelection(e,t,i)}_mergeDetached(e){const t=e.nodeBefore,i=e.nodeAfter;this.move(No._createIn(i),Ao._createAt(t,"end")),this.remove(i)}_merge(e){const t=Ao._createAt(e.nodeBefore,"end"),i=Ao._createAt(e.nodeAfter,0),o=e.root.document.graveyard,n=new Ao(o,[0]),s=e.root.document.version,r=new nr(i,e.nodeAfter.maxOffset,t,n,s);this.batch.addOperation(r),this.model.applyOperation(r)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof ko))throw new S.ZP("writer-rename-not-element-instance",this);const i=e.root.document?e.root.document.version:null,o=new ir(Ao._createBefore(e),e.name,t,i);this.batch.addOperation(o),this.model.applyOperation(o)}split(e,t){this._assertWriterUsedCorrectly();let i,o,n=e.parent;if(!n.parent)throw new S.ZP("writer-split-element-no-parent",this);if(t||(t=n.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new S.ZP("writer-split-invalid-limit-element",this);do{const t=n.root.document?n.root.document.version:null,s=n.maxOffset-e.offset,r=sr.getInsertionPosition(e),a=new sr(e,s,r,null,t);this.batch.addOperation(a),this.model.applyOperation(a),i||o||(i=n,o=e.parent.nextSibling),e=this.createPositionAfter(e.parent),n=e.parent}while(n!==t);return{position:e,range:new No(Ao._createAt(i,"end"),Ao._createAt(o,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new S.ZP("writer-wrap-range-not-flat",this);const i=t instanceof ko?t:new ko(t);if(i.childCount>0)throw new S.ZP("writer-wrap-element-not-empty",this);if(null!==i.parent)throw new S.ZP("writer-wrap-element-attached",this);this.insert(i,e.start);const o=new No(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(o,Ao._createAt(i,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new S.ZP("writer-unwrap-element-no-parent",this);this.move(No._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new S.ZP("writer-addmarker-no-usingoperation",this);const i=t.usingOperation,o=t.range,n=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new S.ZP("writer-addmarker-marker-exists",this);if(!o)throw new S.ZP("writer-addmarker-no-range",this);return i?(dr(this,e,null,o,n),this.model.markers.get(e)):this.model.markers._set(e,o,i,n)}updateMarker(e,t){this._assertWriterUsedCorrectly();const i="string"==typeof e?e:e.name,o=this.model.markers.get(i);if(!o)throw new S.ZP("writer-updatemarker-marker-not-exists",this);if(!t)return void this.model.markers._refresh(o);const n="boolean"==typeof t.usingOperation,s="boolean"==typeof t.affectsData,r=s?t.affectsData:o.affectsData;if(!n&&!t.range&&!s)throw new S.ZP("writer-updatemarker-wrong-options",this);const a=o.getRange(),l=t.range?t.range:a;n&&t.usingOperation!==o.managedUsingOperations?t.usingOperation?dr(this,i,null,l,r):(dr(this,i,a,null,r),this.model.markers._set(i,l,void 0,r)):o.managedUsingOperations?dr(this,i,a,l,r):this.model.markers._set(i,l,void 0,r)}removeMarker(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new S.ZP("writer-removemarker-no-marker",this);const i=this.model.markers.get(t);if(!i.managedUsingOperations)return void this.model.markers._remove(t);const o=i.getRange();dr(this,t,o,null,i.affectsData)}setSelection(e,t,i){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(e,t,i)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"===typeof e)this._setSelectionAttribute(e,t);else for(const[i,o]of Y(e))this._setSelectionAttribute(i,o)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"===typeof e)this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const o=Yo._getStoreAttributeKey(e);this.setAttribute(o,t,i.anchor.parent)}i._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const i=Yo._getStoreAttributeKey(e);this.removeAttribute(i,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new S.ZP("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const o=i.getRange();let n=!1;if("move"===e)n=t.containsPosition(o.start)||t.start.isEqual(o.start)||t.containsPosition(o.end)||t.end.isEqual(o.end);else{const e=t.nodeBefore,i=t.nodeAfter,s=o.start.parent==e&&o.start.isAtEnd,r=o.end.parent==i&&0==o.end.offset,a=o.end.nodeAfter==i,l=o.start.nodeAfter==i;n=s||r||a||l}n&&this.updateMarker(i.name,{range:o})}}}function lr(e,t,i,o){const n=e.model,s=n.document;let r,a,l,c=o.start;for(const h of o.getWalker({shallow:!0}))l=h.item.getAttribute(t),r&&a!=l&&(a!=i&&d(),c=r),r=h.nextPosition,a=l;function d(){const o=new No(c,r),l=o.root.document?s.version:null,d=new Ys(o,t,a,i,l);e.batch.addOperation(d),n.applyOperation(d)}r instanceof Ao&&r!=c&&a!=i&&d()}function cr(e,t,i,o){const n=e.model,s=n.document,r=o.getAttribute(t);let a,l;if(r!=i){const c=o.root===o;if(c){const e=o.document?s.version:null;l=new or(o,t,r,i,e)}else{a=new No(Ao._createBefore(o),e.createPositionAfter(o));const n=a.root.document?s.version:null;l=new Ys(a,t,r,i,n)}e.batch.addOperation(l),n.applyOperation(l)}}function dr(e,t,i,o,n){const s=e.model,r=s.document,a=new tr(t,i,o,s.markers,n,r.version);e.batch.addOperation(a),s.applyOperation(a)}function hr(e,t,i,o){let n;if(e.root.document){const i=o.document,s=new Ao(i.graveyard,[0]);n=new Xs(e,t,s,i.version)}else n=new Qs(e,t);i.addOperation(n),o.applyOperation(n)}function ur(e,t){return e===t||e instanceof rr&&t instanceof rr}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mr{constructor(e){this._markerCollection=e,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize);const t=No._createOn(e);for(const i of this._markerCollection.getMarkersIntersectingRange(t)){const e=i.getRange();this.bufferMarkerChange(i.name,e,e,i.affectsData)}this._cachedChanges=null}bufferOperation(e){switch(e.type){case"insert":if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const t of e.range.getItems({shallow:!0}))this._isInInsertedElement(t.parent)||this._markAttribute(t);break;case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const t=this._isInInsertedElement(e.sourcePosition.parent),i=this._isInInsertedElement(e.targetPosition.parent);t||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),i||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const t=No._createFromPositionAndShift(e.position,1);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}break}case"split":{const t=e.splitPosition.parent;this._isInInsertedElement(t)||this._markRemove(t,e.splitPosition.offset,e.howMany),this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1);break}case"merge":{const t=e.sourcePosition.parent;this._isInInsertedElement(t.parent)||this._markRemove(t.parent,t.startOffset,1);const i=e.graveyardPosition.parent;this._markInsert(i,e.graveyardPosition.offset,1);const o=e.targetPosition.parent;this._isInInsertedElement(o)||this._markInsert(o,e.targetPosition.offset,t.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(e,t,i,o){const n=this._changedMarkers.get(e);n?(n.newRange=i,n.affectsData=o,null==n.oldRange&&null==n.newRange&&this._changedMarkers.delete(e)):this._changedMarkers.set(e,{oldRange:t,newRange:i,affectsData:o})}getMarkersToRemove(){const e=[];for(const[t,i]of this._changedMarkers)null!=i.oldRange&&e.push({name:t,range:i.oldRange});return e}getMarkersToAdd(){const e=[];for(const[t,i]of this._changedMarkers)null!=i.newRange&&e.push({name:t,range:i.newRange});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map((e=>({name:e[0],data:{oldRange:e[1].oldRange,newRange:e[1].newRange}})))}hasDataChanges(){for(const[,e]of this._changedMarkers)if(e.affectsData)return!0;return this._changesInElement.size>0}getChanges(e={includeChangesInGraveyard:!1}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const i of this._changesInElement.keys()){const e=this._changesInElement.get(i).sort(((e,t)=>e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1)),o=this._elementSnapshots.get(i),n=gr(i.getChildren()),s=pr(o.length,e);let r=0,a=0;for(const l of s)if("i"===l)t.push(this._getInsertDiff(i,r,n[r].name)),r++;else if("r"===l)t.push(this._getRemoveDiff(i,r,o[a].name)),a++;else if("a"===l){const e=n[r].attributes,s=o[a].attributes;let l;if("$text"==n[r].name)l=new No(Ao._createAt(i,r),Ao._createAt(i,r+1));else{const e=i.offsetToIndex(r);l=new No(Ao._createAt(i,r),Ao._createAt(i.getChild(e),0))}t.push(...this._getAttributesDiff(l,s,e)),r++,a++}else r++,a++}t.sort(((e,t)=>e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1));for(let i=1,o=0;i<t.length;i++){const e=t[o],n=t[i],s="remove"==e.type&&"remove"==n.type&&"$text"==e.name&&"$text"==n.name&&e.position.isEqual(n.position),r="insert"==e.type&&"insert"==n.type&&"$text"==e.name&&"$text"==n.name&&e.position.parent==n.position.parent&&e.position.offset+e.length==n.position.offset,a="attribute"==e.type&&"attribute"==n.type&&e.position.parent==n.position.parent&&e.range.isFlat&&n.range.isFlat&&e.position.offset+e.length==n.position.offset&&e.attributeKey==n.attributeKey&&e.attributeOldValue==n.attributeOldValue&&e.attributeNewValue==n.attributeNewValue;s||r||a?(e.length++,a&&(e.range.end=e.range.end.getShiftedBy(1)),t[i]=null):o=i}t=t.filter((e=>e));for(const i of t)delete i.changeCount,"attribute"==i.type&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t.slice(),this._cachedChanges=t.filter(fr),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(e,t,i){const o={type:"insert",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,o)}_markRemove(e,t,i){const o={type:"remove",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,o),this._removeAllNestedChanges(e,t,i)}_markAttribute(e){const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const i=this._getChangesForElement(e);this._handleChange(t,i),i.push(t);for(let o=0;o<i.length;o++)i[o].howMany<1&&(i.splice(o,1),o--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,gr(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const i of t){const o=e.offset+e.howMany,n=i.offset+i.howMany;if("insert"==e.type&&("insert"==i.type&&(e.offset<=i.offset?i.offset+=e.howMany:e.offset<n&&(i.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==i.type&&e.offset<i.offset&&(i.offset+=e.howMany),"attribute"==i.type))if(e.offset<=i.offset)i.offset+=e.howMany;else if(e.offset<n){const n=i.howMany;i.howMany=e.offset-i.offset,t.unshift({type:"attribute",offset:o,howMany:n-i.howMany,count:this._changeCount++})}if("remove"==e.type){if("insert"==i.type)if(o<=i.offset)i.offset-=e.howMany;else if(o<=n)if(e.offset<i.offset){const t=o-i.offset;i.offset=e.offset,i.howMany-=t,e.nodesToHandle-=t}else i.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=i.offset)e.nodesToHandle-=i.howMany,i.howMany=0;else if(e.offset<n){const t=n-e.offset;i.howMany-=t,e.nodesToHandle-=t}if("remove"==i.type&&(o<=i.offset?i.offset-=e.howMany:e.offset<i.offset&&(e.nodesToHandle+=i.howMany,i.howMany=0)),"attribute"==i.type)if(o<=i.offset)i.offset-=e.howMany;else if(e.offset<i.offset){const t=o-i.offset;i.offset=e.offset,i.howMany-=t}else if(e.offset<n)if(o<=n){const o=i.howMany;i.howMany=e.offset-i.offset;const n=o-i.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:n,count:this._changeCount++})}else i.howMany-=n-e.offset}if("attribute"==e.type){if("insert"==i.type)if(e.offset<i.offset&&o>i.offset){if(o>n){const e={type:"attribute",offset:n,howMany:o-n,count:this._changeCount++};this._handleChange(e,t),t.push(e)}e.nodesToHandle=i.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=i.offset&&e.offset<n&&(o>n?(e.nodesToHandle=o-n,e.offset=n):e.nodesToHandle=0);if("remove"==i.type&&e.offset<i.offset&&o>i.offset){const n={type:"attribute",offset:i.offset,howMany:o-i.offset,count:this._changeCount++};this._handleChange(n,t),t.push(n),e.nodesToHandle=i.offset-e.offset,e.howMany=e.nodesToHandle}"attribute"==i.type&&(e.offset>=i.offset&&o<=n?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=i.offset&&o>=n&&(i.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,i){return{type:"insert",position:Ao._createAt(e,t),name:i,length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,t,i){return{type:"remove",position:Ao._createAt(e,t),name:i,length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,i){const o=[];i=new Map(i);for(const[n,s]of t){const t=i.has(n)?i.get(n):null;t!==s&&o.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:n,attributeOldValue:s,attributeNewValue:t,changeCount:this._changeCount++}),i.delete(n)}for(const[n,s]of i)o.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:n,attributeOldValue:null,attributeNewValue:s,changeCount:this._changeCount++});return o}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const i=this._changesInElement.get(t),o=e.startOffset;if(i)for(const n of i)if("insert"==n.type&&o>=n.offset&&o<n.offset+n.howMany)return!0;return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,i){const o=new No(Ao._createAt(e,t),Ao._createAt(e,t+i));for(const n of o.getItems({shallow:!0}))n.is("element")&&(this._elementSnapshots.delete(n),this._changesInElement.delete(n),this._removeAllNestedChanges(n,0,n.maxOffset))}}function gr(e){const t=[];for(const i of e)if(i.is("$text"))for(let e=0;e<i.data.length;e++)t.push({name:"$text",attributes:new Map(i.getAttributes())});else t.push({name:i.name,attributes:new Map(i.getAttributes())});return t}function pr(e,t){const i=[];let o=0,n=0;for(const s of t){if(s.offset>o){for(let e=0;e<s.offset-o;e++)i.push("e");n+=s.offset-o}if("insert"==s.type){for(let e=0;e<s.howMany;e++)i.push("i");o=s.offset+s.howMany}else if("remove"==s.type){for(let e=0;e<s.howMany;e++)i.push("r");o=s.offset,n+=s.howMany}else i.push(..."a".repeat(s.howMany).split("")),o=s.offset+s.howMany,n+=s.howMany}if(n<e)for(let s=0;s<e-n-o;s++)i.push("e");return i}function fr(e){const t=e.position&&"$graveyard"==e.position.root.rootName,i=e.range&&"$graveyard"==e.range.root.rootName;return!t&&!i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wr{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(e){this._operations.includes(e)||this._operations.push(e)}getOperations(e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY){const i=[];for(const o of this._operations)o.baseVersion>=e&&o.baseVersion<t&&i.push(o);return i}getOperation(e){for(const t of this._operations)if(t.baseVersion==e)return t}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function br(e){return!!e&&1==e.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(e)}function _r(e){return!!e&&1==e.length&&/[\ud800-\udbff]/.test(e)}function vr(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e)}function yr(e,t){return _r(e.charAt(t-1))&&vr(e.charAt(t))}function Cr(e,t){return br(e.charAt(t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const kr="$graveyard";class xr{constructor(e){this.model=e,this.version=0,this.history=new wr(this),this.selection=new Yo(this),this.roots=new P.Z({idProperty:"rootName"}),this.differ=new mr(e.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",kr),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];if(i.isDocumentOperation&&i.baseVersion!==this.version)throw new S.ZP("model-document-applyoperation-wrong-version",this,{operation:i})}),{priority:"highest"}),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&this.differ.bufferOperation(i)}),{priority:"high"}),this.listenTo(e,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&(this.version++,this.history.addOperation(i))}),{priority:"low"}),this.listenTo(this.selection,"change",(()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0})),this.listenTo(e.markers,"update",((e,t,i,o)=>{this.differ.bufferMarkerChange(t.name,i,o,t.affectsData),null===i&&t.on("change",((e,i)=>{this.differ.bufferMarkerChange(t.name,i,t.getRange(),t.affectsData)}))}))}get graveyard(){return this.getRoot(kr)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new S.ZP("model-document-createroot-name-exists",this,{name:t});const i=new rr(this,e,t);return this.roots.add(i),i}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(){return Array.from(this.roots,(e=>e.rootName)).filter((e=>e!=kr))}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=(0,W.Z)(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const e of this.roots)if(e!==this.graveyard)return e;return this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,i=t.schema,o=t.createPositionFromPath(e,[0]),n=i.getNearestSelectionRange(o);return n||t.createRange(o)}_validateSelectionRange(e){return Vr(e.start)&&Vr(e.end)}_callPostFixers(e){let t=!1;do{for(const i of this._postFixers)if(this.selection.refresh(),t=i(e),t)break}while(t)}}function Vr(e){const t=e.textNode;if(t){const i=t.data,o=e.offset-t.startOffset;return!yr(i,o)&&!Cr(i,o)}return!0}(0,N.Z)(xr,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Er{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof Ar?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,i=!1,o=!1){const n=e instanceof Ar?e.name:e;if(n.includes(","))throw new S.ZP("markercollection-incorrect-marker-name",this);const s=this._markers.get(n);if(s){const e=s.getRange();let r=!1;return e.isEqual(t)||(s._attachLiveRange(qo.fromRange(t)),r=!0),i!=s.managedUsingOperations&&(s._managedUsingOperations=i,r=!0),"boolean"===typeof o&&o!=s.affectsData&&(s._affectsData=o,r=!0),r&&this.fire("update:"+n,s,e,t),s}const r=qo.fromRange(t),a=new Ar(n,r,i,o);return this._markers.set(n,a),this.fire("update:"+n,a,null,t),a}_remove(e){const t=e instanceof Ar?e.name:e,i=this._markers.get(t);return!!i&&(this._markers.delete(t),this.fire("update:"+t,i,i.getRange(),null),this._destroyMarker(i),!0)}_refresh(e){const t=e instanceof Ar?e.name:e,i=this._markers.get(t);if(!i)throw new S.ZP("markercollection-refresh-marker-not-exists",this);const o=i.getRange();this.fire("update:"+t,i,o,o,i.managedUsingOperations,i.affectsData)}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)null!==t.getRange().getIntersection(e)&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}(0,N.Z)(Er,T.ZP);class Ar{constructor(e,t,i,o){this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=i,this._affectsData=o}get managedUsingOperations(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._affectsData}getStart(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new S.ZP("marker-destroyed",this);return this._liveRange.toRange()}is(e){return"marker"===e||"model:marker"===e}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}(0,N.Z)(Ar,T.ZP);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pr extends $s{get type(){return"noop"}clone(){return new Pr(this.baseVersion)}getReversed(){return new Pr(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Sr={};Sr[Ys.className]=Ys,Sr[er.className]=er,Sr[tr.className]=tr,Sr[Xs.className]=Xs,Sr[Pr.className]=Pr,Sr[$s.className]=$s,Sr[ir.className]=ir,Sr[or.className]=or,Sr[sr.className]=sr,Sr[nr.className]=nr;class Tr{static fromJSON(e,t){return Sr[e.__className].fromJSON(e,t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nr extends Ao{constructor(e,t,i="toNone"){if(super(e,t,i),!this.root.is("rootElement"))throw new S.ZP("model-liveposition-root-not-rootelement",e);Ir.call(this)}detach(){this.stopListening()}is(e){return"livePosition"===e||"model:livePosition"===e||"position"==e||"model:position"===e}toPosition(){return new Ao(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}function Ir(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const i=t[0];i.isDocumentOperation&&Dr.call(this,i)}),{priority:"low"})}function Dr(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Rr(e,t,i,o){return e.change((n=>{let s;s=i?i instanceof Fo||i instanceof Yo?i:n.createSelection(i,o):e.document.selection,s.isCollapsed||e.deleteContent(s,{doNotAutoparagraph:!0});const r=new Br(e,n,s.anchor);let a;a=t.is("documentFragment")?t.getChildren():[t],r.handleNodes(a);const l=r.getSelectionRange();l&&(s instanceof Yo?n.setSelection(l):s.setTo(l));const c=r.getAffectedRange()||e.createRange(s.anchor);return r.destroy(),c}))}(0,N.Z)(Nr,T.ZP);class Br{constructor(e,t,i){this.model=e,this.writer=t,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0),this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(e);if(i.isAfter(t)){if(this._lastNode=e,this.position.parent!=e||!this.position.isAtEnd)throw new S.ZP("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this.nodeToSelect?No._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new No(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(this.schema.isObject(e))return void this._handleObject(e);let t=this._checkAndAutoParagraphToAllowedPosition(e);t||(t=this._checkAndSplitToAllowedPosition(e),t)?(this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e):this._handleDisallowedNode(e)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=Nr.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleObject(e){this._checkAndSplitToAllowedPosition(e)?this._appendToFragment(e):this._tryAutoparagraphing(e)}_handleDisallowedNode(e){e.is("element")?this.handleNodes(e.getChildren()):this._tryAutoparagraphing(e)}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new S.ZP("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=e:this.nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=Nr.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Nr.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof ko))return;if(!this._canMergeLeft(e))return;const t=Nr._createBefore(e);t.stickiness="toNext";const i=Nr.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=Nr._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=Nr._createAt(t.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof ko))return;if(!this._canMergeRight(e))return;const t=Nr._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new S.ZP("insertcontent-invalid-insertion-position",this);this.position=Ao._createAt(t.nodeBefore,"end");const i=Nr.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=Nr._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=Nr._createAt(t.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof ko&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof ko&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_tryAutoparagraphing(e){const t=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,t)&&this.schema.checkChild(t,e)&&(t._appendChild(e),this._handleNode(t))}_checkAndAutoParagraphToAllowedPosition(e){if(this.schema.checkChild(this.position.parent,e))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",e))return!1;this._insertPartialFragment();const t=this.writer.createElement("paragraph");return this.writer.insert(t,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=t,this.position=this.writer.createPositionAt(t,0),!0}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;t!=this.position.parent&&this._insertPartialFragment();while(t!=this.position.parent)if(this.position.isAtStart){const e=this.position.parent;this.position=this.writer.createPositionBefore(e),e.isEmpty&&e.parent===t&&this.writer.remove(e)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const e=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=e,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Mr(e,t,i={}){if(t.isCollapsed)return;const o=t.getFirstRange();if("$graveyard"==o.root.rootName)return;const n=e.schema;e.change((e=>{if(!i.doNotResetEntireContent&&Kr(n,t))return void jr(e,t,n);const[s,r]=Or(o);s.isTouching(r)||e.remove(e.createRange(s,r)),i.leaveUnmerged||($r(e,s,r),n.removeDisallowedAttributes(s.parent.getChildren(),e)),Jr(e,t,s),!i.doNotAutoparagraph&&Wr(n,s)&&Gr(e,s,t),s.detach(),r.detach()}))}function Or(e){const t=e.root.document.model,i=e.start;let o=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const i=Lr(o);if(i&&o.isTouching(t.createPositionAt(i,0))){const i=t.createSelection(e);t.modifySelection(i,{direction:"backward"});const n=i.getLastPosition(),s=t.createRange(n,o);t.hasContent(s,{ignoreMarkers:!0})||(o=n)}}return[Nr.fromPosition(i,"toPrevious"),Nr.fromPosition(o,"toNext")]}function Lr(e){const t=e.parent,i=t.root.document.model.schema,o=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const n of o){if(i.isLimit(n))return null;if(i.isBlock(n))return n}}function $r(e,t,i){const o=e.model;if(!Hr(e.model.schema,t,i))return;const[n,s]=Ur(t,i);n&&s&&(!o.hasContent(n,{ignoreMarkers:!0})&&o.hasContent(s,{ignoreMarkers:!0})?zr(e,t,i,n.parent):Fr(e,t,i,n.parent))}function Fr(e,t,i,o){const n=t.parent,s=i.parent;if(n!=o&&s!=o){t=e.createPositionAfter(n),i=e.createPositionBefore(s),i.isEqual(t)||e.insert(s,t),e.merge(t);while(i.parent.isEmpty){const t=i.parent;i=e.createPositionBefore(t),e.remove(t)}Hr(e.model.schema,t,i)&&Fr(e,t,i,o)}}function zr(e,t,i,o){const n=t.parent,s=i.parent;if(n!=o&&s!=o){t=e.createPositionAfter(n),i=e.createPositionBefore(s),i.isEqual(t)||e.insert(n,i);while(t.parent.isEmpty){const i=t.parent;t=e.createPositionBefore(i),e.remove(i)}i=e.createPositionBefore(s),Zr(e,i),Hr(e.model.schema,t,i)&&zr(e,t,i,o)}}function Zr(e,t){const i=t.nodeBefore,o=t.nodeAfter;i.name!=o.name&&e.rename(i,o.name),e.clearAttributes(i),e.setAttributes(Object.fromEntries(o.getAttributes()),i),e.merge(t)}function Hr(e,t,i){const o=t.parent,n=i.parent;return o!=n&&(!e.isLimit(o)&&!e.isLimit(n)&&qr(t,i,e))}function Ur(e,t){const i=e.getAncestors(),o=t.getAncestors();let n=0;while(i[n]&&i[n]==o[n])n++;return[i[n],o[n]]}function Wr(e,t){const i=e.checkChild(t,"$text"),o=e.checkChild(t,"paragraph");return!i&&o}function qr(e,t,i){const o=new No(e,t);for(const n of o.getWalker())if(i.isLimit(n.item))return!1;return!0}function Gr(e,t,i){const o=e.createElement("paragraph");e.insert(o,t),Jr(e,i,e.createPositionAt(o,0))}function jr(e,t){const i=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(i)),Gr(e,e.createPositionAt(i,0),t)}function Kr(e,t){const i=e.getLimitElement(t);if(!t.containsEntireContent(i))return!1;const o=t.getFirstRange();return o.start.parent!=o.end.parent&&e.checkChild(i,"paragraph")}function Jr(e,t,i){t instanceof Yo?e.setSelection(i):t.setTo(i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yr=' ,.?!:;"-()';function Qr(e,t,i={}){const o=e.schema,n="backward"!=i.direction,s=i.unit?i.unit:"character",r=t.focus,a=new Vo({boundaries:ia(r,n),singleCharacters:!0,direction:n?"forward":"backward"}),l={walker:a,schema:o,isForward:n,unit:s};let c;while(c=a.next()){if(c.done)return;const i=Xr(l,c.value);if(i)return void(t instanceof Yo?e.change((e=>{e.setSelectionFocus(i)})):t.setFocus(i))}}function Xr(e,t){const{isForward:i,walker:o,unit:n,schema:s}=e,{type:r,item:a,nextPosition:l}=t;if("text"==r)return"word"===e.unit?ta(o,i):ea(o,n,i);if(r==(i?"elementStart":"elementEnd")){if(s.isSelectable(a))return Ao._createAt(a,i?"after":"before");if(s.checkChild(l,"$text"))return l}else{if(s.isLimit(a))return void o.skip((()=>!0));if(s.checkChild(l,"$text"))return l}}function ea(e,t){const i=e.position.textNode;if(i){const o=i.data;let n=e.position.offset-i.startOffset;while(yr(o,n)||"character"==t&&Cr(o,n))e.next(),n=e.position.offset-i.startOffset}return e.position}function ta(e,t){let i=e.position.textNode;if(i){let o=e.position.offset-i.startOffset;while(!oa(i.data,o,t)&&!na(i,o,t)){e.next();const n=t?e.position.nodeAfter:e.position.nodeBefore;if(n&&n.is("$text")){const o=n.data.charAt(t?0:n.data.length-1);Yr.includes(o)||(e.next(),i=e.position.textNode)}o=e.position.offset-i.startOffset}}return e.position}function ia(e,t){const i=e.root,o=Ao._createAt(i,t?"end":0);return t?new No(e,o):new No(o,e)}function oa(e,t,i){const o=t+(i?0:-1);return Yr.includes(e.charAt(o))}function na(e,t,i){return t===(i?e.endOffset:0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function sa(e,t){return e.change((e=>{const i=e.createDocumentFragment(),o=t.getFirstRange();if(!o||o.isCollapsed)return i;const n=o.start.root,s=o.start.getCommonPath(o.end),r=n.getNodeByPath(s);let a;a=o.start.parent==o.end.parent?o:e.createRange(e.createPositionAt(r,o.start.path[s.length]),e.createPositionAt(r,o.end.path[s.length]+1));const l=a.end.offset-a.start.offset;for(const t of a.getItems({shallow:!0}))t.is("$textProxy")?e.appendText(t.data,t.getAttributes(),i):e.append(e.cloneElement(t,!0),i);if(a!=o){const t=o._getTransformedByMove(a.start,e.createPositionAt(i,0),l)[0],n=e.createRange(e.createPositionAt(i,0),t.start),s=e.createRange(t.end,e.createPositionAt(i,"end"));ra(s,e),ra(n,e)}return i}))}function ra(e,t){const i=[];Array.from(e.getItems({direction:"backward"})).map((e=>t.createRangeOn(e))).filter((t=>{const i=(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end));return i})).forEach((e=>{i.push(e.start.parent),t.remove(e)})),i.forEach((e=>{let i=e;while(i.parent&&i.isEmpty){const e=t.createRangeOn(i);i=i.parent,t.remove(e)}}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function aa(e){e.document.registerPostFixer((t=>la(t,e)))}function la(e,t){const i=t.document.selection,o=t.schema,n=[];let s=!1;for(const r of i.getRanges()){const e=ca(r,o);e&&!e.isEqual(r)?(n.push(e),s=!0):n.push(r)}s&&e.setSelection(ga(n),{backward:i.isBackward})}function ca(e,t){return e.isCollapsed?da(e,t):ha(e,t)}function da(e,t){const i=e.start,o=t.getNearestSelectionRange(i);if(!o){const e=i.getAncestors().reverse().find((e=>t.isObject(e)));return e?No._createOn(e):null}if(!o.isCollapsed)return o;const n=o.start;return i.isEqual(n)?null:new No(n)}function ha(e,t){const{start:i,end:o}=e,n=t.checkChild(i,"$text"),s=t.checkChild(o,"$text"),r=t.getLimitElement(i),a=t.getLimitElement(o);if(r===a){if(n&&s)return null;if(ma(i,o,t)){const e=i.nodeAfter&&t.isSelectable(i.nodeAfter),n=e?null:t.getNearestSelectionRange(i,"forward"),s=o.nodeBefore&&t.isSelectable(o.nodeBefore),r=s?null:t.getNearestSelectionRange(o,"backward"),a=n?n.start:i,l=r?r.end:o;return new No(a,l)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const e=i.nodeAfter&&o.nodeBefore&&i.nodeAfter.parent===o.nodeBefore.parent,n=l&&(!e||!pa(i.nodeAfter,t)),s=c&&(!e||!pa(o.nodeBefore,t));let d=i,h=o;return n&&(d=Ao._createBefore(ua(r,t))),s&&(h=Ao._createAfter(ua(a,t))),new No(d,h)}return null}function ua(e,t){let i=e,o=i;while(t.isLimit(o)&&o.parent)i=o,o=o.parent;return i}function ma(e,t,i){const o=e.nodeAfter&&!i.isLimit(e.nodeAfter)||i.checkChild(e,"$text"),n=t.nodeBefore&&!i.isLimit(t.nodeBefore)||i.checkChild(t,"$text");return o||n}function ga(e){const t=[...e],i=new Set;let o=1;while(o<t.length){const e=t[o],n=t.slice(0,o);for(const[s,r]of n.entries())if(!i.has(s))if(e.isEqual(r))i.add(s);else if(e.isIntersecting(r)){i.add(s),i.add(o);const n=e.getJoined(r);t.push(n)}o++}const n=t.filter(((e,t)=>!i.has(t)));return n}function pa(e,t){return e&&t.isSelectable(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fa{constructor(){this.markers=new Er,this.document=new xr(this),this.schema=new ls,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach((e=>this.decorate(e))),this.on("applyOperation",((e,t)=>{const i=t[0];i._validate()}),{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(((e,t)=>{if("$marker"===t.name)return!0})),aa(this),this.document.registerPostFixer(Bn)}change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new Ls,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){S.ZP.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{"string"===typeof e?e=new Ls(e):"function"==typeof e&&(t=e,e=new Ls),this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(i){S.ZP.rethrowUnexpectedError(i,this)}}applyOperation(e){e._execute()}insertContent(e,t,i){return Rr(this,e,t,i)}deleteContent(e,t){Mr(this,e,t)}modifySelection(e,t){Qr(this,e,t)}getSelectedContent(e){return sa(this,e)}hasContent(e,t={}){const i=e instanceof ko?No._createIn(e):e;if(i.isCollapsed)return!1;const{ignoreWhitespaces:o=!1,ignoreMarkers:n=!1}=t;if(!n)for(const s of this.markers.getMarkersIntersectingRange(i))if(s.affectsData)return!0;for(const s of i.getItems())if(this.schema.isContent(s)){if(!s.is("$textProxy"))return!0;if(!o)return!0;if(-1!==s.data.search(/\S/))return!0}return!1}createPositionFromPath(e,t,i){return new Ao(e,t,i)}createPositionAt(e,t){return Ao._createAt(e,t)}createPositionAfter(e){return Ao._createAfter(e)}createPositionBefore(e){return Ao._createBefore(e)}createRange(e,t){return new No(e,t)}createRangeIn(e){return No._createIn(e)}createRangeOn(e){return No._createOn(e)}createSelection(e,t,i){return new Fo(e,t,i)}createBatch(e){return new Ls(e)}createOperationFromJSON(e){return Tr.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");while(this._pendingChanges.length){const t=this._pendingChanges[0].batch;this._currentWriter=new ar(this,t);const i=this._pendingChanges[0].callback(this._currentWriter);e.push(i),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),e}}(0,N.Z)(fa,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wa extends to{constructor(e){super(),this.editor=e}set(e,t,i={}){if("string"==typeof t){const e=t;t=(t,i)=>{this.editor.execute(e),i()}}super.set(e,t,i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ba{constructor(e={}){const t=e.language||this.constructor.defaultConfig&&this.constructor.defaultConfig.language;this._context=e.context||new z({language:t}),this._context._addEditor(this,!e.context);const i=Array.from(this.constructor.builtinPlugins||[]);this.config=new V(e,this.constructor.defaultConfig),this.config.define("plugins",i),this.config.define(this._context._getEditorConfig()),this.plugins=new I(this,i,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new ss,this.set("state","initializing"),this.once("ready",(()=>this.state="ready"),{priority:"high"}),this.once("destroy",(()=>this.state="destroyed"),{priority:"high"}),this.set("isReadOnly",!1),this.model=new fa;const o=new Ee;this.data=new Ds(this.model,o),this.editing=new ns(this.model,o),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Bs([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new wa(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const e=this.config,t=e.get("plugins"),i=e.get("removePlugins")||[],o=e.get("extraPlugins")||[],n=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(o),i,n)}destroy(){let e=Promise.resolve();return"initializing"==this.state&&(e=new Promise((e=>this.once("ready",e)))),e.then((()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()})).then((()=>this.plugins.destroy())).then((()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()})).then((()=>this._context._removeEditor(this)))}execute(...e){try{return this.commands.execute(...e)}catch(t){S.ZP.rethrowUnexpectedError(t,this)}}focus(){this.editing.view.focus()}}(0,N.Z)(ba,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _a{constructor(e){this.editor=e,this._components=new Map}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(va(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new S.ZP("componentfactory-item-missing",this,{name:e});return this._components.get(va(e)).callback(this.editor.locale)}has(e){return this._components.has(va(e))}}function va(e){return String(e).toLowerCase()}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ya{constructor(e){this.editor=e,this.componentFactory=new _a(e),this.focusTracker=new eo,this.set("viewportOffset",this._readViewportOffsetFromConfig()),this._editableElementsMap=new Map,this.listenTo(e.editing.view.document,"layoutChanged",(()=>this.update()))}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const i=e.config.get("toolbar.viewportTopOffset");return i?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:i}):{top:0}}}(0,N.Z)(ya,Z.Z);var Ca=i(73234);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ka(e){if(!(0,Ca.Z)(e.updateSourceElement))throw new S.ZP("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(t&&"textarea"===t.tagName.toLowerCase()&&t.form){let i;const o=t.form,n=()=>e.updateSourceElement();(0,Ca.Z)(o.submit)&&(i=o.submit,o.submit=()=>{n(),i.apply(o)}),o.addEventListener("submit",n),e.on("destroy",(()=>{o.removeEventListener("submit",n),i&&(o.submit=i)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xa={setData(e){this.data.set(e)},getData(e){return this.data.get(e)}};var Va=xa;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ea(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Aa={updateSourceElement(){if(!this.sourceElement)throw new S.ZP("editor-missing-sourceelement",this);Ea(this.sourceElement,this.data.get())}};var Pa=Aa;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sa extends H{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new P.Z({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if("string"!==typeof e)throw new S.ZP("pendingactions-add-invalid-message",this);const t=Object.create(Z.Z);return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var Ta='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',Na='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',Ia='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',Da='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',Ra='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',Ba='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',Ma='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',Oa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',La='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',$a='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',Fa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',za='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',Za='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',Ha='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',Ua='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Wa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',qa='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',Ga='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',ja='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ka='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',Ja='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',Ya='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',Qa='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',Xa='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',el='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',tl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',il='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',ol='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',nl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sl={cancel:Ta,caption:Na,check:Ia,cog:Da,eraser:Ra,lowVision:Ba,image:Ma,alignBottom:Oa,alignMiddle:La,alignTop:$a,alignLeft:Fa,alignCenter:za,alignRight:Za,alignJustify:Ha,objectLeft:Ka,objectCenter:Wa,objectRight:Ja,objectFullWidth:Ga,objectInline:ja,objectBlockLeft:Ua,objectBlockRight:qa,objectSizeFull:Ya,objectSizeLarge:Qa,objectSizeSmall:Xa,objectSizeMedium:el,pencil:tl,pilcrow:il,quote:ol,threeVerticalDots:nl};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rl{constructor(){const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=e=>{this.loaded=e.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise(((i,o)=>{t.onload=()=>{const e=t.result;this._data=e,i(e)},t.onerror=()=>{o("error")},t.onabort=()=>{o("aborted")},this._reader.readAsDataURL(e)}))}abort(){this._reader.abort()}}(0,N.Z)(rl,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class al extends a.Z{static get pluginName(){return"FileRepository"}static get requires(){return[Sa]}init(){this.loaders=new P.Z,this.loaders.on("add",(()=>this._updatePendingAction())),this.loaders.on("remove",(()=>this._updatePendingAction())),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0))}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return(0,S.KE)("filerepository-no-upload-adapter"),null;const t=new ll(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then((e=>{this._loadersMap.set(e,t)})).catch((()=>{})),t.on("change:uploaded",(()=>{let e=0;for(const t of this.loaders)e+=t.uploaded;this.uploaded=e})),t.on("change:uploadTotal",(()=>{let e=0;for(const t of this.loaders)t.uploadTotal&&(e+=t.uploadTotal);this.uploadTotal=e})),t}destroyLoader(e){const t=e instanceof ll?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach(((e,i)=>{e===t&&this._loadersMap.delete(i)}))}_updatePendingAction(){const e=this.editor.plugins.get(Sa);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,i=e=>`${t("Upload in progress")} ${parseInt(e)}%.`;this._pendingAction=e.add(i(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",i)}}else e.remove(this._pendingAction),this._pendingAction=null}}(0,N.Z)(al,Z.Z);class ll{constructor(e,t){this.id=(0,oo.Z)(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new rl,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0)),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then((e=>this._filePromiseWrapper?e:null)):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new S.ZP("filerepository-read-wrong-status",this);return this.status="reading",this.file.then((e=>this._reader.read(e))).then((e=>{if("reading"!==this.status)throw this.status;return this.status="idle",e})).catch((e=>{if("aborted"===e)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:e}))}upload(){if("idle"!=this.status)throw new S.ZP("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then((()=>this._adapter.upload())).then((e=>(this.uploadResponse=e,this.status="idle",e))).catch((e=>{if("aborted"===this.status)throw"aborted";throw this.status="error",e}))}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==e?this._reader.abort():"uploading"==e&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch((()=>{})),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise(((i,o)=>{t.rejecter=o,t.isFulfilled=!1,e.then((e=>{t.isFulfilled=!0,i(e)})).catch((e=>{t.isFulfilled=!0,o(e)}))})),t}}(0,N.Z)(ll,Z.Z);var cl=i(52612);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dl extends cl.Z{constructor(e){super(e),this.buttonView=new l.Z(e),this._fileInputView=new hl(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",(()=>{this._fileInputView.open()}))}focus(){this.buttonView.focus()}}class hl extends cl.Z{constructor(e){super(e),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to((()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""}))}})}open(){this.element.click()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
i(23767),i(8585),i(68696);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ul="ckCsrfToken",ml=40,gl="abcdefghijklmnopqrstuvwxyz0123456789";function pl(){let e=fl(ul);return e&&e.length==ml||(e=bl(ml),wl(ul,e)),e}function fl(e){e=e.toLowerCase();const t=document.cookie.split(";");for(const i of t){const t=i.split("="),o=decodeURIComponent(t[0].trim().toLowerCase());if(o===e)return decodeURIComponent(t[1])}return null}function wl(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"}function bl(e){let t="";const i=new Uint8Array(e);window.crypto.getRandomValues(i);for(let o=0;o<i.length;o++){const e=gl.charAt(i[o]%gl.length);t+=Math.random()>.5?e.toUpperCase():e}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _l extends a.Z{static get requires(){return[al]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(al).createUploadAdapter=t=>new vl(t,e,this.editor.t))}}class vl{constructor(e,t,i){this.loader=e,this.url=t,this.t=i}upload(){return this.loader.file.then((e=>new Promise(((t,i)=>{this._initRequest(),this._initListeners(t,i,e),this._sendRequest(e)}))))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.url,!0),e.responseType="json"}_initListeners(e,t,i){const o=this.xhr,n=this.loader,s=this.t,r=s("Cannot upload file:")+` ${i.name}.`;o.addEventListener("error",(()=>t(r))),o.addEventListener("abort",(()=>t())),o.addEventListener("load",(()=>{const i=o.response;if(!i||!i.uploaded)return t(i&&i.error&&i.error.message?i.error.message:r);e({default:i.url})})),o.upload&&o.upload.addEventListener("progress",(e=>{e.lengthComputable&&(n.uploadTotal=e.total,n.uploaded=e.loaded)}))}_sendRequest(e){const t=new FormData;t.append("upload",e),t.append("ckCsrfToken",pl()),this.xhr.send(t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const yl=["left","right","center","justify"];function Cl(e){return yl.includes(e)}function kl(e,t){return"rtl"==t.contentLanguageDirection?"right"===e:"left"===e}function xl(e){const t=e.map((e=>{let t;return t="string"==typeof e?{name:e}:e,t})).filter((e=>{const t=!!yl.includes(e.name);return t||(0,S.KE)("alignment-config-name-not-recognized",{option:e}),t})),i=t.filter((e=>!!e.className)).length;if(i&&i<t.length)throw new S.ZP("alignment-config-classnames-are-missing",{configuredOptions:e});return t.forEach(((t,i,o)=>{const n=o.slice(i+1),s=n.some((e=>e.name==t.name));if(s)throw new S.ZP("alignment-config-name-already-defined",{option:t,configuredOptions:e});if(t.className){const i=n.some((e=>e.className==t.className));if(i)throw new S.ZP("alignment-config-classname-already-defined",{option:t,configuredOptions:e})}})),t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Vl="alignment";class El extends b.Z{refresh(){const e=this.editor,t=e.locale,i=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!i&&this._canBeAligned(i),this.isEnabled&&i.hasAttribute("alignment")?this.value=i.getAttribute("alignment"):this.value="rtl"===t.contentLanguageDirection?"right":"left"}execute(e={}){const t=this.editor,i=t.locale,o=t.model,n=o.document,s=e.value;o.change((e=>{const t=Array.from(n.selection.getSelectedBlocks()).filter((e=>this._canBeAligned(e))),o=t[0].getAttribute("alignment"),r=kl(s,i)||o===s||!s;r?Al(t,e):Pl(t,e,s)}))}_canBeAligned(e){return this.editor.model.schema.checkAttribute(e,Vl)}}function Al(e,t){for(const i of e)t.removeAttribute(Vl,i)}function Pl(e,t,i){for(const o of e)t.setAttribute(Vl,i,o)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sl extends a.Z{static get pluginName(){return"AlignmentEditing"}constructor(e){super(e),e.config.define("alignment",{options:[...yl.map((e=>({name:e})))]})}init(){const e=this.editor,t=e.locale,i=e.model.schema,o=xl(e.config.get("alignment.options")),n=o.filter((e=>Cl(e.name)&&!kl(e.name,t))),s=n.some((e=>!!e.className));i.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),s?e.conversion.attributeToAttribute(Dl(n)):e.conversion.for("downcast").attributeToAttribute(Tl(n));const r=Nl(n);for(const l of r)e.conversion.for("upcast").attributeToAttribute(l);const a=Il(n);for(const l of a)e.conversion.for("upcast").attributeToAttribute(l);e.commands.add("alignment",new El(e))}}function Tl(e){const t={model:{key:"alignment",values:e.map((e=>e.name))},view:{}};for(const{name:i}of e)t.view[i]={key:"style",value:{"text-align":i}};return t}function Nl(e){const t=[];for(const{name:i}of e)t.push({view:{key:"style",value:{"text-align":i}},model:{key:"alignment",value:i}});return t}function Il(e){const t=[];for(const{name:i}of e)t.push({view:{key:"align",value:i},model:{key:"alignment",value:i}});return t}function Dl(e){const t={model:{key:"alignment",values:e.map((e=>e.name))},view:{}};for(const i of e)t.view[i.name]={key:"class",value:i.className};return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Rl({emitter:e,activator:t,callback:i,contextElements:o}){e.listenTo(document,"mousedown",((e,n)=>{if(!t())return;const s="function"==typeof n.composedPath?n.composedPath():[];for(const t of o)if(t.contains(n.target)||s.includes(t))return;i()}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bl(e){e.set("_isCssTransitionsDisabled",!1),e.disableCssTransitions=()=>{e._isCssTransitionsDisabled=!0},e.enableCssTransitions=()=>{e._isCssTransitionsDisabled=!1},e.extendTemplate({attributes:{class:[e.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ml({view:e}){e.listenTo(e.element,"submit",((t,i)=>{i.preventDefault(),e.fire("submit")}),{useCapture:!0})}var Ol=i(4167),Ll=i(70575);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $l extends Ll.Z{constructor(e,t=[]){super(t),this.locale=e}attachToDom(){this._bodyCollectionContainer=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=zi(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&0==e.childElementCount&&e.remove()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fl extends l.Z{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new cl.Z;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zl(e,t){const i=e.t,o={Black:i("Black"),"Dim grey":i("Dim grey"),Grey:i("Grey"),"Light grey":i("Light grey"),White:i("White"),Red:i("Red"),Orange:i("Orange"),Yellow:i("Yellow"),"Light green":i("Light green"),Green:i("Green"),Aquamarine:i("Aquamarine"),Turquoise:i("Turquoise"),"Light blue":i("Light blue"),Blue:i("Blue"),Purple:i("Purple")};return t.map((e=>{const t=o[e.label];return t&&t!=e.label&&(e.label=t),e}))}function Zl(e){return e.map(Hl).filter((e=>!!e))}function Hl(e){return"string"===typeof e?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:void 0!==e.hasBorder&&e.hasBorder,view:{name:"span",styles:{color:`${e.color}`}}}}var Ul='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wl extends l.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("color"),this.set("hasBorder"),this.icon=Ul,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color")},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-table__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ql{constructor(e){if(Object.assign(this,e),e.actions&&e.keystrokeHandler)for(const t in e.actions){let i=e.actions[t];"string"==typeof i&&(i=[i]);for(const o of i)e.keystrokeHandler.set(o,((e,i)=>{this[t](),i()}))}}get first(){return this.focusables.find(Gl)||null}get last(){return this.focusables.filter(Gl).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(((t,i)=>{const o=t.element===this.focusTracker.focusedElement;return o&&(e=i),o})),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const t=this.current,i=this.focusables.length;if(!i)return null;if(null===t)return this[1===e?"first":"last"];let o=(t+i+e)%i;do{const t=this.focusables.get(o);if(Gl(t))return t;o=(o+i+e)%i}while(o!==t);return null}}function Gl(e){return!(!e.focus||"none"==ri.window.getComputedStyle(e.element).display)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jl extends cl.Z{constructor(e,t){super(e);const i=t&&t.colorDefinitions||[],o={};t&&t.columns&&(o.gridTemplateColumns=`repeat( ${t.columns}, 1fr)`),this.set("selectedColor"),this.items=this.createCollection(),this.focusTracker=new eo,this.keystrokes=new to,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.items.on("add",((e,t)=>{t.isOn=t.color===this.selectedColor})),i.forEach((e=>{const t=new Wl;t.set({color:e.color,label:e.label,tooltip:!0,hasBorder:e.options.hasBorder}),t.on("execute",(()=>{this.fire("execute",{value:e.color,hasBorder:e.options.hasBorder,label:e.label})})),this.items.add(t)})),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:o}}),this.on("change:selectedColor",((e,t,i)=>{for(const o of this.items)o.isOn=o.color===i}))}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}var Kl='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>',Jl=i(92926);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yl extends l.Z{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Jl.Z;return e.content=Kl,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ql extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("class"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new to,this.focusTracker=new eo,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",t.to("class"),t.if("isVisible","ck-hidden",(e=>!e)),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",((e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())})),this.keystrokes.set("arrowleft",((e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(){const e=new l.Z;return e.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),e.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),e.delegate("execute").to(this),e}_createArrowView(){const e=new l.Z,t=e.bindTemplate;return e.icon=Kl,e.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":t.to("isOn",(e=>String(e)))}}),e.bind("isEnabled").to(this),e.delegate("execute").to(this,"open"),e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xl extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",(e=>`ck-dropdown__panel_${e}`)),t.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:t.to((e=>e.preventDefault()))}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const e=this.children.last;"function"===typeof e.focusLast?e.focusLast():e.focus()}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ec(e){return e&&e.parentNode?e.offsetParent===ri.document.body?null:e.offsetParent:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function tc({element:e,target:t,positions:i,limiter:o,fitInViewport:n,viewportOffsetConfig:s}){(0,Ca.Z)(t)&&(t=t()),(0,Ca.Z)(o)&&(o=o());const r=ec(e),a=new Gi(e),l=new Gi(t);let c;const d={targetRect:l,elementRect:a,positionedElementAncestor:r};if(o||n){const e=o&&new Gi(o).getVisible(),t=n&&ic(s);Object.assign(d,{limiterRect:e,viewportRect:t}),c=oc(i,d)||new rc(i[0],d)}else c=new rc(i[0],d);return c}function ic(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);const t=new Gi(ri.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t}function oc(e,t){const{elementRect:i}=t,o=i.getArea(),n=e.map((e=>new rc(e,t))).filter((e=>!!e.name));let s=0,r=null;for(const a of n){const{_limiterIntersectionArea:e,_viewportIntersectionArea:t}=a;if(e===o)return a;const i=t**2+e**2;i>s&&(s=i,r=a)}return r}function nc(e,t){const i=sc(new Gi(t)),o=Wi(t);let n=0,s=0;n-=i.left,s-=i.top,n+=t.scrollLeft,s+=t.scrollTop,n-=o.left,s-=o.top,e.moveBy(n,s)}function sc(e){const{scrollX:t,scrollY:i}=ri.window;return e.clone().moveBy(t,i)}class rc{constructor(e,t){const i=e(t.targetRect,t.elementRect,t.viewportRect);if(!i)return;const{left:o,top:n,name:s,config:r}=i;Object.assign(this,{name:s,config:r}),this._positioningFunctionCorrdinates={left:o,top:n},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get _limiterIntersectionArea(){const e=this._options.limiterRect;if(e){const t=this._options.viewportRect;if(!t)return e.getIntersectionArea(this._rect);{const i=e.getIntersection(t);if(i)return i.getIntersectionArea(this._rect)}}return 0}get _viewportIntersectionArea(){const e=this._options.viewportRect;return e?e.getIntersectionArea(this._rect):0}get _rect(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCorrdinates.left,this._positioningFunctionCorrdinates.top)),this._cachedRect}get _absoluteRect(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=sc(this._rect),this._options.positionedElementAncestor&&nc(this._cachedAbsoluteRect,this._options.positionedElementAncestor)),this._cachedAbsoluteRect}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ac extends cl.Z{constructor(e,t,i){super(e);const o=this.bindTemplate;this.buttonView=t,this.panelView=i,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new to,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",o.to("class"),o.if("isEnabled","ck-disabled",(e=>!e))],id:o.to("id"),"aria-describedby":o.to("ariaDescribedById")},children:[t,i]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",(()=>{this.isOpen=!this.isOpen})),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",(()=>{this.isOpen&&("auto"===this.panelPosition?this.panelView.position=ac._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)})),this.keystrokes.listenTo(this.element);const e=(e,t)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,t())};this.keystrokes.set("arrowdown",((e,t)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,t())})),this.keystrokes.set("arrowright",((e,t)=>{this.isOpen&&t()})),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:i,southWest:o,northEast:n,northWest:s,southMiddleEast:r,southMiddleWest:a,northMiddleEast:l,northMiddleWest:c}=ac.defaultPanelPositions;return"rtl"!==this.locale.uiLanguageDirection?[i,o,r,a,e,n,s,l,c,t]:[o,i,a,r,e,s,n,c,l,t]}}ac.defaultPanelPositions={south:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),southMiddleEast:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"}),southMiddleWest:(e,t)=>({top:e.bottom,left:e.left-3*(t.width-e.width)/4,name:"smw"}),north:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),northMiddleEast:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"}),northMiddleWest:(e,t)=>({top:e.top-t.height,left:e.left-3*(t.width-e.width)/4,name:"nmw"})},ac._getOptimalPosition=tc;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function dc(e){return e.bindTemplate.to((t=>{t.target===e.element&&t.preventDefault()}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function hc(e){return Array.isArray(e)?{items:e,removeItems:[]}:e?Object.assign({items:[],removeItems:[]},e):{items:[],removeItems:[]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uc extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate,o=this.t;this.options=t||{},this.set("ariaLabel",o("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new eo,this.keystrokes=new to,this.set("class"),this.set("isCompact",!1),this.itemsView=new mc(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const n="rtl"===e.uiLanguageDirection;this._focusCycler=new ql({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[n?"arrowright":"arrowleft","arrowup"],focusNext:[n?"arrowleft":"arrowright","arrowdown"]}});const s=["ck","ck-toolbar",i.to("class"),i.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&s.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:s,role:"toolbar","aria-label":i.to("ariaLabel"),style:{maxWidth:i.to("maxWidth")}},children:this.children,on:{mousedown:dc(this)}}),this._behavior=this.options.shouldGroupWhenFull?new pc(this):new gc(this)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t){const i=hc(e),o=i.items.filter(((e,o,n)=>"|"===e||-1===i.removeItems.indexOf(e)&&("-"===e?!this.options.shouldGroupWhenFull||((0,S.KE)("toolbarview-line-break-ignored-when-grouping-items",n),!1):!!t.has(e)||((0,S.KE)("toolbarview-item-unavailable",{name:e}),!1)))),n=this._cleanSeparators(o).map((e=>"|"===e?new lc:"-"===e?new cc:t.create(e)));this.items.addMany(n)}_cleanSeparators(e){const t=e=>"-"!==e&&"|"!==e,i=e.length,o=e.findIndex(t),n=i-e.slice().reverse().findIndex(t);return e.slice(o,n).filter(((e,i,o)=>{if(t(e))return!0;const n=i>0&&o[i-1]===e;return!n}))}}class mc extends cl.Z{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class gc{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using((e=>e)),e.focusables.bindTo(e.items).using((e=>e)),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class pc{constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,e.itemsView.children.bindTo(this.ungroupedItems).using((e=>e)),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),e.children.on("add",this._updateFocusCycleableItems.bind(this)),e.children.on("remove",this._updateFocusCycleableItems.bind(this)),e.items.on("change",((e,t)=>{const i=t.index;for(const o of t.removed)i>=this.ungroupedItems.length?this.groupedItems.remove(o):this.ungroupedItems.remove(o);for(let o=i;o<i+t.added.length;o++){const e=t.added[o-i];o>this.ungroupedItems.length?this.groupedItems.add(e,o-this.ungroupedItems.length):this.ungroupedItems.add(e,o)}this._updateGrouping()})),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);const e=this.groupedItems.length;let t;while(this._areItemsOverflowing)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){while(this.groupedItems.length&&!this._areItemsOverflowing)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,i=new Gi(e.lastChild),o=new Gi(e);if(!this.cachedPadding){const i=ri.window.getComputedStyle(e),o="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(i[o])}return"ltr"===t?i.right>o.right-this.cachedPadding:i.left<o.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new Yi(this.viewElement,(t=>{e&&e===t.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)})),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",(()=>{this._updateGrouping()}))}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new lc),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,i=_c(e);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",vc(i,[]),i.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:"rtl"===e.uiLanguageDirection?"se":"sw",icon:nl}),i.toolbarView.items.bindTo(this.groupedItems).using((e=>e)),i}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map((e=>{this.viewFocusables.add(e)})),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fc extends cl.Z{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new eo,this.keystrokes=new to,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wc extends cl.Z{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bc extends cl.Z{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function _c(e,t=Yl){const i=new t(e),o=new Xl(e),n=new ac(e,i,o);return i.bind("isEnabled").to(n),i instanceof Yl?i.bind("isOn").to(n,"isOpen"):i.arrowView.bind("isOn").to(n,"isOpen"),Cc(n),n}function vc(e,t){const i=e.locale,o=i.t,n=e.toolbarView=new uc(i);n.set("ariaLabel",o("Dropdown toolbar")),e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),t.map((e=>n.items.add(e))),e.panelView.children.add(n),n.items.delegate("execute").to(e)}function yc(e,t){const i=e.locale,o=e.listView=new fc(i);o.items.bindTo(t).using((({type:e,model:t})=>{if("separator"===e)return new bc(i);if("button"===e||"switchbutton"===e){const o=new wc(i);let n;return n="button"===e?new l.Z(i):new Fl(i),n.bind(...Object.keys(t)).to(t),n.delegate("execute").to(o),o.children.add(n),o}})),e.panelView.children.add(o),o.items.delegate("execute").to(e)}function Cc(e){kc(e),xc(e),Vc(e)}function kc(e){e.on("render",(()=>{Rl({emitter:e,activator:()=>e.isOpen,callback:()=>{e.isOpen=!1},contextElements:[e.element]})}))}function xc(e){e.on("execute",(t=>{t.source instanceof Fl||(e.isOpen=!1)}))}function Vc(e){e.keystrokes.set("arrowdown",((t,i)=>{e.isOpen&&(e.panelView.focus(),i())})),e.keystrokes.set("arrowup",((t,i)=>{e.isOpen&&(e.panelView.focusLast(),i())}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ec extends cl.Z{constructor(e){super(e),this.body=new $l(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ac extends cl.Z{constructor(e){super(e),this.set("text"),this.set("for"),this.id=`ck-editor__label_${(0,oo.Z)()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pc extends Ec{constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new Ac;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sc extends cl.Z{constructor(e,t,i){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=i,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",(()=>this._updateIsFocusedClasses())),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const e=this._editingView;function t(t){e.change((i=>{const o=e.document.getRoot(t.name);i.addClass(t.isFocused?"ck-focused":"ck-blurred",o),i.removeClass(t.isFocused?"ck-blurred":"ck-focused",o)}))}function i(o){e.once("change:isRenderingInProgress",((e,n,s)=>{s?i(o):t(o)}))}e.isRenderingInProgress?i(this):t(this)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tc extends Sc{constructor(e,t,i){super(e,t,i),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView,t=this.t;e.change((i=>{const o=e.document.getRoot(this.name);i.setAttribute("aria-label",t("Rich Text Editor, %0",this.name),o)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nc extends cl.Z{constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",i.to("class")]},children:this.children});const o=new cl.Z(e);o.setTemplate({tag:"span",attributes:{class:["ck","ck-form__header__label"]},children:[{text:i.to("label")}]}),this.children.add(o)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ic extends cl.Z{constructor(e){super(e),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new eo,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById")},on:{input:t.to(((...e)=>{this.fire("input",...e),this._updateIsEmpty()})),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",((e,t,i)=>{this._setDomElementValue(i),this._updateIsEmpty()}))}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=Dc(this.element)}_setDomElementValue(e){this.element.value=e||0===e?e:""}}function Dc(e){return!e.value}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rc extends cl.Z{constructor(e,t){super(e);const i=`ck-labeled-field-view-${(0,oo.Z)()}`,o=`ck-labeled-field-view-status-${(0,oo.Z)()}`;this.fieldView=t(this,i,o),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(i),this.statusView=this._createStatusView(o),this.bind("_statusText").to(this,"errorText",this,"infoText",((e,t)=>e||t));const n=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",n.to("class"),n.if("isEnabled","ck-disabled",(e=>!e)),n.if("isEmpty","ck-labeled-field-view_empty"),n.if("isFocused","ck-labeled-field-view_focused"),n.if("placeholder","ck-labeled-field-view_placeholder"),n.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(e){const t=new Ac(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new cl.Z(this.locale),i=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",i.if("errorText","ck-labeled-field-view__status_error"),i.if("_statusText","ck-hidden",(e=>!e))],id:e,role:i.if("errorText","alert")},children:[{text:i.to("_statusText")}]}),t}focus(){this.fieldView.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bc(e,t,i){const o=new Ic(e.locale);return o.set({id:t,ariaDescribedById:i}),o.bind("isReadOnly").to(e,"isEnabled",(e=>!e)),o.bind("hasError").to(e,"errorText",(e=>!!e)),o.on("input",(()=>{e.errorText=null})),e.bind("isEmpty","isFocused","placeholder").to(o),o}function Mc(e,t,i){const o=_c(e.locale);return o.set({id:t,ariaDescribedById:i}),o.bind("isEnabled").to(e),o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Oc extends H{static get pluginName(){return"Notification"}init(){this.on("show:warning",((e,t)=>{window.alert(t.message)}),{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t=`show:${e.type}`+(e.namespace?`:${e.namespace}`:"");this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lc{constructor(e,t){t&&(0,Vi.Z)(this,t),e&&this.set(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function $c(e){return t=>t+e}(0,N.Z)(Lc,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
const Fc=$c("px"),zc=ri.document.body;class Zc extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",(e=>`ck-balloon-panel_${e}`)),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",Fc),left:t.to("left",Fc)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=Zc.defaultPositions,i=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthMiddleWest,t.southArrowNorthMiddleEast,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthMiddleWest,t.northArrowSouthMiddleEast,t.northArrowSouthWest,t.northArrowSouthEast,t.viewportStickyNorth],limiter:zc,fitInViewport:!0},e),o=Zc._getOptimalPosition(i),n=parseInt(o.left),s=parseInt(o.top),{name:r,config:a={}}=o,{withArrow:l=!0}=a;Object.assign(this,{top:s,left:n,position:r,withArrow:l})}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=Hc(e.target),i=e.limiter?Hc(e.limiter):zc;this.listenTo(ri.document,"scroll",((o,n)=>{const s=n.target,r=t&&s.contains(t),a=i&&s.contains(i);!r&&!a&&t&&i||this.attachTo(e)}),{useCapture:!0}),this.listenTo(ri.window,"resize",(()=>{this.attachTo(e)}))}_stopPinning(){this.stopListening(ri.document,"scroll"),this.stopListening(ri.window,"resize")}}function Hc(e){return x(e)?e:Hi(e)?e.commonAncestorContainer:"function"==typeof e?Hc(e()):null}function Uc({horizontalOffset:e=Zc.arrowHorizontalOffset,verticalOffset:t=Zc.arrowVerticalOffset,stickyVerticalOffset:i=Zc.stickyVerticalOffset,config:o}={}){return{northWestArrowSouthWest:(t,i)=>({top:n(t,i),left:t.left-e,name:"arrow_sw",...o&&{config:o}}),northWestArrowSouthMiddleWest:(t,i)=>({top:n(t,i),left:t.left-.25*i.width-e,name:"arrow_smw",...o&&{config:o}}),northWestArrowSouth:(e,t)=>({top:n(e,t),left:e.left-t.width/2,name:"arrow_s",...o&&{config:o}}),northWestArrowSouthMiddleEast:(t,i)=>({top:n(t,i),left:t.left-.75*i.width+e,name:"arrow_sme",...o&&{config:o}}),northWestArrowSouthEast:(t,i)=>({top:n(t,i),left:t.left-i.width+e,name:"arrow_se",...o&&{config:o}}),northArrowSouthWest:(t,i)=>({top:n(t,i),left:t.left+t.width/2-e,name:"arrow_sw",...o&&{config:o}}),northArrowSouthMiddleWest:(t,i)=>({top:n(t,i),left:t.left+t.width/2-.25*i.width-e,name:"arrow_smw",...o&&{config:o}}),northArrowSouth:(e,t)=>({top:n(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s",...o&&{config:o}}),northArrowSouthMiddleEast:(t,i)=>({top:n(t,i),left:t.left+t.width/2-.75*i.width+e,name:"arrow_sme",...o&&{config:o}}),northArrowSouthEast:(t,i)=>({top:n(t,i),left:t.left+t.width/2-i.width+e,name:"arrow_se",...o&&{config:o}}),northEastArrowSouthWest:(t,i)=>({top:n(t,i),left:t.right-e,name:"arrow_sw",...o&&{config:o}}),northEastArrowSouthMiddleWest:(t,i)=>({top:n(t,i),left:t.right-.25*i.width-e,name:"arrow_smw",...o&&{config:o}}),northEastArrowSouth:(e,t)=>({top:n(e,t),left:e.right-t.width/2,name:"arrow_s",...o&&{config:o}}),northEastArrowSouthMiddleEast:(t,i)=>({top:n(t,i),left:t.right-.75*i.width+e,name:"arrow_sme",...o&&{config:o}}),northEastArrowSouthEast:(t,i)=>({top:n(t,i),left:t.right-i.width+e,name:"arrow_se",...o&&{config:o}}),southWestArrowNorthWest:(t,i)=>({top:s(t,i),left:t.left-e,name:"arrow_nw",...o&&{config:o}}),southWestArrowNorthMiddleWest:(t,i)=>({top:s(t,i),left:t.left-.25*i.width-e,name:"arrow_nmw",...o&&{config:o}}),southWestArrowNorth:(e,t)=>({top:s(e,t),left:e.left-t.width/2,name:"arrow_n",...o&&{config:o}}),southWestArrowNorthMiddleEast:(t,i)=>({top:s(t,i),left:t.left-.75*i.width+e,name:"arrow_nme",...o&&{config:o}}),southWestArrowNorthEast:(t,i)=>({top:s(t,i),left:t.left-i.width+e,name:"arrow_ne",...o&&{config:o}}),southArrowNorthWest:(t,i)=>({top:s(t,i),left:t.left+t.width/2-e,name:"arrow_nw",...o&&{config:o}}),southArrowNorthMiddleWest:(t,i)=>({top:s(t,i),left:t.left+t.width/2-.25*i.width-e,name:"arrow_nmw",...o&&{config:o}}),southArrowNorth:(e,t)=>({top:s(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_n",...o&&{config:o}}),southArrowNorthMiddleEast:(t,i)=>({top:s(t,i),left:t.left+t.width/2-.75*i.width+e,name:"arrow_nme",...o&&{config:o}}),southArrowNorthEast:(t,i)=>({top:s(t,i),left:t.left+t.width/2-i.width+e,name:"arrow_ne",...o&&{config:o}}),southEastArrowNorthWest:(t,i)=>({top:s(t,i),left:t.right-e,name:"arrow_nw",...o&&{config:o}}),southEastArrowNorthMiddleWest:(t,i)=>({top:s(t,i),left:t.right-.25*i.width-e,name:"arrow_nmw",...o&&{config:o}}),southEastArrowNorth:(e,t)=>({top:s(e,t),left:e.right-t.width/2,name:"arrow_n",...o&&{config:o}}),southEastArrowNorthMiddleEast:(t,i)=>({top:s(t,i),left:t.right-.75*i.width+e,name:"arrow_nme",...o&&{config:o}}),southEastArrowNorthEast:(t,i)=>({top:s(t,i),left:t.right-i.width+e,name:"arrow_ne",...o&&{config:o}}),viewportStickyNorth:(e,t,n)=>e.getIntersection(n)?{top:n.top+i,left:e.left+e.width/2-t.width/2,name:"arrowless",config:{withArrow:!1,...o}}:null};function n(e,i){return e.top-i.height-t}function s(e){return e.bottom+t}}Zc.arrowHorizontalOffset=25,Zc.arrowVerticalOffset=10,Zc.stickyVerticalOffset=20,Zc._getOptimalPosition=tc,Zc.defaultPositions=Uc();var Wc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',qc='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Gc=$c("px");class jc extends a.Z{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this.positionLimiter=()=>{const e=this.editor.editing.view,t=e.document,i=t.selection.editableElement;return i?e.domConverter.mapViewToDom(i.root):null},this.set("visibleView",null),this.view=new Zc(e.locale),e.ui.view.body.add(this.view),e.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}destroy(){super.destroy(),this.view.destroy(),this._rotatorView.destroy(),this._fakePanelsView.destroy()}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this.hasView(e.view))throw new S.ZP("contextualballoon-add-view-exist",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t))return this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!e.singleViewMode||this.showStack(t));const i=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),i.set(e.view,e),this._viewToStack.set(e.view,i),i===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new S.ZP("contextualballoon-remove-view-not-exist",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(1===t.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),1===t.size?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new S.ZP("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){const t=Array.from(this._idToStack.entries()).find((t=>t[1]===e));return t[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new Kc(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>!t&&e>1)),e.on("change:isNavigationVisible",(()=>this.updatePosition()),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",((e,i)=>{if(i<2)return"";const o=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("%0 of %1",[o,i])})),e.buttonNextView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()})),e.buttonPrevView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()})),e}_createFakePanelsView(){const e=new Jc(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>{const i=!t&&e>=2;return i?Math.min(e-1,2):0})),e.listenTo(this.view,"change:top",(()=>e.updatePosition())),e.listenTo(this.view,"change:left",(()=>e.updatePosition())),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:i=!0,singleViewMode:o=!1}){this.view.class=t,this.view.withArrow=i,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),o&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class Kc extends cl.Z{constructor(e){super(e);const t=e.t,i=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new eo,this.buttonPrevView=this._createButtonView(t("Previous"),Wc),this.buttonNextView=this._createButtonView(t("Next"),qc),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",i.to("isNavigationVisible",(e=>e?"":"ck-hidden"))]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:i.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const i=new l.Z(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i}}class Jc extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",i.to("numberOfPanels",(e=>e?"":"ck-hidden"))],style:{top:i.to("top",Gc),left:i.to("left",Gc),width:i.to("width",Gc),height:i.to("height",Gc)}},children:this.content}),this.on("change:numberOfPanels",((e,t,i,o)=>{i>o?this._addPanels(i-o):this._removePanels(o-i),this.updatePosition()}))}_addPanels(e){while(e--){const e=new cl.Z;e.setTemplate({tag:"div"}),this.content.add(e),this.registerChild(e)}}_removePanels(e){while(e--){const e=this.content.last;this.content.remove(e),this.deregisterChild(e),e.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:i,height:o}=new Gi(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:i,height:o})}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yc=$c("px");class Qc extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",(e=>e?"block":"none")),height:t.to("isSticky",(e=>e?Yc(this._panelRect.height):null))}}}).render(),this._contentPanel=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",(e=>e?Yc(this._contentPanelPlaceholder.getBoundingClientRect().width):null)),top:t.to("_hasViewportTopOffset",(e=>e?Yc(this.viewportTopOffset):null)),bottom:t.to("_isStickyToTheLimiter",(e=>e?Yc(this.limiterBottomOffset):null)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(ri.window,"scroll",(()=>{this._checkIfShouldBeSticky()})),this.listenTo(this,"change:isActive",(()=>{this._checkIfShouldBeSticky()}))}_checkIfShouldBeSticky(){const e=this._panelRect=this._contentPanel.getBoundingClientRect();let t;this.limiterElement?(t=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&t.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<t.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=t.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:Yc(-ri.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}var Xc=i(71174);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ed({origin:e,originKeystrokeHandler:t,originFocusTracker:i,toolbar:o,beforeFocus:n,afterBlur:s}){i.add(o.element),t.set("Alt+F10",((e,t)=>{i.isFocused&&!o.focusTracker.isFocused&&(n&&n(),o.focus(),t())})),o.keystrokes.set("Esc",((t,i)=>{o.focusTracker.isFocused&&(e.focus(),s&&s(),i())}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
$c("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
$c("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
$c("px");
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const td=new Map([["left",sl.alignLeft],["right",sl.alignRight],["center",sl.alignCenter],["justify",sl.alignJustify]]);class id extends a.Z{get localizedOptionTitles(){const e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const e=this.editor,t=e.ui.componentFactory,i=e.t,o=xl(e.config.get("alignment.options"));o.map((e=>e.name)).filter(Cl).forEach((e=>this._addButton(e))),t.add("alignment",(e=>{const n=_c(e),s=o.map((e=>t.create(`alignment:${e.name}`)));vc(n,s),n.buttonView.set({label:i("Text alignment"),tooltip:!0}),n.toolbarView.isVertical=!0,n.toolbarView.ariaLabel=i("Text alignment toolbar"),n.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const r="rtl"===e.contentLanguageDirection?td.get("right"):td.get("left");return n.buttonView.bind("icon").toMany(s,"isOn",((...e)=>{const t=e.findIndex((e=>e));return t<0?r:s[t].icon})),n.bind("isEnabled").toMany(s,"isEnabled",((...e)=>e.some((e=>e)))),n}))}_addButton(e){const t=this.editor;t.ui.componentFactory.add(`alignment:${e}`,(i=>{const o=t.commands.get("alignment"),n=new l.Z(i);return n.set({label:this.localizedOptionTitles[e],icon:td.get(e),tooltip:!0,isToggleable:!0}),n.bind("isEnabled").to(o),n.bind("isOn").to(o,"value",(t=>t===e)),this.listenTo(n,"execute",(()=>{t.execute("alignment",{value:e}),t.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class od extends a.Z{static get requires(){return[Sl,id]}static get pluginName(){return"Alignment"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nd{constructor(e,t=20){this.model=e,this.size=0,this.limit=t,this.isLocked=!1,this._changeCallback=(e,t)=>{"transparent"!=t.type&&t!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(e){this.size+=e,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e){this.isLocked&&!e||(this._batch=null,this.size=0)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sd extends b.Z{constructor(e,t){super(e),this._buffer=new nd(e.model,t),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,i=t.document,o=e.text||"",n=o.length,s=e.range?t.createSelection(e.range):i.selection,r=e.resultRange;t.enqueueChange(this._buffer.batch,(e=>{this._buffer.lock(),this._batches.add(this._buffer.batch),t.deleteContent(s),o&&t.insertContent(e.createText(o,i.selection.getAttributes()),s),r?e.setSelection(r):s.is("documentSelection")||e.setSelection(s),this._buffer.unlock(),this._buffer.input(n)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function rd(e,t){const i=[];let o,n=0;return e.forEach((e=>{"equal"==e?(s(),n++):"insert"==e?(r("insert")?o.values.push(t[n]):(s(),o={type:"insert",index:n,values:[t[n]]}),n++):r("delete")?o.howMany++:(s(),o={type:"delete",index:n,howMany:1})})),s(),i;function s(){o&&(i.push(o),o=null)}function r(e){return o&&o.type==e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ad(e){if(0==e.length)return!1;for(const t of e)if("children"===t.type&&!ld(t))return!0;return!1}function ld(e){if(e.newChildren.length-e.oldChildren.length!=1)return;const t=Gt(e.oldChildren,e.newChildren,cd),i=rd(t,e.newChildren);if(i.length>1)return;const o=i[0];return o.values[0]&&o.values[0].is("$text")?o:void 0}function cd(e,t){return e&&e.is("$text")&&t&&t.is("$text")?e.data===t.data:e===t}function dd(e,t){const i=t.selection,o=e.shiftKey&&e.keyCode===ct.Do["delete"],n=!i.isCollapsed;return o&&n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function hd(e){let t=null;const i=e.model,o=e.editing.view,n=e.commands.get("input");function s(e){if(Yt.ZP.isWindows&&dd(e,o.document))return;const s=i.document,r=o.document.isComposing,l=t&&t.isEqual(s.selection);t=null,n.isEnabled&&(md(e)||s.selection.isCollapsed||r&&229===e.keyCode||!r&&229===e.keyCode&&l||a())}function r(){const e=i.document,t=1!==e.selection.rangeCount||e.selection.getFirstRange().isFlat;e.selection.isCollapsed||t||a()}function a(){const e=n.buffer;e.lock();const t=e.batch;n._batches.add(t),i.enqueueChange(t,(()=>{i.deleteContent(i.document.selection)})),e.unlock()}Yt.ZP.isAndroid?o.document.on("beforeinput",((e,t)=>s(t)),{priority:"lowest"}):o.document.on("keydown",((e,t)=>s(t)),{priority:"lowest"}),o.document.on("compositionstart",r,{priority:"lowest"}),o.document.on("compositionend",(()=>{t=i.createSelection(i.document.selection)}),{priority:"lowest"})}const ud=[(0,ct.Cq)("arrowUp"),(0,ct.Cq)("arrowRight"),(0,ct.Cq)("arrowDown"),(0,ct.Cq)("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let sA=112;sA<=135;sA++)ud.push(sA);function md(e){return!(!e.ctrlKey&&!e.metaKey)||ud.includes(e.keyCode)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function gd(e){e.editing.view.document.on("mutations",((t,i,o)=>{new pd(e).handle(i,o)}))}class pd{constructor(e){this.editor=e,this.editing=this.editor.editing}handle(e,t){if(ad(e))this._handleContainerChildrenMutations(e,t);else for(const i of e)this._handleTextMutation(i,t),this._handleTextNodeInsertion(i)}_handleContainerChildrenMutations(e,t){const i=fd(e);if(!i)return;const o=this.editor.editing.view.domConverter,n=o.mapViewToDom(i),s=new gi(this.editor.editing.view.document),r=this.editor.data.toModel(s.domToView(n)).getChild(0),a=this.editor.editing.mapper.toModelElement(i);if(!a)return;const l=Array.from(r.getChildren()),c=Array.from(a.getChildren()),d=l[l.length-1],h=c[c.length-1],u=d&&d.is("element","softBreak"),m=h&&!h.is("element","softBreak");u&&m&&l.pop();const g=this.editor.model.schema;if(!wd(l,g)||!wd(c,g))return;const p=l.map((e=>e.is("$text")?e.data:"@")).join("").replace(/\u00A0/g," "),f=c.map((e=>e.is("$text")?e.data:"@")).join("").replace(/\u00A0/g," ");if(f===p)return;const w=Gt(f,p),{firstChangeAt:b,insertions:_,deletions:v}=bd(w);let y=null;t&&(y=this.editing.mapper.toModelRange(t.getFirstRange()));const C=p.substr(b,_),k=this.editor.model.createRange(this.editor.model.createPositionAt(a,b),this.editor.model.createPositionAt(a,b+v));this.editor.execute("input",{text:C,range:k,resultRange:y})}_handleTextMutation(e,t){if("text"!=e.type)return;const i=e.newText.replace(/\u00A0/g," "),o=e.oldText.replace(/\u00A0/g," ");if(o===i)return;const n=Gt(o,i),{firstChangeAt:s,insertions:r,deletions:a}=bd(n);let l=null;t&&(l=this.editing.mapper.toModelRange(t.getFirstRange()));const c=this.editing.view.createPositionAt(e.node,s),d=this.editing.mapper.toModelPosition(c),h=this.editor.model.createRange(d,d.getShiftedBy(a)),u=i.substr(s,r);this.editor.execute("input",{text:u,range:h,resultRange:l})}_handleTextNodeInsertion(e){if("children"!=e.type)return;const t=ld(e),i=this.editing.view.createPositionAt(e.node,t.index),o=this.editing.mapper.toModelPosition(i),n=t.values[0].data;this.editor.execute("input",{text:n.replace(/\u00A0/g," "),range:this.editor.model.createRange(o)})}}function fd(e){const t=e.map((e=>e.node)).reduce(((e,t)=>e.getCommonAncestor(t,{includeSelf:!0})));if(t)return t.getAncestors({includeSelf:!0,parentFirst:!0}).find((e=>e.is("containerElement")||e.is("rootElement")))}function wd(e,t){return e.every((e=>t.isInline(e)))}function bd(e){let t=null,i=null;for(let s=0;s<e.length;s++){const o=e[s];"equal"!=o&&(t=null===t?s:t,i=s)}let o=0,n=0;for(let s=t;s<=i;s++)"insert"!=e[s]&&o++,"delete"!=e[s]&&n++;return{insertions:n,deletions:o,firstChangeAt:t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _d extends a.Z{static get pluginName(){return"Input"}init(){const e=this.editor,t=new sd(e,e.config.get("typing.undoStep")||20);e.commands.add("input",t),hd(e),gd(e)}isInput(e){const t=this.editor.commands.get("input");return t._batches.has(e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vd extends b.Z{constructor(e,t){super(e),this.direction=t,this._buffer=new nd(e.model,e.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,i=t.document;t.enqueueChange(this._buffer.batch,(o=>{this._buffer.lock();const n=o.createSelection(e.selection||i.selection),s=e.sequence||1,r=n.isCollapsed;if(n.isCollapsed&&t.modifySelection(n,{direction:this.direction,unit:e.unit}),this._shouldEntireContentBeReplacedWithParagraph(s))return void this._replaceEntireContentWithParagraph(o);if(this._shouldReplaceFirstBlockWithParagraph(n,s))return void this.editor.execute("paragraph",{selection:n});if(n.isCollapsed)return;let a=0;n.getFirstRange().getMinimalFlatRanges().forEach((e=>{a+=He(e.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))})),t.deleteContent(n,{doNotResetEntireContent:r,direction:this.direction}),this._buffer.input(a),o.setSelection(n),this._buffer.unlock()}))}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,i=t.document,o=i.selection,n=t.schema.getLimitElement(o),s=o.isCollapsed&&o.containsEntireContent(n);if(!s)return!1;if(!t.schema.checkChild(n,"paragraph"))return!1;const r=n.getChild(0);return!r||"paragraph"!==r.name}_replaceEntireContentWithParagraph(e){const t=this.editor.model,i=t.document,o=i.selection,n=t.schema.getLimitElement(o),s=e.createElement("paragraph");e.remove(e.createRangeIn(n)),e.insert(s,n),e.setSelection(s,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const i=this.editor.model;if(t>1||"backward"!=this.direction)return!1;if(!e.isCollapsed)return!1;const o=e.getFirstPosition(),n=i.schema.getLimitElement(o),s=n.getChild(0);return o.parent==s&&(!!e.containsEntireContent(s)&&(!!i.schema.checkChild(n,"paragraph")&&"paragraph"!=s.name))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yd extends vi{constructor(e){super(e);const t=e.document;let i=0;function o(e,i,o){const n=new Ge(t,"delete",t.selection.getFirstRange());t.fire(n,new Ei(t,i,o)),n.stop.called&&e.stop()}t.on("keyup",((e,t)=>{t.keyCode!=ct.Do["delete"]&&t.keyCode!=ct.Do.backspace||(i=0)})),t.on("keydown",((e,n)=>{if(Yt.ZP.isWindows&&dd(n,t))return;const s={};if(n.keyCode==ct.Do["delete"])s.direction="forward",s.unit="character";else{if(n.keyCode!=ct.Do.backspace)return;s.direction="backward",s.unit="codePoint"}const r=Yt.ZP.isMac?n.altKey:n.ctrlKey;s.unit=r?"word":s.unit,s.sequence=++i,o(e,n.domEvent,s)})),Yt.ZP.isAndroid&&t.on("beforeinput",((t,i)=>{if("deleteContentBackward"!=i.domEvent.inputType)return;const n={unit:"codepoint",direction:"backward",sequence:1},s=i.domTarget.ownerDocument.defaultView.getSelection();s.anchorNode==s.focusNode&&s.anchorOffset+1!=s.focusOffset&&(n.selectionToRemove=e.domConverter.domSelectionToView(s)),o(t,i.domEvent,n)}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cd extends a.Z{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,i=t.document,o=e.model.document;t.addObserver(yd),this._undoOnBackspace=!1;const n=new vd(e,"forward");if(e.commands.add("deleteForward",n),e.commands.add("forwardDelete",n),e.commands.add("delete",new vd(e,"backward")),this.listenTo(i,"delete",((i,o)=>{const n={unit:o.unit,sequence:o.sequence};if(o.selectionToRemove){const t=e.model.createSelection(),i=[];for(const n of o.selectionToRemove.getRanges())i.push(e.editing.mapper.toModelRange(n));t.setTo(i),n.selection=t}e.execute("forward"==o.direction?"deleteForward":"delete",n),o.preventDefault(),t.scrollToTheSelection()}),{priority:"low"}),Yt.ZP.isAndroid){let e=null;this.listenTo(i,"delete",((t,i)=>{const o=i.domTarget.ownerDocument.defaultView.getSelection();e={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}}),{priority:"lowest"}),this.listenTo(i,"keyup",((t,i)=>{if(e){const t=i.domTarget.ownerDocument.defaultView.getSelection();t.collapse(e.anchorNode,e.anchorOffset),t.extend(e.focusNode,e.focusOffset),e=null}}))}this.editor.plugins.has("UndoEditing")&&(this.listenTo(i,"delete",((t,i)=>{this._undoOnBackspace&&"backward"==i.direction&&1==i.sequence&&"codePoint"==i.unit&&(this._undoOnBackspace=!1,e.execute("undo"),i.preventDefault(),t.stop())}),{context:"$capture"}),this.listenTo(o,"change",(()=>{this._undoOnBackspace=!1})))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kd extends a.Z{static get requires(){return[_d,Cd]}static get pluginName(){return"Typing"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function xd(e,t){let i=e.start;const o=Array.from(e.getItems()).reduce(((e,o)=>o.is("$text")||o.is("$textProxy")?e+o.data:(i=t.createPositionAfter(o),"")),"");return{text:o,range:t.createRange(i,e.end)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vd{constructor(e,t){this.model=e,this.testCallback=t,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",(()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))})),this._startListening()}_startListening(){const e=this.model,t=e.document;this.listenTo(t.selection,"change:range",((e,{directChange:i})=>{i&&(t.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))})),this.listenTo(t,"change:data",((e,t)=>{"transparent"!=t.type&&this._evaluateTextBeforeSelection("data",{batch:t})}))}_evaluateTextBeforeSelection(e,t={}){const i=this.model,o=i.document,n=o.selection,s=i.createRange(i.createPositionAt(n.focus.parent,0),n.focus),{text:r,range:a}=xd(s,i),l=this.testCallback(r);if(!l&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!l,l){const i=Object.assign(t,{text:r,range:a});"object"==typeof l&&Object.assign(i,l),this.fire(`matched:${e}`,i)}}}(0,N.Z)(Vd,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ed extends a.Z{static get pluginName(){return"TwoStepCaretMovement"}constructor(e){super(e),this.attributes=new Set,this._overrideUid=null}init(){const e=this.editor,t=e.model,i=e.editing.view,o=e.locale,n=t.document.selection;this.listenTo(i.document,"arrowKey",((e,t)=>{if(!n.isCollapsed)return;if(t.shiftKey||t.altKey||t.ctrlKey)return;const i=t.keyCode==ct.Do.arrowright,s=t.keyCode==ct.Do.arrowleft;if(!i&&!s)return;const r=o.contentLanguageDirection;let a=!1;a="ltr"===r&&i||"rtl"===r&&s?this._handleForwardMovement(t):this._handleBackwardMovement(t),!0===a&&e.stop()}),{context:"$text",priority:"highest"}),this._isNextGravityRestorationSkipped=!1,this.listenTo(n,"change:range",((e,t)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!t.directChange&&Nd(n.getFirstPosition(),this.attributes)||this._restoreGravity())}))}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const t=this.attributes,i=this.editor.model,o=i.document.selection,n=o.getFirstPosition();return!this._isGravityOverridden&&((!n.isAtStart||!Ad(o,t))&&(Nd(n,t)?(Sd(e),this._overrideGravity(),!0):void 0))}_handleBackwardMovement(e){const t=this.attributes,i=this.editor.model,o=i.document.selection,n=o.getFirstPosition();return this._isGravityOverridden?(Sd(e),this._restoreGravity(),Pd(i,t,n),!0):n.isAtStart?!!Ad(o,t)&&(Sd(e),Pd(i,t,n),!0):Td(n,t)?n.isAtEnd&&!Ad(o,t)&&Nd(n,t)?(Sd(e),Pd(i,t,n),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):void 0}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change((e=>e.overrideSelectionGravity()))}_restoreGravity(){this.editor.model.change((e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null}))}}function Ad(e,t){for(const i of t)if(e.hasAttribute(i))return!0;return!1}function Pd(e,t,i){const o=i.nodeBefore;e.change((e=>{o?e.setSelectionAttribute(o.getAttributes()):e.removeSelectionAttribute(t)}))}function Sd(e){e.preventDefault()}function Td(e,t){const i=e.getShiftedBy(-1);return Nd(i,t)}function Nd(e,t){const{nodeBefore:i,nodeAfter:o}=e;for(const n of t){const e=i?i.getAttribute(n):void 0,t=o?o.getAttribute(n):void 0;if(t!==e)return!0}return!1}var Id=i(50751),Dd=/[\\^$.*+?()[\]{}|]/g,Rd=RegExp(Dd.source);function Bd(e){return e=(0,Id.Z)(e),e&&Rd.test(e)?e.replace(Dd,"\\$&"):e}var Md=Bd;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Od={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:Ud('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:Ud("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:Ud("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:Ud('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:Ud('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:Ud("'"),to:[null,"‚",null,"’"]}},Ld={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},$d=["symbols","mathematical","typography","quotes"];class Fd extends a.Z{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(e){super(e),e.config.define("typing",{transformations:{include:$d}})}init(){const e=this.editor.model,t=e.document.selection;t.on("change:range",(()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")})),this._enableTransformationWatchers()}_enableTransformationWatchers(){const e=this.editor,t=e.model,i=e.plugins.get("Input"),o=e.plugins.get("Delete"),n=Wd(e.config.get("typing.transformations")),s=e=>{for(const t of n){const i=t.from,o=i.test(e);if(o)return{normalizedTransformation:t}}},r=(e,n)=>{if(!i.isInput(n.batch))return;const{from:s,to:r}=n.normalizedTransformation,a=s.exec(n.text),l=r(a.slice(1)),c=n.range;let d=a.index;t.enqueueChange((e=>{for(let i=1;i<a.length;i++){const o=a[i],n=l[i-1];if(null==n){d+=o.length;continue}const s=c.start.getShiftedBy(d),r=t.createRange(s,s.getShiftedBy(o.length)),h=Hd(s);t.insertContent(e.createText(n,h),r),d+=n.length}t.enqueueChange((()=>{o.requestUndoOnBackspace()}))}))},a=new Vd(e.model,s);a.on("matched:data",r),a.bind("isEnabled").to(this)}}function zd(e){return"string"==typeof e?new RegExp(`(${Md(e)})$`):e}function Zd(e){return"string"==typeof e?()=>[e]:e instanceof Array?()=>e:e}function Hd(e){const t=e.textNode?e.textNode:e.nodeAfter;return t.getAttributes()}function Ud(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}function Wd(e){const t=e.extra||[],i=e.remove||[],o=e=>!i.includes(e),n=e.include.concat(t).filter(o);return qd(n).filter(o).map((e=>Od[e]||e)).map((e=>({from:zd(e.from),to:Zd(e.to)})))}function qd(e){const t=new Set;for(const i of e)if(Ld[i])for(const e of Ld[i])t.add(e);else t.add(i);return Array.from(t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gd(e,t,i,o){return o.createRange(jd(e,t,i,!0,o),jd(e,t,i,!1,o))}function jd(e,t,i,o,n){let s=e.textNode||(o?e.nodeBefore:e.nodeAfter),r=null;while(s&&s.getAttribute(t)==i)r=s,s=o?s.previousSibling:s.nextSibling;return r?n.createPositionAt(r,o?"before":"after"):e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Kd(e,t,i,o){const n=e.editing.view,s=new Set;n.document.registerPostFixer((n=>{const r=e.model.document.selection;let a=!1;if(r.hasAttribute(t)){const l=Gd(r.getFirstPosition(),t,r.getAttribute(t),e.model),c=e.editing.mapper.toViewRange(l);for(const e of c.getItems())e.is("element",i)&&!e.hasClass(o)&&(n.addClass(o,e),s.add(e),a=!0)}return a})),e.conversion.for("editingDowncast").add((e=>{function t(){n.change((e=>{for(const t of s.values())e.removeClass(o,t),s.delete(t)}))}e.on("insert",t,{priority:"highest"}),e.on("remove",t,{priority:"highest"}),e.on("attribute",t,{priority:"highest"}),e.on("selection",t,{priority:"highest"})}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Jd=new WeakMap;function Yd(e){const{view:t,element:i,text:o,isDirectHost:n=!0,keepOnFocus:s=!1}=e,r=t.document;Jd.has(r)||(Jd.set(r,new Map),r.registerPostFixer((e=>th(r,e)))),Jd.get(r).set(i,{text:o,isDirectHost:n,keepOnFocus:s,hostElement:n?i:null}),t.change((e=>th(r,e)))}function Qd(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0)}function Xd(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0)}function eh(e,t){if(!e.isAttached())return!1;const i=Array.from(e.getChildren()).some((e=>!e.is("uiElement")));if(i)return!1;if(t)return!0;const o=e.document;if(!o.isFocused)return!0;const n=o.selection,s=n.anchor;return s&&s.parent!==e}function th(e,t){const i=Jd.get(e),o=[];let n=!1;for(const[s,r]of i)r.isDirectHost&&(o.push(s),ih(t,s,r)&&(n=!0));for(const[s,r]of i){if(r.isDirectHost)continue;const e=oh(s);e&&(o.includes(e)||(r.hostElement=e,ih(t,s,r)&&(n=!0)))}return n}function ih(e,t,i){const{text:o,isDirectHost:n,hostElement:s}=i;let r=!1;s.getAttribute("data-placeholder")!==o&&(e.setAttribute("data-placeholder",o,s),r=!0);const a=n||1==t.childCount;return a&&eh(s,i.keepOnFocus)?Qd(e,s)&&(r=!0):Xd(e,s)&&(r=!0),r}function oh(e){if(e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement"))return t}return null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const nh=new Map;function sh(e,t,i){let o=nh.get(e);o||(o=new Map,nh.set(e,o)),o.set(t,i)}function rh(e,t){const i=nh.get(e);return i&&i.has(t)?i.get(t):ah}function ah(e){return[e]}function lh(e,t,i={}){const o=rh(e.constructor,t.constructor);try{return e=e.clone(),o(e,t,i)}catch(n){throw n}}function ch(e,t,i){e=e.slice(),t=t.slice();const o=new dh(i.document,i.useRelations,i.forceWeakRemove);o.setOriginalOperations(e),o.setOriginalOperations(t);const n=o.originalOperations;if(0==e.length||0==t.length)return{operationsA:e,operationsB:t,originalOperations:n};const s=new WeakMap;for(const l of e)s.set(l,0);const r={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let a=0;while(a<e.length){const i=e[a],n=s.get(i);if(n==t.length){a++;continue}const r=t[n],l=lh(i,r,o.getContext(i,r,!0)),c=lh(r,i,o.getContext(r,i,!1));o.updateRelation(i,r),o.setOriginalOperations(l,i),o.setOriginalOperations(c,r);for(const e of l)s.set(e,n+c.length);e.splice(a,1,...l),t.splice(n,1,...c)}if(i.padWithNoOps){const i=e.length-r.originalOperationsACount,o=t.length-r.originalOperationsBCount;uh(e,o-i),uh(t,i-o)}return hh(e,r.nextBaseVersionB),hh(t,r.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:n}}class dh{constructor(e,t,i=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(e,t=null){const i=t?this.originalOperations.get(t):null;for(const o of e)this.originalOperations.set(o,i||o)}updateRelation(e,t){switch(e.constructor){case Xs:switch(t.constructor){case nr:e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter");break;case Xs:e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter");break}break;case sr:switch(t.constructor){case nr:e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");break;case Xs:if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const i=No._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.splitPosition)){const o=i.end.offset-e.splitPosition.offset,n=e.splitPosition.offset-i.start.offset;this._setRelation(e,t,{howMany:o,offset:n})}}}break;case nr:switch(t.constructor){case nr:e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement");break;case sr:e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource")}break;case tr:{const i=e.newRange;if(!i)return;switch(t.constructor){case Xs:{const o=No._createFromPositionAndShift(t.sourcePosition,t.howMany),n=o.containsPosition(i.start)||o.start.isEqual(i.start),s=o.containsPosition(i.end)||o.end.isEqual(i.end);!n&&!s||o.containsRange(i)||this._setRelation(e,t,{side:n?"left":"right",path:n?i.start.path.slice():i.end.path.slice()});break}case nr:{const o=i.start.isEqual(t.targetPosition),n=i.start.isEqual(t.deletionPosition),s=i.end.isEqual(t.deletionPosition),r=i.end.isEqual(t.sourcePosition);(o||n||s||r)&&this._setRelation(e,t,{wasInLeftElement:o,wasStartBeforeMergedElement:n,wasEndBeforeMergedElement:s,wasInRightElement:r});break}}break}}}getContext(e,t,i){return{aIsStrong:i,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const i=this.originalOperations.get(t),o=this._history.getUndoneOperation(i);if(!o)return null;const n=this.originalOperations.get(e),s=this._relations.get(n);return s&&s.get(o)||null}_setRelation(e,t,i){const o=this.originalOperations.get(e),n=this.originalOperations.get(t);let s=this._relations.get(o);s||(s=new Map,this._relations.set(o,s)),s.set(n,i)}}function hh(e,t){for(const i of e)i.baseVersion=t++}function uh(e,t){for(let i=0;i<t;i++)e.push(new Pr(0))}function mh(e,t,i){const o=e.nodes,n=o.getNode(0).getAttribute(t);if(n==i)return null;const s=new No(e.position,e.position.getShiftedBy(e.howMany));return new Ys(s,t,n,i,0)}function gh(e,t){const i=No._createFromPositionAndShift(t.sourcePosition,t.howMany);let o=null,n=[];i.containsRange(e,!0)?o=e:e.start.hasSameParentAs(i.start)?(n=e.getDifference(i),o=e.getIntersection(i)):n=[e];const s=[];for(let r of n){r=r._getTransformedByDeletion(t.sourcePosition,t.howMany);const e=t.getMovedRangeStart(),i=r.start.hasSameParentAs(e);r=r._getTransformedByInsertion(e,t.howMany,i),s.push(...r)}return o&&s.push(o._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),s}function ph(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)}function fh(e,t){const i=[];for(let o=0;o<e.length;o++){const n=e[o],s=new Xs(n.start,n.end.offset-n.start.offset,t,0);i.push(s);for(let t=o+1;t<e.length;t++)e[t]=e[t]._getTransformedByMove(s.sourcePosition,s.targetPosition,s.howMany)[0];t=t._getTransformedByMove(s.sourcePosition,s.targetPosition,s.howMany)}return i}sh(Ys,Ys,((e,t,i)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const o=e.range.getDifference(t.range).map((t=>new Ys(t,e.key,e.oldValue,e.newValue,0))),n=e.range.getIntersection(t.range);return n&&i.aIsStrong&&o.push(new Ys(n,t.key,t.newValue,e.newValue,0)),0==o.length?[new Pr(0)]:o}return[e]})),sh(Ys,er,((e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const i=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes),o=i.map((t=>new Ys(t,e.key,e.oldValue,e.newValue,e.baseVersion)));if(t.shouldReceiveAttributes){const i=mh(t,e.key,e.oldValue);i&&o.unshift(i)}return o}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]})),sh(Ys,nr,((e,t)=>{const i=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&i.push(No._createFromPositionAndShift(t.graveyardPosition,1));const o=e.range._getTransformedByMergeOperation(t);return o.isCollapsed||i.push(o),i.map((t=>new Ys(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),sh(Ys,Xs,((e,t)=>{const i=gh(e.range,t);return i.map((t=>new Ys(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),sh(Ys,sr,((e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const i=e.clone();return i.range=new No(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,i]}return e.range=e.range._getTransformedBySplitOperation(t),[e]})),sh(er,Ys,((e,t)=>{const i=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const o=mh(e,t.key,t.newValue);o&&i.push(o)}return i})),sh(er,er,((e,t,i)=>(e.position.isEqual(t.position)&&i.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e]))),sh(er,Xs,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),sh(er,sr,((e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e]))),sh(er,nr,((e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e]))),sh(tr,er,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e]))),sh(tr,tr,((e,t,i)=>{if(e.name==t.name){if(!i.aIsStrong)return[new Pr(0)];e.oldRange=t.newRange?t.newRange.clone():null}return[e]})),sh(tr,nr,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e]))),sh(tr,Xs,((e,t,i)=>{if(e.oldRange&&(e.oldRange=No._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){if(i.abRelation){const o=No._createFromRanges(e.newRange._getTransformedByMoveOperation(t));if("left"==i.abRelation.side&&t.targetPosition.isEqual(e.newRange.start))return e.newRange.start.path=i.abRelation.path,e.newRange.end=o.end,[e];if("right"==i.abRelation.side&&t.targetPosition.isEqual(e.newRange.end))return e.newRange.start=o.start,e.newRange.end.path=i.abRelation.path,[e]}e.newRange=No._createFromRanges(e.newRange._getTransformedByMoveOperation(t))}return[e]})),sh(tr,sr,((e,t,i)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(i.abRelation){const o=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?e.newRange.start=Ao._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!i.abRelation.wasInLeftElement&&(e.newRange.start=Ao._createAt(t.moveTargetPosition)),e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasInRightElement?e.newRange.end=Ao._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?e.newRange.end=Ao._createAt(t.insertionPosition):e.newRange.end=o.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]})),sh(nr,er,((e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e]))),sh(nr,nr,((e,t,i)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(i.bWasUndone){const i=t.graveyardPosition.path.slice();return i.push(0),e.sourcePosition=new Ao(t.graveyardPosition.root,i),e.howMany=0,[e]}return[new Pr(0)]}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!i.bWasUndone&&"splitAtSource"!=i.abRelation){const o="$graveyard"==e.targetPosition.root.rootName,n="$graveyard"==t.targetPosition.root.rootName,s=o&&!n,r=n&&!o,a=r||!s&&i.aIsStrong;if(a){const i=t.targetPosition._getTransformedByMergeOperation(t),o=e.targetPosition._getTransformedByMergeOperation(t);return[new Xs(i,e.howMany,o,0)]}return[new Pr(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&i.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),sh(nr,Xs,((e,t,i)=>{const o=No._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!i.bWasUndone&&!i.forceWeakRemove&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&o.containsPosition(e.sourcePosition)?[new Pr(0)]:(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])})),sh(nr,sr,((e,t,i)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){const o=0!=t.howMany,n=t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition);if(o||n||"mergeTargetNotMoved"==i.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e]}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==i.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==i.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]})),sh(Xs,er,((e,t)=>{const i=No._createFromPositionAndShift(e.sourcePosition,e.howMany),o=i._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=o.start,e.howMany=o.end.offset-o.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]})),sh(Xs,Xs,((e,t,i)=>{const o=No._createFromPositionAndShift(e.sourcePosition,e.howMany),n=No._createFromPositionAndShift(t.sourcePosition,t.howMany);let s,r=i.aIsStrong,a=!i.aIsStrong;if("insertBefore"==i.abRelation||"insertAfter"==i.baRelation?a=!0:"insertAfter"!=i.abRelation&&"insertBefore"!=i.baRelation||(a=!1),s=e.targetPosition.isEqual(t.targetPosition)&&a?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),ph(e,t)&&ph(t,e))return[t.getReversed()];const l=o.containsPosition(t.targetPosition);if(l&&o.containsRange(n,!0))return o.start=o.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),o.end=o.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),fh([o],s);const c=n.containsPosition(e.targetPosition);if(c&&n.containsRange(o,!0))return o.start=o.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),o.end=o.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),fh([o],s);const d=U(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==d||"extension"==d)return o.start=o.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),o.end=o.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),fh([o],s);"remove"!=e.type||"remove"==t.type||i.aWasUndone||i.forceWeakRemove?"remove"==e.type||"remove"!=t.type||i.bWasUndone||i.forceWeakRemove||(r=!1):r=!0;const h=[],u=o.getDifference(n);for(const g of u){g.start=g.start._getTransformedByDeletion(t.sourcePosition,t.howMany),g.end=g.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const e="same"==U(g.start.getParentPath(),t.getMovedRangeStart().getParentPath()),i=g._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,e);h.push(...i)}const m=o.getIntersection(n);return null!==m&&r&&(m.start=m.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.end=m.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===h.length?h.push(m):1==h.length?n.start.isBefore(o.start)||n.start.isEqual(o.start)?h.unshift(m):h.push(m):h.splice(1,0,m)),0===h.length?[new Pr(e.baseVersion)]:fh(h,s)})),sh(Xs,sr,((e,t,i)=>{let o=e.targetPosition.clone();e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=i.abRelation||(o=e.targetPosition._getTransformedBySplitOperation(t));const n=No._createFromPositionAndShift(e.sourcePosition,e.howMany);if(n.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=o,[e];if(n.start.hasSameParentAs(t.splitPosition)&&n.containsPosition(t.splitPosition)){let e=new No(t.splitPosition,n.end);e=e._getTransformedBySplitOperation(t);const i=[new No(n.start,t.splitPosition),e];return fh(i,o)}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==i.abRelation&&(o=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==i.abRelation&&(o=e.targetPosition);const s=n._getTransformedBySplitOperation(t),r=[s];if(t.graveyardPosition){const o=n.start.isEqual(t.graveyardPosition)||n.containsPosition(t.graveyardPosition);e.howMany>1&&o&&!i.aWasUndone&&r.push(No._createFromPositionAndShift(t.insertionPosition,1))}return fh(r,o)})),sh(Xs,nr,((e,t,i)=>{const o=No._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&o.containsPosition(t.sourcePosition))if("remove"!=e.type||i.forceWeakRemove){if(1==e.howMany)return i.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new Pr(0)]}else if(!i.aWasUndone){const i=[];let o=t.graveyardPosition.clone(),n=t.targetPosition._getTransformedByMergeOperation(t);e.howMany>1&&(i.push(new Xs(e.sourcePosition,e.howMany-1,e.targetPosition,0)),o=o._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1),n=n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1));const s=t.deletionPosition._getCombined(e.sourcePosition,e.targetPosition),r=new Xs(o,1,s,0),a=r.getMovedRangeStart().path.slice();a.push(0);const l=new Ao(r.targetPosition.root,a);n=n._getTransformedByMove(o,s,1);const c=new Xs(n,t.howMany,l,0);return i.push(r),i.push(c),i}const n=No._createFromPositionAndShift(e.sourcePosition,e.howMany),s=n._getTransformedByMergeOperation(t);return e.sourcePosition=s.start,e.howMany=s.end.offset-s.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]})),sh(ir,er,((e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e]))),sh(ir,nr,((e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e]))),sh(ir,Xs,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),sh(ir,ir,((e,t,i)=>{if(e.position.isEqual(t.position)){if(!i.aIsStrong)return[new Pr(0)];e.oldName=t.newName}return[e]})),sh(ir,sr,((e,t)=>{const i=e.position.path,o=t.splitPosition.getParentPath();if("same"==U(i,o)&&!t.graveyardPosition){const t=new ir(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,t]}return e.position=e.position._getTransformedBySplitOperation(t),[e]})),sh(or,or,((e,t,i)=>{if(e.root===t.root&&e.key===t.key){if(!i.aIsStrong||e.newValue===t.newValue)return[new Pr(0)];e.oldValue=t.newValue}return[e]})),sh(sr,er,((e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e]))),sh(sr,nr,((e,t,i)=>{if(!e.graveyardPosition&&!i.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const i=t.graveyardPosition.path.slice();i.push(0);const o=new Ao(t.graveyardPosition.root,i),n=sr.getInsertionPosition(new Ao(t.graveyardPosition.root,i)),s=new sr(o,0,n,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),e.graveyardPosition=s.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[s,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),sh(sr,Xs,((e,t,i)=>{const o=No._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const n=o.start.isEqual(e.graveyardPosition)||o.containsPosition(e.graveyardPosition);if(!i.bWasUndone&&n){const i=e.splitPosition._getTransformedByMoveOperation(t),o=e.graveyardPosition._getTransformedByMoveOperation(t),n=o.path.slice();n.push(0);const s=new Ao(o.root,n),r=new Xs(i,e.howMany,s,0);return[r]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}const n=e.splitPosition.isEqual(t.targetPosition);if(n&&("insertAtSource"==i.baRelation||"splitBefore"==i.abRelation))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e];if(n&&i.abRelation&&i.abRelation.howMany){const{howMany:t,offset:o}=i.abRelation;return e.howMany+=t,e.splitPosition=e.splitPosition.getShiftedBy(o),[e]}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&o.containsPosition(e.splitPosition)){const i=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=i,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e]}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e]})),sh(sr,sr,((e,t,i)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new Pr(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new Pr(0)];if("splitBefore"==i.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const o="$graveyard"==e.splitPosition.root.rootName,n="$graveyard"==t.splitPosition.root.rootName,s=o&&!n,r=n&&!o,a=r||!s&&i.aIsStrong;if(a){const i=[];return t.howMany&&i.push(new Xs(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&i.push(new Xs(e.splitPosition,e.howMany,e.moveTargetPosition,0)),i}return[new Pr(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==i.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==i.baRelation){const i=t.insertionPosition.path.slice();i.push(0);const o=new Ao(t.insertionPosition.root,i),n=new Xs(e.insertionPosition,1,o,0);return[e,n]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=sr.getInsertionPosition(e.splitPosition),[e]}));
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wh extends Ai{constructor(e){super(e),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bh extends Ai{constructor(e){super(e),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _h{constructor(e){this.document=e}createDocumentFragment(e){return new ft(this.document,e)}createElement(e,t,i){return new Te(this.document,e,t,i)}createText(e){return new G(this.document,e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,i){return i._insertChild(e,t)}removeChildren(e,t,i){return i._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const i=e.parent;if(i){const o=i.getChildIndex(e);return this.removeChildren(o,1,i),this.insertChild(o,t,i),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const i=t.getChildIndex(e);this.remove(e),this.insertChild(i,e.getChildren(),t)}}rename(e,t){const i=new Te(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,i)?i:null}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){(0,v.Z)(e)&&void 0===i&&(i=t),i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return Fe._createAt(e,t)}createPositionAfter(e){return Fe._createAfter(e)}createPositionBefore(e){return Fe._createBefore(e)}createRange(e,t){return new ze(e,t)}createRangeOn(e){return ze._createOn(e)}createRangeIn(e){return ze._createIn(e)}createSelection(e,t,i){return new Ue(e,t,i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const vh=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,yh=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,Ch=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,kh=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,xh=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Vh=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function Eh(e){return e.startsWith("#")?vh.test(e):e.startsWith("rgb")?yh.test(e)||Ch.test(e):e.startsWith("hsl")?kh.test(e)||xh.test(e):Vh.has(e.toLowerCase())}const Ah=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function Ph(e){return Ah.includes(e)}const Sh=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Th(e){return Sh.test(e)}const Nh=/^[+-]?[0-9]*([.][0-9]+)?%$/;function Ih(e){return Nh.test(e)}const Dh=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function Rh(e){return Dh.includes(e)}const Bh=["center","top","bottom","left","right"];function Mh(e){return Bh.includes(e)}const Oh=["fixed","scroll","local"];function Lh(e){return Oh.includes(e)}const $h=/^url\(/;function Fh(e){return $h.test(e)}function zh(e=""){if(""===e)return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=Wh(e),i=t[0],o=t[2]||i,n=t[1]||i,s=t[3]||n;return{top:i,bottom:o,right:n,left:s}}function Zh(e){return t=>{const{top:i,right:o,bottom:n,left:s}=t,r=[];return[i,o,s,n].every((e=>!!e))?r.push([e,Hh(t)]):(i&&r.push([e+"-top",i]),o&&r.push([e+"-right",o]),n&&r.push([e+"-bottom",n]),s&&r.push([e+"-left",s])),r}}function Hh({top:e,right:t,bottom:i,left:o}){const n=[];return o!==t?n.push(e,t,i,o):i!==e?n.push(e,t,i):t!==e?n.push(e,t):n.push(e),n.join(" ")}function Uh(e){return t=>({path:e,value:zh(t)})}function Wh(e){return e.replace(/, /g,",").split(" ").map((e=>e.replace(/,/g,", ")))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function qh(e){e.setNormalizer("background",Gh),e.setNormalizer("background-color",(e=>({path:"background.color",value:e}))),e.setReducer("background",(e=>{const t=[];return t.push(["background-color",e.color]),t})),e.setStyleRelation("background",["background-color"])}function Gh(e){const t={},i=Wh(e);for(const o of i)Rh(o)?(t.repeat=t.repeat||[],t.repeat.push(o)):Mh(o)?(t.position=t.position||[],t.position.push(o)):Lh(o)?t.attachment=o:Eh(o)?t.color=o:Fh(o)&&(t.image=o);return{path:"background",value:t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jh(e){e.setNormalizer("border",Kh),e.setNormalizer("border-top",Jh("top")),e.setNormalizer("border-right",Jh("right")),e.setNormalizer("border-bottom",Jh("bottom")),e.setNormalizer("border-left",Jh("left")),e.setNormalizer("border-color",Yh("color")),e.setNormalizer("border-width",Yh("width")),e.setNormalizer("border-style",Yh("style")),e.setNormalizer("border-top-color",Xh("color","top")),e.setNormalizer("border-top-style",Xh("style","top")),e.setNormalizer("border-top-width",Xh("width","top")),e.setNormalizer("border-right-color",Xh("color","right")),e.setNormalizer("border-right-style",Xh("style","right")),e.setNormalizer("border-right-width",Xh("width","right")),e.setNormalizer("border-bottom-color",Xh("color","bottom")),e.setNormalizer("border-bottom-style",Xh("style","bottom")),e.setNormalizer("border-bottom-width",Xh("width","bottom")),e.setNormalizer("border-left-color",Xh("color","left")),e.setNormalizer("border-left-style",Xh("style","left")),e.setNormalizer("border-left-width",Xh("width","left")),e.setExtractor("border-top",eu("top")),e.setExtractor("border-right",eu("right")),e.setExtractor("border-bottom",eu("bottom")),e.setExtractor("border-left",eu("left")),e.setExtractor("border-top-color","border.color.top"),e.setExtractor("border-right-color","border.color.right"),e.setExtractor("border-bottom-color","border.color.bottom"),e.setExtractor("border-left-color","border.color.left"),e.setExtractor("border-top-width","border.width.top"),e.setExtractor("border-right-width","border.width.right"),e.setExtractor("border-bottom-width","border.width.bottom"),e.setExtractor("border-left-width","border.width.left"),e.setExtractor("border-top-style","border.style.top"),e.setExtractor("border-right-style","border.style.right"),e.setExtractor("border-bottom-style","border.style.bottom"),e.setExtractor("border-left-style","border.style.left"),e.setReducer("border-color",Zh("border-color")),e.setReducer("border-style",Zh("border-style")),e.setReducer("border-width",Zh("border-width")),e.setReducer("border-top",nu("top")),e.setReducer("border-right",nu("right")),e.setReducer("border-bottom",nu("bottom")),e.setReducer("border-left",nu("left")),e.setReducer("border",ou()),e.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),e.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),e.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),e.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),e.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),e.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function Kh(e){const{color:t,style:i,width:o}=iu(e);return{path:"border",value:{color:zh(t),style:zh(i),width:zh(o)}}}function Jh(e){return t=>{const{color:i,style:o,width:n}=iu(t),s={};return void 0!==i&&(s.color={[e]:i}),void 0!==o&&(s.style={[e]:o}),void 0!==n&&(s.width={[e]:n}),{path:"border",value:s}}}function Yh(e){return t=>({path:"border",value:Qh(t,e)})}function Qh(e,t){return{[t]:zh(e)}}function Xh(e,t){return i=>({path:"border",value:{[e]:{[t]:i}}})}function eu(e){return(t,i)=>{if(i.border)return tu(i.border,e)}}function tu(e,t){const i={};return e.width&&e.width[t]&&(i.width=e.width[t]),e.style&&e.style[t]&&(i.style=e.style[t]),e.color&&e.color[t]&&(i.color=e.color[t]),i}function iu(e){const t={},i=Wh(e);for(const o of i)Th(o)||/thin|medium|thick/.test(o)?t.width=o:Ph(o)?t.style=o:t.color=o;return t}function ou(){return t=>{const i=tu(t,"top"),o=tu(t,"right"),n=tu(t,"bottom"),s=tu(t,"left"),r=[i,o,n,s],a={width:e(r,"width"),style:e(r,"style"),color:e(r,"color")},l=su(a,"all");if(l.length)return l;const c=Object.entries(a).reduce(((e,[t,i])=>(i&&(e.push([`border-${t}`,i]),r.forEach((e=>e[t]=null))),e)),[]);return[...c,...su(i,"top"),...su(o,"right"),...su(n,"bottom"),...su(s,"left")]};function e(e,t){return e.map((e=>e[t])).reduce(((e,t)=>e==t?e:null))}}function nu(e){return t=>su(t,e)}function su(e,t){const i=[];if(e&&e.width&&i.push("width"),e&&e.style&&i.push("style"),e&&e.color&&i.push("color"),3==i.length){const o=i.map((t=>e[t])).join(" ");return["all"==t?["border",o]:[`border-${t}`,o]]}return"all"==t?[]:i.map((i=>[`border-${t}-${i}`,e[i]]))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ru(e){e.setNormalizer("padding",Uh("padding")),e.setNormalizer("padding-top",(e=>({path:"padding.top",value:e}))),e.setNormalizer("padding-right",(e=>({path:"padding.right",value:e}))),e.setNormalizer("padding-bottom",(e=>({path:"padding.bottom",value:e}))),e.setNormalizer("padding-left",(e=>({path:"padding.left",value:e}))),e.setReducer("padding",Zh("padding")),e.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function au(e,t,i,o){let n,s=null;"function"==typeof o?n=o:(s=e.commands.get(o),n=()=>{e.execute(o)}),e.model.document.on("change:data",((r,a)=>{if(s&&!s.isEnabled||!t.isEnabled)return;const l=(0,Xi.Z)(e.model.document.selection.getRanges());if(!l.isCollapsed)return;if("transparent"==a.type)return;const c=Array.from(e.model.document.differ.getChanges()),d=c[0];if(1!=c.length||"insert"!==d.type||"$text"!=d.name||1!=d.length)return;const h=d.position.parent;if(h.is("element","codeBlock"))return;if(h.is("element","listItem")&&"function"!==typeof o&&!["numberedList","bulletedList","todoList"].includes(o))return;if(s&&!0===s.value)return;const u=h.getChild(0),m=e.model.createRangeOn(u);if(!m.containsRange(l)&&!l.end.isEqual(m.end))return;const g=i.exec(u.data.substr(0,l.end.offset));g&&e.model.enqueueChange((t=>{const i=t.createPositionAt(h,0),o=t.createPositionAt(h,g[0].length),s=new qo(i,o),r=n({match:g});if(!1!==r){t.remove(s);const i=e.model.document.selection.getFirstRange(),o=t.createRangeIn(h);!h.isEmpty||o.isEqual(i)||o.containsRange(i,!0)||t.remove(h)}s.detach(),e.model.enqueueChange((()=>{e.plugins.get("Delete").requestUndoOnBackspace()}))}))}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function lu(e,t,i,o){let n,s;i instanceof RegExp?n=i:s=i,s=s||(e=>{let t;const i=[],o=[];while(null!==(t=n.exec(e))){if(t&&t.length<4)break;let{index:e,1:n,2:s,3:r}=t;const a=n+s+r;e+=t[0].length-a.length;const l=[e,e+n.length],c=[e+n.length+s.length,e+n.length+s.length+r.length];i.push(l),i.push(c),o.push([e+n.length,e+n.length+s.length])}return{remove:i,format:o}}),e.model.document.on("change:data",((i,n)=>{if("transparent"==n.type||!t.isEnabled)return;const r=e.model,a=r.document.selection;if(!a.isCollapsed)return;const l=Array.from(r.document.differ.getChanges()),c=l[0];if(1!=l.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;const d=a.focus,h=d.parent,{text:u,range:m}=du(r.createRange(r.createPositionAt(h,0),d),r),g=s(u),p=cu(m.start,g.format,r),f=cu(m.start,g.remove,r);p.length&&f.length&&r.enqueueChange((t=>{const i=o(t,p);if(!1!==i){for(const e of f.reverse())t.remove(e);r.enqueueChange((()=>{e.plugins.get("Delete").requestUndoOnBackspace()}))}}))}))}function cu(e,t,i){return t.filter((e=>void 0!==e[0]&&void 0!==e[1])).map((t=>i.createRange(e.getShiftedBy(t[0]),e.getShiftedBy(t[1]))))}function du(e,t){let i=e.start;const o=Array.from(e.getItems()).reduce(((e,o)=>!o.is("$text")&&!o.is("$textProxy")||o.getAttribute("code")?(i=t.createPositionAfter(o),""):e+o.data),"");return{text:o,range:t.createRange(i,e.end)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hu extends a.Z{static get requires(){return[Cd]}static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&au(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&au(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&au(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&au(this.editor,this,/^\[\s?x\s?\]\s$/,(()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")}))}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const e=uu(this.editor,"bold");lu(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,e),lu(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,e)}if(e.get("italic")){const e=uu(this.editor,"italic");lu(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,e),lu(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,e)}if(e.get("code")){const e=uu(this.editor,"code");lu(this.editor,this,/(`)([^`]+)(`)$/g,e)}if(e.get("strikethrough")){const e=uu(this.editor,"strikethrough");lu(this.editor,this,/(~~)([^~]+)(~~)$/g,e)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter((e=>e.match(/^heading[1-6]$/))).forEach((t=>{const i=t[7],o=new RegExp(`^(#{${i}})\\s$`);au(this.editor,this,o,(()=>{if(!e.isEnabled||e.value===t)return!1;this.editor.execute("heading",{value:t})}))}))}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&au(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&au(e,this,/^```$/,(()=>{if(t.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})}))}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&au(this.editor,this,/^---$/,"horizontalLine")}}function uu(e,t){return(i,o)=>{const n=e.commands.get(t);if(!n.isEnabled)return!1;const s=e.model.schema.getValidRanges(o,t);for(const e of s)i.setAttribute(t,!0,e);i.removeSelectionAttribute(t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mu extends b.Z{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document,o=i.selection,n=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(o.isCollapsed)n?e.setSelectionAttribute(this.attributeKey,!0):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(o.getRanges(),this.attributeKey);for(const t of i)n?e.setAttribute(this.attributeKey,n,t):e.removeAttribute(this.attributeKey,t)}}))}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,i=e.document.selection;if(i.isCollapsed)return i.hasAttribute(this.attributeKey);for(const o of i.getRanges())for(const e of o.getItems())if(t.checkAttribute(e,this.attributeKey))return e.hasAttribute(this.attributeKey);return!1}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const gu="bold";class pu extends a.Z{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:gu}),e.model.schema.setAttributeProperties(gu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:gu,view:"strong",upcastAlso:["b",e=>{const t=e.getStyle("font-weight");return t?"bold"==t||Number(t)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),e.commands.add(gu,new mu(e,gu)),e.keystrokes.set("CTRL+B",gu)}}var fu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const wu="bold";class bu extends a.Z{static get pluginName(){return"BoldUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(wu,(i=>{const o=e.commands.get(wu),n=new l.Z(i);return n.set({label:t("Bold"),icon:fu,keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(wu),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _u extends a.Z{static get requires(){return[pu,bu]}static get pluginName(){return"Bold"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const vu="code",yu="ck-code_selected";class Cu extends a.Z{static get pluginName(){return"CodeEditing"}static get requires(){return[Ed]}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:vu}),e.model.schema.setAttributeProperties(vu,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:vu,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),e.commands.add(vu,new mu(e,vu)),e.plugins.get(Ed).registerAttribute(vu),Kd(e,vu,"code",yu)}}var ku='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xu="code";class Vu extends a.Z{static get pluginName(){return"CodeUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(xu,(i=>{const o=e.commands.get(xu),n=new l.Z(i);return n.set({label:t("Code"),icon:ku,tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(xu),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Eu extends a.Z{static get requires(){return[Cu,Vu]}static get pluginName(){return"Code"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Au="italic";class Pu extends a.Z{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Au}),e.model.schema.setAttributeProperties(Au,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Au,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Au,new mu(e,Au)),e.keystrokes.set("CTRL+I",Au)}}var Su='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Tu="italic";class Nu extends a.Z{static get pluginName(){return"ItalicUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Tu,(i=>{const o=e.commands.get(Tu),n=new l.Z(i);return n.set({label:t("Italic"),icon:Su,keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(Tu),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Iu extends a.Z{static get requires(){return[Pu,Nu]}static get pluginName(){return"Italic"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Du="strikethrough";class Ru extends a.Z{static get pluginName(){return"StrikethroughEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Du}),e.model.schema.setAttributeProperties(Du,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Du,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(Du,new mu(e,Du)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}var Bu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Mu="strikethrough";class Ou extends a.Z{static get pluginName(){return"StrikethroughUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Mu,(i=>{const o=e.commands.get(Mu),n=new l.Z(i);return n.set({label:t("Strikethrough"),icon:Bu,keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(Mu),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lu extends a.Z{static get requires(){return[Ru,Ou]}static get pluginName(){return"Strikethrough"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const $u="subscript";class Fu extends a.Z{static get pluginName(){return"SubscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:$u}),e.model.schema.setAttributeProperties($u,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:$u,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),e.commands.add($u,new mu(e,$u))}}var zu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.03 10.349 3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Zu="subscript";class Hu extends a.Z{static get pluginName(){return"SubscriptUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Zu,(i=>{const o=e.commands.get(Zu),n=new l.Z(i);return n.set({label:t("Subscript"),icon:zu,tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(Zu),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Uu extends a.Z{static get requires(){return[Fu,Hu]}static get pluginName(){return"Subscript"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Wu="superscript";class qu extends a.Z{static get pluginName(){return"SuperscriptEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Wu}),e.model.schema.setAttributeProperties(Wu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Wu,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),e.commands.add(Wu,new mu(e,Wu))}}var Gu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ju="superscript";class Ku extends a.Z{static get pluginName(){return"SuperscriptUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(ju,(i=>{const o=e.commands.get(ju),n=new l.Z(i);return n.set({label:t("Superscript"),icon:Gu,tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(ju),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ju extends a.Z{static get requires(){return[qu,Ku]}static get pluginName(){return"Superscript"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Yu="underline";class Qu extends a.Z{static get pluginName(){return"UnderlineEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Yu}),e.model.schema.setAttributeProperties(Yu,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Yu,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(Yu,new mu(e,Yu)),e.keystrokes.set("CTRL+U","underline")}}var Xu='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const em="underline";class tm extends a.Z{static get pluginName(){return"UnderlineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(em,(i=>{const o=e.commands.get(em),n=new l.Z(i);return n.set({label:t("Underline"),icon:Xu,keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(em),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class im extends a.Z{static get requires(){return[Qu,tm]}static get pluginName(){return"Underline"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function*om(e,t){for(const i of t)i&&e.getAttributeProperties(i[0]).copyOnEnter&&(yield i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class nm extends b.Z{execute(){const e=this.editor.model,t=e.document;e.change((i=>{sm(this.editor.model,i,t.selection,e.schema),this.fire("afterExecute",{writer:i})}))}}function sm(e,t,i,o){const n=i.isCollapsed,s=i.getFirstRange(),r=s.start.parent,a=s.end.parent;if(o.isLimit(r)||o.isLimit(a))n||r!=a||e.deleteContent(i);else if(n){const e=om(t.model.schema,i.getAttributes());rm(t,s.start),t.setSelectionAttribute(e)}else{const o=!(s.start.isAtStart&&s.end.isAtEnd),n=r==a;e.deleteContent(i,{leaveUnmerged:o}),o&&(n?rm(t,i.focus):t.setSelection(a,0))}}function rm(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class am extends vi{constructor(e){super(e);const t=this.document;t.on("keydown",((e,i)=>{if(this.isEnabled&&i.keyCode==ct.Do.enter){const o=new Ge(t,"enter",t.selection.getFirstRange());t.fire(o,new Ei(t,i.domEvent,{isSoft:i.shiftKey})),o.stop.called&&e.stop()}}))}observe(){}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lm extends a.Z{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,i=t.document;t.addObserver(am),e.commands.add("enter",new nm(e)),this.listenTo(i,"enter",((i,o)=>{o.preventDefault(),o.isSoft||(e.execute("enter"),t.scrollToTheSelection())}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cm extends b.Z{execute(){const e=this.editor.model,t=e.document;e.change((i=>{hm(e,i,t.selection),this.fire("afterExecute",{writer:i})}))}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=dm(e.schema,t.selection)}}function dm(e,t){if(t.rangeCount>1)return!1;const i=t.anchor;if(!i||!e.checkChild(i,"softBreak"))return!1;const o=t.getFirstRange(),n=o.start.parent,s=o.end.parent;return!mm(n,e)&&!mm(s,e)||n===s}function hm(e,t,i){const o=i.isCollapsed,n=i.getFirstRange(),s=n.start.parent,r=n.end.parent,a=s==r;if(o){const o=om(e.schema,i.getAttributes());um(e,t,n.end),t.removeSelectionAttribute(i.getAttributeKeys()),t.setSelectionAttribute(o)}else{const o=!(n.start.isAtStart&&n.end.isAtEnd);e.deleteContent(i,{leaveUnmerged:o}),a?um(e,t,i.focus):o&&t.setSelection(r,0)}}function um(e,t,i){const o=t.createElement("softBreak");e.insertContent(o,i),t.setSelection(o,"after")}function mm(e,t){return!e.is("rootElement")&&(t.isLimit(e)||mm(e.parent,t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gm extends a.Z{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,i=e.conversion,o=e.editing.view,n=o.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),i.for("upcast").elementToElement({model:"softBreak",view:"br"}),i.for("downcast").elementToElement({model:"softBreak",view:(e,{writer:t})=>t.createEmptyElement("br")}),o.addObserver(am),e.commands.add("shiftEnter",new cm(e)),this.listenTo(n,"enter",((t,i)=>{i.preventDefault(),i.isSoft&&(e.execute("shiftEnter"),o.scrollToTheSelection())}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pm extends b.Z{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.schema,o=t.document.selection,n=Array.from(o.getSelectedBlocks()),s=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(s){const t=n.filter((e=>fm(e)||bm(i,e)));this._applyQuote(e,t)}else this._removeQuote(e,n.filter(fm))}))}_getValue(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getSelectedBlocks());return!(!t||!fm(t))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&bm(t,i)}_removeQuote(e,t){wm(e,t).reverse().forEach((t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const i=e.createPositionBefore(t.start.parent);return void e.move(t,i)}t.end.isAtEnd||e.split(t.end);const i=e.createPositionAfter(t.end.parent);e.move(t,i)}))}_applyQuote(e,t){const i=[];wm(e,t).reverse().forEach((t=>{let o=fm(t.start);o||(o=e.createElement("blockQuote"),e.wrap(t,o)),i.push(o)})),i.reverse().reduce(((t,i)=>t.nextSibling==i?(e.merge(e.createPositionAfter(t)),t):i))}}function fm(e){return"blockQuote"==e.parent.name?e.parent:null}function wm(e,t){let i,o=0;const n=[];while(o<t.length){const s=t[o],r=t[o+1];i||(i=e.createPositionBefore(s)),r&&s.nextSibling==r||(n.push(e.createRange(i,e.createPositionAfter(s))),i=null),o++}return n}function bm(e,t){const i=e.checkChild(t.parent,"blockQuote"),o=e.checkChild(["$root","blockQuote"],t);return i&&o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _m extends a.Z{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[lm,Cd]}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new pm(e)),t.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer((i=>{const o=e.model.document.differ.getChanges();for(const e of o)if("insert"==e.type){const o=e.position.nodeAfter;if(!o)continue;if(o.is("element","blockQuote")&&o.isEmpty)return i.remove(o),!0;if(o.is("element","blockQuote")&&!t.checkChild(e.position,o))return i.unwrap(o),!0;if(o.is("element")){const e=i.createRangeIn(o);for(const o of e.getItems())if(o.is("element","blockQuote")&&!t.checkChild(i.createPositionBefore(o),o))return i.unwrap(o),!0}}else if("remove"==e.type){const t=e.position.parent;if(t.is("element","blockQuote")&&t.isEmpty)return i.remove(t),!0}return!1}));const i=this.editor.editing.view.document,o=e.model.document.selection,n=e.commands.get("blockQuote");this.listenTo(i,"enter",((t,i)=>{if(!o.isCollapsed||!n.value)return;const s=o.getLastPosition().parent;s.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop())}),{context:"blockquote"}),this.listenTo(i,"delete",((t,i)=>{if("backward"!=i.direction||!o.isCollapsed||!n.value)return;const s=o.getLastPosition().parent;s.isEmpty&&!s.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop())}),{context:"blockquote"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vm extends a.Z{static get pluginName(){return"BlockQuoteUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("blockQuote",(i=>{const o=e.commands.get("blockQuote"),n=new l.Z(i);return n.set({label:t("Block quote"),icon:sl.quote,tooltip:!0,isToggleable:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute("blockQuote"),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ym extends a.Z{static get requires(){return[_m,vm]}static get pluginName(){return"BlockQuote"}}i(99726);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Cm(e){const t=e.t,i=e.config.get("codeBlock.languages");for(const o of i)"Plain text"===o.label&&(o.label=t("Plain text")),void 0===o.class&&(o.class=`language-${o.language}`);return i}function km(e,t,i){const o={};for(const n of e)"class"===t?o[n[t].split(" ").shift()]=n[i]:o[n[t]]=n[i];return o}function xm(e){return e.data.match(/^(\s*)/)[0]}function Vm(e,t){const i=e.createDocumentFragment(),o=t.split("\n"),n=o.reduce(((t,i,n)=>(t.push(i),n<o.length-1&&t.push(e.createElement("br")),t)),[]);return e.appendChild(n,i),i}function Em(e){const t=e.document.selection,i=[];if(t.isCollapsed)i.push(t.anchor);else{const o=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:t}of o)if(t.is("$textProxy")&&t.parent.is("element","codeBlock")){const o=xm(t.textNode),{parent:n,startOffset:s}=t.textNode,r=e.createPositionAt(n,s+o.length);i.push(r)}}return i}function Am(e){const t=(0,Xi.Z)(e.getSelectedBlocks());return t&&t.is("element","codeBlock")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pm extends b.Z{constructor(e){super(e),this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor,i=t.model,o=i.document.selection,n=Cm(t),s=n[0],r=Array.from(o.getSelectedBlocks()),a=void 0===e.forceValue?!this.value:e.forceValue,l=Tm(e,this._lastLanguage,s.language);i.change((e=>{a?this._applyCodeBlock(e,r,l):this._removeCodeBlock(e,r)}))}_getValue(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getSelectedBlocks()),i=!(!t||!t.is("element","codeBlock"));return!!i&&t.getAttribute("language")}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&Sm(t,i)}_applyCodeBlock(e,t,i){this._lastLanguage=i;const o=this.editor.model.schema,n=t.filter((e=>Sm(o,e)));for(const s of n)e.rename(s,"codeBlock"),e.setAttribute("language",i,s),o.removeDisallowedAttributes([s],e),Array.from(s.getChildren()).filter((e=>!o.checkChild(s,e))).forEach((t=>e.remove(t)));n.reverse().forEach(((t,i)=>{const o=n[i+1];t.previousSibling===o&&(e.appendElement("softBreak",o),e.merge(e.createPositionBefore(t)))}))}_removeCodeBlock(e,t){const i=t.filter((e=>e.is("element","codeBlock")));for(const o of i){const t=e.createRangeOn(o);for(const i of Array.from(t.getItems()).reverse())if(i.is("element","softBreak")&&i.parent.is("element","codeBlock")){const{position:t}=e.split(e.createPositionBefore(i));e.rename(t.nodeAfter,"paragraph"),e.removeAttribute("language",t.nodeAfter),e.remove(i)}e.rename(o,"paragraph"),e.removeAttribute("language",o)}}}function Sm(e,t){return!t.is("rootElement")&&!e.isLimit(t)&&e.checkChild(t.parent,"codeBlock")}function Tm(e,t,i){return e.language?e.language:e.usePreviousLanguageChoice&&t?t:i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nm extends b.Z{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor,t=e.model;t.change((e=>{const i=Em(t);for(const t of i)e.insertText(this._indentSequence,t)}))}_checkEnabled(){return!!this._indentSequence&&Am(this.editor.model.document.selection)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Im extends b.Z{constructor(e){super(e),this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor,t=e.model;t.change((e=>{const i=Em(t);for(const t of i){const i=Dm(this.editor.model,t,this._indentSequence);i&&e.remove(i)}}))}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return!!Am(e.document.selection)&&Em(e).some((t=>Dm(e,t,this._indentSequence)))}}function Dm(e,t,i){const o=Rm(t);if(!o)return null;const n=xm(o),s=n.lastIndexOf(i);if(s+i.length!==n.length)return null;if(-1===s)return null;const{parent:r,startOffset:a}=o;return e.createRange(e.createPositionAt(r,a+s),e.createPositionAt(r,a+s+i.length))}function Rm(e){let t=e.parent.getChild(e.index);return t&&!t.is("element","softBreak")||(t=e.nodeBefore),!t||t.is("element","softBreak")?null:t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bm(e,t,i=!1){const o=km(t,"language","class"),n=km(t,"language","label");return(t,s,r)=>{const{writer:a,mapper:l,consumable:c}=r;if(!c.consume(s.item,"insert"))return;const d=s.item.getAttribute("language"),h=l.toViewPosition(e.createPositionBefore(s.item)),u={};i&&(u["data-language"]=n[d],u.spellcheck="false");const m=a.createContainerElement("pre",u),g=a.createContainerElement("code",{class:o[d]||null});a.insert(a.createPositionAt(m,0),g),a.insert(h,m),l.bindElements(s.item,g)}}function Mm(e){return(t,i,o)=>{if("codeBlock"!==i.item.parent.name)return;const{writer:n,mapper:s,consumable:r}=o;if(!r.consume(i.item,"insert"))return;const a=s.toViewPosition(e.createPositionBefore(i.item));n.insert(a,n.createText("\n"))}}function Om(e,t){const i=km(t,"class","language"),o=t[0].language;return(e,t,n)=>{const s=t.viewItem,r=s.parent;if(!r||!r.is("element","pre"))return;if(t.modelCursor.findAncestor("codeBlock"))return;const{consumable:a,writer:l}=n;if(!a.test(s,{name:!0}))return;const c=l.createElement("codeBlock"),d=[...s.getClassNames()];d.length||d.push("");for(const o of d){const e=i[o];if(e){l.setAttribute("language",e,c);break}}c.hasAttribute("language")||l.setAttribute("language",o,c),n.convertChildren(s,c),n.safeInsert(c,t.modelCursor)&&(a.consume(s,{name:!0}),n.updateConversionResult(c,t))}}function Lm(){return(e,t,{consumable:i,writer:o})=>{let n=t.modelCursor;if(!i.test(t.viewItem))return;if(!n.findAncestor("codeBlock"))return;i.consume(t.viewItem);const s=t.viewItem.data,r=s.split("\n").map((e=>o.createText(e))),a=r[r.length-1];for(const l of r)if(o.insert(l,n),n=n.getShiftedBy(l.offsetSize),l!==a){const e=o.createElement("softBreak");o.insert(e,n),n=o.createPositionAfter(e)}t.modelRange=o.createRange(t.modelCursor,n),t.modelCursor=n}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const $m="paragraph";class Fm extends a.Z{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[gm]}constructor(e){super(e),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"\t"})}init(){const e=this.editor,t=e.model.schema,i=e.model,o=e.editing.view,n=Cm(e);e.commands.add("codeBlock",new Pm(e)),e.commands.add("indentCodeBlock",new Nm(e)),e.commands.add("outdentCodeBlock",new Im(e));const s=e=>(t,i)=>{const o=this.editor.commands.get(e);o.isEnabled&&(this.editor.execute(e),i())};e.keystrokes.set("Tab",s("indentCodeBlock")),e.keystrokes.set("Shift+Tab",s("outdentCodeBlock")),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",isBlock:!0,allowAttributes:["language"]}),t.addAttributeCheck((e=>{if(e.endsWith("codeBlock $text"))return!1})),e.model.schema.addChildCheck(((e,t)=>{if(e.endsWith("codeBlock")&&t.isObject)return!1})),e.editing.downcastDispatcher.on("insert:codeBlock",Bm(i,n,!0)),e.data.downcastDispatcher.on("insert:codeBlock",Bm(i,n)),e.data.downcastDispatcher.on("insert:softBreak",Mm(i),{priority:"high"}),e.data.upcastDispatcher.on("element:code",Om(o,n)),e.data.upcastDispatcher.on("text",Lm()),this.listenTo(e.editing.view.document,"clipboardInput",((t,o)=>{let n=i.createRange(i.document.selection.anchor);if(o.targetRanges&&(n=e.editing.mapper.toModelRange(o.targetRanges[0])),!n.start.parent.is("element","codeBlock"))return;const s=o.dataTransfer.getData("text/plain"),r=new _h(e.editing.view.document);o.content=Vm(r,s)})),this.listenTo(i,"getSelectedContent",((e,[o])=>{const n=o.anchor;!o.isCollapsed&&n.parent.is("element","codeBlock")&&n.hasSameParentAs(o.focus)&&i.change((i=>{const s=e.return;if(s.childCount>1||o.containsEntireContent(n.parent)){const t=i.createElement("codeBlock",n.parent.getAttributes());i.append(s,t);const o=i.createDocumentFragment();i.append(t,o),e.return=o}else{const e=s.getChild(0);t.checkAttribute(e,"code")&&i.setAttribute("code",!0,e)}}))}))}afterInit(){const e=this.editor,t=e.commands,i=t.get("indent"),o=t.get("outdent");i&&i.registerChildCommand(t.get("indentCodeBlock")),o&&o.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",((t,i)=>{const o=e.model.document.selection.getLastPosition().parent;o.is("element","codeBlock")&&(Zm(e,i.isSoft)||Hm(e,i.isSoft)||zm(e),i.preventDefault(),t.stop())}),{context:"pre"})}}function zm(e){const t=e.model,i=t.document,o=i.selection.getLastPosition(),n=o.nodeBefore||o.textNode;let s;n&&n.is("$text")&&(s=xm(n)),e.model.change((t=>{e.execute("shiftEnter"),s&&t.insertText(s,i.selection.anchor)}))}function Zm(e,t){const i=e.model,o=i.document,n=e.editing.view,s=o.selection.getLastPosition(),r=s.nodeAfter;return!(t||!o.selection.isCollapsed||!s.isAtStart)&&(!!Wm(r)&&(e.model.change((t=>{e.execute("enter");const i=o.selection.anchor.parent.previousSibling;t.rename(i,$m),t.setSelection(i,"in"),e.model.schema.removeDisallowedAttributes([i],t),t.remove(r)})),n.scrollToTheSelection(),!0))}function Hm(e,t){const i=e.model,o=i.document,n=e.editing.view,s=o.selection.getLastPosition(),r=s.nodeBefore;let a;if(t||!o.selection.isCollapsed||!s.isAtEnd||!r||!r.previousSibling)return!1;if(Wm(r)&&Wm(r.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling),i.createPositionAfter(r));else if(Um(r)&&Wm(r.previousSibling)&&Wm(r.previousSibling.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling),i.createPositionAfter(r));else{if(!(Um(r)&&Wm(r.previousSibling)&&Um(r.previousSibling.previousSibling)&&Wm(r.previousSibling.previousSibling.previousSibling)))return!1;a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling.previousSibling),i.createPositionAfter(r))}return e.model.change((t=>{t.remove(a),e.execute("enter");const i=o.selection.anchor.parent;t.rename(i,$m),e.model.schema.removeDisallowedAttributes([i],t)})),n.scrollToTheSelection(),!0}function Um(e){return e&&e.is("$text")&&!e.data.match(/\S/)}function Wm(e){return e&&e.is("element","softBreak")}var qm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gm extends a.Z{static get pluginName(){return"CodeBlockUI"}init(){const e=this.editor,t=e.t,i=e.ui.componentFactory,o=Cm(e);i.add("codeBlock",(i=>{const n=e.commands.get("codeBlock"),s=_c(i,Ql),r=s.buttonView;return r.set({label:t("Insert code block"),tooltip:!0,icon:qm,isToggleable:!0}),r.bind("isOn").to(n,"value",(e=>!!e)),r.on("execute",(()=>{e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus()})),s.on("execute",(t=>{e.execute("codeBlock",{language:t.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus()})),s.class="ck-code-block-dropdown",s.bind("isEnabled").to(n),yc(s,this._getLanguageListItemDefinitions(o)),s}))}_getLanguageListItemDefinitions(e){const t=this.editor,i=t.commands.get("codeBlock"),o=new P.Z;for(const n of e){const e={type:"button",model:new Lc({_codeBlockLanguage:n.language,label:n.label,withText:!0})};e.model.bind("isOn").to(i,"value",(t=>t===e.model._codeBlockLanguage)),o.add(e)}return o}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jm extends a.Z{static get requires(){return[Fm,Gm]}static get pluginName(){return"CodeBlock"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Km extends ya{constructor(e,t){super(e),this.view=t,this._toolbarConfig=hc(e.config.get("toolbar")),this._elementReplacer=new Bi}get element(){return this.view.element}init(e){const t=this.editor,i=this.view,o=t.editing.view,n=i.editable,s=o.document.getRoot();n.name=s.rootName,i.render();const r=n.element;this.setEditableElement(n.name,r),this.focusTracker.add(r),i.editable.bind("isFocused").to(this.focusTracker),o.attachDomRoot(r),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy(),super.destroy()}_initToolbar(){const e=this.editor,t=this.view,i=e.editing.view;t.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),t.stickyPanel.limiterElement=t.element,t.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",(({top:e})=>e)),t.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),ed({origin:i,originFocusTracker:this.focusTracker,originKeystrokeHandler:e.keystrokes,toolbar:t.toolbar})}_initPlaceholder(){const e=this.editor,t=e.editing.view,i=t.document.getRoot(),o=e.sourceElement,n=e.config.get("placeholder")||o&&"textarea"===o.tagName.toLowerCase()&&o.getAttribute("placeholder");n&&Yd({view:t,element:i,text:n,isDirectHost:!1,keepOnFocus:!0})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jm extends Pc{constructor(e,t,i={}){super(e),this.stickyPanel=new Qc(e),this.toolbar=new uc(e,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),this.editable=new Tc(e,t)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ym extends ba{constructor(e,t){super(t),x(e)&&(this.sourceElement=e),this.model.document.createRoot();const i=!this.config.get("toolbar.shouldNotGroupWhenFull"),o=new Jm(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:i});this.ui=new Km(this,o),ka(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise((i=>{const o=new this(e,t);i(o.initPlugins().then((()=>o.ui.init(x(e)?e:null))).then((()=>{if(!x(e)&&t.initialData)throw new S.ZP("editor-create-initial-data",null);const i=void 0!==t.initialData?t.initialData:Qm(e);return o.data.init(i)})).then((()=>o.fire("ready"))).then((()=>o)))}))}}function Qm(e){return x(e)?Zi(e):e}(0,N.Z)(Ym,Va),(0,N.Z)(Ym,Pa);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xm{constructor(e){this.files=eg(e),this._native=e}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}get isCanceled(){return"none"==this._native.dropEffect||!!this._native.mozUserCancelled}}function eg(e){const t=Array.from(e.files||[]),i=Array.from(e.items||[]);return t.length?t:i.filter((e=>"file"===e.kind)).map((e=>e.getAsFile()))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tg extends Ai{constructor(e){super(e);const t=this.document;function i(e){return(i,o)=>{o.preventDefault();const n=o.dropRange?[o.dropRange]:null,s=new qe.Z(t,e);t.fire(s,{dataTransfer:o.dataTransfer,method:i.name,targetRanges:n,target:o.target}),s.stop.called&&o.stopPropagation()}}this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"],this.listenTo(t,"paste",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",i("dragging"),{priority:"low"})}onDomEvent(e){const t={dataTransfer:new Xm(e.clipboardData?e.clipboardData:e.dataTransfer)};"drop"!=e.type&&"dragover"!=e.type||(t.dropRange=ig(this.view,e)),this.fire(e.type,e,t)}}function ig(e,t){const i=t.target.ownerDocument,o=t.clientX,n=t.clientY;let s;return i.caretRangeFromPoint&&i.caretRangeFromPoint(o,n)?s=i.caretRangeFromPoint(o,n):t.rangeParent&&(s=i.createRange(),s.setStart(t.rangeParent,t.rangeOffset),s.collapse(!0)),s?e.domConverter.domRangeToView(s):null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function og(e){return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(e.includes("</p><p>")||e.includes("<br>"))&&(e=`<p>${e}</p>`),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ng(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,((e,t)=>1==t.length?" ":t)).replace(/<!--[\s\S]*?-->/g,"")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sg=["figcaption","li"];function rg(e){let t="";if(e.is("$text")||e.is("$textProxy"))t=e.data;else if(e.is("element","img")&&e.hasAttribute("alt"))t=e.getAttribute("alt");else if(e.is("element","br"))t="\n";else{let i=null;for(const o of e.getChildren()){const e=rg(o);i&&(i.is("containerElement")||o.is("containerElement"))&&(sg.includes(i.name)||sg.includes(o.name)?t+="\n":t+="\n\n"),t+=e,i=o}}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ag extends a.Z{static get pluginName(){return"ClipboardPipeline"}init(){const e=this.editor,t=e.editing.view;t.addObserver(tg),this._setupPasteDrop(),this._setupCopyCut()}_setupPasteDrop(){const e=this.editor,t=e.model,i=e.editing.view,o=i.document;this.listenTo(o,"clipboardInput",(t=>{e.isReadOnly&&t.stop()}),{priority:"highest"}),this.listenTo(o,"clipboardInput",((e,t)=>{const o=t.dataTransfer;let n=t.content||"";n||(o.getData("text/html")?n=ng(o.getData("text/html")):o.getData("text/plain")&&(n=og(o.getData("text/plain"))),n=this.editor.data.htmlProcessor.toView(n));const s=new qe.Z(this,"inputTransformation");this.fire(s,{content:n,dataTransfer:o,targetRanges:t.targetRanges,method:t.method}),s.stop.called&&e.stop(),i.scrollToTheSelection()}),{priority:"low"}),this.listenTo(this,"inputTransformation",((e,i)=>{if(i.content.isEmpty)return;const o=this.editor.data,n=o.toModel(i.content,"$clipboardHolder");0!=n.childCount&&(e.stop(),t.change((()=>{this.fire("contentInsertion",{content:n,method:i.method,dataTransfer:i.dataTransfer,targetRanges:i.targetRanges})})))}),{priority:"low"}),this.listenTo(this,"contentInsertion",((e,i)=>{i.resultRange=t.insertContent(i.content)}),{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,i=e.editing.view,o=i.document;function n(i,n){const s=n.dataTransfer;n.preventDefault();const r=e.data.toView(e.model.getSelectedContent(t.selection));o.fire("clipboardOutput",{dataTransfer:s,content:r,method:i.name})}this.listenTo(o,"copy",n,{priority:"low"}),this.listenTo(o,"cut",((t,i)=>{e.isReadOnly?i.preventDefault():n(t,i)}),{priority:"low"}),this.listenTo(o,"clipboardOutput",((i,o)=>{o.content.isEmpty||(o.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(o.content)),o.dataTransfer.setData("text/plain",rg(o.content))),"cut"==o.method&&e.model.deleteContent(t.selection)}),{priority:"low"})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lg{constructor(){this._stack=[]}add(e,t){const i=this._stack,o=i[0];this._insertDescriptor(e);const n=i[0];o===n||cg(o,n)||this.fire("change:top",{oldDescriptor:o,newDescriptor:n,writer:t})}remove(e,t){const i=this._stack,o=i[0];this._removeDescriptor(e);const n=i[0];o===n||cg(o,n)||this.fire("change:top",{oldDescriptor:o,newDescriptor:n,writer:t})}_insertDescriptor(e){const t=this._stack,i=t.findIndex((t=>t.id===e.id));if(cg(e,t[i]))return;i>-1&&t.splice(i,1);let o=0;while(t[o]&&dg(t[o],e))o++;t.splice(o,0,e)}_removeDescriptor(e){const t=this._stack,i=t.findIndex((t=>t.id===e));i>-1&&t.splice(i,1)}}function cg(e,t){return e&&t&&e.priority==t.priority&&hg(e.classes)==hg(t.classes)}function dg(e,t){return e.priority>t.priority||!(e.priority<t.priority)&&hg(e.classes)>hg(t.classes)}function hg(e){return Array.isArray(e)?e.sort().join(","):e}(0,N.Z)(lg,T.ZP);var ug='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const mg="ck-widget",gg="ck-widget_selected";function pg(e){return!!e.is("element")&&!!e.getCustomProperty("widget")}function fg(e,t,i={}){if(!e.is("containerElement"))throw new S.ZP("widget-to-widget-wrong-element-type",null,{element:e});return t.setAttribute("contenteditable","false",e),t.addClass(mg,e),t.setCustomProperty("widget",!0,e),e.getFillerOffset=xg,i.label&&vg(e,i.label,t),i.hasSelectionHandle&&Vg(e,t),_g(e,t),e}function wg(e,t,i){if(t.classes&&i.addClass((0,D.Z)(t.classes),e),t.attributes)for(const o in t.attributes)i.setAttribute(o,t.attributes[o],e)}function bg(e,t,i){if(t.classes&&i.removeClass((0,D.Z)(t.classes),e),t.attributes)for(const o in t.attributes)i.removeAttribute(o,e)}function _g(e,t,i=wg,o=bg){const n=new lg;n.on("change:top",((t,n)=>{n.oldDescriptor&&o(e,n.oldDescriptor,n.writer),n.newDescriptor&&i(e,n.newDescriptor,n.writer)})),t.setCustomProperty("addHighlight",((e,t,i)=>n.add(t,i)),e),t.setCustomProperty("removeHighlight",((e,t,i)=>n.remove(t,i)),e)}function vg(e,t,i){i.setCustomProperty("widgetLabel",t,e)}function yg(e){const t=e.getCustomProperty("widgetLabel");return t?"function"==typeof t?t():t:""}function Cg(e,t){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],e),t.setAttribute("contenteditable",e.isReadOnly?"false":"true",e),e.on("change:isReadOnly",((i,o,n)=>{t.setAttribute("contenteditable",n?"false":"true",e)})),e.on("change:isFocused",((i,o,n)=>{n?t.addClass("ck-editor__nested-editable_focused",e):t.removeClass("ck-editor__nested-editable_focused",e)})),_g(e,t),e}function kg(e,t){const i=e.getSelectedElement();if(i){const o=Ng(e);if(o)return t.createRange(t.createPositionAt(i,o));if(t.schema.isObject(i)&&!t.schema.isInline(i))return t.createRangeOn(i)}const o=e.getSelectedBlocks().next().value;if(o){if(o.isEmpty)return t.createRange(t.createPositionAt(o,0));const i=t.createPositionAfter(o);return e.focus.isTouching(i)?t.createRange(i):t.createRange(t.createPositionBefore(o))}return t.createRange(e.focus)}function xg(){return null}function Vg(e,t){const i=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},(function(e){const t=this.toDomElement(e),i=new Jl.Z;return i.set("content",ug),i.render(),t.appendChild(i.element),t}));t.insert(t.createPositionAt(e,0),i),t.addClass(["ck-widget_with-selection-handle"],e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Eg="widget-type-around";function Ag(e,t,i){return e&&pg(e)&&!i.isInline(t)}function Pg(e){return e.closest(".ck-widget__type-around__button")}function Sg(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function Tg(e,t){const i=e.closest(".ck-widget");return t.mapDomToView(i)}function Ng(e){return e.getAttribute(Eg)}var Ig='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Dg=["before","after"],Rg=(new DOMParser).parseFromString(Ig,"image/svg+xml").firstChild,Bg="ck-widget__type-around_disabled";class Mg extends a.Z{static get pluginName(){return"WidgetTypeAround"}static get requires(){return[lm,Cd]}constructor(e){super(e),this._currentFakeCaretModelElement=null}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",((i,o,n)=>{t.change((e=>{for(const i of t.document.roots)n?e.removeClass(Bg,i):e.addClass(Bg,i)})),n||e.model.change((e=>{e.removeSelectionAttribute(Eg)}))})),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableDeleteContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const i=this.editor,o=i.editing.view;i.execute("insertParagraph",{position:i.model.createPositionAt(e,t)}),o.focus(),o.scrollToTheSelection()}_listenToIfEnabled(e,t,i,o){this.listenTo(e,t,((...e)=>{this.isEnabled&&i(...e)}),o)}_insertParagraphAccordingToFakeCaretPosition(){const e=this.editor,t=e.model,i=t.document.selection,o=Ng(i);if(!o)return!1;const n=i.getSelectedElement();return this._insertParagraph(n,o),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,i=e.locale.t,o={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",((e,i,n)=>{const s=n.mapper.toViewElement(i.item);Ag(s,i.item,t)&&Og(n.writer,o,s)}),{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,i=t.document.selection,o=t.schema,n=e.editing.view;function s(e){return`ck-widget_type-around_show-fake-caret_${e}`}this._listenToIfEnabled(n.document,"arrowKey",((e,t)=>{this._handleArrowKeyPress(e,t)}),{context:[pg,"$text"],priority:"high"}),this._listenToIfEnabled(i,"change:range",((t,i)=>{i.directChange&&e.model.change((e=>{e.removeSelectionAttribute(Eg)}))})),this._listenToIfEnabled(t.document,"change:data",(()=>{const t=i.getSelectedElement();if(t){const i=e.editing.mapper.toViewElement(t);if(Ag(i,t,o))return}e.model.change((e=>{e.removeSelectionAttribute(Eg)}))})),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",((e,t,i)=>{const n=i.writer;if(this._currentFakeCaretModelElement){const e=i.mapper.toViewElement(this._currentFakeCaretModelElement);e&&(n.removeClass(Dg.map(s),e),this._currentFakeCaretModelElement=null)}const r=t.selection.getSelectedElement();if(!r)return;const a=i.mapper.toViewElement(r);if(!Ag(a,r,o))return;const l=Ng(t.selection);l&&(n.addClass(s(l),a),this._currentFakeCaretModelElement=r)})),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",((t,i,o)=>{o||e.model.change((e=>{e.removeSelectionAttribute(Eg)}))}))}_handleArrowKeyPress(e,t){const i=this.editor,o=i.model,n=o.document.selection,s=o.schema,r=i.editing.view,a=t.keyCode,l=(0,ct.Zt)(a,i.locale.contentLanguageDirection),c=r.document.selection.getSelectedElement(),d=i.editing.mapper.toModelElement(c);let h;Ag(c,d,s)?h=this._handleArrowKeyPressOnSelectedWidget(l):n.isCollapsed?h=this._handleArrowKeyPressWhenSelectionNextToAWidget(l):t.shiftKey||(h=this._handleArrowKeyPressWhenNonCollapsedSelection(l)),h&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const t=this.editor,i=t.model,o=i.document.selection,n=Ng(o);return i.change((t=>{if(!n)return t.setSelectionAttribute(Eg,e?"after":"before"),!0;{const i=n===(e?"after":"before");if(!i)return t.removeSelectionAttribute(Eg),!0}return!1}))}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,i=t.model,o=i.schema,n=t.plugins.get("Widget"),s=n._getObjectElementNextToSelection(e),r=t.editing.mapper.toViewElement(s);return!!Ag(r,s,o)&&(i.change((t=>{n._setSelectionOverElement(s),t.setSelectionAttribute(Eg,e?"before":"after")})),!0)}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,i=t.model,o=i.schema,n=t.editing.mapper,s=i.document.selection,r=e?s.getLastPosition().nodeBefore:s.getFirstPosition().nodeAfter,a=n.toViewElement(r);return!!Ag(a,r,o)&&(i.change((t=>{t.setSelection(r,"on"),t.setSelectionAttribute(Eg,e?"after":"before")})),!0)}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",((i,o)=>{const n=Pg(o.domTarget);if(!n)return;const s=Sg(n),r=Tg(n,t.domConverter),a=e.editing.mapper.toModelElement(r);this._insertParagraph(a,s),o.preventDefault(),i.stop()}))}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,i=e.editing.view;this._listenToIfEnabled(i.document,"enter",((i,o)=>{if("atTarget"!=i.eventPhase)return;const n=t.getSelectedElement(),s=e.editing.mapper.toViewElement(n),r=e.model.schema;let a;this._insertParagraphAccordingToFakeCaretPosition()?a=!0:Ag(s,n,r)&&(this._insertParagraph(n,o.isSoft?"before":"after"),a=!0),a&&(o.preventDefault(),i.stop())}),{context:pg})}_enableInsertingParagraphsOnTypingKeystroke(){const e=this.editor,t=e.editing.view,i=[ct.Do.enter,ct.Do["delete"],ct.Do.backspace];this._listenToIfEnabled(t.document,"keydown",((e,t)=>{i.includes(t.keyCode)||md(t)||this._insertParagraphAccordingToFakeCaretPosition()}),{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,i=e.model,o=i.schema;this._listenToIfEnabled(t.document,"delete",((t,n)=>{if("atTarget"!=t.eventPhase)return;const s=Ng(i.document.selection);if(!s)return;const r=n.direction,a=i.document.selection.getSelectedElement(),l="before"===s,c="forward"==r,d=l===c;if(d)e.execute("delete",{selection:i.createSelection(a,"on")});else{const t=o.getNearestSelectionRange(i.createPositionAt(a,s),r);if(t)if(t.isCollapsed){const n=i.createSelection(t.start);if(i.modifySelection(n,{direction:r}),n.focus.isEqual(t.start)){const e=Fg(o,t.start.parent);i.deleteContent(i.createSelection(e,"on"),{doNotAutoparagraph:!0})}else i.change((i=>{i.setSelection(t),e.execute(c?"deleteForward":"delete")}))}else i.change((i=>{i.setSelection(t),e.execute(c?"deleteForward":"delete")}))}n.preventDefault(),t.stop()}),{context:pg})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",((e,[o,n])=>{if(n&&!n.is("documentSelection"))return;const s=Ng(i);return s?(e.stop(),t.change((e=>{const n=i.getSelectedElement(),r=t.createPositionAt(n,s),a=e.createSelection(r),l=t.insertContent(o,a);return e.setSelection(a),l}))):void 0}),{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"deleteContent",((e,[t])=>{if(t&&!t.is("documentSelection"))return;const o=Ng(i);o&&e.stop()}),{priority:"high"})}}function Og(e,t,i){const o=e.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},(function(e){const i=this.toDomElement(e);return Lg(i,t),$g(i),i}));e.insert(e.createPositionAt(i,"end"),o)}function Lg(e,t){for(const i of Dg){const o=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${i}`],title:t[i]},children:[e.ownerDocument.importNode(Rg,!0)]});e.appendChild(o.render())}}function $g(e){const t=new Ol.ZP({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render())}function Fg(e,t){let i=t;for(const o of t.getAncestors({parentFirst:!0})){if(o.childCount>1||e.isLimit(o))break;i=o}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zg(e){const t=e.model;return(i,o)=>{const n=o.keyCode==ct.Do.arrowup,s=o.keyCode==ct.Do.arrowdown,r=o.shiftKey,a=t.document.selection;if(!n&&!s)return;const l=s;if(r&&qg(a,l))return;const c=Zg(e,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return}(c.isCollapsed||Wg(e,c,l))&&(t.change((e=>{const i=l?c.end:c.start;if(r){const o=t.createSelection(a.anchor);o.setFocus(i),e.setSelection(o)}else e.setSelection(i)})),i.stop(),o.preventDefault(),o.stopPropagation())}}}function Zg(e,t,i){const o=e.model;if(i){const e=t.isCollapsed?t.focus:t.getLastPosition(),i=Hg(o,e,"forward");if(!i)return null;const n=o.createRange(e,i),s=Ug(o.schema,n,"backward");return s?o.createRange(e,s):null}{const e=t.isCollapsed?t.focus:t.getFirstPosition(),i=Hg(o,e,"backward");if(!i)return null;const n=o.createRange(i,e),s=Ug(o.schema,n,"forward");return s?o.createRange(s,e):null}}function Hg(e,t,i){const o=e.schema,n=e.createRangeIn(t.root),s="forward"==i?"elementStart":"elementEnd";for(const{previousPosition:r,item:a,type:l}of n.getWalker({startPosition:t,direction:i})){if(o.isLimit(a)&&!o.isInline(a))return r;if(l==s&&o.isBlock(a))return null}return null}function Ug(e,t,i){const o="backward"==i?t.end:t.start;if(e.checkChild(o,"$text"))return o;for(const{nextPosition:n}of t.getWalker({direction:i}))if(e.checkChild(n,"$text"))return n;return null}function Wg(e,t,i){const o=e.model,n=e.view.domConverter;if(i){const e=o.createSelection(t.start);o.modifySelection(e),e.focus.isAtEnd||t.start.isEqual(e.focus)||(t=o.createRange(e.focus,t.end))}const s=e.mapper.toViewRange(t),r=n.viewRangeToDom(s),a=Gi.getDomRangeRects(r);let l;for(const c of a)if(void 0!==l){if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}else l=Math.round(c.bottom);return!0}function qg(e,t){return!e.isCollapsed&&e.isBackward==t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gg extends a.Z{static get pluginName(){return"Widget"}static get requires(){return[Mg,Cd]}init(){const e=this.editor,t=e.editing.view,i=t.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",((t,i,o)=>{const n=o.writer,s=i.selection;if(s.isCollapsed)return;const r=s.getSelectedElement();if(!r)return;const a=e.editing.mapper.toViewElement(r);pg(a)&&o.consumable.consume(s,"selection")&&n.setSelection(n.createRangeOn(a),{fake:!0,label:yg(a)})})),this.editor.editing.downcastDispatcher.on("selection",((e,t,i)=>{this._clearPreviouslySelectedWidgets(i.writer);const o=i.writer,n=o.document.selection;let s=null;for(const r of n.getRanges())for(const e of r){const t=e.item;pg(t)&&!Kg(t,s)&&(o.addClass(gg,t),this._previouslySelected.add(t),s=t)}}),{priority:"low"}),t.addObserver(bh),this.listenTo(i,"mousedown",((...e)=>this._onMousedown(...e))),this.listenTo(i,"arrowKey",((...e)=>{this._handleSelectionChangeOnArrowKeyPress(...e)}),{context:[pg,"$text"]}),this.listenTo(i,"arrowKey",((...e)=>{this._preventDefaultOnArrowKeyPress(...e)}),{context:"$root"}),this.listenTo(i,"arrowKey",zg(this.editor.editing),{context:"$text"}),this.listenTo(i,"delete",((e,t)=>{this._handleDelete("forward"==t.direction)&&(t.preventDefault(),e.stop())}),{context:"$root"})}_onMousedown(e,t){const i=this.editor,o=i.editing.view,n=o.document;let s=t.target;if(jg(s)){if((Yt.ZP.isSafari||Yt.ZP.isGecko)&&t.domEvent.detail>=3){const e=i.editing.mapper,o=s.is("attributeElement")?s.findAncestor((e=>!e.is("attributeElement"))):s,n=e.toModelElement(o);t.preventDefault(),this.editor.model.change((e=>{e.setSelection(n,"in")}))}return}if(!pg(s)&&(s=s.findAncestor(pg),!s))return;Yt.ZP.isAndroid&&t.preventDefault(),n.isFocused||o.focus();const r=i.editing.mapper.toModelElement(s);this._setSelectionOverElement(r)}_handleSelectionChangeOnArrowKeyPress(e,t){const i=t.keyCode,o=this.editor.model,n=o.schema,s=o.document.selection,r=s.getSelectedElement(),a=(0,ct.mA)(i,this.editor.locale.contentLanguageDirection),l="down"==a||"right"==a,c="up"==a||"down"==a;if(r&&n.isObject(r)){const i=l?s.getLastPosition():s.getFirstPosition(),r=n.getNearestSelectionRange(i,l?"forward":"backward");return void(r&&(o.change((e=>{e.setSelection(r)})),t.preventDefault(),e.stop()))}if(!s.isCollapsed&&!t.shiftKey){const i=s.getFirstPosition(),r=s.getLastPosition(),a=i.nodeAfter,c=r.nodeBefore;return void((a&&n.isObject(a)||c&&n.isObject(c))&&(o.change((e=>{e.setSelection(l?r:i)})),t.preventDefault(),e.stop()))}if(!s.isCollapsed)return;const d=this._getObjectElementNextToSelection(l);if(d&&n.isObject(d)){if(n.isInline(d)&&c)return;this._setSelectionOverElement(d),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const i=this.editor.model,o=i.schema,n=i.document.selection.getSelectedElement();n&&o.isObject(n)&&(t.preventDefault(),e.stop())}_handleDelete(e){if(this.editor.isReadOnly)return;const t=this.editor.model.document,i=t.selection;if(!i.isCollapsed)return;const o=this._getObjectElementNextToSelection(e);return o?(this.editor.model.change((e=>{let t=i.anchor.parent;while(t.isEmpty){const i=t;t=i.parent,e.remove(i)}this._setSelectionOverElement(o)})),!0):void 0}_setSelectionOverElement(e){this.editor.model.change((t=>{t.setSelection(t.createRangeOn(e))}))}_getObjectElementNextToSelection(e){const t=this.editor.model,i=t.schema,o=t.document.selection,n=t.createSelection(o);if(t.modifySelection(n,{direction:e?"forward":"backward"}),n.isEqual(o))return null;const s=e?n.focus.nodeBefore:n.focus.nodeAfter;return s&&i.isObject(s)?s:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(gg,t);this._previouslySelected.clear()}}function jg(e){while(e){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(pg(e))return!1;e=e.parent}return!1}function Kg(e,t){return!!t&&Array.from(e.getAncestors()).includes(t)}var Jg=i(111);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yg extends a.Z{static get pluginName(){return"DragDrop"}static get requires(){return[ag,Gg]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,this._updateDropMarkerThrottled=(0,Jg.Z)((e=>this._updateDropMarker(e)),40),this._removeDropMarkerDelayed=sp((()=>this._removeDropMarker()),40),this._clearDraggableAttributesDelayed=sp((()=>this._clearDraggableAttributes()),40),t.addObserver(tg),t.addObserver(bh),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDropMarker(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",((e,t,i)=>{i?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})),this.on("change:isEnabled",((e,t,i)=>{i||this._finalizeDragging(!1)})),Yt.ZP.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._updateDropMarkerThrottled.cancel(),this._removeDropMarkerDelayed.cancel(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,i=t.document,o=e.editing.view,n=o.document;this.listenTo(n,"dragstart",((o,s)=>{const r=i.selection;if(s.target&&s.target.is("editableElement"))return void s.preventDefault();const a=s.target?rp(s.target):null;if(a){const i=e.editing.mapper.toModelElement(a);this._draggedRange=qo.fromRange(t.createRangeOn(i)),e.plugins.has("WidgetToolbarRepository")&&e.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop")}else if(!n.selection.isCollapsed){const e=n.selection.getSelectedElement();e&&pg(e)||(this._draggedRange=qo.fromRange(r.getFirstRange()))}if(!this._draggedRange)return void s.preventDefault();this._draggingUid=(0,oo.Z)(),s.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",s.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const l=t.createSelection(this._draggedRange.toRange()),c=e.data.toView(t.getSelectedContent(l));n.fire("clipboardOutput",{dataTransfer:s.dataTransfer,content:c,method:o.name}),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")}),{priority:"low"}),this.listenTo(n,"dragend",((e,t)=>{this._finalizeDragging(!t.dataTransfer.isCanceled&&"move"==t.dataTransfer.dropEffect)}),{priority:"low"}),this.listenTo(n,"dragenter",(()=>{this.isEnabled&&o.focus()})),this.listenTo(n,"dragleave",(()=>{this._removeDropMarkerDelayed()})),this.listenTo(n,"dragging",((t,i)=>{if(!this.isEnabled)return void(i.dataTransfer.dropEffect="none");this._removeDropMarkerDelayed.cancel();const o=Qg(e,i.targetRanges,i.target);this._draggedRange||(i.dataTransfer.dropEffect="copy"),Yt.ZP.isGecko||("copy"==i.dataTransfer.effectAllowed?i.dataTransfer.dropEffect="copy":["all","copyMove"].includes(i.dataTransfer.effectAllowed)&&(i.dataTransfer.dropEffect="move")),o&&this._updateDropMarkerThrottled(o)}),{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"clipboardInput",((t,i)=>{if("drop"!=i.method)return;const o=Qg(e,i.targetRanges,i.target);if(this._removeDropMarker(),!o)return this._finalizeDragging(!1),void t.stop();this._draggedRange&&this._draggingUid!=i.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="");const n="move"==np(i.dataTransfer);if(n&&this._draggedRange&&this._draggedRange.containsRange(o,!0))return this._finalizeDragging(!1),void t.stop();i.targetRanges=[e.editing.mapper.toViewRange(o)]}),{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(ag);e.on("contentInsertion",((e,t)=>{if(!this.isEnabled||"drop"!==t.method)return;const i=t.targetRanges.map((e=>this.editor.editing.mapper.toModelRange(e)));this.editor.model.change((e=>e.setSelection(i)))}),{priority:"high"}),e.on("contentInsertion",((e,t)=>{if(!this.isEnabled||"drop"!==t.method)return;const i="move"==np(t.dataTransfer),o=!t.resultRange||!t.resultRange.isCollapsed;this._finalizeDragging(o&&i)}),{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"mousedown",((o,n)=>{if(Yt.ZP.isAndroid||!n)return;this._clearDraggableAttributesDelayed.cancel();let s=rp(n.target);if(Yt.ZP.isBlink&&!e.isReadOnly&&!s&&!i.selection.isCollapsed){const e=i.selection.getSelectedElement();e&&pg(e)||(s=i.selection.editableElement)}s&&(t.change((e=>{e.setAttribute("draggable","true",s)})),this._draggableElement=e.editing.mapper.toModelElement(s))})),this.listenTo(i,"mouseup",(()=>{Yt.ZP.isAndroid||this._clearDraggableAttributesDelayed()}))}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change((t=>{this._draggableElement&&"$graveyard"!=this._draggableElement.root.rootName&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null}))}_setupDropMarker(){const e=this.editor;e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:i})=>{const o=e.model.schema.checkChild(t.markerRange.start,"$text");if(o)return i.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},(function(e){const t=this.toDomElement(e);return t.innerHTML="&NoBreak;<span></span>&NoBreak;",t}))}})}_updateDropMarker(e){const t=this.editor,i=t.model.markers;t.model.change((t=>{i.has("drop-target")?i.get("drop-target").getRange().isEqual(e)||t.updateMarker("drop-target",{range:e}):t.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})}))}_removeDropMarker(){const e=this.editor.model;this._removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),e.markers.has("drop-target")&&e.change((e=>{e.removeMarker("drop-target")}))}_finalizeDragging(e){const t=this.editor,i=t.model;this._removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._draggedRange&&(e&&this.isEnabled&&i.deleteContent(i.createSelection(this._draggedRange),{doNotAutoparagraph:!0}),this._draggedRange.detach(),this._draggedRange=null)}}function Qg(e,t,i){const o=e.model,n=e.editing.mapper;let s=null;const r=t?t[0].start:null;if(i.is("uiElement")&&(i=i.parent),s=Xg(e,i),s)return s;const a=op(e,i),l=r?n.toModelPosition(r):null;return l?(s=tp(e,l,a),s||(s=o.schema.getNearestSelectionRange(l,Yt.ZP.isGecko?"forward":"backward"),s||ip(e,l.parent))):ep(e,a)}function Xg(e,t){const i=e.model,o=e.editing.mapper;if(pg(t))return i.createRangeOn(o.toModelElement(t));if(!t.is("editableElement")){const e=t.findAncestor((e=>pg(e)||e.is("editableElement")));if(pg(e))return i.createRangeOn(o.toModelElement(e))}return null}function ep(e,t){const i=e.model,o=i.schema,n=i.createPositionAt(t,0);return o.getNearestSelectionRange(n,"forward")}function tp(e,t,i){const o=e.model;if(!o.schema.checkChild(i,"$block"))return null;const n=o.createPositionAt(i,0),s=t.path.slice(0,n.path.length),r=o.createPositionFromPath(t.root,s),a=r.nodeAfter;return a&&o.schema.isObject(a)?o.createRangeOn(a):null}function ip(e,t){const i=e.model;while(t){if(i.schema.isObject(t))return i.createRangeOn(t);t=t.parent}}function op(e,t){const i=e.editing.mapper,o=e.editing.view,n=i.toModelElement(t);if(n)return n;const s=o.createPositionBefore(t),r=i.findMappedViewAncestor(s);return i.toModelElement(r)}function np(e){return Yt.ZP.isGecko?e.dropEffect:["all","copyMove"].includes(e.effectAllowed)?"move":"copy"}function sp(e,t){let i;function o(...n){o.cancel(),i=setTimeout((()=>e(...n)),t)}return o.cancel=()=>{clearTimeout(i)},o}function rp(e){if(e.is("editableElement"))return null;if(e.hasClass("ck-widget__selection-handle"))return e.findAncestor(pg);if(pg(e))return e;const t=e.findAncestor((e=>pg(e)||e.is("editableElement")));return pg(t)?t:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ap extends a.Z{static get pluginName(){return"PastePlainText"}static get requires(){return[ag]}init(){const e=this.editor,t=e.model,i=e.editing.view,o=i.document,n=t.document.selection;let s=!1;i.addObserver(tg),this.listenTo(o,"keydown",((e,t)=>{s=t.shiftKey})),e.plugins.get(ag).on("contentInsertion",((e,i)=>{(s||lp(i.content,t.schema))&&t.change((e=>{const o=Array.from(n.getAttributes()).filter((([e])=>t.schema.getAttributeProperties(e).isFormatting));n.isCollapsed||t.deleteContent(n,{doNotAutoparagraph:!0}),o.push(...n.getAttributes());const s=e.createRangeIn(i.content);for(const t of s.getItems())t.is("$textProxy")&&e.setAttributes(o,t)}))}))}}function lp(e,t){if(e.childCount>1)return!1;const i=e.getChild(0);return!t.isObject(i)&&0==[...i.getAttributeKeys()].length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cp extends a.Z{static get pluginName(){return"Clipboard"}static get requires(){return[ag,Yg,ap]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dp extends b.Z{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let i=e.schema.getLimitElement(t);if(t.containsEntireContent(i)||!hp(e.schema,i))do{if(i=i.parent,!i)return}while(!hp(e.schema,i));e.change((e=>{e.setSelection(i,"in")}))}}function hp(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const up=(0,ct.Zz)("Ctrl+A");class mp extends a.Z{static get pluginName(){return"SelectAllEditing"}init(){const e=this.editor,t=e.editing.view,i=t.document;e.commands.add("selectAll",new dp(e)),this.listenTo(i,"keydown",((t,i)=>{(0,ct.Cq)(i)===up&&(e.execute("selectAll"),i.preventDefault())}))}}var gp='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pp extends a.Z{static get pluginName(){return"SelectAllUI"}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",(t=>{const i=e.commands.get("selectAll"),o=new l.Z(t),n=t.t;return o.set({label:n("Select all"),icon:gp,keystroke:"Ctrl+A",tooltip:!0}),o.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(o,"execute",(()=>{e.execute("selectAll"),e.editing.view.focus()})),o}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fp extends a.Z{static get requires(){return[mp,pp]}static get pluginName(){return"SelectAll"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wp extends b.Z{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this.listenTo(e.data,"set",((e,t)=>{t[1]={...t[1]};const i=t[1];i.batchType||(i.batchType="transparent")}),{priority:"high"}),this.listenTo(e.data,"set",((e,t)=>{const i=t[1];"transparent"===i.batchType&&this.clearStack()}))}refresh(){this.isEnabled=this._stack.length>0}addBatch(e){const t=this.editor.model.document.selection,i={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:i}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,i){const o=this.editor.model,n=o.document,s=[],r=e.map((e=>e.getTransformedByOperations(i))),a=r.flat();for(const l of r){const e=l.filter((e=>e.root!=n.graveyard)).filter((e=>!_p(e,a)));e.length&&(bp(e),s.push(e[0]))}s.length&&o.change((e=>{e.setSelection(s,{backward:t})}))}_undo(e,t){const i=this.editor.model,o=i.document;this._createdBatches.add(t);const n=e.operations.slice().filter((e=>e.isDocumentOperation));n.reverse();for(const s of n){const e=s.baseVersion+1,n=Array.from(o.history.getOperations(e)),r=ch([s.getReversed()],n,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}),a=r.operationsA;for(const l of a)t.addOperation(l),i.applyOperation(l),o.history.setOperationAsUndone(s,l)}}}function bp(e){e.sort(((e,t)=>e.start.isBefore(t.start)?-1:1));for(let t=1;t<e.length;t++){const i=e[t-1],o=i.getJoined(e[t],!0);o&&(t--,e.splice(t,2,o))}}function _p(e,t){return t.some((t=>t!==e&&t.containsRange(e,!0)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vp extends wp{execute(e=null){const t=e?this._stack.findIndex((t=>t.batch==e)):this._stack.length-1,i=this._stack.splice(t,1)[0],o=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(o,(()=>{this._undo(i.batch,o);const e=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,e),this.fire("revert",i.batch,o)})),this.refresh()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yp extends wp{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(t,(()=>{const i=e.batch.operations[e.batch.operations.length-1],o=i.baseVersion+1,n=this.editor.model.document.history.getOperations(o);this._restoreSelection(e.selection.ranges,e.selection.isBackward,n),this._undo(e.batch,t)})),this.refresh()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cp extends a.Z{static get pluginName(){return"UndoEditing"}constructor(e){super(e),this._batchRegistry=new WeakSet}init(){const e=this.editor;this._undoCommand=new vp(e),this._redoCommand=new yp(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",((e,t)=>{const i=t[0];if(!i.isDocumentOperation)return;const o=i.batch,n=this._redoCommand._createdBatches.has(o),s=this._undoCommand._createdBatches.has(o),r=this._batchRegistry.has(o);r||"transparent"==o.type&&!n&&!s||(n?this._undoCommand.addBatch(o):s||(this._undoCommand.addBatch(o),this._redoCommand.clearStack()),this._batchRegistry.add(o))}),{priority:"highest"}),this.listenTo(this._undoCommand,"revert",((e,t,i)=>{this._redoCommand.addBatch(i)})),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}var kp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',xp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Vp extends a.Z{static get pluginName(){return"UndoUI"}init(){const e=this.editor,t=e.locale,i=e.t,o="ltr"==t.uiLanguageDirection?kp:xp,n="ltr"==t.uiLanguageDirection?xp:kp;this._addButton("undo",i("Undo"),"CTRL+Z",o),this._addButton("redo",i("Redo"),"CTRL+Y",n)}_addButton(e,t,i,o){const n=this.editor;n.ui.componentFactory.add(e,(s=>{const r=n.commands.get(e),a=new l.Z(s);return a.set({label:t,icon:o,keystroke:i,tooltip:!0}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",(()=>{n.execute(e),n.editing.view.focus()})),a}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ep extends a.Z{static get requires(){return[Cp,Vp]}static get pluginName(){return"Undo"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ap extends a.Z{static get requires(){return[cp,lm,fp,gm,kd,Ep]}static get pluginName(){return"Essentials"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Pp extends cl.Z{constructor(e){super(e);const t=e.t;this.set("matchCount",0),this.set("highlightOffset",0),this.set("isDirty",!1),this.set("_areCommandsEnabled",{}),this.set("_resultsCounterText",""),this.set("_matchCase",!1),this.set("_wholeWordsOnly",!1),this.bind("_searchResultsFound").to(this,"matchCount",this,"isDirty",((e,t)=>e>0&&!t)),this._findInputView=this._createInputField(t("Find in text…")),this._replaceInputView=this._createInputField(t("Replace with…")),this._findButtonView=this._createButton({label:t("Find"),class:"ck-button-find ck-button-action",withText:!0}),this._findPrevButtonView=this._createButton({label:t("Previous result"),class:"ck-button-prev",icon:Wc,keystroke:"Shift+F3",tooltip:!0}),this._findNextButtonView=this._createButton({label:t("Next result"),class:"ck-button-next",icon:Wc,keystroke:"F3",tooltip:!0}),this._optionsDropdown=this._createOptionsDropdown(),this._replaceButtonView=this._createButton({label:t("Replace"),class:"ck-button-replace",withText:!0}),this._replaceAllButtonView=this._createButton({label:t("Replace all"),class:"ck-button-replaceall",withText:!0}),this._findFieldsetView=this._createFindFieldset(),this._replaceFieldsetView=this._createReplaceFieldset(),this._focusTracker=new eo,this._keystrokes=new to,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this._keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-find-and-replace-form"],tabindex:"-1"},children:[new Nc(e,{label:t("Find and replace")}),this._findFieldsetView,this._replaceFieldsetView]}),Bl(this)}render(){super.render(),Ml({view:this}),this._initFocusCycling(),this._initKeystrokeHandling()}destroy(){super.destroy(),this._focusTracker.destroy(),this._keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}reset(){this._findInputView.errorText=null,this.isDirty=!0}get _textToFind(){return this._findInputView.fieldView.element.value}get _textToReplace(){return this._replaceInputView.fieldView.element.value}_createFindFieldset(){const e=this.locale,t=new cl.Z(e);return this._findInputView.fieldView.on("input",(()=>{this.isDirty=!0})),this._findButtonView.on("execute",this._onFindButtonExecute.bind(this)),this._findPrevButtonView.delegate("execute").to(this,"findPrevious"),this._findNextButtonView.delegate("execute").to(this,"findNext"),this._findPrevButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",(({findPrevious:e})=>e)),this._findNextButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",(({findNext:e})=>e)),this._injectFindResultsCounter(),t.setTemplate({tag:"fieldset",attributes:{class:["ck","ck-find-and-replace-form__find"]},children:[this._findInputView,this._findButtonView,this._findPrevButtonView,this._findNextButtonView]}),t}_onFindButtonExecute(){if(this._textToFind)this.isDirty=!1,this.fire("findNext",{searchText:this._textToFind,matchCase:this._matchCase,wholeWords:this._wholeWordsOnly});else{const e=this.t;this._findInputView.errorText=e("Text to find must not be empty.")}}_injectFindResultsCounter(){const e=this.locale,t=e.t,i=this.bindTemplate,o=new cl.Z(e);this.bind("_resultsCounterText").to(this,"highlightOffset",this,"matchCount",((e,i)=>t("%0 of %1",[e,i]))),o.setTemplate({tag:"span",attributes:{class:["ck","ck-results-counter",i.if("isDirty","ck-hidden")]},children:[{text:i.to("_resultsCounterText")}]});const n=()=>{const t=this._findInputView.fieldView.element;if(!t||!t.offsetParent)return;const i=new Gi(o.element).width,n="ltr"===e.uiLanguageDirection?"paddingRight":"paddingLeft";t.style[n]=i?`calc( 2 * var(--ck-spacing-standard) + ${i}px )`:null};this.on("change:_resultsCounterText",n,{priority:"low"}),this.on("change:isDirty",n,{priority:"low"}),this._findInputView.template.children[0].children.push(o)}_createReplaceFieldset(){const e=this.locale,t=e.t,i=new cl.Z(e);return this._replaceButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replace:e},t)=>e&&t)),this._replaceAllButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replaceAll:e},t)=>e&&t)),this._replaceInputView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",(({replace:e},t)=>e&&t)),this._replaceInputView.bind("infoText").to(this._replaceInputView,"isEnabled",this._replaceInputView,"isFocused",((e,i)=>e||!i?"":t("Tip: Find some text first in order to replace it."))),this._replaceButtonView.on("execute",(()=>{this.fire("replace",{searchText:this._textToFind,replaceText:this._textToReplace})})),this._replaceAllButtonView.on("execute",(()=>{this.fire("replaceAll",{searchText:this._textToFind,replaceText:this._textToReplace}),this.focus()})),i.setTemplate({tag:"fieldset",attributes:{class:["ck","ck-find-and-replace-form__replace"]},children:[this._replaceInputView,this._optionsDropdown,this._replaceButtonView,this._replaceAllButtonView]}),i}_createOptionsDropdown(){const e=this.locale,t=e.t,i=_c(e);i.class="ck-options-dropdown",i.buttonView.set({withText:!1,label:t("Show options"),icon:sl.cog,tooltip:!0});const o=new Lc({withText:!0,label:t("Match case"),_isMatchCaseSwitch:!0}),n=new Lc({withText:!0,label:t("Whole words only")});return o.bind("isOn").to(this,"_matchCase"),n.bind("isOn").to(this,"_wholeWordsOnly"),i.on("execute",(e=>{e.source._isMatchCaseSwitch?this._matchCase=!this._matchCase:this._wholeWordsOnly=!this._wholeWordsOnly,this.isDirty=!0})),yc(i,new P.Z([{type:"switchbutton",model:o},{type:"switchbutton",model:n}])),i}_initFocusCycling(){const e=[this._findInputView,this._findButtonView,this._findPrevButtonView,this._findNextButtonView,this._replaceInputView,this._optionsDropdown,this._replaceButtonView,this._replaceAllButtonView];e.forEach((e=>{this._focusables.add(e),this._focusTracker.add(e.element)}))}_initKeystrokeHandling(){const e=e=>e.stopPropagation(),t=e=>{e.stopPropagation(),e.preventDefault()};this._keystrokes.listenTo(this.element),this._keystrokes.set("f3",(e=>{t(e),this._findNextButtonView.fire("execute")})),this._keystrokes.set("shift+f3",(e=>{t(e),this._findPrevButtonView.fire("execute")})),this._keystrokes.set("enter",(e=>{const i=e.target;i===this._findInputView.fieldView.element?(this._areCommandsEnabled.findNext?this._findNextButtonView.fire("execute"):this._findButtonView.fire("execute"),t(e)):i!==this._replaceInputView.fieldView.element||this.isDirty||(this._replaceButtonView.fire("execute"),t(e))})),this._keystrokes.set("shift+enter",(e=>{const i=e.target;i===this._findInputView.fieldView.element&&(this._areCommandsEnabled.findPrevious?this._findPrevButtonView.fire("execute"):this._findButtonView.fire("execute"),t(e))})),this._keystrokes.set("arrowright",e),this._keystrokes.set("arrowleft",e),this._keystrokes.set("arrowup",e),this._keystrokes.set("arrowdown",e),this.listenTo(this._findInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"}),this.listenTo(this._replaceInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}_createButton(e){const t=new l.Z(this.locale);return t.set(e),t}_createInputField(e){const t=new Rc(this.locale,Bc);return t.label=e,t}}var Sp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 13.786 1.532-1.286 3.857 4.596a1 1 0 1 1-1.532 1.286l-3.857-4.596z"/><path d="M16.004 8.5a6.5 6.5 0 0 1-9.216 5.905c-1.154-.53-.863-1.415-.663-1.615.194-.194.564-.592 1.635-.141a4.5 4.5 0 0 0 5.89-5.904l-.104-.227 1.332-1.331c.045-.046.196-.041.224.007a6.47 6.47 0 0 1 .902 3.306zm-3.4-5.715c.562.305.742 1.106.354 1.494-.388.388-.995.414-1.476.178a4.5 4.5 0 0 0-6.086 5.882l.114.236-1.348 1.349c-.038.037-.17.022-.198-.023a6.5 6.5 0 0 1 5.54-9.9 6.469 6.469 0 0 1 3.1.784z"/><path d="M4.001 11.93.948 8.877a.2.2 0 0 1 .141-.341h6.106a.2.2 0 0 1 .141.341L4.283 11.93a.2.2 0 0 1-.282 0zm11.083-6.789 3.053 3.053a.2.2 0 0 1-.14.342H11.89a.2.2 0 0 1-.14-.342l3.052-3.053a.2.2 0 0 1 .282 0z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tp extends a.Z{static get pluginName(){return"FindAndReplaceUI"}constructor(e){super(e),this.formView=null}init(){const e=this.editor;e.ui.componentFactory.add("findAndReplace",(t=>{const i=_c(t),o=this.formView=new Pp(e.locale);return i.bind("isEnabled").to(e.commands.get("find")),i.panelView.children.add(o),i.on("change:isOpen",((e,t,i)=>{i?(o.disableCssTransitions(),o.reset(),o._findInputView.fieldView.select(),o.focus(),o.enableCssTransitions()):(o.focus(),this.fire("searchReseted"))}),{priority:"low"}),this._setupDropdownButton(i),this._setupFormView(o),i}))}_setupDropdownButton(e){const t=this.editor,i=t.locale.t;e.buttonView.set({icon:Sp,label:i("Find and replace"),keystroke:"CTRL+F",tooltip:!0}),t.keystrokes.set("Ctrl+F",((t,i)=>{e.isOpen=!0,i()}))}_setupFormView(e){const t=this.editor,i=t.commands,o=this.editor.plugins.get("FindAndReplaceEditing"),n=o.state,s={before:-1,same:0,after:1};e.bind("highlightOffset").to(n,"highlightedResult",(e=>e?Array.from(n.results).sort(((e,t)=>s[e.marker.getStart().compareWith(t.marker.getStart())])).indexOf(e)+1:0)),e.listenTo(n.results,"change",(()=>{e.matchCount=n.results.length})),e.bind("_areCommandsEnabled").to(i.get("findNext"),"isEnabled",i.get("findPrevious"),"isEnabled",i.get("replace"),"isEnabled",i.get("replaceAll"),"isEnabled",((e,t,i,o)=>({findNext:e,findPrevious:t,replace:i,replaceAll:o}))),e.delegate("findNext","findPrevious","replace","replaceAll").to(this),e.on("change:isDirty",((e,t,i)=>{i&&this.fire("searchReseted")}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Np(e,t,i,o){const n=o||new P.Z;return t.change((o=>{[...e].forEach((({type:e,item:s})=>{if("elementStart"===e&&t.schema.checkChild(s,"$text")){const e=i({item:s,text:Ip(t.createRangeIn(s))});if(!e)return;e.forEach((e=>{const t=`findResult:${(0,oo.Z)()}`,i=o.addMarker(t,{usingOperation:!1,affectsData:!1,range:o.createRange(o.createPositionAt(s,e.start),o.createPositionAt(s,e.end))}),r=Dp(n,i);n.add({id:t,label:e.label,marker:i},r)}))}}))})),n}function Ip(e){return Array.from(e.getItems()).reduce(((e,t)=>t.is("text")||t.is("textProxy")?e+t.data:`${e}\n`),"")}function Dp(e,t){const i=e.find((({marker:e})=>t.getStart().isBefore(e.getStart())));return i?e.getIndex(i):e.length}function Rp(e){const t=e.length-1;let i=e.index;return 3===e.length&&(i+=e[1].length),{label:e[t],start:i,end:i+e[t].length}}function Bp(e,t){let i="gu";t.matchCase||(i+="i");let o=`(${Md(e)})`;if(t.wholeWords){const t="[^a-zA-ZÀ-ɏḀ-ỿ]";new RegExp("^"+t).test(e)||(o=`(^|${t}|_)${o}`),new RegExp(t+"$").test(e)||(o=`${o}(?=_|${t}|$)`)}const n=new RegExp(o,i);function s({text:e}){const t=[...e.matchAll(n)];return t.map(Rp)}return s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mp extends b.Z{constructor(e,t){super(e),this.isEnabled=!0,this.affectsData=!1,this._state=t}execute(e,{matchCase:t,wholeWords:i}={}){const{editor:o}=this,{model:n}=o;let s;"string"===typeof e?(s=Bp(e,{matchCase:t,wholeWords:i}),this._state.searchText=e):s=e;const r=n.document.getRootNames().reduce(((e,t)=>Np(n.createRangeIn(n.document.getRoot(t)),n,s,e)),null);return this._state.clear(n),this._state.results.addMany(Array.from(r)),this._state.highlightedResult=r.get(0),"string"===typeof e&&(this._state.searchText=e),this._state.matchCase=!!t,this._state.matchWholeWords=!!i,{results:r,findCallback:s}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Op extends b.Z{constructor(e,t){super(e),this.isEnabled=!0,this._state=t}execute(e,t){const{model:i}=this.editor;i.change((o=>{const n=t.marker.getRange();if("$graveyard"===n.root.rootName)return void this._state.results.remove(t);let s={};for(const e of n.getItems())if(e.is("$text")||e.is("$textProxy")){s=e.getAttributes();break}i.insertContent(o.createText(e,s),n),this._state.results.has(t)&&this._state.results.remove(t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lp extends Op{execute(e,t){const{editor:i}=this,{model:o}=i,n=t instanceof P.Z?t:o.document.getRootNames().reduce(((e,i)=>Np(o.createRangeIn(o.document.getRoot(i)),o,Bp(t,this._state),e)),null);n.length&&o.change((()=>{[...n].forEach((t=>{super.execute(e,t)}))}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $p extends b.Z{constructor(e,t){super(e),this.affectsData=!1,this._state=t,this.isEnabled=!1,this.listenTo(this._state.results,"change",(()=>{this.isEnabled=this._state.results.length>1}))}refresh(){this.isEnabled=this._state.results.length>1}execute(){const e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t+1>=e.length?0:t+1;this._state.highlightedResult=this._state.results.get(i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fp extends $p{execute(){const e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t-1<0?this._state.results.length-1:t-1;this._state.highlightedResult=this._state.results.get(i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zp{constructor(e){this.set("results",new P.Z),this.set("highlightedResult",null),this.set("searchText",""),this.set("replaceText",""),this.set("matchCase",!1),this.set("matchWholeWords",!1),this.results.on("change",((t,{removed:i,index:o})=>{if(i=Array.from(i),i.length){let t=!1;if(e.change((o=>{for(const n of i)this.highlightedResult===n&&(t=!0),e.markers.has(n.marker.name)&&o.removeMarker(n.marker)})),t){const e=o>=this.results.length?0:o;this.highlightedResult=this.results.get(e)}}}))}clear(e){this.searchText="",e.change((t=>{if(this.highlightedResult){const i=this.highlightedResult.marker.name.split(":")[1],o=e.markers.get(`findResultHighlighted:${i}`);o&&t.removeMarker(o)}[...this.results].forEach((({marker:e})=>{t.removeMarker(e)}))})),this.results.clear()}}(0,N.Z)(zp,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Zp="ck-find-result_selected";function Hp(e,t,i){const o=new Set,n=new Set,s=t.document.differ.getChanges();s.forEach((e=>{"$text"===e.name||t.schema.isInline(e.position.nodeAfter)?(o.add(e.position.parent),[...t.markers.getMarkersAtPosition(e.position)].forEach((e=>{n.add(e.name)}))):"insert"===e.type&&o.add(e.position.nodeAfter)})),t.document.differ.getChangedMarkers().forEach((({name:e,data:{newRange:t}})=>{t&&"$graveyard"===t.start.root.rootName&&n.add(e)})),o.forEach((e=>{const i=[...t.markers.getMarkersIntersectingRange(t.createRangeIn(e))];i.forEach((e=>n.add(e.name)))})),t.change((t=>{n.forEach((i=>{e.has(i)&&e.remove(i),t.removeMarker(i)}))})),o.forEach((o=>{Np(t.createRangeOn(o),t,i,e)}))}class Up extends a.Z{static get pluginName(){return"FindAndReplaceEditing"}init(){this._activeResults=null,this.state=new zp(this.editor.model),this._defineConverters(),this._defineCommands(),this.listenTo(this.state,"change:highlightedResult",((e,t,i,o)=>{const{model:n}=this.editor;n.change((e=>{if(o){const t=o.marker.name.split(":")[1],i=n.markers.get(`findResultHighlighted:${t}`);i&&e.removeMarker(i)}if(i){const t=i.marker.name.split(":")[1];e.addMarker(`findResultHighlighted:${t}`,{usingOperation:!1,affectsData:!1,range:i.marker.getRange()})}}))}));const e=(0,Si.Z)(t.bind(this),32);function t(e,t,i){if(i){const e=this.editor.editing.view.domConverter,t=this.editor.editing.mapper.toViewRange(i.marker.getRange());ro({target:e.viewRangeToDom(t),viewportOffset:40})}}this.listenTo(this.state,"change:highlightedResult",e,{priority:"low"}),this.listenTo(this.editor,"destroy",e.cancel)}find(e){const{editor:t}=this,{model:i}=t,{findCallback:o,results:n}=t.execute("find",e);return this._activeResults=n,this.listenTo(i.document,"change:data",(()=>Hp(this._activeResults,i,o))),this._activeResults}stop(){this._activeResults&&(this.stopListening(this.editor.model.document),this.state.clear(this.editor.model),this._activeResults=null)}_defineCommands(){this.editor.commands.add("find",new Mp(this.editor,this.state)),this.editor.commands.add("findNext",new $p(this.editor,this.state)),this.editor.commands.add("findPrevious",new Fp(this.editor,this.state)),this.editor.commands.add("replace",new Op(this.editor,this.state)),this.editor.commands.add("replaceAll",new Lp(this.editor,this.state))}_defineConverters(){const{editor:e}=this;e.conversion.for("editingDowncast").markerToHighlight({model:"findResult",view:({markerName:e})=>{const[,t]=e.split(":");return{name:"span",classes:["ck-find-result"],attributes:{"data-find-result":t}}}}),e.conversion.for("editingDowncast").markerToHighlight({model:"findResultHighlighted",view:({markerName:e})=>{const[,t]=e.split(":");return{name:"span",classes:[Zp],attributes:{"data-find-result":t}}}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Wp extends a.Z{static get requires(){return[Up,Tp]}static get pluginName(){return"FindAndReplace"}init(){const e=this.editor.plugins.get("FindAndReplaceUI"),t=this.editor.plugins.get("FindAndReplaceEditing"),i=t.state;e.on("findNext",((e,t)=>{t?(i.searchText=t.searchText,this.editor.execute("find",t.searchText,t)):this.editor.execute("findNext")})),e.on("findPrevious",((e,t)=>{t&&i.searchText!==t.searchText?this.editor.execute("find",t.searchText):this.editor.execute("findPrevious")})),e.on("replace",((e,t)=>{i.searchText!==t.searchText&&this.editor.execute("find",t.searchText);const o=i.highlightedResult;o&&this.editor.execute("replace",t.replaceText,o)})),e.on("replaceAll",((e,t)=>{i.searchText!==t.searchText&&this.editor.execute("find",t.searchText),this.editor.execute("replaceAll",t.replaceText,i.results)})),e.on("searchReseted",(()=>{i.clear(this.editor.model),t.stop()}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qp extends b.Z{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document,o=i.selection,n=e.value;t.change((e=>{if(o.isCollapsed)n?e.setSelectionAttribute(this.attributeKey,n):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(o.getRanges(),this.attributeKey);for(const t of i)n?e.setAttribute(this.attributeKey,n,t):e.removeAttribute(this.attributeKey,t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Gp extends P.Z{constructor(e){super(e),this.set("isEmpty",!0),this.on("change",(()=>{this.set("isEmpty",0===this.length)}))}add(e,t){this.find((t=>t.color===e.color))||super.add(e,t)}hasColor(e){return!!this.find((t=>t.color===e))}}(0,N.Z)(Gp,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jp extends cl.Z{constructor(e,{colors:t,columns:i,removeButtonLabel:o,documentColorsLabel:n,documentColorsCount:s}){super(e),this.items=this.createCollection(),this.colorDefinitions=t,this.focusTracker=new eo,this.keystrokes=new to,this.set("selectedColor"),this.removeButtonLabel=o,this.columns=i,this.documentColors=new Gp,this.documentColorsCount=s,this._focusCycler=new ql({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this._documentColorsLabel=n,this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-table"]},children:this.items}),this.items.add(this._removeColorButton())}updateDocumentColors(e,t){const i=e.document,o=this.documentColorsCount;this.documentColors.clear();for(const n of i.getRootNames()){const s=i.getRoot(n),r=e.createRangeIn(s);for(const e of r.getItems())if(e.is("$textProxy")&&e.hasAttribute(t)&&(this._addColorToDocumentColors(e.getAttribute(t)),this.documentColors.length>=o))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,i=this.selectedColor;t.selectedColor=i,e&&(e.selectedColor=i)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendGrids(){if(!this.staticColorsGrid&&(this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount)){const e=Ol.ZP.bind(this.documentColors,this.documentColors),t=new Ac(this.locale);t.text=this._documentColorsLabel,t.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_removeColorButton(){const e=new l.Z;return e.set({withText:!0,icon:sl.eraser,tooltip:!0,label:this.removeButtonLabel}),e.class="ck-color-table__remove-color",e.on("execute",(()=>{this.fire("execute",{value:null})})),e}_createStaticColorsGrid(){const e=new jl(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.delegate("execute").to(this),e}_createDocumentColorsGrid(){const e=Ol.ZP.bind(this.documentColors,this.documentColors),t=new jl(this.locale,{columns:this.columns});return t.delegate("execute").to(this),t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using((e=>{const t=new Wl;return t.set({color:e.color,hasBorder:e.options&&e.options.hasBorder}),e.label&&t.set({label:e.label,tooltip:!0}),t.on("execute",(()=>{this.fire("execute",{value:e.color})})),t})),this.documentColors.on("change:isEmpty",((e,i,o)=>{o&&(t.selectedColor=null)})),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find((t=>t.color===e));t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Kp="fontSize",Jp="fontFamily",Yp="fontColor",Qp="fontBackgroundColor";function Xp(e,t){const i={model:{key:e,values:[]},view:{},upcastAlso:{}};for(const o of t)i.model.values.push(o.model),i.view[o.model]=o.view,o.upcastAlso&&(i.upcastAlso[o.model]=o.upcastAlso);return i}function ef(e){return t=>nf(t.getStyle(e))}function tf(e){return(t,{writer:i})=>i.createAttributeElement("span",{style:`${e}:${t}`},{priority:7})}function of({dropdownView:e,colors:t,columns:i,removeButtonLabel:o,documentColorsLabel:n,documentColorsCount:s}){const r=e.locale,a=new jp(r,{colors:t,columns:i,removeButtonLabel:o,documentColorsLabel:n,documentColorsCount:s});return e.colorTableView=a,e.panelView.children.add(a),a.delegate("execute").to(e,"execute"),a}function nf(e){return e.replace(/\s/g,"")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sf extends qp{constructor(e){super(e,Jp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function rf(e){return e.map(af).filter((e=>!!e))}function af(e){return"object"===typeof e?e:"default"===e?{title:"Default",model:void 0}:"string"===typeof e?lf(e):void 0}function lf(e){const t=e.replace(/"|'/g,"").split(","),i=t[0],o=t.map(cf).join(", ");return{title:i,model:o,view:{name:"span",styles:{"font-family":o},priority:7}}}function cf(e){return e=e.trim(),e.indexOf(" ")>0&&(e=`'${e}'`),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class df extends a.Z{static get pluginName(){return"FontFamilyEditing"}constructor(e){super(e),e.config.define(Jp,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Jp}),e.model.schema.setAttributeProperties(Jp,{isFormatting:!0,copyOnEnter:!0});const t=rf(e.config.get("fontFamily.options")).filter((e=>e.model)),i=Xp(Jp,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(i),e.commands.add(Jp,new sf(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:Jp,view:(e,{writer:t})=>t.createAttributeElement("span",{style:"font-family:"+e},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:Jp,value:e=>e.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){const e=this.editor;e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:Jp,value:e=>e.getAttribute("face")}})}}var hf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uf extends a.Z{static get pluginName(){return"FontFamilyUI"}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),o=e.commands.get(Jp);e.ui.componentFactory.add(Jp,(n=>{const s=_c(n);return yc(s,mf(i,o)),s.buttonView.set({label:t("Font Family"),icon:hf,tooltip:!0}),s.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),s.bind("isEnabled").to(o),this.listenTo(s,"execute",(t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()})),s}))}_getLocalizedOptions(){const e=this.editor,t=e.t,i=rf(e.config.get(Jp).options);return i.map((e=>("Default"===e.title&&(e.title=t("Default")),e)))}}function mf(e,t){const i=new P.Z;for(const o of e){const e={type:"button",model:new Lc({commandName:Jp,commandParam:o.model,label:o.title,withText:!0})};e.model.bind("isOn").to(t,"value",(e=>e===o.model||!(!e||!o.model)&&e.split(",")[0].replace(/'/g,"").toLowerCase()===o.model.toLowerCase())),o.view&&o.view.styles&&e.model.set("labelStyle",`font-family: ${o.view.styles["font-family"]}`),i.add(e)}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gf extends a.Z{static get requires(){return[df,uf]}static get pluginName(){return"FontFamily"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pf extends qp{constructor(e){super(e,Kp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ff(e){return e.map((e=>bf(e))).filter((e=>!!e))}const wf={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function bf(e){if(Cf(e))return vf(e);const t=yf(e);return t?vf(t):"default"===e?{model:void 0,title:"Default"}:kf(e)?void 0:_f(e)}function _f(e){return"number"!==typeof e&&"string"!==typeof e||(e={title:String(e),model:`${parseFloat(e)}px`}),e.view={name:"span",styles:{"font-size":e.model}},vf(e)}function vf(e){return e.view.priority||(e.view.priority=7),e}function yf(e){return wf[e]||wf[e.model]}function Cf(e){return"object"===typeof e&&e.title&&e.model&&e.view}function kf(e){let t;if("object"===typeof e){if(!e.model)throw new S.ZP("font-size-invalid-definition",null,e);t=parseFloat(e.model)}else t=parseFloat(e);return isNaN(t)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const xf=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class Vf extends a.Z{static get pluginName(){return"FontSizeEditing"}constructor(e){super(e),e.config.define(Kp,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Kp}),e.model.schema.setAttributeProperties(Kp,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),i=ff(this.editor.config.get("fontSize.options")).filter((e=>e.model)),o=Xp(Kp,i);t?(this._prepareAnyValueConverters(o),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(o),e.commands.add(Kp,new pf(e))}_prepareAnyValueConverters(e){const t=this.editor,i=e.model.values.filter((e=>!Th(String(e))&&!Ih(String(e))));if(i.length)throw new S.ZP("font-size-invalid-use-of-named-presets",null,{presets:i});t.conversion.for("downcast").attributeToElement({model:Kp,view:(e,{writer:t})=>{if(e)return t.createAttributeElement("span",{style:"font-size:"+e},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:Kp,value:e=>e.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){const e=this.editor;e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:Kp,value:e=>{const t=e.getAttribute("size"),i="-"===t[0]||"+"===t[0];let o=parseInt(t,10);i&&(o=3+o);const n=xf.length-1,s=Math.min(Math.max(o,0),n);return xf[s]}}})}}var Ef='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Af extends a.Z{static get pluginName(){return"FontSizeUI"}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),o=e.commands.get(Kp);e.ui.componentFactory.add(Kp,(n=>{const s=_c(n);return yc(s,Pf(i,o)),s.buttonView.set({label:t("Font Size"),icon:Ef,tooltip:!0}),s.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),s.bind("isEnabled").to(o),this.listenTo(s,"execute",(t=>{e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus()})),s}))}_getLocalizedOptions(){const e=this.editor,t=e.t,i={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")},o=ff(e.config.get(Kp).options);return o.map((e=>{const t=i[e.title];return t&&t!=e.title&&(e=Object.assign({},e,{title:t})),e}))}}function Pf(e,t){const i=new P.Z;for(const o of e){const e={type:"button",model:new Lc({commandName:Kp,commandParam:o.model,label:o.title,class:"ck-fontsize-option",withText:!0})};o.view&&o.view.styles&&e.model.set("labelStyle",`font-size:${o.view.styles["font-size"]}`),o.view&&o.view.classes&&e.model.set("class",`${e.model.class} ${o.view.classes}`),e.model.bind("isOn").to(t,"value",(e=>e===o.model)),i.add(e)}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sf extends a.Z{static get requires(){return[Vf,Af]}static get pluginName(){return"FontSize"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tf extends qp{constructor(e){super(e,Yp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Nf extends a.Z{static get pluginName(){return"FontColorEditing"}constructor(e){super(e),e.config.define(Yp,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:Yp,value:ef("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:Yp,value:e=>e.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:Yp,view:tf("color")}),e.commands.add(Yp,new Tf(e)),e.model.schema.extend("$text",{allowAttributes:Yp}),e.model.schema.setAttributeProperties(Yp,{isFormatting:!0,copyOnEnter:!0})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class If extends a.Z{constructor(e,{commandName:t,icon:i,componentName:o,dropdownLabel:n}){super(e),this.commandName=t,this.componentName=o,this.icon=i,this.dropdownLabel=n,this.columns=e.config.get(`${this.componentName}.columns`),this.colorTableView=void 0}init(){const e=this.editor,t=e.locale,i=t.t,o=e.commands.get(this.commandName),n=Zl(e.config.get(this.componentName).colors),s=zl(t,n),r=e.config.get(`${this.componentName}.documentColors`);e.ui.componentFactory.add(this.componentName,(t=>{const n=_c(t);return this.colorTableView=of({dropdownView:n,colors:s.map((e=>({label:e.label,color:e.model,options:{hasBorder:e.hasBorder}}))),columns:this.columns,removeButtonLabel:i("Remove color"),documentColorsLabel:0!==r?i("Document colors"):void 0,documentColorsCount:void 0===r?this.columns:r}),this.colorTableView.bind("selectedColor").to(o,"value"),n.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),n.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),n.bind("isEnabled").to(o),n.on("execute",((t,i)=>{e.execute(this.commandName,i),e.editing.view.focus()})),n.on("change:isOpen",((t,i,o)=>{n.colorTableView.appendGrids(),o&&(0!==r&&this.colorTableView.updateDocumentColors(e.model,this.componentName),this.colorTableView.updateSelectedColors())})),n}))}}var Df='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rf extends If{constructor(e){const t=e.locale.t;super(e,{commandName:Yp,componentName:Yp,icon:Df,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bf extends a.Z{static get requires(){return[Nf,Rf]}static get pluginName(){return"FontColor"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mf extends qp{constructor(e){super(e,Qp)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Of extends a.Z{static get pluginName(){return"FontBackgroundColorEditing"}constructor(e){super(e),e.config.define(Qp,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(qh),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:Qp,value:ef("background-color")}}),e.conversion.for("downcast").attributeToElement({model:Qp,view:tf("background-color")}),e.commands.add(Qp,new Mf(e)),e.model.schema.extend("$text",{allowAttributes:Qp}),e.model.schema.setAttributeProperties(Qp,{isFormatting:!0,copyOnEnter:!0})}}var Lf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $f extends If{constructor(e){const t=e.locale.t;super(e,{commandName:Qp,componentName:Qp,icon:Lf,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ff extends a.Z{static get requires(){return[Of,$f]}static get pluginName(){return"FontBackgroundColor"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zf extends a.Z{static get requires(){return[gf,Sf,Bf,Ff]}static get pluginName(){return"Font"}}var Zf=i(52012);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hf extends b.Z{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some((t=>Uf(e,t,this.editor.model.schema)))}execute(e){const t=this.editor.model,i=t.document,o=e.value;t.change((e=>{const n=Array.from(i.selection.getSelectedBlocks()).filter((e=>Uf(e,o,t.schema)));for(const t of n)t.is("element",o)||e.rename(t,o)}))}}function Uf(e,t,i){return i.checkChild(e.parent,t)&&!i.isObject(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Wf="paragraph";class qf extends a.Z{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Zf.Paragraph]}init(){const e=this.editor,t=e.config.get("heading.options"),i=[];for(const o of t)o.model!==Wf&&(e.model.schema.register(o.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(o),i.push(o.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new Hf(e,i))}afterInit(){const e=this.editor,t=e.commands.get("enter"),i=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",((t,o)=>{const n=e.model.document.selection.getFirstPosition().parent,s=i.some((e=>n.is("element",e.model)));s&&!n.is("element",Wf)&&0===n.childCount&&o.writer.rename(n,Wf)}))}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:io.Z.get("low")+1})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gf(e){const t=e.t,i={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return e.config.get("heading.options").map((e=>{const t=i[e.title];return t&&t!=e.title&&(e.title=t),e}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jf extends a.Z{static get pluginName(){return"HeadingUI"}init(){const e=this.editor,t=e.t,i=Gf(e),o=t("Choose heading"),n=t("Heading");e.ui.componentFactory.add("heading",(t=>{const s={},r=new P.Z,a=e.commands.get("heading"),l=e.commands.get("paragraph"),c=[a];for(const e of i){const t={type:"button",model:new Lc({label:e.title,class:e.class,withText:!0})};"paragraph"===e.model?(t.model.bind("isOn").to(l,"value"),t.model.set("commandName","paragraph"),c.push(l)):(t.model.bind("isOn").to(a,"value",(t=>t===e.model)),t.model.set({commandName:"heading",commandValue:e.model})),r.add(t),s[e.model]=e.title}const d=_c(t);return yc(d,r),d.buttonView.set({isOn:!1,withText:!0,tooltip:n}),d.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),d.bind("isEnabled").toMany(c,"isEnabled",((...e)=>e.some((e=>e)))),d.buttonView.bind("label").to(a,"value",l,"value",((e,t)=>{const i=e||t&&"paragraph";return s[i]?s[i]:o})),this.listenTo(d,"execute",(t=>{e.execute(t.source.commandName,t.source.commandValue?{value:t.source.commandValue}:void 0),e.editing.view.focus()})),d}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kf extends a.Z{static get requires(){return[qf,jf]}static get pluginName(){return"Heading"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jf extends a.Z{static get requires(){return[jc]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",(t=>{Xf(e.editing.view.document.selection)&&t.stop()}),{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui,"update",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui.focusTracker,"change:isFocused",(()=>{this._updateToolbarsVisibility()}),{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:i,getRelatedElement:o,balloonClassName:n="ck-toolbar-container"}){if(!i.length)return void(0,S.KE)("widget-toolbar-no-items",{toolbarId:e});const s=this.editor,r=s.t,a=new uc(s.locale);if(a.ariaLabel=t||r("Widget toolbar"),this._toolbarDefinitions.has(e))throw new S.ZP("widget-toolbar-duplicated",this,{toolbarId:e});a.fillFromConfig(i,s.ui.componentFactory),this._toolbarDefinitions.set(e,{view:a,getRelatedElement:o,balloonClassName:n})}_updateToolbarsVisibility(){let e=0,t=null,i=null;for(const o of this._toolbarDefinitions.values()){const n=o.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&n)if(this.editor.ui.focusTracker.isFocused){const s=n.getAncestors().length;s>e&&(e=s,t=n,i=o)}else this._isToolbarVisible(o)&&this._hideToolbar(o);else this._isToolbarInBalloon(o)&&this._hideToolbar(o)}i&&this._showToolbar(i,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?Yf(this.editor,t):this._isToolbarInBalloon(e)||(this._balloon.add({view:e.view,position:Qf(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",(()=>{for(const e of this._toolbarDefinitions.values())if(this._isToolbarVisible(e)){const t=e.getRelatedElement(this.editor.editing.view.document.selection);Yf(this.editor,t)}})))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function Yf(e,t){const i=e.plugins.get("ContextualBalloon"),o=Qf(e,t);i.updatePosition(o)}function Qf(e,t){const i=e.editing.view,o=Zc.defaultPositions;return{target:i.domConverter.mapViewToDom(t),positions:[o.northArrowSouth,o.northArrowSouthWest,o.northArrowSouthEast,o.southArrowNorth,o.southArrowNorthWest,o.southArrowNorthEast,o.viewportStickyNorth]}}function Xf(e){const t=e.getSelectedElement();return!(!t||!pg(t))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ew{constructor(e){this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}begin(e,t,i){const o=new Gi(t);this.activeHandlePosition=nw(e),this._referenceCoordinates=iw(t,sw(this.activeHandlePosition)),this.originalWidth=o.width,this.originalHeight=o.height,this.aspectRatio=o.width/o.height;const n=i.style.width;n&&n.match(/^\d+(\.\d*)?%$/)?this.originalWidthPercents=parseFloat(n):this.originalWidthPercents=tw(i,o)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function tw(e,t){const i=e.parentElement,o=parseFloat(i.ownerDocument.defaultView.getComputedStyle(i).width);return t.width/o*100}function iw(e,t){const i=new Gi(e),o=t.split("-"),n={x:"right"==o[1]?i.right:i.left,y:"bottom"==o[0]?i.bottom:i.top};return n.x+=e.ownerDocument.defaultView.scrollX,n.y+=e.ownerDocument.defaultView.scrollY,n}function ow(e){return`ck-widget__resizer__handle-${e}`}function nw(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const i of t)if(e.classList.contains(ow(i)))return i}function sw(e){const t=e.split("-"),i={top:"bottom",bottom:"top",left:"right",right:"left"};return`${i[t[0]]}-${i[t[1]]}`}(0,N.Z)(ew,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class rw extends cl.Z{constructor(){super();const e=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",e.to("_viewPosition",(e=>e?`ck-orientation-${e}`:""))],style:{display:e.if("_isVisible","none",(e=>!e))}},children:[{text:e.to("_label")}]})}_bindToState(e,t){this.bind("_isVisible").to(t,"proposedWidth",t,"proposedHeight",((e,t)=>null!==e&&null!==t)),this.bind("_label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",((t,i,o)=>"px"===e.unit?`${t}×${i}`:`${o}%`)),this.bind("_viewPosition").to(t,"activeHandlePosition",t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",((e,t,i)=>t<50||i<50?"above-center":e))}_dismiss(){this.unbind(),this._isVisible=!1}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class aw{constructor(e){this._options=e,this._viewResizerWrapper=null,this.set("isEnabled",!0),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",(e=>{this.state.proposedWidth||this.state.proposedWidthPercents||(this._cleanup(),e.stop())}),{priority:"high"}),this.on("change:isEnabled",(()=>{this.isEnabled&&this.redraw()}))}attach(){const e=this,t=this._options.viewElement,i=this._options.editor.editing.view;i.change((i=>{const o=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},(function(t){const i=this.toDomElement(t);return e._appendHandles(i),e._appendSizeUI(i),e.on("change:isEnabled",((e,t,o)=>{i.style.display=o?"":"none"})),i.style.display=e.isEnabled?"":"none",i}));i.insert(i.createPositionAt(t,"end"),o),i.addClass("ck-widget_with-resizer",t),this._viewResizerWrapper=o}))}begin(e){this.state=new ew(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const t=this._proposeNewSize(e),i=this._options.editor.editing.view;i.change((e=>{const i=this._options.unit||"%",o=("%"===i?t.widthPercents:t.width)+i;e.setStyle("width",o,this._options.viewElement)}));const o=this._getHandleHost(),n=new Gi(o);t.handleHostWidth=Math.round(n.width),t.handleHostHeight=Math.round(n.height);const s=new Gi(o);t.width=Math.round(s.width),t.height=Math.round(s.height),this.redraw(n),this.state.update(t)}commit(){const e=this._options.unit||"%",t=("%"===e?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change((()=>{this._cleanup(),this._options.onCommit(t)}))}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const t=this._domResizerWrapper;if(!dw(t))return;const i=t.parentElement,o=this._getHandleHost(),n=this._viewResizerWrapper,s=[n.getStyle("width"),n.getStyle("height"),n.getStyle("left"),n.getStyle("top")];let r;if(i.isSameNode(o)){const t=e||new Gi(o);r=[t.width+"px",t.height+"px",void 0,void 0]}else r=[o.offsetWidth+"px",o.offsetHeight+"px",o.offsetLeft+"px",o.offsetTop+"px"];"same"!==U(s,r)&&this._options.editor.editing.view.change((e=>{e.setStyle({width:r[0],height:r[1],left:r[2],top:r[3]},n)}))}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss();const e=this._options.editor.editing.view;e.change((e=>{e.setStyle("width",this._initialViewWidth,this._options.viewElement)}))}_proposeNewSize(e){const t=this.state,i=cw(e),o=!this._options.isCentered||this._options.isCentered(this),n={x:t._referenceCoordinates.x-(i.x+t.originalWidth),y:i.y-t.originalHeight-t._referenceCoordinates.y};o&&t.activeHandlePosition.endsWith("-right")&&(n.x=i.x-(t._referenceCoordinates.x+t.originalWidth)),o&&(n.x*=2);const s={width:Math.abs(t.originalWidth+n.x),height:Math.abs(t.originalHeight+n.y)};s.dominant=s.width/t.aspectRatio>s.height?"width":"height",s.max=s[s.dominant];const r={width:s.width,height:s.height};return"width"==s.dominant?r.height=r.width/t.aspectRatio:r.width=r.height*t.aspectRatio,{width:Math.round(r.width),height:Math.round(r.height),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*r.width*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const t=["top-left","top-right","bottom-right","bottom-left"];for(const i of t)e.appendChild(new Ol.ZP({tag:"div",attributes:{class:`ck-widget__resizer__handle ${lw(i)}`}}).render())}_appendSizeUI(e){this._sizeView=new rw,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function lw(e){return`ck-widget__resizer__handle-${e}`}function cw(e){return{x:e.pageX,y:e.pageY}}function dw(e){return e&&e.ownerDocument&&e.ownerDocument.contains(e)}(0,N.Z)(aw,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hw extends a.Z{static get pluginName(){return"WidgetResize"}init(){const e=this.editor.editing,t=ri.window.document;this.set("visibleResizer",null),this.set("_activeResizer",null),this._resizers=new Map,e.view.addObserver(bh),this._observer=Object.create(_i.Z),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this));const i=()=>{this.visibleResizer&&this.visibleResizer.redraw()};this._redrawFocusedResizerThrottled=(0,Jg.Z)(i,200),this.on("change:visibleResizer",i),this.editor.ui.on("update",this._redrawFocusedResizerThrottled),this.editor.model.document.on("change",(()=>{for(const[e,t]of this._resizers)e.isAttached()||(this._resizers.delete(e),t.destroy())}),{priority:"lowest"}),this._observer.listenTo(ri.window,"resize",this._redrawFocusedResizerThrottled);const o=this.editor.editing.view.document.selection;o.on("change",(()=>{const e=o.getSelectedElement();this.visibleResizer=this.getResizerByViewElement(e)||null}))}destroy(){this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawFocusedResizerThrottled.cancel()}attachTo(e){const t=new aw(e),i=this.editor.plugins;if(t.attach(),i.has("WidgetToolbarRepository")){const e=i.get("WidgetToolbarRepository");t.on("begin",(()=>{e.forceDisabled("resize")}),{priority:"lowest"}),t.on("cancel",(()=>{e.clearForceDisabled("resize")}),{priority:"highest"}),t.on("commit",(()=>{e.clearForceDisabled("resize")}),{priority:"highest"})}this._resizers.set(e.viewElement,t);const o=this.editor.editing.view.document.selection,n=o.getSelectedElement();return this.getResizerByViewElement(n)==t&&(this.visibleResizer=t),t}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const t of this._resizers.values())if(t.containsHandle(e))return t}_mouseDownListener(e,t){const i=t.domTarget;aw.isResizeHandle(i)&&(this._activeResizer=this._getResizerByHandle(i),this._activeResizer&&(this._activeResizer.begin(i),e.stop(),t.preventDefault()))}_mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}(0,N.Z)(hw,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uw extends b.Z{refresh(){const e=this.editor.model,t=e.schema,i=e.document.selection;this.isEnabled=mw(i,t,e)}execute(){const e=this.editor.model;e.change((t=>{const i=t.createElement("horizontalLine");e.insertContent(i);let o=i.nextSibling;const n=o&&e.schema.checkChild(o,"$text");!n&&e.schema.checkChild(i.parent,"paragraph")&&(o=t.createElement("paragraph"),e.insertContent(o,t.createPositionAfter(i))),o&&t.setSelection(o,0)}))}}function mw(e,t,i){const o=gw(e,i);return t.checkChild(o,"horizontalLine")}function gw(e,t){const i=kg(e,t),o=i.start.parent;return o.isEmpty&&!o.is("element","$root")?o.parent:o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pw extends a.Z{static get pluginName(){return"HorizontalLineEditing"}init(){const e=this.editor,t=e.model.schema,i=e.t,o=e.conversion;t.register("horizontalLine",{isObject:!0,allowWhere:"$block"}),o.for("dataDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>t.createEmptyElement("hr")}),o.for("editingDowncast").elementToElement({model:"horizontalLine",view:(e,{writer:t})=>{const o=i("Horizontal line"),n=t.createContainerElement("div"),s=t.createEmptyElement("hr");return t.addClass("ck-horizontal-line",n),t.setCustomProperty("hr",!0,n),t.insert(t.createPositionAt(n,0),s),fw(n,t,o)}}),o.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),e.commands.add("horizontalLine",new uw(e))}}function fw(e,t,i){return t.setCustomProperty("horizontalLine",!0,e),fg(e,t,{label:i})}var ww='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bw extends a.Z{static get pluginName(){return"HorizontalLineUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("horizontalLine",(i=>{const o=e.commands.get("horizontalLine"),n=new l.Z(i);return n.set({label:t("Horizontal line"),icon:ww,tooltip:!0}),n.bind("isEnabled").to(o,"isEnabled"),this.listenTo(n,"execute",(()=>{e.execute("horizontalLine"),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _w extends a.Z{static get requires(){return[pw,bw,Gg]}static get pluginName(){return"HorizontalLine"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vw extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled&&i.hasAttribute("alt")?this.value=i.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor,i=t.plugins.get("ImageUtils"),o=t.model,n=i.getClosestSelectedImageElement(o.document.selection);o.change((t=>{t.setAttribute("alt",e.newValue,n)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function yw(e,t){const i=e.createEmptyElement("img"),o="imageBlock"===t?e.createContainerElement("figure",{class:"image"}):e.createContainerElement("span",{class:"image-inline"},{isAllowedInsideAttributeElement:!0});return e.insert(e.createPositionAt(o,0),i),o}function Cw(e,t){if(e.plugins.has("ImageInlineEditing")!==e.plugins.has("ImageBlockEditing"))return{name:"img"};const i=e.plugins.get("ImageUtils");return e=>{if(!i.isInlineImageView(e))return null;const o=e.findAncestor(i.isBlockImageView)?"imageBlock":"imageInline";return o!==t?null:{name:!0}}}function kw(e,t){const i=(0,Xi.Z)(t.getSelectedBlocks());return!i||e.isObject(i)||i.isEmpty&&"listItem"!=i.name?"imageBlock":"imageInline"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xw extends a.Z{static get pluginName(){return"ImageUtils"}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},t=null,i=null){const o=this.editor,n=o.model,s=n.document.selection;i=Pw(o,t||s,i),e={...Object.fromEntries(s.getAttributes()),...e};for(const r in e)n.schema.checkAttribute(i,r)||delete e[r];return n.change((o=>{const r=o.createElement(i,e);return t||"imageInline"==i||(t=kg(s,n)),n.insertContent(r,t),r.parent?(o.setSelection(r,"on"),r):null}))}getClosestSelectedImageWidget(e){const t=e.getSelectedElement();if(t&&this.isImageWidget(t))return t;let i=e.getFirstPosition().parent;while(i){if(i.is("element")&&this.isImageWidget(i))return i;i=i.parent}return null}getClosestSelectedImageElement(e){const t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock")}isImageAllowed(){const e=this.editor.model,t=e.document.selection;return Vw(this.editor,t)&&Ew(t)}toImageWidget(e,t,i){t.setCustomProperty("image",!0,e);const o=()=>{const t=this.findViewImgElement(e),o=t.getAttribute("alt");return o?`${o} ${i}`:i};return fg(e,t,{label:o})}isImageWidget(e){return!!e.getCustomProperty("image")&&pg(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const t=this.editor.editing.view;for(const{item:i}of t.createRangeIn(e))if(this.isInlineImageView(i))return i}}function Vw(e,t){const i=Pw(e,t);if("imageBlock"==i){const i=Aw(t,e.model);if(e.model.schema.checkChild(i,"imageBlock"))return!0}else if(e.model.schema.checkChild(t.focus,"imageInline"))return!0;return!1}function Ew(e){return[...e.focus.getAncestors()].every((e=>!e.is("element","imageBlock")))}function Aw(e,t){const i=kg(e,t),o=i.start.parent;return o.isEmpty&&!o.is("element","$root")?o.parent:o}function Pw(e,t,i){const o=e.model.schema,n=e.config.get("image.insert.type");return e.plugins.has("ImageBlockEditing")?e.plugins.has("ImageInlineEditing")?i||("inline"===n?"imageInline":"block"===n?"imageBlock":t.is("selection")?kw(o,t):o.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Sw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new vw(this.editor))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Tw extends cl.Z{constructor(e){super(e);const t=this.locale.t;this.focusTracker=new eo,this.keystrokes=new to,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(t("Save"),sl.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(t("Cancel"),sl.cancel,"ck-button-cancel","cancel"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),Bl(this)}render(){super.render(),this.keystrokes.listenTo(this.element),Ml({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(e,t,i,o){const n=new l.Z(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.extendTemplate({attributes:{class:i}}),o&&n.delegate("execute").to(this,o),n}_createLabeledInputView(){const e=this.locale.t,t=new Rc(this.locale,Bc);return t.label=e("Text alternative"),t}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Nw(e){const t=e.plugins.get("ContextualBalloon");if(e.plugins.get("ImageUtils").getClosestSelectedImageWidget(e.editing.view.document.selection)){const i=Iw(e);t.updatePosition(i)}}function Iw(e){const t=e.editing.view,i=Zc.defaultPositions,o=e.plugins.get("ImageUtils");return{target:t.domConverter.viewToDom(o.getClosestSelectedImageWidget(t.document.selection)),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Dw extends a.Z{static get requires(){return[jc]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",(i=>{const o=e.commands.get("imageTextAlternative"),n=new l.Z(i);return n.set({label:t("Change image text alternative"),icon:sl.lowVision,tooltip:!0}),n.bind("isEnabled").to(o,"isEnabled"),this.listenTo(n,"execute",(()=>{this._showForm()})),n}))}_createForm(){const e=this.editor,t=e.editing.view,i=t.document,o=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Tw(e.locale),this._form.render(),this.listenTo(this._form,"submit",(()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)})),this.listenTo(this._form,"cancel",(()=>{this._hideForm(!0)})),this._form.keystrokes.set("Esc",((e,t)=>{this._hideForm(!0),t()})),this.listenTo(e.ui,"update",(()=>{o.getClosestSelectedImageWidget(i.selection)?this._isVisible&&Nw(e):this._hideForm(!0)})),Rl({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const e=this.editor,t=e.commands.get("imageTextAlternative"),i=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Iw(e)}),i.fieldView.value=i.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rw extends a.Z{static get requires(){return[Sw,Dw]}static get pluginName(){return"ImageTextAlternative"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Bw(e){return e=>{e.on("element:figure",t)};function t(t,i,o){if(!o.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const n=e.findViewImgElement(i.viewItem);if(!n||!o.consumable.test(n,{name:!0}))return;o.consumable.consume(i.viewItem,{name:!0,classes:"image"});const s=o.convertItem(n,i.modelCursor),r=(0,Xi.Z)(s.modelRange.getItems());r?(o.convertChildren(i.viewItem,r),o.updateConversionResult(r,i)):o.consumable.revert(i.viewItem,{name:!0,classes:"image"})}}function Mw(e,t){return e=>{e.on(`attribute:srcset:${t}`,i)};function i(t,i,o){if(!o.consumable.consume(i.item,t.name))return;const n=o.writer,s=o.mapper.toViewElement(i.item),r=e.findViewImgElement(s);if(null===i.attributeNewValue){const e=i.attributeOldValue;e.data&&(n.removeAttribute("srcset",r),n.removeAttribute("sizes",r),e.width&&n.removeAttribute("width",r))}else{const e=i.attributeNewValue;e.data&&(n.setAttribute("srcset",e.data,r),n.setAttribute("sizes","100vw",r),e.width&&n.setAttribute("width",e.width,r))}}}function Ow(e,t,i){return e=>{e.on(`attribute:${i}:${t}`,o)};function o(t,i,o){if(!o.consumable.consume(i.item,t.name))return;const n=o.writer,s=o.mapper.toViewElement(i.item),r=e.findViewImgElement(s);n.setAttribute(i.attributeKey,i.attributeNewValue||"",r)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lw extends vi{observe(e){this.listenTo(e,"load",((e,t)=>{const i=t.target;this.checkShouldIgnoreEventFromTarget(i)||"IMG"==i.tagName&&this._fireEvents(t)}),{useCapture:!0})}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $w extends b.Z{constructor(e){super(e);const t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||"block"===t&&(0,S.KE)("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||"inline"===t&&(0,S.KE)("image-inline-plugin-required")}refresh(){this.isEnabled=this.editor.plugins.get("ImageUtils").isImageAllowed()}execute(e){const t=(0,D.Z)(e.source),i=this.editor.model.document.selection,o=this.editor.plugins.get("ImageUtils"),n=Object.fromEntries(i.getAttributes());t.forEach(((e,t)=>{const s=i.getSelectedElement();if("string"===typeof e&&(e={src:e}),t&&s&&o.isImage(s)){const t=this.editor.model.createPositionAfter(s);o.insertImage({...e,...n},t)}else o.insertImage({...e,...n})}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.conversion;e.editing.view.addObserver(Lw),t.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:e=>{const t={data:e.getAttribute("srcset")};return e.hasAttribute("width")&&(t.width=e.getAttribute("width")),t}}});const i=new $w(e);e.commands.add("insertImage",i),e.commands.add("imageInsert",i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zw extends b.Z{constructor(e,t){super(e),this._modelElementName=t}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);"imageBlock"===this._modelElementName?this.isEnabled=t.isInlineImage(i):this.isEnabled=t.isBlockImage(i)}execute(){const e=this.editor,t=this.editor.model,i=e.plugins.get("ImageUtils"),o=i.getClosestSelectedImageElement(t.document.selection),n=Object.fromEntries(o.getAttributes());return n.src||n.uploadId?t.change((e=>{const s=Array.from(t.markers).filter((e=>e.getRange().containsItem(o))),r=i.insertImage(n,t.createSelection(o,"on"),this._modelElementName);if(!r)return null;const a=e.createRangeOn(r);for(const t of s){const i=t.getRange(),o="$graveyard"!=i.root.rootName?i.getJoined(a,!0):a;e.updateMarker(t,{range:o})}return{oldElement:o,newElement:r}})):null}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Zw extends a.Z{static get requires(){return[Fw,xw,ag]}static get pluginName(){return"ImageBlockEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageBlock",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new zw(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,i=e.conversion,o=e.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageBlock",view:(e,{writer:t})=>yw(t,"imageBlock")}),i.for("editingDowncast").elementToElement({model:"imageBlock",view:(e,{writer:i})=>o.toImageWidget(yw(i,"imageBlock"),i,t("image widget"))}),i.for("downcast").add(Ow(o,"imageBlock","src")).add(Ow(o,"imageBlock","alt")).add(Mw(o,"imageBlock")),i.for("upcast").elementToElement({view:Cw(e,"imageBlock"),model:(e,{writer:t})=>t.createElement("imageBlock",e.hasAttribute("src")?{src:e.getAttribute("src")}:null)}).add(Bw(o))}_setupClipboardIntegration(){const e=this.editor,t=e.model,i=e.editing.view,o=e.plugins.get("ImageUtils");this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((n,s)=>{const r=Array.from(s.content.getChildren());let a;if(!r.every(o.isInlineImageView))return;a=s.targetRanges?e.editing.mapper.toModelRange(s.targetRanges[0]):t.document.selection.getFirstRange();const l=t.createSelection(a);if("imageBlock"===kw(t.schema,l)){const e=new _h(i.document),t=r.map((t=>e.createElement("figure",{class:"image"},t)));s.content=e.createDocumentFragment(t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hw extends a.Z{static get requires(){return[Zw,Gg,Rw]}static get pluginName(){return"ImageBlock"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Uw extends a.Z{static get requires(){return[Fw,xw,ag]}static get pluginName(){return"ImageInlineEditing"}init(){const e=this.editor,t=e.model.schema;t.register("imageInline",{isObject:!0,isInline:!0,allowWhere:"$text",allowAttributesOf:"$text",allowAttributes:["alt","src","srcset"]}),t.addChildCheck(((e,t)=>{if(e.endsWith("caption")&&"imageInline"===t.name)return!1})),this._setupConversion(),e.plugins.has("ImageBlockEditing")&&(e.commands.add("imageTypeInline",new zw(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const e=this.editor,t=e.t,i=e.conversion,o=e.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageInline",view:(e,{writer:t})=>t.createEmptyElement("img")}),i.for("editingDowncast").elementToElement({model:"imageInline",view:(e,{writer:i})=>o.toImageWidget(yw(i,"imageInline"),i,t("image widget"))}),i.for("downcast").add(Ow(o,"imageInline","src")).add(Ow(o,"imageInline","alt")).add(Mw(o,"imageInline")),i.for("upcast").elementToElement({view:Cw(e,"imageInline"),model:(e,{writer:t})=>t.createElement("imageInline",e.hasAttribute("src")?{src:e.getAttribute("src")}:null)})}_setupClipboardIntegration(){const e=this.editor,t=e.model,i=e.editing.view,o=e.plugins.get("ImageUtils");this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((n,s)=>{const r=Array.from(s.content.getChildren());let a;if(!r.every(o.isBlockImageView))return;a=s.targetRanges?e.editing.mapper.toModelRange(s.targetRanges[0]):t.document.selection.getFirstRange();const l=t.createSelection(a);if("imageInline"===kw(t.schema,l)){const e=new _h(i.document),t=r.map((t=>1===t.childCount?(Array.from(t.getAttributes()).forEach((i=>e.setAttribute(...i,o.findViewImgElement(t)))),t.getChild(0)):t));s.content=e.createDocumentFragment(t)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ww extends a.Z{static get requires(){return[Uw,Gg,Rw]}static get pluginName(){return"ImageInline"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qw extends a.Z{static get requires(){return[Hw,Ww]}static get pluginName(){return"Image"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Gw(e){for(const t of e.getChildren())if(t&&t.is("element","caption"))return t;return null}function jw(e,t){const i=t.getFirstPosition().findAncestor("caption");return i&&e.isBlockImage(i.parent)?i:null}function Kw(e,t){return"figcaption"==t.name&&e.isBlockImageView(t.parent)?{name:!0}:null}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Jw extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils");if(!e.plugins.has(Zw))return this.isEnabled=!1,void(this.value=!1);const i=e.model.document.selection,o=i.getSelectedElement();if(!o){const e=jw(t,i);return this.isEnabled=!!e,void(this.value=!!e)}this.isEnabled=this.editor.plugins.get("ImageUtils").isImage(o),this.isEnabled?this.value=!!Gw(o):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change((e=>{this.value?this._hideImageCaption(e):this._showImageCaption(e,t)}))}_showImageCaption(e,t){const i=this.editor.model,o=i.document.selection,n=this.editor.plugins.get("ImageCaptionEditing");let s=o.getSelectedElement();const r=n._getSavedCaption(s);this.editor.plugins.get("ImageUtils").isInlineImage(s)&&(this.editor.execute("imageTypeBlock"),s=o.getSelectedElement());const a=r||e.createElement("caption");e.append(a,s),t&&e.setSelection(a,"in")}_hideImageCaption(e){const t=this.editor,i=t.model.document.selection,o=t.plugins.get("ImageCaptionEditing"),n=t.plugins.get("ImageUtils");let s,r=i.getSelectedElement();r?s=Gw(r):(s=jw(n,i),r=s.parent),o._saveCaption(r,s),e.setSelection(r,"on"),e.remove(s)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Yw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema;t.isRegistered("caption")?t.extend("caption",{allowIn:"imageBlock"}):t.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new Jw(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration()}_setupConversion(){const e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),o=e.t;e.conversion.for("upcast").elementToElement({view:e=>Kw(i,e),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>i.isBlockImage(e.parent)?t.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(e,{writer:n})=>{if(!i.isBlockImage(e.parent))return null;const s=n.createEditableElement("figcaption");return n.setCustomProperty("imageCaption",!0,s),Yd({view:t,element:s,text:o("Enter image caption"),keepOnFocus:!0}),Cg(s,n)}}),e.editing.mapper.on("modelToViewPosition",Qw(t)),e.data.mapper.on("modelToViewPosition",Qw(t))}_setupImageTypeCommandsIntegration(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=e.commands.get("imageTypeInline"),o=e.commands.get("imageTypeBlock"),n=e=>{if(!e.return)return;const{oldElement:i,newElement:o}=e.return;if(!i)return;if(t.isBlockImage(i)){const e=Gw(i);if(e)return void this._saveCaption(o,e)}const n=this._getSavedCaption(i);n&&this._saveCaption(o,n)};i&&this.listenTo(i,"execute",n,{priority:"low"}),o&&this.listenTo(o,"execute",n,{priority:"low"})}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?ko.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}function Qw(e){return(t,i)=>{const o=i.modelPosition,n=o.parent;if(!n.is("element","imageBlock"))return;const s=i.mapper.toViewElement(n);i.viewPosition=e.createPositionAt(s,o.offset+1)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Xw extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageCaptionUI"}init(){const e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),o=e.t;e.ui.componentFactory.add("toggleImageCaption",(n=>{const s=e.commands.get("toggleImageCaption"),r=new l.Z(n);return r.set({icon:sl.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(s,"value","isEnabled"),r.bind("label").to(s,"value",(e=>o(e?"Toggle caption off":"Toggle caption on"))),this.listenTo(r,"execute",(()=>{e.execute("toggleImageCaption",{focusCaptionOnShow:!0});const o=jw(i,e.model.document.selection);if(o){const i=e.editing.mapper.toViewElement(o);t.scrollToTheSelection(),t.change((e=>{e.addClass("image__caption_highlighted",i)}))}})),r}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eb extends a.Z{static get requires(){return[Yw,Xw]}static get pluginName(){return"ImageCaption"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tb extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!i,i&&i.hasAttribute("width")?this.value={width:i.getAttribute("width"),height:null}:this.value=null}execute(e){const t=this.editor,i=t.model,o=t.plugins.get("ImageUtils"),n=o.getClosestSelectedImageElement(i.document.selection);this.value={width:e.width,height:null},n&&i.change((t=>{t.setAttribute("width",e.width,n)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ib extends a.Z{static get requires(){return[xw]}static get pluginName(){return"ImageResizeEditing"}constructor(e){super(e),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const e=this.editor,t=new tb(e);this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t)}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:"width"}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:"width"})}_registerConverters(e){const t=this.editor;t.conversion.for("downcast").add((t=>t.on(`attribute:width:${e}`,((e,t,i)=>{if(!i.consumable.consume(t.item,e.name))return;const o=i.writer,n=i.mapper.toViewElement(t.item);null!==t.attributeNewValue?(o.setStyle("width",t.attributeNewValue,n),o.addClass("image_resized",n)):(o.removeStyle("width",n),o.removeClass("image_resized",n))})))),t.conversion.for("upcast").attributeToAttribute({view:{name:"imageBlock"===e?"figure":"img",styles:{width:/.+/}},model:{key:"width",value:e=>e.getStyle("width")}})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ob={small:sl.objectSizeSmall,medium:sl.objectSizeMedium,large:sl.objectSizeLarge,original:sl.objectSizeFull};class nb extends a.Z{static get requires(){return[ib]}static get pluginName(){return"ImageResizeButtons"}constructor(e){super(e),this._resizeUnit=e.config.get("image.resizeUnit")}init(){const e=this.editor,t=e.config.get("image.resizeOptions"),i=e.commands.get("resizeImage");this.bind("isEnabled").to(i);for(const o of t)this._registerImageResizeButton(o);this._registerImageResizeDropdown(t)}_registerImageResizeButton(e){const t=this.editor,{name:i,value:o,icon:n}=e,s=o?o+this._resizeUnit:null;t.ui.componentFactory.add(i,(i=>{const o=new l.Z(i),r=t.commands.get("resizeImage"),a=this._getOptionLabelValue(e,!0);if(!ob[n])throw new S.ZP("imageresizebuttons-missing-icon",t,e);return o.set({label:a,icon:ob[n],tooltip:a,isToggleable:!0}),o.bind("isEnabled").to(this),o.bind("isOn").to(r,"value",sb(s)),this.listenTo(o,"execute",(()=>{t.execute("resizeImage",{width:s})})),o}))}_registerImageResizeDropdown(e){const t=this.editor,i=t.t,o=e.find((e=>!e.value)),n=n=>{const s=t.commands.get("resizeImage"),r=_c(n,Yl),a=r.buttonView;return a.set({tooltip:i("Resize image"),commandValue:o.value,icon:ob.medium,isToggleable:!0,label:this._getOptionLabelValue(o),withText:!0,class:"ck-resize-image-button"}),a.bind("label").to(s,"value",(e=>e&&e.width?e.width:this._getOptionLabelValue(o))),r.bind("isOn").to(s),r.bind("isEnabled").to(this),yc(r,this._getResizeDropdownListItemDefinitions(e,s)),r.listView.ariaLabel=i("Image resize list"),this.listenTo(r,"execute",(e=>{t.execute(e.source.commandName,{width:e.source.commandValue}),t.editing.view.focus()})),r};t.ui.componentFactory.add("resizeImage",n),t.ui.componentFactory.add("imageResize",n)}_getOptionLabelValue(e,t){const i=this.editor.t;return e.label?e.label:t?e.value?i("Resize image to %0",e.value+this._resizeUnit):i("Resize image to the original size"):e.value?e.value+this._resizeUnit:i("Original")}_getResizeDropdownListItemDefinitions(e,t){const i=new P.Z;return e.map((e=>{const o=e.value?e.value+this._resizeUnit:null,n={type:"button",model:new Lc({commandName:"resizeImage",commandValue:o,label:this._getOptionLabelValue(e),withText:!0,icon:null})};n.model.bind("isOn").to(t,"value",sb(o)),i.add(n)})),i}}function sb(e){return t=>null===e&&t===e||t&&t.width===e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const rb="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",ab=/(image|image-inline)/,lb="image_resized";class cb extends a.Z{static get requires(){return[hw]}static get pluginName(){return"ImageResizeHandles"}init(){const e=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(e),this._setupResizerCreator()}_setupResizerCreator(){const e=this.editor,t=e.editing.view;t.addObserver(Lw),this.listenTo(t.document,"imageLoaded",((i,o)=>{if(!o.target.matches(rb))return;const n=e.editing.view.domConverter,s=n.domToView(o.target),r=s.findAncestor({classes:ab});let a=this.editor.plugins.get(hw).getResizerByViewElement(r);if(a)return void a.redraw();const l=e.editing.mapper,c=l.toModelElement(r);a=e.plugins.get(hw).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:c,viewElement:r,editor:e,getHandleHost(e){return e.querySelector("img")},getResizeHost(){return n.viewToDom(l.toViewElement(c.parent))},isCentered(){const e=c.getAttribute("imageStyle");return!e||"block"==e||"alignCenter"==e},onCommit(i){t.change((e=>{e.removeClass(lb,r)})),e.execute("resizeImage",{width:i})}}),a.on("updateSize",(()=>{r.hasClass(lb)||t.change((e=>{e.addClass(lb,r)}))})),a.bind("isEnabled").to(this)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class db extends a.Z{static get requires(){return[ib,cb,nb]}static get pluginName(){return"ImageResize"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hb extends b.Z{constructor(e,t){super(e),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(t.map((e=>{if(e.isDefault)for(const t of e.modelElements)this._defaultStyles[t]=e.name;return[e.name,e]})))}refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled?i.hasAttribute("imageStyle")?this.value=i.getAttribute("imageStyle"):this.value=this._defaultStyles[i.name]:this.value=!1}execute(e={}){const t=this.editor,i=t.model,o=t.plugins.get("ImageUtils");i.change((t=>{const n=e.value;let s=o.getClosestSelectedImageElement(i.document.selection);n&&this.shouldConvertImageType(n,s)&&(this.editor.execute(o.isBlockImage(s)?"imageTypeInline":"imageTypeBlock"),s=o.getClosestSelectedImageElement(i.document.selection)),!n||this._styles.get(n).isDefault?t.removeAttribute("imageStyle",s):t.setAttribute("imageStyle",n,s)}))}shouldConvertImageType(e,t){const i=this._styles.get(e).modelElements;return!i.includes(t.name)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const{objectFullWidth:ub,objectInline:mb,objectLeft:gb,objectRight:pb,objectCenter:fb,objectBlockLeft:wb,objectBlockRight:bb}=sl,_b={inline:{name:"inline",title:"In line",icon:mb,modelElements:["imageInline"],isDefault:!0},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:gb,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"},alignBlockLeft:{name:"alignBlockLeft",title:"Left aligned image",icon:wb,modelElements:["imageBlock"],className:"image-style-block-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:fb,modelElements:["imageBlock"],className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:pb,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"},alignBlockRight:{name:"alignBlockRight",title:"Right aligned image",icon:bb,modelElements:["imageBlock"],className:"image-style-block-align-right"},block:{name:"block",title:"Centered image",icon:fb,modelElements:["imageBlock"],isDefault:!0},side:{name:"side",title:"Side image",icon:pb,modelElements:["imageBlock"],className:"image-style-side"}},vb={full:ub,left:wb,right:bb,center:fb,inlineLeft:gb,inlineRight:pb,inline:mb},yb=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function Cb(e){const t=e.configuredStyles.options||[],i=t.map((e=>Vb(e))).filter((t=>Eb(t,e)));return i}function kb(e,t){return e&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:e?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{}}function xb(e){return e.has("ImageBlockEditing")&&e.has("ImageInlineEditing")?[...yb]:[]}function Vb(e){return e="string"===typeof e?_b[e]?{..._b[e]}:{name:e}:Ab(_b[e.name],e),"string"===typeof e.icon&&(e.icon=vb[e.icon]||e.icon),e}function Eb(e,{isBlockPluginLoaded:t,isInlinePluginLoaded:i}){const{modelElements:o,name:n}=e;if(!(o&&o.length&&n))return Pb({style:e}),!1;{const n=[t?"imageBlock":null,i?"imageInline":null];if(!o.some((e=>n.includes(e))))return(0,S.KE)("image-style-missing-dependency",{style:e,missingPlugins:o.map((e=>"imageBlock"===e?"ImageBlockEditing":"ImageInlineEditing"))}),!1}return!0}function Ab(e,t){const i={...t};for(const o in e)Object.prototype.hasOwnProperty.call(t,o)||(i[o]=e[o]);return i}function Pb(e){(0,S.KE)("image-style-configuration-definition-invalid",e)}var Sb={normalizeStyles:Cb,getDefaultStylesConfiguration:kb,getDefaultDropdownDefinitions:xb,warnInvalidStyle:Pb,DEFAULT_OPTIONS:_b,DEFAULT_ICONS:vb,DEFAULT_DROPDOWN_DEFINITIONS:yb};
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Tb(e){return(t,i,o)=>{if(!o.consumable.consume(i.item,t.name))return;const n=Ib(i.attributeNewValue,e),s=Ib(i.attributeOldValue,e),r=o.mapper.toViewElement(i.item),a=o.writer;s&&a.removeClass(s.className,r),n&&a.addClass(n.className,r)}}function Nb(e){const t={imageInline:e.filter((e=>!e.isDefault&&e.modelElements.includes("imageInline"))),imageBlock:e.filter((e=>!e.isDefault&&e.modelElements.includes("imageBlock")))};return(e,i,o)=>{if(!i.modelRange)return;const n=i.viewItem,s=(0,Xi.Z)(i.modelRange.getItems());if(s&&o.schema.checkAttribute(s,"imageStyle"))for(const r of t[s.name])o.consumable.consume(n,{classes:r.className})&&o.writer.setAttribute("imageStyle",r.name,s)}}function Ib(e,t){for(const i of t)if(i.name===e)return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Db extends a.Z{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[xw]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:t}=Sb,i=this.editor,o=i.plugins.has("ImageBlockEditing"),n=i.plugins.has("ImageInlineEditing");i.config.define("image.styles",t(o,n)),this.normalizedStyles=e({configuredStyles:i.config.get("image.styles"),isBlockPluginLoaded:o,isInlinePluginLoaded:n}),this._setupConversion(o,n),this._setupPostFixer(),i.commands.add("imageStyle",new hb(i,this.normalizedStyles))}_setupConversion(e,t){const i=this.editor,o=i.model.schema,n=Tb(this.normalizedStyles),s=Nb(this.normalizedStyles);i.editing.downcastDispatcher.on("attribute:imageStyle",n),i.data.downcastDispatcher.on("attribute:imageStyle",n),e&&(o.extend("imageBlock",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:figure",s,{priority:"low"})),t&&(o.extend("imageInline",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:img",s,{priority:"low"}))}_setupPostFixer(){const e=this.editor,t=e.model.document,i=e.plugins.get(xw),o=new Map(this.normalizedStyles.map((e=>[e.name,e])));t.registerPostFixer((e=>{let n=!1;for(const s of t.differ.getChanges())if("insert"==s.type||"attribute"==s.type&&"imageStyle"==s.attributeKey){let t="insert"==s.type?s.position.nodeAfter:s.range.start.nodeAfter;if(t&&t.is("element","paragraph")&&t.childCount>0&&(t=t.getChild(0)),!i.isImage(t))continue;const r=t.getAttribute("imageStyle");if(!r)continue;const a=o.get(r);a&&a.modelElements.includes(t.name)||(e.removeAttribute("imageStyle",t),n=!0)}return n}))}}var Rb=i(69203);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Bb extends a.Z{static get requires(){return[Db]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")}}init(){const e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],i=Mb(e.get("ImageStyleEditing").normalizedStyles,this.localizedDefaultStylesTitles);for(const n of i)this._createButton(n);const o=Mb([...t.filter(le.Z),...Sb.getDefaultDropdownDefinitions(e)],this.localizedDefaultStylesTitles);for(const n of o)this._createDropdown(n,i)}_createDropdown(e,t){const i=this.editor.ui.componentFactory;i.add(e.name,(o=>{let n;const{defaultItem:s,items:r,title:a}=e,l=r.filter((e=>t.find((({name:t})=>Ob(t)===e)))).map((e=>{const t=i.create(e);return e===s&&(n=t),t}));r.length!==l.length&&Sb.warnInvalidStyle({dropdown:e});const c=_c(o,Ql),d=c.buttonView;return vc(c,l),d.set({label:Lb(a,n.label),class:null,tooltip:!0}),d.bind("icon").toMany(l,"isOn",((...e)=>{const t=e.findIndex(Rb.Z);return t<0?n.icon:l[t].icon})),d.bind("label").toMany(l,"isOn",((...e)=>{const t=e.findIndex(Rb.Z);return Lb(a,t<0?n.label:l[t].label)})),d.bind("isOn").toMany(l,"isOn",((...e)=>e.some(Rb.Z))),d.bind("class").toMany(l,"isOn",((...e)=>e.some(Rb.Z)?"ck-splitbutton_flatten":null)),d.on("execute",(()=>{l.some((({isOn:e})=>e))?c.isOpen=!c.isOpen:n.fire("execute")})),c.bind("isEnabled").toMany(l,"isEnabled",((...e)=>e.some(Rb.Z))),c}))}_createButton(e){const t=e.name;this.editor.ui.componentFactory.add(Ob(t),(i=>{const o=this.editor.commands.get("imageStyle"),n=new l.Z(i);return n.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),n.bind("isEnabled").to(o,"isEnabled"),n.bind("isOn").to(o,"value",(e=>e===t)),n.on("execute",this._executeCommand.bind(this,t)),n}))}_executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus()}}function Mb(e,t){for(const i of e)t[i.title]&&(i.title=t[i.title]);return e}function Ob(e){return`imageStyle:${e}`}function Lb(e,t){return(e?e+": ":"")+t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $b extends a.Z{static get requires(){return[Db,Bb]}static get pluginName(){return"ImageStyle"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Fb extends a.Z{static get requires(){return[Jf,xw]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t,i=e.plugins.get(Jf),o=e.plugins.get("ImageUtils");i.register("image",{ariaLabel:t("Image toolbar"),items:zb(e.config.get("image.toolbar")||[]),getRelatedElement:e=>o.getClosestSelectedImageWidget(e)})}}function zb(e){return e.map((e=>(0,le.Z)(e)?e.name:e))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Zb(e){const t=e.map((e=>e.replace("+","\\+")));return new RegExp(`^image\\/(${t.join("|")})$`)}function Hb(e){return new Promise(((t,i)=>{const o=e.getAttribute("src");fetch(o).then((e=>e.blob())).then((e=>{const i=Wb(e,o),n=i.replace("image/",""),s=`image.${n}`,r=new File([e],s,{type:i});t(r)})).catch((e=>e&&"TypeError"===e.name?qb(o).then(t).catch(i):i(e)))}))}function Ub(e,t){return!(!e.isInlineImageView(t)||!t.getAttribute("src"))&&(t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||t.getAttribute("src").match(/^blob:/g))}function Wb(e,t){return e.type?e.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function qb(e){return Gb(e).then((t=>{const i=Wb(t,e),o=i.replace("image/",""),n=`image.${o}`;return new File([t],n,{type:i})}))}function Gb(e){return new Promise(((t,i)=>{const o=ri.document.createElement("img");o.addEventListener("load",(()=>{const e=ri.document.createElement("canvas");e.width=o.width,e.height=o.height;const n=e.getContext("2d");n.drawImage(o,0,0),e.toBlob((e=>e?t(e):i()))})),o.addEventListener("error",(()=>i())),o.src=e}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jb extends a.Z{static get pluginName(){return"ImageUploadUI"}init(){const e=this.editor,t=e.t,i=i=>{const o=new dl(i),n=e.commands.get("uploadImage"),s=e.config.get("image.upload.types"),r=Zb(s);return o.set({acceptedType:s.map((e=>`image/${e}`)).join(","),allowMultipleFiles:!0}),o.buttonView.set({label:t("Insert image"),icon:sl.image,tooltip:!0}),o.buttonView.bind("isEnabled").to(n),o.on("done",((t,i)=>{const o=Array.from(i).filter((e=>r.test(e.type)));o.length&&e.execute("uploadImage",{file:o})})),o};e.ui.componentFactory.add("uploadImage",i),e.ui.componentFactory.add("imageUpload",i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kb extends a.Z{static get pluginName(){return"ImageUploadProgress"}constructor(e){super(e),this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",((...e)=>this.uploadStatusChange(...e))),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",((...e)=>this.uploadStatusChange(...e)))}uploadStatusChange(e,t,i){const o=this.editor,n=t.item,s=n.getAttribute("uploadId");if(!i.consumable.consume(t.item,e.name))return;const r=o.plugins.get("ImageUtils"),a=o.plugins.get(al),l=s?t.attributeNewValue:null,c=this.placeholder,d=o.editing.mapper.toViewElement(n),h=i.writer;if("reading"==l)return Jb(d,h),void Qb(r,c,d,h);if("uploading"==l){const e=a.loaders.get(s);return Jb(d,h),void(e?(Xb(d,h),e_(d,h,e,o.editing.view),a_(r,d,h,e)):Qb(r,c,d,h))}"complete"==l&&a.loaders.get(s)&&i_(d,h,o.editing.view),t_(d,h),Xb(d,h),Yb(d,h)}}function Jb(e,t){e.hasClass("ck-appear")||t.addClass("ck-appear",e)}function Yb(e,t){t.removeClass("ck-appear",e)}function Qb(e,t,i,o){i.hasClass("ck-image-upload-placeholder")||o.addClass("ck-image-upload-placeholder",i);const n=e.findViewImgElement(i);n.getAttribute("src")!==t&&o.setAttribute("src",t,n),s_(i,"placeholder")||o.insert(o.createPositionAfter(n),n_(o))}function Xb(e,t){e.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",e),r_(e,t,"placeholder")}function e_(e,t,i,o){const n=o_(t);t.insert(t.createPositionAt(e,"end"),n),i.on("change:uploadedPercent",((e,t,i)=>{o.change((e=>{e.setStyle("width",i+"%",n)}))}))}function t_(e,t){r_(e,t,"progressBar")}function i_(e,t,i){const o=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(e,"end"),o),setTimeout((()=>{i.change((e=>e.remove(e.createRangeOn(o))))}),3e3)}function o_(e){const t=e.createUIElement("div",{class:"ck-progress-bar"});return e.setCustomProperty("progressBar",!0,t),t}function n_(e){const t=e.createUIElement("div",{class:"ck-upload-placeholder-loader"});return e.setCustomProperty("placeholder",!0,t),t}function s_(e,t){for(const i of e.getChildren())if(i.getCustomProperty(t))return i}function r_(e,t,i){const o=s_(e,i);o&&t.remove(t.createRangeOn(o))}function a_(e,t,i,o){if(o.data){const n=e.findViewImgElement(t);i.setAttribute("src",o.data,n)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class l_ extends b.Z{refresh(){const e=this.editor,t=e.plugins.get("ImageUtils"),i=e.model.document.selection.getSelectedElement();this.isEnabled=t.isImageAllowed()||t.isImage(i)}execute(e){const t=(0,D.Z)(e.file),i=this.editor.model.document.selection,o=this.editor.plugins.get("ImageUtils"),n=Object.fromEntries(i.getAttributes());t.forEach(((e,t)=>{const s=i.getSelectedElement();if(t&&s&&o.isImage(s)){const t=this.editor.model.createPositionAfter(s);this._uploadImage(e,n,t)}else this._uploadImage(e,n)}))}_uploadImage(e,t,i){const o=this.editor,n=o.plugins.get(al),s=n.createLoader(e),r=o.plugins.get("ImageUtils");s&&r.insertImage({...t,uploadId:s.id},i)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class c_ extends a.Z{static get requires(){return[al,Oc,ag,xw]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const e=this.editor,t=e.model.document,i=e.conversion,o=e.plugins.get(al),n=e.plugins.get("ImageUtils"),s=Zb(e.config.get("image.upload.types")),r=new l_(e);e.commands.add("uploadImage",r),e.commands.add("imageUpload",r),i.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",((t,i)=>{if(d_(i.dataTransfer))return;const o=Array.from(i.dataTransfer.files).filter((e=>!!e&&s.test(e.type)));o.length&&(t.stop(),e.model.change((t=>{i.targetRanges&&t.setSelection(i.targetRanges.map((t=>e.editing.mapper.toModelRange(t)))),e.model.enqueueChange("default",(()=>{e.execute("uploadImage",{file:o})}))})))})),this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",((t,i)=>{const s=Array.from(e.editing.view.createRangeIn(i.content)).filter((e=>Ub(n,e.item)&&!e.item.getAttribute("uploadProcessed"))).map((e=>({promise:Hb(e.item),imageElement:e.item})));if(!s.length)return;const r=new _h(e.editing.view.document);for(const e of s){r.setAttribute("uploadProcessed",!0,e.imageElement);const t=o.createLoader(e.promise);t&&(r.setAttribute("src","",e.imageElement),r.setAttribute("uploadId",t.id,e.imageElement))}})),e.editing.view.document.on("dragover",((e,t)=>{t.preventDefault()})),t.on("change",(()=>{const i=t.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),n=new Set;for(const t of i)if("insert"==t.type&&"$text"!=t.name){const i=t.position.nodeAfter,s="$graveyard"==t.position.root.rootName;for(const t of h_(e,i)){const e=t.getAttribute("uploadId");if(!e)continue;const i=o.loaders.get(e);i&&(s?n.has(e)||i.abort():(n.add(e),this._uploadImageElements.set(e,t),"idle"==i.status&&this._readAndUpload(i)))}}})),this.on("uploadComplete",((e,{imageElement:t,data:i})=>{const o=i.urls?i.urls:i;this.editor.model.change((e=>{e.setAttribute("src",o.default,t),this._parseAndSetSrcsetAttributeOnImage(o,t,e)}))}),{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(e){const t=this.editor,i=t.model,o=t.locale.t,n=t.plugins.get(al),s=t.plugins.get(Oc),r=t.plugins.get("ImageUtils"),a=this._uploadImageElements;return i.enqueueChange("transparent",(t=>{t.setAttribute("uploadStatus","reading",a.get(e.id))})),e.read().then((()=>{const o=e.upload(),n=a.get(e.id);if(Yt.ZP.isSafari){const e=t.editing.mapper.toViewElement(n),i=r.findViewImgElement(e);t.editing.view.once("render",(()=>{if(!i.parent)return;const e=t.editing.view.domConverter.mapViewToDom(i.parent);if(!e)return;const o=e.style.display;e.style.display="none",e._ckHack=e.offsetHeight,e.style.display=o}))}return i.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","uploading",n)})),o})).then((t=>{i.enqueueChange("transparent",(i=>{const o=a.get(e.id);i.setAttribute("uploadStatus","complete",o),this.fire("uploadComplete",{data:t,imageElement:o})})),l()})).catch((t=>{if("error"!==e.status&&"aborted"!==e.status)throw t;"error"==e.status&&t&&s.showWarning(t,{title:o("Upload failed"),namespace:"upload"}),i.enqueueChange("transparent",(t=>{t.remove(a.get(e.id))})),l()}));function l(){i.enqueueChange("transparent",(t=>{const i=a.get(e.id);t.removeAttribute("uploadId",i),t.removeAttribute("uploadStatus",i),a.delete(e.id)})),n.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,i){let o=0;const n=Object.keys(e).filter((e=>{const t=parseInt(e,10);if(!isNaN(t))return o=Math.max(o,t),!0})).map((t=>`${e[t]} ${t}w`)).join(", ");""!=n&&i.setAttribute("srcset",{data:n,width:o},t)}}function d_(e){return Array.from(e.types).includes("text/html")&&""!==e.getData("text/html")}function h_(e,t){const i=e.plugins.get("ImageUtils");return Array.from(e.model.createRangeOn(t)).filter((e=>i.isImage(e.item))).map((e=>e.item))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class u_ extends a.Z{static get pluginName(){return"ImageUpload"}static get requires(){return[c_,jb,Kb]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class m_ extends a.Z{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new _(e)),e.commands.add("outdent",new _(e))}}var g_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',p_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class f_ extends a.Z{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,i=e.t,o="ltr"==t.uiLanguageDirection?g_:p_,n="ltr"==t.uiLanguageDirection?p_:g_;this._defineButton("indent",i("Increase indent"),o),this._defineButton("outdent",i("Decrease indent"),n)}_defineButton(e,t,i){const o=this.editor;o.ui.componentFactory.add(e,(n=>{const s=o.commands.get(e),r=new l.Z(n);return r.set({label:t,icon:i,tooltip:!0}),r.bind("isOn","isEnabled").to(s,"value","isEnabled"),this.listenTo(r,"execute",(()=>{o.execute(e),o.editing.view.focus()})),r}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class w_ extends a.Z{static get pluginName(){return"Indent"}static get requires(){return[m_,f_]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
class b_{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach((e=>this._definitions.add(e))):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",((e,t,i)=>{if(!i.consumable.test(t.item,"attribute:linkHref"))return;const o=i.writer,n=o.document.selection;for(const s of this._definitions){const e=o.createAttributeElement("a",s.attributes,{priority:5});s.classes&&o.addClass(s.classes,e);for(const t in s.styles)o.setStyle(t,s.styles[t],e);o.setCustomProperty("link",!0,e),s.callback(t.attributeNewValue)?t.item.is("selection")?o.wrap(n.getFirstRange(),e):o.wrap(i.mapper.toViewRange(t.range),e):o.unwrap(i.mapper.toViewRange(t.range),e)}}),{priority:"high"})}}getDispatcherForLinkedImage(){return e=>{e.on("attribute:linkHref:imageBlock",((e,t,{writer:i,mapper:o})=>{const n=o.toViewElement(t.item),s=Array.from(n.getChildren()).find((e=>"a"===e.name));for(const r of this._definitions){const e=Y(r.attributes);if(r.callback(t.attributeNewValue)){for(const[t,o]of e)"class"===t?i.addClass(o,s):i.setAttribute(t,o,s);r.classes&&i.addClass(r.classes,s);for(const e in r.styles)i.setStyle(e,r.styles[e],s)}else{for(const[t,o]of e)"class"===t?i.removeClass(o,s):i.removeAttribute(t,s);r.classes&&i.removeClass(r.classes,s);for(const e in r.styles)i.removeStyle(e,s)}}}))}}}function __(e,t,i){var o=e.length;return i=void 0===i?o:i,!t&&i>=o?e:ge(e,t,i)}var v_=__,y_="\\ud800-\\udfff",C_="\\u0300-\\u036f",k_="\\ufe20-\\ufe2f",x_="\\u20d0-\\u20ff",V_=C_+k_+x_,E_="\\ufe0e\\ufe0f",A_="\\u200d",P_=RegExp("["+A_+y_+V_+E_+"]");function S_(e){return P_.test(e)}var T_=S_;function N_(e){return e.split("")}var I_=N_,D_="\\ud800-\\udfff",R_="\\u0300-\\u036f",B_="\\ufe20-\\ufe2f",M_="\\u20d0-\\u20ff",O_=R_+B_+M_,L_="\\ufe0e\\ufe0f",$_="["+D_+"]",F_="["+O_+"]",z_="\\ud83c[\\udffb-\\udfff]",Z_="(?:"+F_+"|"+z_+")",H_="[^"+D_+"]",U_="(?:\\ud83c[\\udde6-\\uddff]){2}",W_="[\\ud800-\\udbff][\\udc00-\\udfff]",q_="\\u200d",G_=Z_+"?",j_="["+L_+"]?",K_="(?:"+q_+"(?:"+[H_,U_,W_].join("|")+")"+j_+G_+")*",J_=j_+G_+K_,Y_="(?:"+[H_+F_+"?",F_,U_,W_,$_].join("|")+")",Q_=RegExp(z_+"(?="+z_+")|"+Y_+J_,"g");function X_(e){return e.match(Q_)||[]}var ev=X_;function tv(e){return T_(e)?ev(e):I_(e)}var iv=tv;function ov(e){return function(t){t=(0,Id.Z)(t);var i=T_(t)?iv(t):void 0,o=i?i[0]:t.charAt(0),n=i?v_(i,1).join(""):t.slice(1);return o[e]()+n}}var nv=ov,sv=nv("toUpperCase"),rv=sv;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const av=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,lv=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,cv=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,dv=/^((\w+:(\/{2,})?)|(\W))/i,hv="Ctrl+K";function uv(e){return e.is("attributeElement")&&!!e.getCustomProperty("link")}function mv(e,{writer:t}){const i=t.createAttributeElement("a",{href:e},{priority:5});return t.setCustomProperty("link",!0,i),i}function gv(e){return e=String(e),pv(e)?e:"#"}function pv(e){const t=e.replace(av,"");return t.match(lv)}function fv(e,t){const i={"Open in a new tab":e("Open in a new tab"),Downloadable:e("Downloadable")};return t.forEach((e=>(e.label&&i[e.label]&&(e.label=i[e.label]),e))),t}function wv(e){const t=[];if(e)for(const[i,o]of Object.entries(e)){const e=Object.assign({},o,{id:`link${rv(i)}`});t.push(e)}return t}function bv(e,t){return!!e&&t.checkAttribute(e.name,"linkHref")}function _v(e){return cv.test(e)}function vv(e,t){const i=_v(e)?"mailto:":t,o=!!i&&!dv.test(e);return e&&o?i+e:e}function yv(e){window.open(e,"_blank","noopener")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Cv extends b.Z{constructor(e){super(e),this.manualDecorators=new P.Z,this.automaticDecorators=new b_}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement()||(0,Xi.Z)(t.getSelectedBlocks());bv(i,e.schema)?(this.value=i.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(i,"linkHref")):(this.value=t.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref"));for(const o of this.manualDecorators)o.value=this._getDecoratorStateFromModel(o.id)}execute(e,t={}){const i=this.editor.model,o=i.document.selection,n=[],s=[];for(const r in t)t[r]?n.push(r):s.push(r);i.change((t=>{if(o.isCollapsed){const r=o.getFirstPosition();if(o.hasAttribute("linkHref")){const a=Gd(r,"linkHref",o.getAttribute("linkHref"),i);t.setAttribute("linkHref",e,a),n.forEach((e=>{t.setAttribute(e,!0,a)})),s.forEach((e=>{t.removeAttribute(e,a)})),t.setSelection(t.createPositionAfter(a.end.nodeBefore))}else if(""!==e){const s=Y(o.getAttributes());s.set("linkHref",e),n.forEach((e=>{s.set(e,!0)}));const{end:a}=i.insertContent(t.createText(e,s),r);t.setSelection(a)}["linkHref",...n,...s].forEach((e=>{t.removeSelectionAttribute(e)}))}else{const r=i.schema.getValidRanges(o.getRanges(),"linkHref"),a=[];for(const e of o.getSelectedBlocks())i.schema.checkAttribute(e,"linkHref")&&a.push(t.createRangeOn(e));const l=a.slice();for(const e of r)this._isRangeToUpdate(e,a)&&l.push(e);for(const i of l)t.setAttribute("linkHref",e,i),n.forEach((e=>{t.setAttribute(e,!0,i)})),s.forEach((e=>{t.removeAttribute(e,i)}))}}))}_getDecoratorStateFromModel(e){const t=this.editor.model,i=t.document.selection,o=i.getSelectedElement();return bv(o,t.schema)?o.getAttribute(e):i.getAttribute(e)}_isRangeToUpdate(e,t){for(const i of t)if(i.containsRange(e))return!1;return!0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kv extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=t.getSelectedElement();bv(i,e.schema)?this.isEnabled=e.schema.checkAttribute(i,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref")}execute(){const e=this.editor,t=this.editor.model,i=t.document.selection,o=e.commands.get("link");t.change((e=>{const n=i.isCollapsed?[Gd(i.getFirstPosition(),"linkHref",i.getAttribute("linkHref"),t)]:t.schema.getValidRanges(i.getRanges(),"linkHref");for(const t of n)if(e.removeAttribute("linkHref",t),o)for(const i of o.manualDecorators)e.removeAttribute(i.id,t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xv{constructor({id:e,label:t,attributes:i,classes:o,styles:n,defaultValue:s}){this.id=e,this.set("value"),this.defaultValue=s,this.label=t,this.attributes=i,this.classes=o,this.styles=n}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}(0,N.Z)(xv,Z.Z);
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Vv="ck-link_selected",Ev="automatic",Av="manual",Pv=/^(https?:)?\/\//;class Sv extends a.Z{static get pluginName(){return"LinkEditing"}static get requires(){return[Ed,_d,ag]}constructor(e){super(e),e.config.define("link",{addTargetToExternalLinks:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:mv}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(e,t)=>mv(gv(e),t)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:e=>e.getAttribute("href")}}),e.commands.add("link",new Cv(e)),e.commands.add("unlink",new kv(e));const t=fv(e.t,wv(e.config.get("link.decorators")));this._enableAutomaticDecorators(t.filter((e=>e.mode===Ev))),this._enableManualDecorators(t.filter((e=>e.mode===Av)));const i=e.plugins.get(Ed);i.registerAttribute("linkHref"),Kd(e,"linkHref","a",Vv),this._enableLinkOpen(),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterLink(),this._enableTypingOverLink(),this._handleDeleteContentAfterLink()}_enableAutomaticDecorators(e){const t=this.editor,i=t.commands.get("link"),o=i.automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&o.add({id:"linkIsExternal",mode:Ev,callback:e=>Pv.test(e),attributes:{target:"_blank",rel:"noopener noreferrer"}}),o.add(e),o.length&&t.conversion.for("downcast").add(o.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,i=t.commands.get("link"),o=i.manualDecorators;e.forEach((e=>{t.model.schema.extend("$text",{allowAttributes:e.id}),e=new xv(e),o.add(e),t.conversion.for("downcast").attributeToElement({model:e.id,view:(t,{writer:i})=>{if(t){const t=i.createAttributeElement("a",e.attributes,{priority:5});e.classes&&i.addClass(e.classes,t);for(const o in e.styles)i.setStyle(o,e.styles[o],t);return i.setCustomProperty("link",!0,t),t}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",...e._createPattern()},model:{key:e.id}})}))}_enableLinkOpen(){const e=this.editor,t=e.editing.view,i=t.document,o=e.model.document;this.listenTo(i,"click",((e,t)=>{const i=Yt.ZP.isMac?t.domEvent.metaKey:t.domEvent.ctrlKey;if(!i)return;let o=t.domTarget;if("a"!=o.tagName.toLowerCase()&&(o=o.closest("a")),!o)return;const n=o.getAttribute("href");n&&(e.stop(),t.preventDefault(),yv(n))}),{context:"$capture"}),this.listenTo(i,"enter",((e,t)=>{const i=o.selection,n=i.getSelectedElement(),s=n?n.getAttribute("linkHref"):i.getAttribute("linkHref"),r=s&&t.domEvent.altKey;r&&(e.stop(),yv(s))}),{context:"a"})}_enableInsertContentSelectionAttributesFixer(){const e=this.editor,t=e.model,i=t.document.selection;this.listenTo(t,"insertContent",(()=>{const e=i.anchor.nodeBefore,o=i.anchor.nodeAfter;i.hasAttribute("linkHref")&&e&&e.hasAttribute("linkHref")&&(o&&o.hasAttribute("linkHref")||t.change((e=>{Tv(e,Dv(t.schema))})))}),{priority:"low"})}_enableClickingAfterLink(){const e=this.editor,t=e.model;e.editing.view.addObserver(bh);let i=!1;this.listenTo(e.editing.view.document,"mousedown",(()=>{i=!0})),this.listenTo(e.editing.view.document,"selectionChange",(()=>{if(!i)return;i=!1;const e=t.document.selection;if(!e.isCollapsed)return;if(!e.hasAttribute("linkHref"))return;const o=e.getFirstPosition(),n=Gd(o,"linkHref",e.getAttribute("linkHref"),t);(o.isTouching(n.start)||o.isTouching(n.end))&&t.change((e=>{Tv(e,Dv(t.schema))}))}))}_enableTypingOverLink(){const e=this.editor,t=e.editing.view;let i,o;this.listenTo(t.document,"delete",(()=>{o=!0}),{priority:"high"}),this.listenTo(e.model,"deleteContent",(()=>{const t=e.model.document.selection;t.isCollapsed||(o?o=!1:Iv(e)&&Nv(e.model)&&(i=t.getAttributes()))}),{priority:"high"}),this.listenTo(e.model,"insertContent",((t,[n])=>{o=!1,Iv(e)&&i&&(e.model.change((e=>{for(const[t,o]of i)e.setAttribute(t,o,n)})),i=null)}),{priority:"high"})}_handleDeleteContentAfterLink(){const e=this.editor,t=e.model,i=t.document.selection,o=e.editing.view;let n=!1,s=!1;this.listenTo(o.document,"delete",((e,t)=>{s=t.domEvent.keyCode===ct.Do.backspace}),{priority:"high"}),this.listenTo(t,"deleteContent",(()=>{n=!1;const e=i.getFirstPosition(),o=i.getAttribute("linkHref");if(!o)return;const s=Gd(e,"linkHref",o,t);n=s.containsPosition(e)||s.end.isEqual(e)}),{priority:"high"}),this.listenTo(t,"deleteContent",(()=>{s&&(s=!1,n||e.model.enqueueChange((e=>{Tv(e,Dv(t.schema))})))}),{priority:"low"})}}function Tv(e,t){e.removeSelectionAttribute("linkHref");for(const i of t)e.removeSelectionAttribute(i)}function Nv(e){const t=e.document.selection,i=t.getFirstPosition(),o=t.getLastPosition(),n=i.nodeAfter;if(!n)return!1;if(!n.is("$text"))return!1;if(!n.hasAttribute("linkHref"))return!1;const s=o.textNode||o.nodeBefore;if(n===s)return!0;const r=Gd(i,"linkHref",n.getAttribute("linkHref"),e);return r.containsRange(e.createRange(i,o),!0)}function Iv(e){const t=e.plugins.get("Input");return t.isInput(e.model.change((e=>e.batch)))}function Dv(e){const t=e.getDefinition("$text").allowAttributes;return t.filter((e=>e.startsWith("link")))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Rv extends cl.Z{constructor(e,t){super(e);const i=e.t;this.focusTracker=new eo,this.keystrokes=new to,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),sl.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(i("Cancel"),sl.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t.manualDecorators),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const o=["ck","ck-link-form","ck-responsive-form"];t.manualDecorators.length&&o.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:o,tabindex:"-1"},children:this.children}),Bl(this)}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce(((e,t)=>(e[t.name]=t.isOn,e)),{})}render(){super.render(),Ml({view:this});const e=[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,t=new Rc(this.locale,Bc);return t.label=e("Link URL"),t}_createButton(e,t,i,o){const n=new l.Z(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.extendTemplate({attributes:{class:i}}),o&&n.delegate("execute").to(this,o),n}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const i of e.manualDecorators){const o=new Fl(this.locale);o.set({name:i.id,label:i.label,withText:!0}),o.bind("isOn").toMany([i,e],"value",((e,t)=>void 0===t&&void 0===e?i.defaultValue:e)),o.on("execute",(()=>{i.set("value",!o.isOn)})),t.add(o)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const e=new cl.Z;e.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map((e=>({tag:"li",children:[e],attributes:{class:["ck","ck-list__item"]}}))),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(e)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}}var Bv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Mv extends cl.Z{constructor(e){super(e);const t=e.t;this.focusTracker=new eo,this.keystrokes=new to,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(t("Unlink"),Bv,"unlink"),this.editButtonView=this._createButton(t("Edit link"),sl.pencil,"edit"),this.set("href"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render();const e=[this.previewButtonView,this.editButtonView,this.unlinkButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(e,t,i){const o=new l.Z(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.delegate("execute").to(this,i),o}_createPreviewButton(){const e=new l.Z(this.locale),t=this.bindTemplate,i=this.t;return e.set({withText:!0,tooltip:i("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:t.to("href",(e=>e&&gv(e))),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",(e=>e||i("This link has no URL"))),e.bind("isEnabled").to(this,"href",(e=>!!e)),e.template.tag="a",e.template.eventListeners={},e}}var Ov='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Lv="link-ui";class $v extends a.Z{static get requires(){return[jc]}static get pluginName(){return"LinkUI"}init(){const e=this.editor;e.editing.view.addObserver(wh),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get(jc),this._createToolbarLinkButton(),this._enableUserBalloonInteractions(),e.conversion.for("editingDowncast").markerToHighlight({model:Lv,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:Lv,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,t=new Mv(e.locale),i=e.commands.get("link"),o=e.commands.get("unlink");return t.bind("href").to(i,"value"),t.editButtonView.bind("isEnabled").to(i),t.unlinkButtonView.bind("isEnabled").to(o),this.listenTo(t,"edit",(()=>{this._addFormView()})),this.listenTo(t,"unlink",(()=>{e.execute("unlink"),this._hideUI()})),t.keystrokes.set("Esc",((e,t)=>{this._hideUI(),t()})),t.keystrokes.set(hv,((e,t)=>{this._addFormView(),t()})),t}_createFormView(){const e=this.editor,t=e.commands.get("link"),i=e.config.get("link.defaultProtocol"),o=new Rv(e.locale,t);return o.urlInputView.fieldView.bind("value").to(t,"value"),o.urlInputView.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),o.saveButtonView.bind("isEnabled").to(t),this.listenTo(o,"submit",(()=>{const{value:t}=o.urlInputView.fieldView.element,n=vv(t,i);e.execute("link",n,o.getDecoratorSwitchesState()),this._closeFormView()})),this.listenTo(o,"cancel",(()=>{this._closeFormView()})),o.keystrokes.set("Esc",((e,t)=>{this._closeFormView(),t()})),o}_createToolbarLinkButton(){const e=this.editor,t=e.commands.get("link"),i=e.t;e.keystrokes.set(hv,((e,i)=>{i(),t.isEnabled&&this._showUI(!0)})),e.ui.componentFactory.add("link",(e=>{const o=new l.Z(e);return o.isEnabled=!0,o.label=i("Link"),o.icon=Ov,o.keystroke=hv,o.tooltip=!0,o.isToggleable=!0,o.bind("isEnabled").to(t,"isEnabled"),o.bind("isOn").to(t,"value",(e=>!!e)),this.listenTo(o,"execute",(()=>this._showUI(!0))),o}))}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",(()=>{const e=this._getSelectedLinkElement();e&&this._showUI()})),this.editor.keystrokes.set("Tab",((e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())}),{priority:"high"}),this.editor.keystrokes.set("Esc",((e,t)=>{this._isUIVisible&&(this._hideUI(),t())})),Rl({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const e=this.editor,t=e.commands.get("link");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=t.value||""}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let i=this._getSelectedLinkElement(),o=s();const n=()=>{const e=this._getSelectedLinkElement(),t=s();i&&!e||!i&&t!==o?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),i=e,o=t};function s(){return t.selection.focus.getAncestors().reverse().find((e=>e.is("element")))}this.listenTo(e.ui,"update",n),this.listenTo(this._balloon,"change:visibleView",n)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){const e=this._balloon.visibleView;return e==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model,i=e.document;let o=null;if(t.markers.has(Lv)){const t=Array.from(this.editor.editing.mapper.markerNameToElements(Lv)),i=e.createRange(e.createPositionBefore(t[0]),e.createPositionAfter(t[t.length-1]));o=e.domConverter.viewRangeToDom(i)}else o=()=>{const t=this._getSelectedLinkElement();return t?e.domConverter.mapViewToDom(t):e.domConverter.viewRangeToDom(i.selection.getFirstRange())};return{target:o}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection,i=t.getSelectedElement();if(t.isCollapsed||i&&pg(i))return Fv(t.getFirstPosition());{const i=t.getFirstRange().getTrimmed(),o=Fv(i.start),n=Fv(i.end);return o&&o==n&&e.createRangeIn(o).getTrimmed().isEqual(i)?o:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change((t=>{const i=e.document.selection.getFirstRange();if(e.markers.has(Lv))t.updateMarker(Lv,{range:i});else if(i.start.isAtEnd){const o=i.start.getLastMatchingPosition((({item:t})=>!e.schema.isContent(t)),{boundaries:i});t.addMarker(Lv,{usingOperation:!1,affectsData:!1,range:t.createRange(o,i.end)})}else t.addMarker(Lv,{usingOperation:!1,affectsData:!1,range:i})}))}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(Lv)&&e.change((e=>{e.removeMarker(Lv)}))}}function Fv(e){return e.getAncestors().find((e=>uv(e)))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const zv=4,Zv=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),Hv=2;class Uv extends a.Z{static get requires(){return[Cd]}static get pluginName(){return"AutoLink"}init(){const e=this.editor,t=e.model.document.selection;t.on("change:range",(()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")})),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling()}_enableTypingHandling(){const e=this.editor,t=new Vd(e.model,(e=>{if(!Wv(e))return;const t=qv(e.substr(0,e.length-1));return t?{url:t}:void 0})),i=e.plugins.get("Input");t.on("matched:data",((t,o)=>{const{batch:n,range:s,url:r}=o;if(!i.isInput(n))return;const a=s.end.getShiftedBy(-1),l=a.getShiftedBy(-r.length),c=e.model.createRange(l,a);this._applyAutoLink(r,c)})),t.bind("isEnabled").to(this)}_enableEnterHandling(){const e=this.editor,t=e.model,i=e.commands.get("enter");i&&i.on("execute",(()=>{const e=t.document.selection.getFirstPosition();if(!e.parent.previousSibling)return;const i=t.createRangeIn(e.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(i)}))}_enableShiftEnterHandling(){const e=this.editor,t=e.model,i=e.commands.get("shiftEnter");i&&i.on("execute",(()=>{const e=t.document.selection.getFirstPosition(),i=t.createRange(t.createPositionAt(e.parent,0),e.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(i)}))}_checkAndApplyAutoLinkOnRange(e){const t=this.editor.model,{text:i,range:o}=xd(e,t),n=qv(i);if(n){const e=t.createRange(o.end.getShiftedBy(-n.length),o.end);this._applyAutoLink(n,e)}}_applyAutoLink(e,t){const i=this.editor.model,o=this.editor.plugins.get("Delete");this.isEnabled&&Gv(t,i)&&i.enqueueChange((n=>{const s=this.editor.config.get("link.defaultProtocol"),r=vv(e,s);n.setAttribute("linkHref",r,t),i.enqueueChange((()=>{o.requestUndoOnBackspace()}))}))}}function Wv(e){return e.length>zv&&" "===e[e.length-1]&&" "!==e[e.length-2]}function qv(e){const t=Zv.exec(e);return t?t[Hv]:null}function Gv(e,t){return t.schema.checkAttributeInSelection(t.createSelection(e),"linkHref")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jv extends a.Z{static get requires(){return[Sv,$v,Uv]}static get pluginName(){return"Link"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Kv extends b.Z{constructor(e,t){super(e),this.type=t}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.document,o=Array.from(i.selection.getSelectedBlocks()).filter((e=>Yv(e,t.schema))),n=void 0!==e.forceValue?!e.forceValue:this.value;t.change((e=>{if(n){let t=o[o.length-1].nextSibling,i=Number.POSITIVE_INFINITY,n=[];while(t&&"listItem"==t.name&&0!==t.getAttribute("listIndent")){const e=t.getAttribute("listIndent");e<i&&(i=e);const o=e-i;n.push({element:t,listIndent:o}),t=t.nextSibling}n=n.reverse();for(const o of n)e.setAttribute("listIndent",o.listIndent,o.element)}if(!n){let e=Number.POSITIVE_INFINITY;for(const t of o)t.is("element","listItem")&&t.getAttribute("listIndent")<e&&(e=t.getAttribute("listIndent"));e=0===e?1:e,Jv(o,!0,e),Jv(o,!1,e)}for(const t of o.reverse())n&&"listItem"==t.name?e.rename(t,"paragraph"):n||"listItem"==t.name?n||"listItem"!=t.name||t.getAttribute("listType")==this.type||e.setAttribute("listType",this.type,t):(e.setAttributes({listType:this.type,listIndent:0},t),e.rename(t,"listItem"));this.fire("_executeCleanup",o)}))}_getValue(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("element","listItem")&&e.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,i=(0,Xi.Z)(e.getSelectedBlocks());return!!i&&Yv(i,t)}}function Jv(e,t,i){const o=t?e[0]:e[e.length-1];if(o.is("element","listItem")){let n=o[t?"previousSibling":"nextSibling"],s=o.getAttribute("listIndent");while(n&&n.is("element","listItem")&&n.getAttribute("listIndent")>=i)s>n.getAttribute("listIndent")&&(s=n.getAttribute("listIndent")),n.getAttribute("listIndent")==s&&e[t?"unshift":"push"](n),n=n[t?"previousSibling":"nextSibling"]}}function Yv(e,t){return t.checkChild(e.parent,"listItem")&&!t.isObject(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qv extends b.Z{constructor(e,t){super(e),this._indentBy="forward"==t?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document;let i=Array.from(t.selection.getSelectedBlocks());e.change((e=>{const t=i[i.length-1];let o=t.nextSibling;while(o&&"listItem"==o.name&&o.getAttribute("listIndent")>t.getAttribute("listIndent"))i.push(o),o=o.nextSibling;this._indentBy<0&&(i=i.reverse());for(const n of i){const t=n.getAttribute("listIndent")+this._indentBy;t<0?e.rename(n,"paragraph"):e.setAttribute("listIndent",t,n)}this.fire("_executeCleanup",i)}))}_checkEnabled(){const e=(0,Xi.Z)(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("element","listItem"))return!1;if(this._indentBy>0){const t=e.getAttribute("listIndent"),i=e.getAttribute("listType");let o=e.previousSibling;while(o&&o.is("element","listItem")&&o.getAttribute("listIndent")>=t){if(o.getAttribute("listIndent")==t)return o.getAttribute("listType")==i;o=o.previousSibling}return!1}return!0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Xv(e){const t=e.createContainerElement("li");return t.getFillerOffset=ay,t}function ey(e,t){const i=t.mapper,o=t.writer,n="numbered"==e.getAttribute("listType")?"ol":"ul",s=Xv(o),r=o.createContainerElement(n,null);return o.insert(o.createPositionAt(r,0),s),i.bindElements(e,s),s}function ty(e,t,i,o){const n=t.parent,s=i.mapper,r=i.writer;let a=s.toViewPosition(o.createPositionBefore(e));const l=ny(e.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:e.getAttribute("listIndent")}),c=e.previousSibling;if(l&&l.getAttribute("listIndent")==e.getAttribute("listIndent")){const e=s.toViewElement(l);a=r.breakContainer(r.createPositionAfter(e))}else if(c&&"listItem"==c.name){a=s.toViewPosition(o.createPositionAt(c,"end"));const e=s.findMappedViewAncestor(a),t=ry(e);a=t?r.createPositionBefore(t):r.createPositionAt(e,"end")}else a=s.toViewPosition(o.createPositionBefore(e));if(a=oy(a),r.insert(a,n),c&&"listItem"==c.name){const e=s.toViewElement(c),i=r.createRange(r.createPositionAt(e,0),a),o=i.getWalker({ignoreElementEnd:!0});for(const n of o)if(n.item.is("element","li")){const e=r.breakContainer(r.createPositionBefore(n.item)),i=n.item.parent,s=r.createPositionAt(t,"end");iy(r,s.nodeBefore,s.nodeAfter),r.move(r.createRangeOn(i),s),o.position=e}}else{const i=n.nextSibling;if(i&&(i.is("element","ul")||i.is("element","ol"))){let o=null;for(const t of i.getChildren()){const i=s.toModelElement(t);if(!(i&&i.getAttribute("listIndent")>e.getAttribute("listIndent")))break;o=t}o&&(r.breakContainer(r.createPositionAfter(o)),r.move(r.createRangeOn(o.parent),r.createPositionAt(t,"end")))}}iy(r,n,n.nextSibling),iy(r,n.previousSibling,n)}function iy(e,t,i){return!t||!i||"ul"!=t.name&&"ol"!=t.name||t.name!=i.name||t.getAttribute("class")!==i.getAttribute("class")?null:e.mergeContainers(e.createPositionAfter(t))}function oy(e){return e.getLastMatchingPosition((e=>e.item.is("uiElement")))}function ny(e,t){const i=!!t.sameIndent,o=!!t.smallerIndent,n=t.listIndent;let s=e;while(s&&"listItem"==s.name){const e=s.getAttribute("listIndent");if(i&&n==e||o&&n>e)return s;s="forward"===t.direction?s.nextSibling:s.previousSibling}return null}function sy(e,t,i,o){e.ui.componentFactory.add(t,(n=>{const s=e.commands.get(t),r=new l.Z(n);return r.set({label:i,icon:o,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(s,"value","isEnabled"),r.on("execute",(()=>{e.execute(t),e.editing.view.focus()})),r}))}function ry(e){for(const t of e.getChildren())if("ul"==t.name||"ol"==t.name)return t;return null}function ay(){const e=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||e?0:Be.call(this)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ly(e){return(t,i,o)=>{const n=o.consumable;if(!n.test(i.item,"insert")||!n.test(i.item,"attribute:listType")||!n.test(i.item,"attribute:listIndent"))return;n.consume(i.item,"insert"),n.consume(i.item,"attribute:listType"),n.consume(i.item,"attribute:listIndent");const s=i.item,r=ey(s,o);ty(s,r,o,e)}}function cy(e){return(t,i,o)=>{const n=o.mapper.toViewPosition(i.position),s=n.getLastMatchingPosition((e=>!e.item.is("element","li"))),r=s.nodeAfter,a=o.writer;a.breakContainer(a.createPositionBefore(r)),a.breakContainer(a.createPositionAfter(r));const l=r.parent,c=l.previousSibling,d=a.createRangeOn(l),h=a.remove(d);c&&c.nextSibling&&iy(a,c,c.nextSibling);const u=o.mapper.toModelElement(r);xy(u.getAttribute("listIndent")+1,i.position,d.start,r,o,e);for(const e of a.createRangeIn(h).getItems())o.mapper.unbindViewElement(e);t.stop()}}function dy(e,t,i){if(!i.consumable.consume(t.item,"attribute:listType"))return;const o=i.mapper.toViewElement(t.item),n=i.writer;n.breakContainer(n.createPositionBefore(o)),n.breakContainer(n.createPositionAfter(o));const s=o.parent,r="numbered"==t.attributeNewValue?"ol":"ul";n.rename(r,s)}function hy(e,t,i){const o=i.mapper.toViewElement(t.item),n=o.parent,s=i.writer;iy(s,n,n.nextSibling),iy(s,n.previousSibling,n);for(const r of t.item.getChildren())i.consumable.consume(r,"insert")}function uy(e){return(t,i,o)=>{if(!o.consumable.consume(i.item,"attribute:listIndent"))return;const n=o.mapper.toViewElement(i.item),s=o.writer;s.breakContainer(s.createPositionBefore(n)),s.breakContainer(s.createPositionAfter(n));const r=n.parent,a=r.previousSibling,l=s.createRangeOn(r);s.remove(l),a&&a.nextSibling&&iy(s,a,a.nextSibling),xy(i.attributeOldValue+1,i.range.start,l.start,n,o,e),ty(i.item,n,o,e);for(const e of i.item.getChildren())o.consumable.consume(e,"insert")}}function my(e,t,i){if("listItem"!=t.item.name){let e=i.mapper.toViewPosition(t.range.start);const o=i.writer,n=[];while("ul"==e.parent.name||"ol"==e.parent.name){if(e=o.breakContainer(e),"li"!=e.parent.name)break;const t=e,i=o.createPositionAt(e.parent,"end");if(!t.isEqual(i)){const e=o.remove(o.createRange(t,i));n.push(e)}e=o.createPositionAfter(e.parent)}if(n.length>0){for(let t=0;t<n.length;t++){const i=e.nodeBefore,s=o.insert(e,n[t]);if(e=s.end,t>0){const t=iy(o,i,i.nextSibling);t&&t.parent==i&&e.offset--}}iy(o,e.nodeBefore,e.nodeAfter)}}}function gy(e,t,i){const o=i.mapper.toViewPosition(t.position),n=o.nodeBefore,s=o.nodeAfter;iy(i.writer,n,s)}function py(e,t,i){if(i.consumable.consume(t.viewItem,{name:!0})){const e=i.writer,o=e.createElement("listItem"),n=Ey(t.viewItem);e.setAttribute("listIndent",n,o);const s=t.viewItem.parent&&"ol"==t.viewItem.parent.name?"numbered":"bulleted";if(e.setAttribute("listType",s,o),!i.safeInsert(o,t.modelCursor))return;const r=Cy(o,t.viewItem.getChildren(),i);t.modelRange=e.createRange(t.modelCursor,r),i.updateConversionResult(o,t)}}function fy(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){const e=Array.from(t.viewItem.getChildren());for(const t of e){const e=!(t.is("element","li")||Vy(t));e&&t._remove()}}}function wy(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){if(0===t.viewItem.childCount)return;const e=[...t.viewItem.getChildren()];let i=!1;for(const t of e)i&&!Vy(t)&&t._remove(),Vy(t)&&(i=!0)}}function by(e){return(t,i)=>{if(i.isPhantom)return;const o=i.modelPosition.nodeBefore;if(o&&o.is("element","listItem")){const t=i.mapper.toViewElement(o),n=t.getAncestors().find(Vy),s=e.createPositionAt(t,0).getWalker();for(const e of s){if("elementStart"==e.type&&e.item.is("element","li")){i.viewPosition=e.previousPosition;break}if("elementEnd"==e.type&&e.item==n){i.viewPosition=e.nextPosition;break}}}}}function _y(e){return(t,i)=>{const o=i.viewPosition,n=o.parent,s=i.mapper;if("ul"==n.name||"ol"==n.name){if(o.isAtEnd){const t=s.toModelElement(o.nodeBefore),n=s.getModelLength(o.nodeBefore);i.modelPosition=e.createPositionBefore(t).getShiftedBy(n)}else{const t=s.toModelElement(o.nodeAfter);i.modelPosition=e.createPositionBefore(t)}t.stop()}else if("li"==n.name&&o.nodeBefore&&("ul"==o.nodeBefore.name||"ol"==o.nodeBefore.name)){const r=s.toModelElement(n);let a=1,l=o.nodeBefore;while(l&&Vy(l))a+=s.getModelLength(l),l=l.previousSibling;i.modelPosition=e.createPositionBefore(r).getShiftedBy(a),t.stop()}}}function vy(e,t){const i=e.document.differ.getChanges(),o=new Map;let n=!1;for(const l of i)if("insert"==l.type&&"listItem"==l.name)s(l.position);else if("insert"==l.type&&"listItem"!=l.name){if("$text"!=l.name){const i=l.position.nodeAfter;i.hasAttribute("listIndent")&&(t.removeAttribute("listIndent",i),n=!0),i.hasAttribute("listType")&&(t.removeAttribute("listType",i),n=!0),i.hasAttribute("listStyle")&&(t.removeAttribute("listStyle",i),n=!0);for(const t of Array.from(e.createRangeIn(i)).filter((e=>e.item.is("element","listItem"))))s(t.previousPosition)}const i=l.position.getShiftedBy(l.length);s(i)}else"remove"==l.type&&"listItem"==l.name?s(l.position):("attribute"==l.type&&"listIndent"==l.attributeKey||"attribute"==l.type&&"listType"==l.attributeKey)&&s(l.range.start);for(const l of o.values())r(l),a(l);return n;function s(e){const t=e.nodeBefore;if(t&&t.is("element","listItem")){let e=t;if(o.has(e))return;for(let t=e.previousSibling;t&&t.is("element","listItem");t=e.previousSibling)if(e=t,o.has(e))return;o.set(t,e)}else{const t=e.nodeAfter;t&&t.is("element","listItem")&&o.set(t,t)}}function r(e){let i=0,o=null;while(e&&e.is("element","listItem")){const s=e.getAttribute("listIndent");if(s>i){let r;null===o?(o=s-i,r=i):(o>s&&(o=s),r=s-o),t.setAttribute("listIndent",r,e),n=!0}else o=null,i=e.getAttribute("listIndent")+1;e=e.nextSibling}}function a(e){let i=[],o=null;while(e&&e.is("element","listItem")){const s=e.getAttribute("listIndent");if(o&&o.getAttribute("listIndent")>s&&(i=i.slice(0,s+1)),0!=s)if(i[s]){const o=i[s];e.getAttribute("listType")!=o&&(t.setAttribute("listType",o,e),n=!0)}else i[s]=e.getAttribute("listType");o=e,e=e.nextSibling}}}function yy(e,[t,i]){let o,n=t.is("documentFragment")?t.getChild(0):t;if(o=i?this.createSelection(i):this.document.selection,n&&n.is("element","listItem")){const e=o.getFirstPosition();let t=null;if(e.parent.is("element","listItem")?t=e.parent:e.nodeBefore&&e.nodeBefore.is("element","listItem")&&(t=e.nodeBefore),t){const e=t.getAttribute("listIndent");if(e>0)while(n&&n.is("element","listItem"))n._setAttribute("listIndent",n.getAttribute("listIndent")+e),n=n.nextSibling}}}function Cy(e,t,i){const{writer:o,schema:n}=i;let s=o.createPositionAfter(e);for(const r of t)if("ul"==r.name||"ol"==r.name)s=i.convertItem(r,s).modelCursor;else{const t=i.convertItem(r,o.createPositionAt(e,"end")),a=t.modelRange.start.nodeAfter,l=a&&a.is("element")&&!n.checkChild(e,a.name);l&&(e=t.modelCursor.parent.is("element","listItem")?t.modelCursor.parent:ky(t.modelCursor),s=o.createPositionAfter(e))}return s}function ky(e){const t=new Vo({startPosition:e});let i;do{i=t.next()}while(!i.value.item.is("element","listItem"));return i.value.item}function xy(e,t,i,o,n,s){const r=ny(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:e,foo:"b"}),a=n.mapper,l=n.writer,c=r?r.getAttribute("listIndent"):null;let d;if(r)if(c==e){const e=a.toViewElement(r).parent;d=l.createPositionAfter(e)}else{const e=s.createPositionAt(r,"end");d=a.toViewPosition(e)}else d=i;d=oy(d);for(const h of[...o.getChildren()])Vy(h)&&(d=l.move(l.createRangeOn(h),d).end,iy(l,h,h.nextSibling),iy(l,h.previousSibling,h))}function Vy(e){return e.is("element","ol")||e.is("element","ul")}function Ey(e){let t=0,i=e.parent;while(i){if(i.is("element","li"))t++;else{const e=i.previousSibling;e&&e.is("element","li")&&t++}i=i.parent}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ay extends a.Z{static get pluginName(){return"ListEditing"}static get requires(){return[lm,Cd]}init(){const e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const t=e.data,i=e.editing;e.model.document.registerPostFixer((t=>vy(e.model,t))),i.mapper.registerViewToModelLength("li",Py),t.mapper.registerViewToModelLength("li",Py),i.mapper.on("modelToViewPosition",by(i.view)),i.mapper.on("viewToModelPosition",_y(e.model)),t.mapper.on("modelToViewPosition",by(i.view)),e.conversion.for("editingDowncast").add((t=>{t.on("insert",my,{priority:"high"}),t.on("insert:listItem",ly(e.model)),t.on("attribute:listType:listItem",dy,{priority:"high"}),t.on("attribute:listType:listItem",hy,{priority:"low"}),t.on("attribute:listIndent:listItem",uy(e.model)),t.on("remove:listItem",cy(e.model)),t.on("remove",gy,{priority:"low"})})),e.conversion.for("dataDowncast").add((t=>{t.on("insert",my,{priority:"high"}),t.on("insert:listItem",ly(e.model))})),e.conversion.for("upcast").add((e=>{e.on("element:ul",fy,{priority:"high"}),e.on("element:ol",fy,{priority:"high"}),e.on("element:li",wy,{priority:"high"}),e.on("element:li",py)})),e.model.on("insertContent",yy,{priority:"high"}),e.commands.add("numberedList",new Kv(e,"numbered")),e.commands.add("bulletedList",new Kv(e,"bulleted")),e.commands.add("indentList",new Qv(e,"forward")),e.commands.add("outdentList",new Qv(e,"backward"));const o=i.view.document;this.listenTo(o,"enter",((e,t)=>{const i=this.editor.model.document,o=i.selection.getLastPosition().parent;i.selection.isCollapsed&&"listItem"==o.name&&o.isEmpty&&(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),{context:"li"}),this.listenTo(o,"delete",((e,t)=>{if("backward"!==t.direction)return;const i=this.editor.model.document.selection;if(!i.isCollapsed)return;const o=i.getFirstPosition();if(!o.isAtStart)return;const n=o.parent;if("listItem"!==n.name)return;const s=n.previousSibling&&"listItem"===n.previousSibling.name;s||(this.editor.execute("outdentList"),t.preventDefault(),e.stop())}),{context:"li"});const n=e=>(t,i)=>{const o=this.editor.commands.get(e);o.isEnabled&&(this.editor.execute(e),i())};e.keystrokes.set("Tab",n("indentList")),e.keystrokes.set("Shift+Tab",n("outdentList"))}afterInit(){const e=this.editor.commands,t=e.get("indent"),i=e.get("outdent");t&&t.registerChildCommand(e.get("indentList")),i&&i.registerChildCommand(e.get("outdentList"))}}function Py(e){let t=1;for(const i of e.getChildren())if("ul"==i.name||"ol"==i.name)for(const e of i.getChildren())t+=Py(e);return t}var Sy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Ty='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ny extends a.Z{static get pluginName(){return"ListUI"}init(){const e=this.editor.t;sy(this.editor,"numberedList",e("Numbered List"),Sy),sy(this.editor,"bulletedList",e("Bulleted List"),Ty)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Iy extends a.Z{static get requires(){return[Ay,Ny]}static get pluginName(){return"List"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Dy="todoListChecked";class Ry extends b.Z{constructor(e){super(e),this._selectedElements=[],this.on("execute",(()=>{this.refresh()}),{priority:"highest"})}refresh(){this._selectedElements=this._getSelectedItems(),this.value=this._selectedElements.every((e=>!!e.getAttribute("todoListChecked"))),this.isEnabled=!!this._selectedElements.length}_getSelectedItems(){const e=this.editor.model,t=e.schema,i=e.document.selection.getFirstRange(),o=i.start.parent,n=[];t.checkAttribute(o,Dy)&&n.push(o);for(const s of i.getItems())t.checkAttribute(s,Dy)&&!n.includes(s)&&n.push(s);return n}execute(e={}){this.editor.model.change((t=>{for(const i of this._selectedElements){const o=void 0===e.forceValue?!this.value:e.forceValue;o?t.setAttribute(Dy,!0,i):t.removeAttribute(Dy,i)}}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function By(e,t){return(i,o,n)=>{const s=n.consumable;if(!s.test(o.item,"insert")||!s.test(o.item,"attribute:listType")||!s.test(o.item,"attribute:listIndent"))return;if("todo"!=o.item.getAttribute("listType"))return;const r=o.item;s.consume(r,"insert"),s.consume(r,"attribute:listType"),s.consume(r,"attribute:listIndent"),s.consume(r,"attribute:todoListChecked");const a=n.writer,l=ey(r,n),c=!!r.getAttribute("todoListChecked"),d=zy(r,a,c,t),h=a.createContainerElement("span",{class:"todo-list__label__description"});a.addClass("todo-list",l.parent),a.insert(a.createPositionAt(l,0),d),a.insert(a.createPositionAfter(d),h),ty(r,l,n,e)}}function My(e){return(t,i,o)=>{const n=o.consumable;if(!n.test(i.item,"insert")||!n.test(i.item,"attribute:listType")||!n.test(i.item,"attribute:listIndent"))return;if("todo"!=i.item.getAttribute("listType"))return;const s=i.item;n.consume(s,"insert"),n.consume(s,"attribute:listType"),n.consume(s,"attribute:listIndent"),n.consume(s,"attribute:todoListChecked");const r=o.writer,a=ey(s,o);r.addClass("todo-list",a.parent);const l=r.createContainerElement("label",{class:"todo-list__label"}),c=r.createEmptyElement("input",{type:"checkbox",disabled:"disabled"}),d=r.createContainerElement("span",{class:"todo-list__label__description"});s.getAttribute("todoListChecked")&&r.setAttribute("checked","checked",c),r.insert(r.createPositionAt(a,0),l),r.insert(r.createPositionAt(l,0),c),r.insert(r.createPositionAfter(c),d),ty(s,a,o,e)}}function Oy(e,t,i){const o=t.modelCursor,n=o.parent,s=t.viewItem;if("checkbox"!=s.getAttribute("type")||"listItem"!=n.name||!o.isAtStart)return;if(!i.consumable.consume(s,{name:!0}))return;const r=i.writer;r.setAttribute("listType","todo",n),t.viewItem.hasAttribute("checked")&&r.setAttribute("todoListChecked",!0,n),t.modelRange=r.createRange(o)}function Ly(e,t){return(i,o,n)=>{const s=n.mapper.toViewElement(o.item),r=n.writer,a=Zy(s,t);if("todo"==o.attributeNewValue){const t=!!o.item.getAttribute("todoListChecked"),i=zy(o.item,r,t,e),n=r.createContainerElement("span",{class:"todo-list__label__description"}),a=r.createRangeIn(s),l=ry(s),c=oy(a.start),d=l?r.createPositionBefore(l):a.end,h=r.createRange(c,d);r.addClass("todo-list",s.parent),r.move(h,r.createPositionAt(n,0)),r.insert(r.createPositionAt(s,0),i),r.insert(r.createPositionAfter(i),n)}else if("todo"==o.attributeOldValue){const e=Hy(s,t);r.removeClass("todo-list",s.parent),r.remove(a),r.move(r.createRangeIn(e),r.createPositionBefore(e)),r.remove(e)}}}function $y(e){return(t,i,o)=>{if("todo"!=i.item.getAttribute("listType"))return;if(!o.consumable.consume(i.item,"attribute:todoListChecked"))return;const{mapper:n,writer:s}=o,r=!!i.item.getAttribute("todoListChecked"),a=n.toViewElement(i.item),l=a.getChild(0),c=zy(i.item,s,r,e);s.insert(s.createPositionAfter(l),c),s.remove(l)}}function Fy(e){return(t,i)=>{const o=i.modelPosition,n=o.parent;if(!n.is("element","listItem")||"todo"!=n.getAttribute("listType"))return;const s=i.mapper.toViewElement(n),r=Hy(s,e);r&&(i.viewPosition=i.mapper.findPositionIn(r,o.offset))}}function zy(e,t,i,o){const n=t.createUIElement("label",{class:"todo-list__label",contenteditable:!1},(function(t){const n=zi(document,"input",{type:"checkbox"});i&&n.setAttribute("checked","checked"),n.addEventListener("change",(()=>o(e)));const s=this.toDomElement(t);return s.appendChild(n),s}));return n}function Zy(e,t){const i=t.createRangeIn(e);for(const o of i)if(o.item.is("uiElement","label"))return o.item}function Hy(e,t){const i=t.createRangeIn(e);for(const o of i)if(o.item.is("containerElement","span")&&o.item.hasClass("todo-list__label__description"))return o.item}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const Uy=(0,ct.Zz)("Ctrl+Enter");class Wy extends a.Z{static get pluginName(){return"TodoListEditing"}static get requires(){return[Ay]}init(){const e=this.editor,{editing:t,data:i,model:o}=e;o.schema.extend("listItem",{allowAttributes:["todoListChecked"]}),o.schema.addAttributeCheck(((e,t)=>{const i=e.last;if("todoListChecked"==t&&"listItem"==i.name&&"todo"!=i.getAttribute("listType"))return!1})),e.commands.add("todoList",new Kv(e,"todo"));const n=new Ry(e);e.commands.add("checkTodoList",n),e.commands.add("todoListCheck",n),i.downcastDispatcher.on("insert:listItem",My(o),{priority:"high"}),i.upcastDispatcher.on("element:input",Oy,{priority:"high"}),t.downcastDispatcher.on("insert:listItem",By(o,(e=>this._handleCheckmarkChange(e))),{priority:"high"}),t.downcastDispatcher.on("attribute:listType:listItem",Ly((e=>this._handleCheckmarkChange(e)),t.view)),t.downcastDispatcher.on("attribute:todoListChecked:listItem",$y((e=>this._handleCheckmarkChange(e)))),t.mapper.on("modelToViewPosition",Fy(t.view)),i.mapper.on("modelToViewPosition",Fy(t.view)),this.listenTo(t.view.document,"arrowKey",qy(o,e.locale),{context:"li"}),this.listenTo(t.view.document,"keydown",((t,i)=>{(0,ct.Cq)(i)===Uy&&(e.execute("checkTodoList"),t.stop())}),{priority:"high"});const s=new Set;this.listenTo(o,"applyOperation",((e,t)=>{const i=t[0];if("rename"==i.type&&"listItem"==i.oldName){const e=i.position.nodeAfter;e.hasAttribute("todoListChecked")&&s.add(e)}else if("changeAttribute"==i.type&&"listType"==i.key&&"todo"===i.oldValue)for(const o of i.range.getItems())o.hasAttribute("todoListChecked")&&"todo"!==o.getAttribute("listType")&&s.add(o)})),o.document.registerPostFixer((e=>{let t=!1;for(const i of s)e.removeAttribute("todoListChecked",i),t=!0;return s.clear(),t}))}_handleCheckmarkChange(e){const t=this.editor,i=t.model,o=Array.from(i.document.selection.getRanges());i.change((i=>{i.setSelection(e,"end"),t.execute("checkTodoList"),i.setSelection(o)}))}}function qy(e,t){return(i,o)=>{const n=(0,ct.mA)(o.keyCode,t.contentLanguageDirection);if("left"!=n)return;const s=e.schema,r=e.document.selection;if(!r.isCollapsed)return;const a=r.getFirstPosition(),l=a.parent;if("listItem"===l.name&&"todo"==l.getAttribute("listType")&&a.isAtStart){const t=s.getNearestSelectionRange(e.createPositionBefore(l),"backward");t&&e.change((e=>e.setSelection(t))),o.preventDefault(),o.stopPropagation(),i.stop()}}}var Gy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class jy extends a.Z{static get pluginName(){return"TodoListUI"}init(){const e=this.editor.t;sy(this.editor,"todoList",e("To-do List"),Gy)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ky extends a.Z{static get requires(){return[Wy,jy]}static get pluginName(){return"TodoList"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Jy(e,t){return e=>{e.on("attribute:url:media",i)};function i(i,o,n){if(!n.consumable.consume(o.item,i.name))return;const s=o.attributeNewValue,r=n.writer,a=n.mapper.toViewElement(o.item),l=[...a.getChildren()].find((e=>e.getCustomProperty("media-content")));r.remove(l);const c=e.getMediaViewElement(r,s,t);r.insert(r.createPositionAt(a,0),c)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Yy(e,t,i){return t.setCustomProperty("media",!0,e),fg(e,t,{label:i})}function Qy(e,t,i,o){const n=e.createContainerElement("figure",{class:"media"});return e.insert(e.createPositionAt(n,0),t.getMediaViewElement(e,i,o)),n}function Xy(e){const t=e.getSelectedElement();return t&&t.is("element","media")?t:null}function eC(e,t,i){e.change((o=>{const n=o.createElement("media",{url:t});e.insertContent(n,i),o.setSelection(n,"on")}))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tC extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=Xy(t);this.value=i?i.getAttribute("url"):null,this.isEnabled=oC(t)||iC(t,e)}execute(e){const t=this.editor.model,i=t.document.selection,o=Xy(i);o?t.change((t=>{t.setAttribute("url",e,o)})):eC(t,e,kg(i,t))}}function iC(e,t){const i=kg(e,t);let o=i.start.parent;return o.isEmpty&&!t.schema.isLimit(o)&&(o=o.parent),t.schema.checkChild(o,"media")}function oC(e){const t=e.getSelectedElement();return!!t&&"media"===t.name}var nC='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sC="0 0 64 42";class rC{constructor(e,t){const i=t.providers,o=t.extraProviders||[],n=new Set(t.removeProviders),s=i.concat(o).filter((e=>{const t=e.name;return t?!n.has(t):((0,S.KE)("media-embed-no-provider-name",{provider:e}),!1)}));this.locale=e,this.providerDefinitions=s}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,i){return this._getMedia(t).getViewElement(e,i)}_getMedia(e){if(!e)return new aC(this.locale);e=e.trim();for(const t of this.providerDefinitions){const i=t.html,o=(0,D.Z)(t.url);for(const t of o){const o=this._getUrlMatches(e,t);if(o)return new aC(this.locale,e,o,i)}}return null}_getUrlMatches(e,t){let i=e.match(t);if(i)return i;let o=e.replace(/^https?:\/\//,"");return i=o.match(t),i||(o=o.replace(/^www\./,""),i=o.match(t),i||null)}}class aC{constructor(e,t,i,o){this.url=this._getValidUrl(t),this._t=e.t,this._match=i,this._previewRenderer=o}getViewElement(e,t){const i={};let o;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(i["data-oembed-url"]=this.url),t.renderForEditingView&&(i.class="ck-media__wrapper");const n=this._getPreviewHtml(t);o=e.createRawElement("div",i,((e,t)=>{t.setContentOf(e,n)}))}else this.url&&(i.url=this.url),o=e.createEmptyElement(t.elementName,i);return e.setCustomProperty("media-content",!0,o),o}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new Xc.Z,t=new Jl.Z;e.text=this._t("Open media in new tab"),t.content=nC,t.viewBox=sC;const i=new Ol.ZP({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[t]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},e]}]}).render();return i.outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lC extends a.Z{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`}},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`}},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:e=>{const t=e[1];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`}},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new rC(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,i=e.t,o=e.conversion,n=e.config.get("mediaEmbed.previewsInData"),s=e.config.get("mediaEmbed.elementName"),r=this.registry;e.commands.add("mediaEmbed",new tC(e)),t.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),o.for("dataDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const i=e.getAttribute("url");return Qy(t,r,i,{elementName:s,renderMediaPreview:i&&n})}}),o.for("dataDowncast").add(Jy(r,{elementName:s,renderMediaPreview:n})),o.for("editingDowncast").elementToElement({model:"media",view:(e,{writer:t})=>{const o=e.getAttribute("url"),n=Qy(t,r,o,{elementName:s,renderForEditingView:!0});return Yy(n,t,i("media widget"))}}),o.for("editingDowncast").add(Jy(r,{elementName:s,renderForEditingView:!0})),o.for("upcast").elementToElement({view:e=>["oembed",s].includes(e.name)&&e.getAttribute("url")?{name:!0}:null,model:(e,{writer:t})=>{const i=e.getAttribute("url");if(r.hasMedia(i))return t.createElement("media",{url:i})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(e,{writer:t})=>{const i=e.getAttribute("data-oembed-url");if(r.hasMedia(i))return t.createElement("media",{url:i})}}).add((e=>{function t(e,t,i){if(!i.consumable.consume(t.viewItem,{name:!0,classes:"media"}))return;const{modelRange:o,modelCursor:n}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=o,t.modelCursor=n;const s=(0,Xi.Z)(o.getItems());s||i.consumable.revert(t.viewItem,{name:!0,classes:"media"})}e.on("element:figure",t)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const cC=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class dC extends a.Z{static get requires(){return[cp,Cd,Ep]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document;this.listenTo(e.plugins.get("ClipboardPipeline"),"inputTransformation",(()=>{const e=t.selection.getFirstRange(),i=Nr.fromPosition(e.start);i.stickiness="toPrevious";const o=Nr.fromPosition(e.end);o.stickiness="toNext",t.once("change:data",(()=>{this._embedMediaBetweenPositions(i,o),i.detach(),o.detach()}),{priority:"high"})})),e.commands.get("undo").on("execute",(()=>{this._timeoutId&&(ri.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)}),{priority:"high"})}_embedMediaBetweenPositions(e,t){const i=this.editor,o=i.plugins.get(lC).registry,n=new qo(e,t),s=n.getWalker({ignoreElementEnd:!0});let r="";for(const l of s)l.item.is("$textProxy")&&(r+=l.item.data);if(r=r.trim(),!r.match(cC))return void n.detach();if(!o.hasMedia(r))return void n.detach();const a=i.commands.get("mediaEmbed");a.isEnabled?(this._positionToInsert=Nr.fromPosition(e),this._timeoutId=ri.window.setTimeout((()=>{i.model.change((e=>{let t;this._timeoutId=null,e.remove(n),n.detach(),"$graveyard"!==this._positionToInsert.root.rootName&&(t=this._positionToInsert),eC(i.model,r,t),this._positionToInsert.detach(),this._positionToInsert=null})),i.plugins.get("Delete").requestUndoOnBackspace()}),100)):n.detach()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hC extends cl.Z{constructor(e,t){super(t);const i=t.t;this.focusTracker=new eo,this.keystrokes=new to,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),sl.check,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",(e=>!!e)),this.cancelButtonView=this._createButton(i("Cancel"),sl.cancel,"ck-button-cancel","cancel"),this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]}),Bl(this)}render(){super.render(),Ml({view:this});const e=[this.urlInputView,this.saveButtonView,this.cancelButtonView];e.forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element);const t=e=>e.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t),this.listenTo(this.urlInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new Rc(this.locale,Bc),i=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,i.on("input",(()=>{t.infoText=i.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=i.element.value.trim()})),t}_createButton(e,t,i,o){const n=new l.Z(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.extendTemplate({attributes:{class:i}}),o&&n.delegate("execute").to(this,o),n}}var uC='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mC extends a.Z{static get requires(){return[lC]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,t=e.commands.get("mediaEmbed"),i=e.plugins.get(lC).registry;e.ui.componentFactory.add("mediaEmbed",(o=>{const n=_c(o),s=new hC(gC(e.t,i),e.locale);return this._setUpDropdown(n,s,t,e),this._setUpForm(n,s,t),n}))}_setUpDropdown(e,t,i){const o=this.editor,n=o.t,s=e.buttonView;function r(){o.editing.view.focus(),e.isOpen=!1}e.bind("isEnabled").to(i),e.panelView.children.add(t),s.set({label:n("Insert media"),icon:uC,tooltip:!0}),s.on("open",(()=>{t.disableCssTransitions(),t.url=i.value||"",t.urlInputView.fieldView.select(),t.focus(),t.enableCssTransitions()}),{priority:"low"}),e.on("submit",(()=>{t.isValid()&&(o.execute("mediaEmbed",t.url),r())})),e.on("change:isOpen",(()=>t.resetFormStatus())),e.on("cancel",(()=>r()))}_setUpForm(e,t,i){t.delegate("submit","cancel").to(e),t.urlInputView.bind("value").to(i,"value"),t.urlInputView.bind("isReadOnly").to(i,"isEnabled",(e=>!e))}}function gC(e,t){return[t=>{if(!t.url.length)return e("The URL must not be empty.")},i=>{if(!t.hasMedia(i.url))return e("This media URL is not supported.")}]}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pC extends a.Z{static get requires(){return[lC,mC,dC,Gg]}static get pluginName(){return"MediaEmbed"}}var fC=i(76920),wC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const bC="removeFormat";class _C extends a.Z{static get pluginName(){return"RemoveFormatUI"}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(bC,(i=>{const o=e.commands.get(bC),n=new l.Z(i);return n.set({label:t("Remove Format"),icon:wC,tooltip:!0}),n.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(n,"execute",(()=>{e.execute(bC),e.editing.view.focus()})),n}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vC extends b.Z{refresh(){const e=this.editor.model;this.isEnabled=!!(0,Xi.Z)(this._getFormattingItems(e.document.selection,e.schema))}execute(){const e=this.editor.model,t=e.schema;e.change((i=>{for(const o of this._getFormattingItems(e.document.selection,t))if(o.is("selection"))for(const e of this._getFormattingAttributes(o,t))i.removeSelectionAttribute(e);else{const e=i.createRangeOn(o);for(const n of this._getFormattingAttributes(o,t))i.removeAttribute(n,e)}}))}*_getFormattingItems(e,t){const i=e=>!!(0,Xi.Z)(this._getFormattingAttributes(e,t));for(const o of e.getRanges())for(const e of o.getItems())!t.isBlock(e)&&i(e)&&(yield e);for(const o of e.getSelectedBlocks())i(o)&&(yield o);i(e)&&(yield e)}*_getFormattingAttributes(e,t){for(const[i]of e.getAttributes()){const e=t.getAttributeProperties(i);e&&e.isFormatting&&(yield i)}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yC extends a.Z{static get pluginName(){return"RemoveFormatEditing"}init(){const e=this.editor;e.commands.add("removeFormat",new vC(e))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class CC extends a.Z{static get requires(){return[yC,_C]}static get pluginName(){return"RemoveFormat"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function kC(e){const t=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"br",isVoid:!0},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"input",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"pre",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"textarea",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],i=t.map((e=>e.name)).join("|"),o=e.replace(new RegExp(`</?(${i})( .*?)?>`,"g"),"\n$&\n").split("\n");let n=0;return o.filter((e=>e.length)).map((e=>xC(e,t)?EC(e,n++):VC(e,t)?EC(e,--n):EC(e,n))).join("\n")}function xC(e,t){return t.some((t=>!t.isVoid&&!!new RegExp(`<${t.name}( .*?)?>`).test(e)))}function VC(e,t){return t.some((t=>new RegExp(`</${t.name}>`).test(e)))}function EC(e,t,i="    "){return`${i.repeat(t)}${e}`}var AC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const PC="SourceEditingMode";class SC extends a.Z{static get pluginName(){return"SourceEditing"}static get requires(){return[Sa]}constructor(e){super(e),this.set("isSourceEditingMode",!1),this._elementReplacer=new Bi,this._replacedRoots=new Map,this._dataFromRoots=new Map}init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("sourceEditing",(i=>{const o=new l.Z(i);return o.set({label:t("Source"),icon:AC,tooltip:!0,withText:!0,class:"ck-source-editing-button"}),o.bind("isOn").to(this,"isSourceEditingMode"),o.bind("isEnabled").to(this,"isEnabled",e,"isReadOnly",e.plugins.get(Sa),"hasAny",((e,t,i)=>!!e&&(!t&&!i))),this.listenTo(o,"execute",(()=>{this.isSourceEditingMode=!this.isSourceEditingMode})),o})),this._isAllowedToHandleSourceEditingMode()&&(this.on("change:isSourceEditingMode",((e,t,i)=>{i?(this._showSourceEditing(),this._disableCommands()):(this._hideSourceEditing(),this._enableCommands())})),this.on("change:isEnabled",((e,t,i)=>this._handleReadOnlyMode(!i))),this.listenTo(e,"change:isReadOnly",((e,t,i)=>this._handleReadOnlyMode(i)))),e.data.on("get",(()=>{this.isSourceEditingMode&&this._updateEditorData()}),{priority:"high"})}afterInit(){const e=this.editor,t=["RealTimeCollaborativeEditing","CommentsEditing","TrackChangesEditing","RevisionHistory"];t.some((t=>e.plugins.has(t)))&&console.warn("You initialized the editor with the source editing feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing feature and restricted editing feature. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.")}_showSourceEditing(){const e=this.editor,t=e.editing.view,i=e.model;i.change((e=>{e.setSelection(null),e.removeSelectionAttribute(i.document.selection.getAttributeKeys())}));for(const[o,n]of t.domRoots){const i=TC(e.data.get({rootName:o})),s=zi(n.ownerDocument,"textarea",{rows:"1"}),r=zi(n.ownerDocument,"div",{class:"ck-source-editing-area","data-value":i},[s]);s.value=i,s.setSelectionRange(0,0),s.addEventListener("input",(()=>{r.dataset.value=s.value})),t.change((e=>{const i=t.document.getRoot(o);e.addClass("ck-hidden",i)})),this._replacedRoots.set(o,r),this._elementReplacer.replace(n,r),this._dataFromRoots.set(o,i)}this._focusSourceEditing()}_hideSourceEditing(){const e=this.editor,t=e.editing.view;this._updateEditorData(),t.change((e=>{for(const[i]of this._replacedRoots)e.removeClass("ck-hidden",t.document.getRoot(i))})),this._elementReplacer.restore(),this._replacedRoots.clear(),this._dataFromRoots.clear(),t.focus()}_updateEditorData(){const e=this.editor,t={};for(const[i,o]of this._replacedRoots){const e=this._dataFromRoots.get(i),n=o.dataset.value;e!==n&&(t[i]=n)}Object.keys(t).length&&e.data.set(t,{batchType:"default"})}_focusSourceEditing(){const[e]=this._replacedRoots.values(),t=e.querySelector("textarea");t.focus()}_disableCommands(){const e=this.editor;for(const t of e.commands.commands())t.forceDisabled(PC)}_enableCommands(){const e=this.editor;for(const t of e.commands.commands())t.clearForceDisabled(PC)}_handleReadOnlyMode(e){if(this.isSourceEditingMode)for(const[,t]of this._replacedRoots)t.querySelector("textarea").readOnly=e}_isAllowedToHandleSourceEditingMode(){const e=this.editor,t=e.ui.view.editable;return t&&!t._hasExternalElement}}function TC(e){return NC(e)?kC(e):e}function NC(e){return e.startsWith("<")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class IC extends Nc{constructor(e,t){super(e);const i=e.t;this.set("class","ck-special-characters-navigation"),this.groupDropdownView=this._createGroupDropdown(t),this.groupDropdownView.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",this.label=i("Special characters"),this.children.add(this.groupDropdownView)}get currentGroupName(){return this.groupDropdownView.value}_createGroupDropdown(e){const t=this.locale,i=t.t,o=_c(t),n=this._getCharacterGroupListItemDefinitions(o,e);return o.set("value",n.first.model.label),o.buttonView.bind("label").to(o,"value"),o.buttonView.set({isOn:!1,withText:!0,tooltip:i("Character categories"),class:["ck-dropdown__button_label-width_auto"]}),o.on("execute",(e=>{o.value=e.source.label})),o.delegate("execute").to(this),yc(o,n),o}_getCharacterGroupListItemDefinitions(e,t){const i=new P.Z;for(const o of t){const t={type:"button",model:new Lc({label:o,withText:!0})};t.model.bind("isOn").to(e,"value",(e=>e===t.model.label)),i.add(t)}return i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class DC extends cl.Z{constructor(e){super(e),this.tiles=this.createCollection(),this.setTemplate({tag:"div",children:[{tag:"div",attributes:{class:["ck","ck-character-grid__tiles"]},children:this.tiles}],attributes:{class:["ck","ck-character-grid"]}})}createTile(e,t){const i=new l.Z(this.locale);return i.set({label:e,withText:!0,class:"ck-character-grid__tile"}),i.extendTemplate({attributes:{title:t},on:{mouseover:i.bindTemplate.to("mouseover")}}),i.on("mouseover",(()=>{this.fire("tileHover",{name:t,character:e})})),i.on("execute",(()=>{this.fire("execute",{name:t,character:e})})),i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class RC extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.set("character",null),this.set("name",null),this.bind("code").to(this,"character",BC),this.setTemplate({tag:"div",children:[{tag:"span",attributes:{class:["ck-character-info__name"]},children:[{text:t.to("name",(e=>e||"​"))}]},{tag:"span",attributes:{class:["ck-character-info__code"]},children:[{text:t.to("code")}]}],attributes:{class:["ck","ck-character-info"]}})}}function BC(e){if(null===e)return"";const t=e.codePointAt(0).toString(16);return"U+"+("0000"+t).slice(-4)}var MC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2.5a7.47 7.47 0 0 1 4.231 1.31 7.268 7.268 0 0 1 2.703 3.454 7.128 7.128 0 0 1 .199 4.353c-.39 1.436-1.475 2.72-2.633 3.677h2.013c0-.226.092-.443.254-.603a.876.876 0 0 1 1.229 0c.163.16.254.377.254.603v.853c0 .209-.078.41-.22.567a.873.873 0 0 1-.547.28l-.101.006h-4.695a.517.517 0 0 1-.516-.518v-1.265c0-.21.128-.398.317-.489a5.601 5.601 0 0 0 2.492-2.371 5.459 5.459 0 0 0 .552-3.693 5.53 5.53 0 0 0-1.955-3.2A5.71 5.71 0 0 0 10 4.206 5.708 5.708 0 0 0 6.419 5.46 5.527 5.527 0 0 0 4.46 8.663a5.457 5.457 0 0 0 .554 3.695 5.6 5.6 0 0 0 2.497 2.37.55.55 0 0 1 .317.49v1.264c0 .286-.23.518-.516.518H2.618a.877.877 0 0 1-.614-.25.845.845 0 0 1-.254-.603v-.853c0-.226.091-.443.254-.603a.876.876 0 0 1 1.228 0c.163.16.255.377.255.603h1.925c-1.158-.958-2.155-2.241-2.545-3.678a7.128 7.128 0 0 1 .199-4.352 7.268 7.268 0 0 1 2.703-3.455A7.475 7.475 0 0 1 10 2.5z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const OC="All";class LC extends a.Z{static get requires(){return[kd]}static get pluginName(){return"SpecialCharacters"}constructor(e){super(e),this._characters=new Map,this._groups=new Map}init(){const e=this.editor,t=e.t,i=e.commands.get("input");e.ui.componentFactory.add("specialCharacters",(o=>{const n=_c(o);let s;return n.buttonView.set({label:t("Special characters"),icon:MC,tooltip:!0}),n.bind("isEnabled").to(i),n.on("execute",((t,i)=>{e.execute("input",{text:i.character}),e.editing.view.focus()})),n.on("change:isOpen",(()=>{s||(s=this._createDropdownPanelContent(o,n),n.panelView.children.add(s.navigationView),n.panelView.children.add(s.gridView),n.panelView.children.add(s.infoView)),s.infoView.set({character:null,name:null})})),n}))}addItems(e,t){if(e===OC)throw new S.ZP(`special-character-invalid-group-name: The name "${OC}" is reserved and cannot be used.`);const i=this._getGroup(e);for(const o of t)i.add(o.title),this._characters.set(o.title,o.character)}getGroups(){return this._groups.keys()}getCharactersForGroup(e){return e===OC?new Set(this._characters.keys()):this._groups.get(e)}getCharacter(e){return this._characters.get(e)}_getGroup(e){return this._groups.has(e)||this._groups.set(e,new Set),this._groups.get(e)}_updateGrid(e,t){t.tiles.clear();const i=this.getCharactersForGroup(e);for(const o of i){const e=this.getCharacter(o);t.tiles.add(t.createTile(e,o))}}_createDropdownPanelContent(e,t){const i=[...this.getGroups()];i.unshift(OC);const o=new IC(e,i),n=new DC(e),s=new RC(e);return n.delegate("execute").to(t),n.on("tileHover",((e,t)=>{s.set(t)})),o.on("execute",(()=>{this._updateGrid(o.currentGroupName,n)})),this._updateGrid(o.currentGroupName,n),{navigationView:o,gridView:n,infoView:s}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $C extends a.Z{static get pluginName(){return"SpecialCharactersCurrency"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Currency",[{character:"$",title:t("Dollar sign")},{character:"€",title:t("Euro sign")},{character:"¥",title:t("Yen sign")},{character:"£",title:t("Pound sign")},{character:"¢",title:t("Cent sign")},{character:"₠",title:t("Euro-currency sign")},{character:"₡",title:t("Colon sign")},{character:"₢",title:t("Cruzeiro sign")},{character:"₣",title:t("French franc sign")},{character:"₤",title:t("Lira sign")},{character:"¤",title:t("Currency sign")},{character:"₿",title:t("Bitcoin sign")},{character:"₥",title:t("Mill sign")},{character:"₦",title:t("Naira sign")},{character:"₧",title:t("Peseta sign")},{character:"₨",title:t("Rupee sign")},{character:"₩",title:t("Won sign")},{character:"₪",title:t("New sheqel sign")},{character:"₫",title:t("Dong sign")},{character:"₭",title:t("Kip sign")},{character:"₮",title:t("Tugrik sign")},{character:"₯",title:t("Drachma sign")},{character:"₰",title:t("German penny sign")},{character:"₱",title:t("Peso sign")},{character:"₲",title:t("Guarani sign")},{character:"₳",title:t("Austral sign")},{character:"₴",title:t("Hryvnia sign")},{character:"₵",title:t("Cedi sign")},{character:"₶",title:t("Livre tournois sign")},{character:"₷",title:t("Spesmilo sign")},{character:"₸",title:t("Tenge sign")},{character:"₹",title:t("Indian rupee sign")},{character:"₺",title:t("Turkish lira sign")},{character:"₻",title:t("Nordic mark sign")},{character:"₼",title:t("Manat sign")},{character:"₽",title:t("Ruble sign")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class FC extends a.Z{static get pluginName(){return"SpecialCharactersMathematical"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Mathematical",[{character:"<",title:t("Less-than sign")},{character:">",title:t("Greater-than sign")},{character:"≤",title:t("Less-than or equal to")},{character:"≥",title:t("Greater-than or equal to")},{character:"–",title:t("En dash")},{character:"—",title:t("Em dash")},{character:"¯",title:t("Macron")},{character:"‾",title:t("Overline")},{character:"°",title:t("Degree sign")},{character:"−",title:t("Minus sign")},{character:"±",title:t("Plus-minus sign")},{character:"÷",title:t("Division sign")},{character:"⁄",title:t("Fraction slash")},{character:"×",title:t("Multiplication sign")},{character:"ƒ",title:t("Latin small letter f with hook")},{character:"∫",title:t("Integral")},{character:"∑",title:t("N-ary summation")},{character:"∞",title:t("Infinity")},{character:"√",title:t("Square root")},{character:"∼",title:t("Tilde operator")},{character:"≅",title:t("Approximately equal to")},{character:"≈",title:t("Almost equal to")},{character:"≠",title:t("Not equal to")},{character:"≡",title:t("Identical to")},{character:"∈",title:t("Element of")},{character:"∉",title:t("Not an element of")},{character:"∋",title:t("Contains as member")},{character:"∏",title:t("N-ary product")},{character:"∧",title:t("Logical and")},{character:"∨",title:t("Logical or")},{character:"¬",title:t("Not sign")},{character:"∩",title:t("Intersection")},{character:"∪",title:t("Union")},{character:"∂",title:t("Partial differential")},{character:"∀",title:t("For all")},{character:"∃",title:t("There exists")},{character:"∅",title:t("Empty set")},{character:"∇",title:t("Nabla")},{character:"∗",title:t("Asterisk operator")},{character:"∝",title:t("Proportional to")},{character:"∠",title:t("Angle")},{character:"¼",title:t("Vulgar fraction one quarter")},{character:"½",title:t("Vulgar fraction one half")},{character:"¾",title:t("Vulgar fraction three quarters")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zC extends a.Z{static get pluginName(){return"SpecialCharactersArrows"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Arrows",[{title:t("leftwards double arrow"),character:"⇐"},{title:t("rightwards double arrow"),character:"⇒"},{title:t("upwards double arrow"),character:"⇑"},{title:t("downwards double arrow"),character:"⇓"},{title:t("leftwards dashed arrow"),character:"⇠"},{title:t("rightwards dashed arrow"),character:"⇢"},{title:t("upwards dashed arrow"),character:"⇡"},{title:t("downwards dashed arrow"),character:"⇣"},{title:t("leftwards arrow to bar"),character:"⇤"},{title:t("rightwards arrow to bar"),character:"⇥"},{title:t("upwards arrow to bar"),character:"⤒"},{title:t("downwards arrow to bar"),character:"⤓"},{title:t("up down arrow with base"),character:"↨"},{title:t("back with leftwards arrow above"),character:"🔙"},{title:t("end with leftwards arrow above"),character:"🔚"},{title:t("on with exclamation mark with left right arrow above"),character:"🔛"},{title:t("soon with rightwards arrow above"),character:"🔜"},{title:t("top with upwards arrow above"),character:"🔝"}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ZC extends a.Z{static get pluginName(){return"SpecialCharactersLatin"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Latin",[{character:"Ā",title:t("Latin capital letter a with macron")},{character:"ā",title:t("Latin small letter a with macron")},{character:"Ă",title:t("Latin capital letter a with breve")},{character:"ă",title:t("Latin small letter a with breve")},{character:"Ą",title:t("Latin capital letter a with ogonek")},{character:"ą",title:t("Latin small letter a with ogonek")},{character:"Ć",title:t("Latin capital letter c with acute")},{character:"ć",title:t("Latin small letter c with acute")},{character:"Ĉ",title:t("Latin capital letter c with circumflex")},{character:"ĉ",title:t("Latin small letter c with circumflex")},{character:"Ċ",title:t("Latin capital letter c with dot above")},{character:"ċ",title:t("Latin small letter c with dot above")},{character:"Č",title:t("Latin capital letter c with caron")},{character:"č",title:t("Latin small letter c with caron")},{character:"Ď",title:t("Latin capital letter d with caron")},{character:"ď",title:t("Latin small letter d with caron")},{character:"Đ",title:t("Latin capital letter d with stroke")},{character:"đ",title:t("Latin small letter d with stroke")},{character:"Ē",title:t("Latin capital letter e with macron")},{character:"ē",title:t("Latin small letter e with macron")},{character:"Ĕ",title:t("Latin capital letter e with breve")},{character:"ĕ",title:t("Latin small letter e with breve")},{character:"Ė",title:t("Latin capital letter e with dot above")},{character:"ė",title:t("Latin small letter e with dot above")},{character:"Ę",title:t("Latin capital letter e with ogonek")},{character:"ę",title:t("Latin small letter e with ogonek")},{character:"Ě",title:t("Latin capital letter e with caron")},{character:"ě",title:t("Latin small letter e with caron")},{character:"Ĝ",title:t("Latin capital letter g with circumflex")},{character:"ĝ",title:t("Latin small letter g with circumflex")},{character:"Ğ",title:t("Latin capital letter g with breve")},{character:"ğ",title:t("Latin small letter g with breve")},{character:"Ġ",title:t("Latin capital letter g with dot above")},{character:"ġ",title:t("Latin small letter g with dot above")},{character:"Ģ",title:t("Latin capital letter g with cedilla")},{character:"ģ",title:t("Latin small letter g with cedilla")},{character:"Ĥ",title:t("Latin capital letter h with circumflex")},{character:"ĥ",title:t("Latin small letter h with circumflex")},{character:"Ħ",title:t("Latin capital letter h with stroke")},{character:"ħ",title:t("Latin small letter h with stroke")},{character:"Ĩ",title:t("Latin capital letter i with tilde")},{character:"ĩ",title:t("Latin small letter i with tilde")},{character:"Ī",title:t("Latin capital letter i with macron")},{character:"ī",title:t("Latin small letter i with macron")},{character:"Ĭ",title:t("Latin capital letter i with breve")},{character:"ĭ",title:t("Latin small letter i with breve")},{character:"Į",title:t("Latin capital letter i with ogonek")},{character:"į",title:t("Latin small letter i with ogonek")},{character:"İ",title:t("Latin capital letter i with dot above")},{character:"ı",title:t("Latin small letter dotless i")},{character:"Ĳ",title:t("Latin capital ligature ij")},{character:"ĳ",title:t("Latin small ligature ij")},{character:"Ĵ",title:t("Latin capital letter j with circumflex")},{character:"ĵ",title:t("Latin small letter j with circumflex")},{character:"Ķ",title:t("Latin capital letter k with cedilla")},{character:"ķ",title:t("Latin small letter k with cedilla")},{character:"ĸ",title:t("Latin small letter kra")},{character:"Ĺ",title:t("Latin capital letter l with acute")},{character:"ĺ",title:t("Latin small letter l with acute")},{character:"Ļ",title:t("Latin capital letter l with cedilla")},{character:"ļ",title:t("Latin small letter l with cedilla")},{character:"Ľ",title:t("Latin capital letter l with caron")},{character:"ľ",title:t("Latin small letter l with caron")},{character:"Ŀ",title:t("Latin capital letter l with middle dot")},{character:"ŀ",title:t("Latin small letter l with middle dot")},{character:"Ł",title:t("Latin capital letter l with stroke")},{character:"ł",title:t("Latin small letter l with stroke")},{character:"Ń",title:t("Latin capital letter n with acute")},{character:"ń",title:t("Latin small letter n with acute")},{character:"Ņ",title:t("Latin capital letter n with cedilla")},{character:"ņ",title:t("Latin small letter n with cedilla")},{character:"Ň",title:t("Latin capital letter n with caron")},{character:"ň",title:t("Latin small letter n with caron")},{character:"ŉ",title:t("Latin small letter n preceded by apostrophe")},{character:"Ŋ",title:t("Latin capital letter eng")},{character:"ŋ",title:t("Latin small letter eng")},{character:"Ō",title:t("Latin capital letter o with macron")},{character:"ō",title:t("Latin small letter o with macron")},{character:"Ŏ",title:t("Latin capital letter o with breve")},{character:"ŏ",title:t("Latin small letter o with breve")},{character:"Ő",title:t("Latin capital letter o with double acute")},{character:"ő",title:t("Latin small letter o with double acute")},{character:"Œ",title:t("Latin capital ligature oe")},{character:"œ",title:t("Latin small ligature oe")},{character:"Ŕ",title:t("Latin capital letter r with acute")},{character:"ŕ",title:t("Latin small letter r with acute")},{character:"Ŗ",title:t("Latin capital letter r with cedilla")},{character:"ŗ",title:t("Latin small letter r with cedilla")},{character:"Ř",title:t("Latin capital letter r with caron")},{character:"ř",title:t("Latin small letter r with caron")},{character:"Ś",title:t("Latin capital letter s with acute")},{character:"ś",title:t("Latin small letter s with acute")},{character:"Ŝ",title:t("Latin capital letter s with circumflex")},{character:"ŝ",title:t("Latin small letter s with circumflex")},{character:"Ş",title:t("Latin capital letter s with cedilla")},{character:"ş",title:t("Latin small letter s with cedilla")},{character:"Š",title:t("Latin capital letter s with caron")},{character:"š",title:t("Latin small letter s with caron")},{character:"Ţ",title:t("Latin capital letter t with cedilla")},{character:"ţ",title:t("Latin small letter t with cedilla")},{character:"Ť",title:t("Latin capital letter t with caron")},{character:"ť",title:t("Latin small letter t with caron")},{character:"Ŧ",title:t("Latin capital letter t with stroke")},{character:"ŧ",title:t("Latin small letter t with stroke")},{character:"Ũ",title:t("Latin capital letter u with tilde")},{character:"ũ",title:t("Latin small letter u with tilde")},{character:"Ū",title:t("Latin capital letter u with macron")},{character:"ū",title:t("Latin small letter u with macron")},{character:"Ŭ",title:t("Latin capital letter u with breve")},{character:"ŭ",title:t("Latin small letter u with breve")},{character:"Ů",title:t("Latin capital letter u with ring above")},{character:"ů",title:t("Latin small letter u with ring above")},{character:"Ű",title:t("Latin capital letter u with double acute")},{character:"ű",title:t("Latin small letter u with double acute")},{character:"Ų",title:t("Latin capital letter u with ogonek")},{character:"ų",title:t("Latin small letter u with ogonek")},{character:"Ŵ",title:t("Latin capital letter w with circumflex")},{character:"ŵ",title:t("Latin small letter w with circumflex")},{character:"Ŷ",title:t("Latin capital letter y with circumflex")},{character:"ŷ",title:t("Latin small letter y with circumflex")},{character:"Ÿ",title:t("Latin capital letter y with diaeresis")},{character:"Ź",title:t("Latin capital letter z with acute")},{character:"ź",title:t("Latin small letter z with acute")},{character:"Ż",title:t("Latin capital letter z with dot above")},{character:"ż",title:t("Latin small letter z with dot above")},{character:"Ž",title:t("Latin capital letter z with caron")},{character:"ž",title:t("Latin small letter z with caron")},{character:"ſ",title:t("Latin small letter long s")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class HC extends a.Z{static get pluginName(){return"SpecialCharactersText"}init(){const e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Text",[{character:"‹",title:t("Single left-pointing angle quotation mark")},{character:"›",title:t("Single right-pointing angle quotation mark")},{character:"«",title:t("Left-pointing double angle quotation mark")},{character:"»",title:t("Right-pointing double angle quotation mark")},{character:"‘",title:t("Left single quotation mark")},{character:"’",title:t("Right single quotation mark")},{character:"“",title:t("Left double quotation mark")},{character:"”",title:t("Right double quotation mark")},{character:"‚",title:t("Single low-9 quotation mark")},{character:"„",title:t("Double low-9 quotation mark")},{character:"¡",title:t("Inverted exclamation mark")},{character:"¿",title:t("Inverted question mark")},{character:"‥",title:t("Two dot leader")},{character:"…",title:t("Horizontal ellipsis")},{character:"‡",title:t("Double dagger")},{character:"‰",title:t("Per mille sign")},{character:"‱",title:t("Per ten thousand sign")},{character:"‼",title:t("Double exclamation mark")},{character:"⁈",title:t("Question exclamation mark")},{character:"⁉",title:t("Exclamation question mark")},{character:"⁇",title:t("Double question mark")},{character:"©",title:t("Copyright sign")},{character:"®",title:t("Registered sign")},{character:"™",title:t("Trade mark sign")},{character:"§",title:t("Section sign")},{character:"¶",title:t("Paragraph sign")},{character:"⁋",title:t("Reversed paragraph sign")}])}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class UC extends a.Z{static get requires(){return[$C,HC,FC,zC,ZC]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function WC(e,t,i,o,n=1){t>n?o.setAttribute(e,t,i):o.removeAttribute(e,i)}function qC(e,t,i={}){const o=e.createElement("tableCell",i);return e.insertElement("paragraph",o),e.insert(o,t),o}function GC(e,t){const i=t.parent.parent,o=parseInt(i.getAttribute("headingColumns")||0),{column:n}=e.getCellLocation(t);return!!o&&n<o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function jC(){return e=>{e.on("element:figure",((e,t,i)=>{if(!i.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;const o=QC(t.viewItem);if(!o||!i.consumable.test(o,{name:!0}))return;i.consumable.consume(t.viewItem,{name:!0,classes:"table"});const n=i.convertItem(o,t.modelCursor),s=(0,Xi.Z)(n.modelRange.getItems());s?(i.convertChildren(t.viewItem,i.writer.createPositionAt(s,"end")),i.updateConversionResult(s,t)):i.consumable.revert(t.viewItem,{name:!0,classes:"table"})}))}}function KC(){return e=>{e.on("element:table",((e,t,i)=>{const o=t.viewItem;if(!i.consumable.test(o,{name:!0}))return;const{rows:n,headingRows:s,headingColumns:r}=XC(o),a={};r&&(a.headingColumns=r),s&&(a.headingRows=s);const l=i.writer.createElement("table",a);if(i.safeInsert(l,t.modelCursor)){if(i.consumable.consume(o,{name:!0}),n.forEach((e=>i.convertItem(e,i.writer.createPositionAt(l,"end")))),i.convertChildren(o,i.writer.createPositionAt(l,"end")),l.isEmpty){const e=i.writer.createElement("tableRow");i.writer.insert(e,i.writer.createPositionAt(l,"end")),qC(i.writer,i.writer.createPositionAt(e,"end"))}i.updateConversionResult(l,t)}}))}}function JC(){return e=>{e.on("element:tr",((e,t)=>{t.viewItem.isEmpty&&0==t.modelCursor.index&&e.stop()}),{priority:"high"})}}function YC(e){return t=>{t.on(`element:${e}`,((e,t,i)=>{if(t.modelRange&&t.viewItem.isEmpty){const e=t.modelRange.start.nodeAfter,o=i.writer.createPositionAt(e,0);i.writer.insertElement("paragraph",o)}}),{priority:"low"})}}function QC(e){for(const t of e.getChildren())if(t.is("element","table"))return t}function XC(e){const t={headingRows:0,headingColumns:0},i=[],o=[];let n;for(const s of Array.from(e.getChildren()))if("tbody"===s.name||"thead"===s.name||"tfoot"===s.name){"thead"!==s.name||n||(n=s);const e=Array.from(s.getChildren()).filter((e=>e.is("element","tr")));for(const s of e)if("thead"===s.parent.name&&s.parent===n)t.headingRows++,i.push(s);else{o.push(s);const e=ek(s,t,n);e>t.headingColumns&&(t.headingColumns=e)}}return t.rows=[...i,...o],t}function ek(e){let t=0,i=0;const o=Array.from(e.getChildren()).filter((e=>"th"===e.name||"td"===e.name));while(i<o.length&&"th"===o[i].name){const e=o[i],n=parseInt(e.getAttribute("colspan")||1);t+=n,i++}return t}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tk{constructor(e,t={}){this._table=e,this._startRow=void 0!==t.row?t.row:t.startRow||0,this._endRow=void 0!==t.row?t.row:t.endRow,this._startColumn=void 0!==t.column?t.column:t.startColumn||0,this._endColumn=void 0!==t.column?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let t=null;const i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(i.cell,i.row,i.column));else{const i=e.getChild(this._cellIndex);if(!i)return this._advanceToNextRow();const o=parseInt(i.getAttribute("colspan")||1),n=parseInt(i.getAttribute("rowspan")||1);(o>1||n>1)&&this._recordSpans(i,n,o),this._shouldSkipSlot()||(t=this._formatOutValue(i)),this._nextCellAtColumn=this._column+o}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next()}skipRow(e){this._skipRows.add(e)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return void 0!==this._endRow&&this._row>this._endRow}_isOverEndColumn(){return void 0!==this._endColumn&&this._column>this._endColumn}_formatOutValue(e,t=this._row,i=this._column){return{done:!1,value:new ik(this,e,t,i)}}_shouldSkipSlot(){const e=this._skipRows.has(this._row),t=this._row<this._startRow,i=this._column<this._startColumn,o=void 0!==this._endColumn&&this._column>this._endColumn;return e||t||i||o}_getSpanned(){const e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null}_recordSpans(e,t,i){const o={cell:e,row:this._row,column:this._column};for(let n=this._row;n<this._row+t;n++)for(let e=this._column;e<this._column+i;e++)n==this._row&&e==this._column||this._markSpannedCell(n,e,o)}_markSpannedCell(e,t,i){this._spannedCells.has(e)||this._spannedCells.set(e,new Map);const o=this._spannedCells.get(e);o.set(t,i)}}class ik{constructor(e,t,i,o){this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=i,this.cellAnchorColumn=o,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||1)}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||1)}get rowIndex(){return this._rowIndex}getPositionBefore(){const e=this._table.root.document.model;return e.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function ok(e={}){return t=>t.on("insert:table",((t,i,o)=>{const n=i.item;if(!o.consumable.consume(n,"insert"))return;o.consumable.consume(n,"attribute:headingRows:table"),o.consumable.consume(n,"attribute:headingColumns:table");const s=e&&e.asWidget,r=o.writer.createContainerElement("figure",{class:"table"}),a=o.writer.createContainerElement("table");let l;o.writer.insert(o.writer.createPositionAt(r,0),a),s&&(l=dk(r,o.writer));const c=new tk(n),d={headingRows:n.getAttribute("headingRows")||0,headingColumns:n.getAttribute("headingColumns")||0},h=new Map;for(const m of c){const{row:t,cell:i}=m,s=n.getChild(t),r=h.get(t)||gk(a,s,t,d,o);h.set(t,r),o.consumable.consume(i,"insert");const l=o.writer.createPositionAt(r,"end");mk(m,d,l,o,e)}for(const e of n.getChildren()){const t=e.index;e.is("element","tableRow")&&!h.has(t)&&h.set(t,gk(a,e,t,d,o))}const u=o.mapper.toViewPosition(i.range.start);o.mapper.bindElements(n,s?l:r),o.writer.insert(u,s?l:r)}))}function nk(){return e=>e.on("insert:tableRow",((e,t,i)=>{const o=t.item;if(!i.consumable.consume(o,"insert"))return;const n=o.parent,s=i.mapper.toViewElement(n),r=yk(s),a=n.getChildIndex(o),l=new tk(n,{row:a}),c={headingRows:n.getAttribute("headingRows")||0,headingColumns:n.getAttribute("headingColumns")||0},d=new Map;for(const h of l){const e=d.get(a)||gk(r,o,a,c,i);d.set(a,e),i.consumable.consume(h.cell,"insert");const t=i.writer.createPositionAt(e,"end");mk(h,c,t,i,{asWidget:!0})}}))}function sk(){return e=>e.on("insert:tableCell",((e,t,i)=>{const o=t.item;if(!i.consumable.consume(o,"insert"))return;const n=o.parent,s=n.parent,r=s.getChildIndex(n),a=new tk(s,{row:r}),l={headingRows:s.getAttribute("headingRows")||0,headingColumns:s.getAttribute("headingColumns")||0};for(const c of a)if(c.cell===o){const e=i.mapper.toViewElement(n),t=i.writer.createPositionAt(e,n.getChildIndex(o));return void mk(c,l,t,i,{asWidget:!0})}}))}function rk(){return e=>e.on("attribute:headingColumns:table",((e,t,i)=>{const o=t.item;if(!i.consumable.consume(t.item,e.name))return;const n={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},s=t.attributeOldValue,r=t.attributeNewValue,a=(s>r?s:r)-1;for(const l of new tk(o,{endColumn:a}))uk(l,n,i)}))}function ak(){return e=>e.on("remove:tableRow",((e,t,i)=>{e.stop();const o=i.writer,n=i.mapper,s=n.toViewPosition(t.position).getLastMatchingPosition((e=>!e.item.is("element","tr"))),r=s.nodeAfter,a=r.parent,l=a.parent,c=o.createRangeOn(r),d=o.remove(c);for(const h of o.createRangeIn(d).getItems())n.unbindViewElement(h);vk("thead",l,i),vk("tbody",l,i)}),{priority:"higher"})}function lk(e,t){const{writer:i}=t;if(e.parent.is("element","tableCell"))return ck(e)?i.createContainerElement("span",{class:"ck-table-bogus-paragraph"}):i.createContainerElement("p")}function ck(e){const t=e.parent,i=1===t.childCount;return i&&!Ck(e)}function dk(e,t){return t.setCustomProperty("table",!0,e),fg(e,t,{hasSelectionHandle:!0})}function hk(e,t,i){const o=i.writer,n=i.mapper.toViewElement(e),s=o.createEditableElement(t,n.getAttributes()),r=Cg(s,o);o.insert(o.createPositionAfter(n),r),o.move(o.createRangeIn(n),o.createPositionAt(r,0)),o.remove(o.createRangeOn(n)),i.mapper.unbindViewElement(n),i.mapper.bindElements(e,r)}function uk(e,t,i){const{cell:o}=e,n=pk(e,t),s=i.mapper.toViewElement(o);s&&s.name!==n&&hk(o,n,i)}function mk(e,t,i,o,n){const s=n&&n.asWidget,r=pk(e,t),a=s?Cg(o.writer.createEditableElement(r),o.writer):o.writer.createContainerElement(r),l=e.cell,c=l.getChild(0),d=1===l.childCount&&"paragraph"===c.name;if(o.writer.insert(i,a),o.mapper.bindElements(l,a),!s&&d&&!Ck(c)){const e=l.getChild(0);o.consumable.consume(e,"insert"),o.mapper.bindElements(e,a)}}function gk(e,t,i,o,n){n.consumable.consume(t,"insert");const s=t.isEmpty?n.writer.createEmptyElement("tr"):n.writer.createContainerElement("tr");n.mapper.bindElements(t,s);const r=o.headingRows,a=wk(fk(i,o),e,n),l=r>0&&i>=r?i-r:i,c=n.writer.createPositionAt(a,l);return n.writer.insert(c,s),s}function pk(e,t){const{row:i,column:o}=e,{headingColumns:n,headingRows:s}=t,r=s&&s>i;if(r)return"th";const a=n&&n>o;return a?"th":"td"}function fk(e,t){return e<t.headingRows?"thead":"tbody"}function wk(e,t,i){const o=bk(e,t);return o||_k(e,t,i)}function bk(e,t){for(const i of t.getChildren())if(i.name==e)return i}function _k(e,t,i){const o=i.writer.createContainerElement(e),n=i.writer.createPositionAt(t,"tbody"==e?"end":0);return i.writer.insert(n,o),o}function vk(e,t,i){const o=bk(e,t);o&&0===o.childCount&&i.writer.remove(i.writer.createRangeOn(o))}function yk(e){for(const t of e.getChildren())if("table"===t.name)return t}function Ck(e){return!![...e.getAttributeKeys()].length}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kk extends b.Z{refresh(){const e=this.editor.model,t=e.document.selection,i=e.schema;this.isEnabled=xk(t,i)}execute(e={}){const t=this.editor.model,i=t.document.selection,o=this.editor.plugins.get("TableUtils"),n=this.editor.config.get("table"),s=kg(i,t),r=n.defaultHeadings.rows,a=n.defaultHeadings.columns;void 0===e.headingRows&&r&&(e.headingRows=r),void 0===e.headingColumns&&a&&(e.headingColumns=a),t.change((i=>{const n=o.createTable(i,e);t.insertContent(n,s),i.setSelection(i.createPositionAt(n.getNodeByPath([0,0,0]),0))}))}}function xk(e,t){const i=e.getFirstPosition().parent,o=i===i.root?i:i.parent;return t.checkChild(o,"table")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Vk(e){const t=[];for(const i of Nk(e.getRanges())){const e=i.getContainedElement();e&&e.is("element","tableCell")&&t.push(e)}return t}function Ek(e){const t=[];for(const i of e.getRanges()){const e=i.start.findAncestor("tableCell");e&&t.push(e)}return t}function Ak(e){const t=Vk(e);return t.length?t:Ek(e)}function Pk(e){const t=e.map((e=>e.parent.index));return Ik(t)}function Sk(e){const t=e[0].findAncestor("table"),i=[...new tk(t)],o=i.filter((t=>e.includes(t.cell))).map((e=>e.column));return Ik(o)}function Tk(e,t){if(e.length<2||!Bk(e))return!1;const i=new Set,o=new Set;let n=0;for(const r of e){const{row:e,column:s}=t.getCellLocation(r),a=parseInt(r.getAttribute("rowspan")||1),l=parseInt(r.getAttribute("colspan")||1);i.add(e),o.add(s),a>1&&i.add(e+a-1),l>1&&o.add(s+l-1),n+=a*l}const s=Rk(i,o);return s==n}function Nk(e){return Array.from(e).sort(Dk)}function Ik(e){const t=e.sort(((e,t)=>e-t)),i=t[0],o=t[t.length-1];return{first:i,last:o}}function Dk(e,t){const i=e.start,o=t.start;return i.isBefore(o)?-1:1}function Rk(e,t){const i=Array.from(e.values()),o=Array.from(t.values()),n=Math.max(...i),s=Math.min(...i),r=Math.max(...o),a=Math.min(...o);return(n-s+1)*(r-a+1)}function Bk(e){const t=e[0].findAncestor("table"),i=Pk(e),o=parseInt(t.getAttribute("headingRows")||0);if(!Mk(i,o))return!1;const n=parseInt(t.getAttribute("headingColumns")||0),s=Sk(e);return Mk(s,n)}function Mk({first:e,last:t},i){const o=e<i,n=t<i;return o===n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Ok extends b.Z{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=this.editor.model.document.selection,t=!!Ak(e).length;this.isEnabled=t}execute(){const e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),o="above"===this.order,n=Ak(t),s=Pk(n),r=o?s.first:s.last,a=n[0].findAncestor("table");i.insertRows(a,{at:o?r:r+1,copyStructureFromAbove:!o})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Lk extends b.Z{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=this.editor.model.document.selection,t=!!Ak(e).length;this.isEnabled=t}execute(){const e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),o="left"===this.order,n=Ak(t),s=Sk(n),r=o?s.first:s.last,a=n[0].findAncestor("table");i.insertColumns(a,{columns:1,at:o?r:r+1})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class $k extends b.Z{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const e=Ak(this.editor.model.document.selection);this.isEnabled=1===e.length}execute(){const e=Ak(this.editor.model.document.selection)[0],t="horizontally"===this.direction,i=this.editor.plugins.get("TableUtils");t?i.splitCellHorizontally(e,2):i.splitCellVertically(e,2)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Fk(e,t,i){const{startRow:o,startColumn:n,endRow:s,endColumn:r}=t,a=i.createElement("table"),l=s-o+1;for(let d=0;d<l;d++)i.insertElement("tableRow",a,"end");const c=[...new tk(e,{startRow:o,endRow:s,startColumn:n,endColumn:r,includeAllSlots:!0})];for(const{row:d,column:h,cell:u,isAnchor:m,cellAnchorRow:g,cellAnchorColumn:p}of c){const e=d-o,t=a.getChild(e);if(m){const e=i.cloneElement(u);i.append(e,t),Wk(e,d,h,s,r,i)}else(g<o||p<n)&&qC(i,i.createPositionAt(t,"end"))}return qk(a,e,o,n,i),a}function zk(e,t,i=0){const o=[],n=new tk(e,{startRow:i,endRow:t-1});for(const s of n){const{row:e,cellHeight:i}=s,n=e+i-1;e<t&&t<=n&&o.push(s)}return o}function Zk(e,t,i){const o=e.parent,n=o.parent,s=o.index,r=parseInt(e.getAttribute("rowspan")),a=t-s,l={},c=r-a;c>1&&(l.rowspan=c);const d=parseInt(e.getAttribute("colspan")||1);d>1&&(l.colspan=d);const h=s,u=h+a,m=[...new tk(n,{startRow:h,endRow:u,includeAllSlots:!0})];let g,p=null;for(const f of m){const{row:t,column:o,cell:n}=f;n===e&&void 0===g&&(g=o),void 0!==g&&g===o&&t===u&&(p=qC(i,f.getPositionBefore(),l))}return WC("rowspan",a,e,i),p}function Hk(e,t){const i=[],o=new tk(e);for(const n of o){const{column:e,cellWidth:o}=n,s=e+o-1;e<t&&t<=s&&i.push(n)}return i}function Uk(e,t,i,o){const n=parseInt(e.getAttribute("colspan")),s=i-t,r={},a=n-s;a>1&&(r.colspan=a);const l=parseInt(e.getAttribute("rowspan")||1);l>1&&(r.rowspan=l);const c=qC(o,o.createPositionAfter(e),r);return WC("colspan",s,e,o),c}function Wk(e,t,i,o,n,s){const r=parseInt(e.getAttribute("colspan")||1),a=parseInt(e.getAttribute("rowspan")||1),l=i+r-1;if(l>n){const t=n-i+1;WC("colspan",t,e,s,1)}const c=t+a-1;if(c>o){const i=o-t+1;WC("rowspan",i,e,s,1)}}function qk(e,t,i,o,n){const s=parseInt(t.getAttribute("headingRows")||0);if(s>0){const t=s-i;WC("headingRows",t,e,n,0)}const r=parseInt(t.getAttribute("headingColumns")||0);if(r>0){const t=r-o;WC("headingColumns",t,e,n,0)}}function Gk(e,t){const i=t.getColumns(e),o=new Array(i).fill(0);for(const{column:s}of new tk(e))o[s]++;const n=o.reduce(((e,t,i)=>t?e:[...e,i]),[]);if(n.length>0){const i=n[n.length-1];return t.removeColumns(e,{at:i}),!0}return!1}function jk(e,t){const i=[],o=t.getRows(e);for(let n=0;n<o;n++){const t=e.getChild(n);t.isEmpty&&i.push(n)}if(i.length>0){const o=i[i.length-1];return t.removeRows(e,{at:o}),!0}return!1}function Kk(e,t){const i=Gk(e,t);i||jk(e,t)}function Jk(e,t){const i=Array.from(new tk(e,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow})),o=i.every((({cellHeight:e})=>1===e));if(o)return t.lastRow;const n=i[0].cellHeight-1;return t.lastRow+n}function Yk(e,t){const i=Array.from(new tk(e,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn})),o=i.every((({cellWidth:e})=>1===e));if(o)return t.lastColumn;const n=i[0].cellWidth-1;return t.lastColumn+n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qk extends b.Z{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=e.document,i=Ek(t.selection)[0],o=this.value,n=this.direction;e.change((e=>{const t="right"==n||"down"==n,s=t?i:o,r=t?o:i,a=r.parent;tx(r,s,e);const l=this.isHorizontal?"colspan":"rowspan",c=parseInt(i.getAttribute(l)||1),d=parseInt(o.getAttribute(l)||1);e.setAttribute(l,c+d,s),e.setSelection(e.createRangeIn(s));const h=this.editor.plugins.get("TableUtils"),u=a.findAncestor("table");Kk(u,h)}))}_getMergeableCell(){const e=this.editor.model,t=e.document,i=Ek(t.selection)[0];if(!i)return;const o=this.editor.plugins.get("TableUtils"),n=this.isHorizontal?Xk(i,this.direction,o):ex(i,this.direction,o);if(!n)return;const s=this.isHorizontal?"rowspan":"colspan",r=parseInt(i.getAttribute(s)||1),a=parseInt(n.getAttribute(s)||1);return a===r?n:void 0}}function Xk(e,t,i){const o=e.parent,n=o.parent,s="right"==t?e.nextSibling:e.previousSibling,r=(n.getAttribute("headingColumns")||0)>0;if(!s)return;const a="right"==t?e:s,l="right"==t?s:e,{column:c}=i.getCellLocation(a),{column:d}=i.getCellLocation(l),h=parseInt(a.getAttribute("colspan")||1),u=GC(i,a,n),m=GC(i,l,n);if(r&&u!=m)return;const g=c+h===d;return g?s:void 0}function ex(e,t,i){const o=e.parent,n=o.parent,s=n.getChildIndex(o);if("down"==t&&s===i.getRows(n)-1||"up"==t&&0===s)return;const r=parseInt(e.getAttribute("rowspan")||1),a=n.getAttribute("headingRows")||0,l="down"==t&&s+r===a,c="up"==t&&s===a;if(a&&(l||c))return;const d=parseInt(e.getAttribute("rowspan")||1),h="down"==t?s+d:s,u=[...new tk(n,{endRow:h})],m=u.find((t=>t.cell===e)),g=m.column,p=u.find((({row:e,cellHeight:i,column:o})=>o===g&&("down"==t?e===h:h===e+i)));return p&&p.cell}function tx(e,t,i){ix(e)||(ix(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e)}function ix(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ox extends b.Z{refresh(){const e=Ak(this.editor.model.document.selection),t=e[0];if(t){const i=t.findAncestor("table"),o=this.editor.plugins.get("TableUtils").getRows(i),n=o-1,s=Pk(e),r=0===s.first&&s.last===n;this.isEnabled=!r}else this.isEnabled=!1}execute(){const e=this.editor.model,t=this.editor.plugins.get("TableUtils"),i=Ak(e.document.selection),o=Pk(i),n=i[0],s=n.findAncestor("table"),r=t.getCellLocation(n).column;e.change((e=>{const i=o.last-o.first+1;t.removeRows(s,{at:o.first,rows:i});const n=nx(s,o.first,r,t.getRows(s));e.setSelection(e.createPositionAt(n,0))}))}}function nx(e,t,i,o){const n=e.getChild(Math.min(t,o-1));let s=n.getChild(0),r=0;for(const a of n.getChildren()){if(r>i)return s;s=a,r+=parseInt(a.getAttribute("colspan")||1)}return s}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class sx extends b.Z{refresh(){const e=Ak(this.editor.model.document.selection),t=e[0];if(t){const i=t.findAncestor("table"),o=this.editor.plugins.get("TableUtils").getColumns(i),{first:n,last:s}=Sk(e);this.isEnabled=s-n<o-1}else this.isEnabled=!1}execute(){const[e,t]=ax(this.editor.model.document.selection),i=e.parent.parent,o=[...new tk(i)],n={first:o.find((t=>t.cell===e)).column,last:o.find((e=>e.cell===t)).column},s=rx(o,e,t,n);this.editor.model.change((e=>{const t=n.last-n.first+1;this.editor.plugins.get("TableUtils").removeColumns(i,{at:n.first,columns:t}),e.setSelection(e.createPositionAt(s,0))}))}}function rx(e,t,i,o){const n=parseInt(i.getAttribute("colspan")||1);return n>1?i:t.previousSibling||i.nextSibling?i.nextSibling||t.previousSibling:o.first?e.reverse().find((({column:e})=>e<o.first)).cell:e.reverse().find((({column:e})=>e>o.last)).cell}function ax(e){const t=Ak(e),i=t[0],o=t.pop(),n=[i,o];return i.isBefore(o)?n:n.reverse()}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class lx extends b.Z{refresh(){const e=this.editor.model,t=Ak(e.document.selection),i=t.length>0;this.isEnabled=i,this.value=i&&t.every((e=>this._isInHeading(e,e.parent.parent)))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,i=Ak(t.document.selection),o=i[0].findAncestor("table"),{first:n,last:s}=Pk(i),r=this.value?n:s+1,a=o.getAttribute("headingRows")||0;t.change((e=>{if(r){const t=r>a?a:0,i=zk(o,r,t);for(const{cell:o}of i)Zk(o,r,e)}WC("headingRows",r,o,e,0)}))}_isInHeading(e,t){const i=parseInt(t.getAttribute("headingRows")||0);return!!i&&e.parent.index<i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class cx extends b.Z{refresh(){const e=this.editor.model,t=Ak(e.document.selection),i=this.editor.plugins.get("TableUtils"),o=t.length>0;this.isEnabled=o,this.value=o&&t.every((e=>GC(i,e)))}execute(e={}){if(e.forceValue===this.value)return;const t=this.editor.model,i=Ak(t.document.selection),o=i[0].findAncestor("table"),{first:n,last:s}=Sk(i),r=this.value?n:s+1;t.change((e=>{if(r){const t=Hk(o,r);for(const{cell:i,column:o}of t)Uk(i,o,r,e)}WC("headingColumns",r,o,e,0)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dx extends a.Z{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(e){const t=e.parent,i=t.parent,o=i.getChildIndex(t),n=new tk(i,{row:o});for(const{cell:s,row:r,column:a}of n)if(s===e)return{row:r,column:a}}createTable(e,t){const i=e.createElement("table"),o=parseInt(t.rows)||2,n=parseInt(t.columns)||2;return hx(e,i,0,o,n),t.headingRows&&WC("headingRows",Math.min(t.headingRows,o),i,e,0),t.headingColumns&&WC("headingColumns",Math.min(t.headingColumns,n),i,e,0),i}insertRows(e,t={}){const i=this.editor.model,o=t.at||0,n=t.rows||1,s=void 0!==t.copyStructureFromAbove,r=t.copyStructureFromAbove?o-1:o,a=this.getRows(e),l=this.getColumns(e);if(o>a)throw new S.ZP("tableutils-insertrows-insert-out-of-range",this,{options:t});i.change((t=>{const i=e.getAttribute("headingRows")||0;if(i>o&&WC("headingRows",i+n,e,t,0),!s&&(0===o||o===a))return void hx(t,e,o,n,l);const c=s?Math.max(o,r):o,d=new tk(e,{endRow:c}),h=new Array(l).fill(1);for(const{row:e,column:a,cellHeight:l,cellWidth:u,cell:m}of d){const i=e+l-1,c=e<o&&o<=i,d=e<=r&&r<=i;c?(t.setAttribute("rowspan",l+n,m),h[a]=-u):s&&d&&(h[a]=u)}for(let s=0;s<n;s++){const i=t.createElement("tableRow");t.insert(i,e,o);for(let e=0;e<h.length;e++){const o=h[e],n=t.createPositionAt(i,"end");o>0&&qC(t,n,o>1?{colspan:o}:null),e+=Math.abs(o)-1}}}))}insertColumns(e,t={}){const i=this.editor.model,o=t.at||0,n=t.columns||1;i.change((t=>{const i=e.getAttribute("headingColumns");o<i&&t.setAttribute("headingColumns",i+n,e);const s=this.getColumns(e);if(0===o||s===o){for(const i of e.getChildren())i.is("element","tableRow")&&ux(n,t,t.createPositionAt(i,o?"end":0));return}const r=new tk(e,{column:o,includeAllSlots:!0});for(const e of r){const{row:i,cell:s,cellAnchorColumn:a,cellAnchorRow:l,cellWidth:c,cellHeight:d}=e;if(a<o){t.setAttribute("colspan",c+n,s);const e=l+d-1;for(let t=i;t<=e;t++)r.skipRow(t)}else ux(n,t,e.getPositionBefore())}}))}removeRows(e,t){const i=this.editor.model,o=t.rows||1,n=this.getRows(e),s=t.at,r=s+o-1;if(r>n-1)throw new S.ZP("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});i.change((t=>{const{cellsToMove:i,cellsToTrim:o}=fx(e,s,r);if(i.size){const o=r+1;wx(e,o,i,t)}for(let n=r;n>=s;n--)t.remove(e.getChild(n));for(const{rowspan:e,cell:n}of o)WC("rowspan",e,n,t);px(e,s,r,t),Gk(e,this)||jk(e,this)}))}removeColumns(e,t){const i=this.editor.model,o=t.at,n=t.columns||1,s=t.at+n-1;i.change((t=>{gx(e,{first:o,last:s},t);for(let i=s;i>=o;i--)for(const{cell:o,column:n,cellWidth:s}of[...new tk(e)])n<=i&&s>1&&n+s>i?WC("colspan",s-1,o,t):n===i&&t.remove(o);jk(e,this)||Gk(e,this)}))}splitCellVertically(e,t=2){const i=this.editor.model,o=e.parent,n=o.parent,s=parseInt(e.getAttribute("rowspan")||1),r=parseInt(e.getAttribute("colspan")||1);i.change((i=>{if(r>1){const{newCellsSpan:o,updatedSpan:n}=mx(r,t);WC("colspan",n,e,i);const a={};o>1&&(a.colspan=o),s>1&&(a.rowspan=s);const l=r>t?t-1:r-1;ux(l,i,i.createPositionAfter(e),a)}if(r<t){const o=t-r,a=[...new tk(n)],{column:l}=a.find((({cell:t})=>t===e)),c=a.filter((({cell:t,cellWidth:i,column:o})=>{const n=t!==e&&o===l,s=o<l&&o+i>l;return n||s}));for(const{cell:e,cellWidth:t}of c)i.setAttribute("colspan",t+o,e);const d={};s>1&&(d.rowspan=s),ux(o,i,i.createPositionAfter(e),d);const h=n.getAttribute("headingColumns")||0;h>l&&WC("headingColumns",h+o,n,i)}}))}splitCellHorizontally(e,t=2){const i=this.editor.model,o=e.parent,n=o.parent,s=n.getChildIndex(o),r=parseInt(e.getAttribute("rowspan")||1),a=parseInt(e.getAttribute("colspan")||1);i.change((i=>{if(r>1){const o=[...new tk(n,{startRow:s,endRow:s+r-1,includeAllSlots:!0})],{newCellsSpan:l,updatedSpan:c}=mx(r,t);WC("rowspan",c,e,i);const{column:d}=o.find((({cell:t})=>t===e)),h={};l>1&&(h.rowspan=l),a>1&&(h.colspan=a);for(const e of o){const{column:t,row:o}=e,n=o>=s+c,r=t===d,a=(o+s+c)%l===0;n&&r&&a&&ux(1,i,e.getPositionBefore(),h)}}if(r<t){const o=t-r,l=[...new tk(n,{startRow:0,endRow:s})];for(const{cell:t,cellHeight:n,row:r}of l)if(t!==e&&r+n>s){const e=n+o;i.setAttribute("rowspan",e,t)}const c={};a>1&&(c.colspan=a),hx(i,n,s+1,o,1,c);const d=n.getAttribute("headingRows")||0;d>s&&WC("headingRows",d+o,n,i)}}))}getColumns(e){const t=e.getChild(0);return[...t.getChildren()].reduce(((e,t)=>{const i=parseInt(t.getAttribute("colspan")||1);return e+i}),0)}getRows(e){return Array.from(e.getChildren()).reduce(((e,t)=>t.is("element","tableRow")?e+1:e),0)}}function hx(e,t,i,o,n,s={}){for(let r=0;r<o;r++){const o=e.createElement("tableRow");e.insert(o,t,i),ux(n,e,e.createPositionAt(o,"end"),s)}}function ux(e,t,i,o={}){for(let n=0;n<e;n++)qC(t,i,o)}function mx(e,t){if(e<t)return{newCellsSpan:1,updatedSpan:1};const i=Math.floor(e/t),o=e-i*t+i;return{newCellsSpan:i,updatedSpan:o}}function gx(e,t,i){const o=e.getAttribute("headingColumns")||0;if(o&&t.first<o){const n=Math.min(o-1,t.last)-t.first+1;i.setAttribute("headingColumns",o-n,e)}}function px(e,t,i,o){const n=e.getAttribute("headingRows")||0;if(t<n){const s=i<n?n-(i-t+1):t;WC("headingRows",s,e,o,0)}}function fx(e,t,i){const o=new Map,n=[];for(const{row:s,column:r,cellHeight:a,cell:l}of new tk(e,{endRow:i})){const e=s+a-1,c=s>=t&&s<=i&&e>i;if(c){const e=i-s+1,t=a-e;o.set(r,{cell:l,rowspan:t})}const d=s<t&&e>=t;if(d){let o;o=e>=i?i-t+1:e-t+1,n.push({cell:l,rowspan:a-o})}}return{cellsToMove:o,cellsToTrim:n}}function wx(e,t,i,o){const n=new tk(e,{includeAllSlots:!0,row:t}),s=[...n],r=e.getChild(t);let a;for(const{column:l,cell:c,isAnchor:d}of s)if(i.has(l)){const{cell:e,rowspan:t}=i.get(l),n=a?o.createPositionAfter(a):o.createPositionAt(r,0);o.move(o.createRangeOn(e),n),WC("rowspan",t,e,o),a=e}else d&&(a=c)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bx extends b.Z{refresh(){const e=Vk(this.editor.model.document.selection);this.isEnabled=Tk(e,this.editor.plugins.get(dx))}execute(){const e=this.editor.model,t=this.editor.plugins.get(dx);e.change((i=>{const o=Vk(e.document.selection),n=o.shift(),{mergeWidth:s,mergeHeight:r}=yx(n,o,t);WC("colspan",s,n,i),WC("rowspan",r,n,i);for(const e of o)_x(e,n,i);const a=n.findAncestor("table");Kk(a,t),i.setSelection(n,"in")}))}}function _x(e,t,i){vx(e)||(vx(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e)}function vx(e){return 1==e.childCount&&e.getChild(0).is("element","paragraph")&&e.getChild(0).isEmpty}function yx(e,t,i){let o=0,n=0;for(const c of t){const{row:e,column:t}=i.getCellLocation(c);o=Cx(c,t,o,"colspan"),n=Cx(c,e,n,"rowspan")}const{row:s,column:r}=i.getCellLocation(e),a=o-r,l=n-s;return{mergeWidth:a,mergeHeight:l}}function Cx(e,t,i,o){const n=parseInt(e.getAttribute(o)||1);return Math.max(i,t+n)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kx extends b.Z{constructor(e){super(e),this.affectsData=!1}refresh(){const e=Ak(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=Ak(e.document.selection),i=Pk(t),o=t[0].findAncestor("table"),n=[];for(let s=i.first;s<=i.last;s++)for(const t of o.getChild(s).getChildren())n.push(e.createRangeOn(t));e.change((e=>{e.setSelection(n)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class xx extends b.Z{constructor(e){super(e),this.affectsData=!1}refresh(){const e=Ak(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const e=this.editor.model,t=Ak(e.document.selection),i=t[0],o=t.pop(),n=i.findAncestor("table"),s=this.editor.plugins.get("TableUtils"),r=s.getCellLocation(i),a=s.getCellLocation(o),l=Math.min(r.column,a.column),c=Math.max(r.column,a.column),d=[];for(const h of new tk(n,{startColumn:l,endColumn:c}))d.push(e.createRangeOn(h.cell));e.change((e=>{e.setSelection(d)}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Vx(e){e.document.registerPostFixer((t=>Ex(t,e)))}function Ex(e,t){const i=t.document.differ.getChanges();let o=!1;const n=new Set;for(const s of i){let t;"table"==s.name&&"insert"==s.type&&(t=s.position.nodeAfter),"tableRow"!=s.name&&"tableCell"!=s.name||(t=s.position.findAncestor("table")),Nx(s)&&(t=s.range.start.findAncestor("table")),t&&!n.has(t)&&(o=Ax(t,e)||o,o=Px(t,e)||o,n.add(t))}return o}function Ax(e,t){let i=!1;const o=Sx(e);if(o.length){i=!0;for(const e of o)WC("rowspan",e.rowspan,e.cell,t,1)}return i}function Px(e,t){let i=!1;const o=Tx(e),n=[];for(const[l,c]of o.entries())!c&&e.getChild(l).is("element","tableRow")&&n.push(l);if(n.length){i=!0;for(const i of n.reverse())t.remove(e.getChild(i)),o.splice(i,1)}const s=o.filter(((t,i)=>e.getChild(i).is("element","tableRow"))),r=s[0],a=s.every((e=>e===r));if(!a){const o=s.reduce(((e,t)=>t>e?t:e),0);for(const[n,r]of s.entries()){const s=o-r;if(s){for(let i=0;i<s;i++)qC(t,t.createPositionAt(e.getChild(n),"end"));i=!0}}}return i}function Sx(e){const t=parseInt(e.getAttribute("headingRows")||0),i=Array.from(e.getChildren()).reduce(((e,t)=>t.is("element","tableRow")?e+1:e),0),o=[];for(const{row:n,cell:s,cellHeight:r}of new tk(e)){if(r<2)continue;const e=n<t,a=e?t:i;if(n+r>a){const e=a-n;o.push({cell:s,rowspan:e})}}return o}function Tx(e){const t=new Array(e.childCount).fill(0);for(const{rowIndex:i}of new tk(e,{includeAllSlots:!0}))t[i]++;return t}function Nx(e){const t="attribute"===e.type,i=e.attributeKey;return t&&("headingRows"===i||"colspan"===i||"rowspan"===i)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Ix(e){e.document.registerPostFixer((t=>Dx(t,e)))}function Dx(e,t){const i=t.document.differ.getChanges();let o=!1;for(const n of i)"insert"==n.type&&"table"==n.name&&(o=Rx(n.position.nodeAfter,e)||o),"insert"==n.type&&"tableRow"==n.name&&(o=Bx(n.position.nodeAfter,e)||o),"insert"==n.type&&"tableCell"==n.name&&(o=Mx(n.position.nodeAfter,e)||o),Ox(n)&&(o=Mx(n.position.parent,e)||o);return o}function Rx(e,t){let i=!1;for(const o of e.getChildren())o.is("element","tableRow")&&(i=Bx(o,t)||i);return i}function Bx(e,t){let i=!1;for(const o of e.getChildren())i=Mx(o,t)||i;return i}function Mx(e,t){if(0==e.childCount)return t.insertElement("paragraph",e),!0;const i=Array.from(e.getChildren()).filter((e=>e.is("$text")));for(const o of i)t.wrap(t.createRangeOn(o),"paragraph");return!!i.length}function Ox(e){return!(!e.position||!e.position.parent.is("element","tableCell"))&&("insert"==e.type&&"$text"==e.name||"remove"==e.type)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function Lx(e,t){e.document.registerPostFixer((()=>$x(e.document.differ,t)))}function $x(e,t){const i=new Set;for(const o of e.getChanges()){const e="attribute"==o.type?o.range.start.parent:o.position.parent;e.is("element","tableCell")&&i.add(e)}for(const o of i.values())for(const i of[...o.getChildren()].filter((e=>Fx(e,t))))e.refreshItem(i);return!1}function Fx(e,t){if(!e.is("element","paragraph"))return!1;const i=t.toViewElement(e);return!!i&&ck(e)!==i.is("element","span")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function zx(e){e.document.registerPostFixer((()=>Zx(e)))}function Zx(e){const t=e.document.differ,i=new Set;for(const o of t.getChanges())if("attribute"===o.type){const e=o.range.start.nodeAfter;e&&e.is("element","table")&&"headingRows"===o.attributeKey&&i.add(e)}else if("insert"===o.type||"remove"===o.type)if("tableRow"===o.name){const e=o.position.findAncestor("table"),t=e.getAttribute("headingRows")||0;o.position.offset<t&&i.add(e)}else if("tableCell"===o.name){const e=o.position.findAncestor("table"),t=e.getAttribute("headingColumns")||0;o.position.offset<t&&i.add(e)}if(i.size){for(const e of i.values())t.refreshItem(e);return!0}return!1}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Hx extends a.Z{static get pluginName(){return"TableEditing"}init(){const e=this.editor,t=e.model,i=t.schema,o=e.conversion;i.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isObject:!0,isBlock:!0}),i.register("tableRow",{allowIn:"table",isLimit:!0}),i.register("tableCell",{allowIn:"tableRow",allowChildren:"$block",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),o.for("upcast").add(jC()),o.for("upcast").add(KC()),o.for("editingDowncast").add(ok({asWidget:!0})),o.for("dataDowncast").add(ok()),o.for("upcast").elementToElement({model:"tableRow",view:"tr"}),o.for("upcast").add(JC()),o.for("editingDowncast").add(nk()),o.for("editingDowncast").add(ak()),o.for("upcast").elementToElement({model:"tableCell",view:"td"}),o.for("upcast").elementToElement({model:"tableCell",view:"th"}),o.for("upcast").add(YC("td")),o.for("upcast").add(YC("th")),o.for("editingDowncast").add(sk()),o.for("editingDowncast").elementToElement({model:"paragraph",view:lk,converterPriority:"high"}),o.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),o.for("upcast").attributeToAttribute({model:{key:"colspan",value:Wx("colspan")},view:"colspan"}),o.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),o.for("upcast").attributeToAttribute({model:{key:"rowspan",value:Wx("rowspan")},view:"rowspan"}),o.for("editingDowncast").add(rk()),e.data.mapper.on("modelToViewPosition",Ux()),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new kk(e)),e.commands.add("insertTableRowAbove",new Ok(e,{order:"above"})),e.commands.add("insertTableRowBelow",new Ok(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Lk(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Lk(e,{order:"right"})),e.commands.add("removeTableRow",new ox(e)),e.commands.add("removeTableColumn",new sx(e)),e.commands.add("splitTableCellVertically",new $k(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new $k(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new bx(e)),e.commands.add("mergeTableCellRight",new Qk(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new Qk(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new Qk(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new Qk(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new cx(e)),e.commands.add("setTableRowHeader",new lx(e)),e.commands.add("selectTableRow",new kx(e)),e.commands.add("selectTableColumn",new xx(e)),zx(t),Vx(t),Lx(t,e.editing.mapper),Ix(t)}static get requires(){return[dx]}}function Ux(){return(e,t)=>{const i=t.modelPosition.parent,o=t.modelPosition.nodeBefore;if(!i.is("element","tableCell"))return;if(!o||!o.is("element","paragraph"))return;const n=t.mapper.toViewElement(o),s=t.mapper.toViewElement(i);n===s&&(t.viewPosition=t.mapper.findPositionIn(s,o.maxOffset))}}function Wx(e){return t=>{const i=parseInt(t.getAttribute(e));return Number.isNaN(i)||i<=0?null:i}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class qx extends cl.Z{constructor(e){super(e);const t=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",((e,t)=>`${t} × ${e}`)),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:t.to("label")}]}],on:{mousedown:t.to((e=>{e.preventDefault()})),click:t.to((()=>{this.fire("execute")}))}}),this.on("boxover",((e,t)=>{const{row:i,column:o}=t.target.dataset;this.set({rows:parseInt(i),columns:parseInt(o)})})),this.on("change:columns",(()=>{this._highlightGridBoxes()})),this.on("change:rows",(()=>{this._highlightGridBoxes()}))}focus(){}focusLast(){}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map(((i,o)=>{const n=Math.floor(o/10),s=o%10,r=n<e&&s<t;i.set("isOn",r)}))}_createGridCollection(){const e=[];for(let t=0;t<100;t++){const i=Math.floor(t/10),o=t%10;e.push(new Gx(this.locale,i+1,o+1))}return this.createCollection(e)}}class Gx extends cl.Z{constructor(e,t,i){super(e);const o=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",o.if("isOn","ck-on")],"data-row":t,"data-column":i}})}}var jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',Kx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',Jx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',Yx='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class Qx extends a.Z{static get pluginName(){return"TableUI"}init(){const e=this.editor,t=this.editor.t,i=e.locale.contentLanguageDirection,o="ltr"===i;e.ui.componentFactory.add("insertTable",(i=>{const o=e.commands.get("insertTable"),n=_c(i);let s;return n.bind("isEnabled").to(o),n.buttonView.set({icon:jx,label:t("Insert table"),tooltip:!0}),n.on("change:isOpen",(()=>{s||(s=new qx(i),n.panelView.children.add(s),s.delegate("execute").to(n),n.buttonView.on("open",(()=>{s.rows=0,s.columns=0})),n.on("execute",(()=>{e.execute("insertTable",{rows:s.rows,columns:s.columns}),e.editing.view.focus()})))})),n})),e.ui.componentFactory.add("tableColumn",(e=>{const i=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:o?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:o?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return this._prepareDropdown(t("Column"),Kx,i,e)})),e.ui.componentFactory.add("tableRow",(e=>{const i=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return this._prepareDropdown(t("Row"),Jx,i,e)})),e.ui.componentFactory.add("mergeTableCells",(e=>{const i=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:o?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:o?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(t("Merge cells"),Yx,i,e)}))}_prepareDropdown(e,t,i,o){const n=this.editor,s=_c(o),r=this._fillDropdownWithListOptions(s,i);return s.buttonView.set({label:e,icon:t,tooltip:!0}),s.bind("isEnabled").toMany(r,"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(s,"execute",(e=>{n.execute(e.source.commandName),n.editing.view.focus()})),s}_prepareMergeSplitButtonDropdown(e,t,i,o){const n=this.editor,s=_c(o,Ql),r="mergeTableCells",a=n.commands.get(r),l=this._fillDropdownWithListOptions(s,i);return s.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),s.bind("isEnabled").toMany([a,...l],"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(s.buttonView,"execute",(()=>{n.execute(r),n.editing.view.focus()})),this.listenTo(s,"execute",(e=>{n.execute(e.source.commandName),n.editing.view.focus()})),s}_fillDropdownWithListOptions(e,t){const i=this.editor,o=[],n=new P.Z;for(const s of t)Xx(s,i,o,n);return yc(e,n,i.ui.componentFactory),o}}function Xx(e,t,i,o){const n=e.model=new Lc(e.model),{commandName:s,bindIsOn:r}=e.model;if("button"===e.type||"switchbutton"===e.type){const e=t.commands.get(s);i.push(e),n.set({commandName:s}),n.bind("isEnabled").to(e),r&&n.bind("isOn").to(e,"value")}n.set({withText:!0}),o.add(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eV extends a.Z{static get pluginName(){return"TableSelection"}static get requires(){return[dx]}init(){const e=this.editor,t=e.model;this.listenTo(t,"deleteContent",((e,t)=>this._handleDeleteContent(e,t)),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const e=this.editor.model.document.selection,t=Vk(e);return 0==t.length?null:t}getSelectionAsFragment(){const e=this.getSelectedTableCells();return e?this.editor.model.change((t=>{const i=t.createDocumentFragment(),o=this.editor.plugins.get("TableUtils"),{first:n,last:s}=Sk(e),{first:r,last:a}=Pk(e),l=e[0].findAncestor("table");let c=a,d=s;if(Tk(e,o)){const e={firstColumn:n,lastColumn:s,firstRow:r,lastRow:a};c=Jk(l,e),d=Yk(l,e)}const h={startRow:r,startColumn:n,endRow:c,endColumn:d},u=Fk(l,h,t);return t.insert(u,i,0),i})):null}setCellSelection(e,t){const i=this._getCellsToSelect(e,t);this.editor.model.change((e=>{e.setSelection(i.cells.map((t=>e.createRangeOn(t))),{backward:i.backward})}))}getFocusCell(){const e=this.editor.model.document.selection,t=[...e.getRanges()].pop(),i=t.getContainedElement();return i&&i.is("element","tableCell")?i:null}getAnchorCell(){const e=this.editor.model.document.selection,t=(0,Xi.Z)(e.getRanges()),i=t.getContainedElement();return i&&i.is("element","tableCell")?i:null}_defineSelectionConverter(){const e=this.editor,t=new Set;function i(e){for(const i of t)e.removeClass("ck-editor__editable_selected",i);t.clear()}e.conversion.for("editingDowncast").add((e=>e.on("selection",((e,o,n)=>{const s=n.writer;i(s);const r=this.getSelectedTableCells();if(!r)return;for(const i of r){const e=n.mapper.toViewElement(i);s.addClass("ck-editor__editable_selected",e),t.add(e)}const a=n.mapper.toViewElement(r[r.length-1]);s.setSelection(a,0)}),{priority:"lowest"})))}_enablePluginDisabling(){const e=this.editor;this.on("change:isEnabled",(()=>{if(!this.isEnabled){const t=this.getSelectedTableCells();if(!t)return;e.model.change((i=>{const o=i.createPositionAt(t[0],0),n=e.model.schema.getNearestSelectionRange(o);i.setSelection(n)}))}}))}_handleDeleteContent(e,t){const[i,o]=t,n=this.editor.model,s=!o||"backward"==o.direction,r=Vk(i);r.length&&(e.stop(),n.change((e=>{const t=r[s?r.length-1:0];n.change((e=>{for(const t of r)n.deleteContent(e.createSelection(t,"in"))}));const o=n.schema.getNearestSelectionRange(e.createPositionAt(t,0));i.is("documentSelection")?e.setSelection(o):i.setTo(o)})))}_getCellsToSelect(e,t){const i=this.editor.plugins.get("TableUtils"),o=i.getCellLocation(e),n=i.getCellLocation(t),s=Math.min(o.row,n.row),r=Math.max(o.row,n.row),a=Math.min(o.column,n.column),l=Math.max(o.column,n.column),c=new Array(r-s+1).fill(null).map((()=>[])),d={startRow:s,endRow:r,startColumn:a,endColumn:l};for(const{row:m,cell:g}of new tk(e.findAncestor("table"),d))c[m-s].push(g);const h=n.row<o.row,u=n.column<o.column;return h&&c.reverse(),u&&c.forEach((e=>e.reverse())),{cells:c.flat(),backward:h||u}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class tV extends a.Z{static get pluginName(){return"TableClipboard"}static get requires(){return[eV,dx]}init(){const e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",((e,t)=>this._onCopyCut(e,t))),this.listenTo(t,"cut",((e,t)=>this._onCopyCut(e,t))),this.listenTo(e.model,"insertContent",((e,t)=>this._onInsertContent(e,...t)),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(e,t){const i=this.editor.plugins.get(eV);if(!i.getSelectedTableCells())return;if("cut"==e.name&&this.editor.isReadOnly)return;t.preventDefault(),e.stop();const o=this.editor.data,n=this.editor.editing.view.document,s=o.toView(i.getSelectionAsFragment());n.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:s,method:e.name})}_onInsertContent(e,t,i){if(i&&!i.is("documentSelection"))return;const o=this.editor.model,n=this.editor.plugins.get(dx);let s=iV(t,o);if(!s)return;const r=Ak(o.document.selection);r.length?(e.stop(),o.change((e=>{const t={width:n.getColumns(s),height:n.getRows(s)},i=oV(r,t,e,n),o=i.lastRow-i.firstRow+1,a=i.lastColumn-i.firstColumn+1,l={startRow:0,startColumn:0,endRow:Math.min(o,t.height)-1,endColumn:Math.min(a,t.width)-1};s=Fk(s,l,e);const c=r[0].findAncestor("table"),d=this._replaceSelectedCellsWithPasted(s,t,c,i,e);if(this.editor.plugins.get("TableSelection").isEnabled){const t=Nk(d.map((t=>e.createRangeOn(t))));e.setSelection(t)}else e.setSelection(d[0],0)}))):Kk(s,n)}_replaceSelectedCellsWithPasted(e,t,i,o,n){const{width:s,height:r}=t,a=sV(e,s,r),l=[...new tk(i,{startRow:o.firstRow,endRow:o.lastRow,startColumn:o.firstColumn,endColumn:o.lastColumn,includeAllSlots:!0})],c=[];let d;for(const p of l){const{row:e,column:t}=p;t===o.firstColumn&&(d=p.getPositionBefore());const i=e-o.firstRow,l=t-o.firstColumn,h=a[i%r][l%s],u=h?n.cloneElement(h):null,m=this._replaceTableSlotCell(p,u,d,n);m&&(Wk(m,e,t,o.lastRow,o.lastColumn,n),c.push(m),d=n.createPositionAfter(m))}const h=parseInt(i.getAttribute("headingRows")||0),u=parseInt(i.getAttribute("headingColumns")||0),m=o.firstRow<h&&h<=o.lastRow,g=o.firstColumn<u&&u<=o.lastColumn;if(m){const e={first:o.firstColumn,last:o.lastColumn},t=aV(i,h,e,n,o.firstRow);c.push(...t)}if(g){const e={first:o.firstRow,last:o.lastRow},t=lV(i,u,e,n);c.push(...t)}return c}_replaceTableSlotCell(e,t,i,o){const{cell:n,isAnchor:s}=e;return s&&o.remove(n),t?(o.insert(t,i),t):null}}function iV(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(1==e.childCount&&e.getChild(0).is("element","table"))return e.getChild(0);const i=t.createRangeIn(e);for(const o of i.getItems())if(o.is("element","table")){const e=t.createRange(i.start,t.createPositionBefore(o));if(t.hasContent(e,{ignoreWhitespaces:!0}))return null;const n=t.createRange(t.createPositionAfter(o),i.end);return t.hasContent(n,{ignoreWhitespaces:!0})?null:o}return null}function oV(e,t,i,o){const n=e[0].findAncestor("table"),s=Sk(e),r=Pk(e),a={firstColumn:s.first,lastColumn:s.last,firstRow:r.first,lastRow:r.last},l=1===e.length;return l&&(a.lastRow+=t.height-1,a.lastColumn+=t.width-1,nV(n,a.lastRow+1,a.lastColumn+1,o)),l||!Tk(e,o)?rV(n,a,i):(a.lastRow=Jk(n,a),a.lastColumn=Yk(n,a)),a}function nV(e,t,i,o){const n=o.getColumns(e),s=o.getRows(e);i>n&&o.insertColumns(e,{at:n,columns:i-n}),t>s&&o.insertRows(e,{at:s,rows:t-s})}function sV(e,t,i){const o=new Array(i).fill(null).map((()=>new Array(t).fill(null)));for(const{column:n,row:s,cell:r}of new tk(e))o[s][n]=r;return o}function rV(e,t,i){const{firstRow:o,lastRow:n,firstColumn:s,lastColumn:r}=t,a={first:o,last:n},l={first:s,last:r};lV(e,s,a,i),lV(e,r+1,a,i),aV(e,o,l,i),aV(e,n+1,l,i,o)}function aV(e,t,i,o,n=0){if(t<1)return;const s=zk(e,t,n),r=s.filter((({column:e,cellWidth:t})=>cV(e,t,i)));return r.map((({cell:e})=>Zk(e,t,o)))}function lV(e,t,i,o){if(t<1)return;const n=Hk(e,t),s=n.filter((({row:e,cellHeight:t})=>cV(e,t,i)));return s.map((({cell:e,column:i})=>Uk(e,i,t,o)))}function cV(e,t,i){const o=e+t-1,{first:n,last:s}=i,r=e>=n&&e<=s,a=e<n&&o>=n;return r||a}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class dV extends a.Z{static get pluginName(){return"TableKeyboard"}static get requires(){return[eV]}init(){const e=this.editor.editing.view,t=e.document;this.editor.keystrokes.set("Tab",((...e)=>this._handleTabOnSelectedTable(...e)),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(t,"arrowKey",((...e)=>this._onArrowKey(...e)),{context:"table"})}_handleTabOnSelectedTable(e,t){const i=this.editor,o=i.model.document.selection,n=o.getSelectedElement();n&&n.is("element","table")&&(t(),i.model.change((e=>{e.setSelection(e.createRangeIn(n.getChild(0).getChild(0)))})))}_getTabHandler(e){const t=this.editor;return(i,o)=>{const n=t.model.document.selection;let s=Ek(n)[0];if(s||(s=this.editor.plugins.get("TableSelection").getFocusCell()),!s)return;o();const r=s.parent,a=r.parent,l=a.getChildIndex(r),c=r.getChildIndex(s),d=0===c;if(!e&&d&&0===l)return void t.model.change((e=>{e.setSelection(e.createRangeOn(a))}));const h=this.editor.plugins.get("TableUtils"),u=c===r.childCount-1,m=l===h.getRows(a)-1;if(e&&m&&u&&(t.execute("insertTableRowBelow"),l===h.getRows(a)-1))return void t.model.change((e=>{e.setSelection(e.createRangeOn(a))}));let g;if(e&&u){const e=a.getChild(l+1);g=e.getChild(0)}else if(!e&&d){const e=a.getChild(l-1);g=e.getChild(e.childCount-1)}else g=r.getChild(c+(e?1:-1));t.model.change((e=>{e.setSelection(e.createRangeIn(g))}))}}_onArrowKey(e,t){const i=this.editor,o=t.keyCode,n=(0,ct.mA)(o,i.locale.contentLanguageDirection),s=this._handleArrowKeys(n,t.shiftKey);s&&(t.preventDefault(),t.stopPropagation(),e.stop())}_handleArrowKeys(e,t){const i=this.editor.model,o=i.document.selection,n=["right","down"].includes(e),s=Vk(o);if(s.length){let i;return i=t?this.editor.plugins.get("TableSelection").getFocusCell():n?s[s.length-1]:s[0],this._navigateFromCellInDirection(i,e,t),!0}const r=o.focus.findAncestor("tableCell");if(!r)return!1;if(!o.isCollapsed)if(t){if(o.isBackward==n&&!o.containsEntireContent(r))return!1}else{const e=o.getSelectedElement();if(!e||!i.schema.isObject(e))return!1}return!!this._isSelectionAtCellEdge(o,r,n)&&(this._navigateFromCellInDirection(r,e,t),!0)}_isSelectionAtCellEdge(e,t,i){const o=this.editor.model,n=this.editor.model.schema,s=i?e.getLastPosition():e.getFirstPosition();if(!n.getLimitElement(s).is("element","tableCell")){const e=o.createPositionAt(t,i?"end":0);return e.isTouching(s)}const r=o.createSelection(s);return o.modifySelection(r,{direction:i?"forward":"backward"}),s.isEqual(r.focus)}_navigateFromCellInDirection(e,t,i=!1){const o=this.editor.model,n=e.findAncestor("table"),s=[...new tk(n,{includeAllSlots:!0})],{row:r,column:a}=s[s.length-1],l=s.find((({cell:t})=>t==e));let{row:c,column:d}=l;switch(t){case"left":d--;break;case"up":c--;break;case"right":d+=l.cellWidth;break;case"down":c+=l.cellHeight;break}const h=c<0||c>r,u=d<0&&c<=0,m=d>a&&c>=r;if(h||u||m)return void o.change((e=>{e.setSelection(e.createRangeOn(n))}));d<0?(d=i?0:a,c--):d>a&&(d=i?a:0,c++);const g=s.find((e=>e.row==c&&e.column==d)).cell,p=["right","down"].includes(t),f=this.editor.plugins.get("TableSelection");if(i&&f.isEnabled){const t=f.getAnchorCell()||e;f.setCellSelection(t,g)}else{const e=o.createPositionAt(g,p?0:"end");o.change((t=>{t.setSelection(e)}))}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class hV extends Ai{constructor(e){super(e),this.domEventType=["mousemove","mouseleave"]}onDomEvent(e){this.fire(e.type,e)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class uV extends a.Z{static get pluginName(){return"TableMouse"}static get requires(){return[eV]}init(){const e=this.editor;e.editing.view.addObserver(hV),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const e=this.editor;let t=!1;const i=e.plugins.get(eV);this.listenTo(e.editing.view.document,"mousedown",((o,n)=>{if(!this.isEnabled||!i.isEnabled)return;if(!n.domEvent.shiftKey)return;const s=i.getAnchorCell()||Ek(e.model.document.selection)[0];if(!s)return;const r=this._getModelTableCellFromDomEvent(n);r&&mV(s,r)&&(t=!0,i.setCellSelection(s,r),n.preventDefault())})),this.listenTo(e.editing.view.document,"mouseup",(()=>{t=!1})),this.listenTo(e.editing.view.document,"selectionChange",(e=>{t&&e.stop()}),{priority:"highest"})}_enableMouseDragSelection(){const e=this.editor;let t,i,o=!1,n=!1;const s=e.plugins.get(eV);this.listenTo(e.editing.view.document,"mousedown",((e,i)=>{this.isEnabled&&s.isEnabled&&(i.domEvent.shiftKey||i.domEvent.ctrlKey||i.domEvent.altKey||(t=this._getModelTableCellFromDomEvent(i)))})),this.listenTo(e.editing.view.document,"mousemove",((e,r)=>{if(!r.domEvent.buttons)return;if(!t)return;const a=this._getModelTableCellFromDomEvent(r);a&&mV(t,a)&&(i=a,o||i==t||(o=!0)),o&&(n=!0,s.setCellSelection(t,i),r.preventDefault())})),this.listenTo(e.editing.view.document,"mouseup",(()=>{o=!1,n=!1,t=null,i=null})),this.listenTo(e.editing.view.document,"selectionChange",(e=>{n&&e.stop()}),{priority:"highest"})}_getModelTableCellFromDomEvent(e){const t=e.target,i=this.editor.editing.view.createPositionAt(t,0),o=this.editor.editing.mapper.toModelPosition(i),n=o.parent;return n.findAncestor("tableCell",{includeSelf:!0})}}function mV(e,t){return e.parent.parent==t.parent.parent}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gV extends a.Z{static get requires(){return[Hx,Qx,eV,uV,dV,tV,Gg]}static get pluginName(){return"Table"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function pV(e){e.document.registerPostFixer((t=>fV(t,e)))}function fV(e,t){const i=t.document.differ.getChanges();let o=!1;for(const n of i){if("insert"!=n.type)continue;const t=n.position.parent;if(t.is("element","table")||"table"==n.name){const t="table"==n.name?n.position.nodeAfter:n.position.parent,i=Array.from(t.getChildren()).filter((e=>e.is("element","caption"))),s=i.shift();if(!s)continue;for(const o of i)e.move(e.createRangeIn(o),s,"end"),e.remove(o);s.nextSibling&&(e.move(e.createRangeOn(s),t,"end"),o=!0),o=!!i.length||o}}return o}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function wV(e){return!!e&&e.is("element","table")}function bV(e){for(const t of e.getChildren())if(t.is("element","caption"))return t;return null}function _V(e){const t=yV(e);return t?bV(t):null}function vV(e){const t=e.parent;return"figcaption"==e.name&&t&&"figure"==t.name&&t.hasClass("table")||"caption"==e.name&&t&&"table"==t.name?{name:!0}:null}function yV(e){const t=e.getSelectedElement();return t&&t.is("element","table")?t:e.getFirstPosition().findAncestor("table")}
/**
* @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
class CV extends b.Z{refresh(){const e=this.editor,t=yV(e.model.document.selection);this.isEnabled=!!t,this.isEnabled?this.value=!!bV(t):this.value=!1}execute(e={}){const{focusCaptionOnShow:t}=e;this.editor.model.change((e=>{this.value?this._hideTableCaption(e):this._showTableCaption(e,t)}))}_showTableCaption(e,t){const i=this.editor.model,o=yV(i.document.selection),n=this.editor.plugins.get("TableCaptionEditing"),s=n._getSavedCaption(o),r=s||e.createElement("caption");e.append(r,o),t&&e.setSelection(r,"in")}_hideTableCaption(e){const t=this.editor.model,i=yV(t.document.selection),o=this.editor.plugins.get("TableCaptionEditing"),n=bV(i);o._saveCaption(i,n),e.setSelection(e.createRangeIn(i.getChild(0).getChild(0))),e.remove(n)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class kV extends a.Z{static get pluginName(){return"TableCaptionEditing"}constructor(e){super(e),this._savedCaptionsMap=new WeakMap}init(){const e=this.editor,t=e.model.schema,i=e.editing.view,o=e.t;t.isRegistered("caption")?t.extend("caption",{allowIn:"table"}):t.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new CV(this.editor)),e.conversion.for("upcast").elementToElement({view:vV,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>wV(e.parent)?t.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(e,{writer:t})=>{if(!wV(e.parent))return null;const n=t.createEditableElement("figcaption");return t.setCustomProperty("tableCaption",!0,n),Yd({view:i,element:n,text:o("Enter table caption"),keepOnFocus:!0}),Cg(n,t)}}),pV(e.model)}_getSavedCaption(e){const t=this._savedCaptionsMap.get(e);return t?ko.fromJSON(t):null}_saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON())}}
/**
* @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
class xV extends a.Z{static get pluginName(){return"TableCaptionUI"}init(){const e=this.editor,t=e.editing.view,i=e.t;e.ui.componentFactory.add("toggleTableCaption",(o=>{const n=e.commands.get("toggleTableCaption"),s=new l.Z(o);return s.set({icon:sl.caption,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(n,"value","isEnabled"),s.bind("label").to(n,"value",(e=>i(e?"Toggle caption off":"Toggle caption on"))),this.listenTo(s,"execute",(()=>{if(e.execute("toggleTableCaption",{focusCaptionOnShow:!0}),n.value){const i=_V(e.model.document.selection),o=e.editing.mapper.toViewElement(i);if(!o)return;t.scrollToTheSelection(),t.change((e=>{e.addClass("table__caption_highlighted",o)}))}})),s}))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class VV extends a.Z{static get pluginName(){return"TableCaption"}static get requires(){return[kV,xV]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class EV extends cl.Z{constructor(e,t){super(e);const i=this.bindTemplate;this.set("value",""),this.set("id"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.set("ariaDescribedById"),this.options=t,this._dropdownView=this._createDropdownView(),this._inputView=this._createInputTextView(),this._stillTyping=!1,this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color",i.if("hasError","ck-error")],id:i.to("id"),"aria-invalid":i.if("hasError",!0),"aria-describedby":i.to("ariaDescribedById")},children:[this._dropdownView,this._inputView]}),this.on("change:value",((e,t,i)=>this._setInputValue(i)))}focus(){this._inputView.focus()}_createDropdownView(){const e=this.locale,t=e.t,i=this.bindTemplate,o=this._createColorGrid(e),n=_c(e),s=new cl.Z,r=this._createRemoveColorButton();return s.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:i.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",i.if("value","ck-hidden",(e=>""!=e))]}}]}),n.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),n.buttonView.children.add(s),n.buttonView.tooltip=t("Color picker"),n.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",n.panelView.children.add(r),n.panelView.children.add(o),n.bind("isEnabled").to(this,"isReadOnly",(e=>!e)),n}_createInputTextView(){const e=this.locale,t=new Ic(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",(()=>{const e=t.element.value,i=this.options.colorDefinitions.find((t=>e===t.label));this._stillTyping=!0,this.value=i&&i.color||e})),t.on("blur",(()=>{this._stillTyping=!1,this._setInputValue(t.element.value)})),t.delegate("input").to(this),t}_createRemoveColorButton(){const e=this.locale,t=e.t,i=new l.Z(e),o=this.options.defaultColorValue||"",n=t(o?"Restore default":"Remove color");return i.class="ck-input-color__remove-color",i.withText=!0,i.icon=sl.eraser,i.label=n,i.on("execute",(()=>{this.value=o,this._dropdownView.isOpen=!1,this.fire("input")})),i}_createColorGrid(e){const t=new jl(e,{colorDefinitions:this.options.colorDefinitions,columns:this.options.columns});return t.on("execute",((e,t)=>{this.value=t.value,this._dropdownView.isOpen=!1,this.fire("input")})),t.bind("selectedColor").to(this,"value"),t}_setInputValue(e){if(!this._stillTyping){const t=AV(e),i=this.options.colorDefinitions.find((e=>t===AV(e.color)));this._inputView.value=i?i.label:e||""}}}function AV(e){return e.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const PV=e=>""===e;function SV(e){return{none:e("None"),solid:e("Solid"),dotted:e("Dotted"),dashed:e("Dashed"),double:e("Double"),groove:e("Groove"),ridge:e("Ridge"),inset:e("Inset"),outset:e("Outset")}}function TV(e){return e('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function NV(e){return e('The value is invalid. Try "10px" or "2em" or simply "2".')}function IV(e){return e=e.trim(),PV(e)||Eh(e)}function DV(e){return e=e.trim(),PV(e)||$V(e)||Th(e)||Ih(e)}function RV(e){return e=e.trim(),PV(e)||$V(e)||Th(e)}function BV(e,t){const i=new P.Z,o=SV(e.t);for(const n in o){const s={type:"button",model:new Lc({_borderStyleValue:n,label:o[n],withText:!0})};"none"===n?s.model.bind("isOn").to(e,"borderStyle",(e=>"none"===t?!e:e===n)):s.model.bind("isOn").to(e,"borderStyle",(e=>e===n)),i.add(s)}return i}function MV(e){const{view:t,icons:i,toolbar:o,labels:n,propertyName:s,nameToValue:r,defaultValue:a}=e;for(const c in n){const e=new l.Z(t.locale);e.set({label:n[c],icon:i[c],tooltip:n[c]});const d=r?r(c):c;e.bind("isOn").to(t,s,(e=>{let t=e;return""===e&&a&&(t=a),d===t})),e.on("execute",(()=>{t[s]=d})),o.items.add(e)}}const OV=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function LV(e){return(t,i,o)=>{const n=new EV(t.locale,{colorDefinitions:FV(e.colorConfig),columns:e.columns,defaultColorValue:e.defaultColorValue});return n.set({id:i,ariaDescribedById:o}),n.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),n.bind("hasError").to(t,"errorText",(e=>!!e)),n.on("input",(()=>{t.errorText=null})),t.bind("isEmpty","isFocused").to(n),n}}function $V(e){const t=parseFloat(e);return!Number.isNaN(t)&&e===String(t)}function FV(e){return e.map((e=>({color:e.model,label:e.label,options:{hasBorder:e.hasBorder}})))}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class zV extends cl.Z{constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("class",t.class||null),this.children=this.createCollection(),t.children&&t.children.forEach((e=>this.children.add(e))),this.set("_role",null),this.set("_ariaLabelledBy",null),t.labelView&&this.set({_role:"group",_ariaLabelledBy:t.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",i.to("class")],role:i.to("_role"),"aria-labelledby":i.to("_ariaLabelledBy")},children:this.children})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const ZV={left:sl.alignLeft,center:sl.alignCenter,right:sl.alignRight,justify:sl.alignJustify,top:sl.alignTop,middle:sl.alignMiddle,bottom:sl.alignBottom};class HV extends cl.Z{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=t;const{borderStyleDropdown:i,borderWidthInput:o,borderColorInput:n,borderRowLabel:s}=this._createBorderFields(),{backgroundRowLabel:r,backgroundInput:a}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{horizontalAlignmentToolbar:u,verticalAlignmentToolbar:m,alignmentLabel:g}=this._createAlignmentFields();this.focusTracker=new eo,this.keystrokes=new to,this.children=this.createCollection(),this.borderStyleDropdown=i,this.borderWidthInput=o,this.borderColorInput=n,this.backgroundInput=a,this.paddingInput=this._createPaddingField(),this.widthInput=l,this.heightInput=d,this.horizontalAlignmentToolbar=u,this.verticalAlignmentToolbar=m;const{saveButtonView:p,cancelButtonView:f}=this._createActionButtons();this.saveButtonView=p,this.cancelButtonView=f,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Nc(e,{label:this.t("Cell properties")})),this.children.add(new zV(e,{labelView:s,children:[s,i,n,o],class:"ck-table-form__border-row"})),this.children.add(new zV(e,{labelView:r,children:[r,a],class:"ck-table-form__background-row"})),this.children.add(new zV(e,{children:[new zV(e,{labelView:h,children:[h,l,c,d],class:"ck-table-form__dimensions-row"}),new zV(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new zV(e,{labelView:g,children:[g,u,m],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new zV(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ml({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=LV({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color}),o=this.locale,n=this.t,s=new Ac(o);s.text=n("Border");const r=SV(n),a=new Rc(o,Mc);a.set({label:n("Style"),class:"ck-table-form__border-style"}),a.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:n("Style")}),a.fieldView.buttonView.bind("label").to(this,"borderStyle",(e=>r[e||"none"])),a.fieldView.on("execute",(e=>{this.borderStyle=e.source._borderStyleValue})),a.bind("isEmpty").to(this,"borderStyle",(e=>!e)),yc(a.fieldView,BV(this,t.style));const l=new Rc(o,Bc);l.set({label:n("Width"),class:"ck-table-form__border-width"}),l.fieldView.bind("value").to(this,"borderWidth"),l.bind("isEnabled").to(this,"borderStyle",UV),l.fieldView.on("input",(()=>{this.borderWidth=l.fieldView.element.value}));const c=new Rc(o,i);return c.set({label:n("Color"),class:"ck-table-form__border-color"}),c.fieldView.bind("value").to(this,"borderColor"),c.bind("isEnabled").to(this,"borderStyle",UV),c.fieldView.on("input",(()=>{this.borderColor=c.fieldView.value})),this.on("change:borderStyle",((e,i,o,n)=>{UV(o)||(this.borderColor="",this.borderWidth=""),UV(n)||(this.borderColor=t.color,this.borderWidth=t.width)})),{borderRowLabel:s,borderStyleDropdown:a,borderColorInput:c,borderWidthInput:l}}_createBackgroundFields(){const e=this.locale,t=this.t,i=new Ac(e);i.text=t("Background");const o=LV({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor}),n=new Rc(e,o);return n.set({label:t("Color"),class:"ck-table-cell-properties-form__background"}),n.fieldView.bind("value").to(this,"backgroundColor"),n.fieldView.on("input",(()=>{this.backgroundColor=n.fieldView.value})),{backgroundRowLabel:i,backgroundInput:n}}_createDimensionFields(){const e=this.locale,t=this.t,i=new Ac(e);i.text=t("Dimensions");const o=new Rc(e,Bc);o.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),o.fieldView.bind("value").to(this,"width"),o.fieldView.on("input",(()=>{this.width=o.fieldView.element.value}));const n=new cl.Z(e);n.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const s=new Rc(e,Bc);return s.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),s.fieldView.bind("value").to(this,"height"),s.fieldView.on("input",(()=>{this.height=s.fieldView.element.value})),{dimensionsLabel:i,widthInput:o,operatorLabel:n,heightInput:s}}_createPaddingField(){const e=this.locale,t=this.t,i=new Rc(e,Bc);return i.set({label:t("Padding"),class:"ck-table-cell-properties-form__padding"}),i.fieldView.bind("value").to(this,"padding"),i.fieldView.on("input",(()=>{this.padding=i.fieldView.element.value})),i}_createAlignmentFields(){const e=this.locale,t=this.t,i=new Ac(e);i.text=t("Table cell text alignment");const o=new uc(e),n="rtl"===this.locale.contentLanguageDirection;o.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),MV({view:this,icons:ZV,toolbar:o,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:e=>{if(n){if("left"===e)return"right";if("right"===e)return"left"}return e},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const s=new uc(e);return s.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),MV({view:this,icons:ZV,toolbar:s,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:o,verticalAlignmentToolbar:s,alignmentLabel:i}}_createActionButtons(){const e=this.locale,t=this.t,i=new l.Z(e),o=new l.Z(e),n=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return i.set({label:t("Save"),icon:sl.check,class:"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(n,"errorText",((...e)=>e.every((e=>!e)))),o.set({label:t("Cancel"),icon:sl.cancel,class:"ck-button-cancel",withText:!0}),o.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:o}}get _horizontalAlignmentLabels(){const e=this.locale,t=this.t,i=t("Align cell text to the left"),o=t("Align cell text to the center"),n=t("Align cell text to the right"),s=t("Justify cell text");return"rtl"===e.uiLanguageDirection?{right:n,center:o,left:i,justify:s}:{left:i,center:o,right:n,justify:s}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function UV(e){return"none"!==e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function WV(e){const t=e.getSelectedElement();return t&&GV(t)?t:null}function qV(e){let t=e.getFirstPosition().parent;while(t){if(t.is("element")&&GV(t))return t;t=t.parent}return null}function GV(e){return!!e.getCustomProperty("table")&&pg(e)}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const jV=Zc.defaultPositions,KV=[jV.northArrowSouth,jV.northArrowSouthWest,jV.northArrowSouthEast,jV.southArrowNorth,jV.southArrowNorthWest,jV.southArrowNorthEast,jV.viewportStickyNorth];function JV(e,t){const i=e.plugins.get("ContextualBalloon");if(qV(e.editing.view.document.selection)){let o;o="cell"===t?QV(e):YV(e),i.updatePosition(o)}}function YV(e){const t=e.model.document.selection.getFirstPosition(),i=t.findAncestor("table"),o=e.editing.mapper.toViewElement(i);return{target:e.editing.view.domConverter.viewToDom(o),positions:KV}}function QV(e){const t=e.editing.mapper,i=e.editing.view.domConverter,o=e.model.document.selection;if(o.rangeCount>1)return{target:()=>eE(o.getRanges(),e),positions:KV};const n=XV(o.getFirstPosition()),s=t.toViewElement(n);return{target:i.viewToDom(s),positions:KV}}function XV(e){const t=e.nodeAfter&&e.nodeAfter.is("element","tableCell");return t?e.nodeAfter:e.findAncestor("tableCell")}function eE(e,t){const i=t.editing.mapper,o=t.editing.view.domConverter,n=Array.from(e).map((e=>{const t=XV(e.start),n=i.toViewElement(t);return new Gi(o.viewToDom(n))}));return Gi.getBoundingRect(n)}var tE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function iE(e){if(!e||!(0,le.Z)(e))return e;const{top:t,right:i,bottom:o,left:n}=e;return t==i&&i==o&&o==n?t:void 0}function oE(e,t){const i=parseFloat(e);return Number.isNaN(i)||String(i)!==String(e)?e:`${i}${t}`}function nE(e,t={}){const i=Object.assign({borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:""},e);return t.includeAlignmentProperty&&!i.alignment&&(i.alignment="center"),t.includePaddingProperty&&!i.padding&&(i.padding=""),t.includeVerticalAlignmentProperty&&!i.verticalAlignment&&(i.verticalAlignment="middle"),t.includeHorizontalAlignmentProperty&&!i.horizontalAlignment&&(i.horizontalAlignment=t.isRightToLeftContent?"right":"left"),i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const sE=500,rE={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",width:"tableCellWidth",height:"tableCellHeight",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class aE extends a.Z{static get requires(){return[jc]}static get pluginName(){return"TableCellPropertiesUI"}constructor(e){super(e),e.config.define("table.tableCellProperties",{borderColors:OV,backgroundColors:OV})}init(){const e=this.editor,t=e.t;this._defaultTableCellProperties=nE(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection}),this._balloon=e.plugins.get(jc),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableCellProperties",(i=>{const o=new l.Z(i);o.set({label:t("Cell properties"),icon:tE,tooltip:!0}),this.listenTo(o,"execute",(()=>this._showView()));const n=Object.values(rE).map((t=>e.commands.get(t)));return o.bind("isEnabled").toMany(n,"isEnabled",((...e)=>e.some((e=>e)))),o}))}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.editing.view.document,i=e.config.get("table.tableCellProperties"),o=Zl(i.borderColors),n=zl(e.locale,o),s=Zl(i.backgroundColors),r=zl(e.locale,s),a=new HV(e.locale,{borderColors:n,backgroundColors:r,defaultTableCellProperties:this._defaultTableCellProperties}),l=e.t;a.render(),this.listenTo(a,"submit",(()=>{this._hideView()})),this.listenTo(a,"cancel",(()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()})),a.keystrokes.set("Esc",((e,t)=>{this._hideView(),t()})),this.listenTo(e.ui,"update",(()=>{qV(t.selection)?this._isViewVisible&&JV(e,"cell"):this._hideView()})),Rl({emitter:a,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const c=TV(l),d=NV(l);return a.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle",this._defaultTableCellProperties.borderStyle)),a.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:a.borderColorInput,commandName:"tableCellBorderColor",errorText:c,validator:IV,defaultValue:this._defaultTableCellProperties.borderColor})),a.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:a.borderWidthInput,commandName:"tableCellBorderWidth",errorText:d,validator:RV,defaultValue:this._defaultTableCellProperties.borderWidth})),a.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:a.paddingInput,commandName:"tableCellPadding",errorText:d,validator:DV,defaultValue:this._defaultTableCellProperties.padding})),a.on("change:width",this._getValidatedPropertyChangeCallback({viewField:a.widthInput,commandName:"tableCellWidth",errorText:d,validator:DV,defaultValue:this._defaultTableCellProperties.width})),a.on("change:height",this._getValidatedPropertyChangeCallback({viewField:a.heightInput,commandName:"tableCellHeight",errorText:d,validator:DV,defaultValue:this._defaultTableCellProperties.height})),a.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:a.backgroundInput,commandName:"tableCellBackgroundColor",errorText:c,validator:IV,defaultValue:this._defaultTableCellProperties.backgroundColor})),a.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment",this._defaultTableCellProperties.horizontalAlignment)),a.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment",this._defaultTableCellProperties.verticalAlignment)),a}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(rE).map((([t,i])=>{const o=this._defaultTableCellProperties[t]||"";return[t,e.get(i).value||o]})).forEach((([e,i])=>{("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&this.view.set(e,i)}))}_showView(){const e=this.editor;this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:QV(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){if(!this._isViewInBalloon)return;const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e,t){return(i,o,n,s)=>{(s||t!==n)&&this.editor.execute(e,{value:n,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:i,validator:o,errorText:n,defaultValue:s}=e,r=(0,Si.Z)((()=>{i.errorText=n}),sE);return(e,n,a,l)=>{r.cancel(),(l||s!==a)&&(o(a)?(this.editor.execute(t,{value:a,batch:this._undoStepBatch}),i.errorText=null):r())}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function lE(e,t){const{viewElement:i,defaultValue:o,modelAttribute:n,styleName:s,reduceBoxSides:r=!1}=t;e.for("upcast").attributeToAttribute({view:{name:i,styles:{[s]:/[\s\S]+/}},model:{key:n,value:e=>{const t=e.getNormalizedStyle(s),i=r?uE(t):t;if(o!==i)return i}}})}function cE(e,t,i,o){e.for("upcast").add((e=>e.on("element:"+t,((e,t,n)=>{if(!t.modelRange)return;const s=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter((e=>t.viewItem.hasStyle(e)));if(!s.length)return;const r={styles:s};if(!n.consumable.test(t.viewItem,r))return;const a=[...t.modelRange.getItems({shallow:!0})].pop();n.consumable.consume(t.viewItem,r);const l={style:t.viewItem.getNormalizedStyle("border-style"),color:t.viewItem.getNormalizedStyle("border-color"),width:t.viewItem.getNormalizedStyle("border-width")},c={style:uE(l.style),color:uE(l.color),width:uE(l.width)};c.style!==o.style&&n.writer.setAttribute(i.style,c.style,a),c.color!==o.color&&n.writer.setAttribute(i.color,c.color,a),c.width!==o.width&&n.writer.setAttribute(i.width,c.width,a)}))))}function dE(e,{modelElement:t,modelAttribute:i,styleName:o}){e.for("downcast").attributeToAttribute({model:{name:t,key:i},view:e=>({key:"style",value:{[o]:e}})})}function hE(e,{modelAttribute:t,styleName:i}){e.for("downcast").add((e=>e.on(`attribute:${t}:table`,((e,t,o)=>{const{item:n,attributeNewValue:s}=t,{mapper:r,writer:a}=o;if(!o.consumable.consume(t.item,e.name))return;const l=[...r.toViewElement(n).getChildren()].find((e=>e.is("element","table")));s?a.setStyle(i,s,l):a.removeStyle(i,l)}))))}function uE(e){if(!e)return;const t=["top","right","bottom","left"].map((t=>e[t])).reduce(((e,t)=>e==t?e:null));return t||e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class mE extends b.Z{constructor(e,t,i){super(e),this.attributeName=t,this._defaultValue=i}refresh(){const e=this.editor,t=Ak(e.model.document.selection);this.isEnabled=!!t.length,this.value=this._getSingleValue(t)}execute(e={}){const{value:t,batch:i}=e,o=this.editor.model,n=Ak(o.document.selection),s=this._getValueToSet(t);o.enqueueChange(i||"default",(e=>{s?n.forEach((t=>e.setAttribute(this.attributeName,s,t))):n.forEach((t=>e.removeAttribute(this.attributeName,t)))}))}_getAttribute(e){if(!e)return;const t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const t=this._getAttribute(e[0]),i=e.every((e=>this._getAttribute(e)===t));return i?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class gE extends mE{constructor(e,t){super(e,"tableCellPadding",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=oE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class pE extends mE{constructor(e,t){super(e,"tableCellWidth",t)}_getValueToSet(e){if(e=oE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class fE extends mE{constructor(e,t){super(e,"tableCellHeight",t)}_getValueToSet(e){return e=oE(e,"px"),e===this._defaultValue?null:e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class wE extends mE{constructor(e,t){super(e,"tableCellBackgroundColor",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class bE extends mE{constructor(e,t){super(e,"tableCellVerticalAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class _E extends mE{constructor(e,t){super(e,"tableCellHorizontalAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class vE extends mE{constructor(e,t){super(e,"tableCellBorderStyle",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class yE extends mE{constructor(e,t){super(e,"tableCellBorderColor",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class CE extends mE{constructor(e,t){super(e,"tableCellBorderWidth",t)}_getAttribute(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=oE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const kE=/^(top|middle|bottom)$/,xE=/^(left|center|right|justify)$/;class VE extends a.Z{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[Hx]}init(){const e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});const o=nE(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection});e.data.addStyleProcessorRules(jh),EE(t,i,{color:o.borderColor,style:o.borderStyle,width:o.borderWidth}),e.commands.add("tableCellBorderStyle",new vE(e,o.borderStyle)),e.commands.add("tableCellBorderColor",new yE(e,o.borderColor)),e.commands.add("tableCellBorderWidth",new CE(e,o.borderWidth)),SE(t,i,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:o.width}),e.commands.add("tableCellWidth",new pE(e,o.width)),SE(t,i,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:o.height}),e.commands.add("tableCellHeight",new fE(e,o.height)),e.data.addStyleProcessorRules(ru),SE(t,i,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:o.padding}),e.commands.add("tableCellPadding",new gE(e,o.padding)),e.data.addStyleProcessorRules(qh),SE(t,i,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:o.backgroundColor}),e.commands.add("tableCellBackgroundColor",new wE(e,o.backgroundColor)),AE(t,i,o.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new _E(e,o.horizontalAlignment)),PE(t,i,o.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new bE(e,o.verticalAlignment))}}function EE(e,t,i){const o={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};e.extend("tableCell",{allowAttributes:Object.values(o)}),cE(t,"td",o,i),cE(t,"th",o,i),dE(t,{modelElement:"tableCell",modelAttribute:o.style,styleName:"border-style"}),dE(t,{modelElement:"tableCell",modelAttribute:o.color,styleName:"border-color"}),dE(t,{modelElement:"tableCell",modelAttribute:o.width,styleName:"border-width"})}function AE(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:e=>({key:"style",value:{"text-align":e}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":xE}},model:{key:"tableCellHorizontalAlignment",value:e=>{const t=e.getStyle("text-align");return t===i?null:t}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:xE}},model:{key:"tableCellHorizontalAlignment",value:e=>{const t=e.getAttribute("align");return t===i?null:t}}})}function PE(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:e=>({key:"style",value:{"vertical-align":e}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":kE}},model:{key:"tableCellVerticalAlignment",value:e=>{const t=e.getStyle("vertical-align");return t===i?null:t}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:kE}},model:{key:"tableCellVerticalAlignment",value:e=>{const t=e.getAttribute("valign");return t===i?null:t}}})}function SE(e,t,i){const{modelAttribute:o}=i;e.extend("tableCell",{allowAttributes:[o]}),lE(t,{viewElement:/^(td|th)$/,...i}),dE(t,{modelElement:"tableCell",...i})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class TE extends a.Z{static get pluginName(){return"TableCellProperties"}static get requires(){return[VE,aE]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class NE extends b.Z{constructor(e,t,i){super(e),this.attributeName=t,this._defaultValue=i}refresh(){const e=this.editor,t=e.model.document.selection,i=t.getFirstPosition().findAncestor("table");this.isEnabled=!!i,this.value=this._getValue(i)}execute(e={}){const t=this.editor.model,i=t.document.selection,{value:o,batch:n}=e,s=i.getFirstPosition().findAncestor("table"),r=this._getValueToSet(o);t.enqueueChange(n||"default",(e=>{r?e.setAttribute(this.attributeName,r,s):e.removeAttribute(this.attributeName,s)}))}_getValue(e){if(!e)return;const t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class IE extends NE{constructor(e,t){super(e,"tableBackgroundColor",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class DE extends NE{constructor(e,t){super(e,"tableBorderColor",t)}_getValue(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class RE extends NE{constructor(e,t){super(e,"tableBorderStyle",t)}_getValue(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class BE extends NE{constructor(e,t){super(e,"tableBorderWidth",t)}_getValue(e){if(!e)return;const t=iE(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0}_getValueToSet(e){if(e=oE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class ME extends NE{constructor(e,t){super(e,"tableWidth",t)}_getValueToSet(e){if(e=oE(e,"px"),e!==this._defaultValue)return e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class OE extends NE{constructor(e,t){super(e,"tableHeight",t)}_getValueToSet(e){return e=oE(e,"px"),e===this._defaultValue?null:e}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class LE extends NE{constructor(e,t){super(e,"tableAlignment",t)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const $E=/^(left|center|right)$/,FE=/^(left|none|right)$/;class zE extends a.Z{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[Hx]}init(){const e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});const o=nE(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});e.data.addStyleProcessorRules(jh),ZE(t,i,{color:o.borderColor,style:o.borderStyle,width:o.borderWidth}),e.commands.add("tableBorderColor",new DE(e,o.borderColor)),e.commands.add("tableBorderStyle",new RE(e,o.borderStyle)),e.commands.add("tableBorderWidth",new BE(e,o.borderWidth)),HE(t,i,o.alignment),e.commands.add("tableAlignment",new LE(e,o.alignment)),WE(t,i,{modelAttribute:"tableWidth",styleName:"width",defaultValue:o.width}),e.commands.add("tableWidth",new ME(e,o.width)),WE(t,i,{modelAttribute:"tableHeight",styleName:"height",defaultValue:o.height}),e.commands.add("tableHeight",new OE(e,o.height)),e.data.addStyleProcessorRules(qh),UE(t,i,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:o.backgroundColor}),e.commands.add("tableBackgroundColor",new IE(e,o.backgroundColor))}}function ZE(e,t,i){const o={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};e.extend("table",{allowAttributes:Object.values(o)}),cE(t,"table",o,i),hE(t,{modelAttribute:o.color,styleName:"border-color"}),hE(t,{modelAttribute:o.style,styleName:"border-style"}),hE(t,{modelAttribute:o.width,styleName:"border-width"})}function HE(e,t,i){e.extend("table",{allowAttributes:["tableAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:e=>({key:"style",value:{float:"center"===e?"none":e}}),converterPriority:"high"}),t.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:FE}},model:{key:"tableAlignment",value:e=>{let t=e.getStyle("float");return"none"===t&&(t="center"),t===i?null:t}}}).attributeToAttribute({view:{attributes:{align:$E}},model:{name:"table",key:"tableAlignment",value:e=>{const t=e.getAttribute("align");return t===i?null:t}}})}function UE(e,t,i){const{modelAttribute:o}=i;e.extend("table",{allowAttributes:[o]}),lE(t,{viewElement:"table",...i}),hE(t,i)}function WE(e,t,i){const{modelAttribute:o}=i;e.extend("table",{allowAttributes:[o]}),lE(t,{viewElement:/^(table|figure)$/,...i}),dE(t,{modelElement:"table",...i})}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const qE={left:sl.objectLeft,center:sl.objectCenter,right:sl.objectRight};class GE extends cl.Z{constructor(e,t){super(e),this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=t;const{borderStyleDropdown:i,borderWidthInput:o,borderColorInput:n,borderRowLabel:s}=this._createBorderFields(),{backgroundRowLabel:r,backgroundInput:a}=this._createBackgroundFields(),{widthInput:l,operatorLabel:c,heightInput:d,dimensionsLabel:h}=this._createDimensionFields(),{alignmentToolbar:u,alignmentLabel:m}=this._createAlignmentFields();this.focusTracker=new eo,this.keystrokes=new to,this.children=this.createCollection(),this.borderStyleDropdown=i,this.borderWidthInput=o,this.borderColorInput=n,this.backgroundInput=a,this.widthInput=l,this.heightInput=d,this.alignmentToolbar=u;const{saveButtonView:g,cancelButtonView:p}=this._createActionButtons();this.saveButtonView=g,this.cancelButtonView=p,this._focusables=new Ll.Z,this._focusCycler=new ql({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Nc(e,{label:this.t("Table properties")})),this.children.add(new zV(e,{labelView:s,children:[s,i,n,o],class:"ck-table-form__border-row"})),this.children.add(new zV(e,{labelView:r,children:[r,a],class:"ck-table-form__background-row"})),this.children.add(new zV(e,{children:[new zV(e,{labelView:h,children:[h,l,c,d],class:"ck-table-form__dimensions-row"}),new zV(e,{labelView:m,children:[m,u],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new zV(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),Ml({view:this}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=LV({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color}),o=this.locale,n=this.t,s=new Ac(o);s.text=n("Border");const r=SV(this.t),a=new Rc(o,Mc);a.set({label:n("Style"),class:"ck-table-form__border-style"}),a.fieldView.buttonView.set({isOn:!1,withText:!0,tooltip:n("Style")}),a.fieldView.buttonView.bind("label").to(this,"borderStyle",(e=>r[e||"none"])),a.fieldView.on("execute",(e=>{this.borderStyle=e.source._borderStyleValue})),a.bind("isEmpty").to(this,"borderStyle",(e=>!e)),yc(a.fieldView,BV(this,t.style));const l=new Rc(o,Bc);l.set({label:n("Width"),class:"ck-table-form__border-width"}),l.fieldView.bind("value").to(this,"borderWidth"),l.bind("isEnabled").to(this,"borderStyle",jE),l.fieldView.on("input",(()=>{this.borderWidth=l.fieldView.element.value}));const c=new Rc(o,i);return c.set({label:n("Color"),class:"ck-table-form__border-color"}),c.fieldView.bind("value").to(this,"borderColor"),c.bind("isEnabled").to(this,"borderStyle",jE),c.fieldView.on("input",(()=>{this.borderColor=c.fieldView.value})),this.on("change:borderStyle",((e,i,o,n)=>{jE(o)||(this.borderColor="",this.borderWidth=""),jE(n)||(this.borderColor=t.color,this.borderWidth=t.width)})),{borderRowLabel:s,borderStyleDropdown:a,borderColorInput:c,borderWidthInput:l}}_createBackgroundFields(){const e=this.locale,t=this.t,i=new Ac(e);i.text=t("Background");const o=LV({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor}),n=new Rc(e,o);return n.set({label:t("Color"),class:"ck-table-properties-form__background"}),n.fieldView.bind("value").to(this,"backgroundColor"),n.fieldView.on("input",(()=>{this.backgroundColor=n.fieldView.value})),{backgroundRowLabel:i,backgroundInput:n}}_createDimensionFields(){const e=this.locale,t=this.t,i=new Ac(e);i.text=t("Dimensions");const o=new Rc(e,Bc);o.set({label:t("Width"),class:"ck-table-form__dimensions-row__width"}),o.fieldView.bind("value").to(this,"width"),o.fieldView.on("input",(()=>{this.width=o.fieldView.element.value}));const n=new cl.Z(e);n.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const s=new Rc(e,Bc);return s.set({label:t("Height"),class:"ck-table-form__dimensions-row__height"}),s.fieldView.bind("value").to(this,"height"),s.fieldView.on("input",(()=>{this.height=s.fieldView.element.value})),{dimensionsLabel:i,widthInput:o,operatorLabel:n,heightInput:s}}_createAlignmentFields(){const e=this.locale,t=this.t,i=new Ac(e);i.text=t("Alignment");const o=new uc(e);return o.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),MV({view:this,icons:qE,toolbar:o,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:i,alignmentToolbar:o}}_createActionButtons(){const e=this.locale,t=this.t,i=new l.Z(e),o=new l.Z(e),n=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return i.set({label:t("Save"),icon:sl.check,class:"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(n,"errorText",((...e)=>e.every((e=>!e)))),o.set({label:t("Cancel"),icon:sl.cancel,class:"ck-button-cancel",withText:!0}),o.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:o}}get _alignmentLabels(){const e=this.locale,t=this.t,i=t("Align table to the left"),o=t("Center table"),n=t("Align table to the right");return"rtl"===e.uiLanguageDirection?{right:n,center:o,left:i}:{left:i,center:o,right:n}}}function jE(e){return"none"!==e}var KE='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
const JE=500,YE={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class QE extends a.Z{static get requires(){return[jc]}static get pluginName(){return"TablePropertiesUI"}constructor(e){super(e),e.config.define("table.tableProperties",{borderColors:OV,backgroundColors:OV})}init(){const e=this.editor,t=e.t;this._defaultTableProperties=nE(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(jc),this.view=this._createPropertiesView(),this._undoStepBatch=null,e.ui.componentFactory.add("tableProperties",(i=>{const o=new l.Z(i);o.set({label:t("Table properties"),icon:KE,tooltip:!0}),this.listenTo(o,"execute",(()=>this._showView()));const n=Object.values(YE).map((t=>e.commands.get(t)));return o.bind("isEnabled").toMany(n,"isEnabled",((...e)=>e.some((e=>e)))),o}))}destroy(){super.destroy(),this.view.destroy()}_createPropertiesView(){const e=this.editor,t=e.config.get("table.tableProperties"),i=Zl(t.borderColors),o=zl(e.locale,i),n=Zl(t.backgroundColors),s=zl(e.locale,n),r=new GE(e.locale,{borderColors:o,backgroundColors:s,defaultTableProperties:this._defaultTableProperties}),a=e.t;r.render(),this.listenTo(r,"submit",(()=>{this._hideView()})),this.listenTo(r,"cancel",(()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()})),r.keystrokes.set("Esc",((e,t)=>{this._hideView(),t()})),Rl({emitter:r,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const l=TV(a),c=NV(a);return r.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle",this._defaultTableProperties.borderStyle)),r.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:r.borderColorInput,commandName:"tableBorderColor",errorText:l,validator:IV,defaultValue:this._defaultTableProperties.borderColor})),r.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:r.borderWidthInput,commandName:"tableBorderWidth",errorText:c,validator:RV,defaultValue:this._defaultTableProperties.borderWidth})),r.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:r.backgroundInput,commandName:"tableBackgroundColor",errorText:l,validator:IV,defaultValue:this._defaultTableProperties.backgroundColor})),r.on("change:width",this._getValidatedPropertyChangeCallback({viewField:r.widthInput,commandName:"tableWidth",errorText:c,validator:DV,defaultValue:this._defaultTableProperties.width})),r.on("change:height",this._getValidatedPropertyChangeCallback({viewField:r.heightInput,commandName:"tableHeight",errorText:c,validator:DV,defaultValue:this._defaultTableProperties.height})),r.on("change:alignment",this._getPropertyChangeCallback("tableAlignment",this._defaultTableProperties.alignment)),r}_fillViewFormFromCommandValues(){const e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(YE).map((([t,i])=>{const o=this._defaultTableProperties[t]||"";return[t,e.get(i).value||o]})).forEach((([e,i])=>{("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&this.view.set(e,i)}))}_showView(){const e=this.editor;this.listenTo(e.ui,"update",(()=>{this._updateView()})),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:YV(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,t=e.editing.view.document;qV(t.selection)?this._isViewVisible&&JV(e,"table"):this._hideView()}get _isViewVisible(){return this._balloon.visibleView===this.view}get _isViewInBalloon(){return this._balloon.hasView(this.view)}_getPropertyChangeCallback(e,t){return(i,o,n,s)=>{(s||t!==n)&&this.editor.execute(e,{value:n,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:t,viewField:i,validator:o,errorText:n,defaultValue:s}=e,r=(0,Si.Z)((()=>{i.errorText=n}),JE);return(e,n,a,l)=>{r.cancel(),(l||s!==a)&&(o(a)?(this.editor.execute(t,{value:a,batch:this._undoStepBatch}),i.errorText=null):r())}}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class XE extends a.Z{static get pluginName(){return"TableProperties"}static get requires(){return[zE,QE]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class eA extends a.Z{static get requires(){return[Jf]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,i=e.plugins.get(Jf),o=e.config.get("table.contentToolbar"),n=e.config.get("table.tableToolbar");o&&i.register("tableContent",{ariaLabel:t("Table toolbar"),items:o,getRelatedElement:qV}),n&&i.register("table",{ariaLabel:t("Table toolbar"),items:n,getRelatedElement:WV})}}var tA={name:"CustomCKEditor",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1},tagName:{type:String,default:"div"},placeholder:{type:String,default:""},lang:{type:String,default:null},shouldNotGroupWhenFull:{type:Boolean,default:!0},toolbarItems:{type:Array,default:()=>["heading","|","bold","italic","underline","strikethrough","code","codeBlock","subscript","superscript","removeFormat","selectAll","specialCharacters","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","todoList","alignment","|","outdent","indent","|","link","uploadImage","insertTable","mediaEmbed","findAndReplace","|","undo","redo","|","sourceEditing","addBreezeMedias","|","fullScreen"]},imageToolbarItems:{type:Array,default:()=>["imageStyle:inline","imageStyle:block","imageStyle:side","|","toggleImageCaption","imageTextAlternative","|","resizeImage:50","resizeImage:75","resizeImage:original"]},tableContentToolbar:{type:Array,default:()=>["toggleTableCaption","tableColumn","tableRow","mergeTableCells"]}},emits:["update:modelValue","ready","focus","blur","destroy"],data(){return{editor:Ym,editorConfig:{language:this.lang||this.$i18n.locale,placeholder:this.placeholder,plugins:[Ap,_l,hu,_u,Iu,im,Lu,Eu,Uu,Ju,ym,Kf,qw,eb,$b,Fb,u_,db,jv,Iy,fC.Z,od,gV,eA,VV,XE,TE,pC,w_,Fd,jm,Wp,zf,gf,_w,Ky,CC,fp,SC,LC,UC,h,p],toolbar:{items:this.toolbarItems,shouldNotGroupWhenFull:this.shouldNotGroupWhenFull},image:{toolbar:this.imageToolbarItems,resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]},table:{contentToolbar:this.tableContentToolbar}},mediaPickerVisible:!1,STORAGE_API_BASE_URL:f.STORAGE_API_BASE_URL,BASE_URL_MUSTACHE:"{{BASE_URL}}"}},created(){document.addEventListener("add-breeze-medias",this.onAddMediaBtnClick)},beforeUnmount(){document.removeEventListener("add-breeze-medias",this.onAddMediaBtnClick)},methods:{onAddMediaBtnClick(){this.mediaPickerVisible=!0},onMediasSelected(e){if(e){let t=this.modelValue||"";e.forEach((e=>{e.type==w.Tr.IMAGE.value&&(t+=`<p><img src="${this.resolveMediaLink(e.link)}" /></p>`),e.type==w.Tr.DOCUMENT.value&&(t+=`<p><a href="${this.resolveMediaLink(e.link)}">${e.name}</a></p>`),e.type==w.Tr.AUDIO.value&&(t+=`<p style="text-align:center">[audio]${e.name}[/audio]</p>`),e.type==w.Tr.VIDEO.value&&(t+=`<p style="text-align:center">[video]${e.name}[/video]</p>`),e.type==w.Tr.OTHERS.value&&(t+=`<p><a href="${this.resolveMediaLink(e.link)}">${e.name}</a></p>`)})),this.$emit("update:modelValue",t?.replace(new RegExp(f.STORAGE_API_BASE_URL,"g"),this.BASE_URL_MUSTACHE))}this.mediaPickerVisible=!1}}},iA=i(83744);const oA=(0,iA.Z)(tA,[["render",s],["__scopeId","data-v-64323a7e"]]);var nA=oA},30780:function(e,t,i){"use strict";i.d(t,{Z:function(){return l}});var o=i(82234);function n(e,t,i,n,s,r){const a=(0,o.resolveComponent)("el-col"),l=(0,o.resolveComponent)("el-button"),c=(0,o.resolveComponent)("el-row"),d=(0,o.resolveComponent)("el-input"),h=(0,o.resolveComponent)("el-scrollbar");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"features",style:(0,o.normalizeStyle)(`background: ${e.pickByTheme("whitesmoke","dimgray")}`)},[(0,o.createVNode)(c,{class:"features-header mb-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a,{span:16,style:{"justify-content":"left"}},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("small",null,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(i.title),1)])])),_:1}),(0,o.createVNode)(a,{span:8,style:{"justify-content":"right"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{size:"default",type:"primary",disabled:i.disabled||i.addBtnDisabled,onClick:r.addFeature},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("add")),1)])),_:1},8,["disabled","onClick"])])),_:1})])),_:1}),(0,o.createVNode)(c,{class:"features-body mt-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a,{span:24},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{"max-height":"275px"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.list,((t,n)=>((0,o.openBlock)(),(0,o.createBlock)(c,{key:"feature_"+n,gutter:5,class:"mb-5"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{modelValue:t.name,"onUpdate:modelValue":e=>t.name=e,type:"text",size:"default",placeholder:i.namePlaceholder||e.$t("name"),readonly:i.nameReadonly||i.disabled},null,8,["modelValue","onUpdate:modelValue","placeholder","readonly"])])),_:2},1024),(0,o.createVNode)(a,{span:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,type:"text",size:"default",placeholder:i.valuePlaceholder||e.$t("value"),readonly:i.valueReadonly||i.disabled},null,8,["modelValue","onUpdate:modelValue","placeholder","readonly"])])),_:2},1024),(0,o.createVNode)(a,{span:4},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{type:"danger",size:"default",icon:"delete",disabled:i.disabled||i.deleteBtnDisabled,style:{width:"100%"},onClick:e=>r.removeFeature(n)},null,8,["disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),(0,o.createVNode)(c,{gutter:10,class:"features-footer"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a,{span:24},{default:(0,o.withCtx)((()=>[(0,o.renderSlot)(e.$slots,"features-footer",{},void 0,!0)])),_:3})])),_:3})],4)}i(57658);var s={props:{title:{type:String,default:""},list:{type:Array,default:()=>[]},namePlaceholder:{type:String,default:null},valuePlaceholder:{type:String,default:null},nameReadonly:{type:Boolean,default:!1},valueReadonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},addBtnDisabled:{type:Boolean,default:!1},deleteBtnDisabled:{type:Boolean,default:!1}},emits:["onFeatureAdd","onFeatureRemove"],methods:{addFeature(){this.$emit("onFeatureAdd"),this.list.push({name:"",value:""})},removeFeature(e){this.$emit("onFeatureRemove",e,this.list[e]),this.list.splice(e,1)}}},r=i(83744);const a=(0,r.Z)(s,[["render",n],["__scopeId","data-v-6c94250c"]]);var l=a},71561:function(e,t,i){"use strict";i.d(t,{Z:function(){return y}});var o=i(89948),n=i(82234),s=i(75979);const r=e=>((0,n.pushScopeId)("data-v-725fb0c0"),e=e(),(0,n.popScopeId)(),e),a={class:"picker-container"},l={class:"picker-content"},c={key:0},d={class:"cropper-container"},h={class:"vertical-buttons"},u=r((()=>(0,n.createElementVNode)("br",null,null,-1))),m={class:"preview-container"},g={key:1,class:"text-center"},p={class:"picker-action"},f={class:"dialog-footer"},w={name:"ImageEditor",inheritAttrs:!1};var b=Object.assign(w,{props:{cropperAutoZoom:{type:Boolean,default:!0},cropperScalable:{type:Boolean,default:!1},cropperMovable:{type:Boolean,default:!1},cropperRatio:{type:Number,default:null},roundPreview:{type:Boolean,default:!1},previewWidth:{type:Number,default:null},previewHeight:{type:Number,default:120},src:{type:String,default:null}},emits:["croppedFileChange","save","cancel"],setup(e,{emit:t}){const i=e,{t:r}=(0,o.useI18n)(),w=(0,n.ref)(null),b=(0,n.ref)({coordinates:null,image:null}),_=(0,n.computed)((()=>i.previewWidth?i.previewWidth:b.value&&b.value.coordinates?b.value.coordinates.width/b.value.coordinates.height*i.previewHeight:i.previewHeight)),v=({coordinates:e,image:i})=>{b.value={coordinates:e,image:i};const{canvas:o}=w.value.getResult();t("croppedFileChange",b.value,o.toDataURL())},y=(e,t)=>{w.value.customImageTransforms.rotate%180!==0?w.value.flip(!e,!t):w.value.flip(e,t)},C=e=>{w.value.rotate(e)},k=()=>{const{canvas:e}=w.value.getResult();t("save",b.value,e.toDataURL())};return(e,o)=>{const x=(0,n.resolveComponent)("font-awesome-icon"),V=(0,n.resolveComponent)("n-alert"),E=(0,n.resolveComponent)("n-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",a,[(0,n.createElementVNode)("div",l,[i.src?((0,n.openBlock)(),(0,n.createElementBlock)("div",c,[(0,n.createElementVNode)("div",d,[(0,n.createVNode)((0,n.unref)(s.Cropper),{ref_key:"cropper",ref:w,class:"cropper",src:i.src,"auto-zoom":i.cropperAutoZoom,"stencil-props":{movable:i.cropperMovable,scalable:i.cropperScalable,aspectRatio:i.cropperRatio,previewClass:i.roundPreview?"circle-stencil-preview":""},"image-restriction":"stencil","background-class":"cropper-background","stencil-component":i.roundPreview?(0,n.unref)(s.CircleStencil):(0,n.unref)(s.RectangleStencil),onChange:v},null,8,["src","auto-zoom","stencil-props","stencil-component"]),(0,n.createElementVNode)("div",h,[(0,n.createElementVNode)("div",{class:"square-button",title:"Flip Horizontal",onClick:o[0]||(o[0]=e=>y(!0,!1))},[(0,n.createVNode)(x,{icon:["fas","arrows-alt-h"],size:"1x",style:{color:"white"}})]),(0,n.createElementVNode)("div",{class:"square-button",title:"Flip Vertical",onClick:o[1]||(o[1]=e=>y(!1,!0))},[(0,n.createVNode)(x,{icon:["fas","arrows-alt-v"],size:"1x",style:{color:"white"}})]),(0,n.createElementVNode)("div",{class:"square-button",title:"Rotate Clockwise",onClick:o[2]||(o[2]=e=>C(90))},[(0,n.createVNode)(x,{icon:["fas","redo"],size:"1x",style:{color:"white"}})]),(0,n.createElementVNode)("div",{class:"square-button",title:"Rotate Counter-Clockwise",onClick:o[3]||(o[3]=e=>C(-90))},[(0,n.createVNode)(x,{icon:["fas","undo"],size:"1x",style:{color:"white"}})])])]),u,(0,n.createElementVNode)("div",m,[(0,n.createVNode)((0,n.unref)(s.Preview),{ref:"preview",class:(0,n.normalizeClass)(["preview",{round:i.roundPreview}]),image:(0,n.unref)(b).image,width:(0,n.unref)(_),height:i.previewHeight,coordinates:(0,n.unref)(b).coordinates},null,8,["image","width","height","class","coordinates"])])])):((0,n.openBlock)(),(0,n.createElementBlock)("div",g,[(0,n.createVNode)(V,{title:(0,n.unref)(r)("noSrcFileWarning"),type:"warning","show-icon":""},null,8,["title"])])),(0,n.createElementVNode)("div",p,[(0,n.createElementVNode)("span",f,[(0,n.createVNode)(E,{onClick:o[4]||(o[4]=e=>t("cancel"))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)("close")),1)])),_:1}),i.src?((0,n.openBlock)(),(0,n.createBlock)(E,{key:0,type:"primary",onClick:o[5]||(o[5]=e=>k())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(r)("save")),1)])),_:1})):(0,n.createCommentVNode)("",!0)])])])])}}}),_=i(83744);const v=(0,_.Z)(b,[["__scopeId","data-v-725fb0c0"]]);var y=v},68716:function(e,t,i){"use strict";i.d(t,{Z:function(){return ce}});var o=i(82234);function n(e,t,i,n,s,r){const a=(0,o.resolveComponent)("el-button"),l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-input"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card");return(0,o.openBlock)(),(0,o.createBlock)(h,null,{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.items,((n,h)=>((0,o.openBlock)(),(0,o.createBlock)(d,{key:h,gutter:10,class:"mb-10 urls-container"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:2},{default:(0,o.withCtx)((()=>[i.multiple?((0,o.openBlock)(),(0,o.createBlock)(a,{key:0,type:"primary",disabled:0===h&&i.multiple&&i.limit>0&&s.items.length>=i.limit,icon:0===h?"plus":"minus",onClick:e=>r.manageItems(h)},null,8,["disabled","icon","onClick"])):(0,o.createCommentVNode)("",!0)])),_:2},1024),(0,o.createVNode)(l,{span:20},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{modelValue:n.url,"onUpdate:modelValue":e=>n.url=e,placeholder:e.$t("insertLink"),style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1024),(0,o.createVNode)(l,{span:2},{default:(0,o.withCtx)((()=>[0===h?((0,o.openBlock)(),(0,o.createBlock)(a,{key:0,type:"primary",disabled:!r.isUrlsValid,onClick:t[0]||(t[0]=e=>r.validate())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("validate")),1)])),_:1},8,["disabled"])):(0,o.createCommentVNode)("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})}i(57658);var s=i(14340),r={name:"AddFromAnUrl",props:{multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},acceptImages:{type:Boolean,default:!0},acceptVideos:{type:Boolean,default:!0},acceptAudios:{type:Boolean,default:!0},acceptDocuments:{type:Boolean,default:!0},acceptOtherTypes:{type:Boolean,default:!0}},emits:["validate"],data(){return{items:[{url:"http://"}],docExtList:["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],vidExtList:["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"],audExtList:["MP3","WAV","M4A","WMA","AAC","FLAC"]}},computed:{isUrlsValid(){const e=this.items.filter((e=>e.url&&this.$validator.isURL(e.url)));return e.length===this.items.length}},methods:{manageItems(e){e>0?this.items.splice(e,1):this.items.push({url:"http://"})},getFileTypeByUrl(e){const t=e.split(".").pop();if(t){if(this.docExtList.includes(t.toUpperCase()))return s.Tr.DOCUMENT.value;if(this.vidExtList.includes(t.toUpperCase()))return s.Tr.VIDEO.value;if(this.imgExtList.includes(t.toUpperCase()))return s.Tr.IMAGE.value;if(this.audExtList.includes(t.toUpperCase()))return s.Tr.AUDIO.value}return s.Tr.OTHERS.value},validate(){if(this.isUrlsValid){let e=!0;const t=[];for(let i=0;i<this.items.length;i++){const o=this.getFileTypeByUrl(this.items[i].url),n=!this.acceptImages&&o==s.Tr.IMAGE.value||!this.acceptVideos&&o==s.Tr.VIDEO.value||!this.acceptAudios&&o==s.Tr.AUDIO.value||!this.acceptDocuments&&o==s.Tr.DOCUMENT.value||!this.acceptOtherTypes&&o==s.Tr.OTHERS.value;n&&this.$message.error(this.$t("fileFormatNotAllowed",[this.items[i].url])),e&&n&&(e=!1),t.push(this.items[i].url)}if(!e)return;this.$emit("validate",this.multiple?t:t[0],this.multiple)}}}},a=i(83744);const l=(0,a.Z)(r,[["render",n],["__scopeId","data-v-47880409"]]);var c=l,d=i(71561),h=i(39494);const u={class:"text-left"},m={class:"text-right"},g={key:0,class:"mt-5 text-center"},p={class:"item-selector"},f={class:"image-slot"},w={key:1,class:"item-doc"},b={class:"item-doc-center"},_={class:"item-doc-footer"},v={key:2,class:"item-aud"},y={class:"item-aud-center"},C={class:"item-aud-footer"},k={key:3,class:"item-vid"},x={class:"item-vid-center"},V={class:"item-vid-footer"},E={key:4,class:"item-oth"},A={class:"item-oth-center"},P={class:"item-oth-footer"},S={class:"text-center"},T={key:1,class:"no-medias-container mt-5"},N={class:"text-center"},I={class:"text-left item-actions-container"},D={class:"text-center"},R={id:"music",preload:"all",autoplay:"",controls:"",style:{width:"100%"}},B=["src"],M={id:"video",autoplay:"",controls:"",style:{width:"100%"}},O=["src"],L={class:"dialog-footer"};function $(e,t,i,n,s,r){const a=(0,o.resolveComponent)("el-option"),l=(0,o.resolveComponent)("el-select"),c=(0,o.resolveComponent)("el-input"),$=(0,o.resolveComponent)("el-col"),F=(0,o.resolveComponent)("el-button"),z=(0,o.resolveComponent)("el-row"),Z=(0,o.resolveComponent)("el-card"),H=(0,o.resolveComponent)("loading"),U=(0,o.resolveComponent)("el-icon"),W=(0,o.resolveComponent)("el-checkbox"),q=(0,o.resolveComponent)("Picture"),G=(0,o.resolveComponent)("el-image"),j=(0,o.resolveComponent)("font-awesome-icon"),K=(0,o.resolveComponent)("infinite-loading"),J=h.Z,Y=(0,o.resolveComponent)("el-divider"),Q=(0,o.resolveComponent)("el-table-column"),X=(0,o.resolveComponent)("el-table"),ee=(0,o.resolveComponent)("el-image-viewer"),te=(0,o.resolveComponent)("el-dialog"),ie=d.Z;return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(Z,{shadow:"never",class:"mb-10 header-card"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(z,{align:"middle"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)($,{span:16},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",u,[(0,o.createVNode)(l,{modelValue:s.mediaType,"onUpdate:modelValue":t[0]||(t[0]=e=>s.mediaType=e),placeholder:e.$t("mediaType"),style:{width:"165px"},class:"mr-10"},{default:(0,o.withCtx)((()=>[i.showImages&&i.showVideos&&i.showAudios&&i.showDocuments&&i.showOtherTypes?((0,o.openBlock)(),(0,o.createBlock)(a,{key:0,label:e.$t("allMedias"),value:0},null,8,["label"])):(0,o.createCommentVNode)("",!0),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.mediaTypes,(e=>((0,o.openBlock)(),(0,o.createBlock)(a,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder"]),(0,o.createVNode)(l,{modelValue:s.mediaDate,"onUpdate:modelValue":t[1]||(t[1]=e=>s.mediaDate=e),style:{width:"165px"},class:"mr-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a,{label:e.$t("allDates"),value:0},null,8,["label"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.mediaDates,(e=>((0,o.openBlock)(),(0,o.createBlock)(a,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,o.createVNode)(c,{modelValue:s.mediaSearch,"onUpdate:modelValue":t[2]||(t[2]=e=>s.mediaSearch=e),class:"mr-10",style:{width:"185px"},placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])])),_:1}),(0,o.createVNode)($,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",m,[(0,o.createVNode)(F,{size:"default",icon:"refresh-right",onClick:t[3]||(t[3]=e=>r.reset())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("reload")),1)])),_:1}),(0,o.createVNode)(F,{class:"ml-10",size:"default",type:"primary",icon:"check",disabled:!s.selectedMedias.length,onClick:t[4]||(t[4]=e=>r.validate())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("validateSelection")),1)])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1}),(0,o.createVNode)(z,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)($,{span:16},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(Z,{shadow:"never",class:"medias-card"},{default:(0,o.withCtx)((()=>[s.isLoading?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createVNode)(U,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(H)])),_:1},8,["color"])])):((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[r.filteredMedias&&r.filteredMedias.length>0?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(z,{gutter:10,class:"mt-5"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(r.filteredMedias,((t,i)=>((0,o.openBlock)(),(0,o.createBlock)($,{key:i,span:4,class:"mb-10 item-container",onClick:e=>r.updateSelectedMedias(t,i)},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(W,{size:"default","model-value":s.selectedMedias.findIndex((e=>e.id===t.id))>-1,onChange:e=>r.updateSelectedMedias(t,i)},null,8,["model-value","onChange"])]),t.type==s.MediaTypes.IMAGE.value?((0,o.openBlock)(),(0,o.createBlock)(G,{key:0,class:"item-img",src:e.resolveMediaLink(t.link),fit:"cover"},{error:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",f,[(0,o.createVNode)(U,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q)])),_:1})])])),_:2},1032,["src"])):t.type==s.MediaTypes.DOCUMENT.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",w,[(0,o.createElementVNode)("div",b,[(0,o.createVNode)(j,{icon:"file",class:"item-doc-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",_,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])])):t.type==s.MediaTypes.AUDIO.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createElementVNode)("div",y,[(0,o.createVNode)(j,{icon:"music",class:"item-aud-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",C,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])])):t.type==s.MediaTypes.VIDEO.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",k,[(0,o.createElementVNode)("div",x,[(0,o.createVNode)(j,{icon:"video",class:"item-vid-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",V,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",E,[(0,o.createElementVNode)("div",A,[(0,o.createVNode)(j,{icon:"question-circle",class:"item-oth-icon",size:"4x"}),(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(t.name.split(".").pop().toUpperCase()),1)]),(0,o.createElementVNode)("div",P,[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.name),1)])]))])),_:2},1032,["onClick"])))),128))])),_:1}),(0,o.createVNode)(K,{onInfinite:r.infiniteHandler},{"no-more":(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("noOtherMediaFound")),1)])),"no-results":(0,o.withCtx)((()=>[(0,o.createTextVNode)(".")])),spinner:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",S,[(0,o.createVNode)(U,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(H)])),_:1},8,["color"])])])),error:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("somethingWrong"))+". ",1),(0,o.createElementVNode)("a",{href:"javascript:;",onClick:t[5]||(t[5]=t=>e.location.reload())},(0,o.toDisplayString)(e.$t("retry")),1)])),_:1},8,["onInfinite"])],64)):((0,o.openBlock)(),(0,o.createElementBlock)("div",T,[(0,o.createElementVNode)("div",N,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.$t("noMediaFound")),1)])]))],64))])),_:1})])),_:1}),(0,o.createVNode)($,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(Z,{shadow:"never",class:"media-info-card"},{default:(0,o.withCtx)((()=>[s.detailsData.length?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",I,[(0,o.createVNode)(F,{icon:"view",size:"small",type:"primary",onClick:t[6]||(t[6]=e=>r.showPreview(s.currentItem,s.currentItemIndex))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("preview")),1)])),_:1}),(0,o.createVNode)(J,{"to-copy":e.resolveMediaLink(s.currentItem.link),class:"link-copy-btn",onCopy:r.copyLink},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(F,{icon:"link",size:"small",type:"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("copyLink")),1)])),_:1})])),_:1},8,["to-copy","onCopy"]),s.currentItem.type==s.MediaTypes.IMAGE.value?((0,o.openBlock)(),(0,o.createBlock)(F,{key:0,icon:"edit",size:"small",type:"warning",onClick:t[7]||(t[7]=e=>s.imageEditorVisible=!0)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("edit")),1)])),_:1})):(0,o.createCommentVNode)("",!0)]),(0,o.createVNode)(Y),(0,o.createVNode)(X,{data:s.detailsData,"show-header":!1,stripe:"",size:"default",style:{width:"100%"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(Q,{prop:"name",label:"",width:"100"}),(0,o.createVNode)(Q,{prop:"value",label:""})])),_:1},8,["data"]),(0,o.createVNode)(Y),(0,o.createElementVNode)("div",D,[(0,o.createVNode)(F,{icon:"delete",size:"default",type:"danger",onClick:t[8]||(t[8]=e=>r.deleteItem())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("delete")),1)])),_:1})])],64)):(0,o.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1}),s.showViewer?((0,o.openBlock)(),(0,o.createBlock)(ee,{key:0,infinite:!1,"hide-on-click-modal":!0,"url-list":r.filteredMediaLinks,"initial-index":s.currentItemIndex,onClose:t[9]||(t[9]=e=>s.showViewer=!1)},null,8,["url-list","initial-index"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(te,{modelValue:s.showAudioReaderDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>s.showAudioReaderDialog=e),width:"35%","show-close":"","destroy-on-close":"",title:s.currentItem?s.currentItem.name:"",top:"30vh"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("audio",R,[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(s.currentItem.link)},null,8,B)])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(te,{modelValue:s.showVideoReaderDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>s.showVideoReaderDialog=e),width:"45%","show-close":"","destroy-on-close":"",title:s.currentItem?s.currentItem.name:"",top:"10vh"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("video",M,[(0,o.createElementVNode)("source",{src:e.resolveMediaLink(s.currentItem.link)},null,8,O)])])),_:1},8,["modelValue","title"]),(0,o.createVNode)(te,{modelValue:s.imageEditorVisible,"onUpdate:modelValue":t[17]||(t[17]=e=>s.imageEditorVisible=e),"destroy-on-close":"",top:"1vh"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(ie,{"cropper-ratio":null,"round-preview":!1,src:s.currentItem?e.resolveMediaLink(s.currentItem.link):null,onCancel:t[12]||(t[12]=e=>s.imageEditorVisible=!1),onSave:r.storeEditedPicture},null,8,["src","onSave"]),(0,o.createVNode)(te,{modelValue:s.imageEditorConfirmVisible,"onUpdate:modelValue":t[16]||(t[16]=e=>s.imageEditorConfirmVisible=e),width:"50%",title:e.$t("confirmation"),"append-to-body":""},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",L,[(0,o.createVNode)(F,{size:"default",onClick:t[13]||(t[13]=e=>s.imageEditorConfirmVisible=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,o.createVNode)(F,{type:"primary",size:"default",onClick:t[14]||(t[14]=e=>r.saveEditedPicture(!1))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("saveNewFile")),1)])),_:1}),(0,o.createVNode)(F,{type:"danger",size:"default",onClick:t[15]||(t[15]=e=>r.saveEditedPicture(!0))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("overwriteExistingFile")),1)])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("whatDoYouWantToDo"))+" ",1)])),_:1},8,["modelValue","title"])])),_:1},8,["modelValue"])],64)}var F=i(39355),z=i(11165),Z=i(92829),H=i(98761),U=i(64713),W=i(21101),q={name:"MediaLibrary",mixins:[H.Z],props:{multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},showImages:{type:Boolean,default:!0},showVideos:{type:Boolean,default:!0},showAudios:{type:Boolean,default:!0},showDocuments:{type:Boolean,default:!0},showOtherTypes:{type:Boolean,default:!0},baseUrl:{type:String,default:z.STORAGE_API_BASE_URL},folder:{type:String,default:"medias"},initSelectedMedias:{type:Array,default:null}},emits:["validate"],data(){return{MediaTypes:s.Tr,users:[],medias:[],mediaDate:0,mediaType:0,mediaTypes:[],mediaDates:[],detailsData:[],mediaSearch:"",isLoading:!0,showViewer:!1,currentItem:null,lastMediaRowId:0,selectedMedias:[],currentItemIndex:0,imageEditorVisible:!1,currentEditorDataUrl:null,showAudioReaderDialog:!1,showVideoReaderDialog:!1,imageEditorConfirmVisible:!1}},computed:{filteredMedias(){let e=[];const t=this.medias.filter((e=>0==this.mediaType||e.type==this.mediaType));e=this.mediaSearch?t.filter((e=>e.name.toLowerCase().includes(this.mediaSearch.toLowerCase()))):t;const i=e.filter((e=>0==this.mediaDate||this.extractDatetimeMonthYear(e.insert_datetime)==this.mediaDate));return i},filteredMediaLinks(){const e=[];return this.filteredMedias.forEach((t=>{t.type==s.Tr.IMAGE.value&&e.push(this.resolveMediaLink(t.link))})),e}},watch:{medias:{handler(e,t){this.loadMediaDates()},deep:!0}},created(){this.$_.forIn(s.Tr,((e,t)=>{this.showImages&&e.value==s.Tr.IMAGE.value&&this.mediaTypes.push(e),this.showAudios&&e.value==s.Tr.AUDIO.value&&this.mediaTypes.push(e),this.showVideos&&e.value==s.Tr.VIDEO.value&&this.mediaTypes.push(e),this.showOtherTypes&&e.value==s.Tr.OTHERS.value&&this.mediaTypes.push(e),this.showDocuments&&e.value==s.Tr.DOCUMENT.value&&this.mediaTypes.push(e)})),this.mediaType=this.showImages&&this.showVideos&&this.showAudios&&this.showDocuments&&this.showOtherTypes?0:this.mediaTypes[0].value,this.init()},methods:{...(0,W.mapActions)("media",["getMediasPage","deleteMedia","generateThumbnail"]),...(0,W.mapActions)("user",["getAllUsers"]),async init(){const e=await this.getAllUsers();e.data&&(this.users=e.data);let t=null;const i=await this.getMediasPage({offset:this.lastMediaRowId,limit:18});return i.success&&i.data?(t=i.data,this.lastMediaRowId+=t.length,this.medias.push(...t),t.forEach((e=>{this.initSelectedMedias&&this.initSelectedMedias.includes(e.link)&&this.selectedMedias.push(e)}))):this.$message.error(this.$t("anErrorOccured")),this.isLoading&&(this.isLoading=!1),t?t.length:0},async infiniteHandler(e){const t=await this.init();t>0?e.loaded():e.complete()},loadMediaDates(){this.mediaDates=[],this.medias.forEach((e=>{const t=this.extractDatetimeMonthYear(e.insert_datetime);this.mediaDates.includes(t)||this.mediaDates.push(t)}))},extractDatetimeMonthYear(e){if(!e)return"";let t=(0,F.bK)(e.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale});return t=t.split(" "),(0,Z.fm)(t[1])+" "+t[2]},showPreview(e,t){this.currentItem=e,this.currentItemIndex=t,e.type==s.Tr.IMAGE.value&&(this.showViewer=!0),e.type==s.Tr.DOCUMENT.value&&window.open(this.resolveMediaLink(e.link)),e.type==s.Tr.AUDIO.value&&(this.showAudioReaderDialog=!0),e.type==s.Tr.VIDEO.value&&(this.showVideoReaderDialog=!0),e.type==s.Tr.OTHERS.value&&this.$message.warning(this.$t("cannotOpenThisFile"))},loadDetails(e,t){this.currentItem=e,this.currentItemIndex=t;const i=this.mediaTypes.find((t=>t.value==e.type)),o=(0,F.bK)(e.insert_datetime.split(" ")[0],{outPattern:"DD MMMM YYYY",locale:this.$i18n.locale}),n=this.users.find((t=>t.id==e.sender));if(this.detailsData=[{name:this.$t("name"),value:e.name},{name:this.$t("url"),value:this.resolveMediaLink(e.link)},{name:this.$t("type"),value:i?i.label:""},{name:this.$t("size"),value:(0,Z.gB)(e.size,!0)},{name:this.$t("mimeType"),value:e.mime},{name:this.$t("sentBy"),value:n?n.name:""},{name:this.$t("date"),value:o}],e.type==s.Tr.IMAGE.value){var r=new Image;r.onload=()=>{const e=r.naturalHeight,t=r.naturalWidth;t&&e&&this.detailsData.length&&this.detailsData.push({name:this.$t("dimensions"),value:t+" x "+e})},r.src=this.resolveMediaLink(e.link)}},async reset(){this.isLoading=!0,this.medias=[],this.detailsData=[],this.selectedMedias=[],this.lastMediaRowId=0,await this.init()},copyLink(e,t){t&&this.$message.success(this.$t("mediaLinkCopied"))},updateSelectedMedias(e,t){const i=this.selectedMedias.findIndex((t=>t.id===e.id));i>-1?(this.selectedMedias.splice(i,1),this.detailsData=[]):(this.multiple?this.selectedMedias.push(e):this.selectedMedias=[e],this.loadDetails(e,t))},deleteItem(){this.$confirm(this.$t("deleteMediaQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteMedia({id:this.currentItem.id});e.success?(this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},validate(){this.$emit("validate",this.multiple?this.selectedMedias:this.selectedMedias[0],this.multiple)},storeEditedPicture(e,t){this.currentEditorDataUrl=t,this.imageEditorConfirmVisible=!0},async saveEditedPicture(e){if(this.currentEditorDataUrl){var t=(0,Z.Bo)(this.currentEditorDataUrl,{filename:this.$uuidv4()+".png",type:"image/png"});this.compressImages&&(t=await(0,Z.hv)(t,{maxSizeMB:this.compressThreshold}));const o=e?this.currentItem.name:t.name,n=new FormData;n.append("folder",this.folder),n.append("overwrite",e),n.append("file",t,o);try{const i=await this.axios.post(this.baseUrl,n,{headers:z.API_REQUEST_HEADERS});i.data&&"success"==i.data["status"]?(e&&await this.deleteMedia({id:this.currentItem.id}),await this.addItemInDB({context:U.R,data:{name:o,link:"root/"+this.folder+"/"+o,type:s.Tr.IMAGE.value,size:t.size||0,mime:t.type||"",sender:this.userData.id}}),await this.generateThumbnail({autoWidth:this.thumbnailsFormat==s.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==s.vh.AUTOHEIGHT.value,folder:this.folder,file:o,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))}),this.imageEditorConfirmVisible=!1,this.imageEditorVisible=!1,await this.reset()):this.$message.error(this.$t("anErrorOccured"))}catch(i){this.$message.error(this.$t("anErrorOccured"))}}}}};const G=(0,a.Z)(q,[["render",$],["__scopeId","data-v-0bb993f2"]]);var j=G;const K={class:"text-right"},J={class:"mr-10"},Y={class:"mr-5"},Q={key:0,class:"mb-10"},X={key:0,class:"text-left"},ee={class:"text-right"},te={class:"el-upload__text mt-10"};function ie(e,t,i,n,s,r){const a=(0,o.resolveComponent)("el-switch"),l=(0,o.resolveComponent)("el-button"),c=(0,o.resolveComponent)("el-col"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("el-progress"),m=(0,o.resolveComponent)("UploadFilled"),g=(0,o.resolveComponent)("el-icon"),p=(0,o.resolveComponent)("el-upload");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[s.fileList&&s.fileList.length?((0,o.openBlock)(),(0,o.createBlock)(h,{key:0,class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{span:24},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",K,[(0,o.createElementVNode)("span",J,[(0,o.createElementVNode)("b",Y,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.$t("overwriteDuplicateFiles")),1)]),(0,o.createVNode)(a,{modelValue:s.overwrite,"onUpdate:modelValue":t[0]||(t[0]=e=>s.overwrite=e),"active-color":e.appPrimaryColor,size:"default"},null,8,["modelValue","active-color"])]),(0,o.createVNode)(l,{size:"default",icon:"close",disabled:s.isUploading,class:"ml-10",onClick:t[1]||(t[1]=e=>r.clearFileList())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("clearList")),1)])),_:1},8,["disabled"]),(0,o.createVNode)(l,{size:"default",type:"primary",icon:"upload",disabled:s.isUploading,onClick:t[2]||(t[2]=e=>r.send())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("send")+" ("+s.fileList.length+")"),1)])),_:1},8,["disabled"])])])),_:1})])),_:1})])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(h,{shadow:"never"},{default:(0,o.withCtx)((()=>[s.isUploading?((0,o.openBlock)(),(0,o.createElementBlock)("div",Q,[(0,o.createVNode)(d,{gutter:10,class:"mb-10"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{span:12},{default:(0,o.withCtx)((()=>[s.uploadedFileName?((0,o.openBlock)(),(0,o.createElementBlock)("div",X,(0,o.toDisplayString)(e.$t("sendingInProgress")+": "+s.uploadedFileName),1)):(0,o.createCommentVNode)("",!0)])),_:1}),(0,o.createVNode)(c,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",ee,(0,o.toDisplayString)(s.uploadedList.length+s.failedList.length+" / "+s.fileList.length),1)])),_:1})])),_:1}),(0,o.createVNode)(u,{percentage:s.percentage,format:r.format},null,8,["percentage","format"])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(p,{ref:"upload",class:"upload-box","auto-upload":!1,"file-list":s.fileList,"on-change":r.handleChange,"on-remove":r.handleChange,headers:i.headers,action:i.baseUrl,multiple:"",drag:""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{class:"upload-icon",size:64},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m)])),_:1}),(0,o.createElementVNode)("div",te,(0,o.toDisplayString)(e.$t("uploadFilesOrClickToSend")),1)])),_:1},8,["file-list","on-change","on-remove","headers","action"])])),_:1})],64)}var oe={name:"UploadFiles",mixins:[H.Z],props:{folder:{type:String,default:"medias"},maxUploadSize:{type:Number,default:256},baseUrl:{type:String,default:z.STORAGE_API_BASE_URL},headers:{type:Object,default:z.API_REQUEST_HEADERS},acceptImages:{type:Boolean,default:!0},acceptVideos:{type:Boolean,default:!0},acceptAudios:{type:Boolean,default:!0},acceptDocuments:{type:Boolean,default:!0},acceptOtherTypes:{type:Boolean,default:!0}},data(){return{fileList:[],percentage:0,failedList:[],uploadedList:[],overwrite:!0,isUploading:!1,uploadedFileName:"",docExtList:["DOC","DOCX","HTML","HTM","ODT","PDF","XLS","XLSX","ODS","PPT","PPTX","TXT"],vidExtList:["WEBM","MP4","AVI","MOV","FLV","OGG","WMV","MKV"],imgExtList:["JPEG","JPG","PNG","GIF","WEBP","SVG"],audExtList:["MP3","WAV","M4A","WMA","AAC","FLAC"]}},computed:{acceptedExtensions(){const e=[];return this.acceptImages&&this.acceptAudios&&this.acceptVideos&&this.acceptDocuments&&this.acceptOtherTypes?"*":(this.acceptImages&&this.imgExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptAudios&&this.audExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptVideos&&this.vidExtList.forEach((t=>{e.push("."+t.toLowerCase())})),this.acceptDocuments&&this.docExtList.forEach((t=>{e.push("."+t.toLowerCase())})),e.join(", "))}},methods:{...(0,W.mapActions)("media",["generateThumbnail"]),format(e){return 100===e?this.$t("completed"):`${e}%`},handleChange(e,t){this.fileList=t},getFileTypeByName(e){const t=e.split(".").pop();if(t){if(this.docExtList.includes(t.toUpperCase()))return s.Tr.DOCUMENT.value;if(this.vidExtList.includes(t.toUpperCase()))return s.Tr.VIDEO.value;if(this.imgExtList.includes(t.toUpperCase()))return s.Tr.IMAGE.value;if(this.audExtList.includes(t.toUpperCase()))return s.Tr.AUDIO.value}return s.Tr.OTHERS.value},async send(){let e=!0;for(let o=0;o<this.fileList.length;o++){const t=this.fileList[o].size/1024/1024<this.maxUploadSize;t||(e=!1,this.$message.error(this.$t("uploadFileSizeWarning",[this.fileList[o].name,this.maxUploadSize])));const i=this.getFileTypeByName(this.fileList[o].name),n=!this.acceptImages&&i==s.Tr.IMAGE.value||!this.acceptVideos&&i==s.Tr.VIDEO.value||!this.acceptAudios&&i==s.Tr.AUDIO.value||!this.acceptDocuments&&i==s.Tr.DOCUMENT.value||!this.acceptOtherTypes&&i==s.Tr.OTHERS.value;n&&this.$message.error(this.$t("fileFormatNotAllowed",[this.fileList[o].name])),e&&n&&(e=!1)}if(e){this.isUploading=!0;for(let e=0;e<this.fileList.length;e++){const o=this.fileList[e].name;var t=this.fileList[e].raw;this.compressImages&&(t=await(0,Z.hv)(t,{maxSizeMB:this.compressThreshold}));const n=new FormData;n.append("folder",this.folder),n.append("overwrite",this.overwrite),n.append("file",t,o);try{this.percentage=0,this.uploadedFileName=this.fileList[e].name;const i=await this.axios.post(this.baseUrl,n,{headers:this.headers,onUploadProgress:e=>{null!==e.total&&(this.percentage=Math.round(100*e.loaded/e.total))}});i.data&&"success"==i.data["status"]?(this.uploadedList.push(this.fileList[e].name),await this.addItemInDB({context:U.R,data:{name:o,link:"root/"+this.folder+"/"+o,type:this.getFileTypeByName(o),size:t.size||0,mime:t.type||"",sender:this.userData.id}}),this.getFileTypeByName(o)==s.Tr.IMAGE.value&&await this.generateThumbnail({autoWidth:this.thumbnailsFormat==s.vh.AUTOWIDTH.value,autoHeight:this.thumbnailsFormat==s.vh.AUTOHEIGHT.value,folder:this.folder,file:o,lib:this.imgProcessingLib,models:this.thumbnails.filter((e=>e.label&&e.width&&e.height))})):i.data&&"exists"==i.data["status"]?(this.failedList.push(this.fileList[e].name),this.$message({type:"error",duration:5e3,showClose:!0,message:this.$t("fileExistsError",[this.fileList[e].name])})):(this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name])))}catch(i){this.failedList.push(this.fileList[e].name),this.$message.error(this.$t("fileSendingError",[this.fileList[e].name]))}this.uploadedFileName=""}setTimeout((()=>{this.$message({showClose:!0,duration:5e3,message:this.$t("sendingCompleted",[this.uploadedList.length,this.failedList.length])}),this.clearFileList(),this.isUploading=!1}),1e3)}},clearFileList(){this.fileList=[],this.failedList=[],this.uploadedList=[]}}};const ne=(0,a.Z)(oe,[["render",ie],["__scopeId","data-v-66d0394a"]]);var se=ne;function re(e,t,i,n,s,r){const a=se,l=(0,o.resolveComponent)("el-tab-pane"),d=j,h=c,u=(0,o.resolveComponent)("el-tabs");return(0,o.openBlock)(),(0,o.createBlock)(u,{modelValue:s.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>s.tab=e),type:"card",onTabClick:r.handleClick},{default:(0,o.withCtx)((()=>[i.enableUploadFiles?((0,o.openBlock)(),(0,o.createBlock)(l,{key:0,label:e.$t("uploadFiles"),name:"1"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(a,{"max-upload-size":i.uploadConfig.maxUploadSize,"base-url":i.uploadConfig.baseUrl,folder:i.uploadConfig.folder,"accept-images":i.displayImages,"accept-videos":i.displayVideos,"accept-audios":i.displayAudios,"accept-documents":i.displayDocuments,"accept-other-types":i.displayOtherTypes},null,8,["max-upload-size","base-url","folder","accept-images","accept-videos","accept-audios","accept-documents","accept-other-types"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),i.enableMediaLibrary?((0,o.openBlock)(),(0,o.createBlock)(l,{key:1,label:e.$t("mediaLibrary"),name:"2"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{limit:i.limit,multiple:i.multiple,"show-images":i.displayImages,"show-videos":i.displayVideos,"show-audios":i.displayAudios,"show-documents":i.displayDocuments,"show-other-types":i.displayOtherTypes,"init-selected-medias":i.initSelectedMedias,onValidate:r.validateSelection},null,8,["limit","multiple","show-images","show-videos","show-audios","show-documents","show-other-types","init-selected-medias","onValidate"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),i.enableAddFromAnUrl?((0,o.openBlock)(),(0,o.createBlock)(l,{key:2,label:e.$t("addFromAnUrl"),name:"3"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{limit:i.limit,multiple:i.multiple,"accept-images":i.displayImages,"accept-videos":i.displayVideos,"accept-audios":i.displayAudios,"accept-documents":i.displayDocuments,"accept-other-types":i.displayOtherTypes,onValidate:r.validateLinks},null,8,["limit","multiple","accept-images","accept-videos","accept-audios","accept-documents","accept-other-types","onValidate"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1},8,["modelValue","onTabClick"])}var ae={name:"MediaPicker",components:{UploadFiles:se,MediaLibrary:j,AddFromAnUrl:c},props:{enableUploadFiles:{type:Boolean,default:!0},enableMediaLibrary:{type:Boolean,default:!0},enableAddFromAnUrl:{type:Boolean,default:!0},displayImages:{type:Boolean,default:!0},displayVideos:{type:Boolean,default:!0},displayAudios:{type:Boolean,default:!0},displayDocuments:{type:Boolean,default:!0},displayOtherTypes:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},limit:{type:Number,default:0},uploadConfig:{type:Object,default:()=>({folder:"medias",maxUploadSize:256,baseUrl:z.STORAGE_API_BASE_URL})},currentTab:{type:String,default:"2"},initSelectedMedias:{type:Array,default:null},enableSelectionDetails:{type:Boolean,default:!1}},emits:["selected"],data(){return{tab:this.currentTab}},methods:{handleClick(){},validateSelection(e,t){if(t){const t=[];e.forEach((e=>{this.enableSelectionDetails?t.push(e):t.push(e.link)})),this.$emit("selected",t)}else this.$emit("selected",this.enableSelectionDetails?e:e.link)},validateLinks(e,t){t?this.$emit("selected",e):this.$emit("selected",e[0])}}};const le=(0,a.Z)(ae,[["render",re],["__scopeId","data-v-ce9c6404"]]);var ce=le},12670:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var o=i(31377),n=i(82234);const s={style:{float:"left"}},r={style:{float:"left"}};function a(e,t,i,a,l,c){const d=(0,n.resolveComponent)("country-flag"),h=(0,n.resolveComponent)("el-option"),u=(0,n.resolveComponent)("el-select"),m=(0,n.resolveComponent)("el-col"),g=o.Z,p=(0,n.resolveComponent)("el-input"),f=(0,n.resolveComponent)("el-row");return i.reverse?((0,n.openBlock)(),(0,n.createBlock)(f,{key:0,gutter:2,style:{width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(m,{span:i.selectorSpan},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,{modelValue:l.langCode,"onUpdate:modelValue":t[0]||(t[0]=e=>l.langCode=e),size:i.size,style:{width:"100%"},placeholder:e.$t("code"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,n.createSlots)({default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.langList,(e=>((0,n.openBlock)(),(0,n.createBlock)(h,{key:e.code,value:e.code,label:i.displayCode?e.code:" "},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("span",s," [ "+(0,n.toDisplayString)(e.code)+" ] "+(0,n.toDisplayString)(e.label),1)])),_:2},1032,["value","label"])))),128))])),_:2},[i.displayFlag?{name:"prefix",fn:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{iso:l.langCode.replace("EN","GB"),class:"ml-5 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","size","placeholder","no-data-text","no-match-text"])])),_:1},8,["span"]),(0,n.createVNode)(m,{span:24-i.selectorSpan},{default:(0,n.withCtx)((()=>["editor"==i.type?((0,n.openBlock)(),(0,n.createBlock)(g,{key:0,modelValue:c.content,"onUpdate:modelValue":t[1]||(t[1]=e=>c.content=e),style:(0,n.normalizeStyle)(i.inputStyles),placeholder:i.placeholder,"toolbar-items":i.contentEditorItems,"should-not-group-when-full":!1},null,8,["modelValue","style","placeholder","toolbar-items"])):(0,n.createCommentVNode)("",!0),"text"==i.type?((0,n.openBlock)(),(0,n.createBlock)(p,{key:1,modelValue:c.content,"onUpdate:modelValue":t[2]||(t[2]=e=>c.content=e),size:i.size,type:i.type,style:(0,n.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","style","placeholder"])):(0,n.createCommentVNode)("",!0),"textarea"==i.type?((0,n.openBlock)(),(0,n.createBlock)(p,{key:2,modelValue:c.content,"onUpdate:modelValue":t[3]||(t[3]=e=>c.content=e),size:i.size,type:i.type,rows:i.rows,style:(0,n.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","rows","style","placeholder"])):(0,n.createCommentVNode)("",!0)])),_:1},8,["span"])])),_:1})):((0,n.openBlock)(),(0,n.createBlock)(f,{key:1,gutter:2,style:{width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(m,{span:24-i.selectorSpan},{default:(0,n.withCtx)((()=>["editor"==i.type?((0,n.openBlock)(),(0,n.createBlock)(g,{key:0,modelValue:c.content,"onUpdate:modelValue":t[4]||(t[4]=e=>c.content=e),style:(0,n.normalizeStyle)(i.inputStyles),placeholder:i.placeholder,"toolbar-items":i.contentEditorItems,"should-not-group-when-full":!1},null,8,["modelValue","style","placeholder","toolbar-items"])):(0,n.createCommentVNode)("",!0),"text"==i.type?((0,n.openBlock)(),(0,n.createBlock)(p,{key:1,modelValue:c.content,"onUpdate:modelValue":t[5]||(t[5]=e=>c.content=e),size:i.size,type:i.type,style:(0,n.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","style","placeholder"])):(0,n.createCommentVNode)("",!0),"textarea"==i.type?((0,n.openBlock)(),(0,n.createBlock)(p,{key:2,modelValue:c.content,"onUpdate:modelValue":t[6]||(t[6]=e=>c.content=e),size:i.size,type:i.type,rows:i.rows,style:(0,n.normalizeStyle)(i.inputStyles),placeholder:i.placeholder},null,8,["modelValue","size","type","rows","style","placeholder"])):(0,n.createCommentVNode)("",!0)])),_:1},8,["span"]),(0,n.createVNode)(m,{span:i.selectorSpan},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,{modelValue:l.langCode,"onUpdate:modelValue":t[7]||(t[7]=e=>l.langCode=e),size:i.size,style:{width:"100%"},placeholder:e.$t("code"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,n.createSlots)({default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.langList,(e=>((0,n.openBlock)(),(0,n.createBlock)(h,{key:e.code,value:e.code,label:i.displayCode?e.code:" "},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("span",r,(0,n.toDisplayString)(e.label),1)])),_:2},1032,["value","label"])))),128))])),_:2},[i.displayFlag?{name:"prefix",fn:(0,n.withCtx)((()=>[(0,n.createVNode)(d,{iso:l.langCode.replace("EN","GB"),class:"ml-5 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","size","placeholder","no-data-text","no-match-text"])])),_:1},8,["span"])])),_:1}))}var l=i(2258);const c=()=>({langCode:""}),d={},h={},u=(0,l.defineStore)("mltlang",{state:c,getters:d,actions:h});var m=i(98761),g={name:"MltlangInput",mixins:[m.Z],props:{type:{type:String,default:"text"},size:{type:String,default:"default"},placeholder:{type:String,default:""},inputStyles:{type:Object,default:()=>({width:"100%"})},selectorSpan:{type:Number,default:3},modelValue:{type:String,required:!0},displayCode:{type:Boolean,default:!1},displayFlag:{type:Boolean,default:!0},reverse:{type:Boolean,default:!1},synchro:{type:Boolean,default:!1},rows:{type:Number,default:2},contentEditorItems:{type:Array,default:()=>["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"]}},emits:["update:modelValue","codeChange"],setup(){const e=u();return{mltlangStore:e}},data(){return{langCode:""}},computed:{content:{get(){let e;try{e=JSON.parse(this.modelValue)}catch(t){e={}}return e[this.langCode]||""},set(e){let t;try{t=JSON.parse(this.modelValue)}catch(i){t={}}t[this.langCode]=e,this.$emit("update:modelValue",JSON.stringify(t))}}},watch:{langCode:{handler(e,t){this.$emit("codeChange",e),this.mltlangStore.langCode=e}},"mltlangStore.langCode":{handler(e,t){this.synchro&&(this.langCode=e)}}},created(){this.mltlangStore.langCode&&(this.langCode=this.mltlangStore.langCode),this.langList?.length&&!this.langCode&&(this.langCode=this.langList[0]?.code)}},p=i(83744);const f=(0,p.Z)(g,[["render",a],["__scopeId","data-v-494e3f59"]]);var w=f},97200:function(e,t,i){"use strict";i.d(t,{Z:function(){return c}});var o=i(82234);const n=(0,o.createElementVNode)("div",null,"Sticky Top",-1);function s(e,t,i,s,r,a){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{style:(0,o.normalizeStyle)({height:r.height+"px",zIndex:i.zIndex})},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(i.className),style:(0,o.normalizeStyle)({top:r.isSticky?i.top+"px":"",zIndex:i.zIndex,position:r.position,width:r.width,height:r.height+"px"})},[(0,o.renderSlot)(e.$slots,"default",{},(()=>[n]))],6)],4)}var r={name:"Sticky",props:{top:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated(){this.handleScroll()},unmounted(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset(){this.active&&this.reset()},reset(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll(){const e=this.$el.getBoundingClientRect().width;this.width=e||"auto";const t=this.$el.getBoundingClientRect().top;t<this.top?this.sticky():this.handleReset()},handleResize(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},a=i(83744);const l=(0,a.Z)(r,[["render",s]]);var c=l},29617:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return S}});var o=i(68716),n=i(12670),s=i(82234);const r={style:{"line-height":"36px","font-size":"18px"}},a={style:{"text-align":"center","margin-top":"20px",display:"flex"}},l={class:"card-header"},c={class:"img-preview-container"},d={class:"image-slot"},h={key:1},u={class:"dialog-footer"},m={class:"card-header"},g={class:"img-preview-container"},p={class:"image-slot"},f={key:1},w={class:"dialog-footer"};function b(e,t,i,b,_,v){const y=(0,s.resolveComponent)("el-col"),C=(0,s.resolveComponent)("el-button"),k=(0,s.resolveComponent)("el-row"),x=(0,s.resolveComponent)("el-card"),V=(0,s.resolveComponent)("el-table-column"),E=(0,s.resolveComponent)("el-tag"),A=(0,s.resolveComponent)("el-input"),P=(0,s.resolveComponent)("el-table"),S=(0,s.resolveComponent)("el-pagination"),T=(0,s.resolveComponent)("Delete"),N=(0,s.resolveComponent)("el-icon"),I=(0,s.resolveComponent)("Picture"),D=(0,s.resolveComponent)("el-image"),R=n.Z,B=(0,s.resolveComponent)("el-form-item"),M=(0,s.resolveComponent)("el-radio-button"),O=(0,s.resolveComponent)("el-radio-group"),L=(0,s.resolveComponent)("el-input-number"),$=(0,s.resolveComponent)("el-color-picker"),F=(0,s.resolveComponent)("el-form"),z=(0,s.resolveComponent)("el-dialog"),Z=o.Z,H=(0,s.resolveDirective)("loading");return(0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createVNode)(x,{class:"mb-10 header-card",shadow:"hover"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,null,{default:(0,s.withCtx)((()=>[(0,s.createVNode)(y,{span:12},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("b",r,(0,s.toDisplayString)(e.$t("productsCategories")),1)])),_:1}),(0,s.createVNode)(y,{span:12,class:"text-right"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(C,{size:"default",type:"primary",icon:"plus",onClick:t[0]||(t[0]=e=>v.addItem())},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("add")),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.createVNode)(x,{shadow:"hover"},{default:(0,s.withCtx)((()=>[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(P,{border:"","row-key":"id","default-expand-all":"",data:v.pagedTableData,"empty-text":e.$t("noData"),"row-class-name":v.tableRowClassName,style:{width:"100%"}},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(V,{width:"50",fixed:""},{header:(0,s.withCtx)((()=>[])),_:1}),(0,s.createVNode)(V,{sortable:"",label:e.$t("name"),prop:"name",width:"150",fixed:""},{default:(0,s.withCtx)((t=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.tr(t.row.name)),1)])),_:1},8,["label"]),(0,s.createVNode)(V,{sortable:"",label:e.$t("slug"),prop:"slug",width:"150"},null,8,["label"]),(0,s.createVNode)(V,{sortable:"",label:e.$t("description"),prop:"description",width:"175","show-overflow-tooltip":""},{default:(0,s.withCtx)((t=>[(0,s.createElementVNode)("small",null,(0,s.toDisplayString)(e.tr(t.row.description)),1)])),_:1},8,["label"]),(0,s.createVNode)(V,{sortable:"",label:e.$t("status"),prop:"display",width:"125"},{default:(0,s.withCtx)((t=>[parseInt(t.row.display)?((0,s.openBlock)(),(0,s.createBlock)(E,{key:0,type:"success"},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("published")),1)])),_:1})):((0,s.openBlock)(),(0,s.createBlock)(E,{key:1,type:"danger"},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("unpublished")),1)])),_:1}))])),_:1},8,["label"]),(0,s.createVNode)(V,{sortable:"",label:e.$t("relatedProducts"),width:"140"},{default:(0,s.withCtx)((e=>[e.row.count_products?((0,s.openBlock)(),(0,s.createBlock)(E,{key:0},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.row.count_products),1)])),_:2},1024)):(0,s.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,s.createVNode)(V,{sortable:"",label:e.$t("position"),width:"125"},{default:(0,s.withCtx)((e=>[(0,s.createVNode)(E,null,{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.row.position),1)])),_:2},1024)])),_:1},8,["label"]),(0,s.createVNode)(V,{label:e.$t("color"),width:"125"},{default:(0,s.withCtx)((e=>[e.row.color?((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:0,style:(0,s.normalizeStyle)("width: 50px; height: 10px; background: "+e.row.color)},null,4)):(0,s.createCommentVNode)("",!0)])),_:1},8,["label"]),(0,s.createVNode)(V,{align:"right",width:"300",fixed:"right"},{header:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{modelValue:_.search,"onUpdate:modelValue":t[1]||(t[1]=e=>_.search=e),size:"small",placeholder:e.$t("search"),style:{width:"260px"}},null,8,["modelValue","placeholder"])])),default:(0,s.withCtx)((t=>[t.row.isParent?((0,s.openBlock)(),(0,s.createBlock)(C,{key:0,size:"small",type:"primary",icon:"plus",onClick:e=>v.addSubItem(t.$index,t.row)},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("subCategory")),1)])),_:2},1032,["onClick"])):(0,s.createCommentVNode)("",!0),(0,s.createVNode)(C,{size:"small",type:"warning",icon:"edit",onClick:e=>v.editItem(t.$index,t.row)},null,8,["onClick"]),(0,s.createVNode)(C,{size:"small",type:"danger",icon:"delete",onClick:e=>v.deleteItem(t.$index,t.row)},null,8,["onClick"])])),_:1})])),_:1},8,["data","empty-text","row-class-name"])),[[H,_.isLoading]]),(0,s.createElementVNode)("div",a,[(0,s.createVNode)(S,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":_.pageSize,total:_.total,onCurrentChange:v.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1}),(0,s.createVNode)(z,{modelValue:_.addDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>_.addDialog=e),title:0!=_.addCategoryData.parent?e.$t("addSubCategory"):e.$t("addCategory"),width:"65%",top:"3vh"},{footer:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",u,[(0,s.createVNode)(C,{onClick:t[9]||(t[9]=e=>v.cancelForm(_.addCategoryForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,s.createVNode)(C,{type:"primary",onClick:t[10]||(t[10]=e=>v.submitForm(_.addCategoryForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,s.withCtx)((()=>[(0,s.createVNode)(F,{ref:_.addCategoryForm,rules:_.rules,model:_.addCategoryData,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,{gutter:20},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(y,{span:8},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{class:"category-uploader-container",shadow:"never"},{header:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",l,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("categoryPreview")),1),_.addCategoryData.preview?((0,s.openBlock)(),(0,s.createBlock)(N,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:v.clearPreview},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(T)])),_:1},8,["title","onClick"])):(0,s.createCommentVNode)("",!0)])])),default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",c,[(0,s.createElementVNode)("div",{class:"img-preview",onClick:t[2]||(t[2]=e=>_.pickerVisible=!0)},[_.addCategoryData.preview?((0,s.openBlock)(),(0,s.createBlock)(D,{key:0,style:{width:"100%",height:"100%"},src:e.resolveMediaLink(_.addCategoryData.preview),fit:"cover"},{error:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",d,[(0,s.createVNode)(N,null,{default:(0,s.withCtx)((()=>[(0,s.createVNode)(I)])),_:1})])])),_:1},8,["src"])):((0,s.openBlock)(),(0,s.createElementBlock)("span",h,(0,s.toDisplayString)(e.$t("select")),1))])])])),_:1})])),_:1}),(0,s.createVNode)(y,{span:16},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(B,{prop:"name",label:e.$t("name")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(R,{modelValue:_.addCategoryData.name,"onUpdate:modelValue":t[3]||(t[3]=e=>_.addCategoryData.name=e),synchro:!0,"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(B,{prop:"slug",label:e.$t("slug")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{modelValue:_.addCategoryData.slug,"onUpdate:modelValue":t[4]||(t[4]=e=>_.addCategoryData.slug=e),style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(B,{prop:"description",label:e.$t("description")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(R,{modelValue:_.addCategoryData.description,"onUpdate:modelValue":t[5]||(t[5]=e=>_.addCategoryData.description=e),type:"textarea",synchro:!0,"selector-span":5,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(B,{prop:"display",label:e.$t("status")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(O,{modelValue:_.addCategoryData.display,"onUpdate:modelValue":t[6]||(t[6]=e=>_.addCategoryData.display=e)},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(M,{label:0},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,s.createVNode)(M,{label:1},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,s.createVNode)(k,{gutter:20},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(y,{span:14},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(B,{prop:"position",label:e.$t("position")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(L,{modelValue:_.addCategoryData.position,"onUpdate:modelValue":t[7]||(t[7]=e=>_.addCategoryData.position=e),style:{width:"100%"},"controls-position":"right",placeholder:e.$t("position")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,s.createVNode)(y,{span:10},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(B,{prop:"color",label:e.$t("color")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)($,{modelValue:_.addCategoryData.color,"onUpdate:modelValue":t[8]||(t[8]=e=>_.addCategoryData.color=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,s.createVNode)(z,{modelValue:_.editDialog,"onUpdate:modelValue":t[21]||(t[21]=e=>_.editDialog=e),title:0!=_.editCategoryData.parent?e.$t("editSubCategory"):e.$t("editCategory"),width:"65%",top:"3vh"},{footer:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",w,[(0,s.createVNode)(C,{onClick:t[19]||(t[19]=e=>v.cancelForm(_.editCategoryForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,s.createVNode)(C,{type:"primary",onClick:t[20]||(t[20]=e=>v.submitForm(_.editCategoryForm))},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,s.withCtx)((()=>[(0,s.createVNode)(F,{ref:_.editCategoryForm,rules:_.rules,model:_.editCategoryData,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(k,{gutter:20},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(y,{span:8},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{class:"category-uploader-container",shadow:"never"},{header:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",m,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("categoryPreview")),1),_.editCategoryData.preview?((0,s.openBlock)(),(0,s.createBlock)(N,{key:0,title:e.$t("clear"),class:"delete-icon",onClick:v.clearPreview},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(T)])),_:1},8,["title","onClick"])):(0,s.createCommentVNode)("",!0)])])),default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",g,[(0,s.createElementVNode)("div",{class:"img-preview",onClick:t[12]||(t[12]=e=>_.pickerVisible=!0)},[_.editCategoryData.preview?((0,s.openBlock)(),(0,s.createBlock)(D,{key:0,style:{width:"100%",height:"100%"},src:e.resolveMediaLink(_.editCategoryData.preview),fit:"cover"},{error:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",p,[(0,s.createVNode)(N,null,{default:(0,s.withCtx)((()=>[(0,s.createVNode)(I)])),_:1})])])),_:1},8,["src"])):((0,s.openBlock)(),(0,s.createElementBlock)("span",f,(0,s.toDisplayString)(e.$t("select")),1))])])])),_:1})])),_:1}),(0,s.createVNode)(y,{span:16},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(B,{prop:"name",label:e.$t("name")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(R,{modelValue:_.editCategoryData.name,"onUpdate:modelValue":t[13]||(t[13]=e=>_.editCategoryData.name=e),synchro:!0,"selector-span":5,placeholder:e.$t("name")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(B,{prop:"slug",label:e.$t("slug")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{modelValue:_.editCategoryData.slug,"onUpdate:modelValue":t[14]||(t[14]=e=>_.editCategoryData.slug=e),style:{width:"100%"},placeholder:e.$t("slug")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(B,{prop:"description",label:e.$t("description")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(R,{modelValue:_.editCategoryData.description,"onUpdate:modelValue":t[15]||(t[15]=e=>_.editCategoryData.description=e),type:"textarea",synchro:!0,"selector-span":5,placeholder:e.$t("description")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),(0,s.createVNode)(B,{prop:"display",label:e.$t("status")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(O,{modelValue:_.editCategoryData.display,"onUpdate:modelValue":t[16]||(t[16]=e=>_.editCategoryData.display=e)},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(M,{label:0},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,s.createVNode)(M,{label:1},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(0,s.createVNode)(k,{gutter:20},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(y,{span:14},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(B,{prop:"position",label:e.$t("position")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(L,{modelValue:_.editCategoryData.position,"onUpdate:modelValue":t[17]||(t[17]=e=>_.editCategoryData.position=e),style:{width:"100%"},"controls-position":"right",placeholder:e.$t("position")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),(0,s.createVNode)(y,{span:10},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(B,{prop:"color",label:e.$t("color")},{default:(0,s.withCtx)((()=>[(0,s.createVNode)($,{modelValue:_.editCategoryData.color,"onUpdate:modelValue":t[18]||(t[18]=e=>_.editCategoryData.color=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","title"]),(0,s.createVNode)(z,{modelValue:_.pickerVisible,"onUpdate:modelValue":t[22]||(t[22]=e=>_.pickerVisible=e),title:_.currentEditItem?e.$t("editCategory"):e.$t("addCategory"),"destroy-on-close":"","append-to-body":"",fullscreen:"",top:"1vh"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(Z,{"display-videos":!1,"display-audios":!1,"display-documents":!1,"display-other-types":!1,"enable-add-from-an-url":!1,onSelected:v.savePreview},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)}var _=i(46962),v=i.n(_),y=(i(57658),i(31567)),C=i(98761),k=i(38855),x=i(80565),V=i(21101),E={name:"Categories",mixins:[k.Z,y.Z,C.Z],data(){return{editCategoryData:{name:"",parent:0,position:0,color:"",slug:"",description:"",display:"",preview:""},addCategoryData:{name:"",parent:0,position:0,color:"",slug:"",description:"",display:"",preview:""},rules:{name:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],parent:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],slug:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}],display:[{required:!0,message:this.$t("fieldRequired"),trigger:"blur"}]},currentStoFolder:"categories",addCategoryForm:"addCategoryForm",editCategoryForm:"editCategoryForm",currentEditItem:null,pickerVisible:!1,editDialog:!1,addDialog:!1,isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.name.toLowerCase().includes(this.search.toLowerCase())||e.slug.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},watch:{"addCategoryData.name":{handler(e){this.addCategoryData.slug=v()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"addCategoryData.slug":{handler(e){this.addCategoryData.slug=v()(e,{trim:!0,lower:!0,strict:!0})}},"editCategoryData.name":{handler(e){this.editCategoryData.slug=v()(this.tr(e),{trim:!0,lower:!0,strict:!0})}},"editCategoryData.slug":{handler(e){this.editCategoryData.slug=v()(e,{trim:!0,lower:!0,strict:!0})}}},async created(){this.init()},methods:{...(0,V.mapActions)("eCommerceCategory",["getCategoriesByParent"]),...(0,V.mapActions)("eCommerceProduct",["getAllProducts"]),setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},tableRowClassName({row:e}){return e.isParent?"":"info-row"},async init(){this.isLoading=!0;const e=await this.getCategoriesByParent(0);if(e.success&&e.data){this.tableData=e.data;for(let e=0;e<this.tableData.length;e++){const t=await this.getCategoriesByParent(this.tableData[e].id);if(this.tableData[e].isParent=!0,t.success&&t.data){const i=[];t.data.forEach((e=>{i.push(e)})),this.tableData[e].children=i}}}else this.$message.error(this.$t("anErrorOccured"));this.countCategoriesProducts(),this.isLoading=!1},async countCategoriesProducts(){const e=await this.getAllProducts(),t=[];e.success&&e.data&&(e.data.forEach((e=>{let i;try{i=JSON.parse(e.categories)}catch(o){i=[]}t.push(i)})),this.tableData.forEach((e=>{e.count_products=t.filter((t=>t.includes(e.id)))?.length||0})))},addItem(){this.addCategoryData.parent=0,this.addDialog=!0},addSubItem(e,t){this.addCategoryData.parent=t.id,this.addDialog=!0},async editItem(e,t){this.currentEditItem=t,this.editCategoryData.name=t.name,this.editCategoryData.slug=t.slug,this.editCategoryData.preview=t.preview,this.editCategoryData.description=t.description,this.editCategoryData.display=parseInt(t.display),this.editCategoryData.position=parseInt(t.position),this.editCategoryData.color=t.color,this.editDialog=!0},deleteItem(e,t){this.$confirm(this.$t("deleteCategoryQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteItemInDB({context:x.H,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},clearPreview(){this.currentEditItem?this.editCategoryData.preview="":this.addCategoryData.preview=""},async savePreview(e){this.currentEditItem?this.editCategoryData.preview=e:this.addCategoryData.preview=e,this.pickerVisible=!1},submitForm(e){this.$refs[e].validate((async t=>{if(!t)return!1;if(e===this.addCategoryForm){if(this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.addCategoryData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(this.tableData.findIndex((e=>e.slug==this.addCategoryData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;const e=await this.addItemInDB({context:x.H,data:{name:this.addCategoryData.name,parent:this.addCategoryData.parent,preview:this.addCategoryData.preview,slug:this.addCategoryData.slug,description:this.addCategoryData.description,display:this.addCategoryData.display,position:this.addCategoryData.position,color:this.addCategoryData.color}});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}else if(e===this.editCategoryForm){const e={};if(this.tr(this.currentEditItem.name)!==this.tr(this.editCategoryData.name)&&this.tableData.findIndex((e=>this.tr(e.name)==this.tr(this.editCategoryData.name)))>-1)return this.$message.error(this.$t("sameNameErrorMessage")),!1;if(e["name"]=this.editCategoryData.name,this.currentEditItem.slug!==this.editCategoryData.slug&&this.tableData.findIndex((e=>e.slug==this.editCategoryData.slug))>-1)return this.$message.error(this.$t("slugAlreadyInUse")),!1;if(e["slug"]=this.editCategoryData.slug,this.currentEditItem.description!==this.editCategoryData.description&&(e["description"]=this.editCategoryData.description),this.currentEditItem.preview!==this.editCategoryData.preview&&(e["preview"]=this.editCategoryData.preview),this.currentEditItem.display!==this.editCategoryData.display&&(e["display"]=this.editCategoryData.display),this.currentEditItem.position!==this.editCategoryData.position&&(e["position"]=this.editCategoryData.position),this.currentEditItem.color!==this.editCategoryData.color&&(e["color"]=this.editCategoryData.color),!this.$_.isEmpty(e)){const t=await this.updateItemInDB({context:x.H,id:this.currentEditItem.id,data:e});t.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured"))}}this.cancelForm(e),this.init()}))},cancelForm(e){this.$refs[e].resetFields(),this.addDialog=this.editDialog=!1,this.addCategoryData.preview=this.editCategoryData.preview=""}}},A=i(83744);const P=(0,A.Z)(E,[["render",b],["__scopeId","data-v-5feb5d0e"]]);var S=P},26078:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}};function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-button"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("Form");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("addOrder")),1)])),_:1}),(0,o.createVNode)(l,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,o.createElementVNode)("section",null,[(0,o.createVNode)(u)])],64)}var r=i(5867),a=i(21626),l={name:"AddOrder",components:{Form:a.Z},mixins:[r.Z],data(){return{products:[]}},async created(){this.$store.dispatch("eCommerceOrder/getAllOrders",{root:!0});const e=await this.$store.dispatch("eCommerceProduct/getAllProducts",{root:!0});e.success&&e.data&&(this.products=e.data)},methods:{async save(){if(this.dataProvided){if(this.orders.findIndex((e=>e.code==this.orderData.code))>-1)return this.$message.error(this.$t("sameOrderCodeError")),!1;const e=await this.addItemInDB({context:this.E_COMMERCE_ORDER_CONTEXT,data:{code:this.orderData.code,date:this.orderData.date,status:this.orderData.status,user:this.orderData.user,billing:JSON.stringify(this.orderData.billing),expedition:JSON.stringify(this.orderData.expedition),products:JSON.stringify(this.orderData.products),fees:JSON.stringify(this.orderData.fees),custom_fields:JSON.stringify(this.orderData.customFields),promo_code:this.orderData.promoCode,note:this.orderData.note}});e.success?this.$router.replace(this.Routes.E_COMMERCE.PATH+"/orders"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",s]]);var h=d},31889:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}};function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-button"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("Form"),m=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("editOrder")),1)])),_:1}),(0,o.createVNode)(l,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("section",null,[(0,o.createVNode)(u)])),[[m,r.isLoading]])],64)}var r=i(5867),a=i(21626),l={name:"EditOrder",components:{Form:a.Z},mixins:[r.Z],data(){return{isLoading:!1,currentCode:"",products:[]}},async created(){this.$store.dispatch("eCommerceOrder/getAllOrders",{root:!0});const e=await this.$store.dispatch("eCommerceProduct/getAllProducts",{root:!0});e.success&&e.data&&(this.products=e.data),this.init()},methods:{async init(){if(this.$route.params&&this.$route.params.order){this.isLoading=!0;const e=await this.getItemFromDB({context:this.E_COMMERCE_ORDER_CONTEXT,id:this.$route.params.order});e.data&&e.success?(this.orderData={code:e.data.code,date:e.data.date,status:parseInt(e.data.status),user:e.data.user,billing:JSON.parse(e.data.billing),expedition:JSON.parse(e.data.expedition),products:JSON.parse(e.data.products),fees:JSON.parse(e.data.fees),customFields:JSON.parse(e.data.custom_fields),promoCode:e.data.promo_code,note:e.data.note},this.currentCode=e.data.code,this.isLoading=!1):this.$router.replace(this.Routes.E_COMMERCE.PATH+"/orders")}else this.$router.replace(this.Routes.E_COMMERCE.PATH+"/orders")},async save(){if(this.dataProvided){if(this.currentCode!==this.orderData.code&&this.orders.findIndex((e=>e.code==this.orderData.code))>-1)return this.$message.error(this.$t("sameOrderCodeError")),!1;const e=await this.updateItemInDB({context:this.E_COMMERCE_ORDER_CONTEXT,id:this.$route.params.order,data:{code:this.orderData.code,date:this.orderData.date,status:this.orderData.status,user:this.orderData.user,billing:JSON.stringify(this.orderData.billing),expedition:JSON.stringify(this.orderData.expedition),products:JSON.stringify(this.orderData.products),fees:JSON.stringify(this.orderData.fees),custom_fields:JSON.stringify(this.orderData.customFields),promo_code:this.orderData.promoCode,note:this.orderData.note}});e.success?this.$router.replace(this.Routes.E_COMMERCE.PATH+"/orders"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",s]]);var h=d},21626:function(e,t,i){"use strict";i.d(t,{Z:function(){return z}});var o=i(97200),n=i(30780),s=i(12670),r=i(82234);const a=e=>((0,r.pushScopeId)("data-v-95339c84"),e=e(),(0,r.popScopeId)(),e),l={class:"item-title"},c={class:"item-title"},d={class:"item-title mt-10"},h={style:{"padding-left":"10px","padding-right":"10px"}},u={style:{float:"left"}},m={style:{"padding-left":"10px","padding-right":"10px"}},g={style:{float:"left"}},p=a((()=>(0,r.createElementVNode)("br",null,null,-1))),f=a((()=>(0,r.createElementVNode)("br",null,null,-1))),w={class:"item-title"},b={class:"item-title mt-10"},_={class:"item-title mt-10"};function v(e,t,i,a,v,y){const C=(0,r.resolveComponent)("el-input"),k=(0,r.resolveComponent)("el-col"),x=(0,r.resolveComponent)("el-option"),V=(0,r.resolveComponent)("el-select"),E=(0,r.resolveComponent)("el-row"),A=s.Z,P=(0,r.resolveComponent)("country-flag"),S=(0,r.resolveComponent)("el-collapse-item"),T=(0,r.resolveComponent)("el-collapse"),N=(0,r.resolveComponent)("List"),I=n.Z,D=(0,r.resolveComponent)("el-date-picker"),R=o.Z,B=(0,r.resolveComponent)("el-card");return(0,r.openBlock)(),(0,r.createBlock)(B,{shadow:"never"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:16},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:12},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",l,(0,r.toDisplayString)(e.$t("orderNumber")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.code,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$parent.orderData.code=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("orderNumber")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:12},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",c,(0,r.toDisplayString)(e.$t("user")),1),(0,r.createVNode)(V,{modelValue:e.$parent.orderData.user,"onUpdate:modelValue":t[1]||(t[1]=t=>e.$parent.orderData.user=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.accounts,(e=>((0,r.openBlock)(),(0,r.createBlock)(x,{key:e.id,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1})])),_:1}),(0,r.createElementVNode)("span",d,(0,r.toDisplayString)(e.$t("note")),1),(0,r.createVNode)(A,{modelValue:e.$parent.orderData.note,"onUpdate:modelValue":t[2]||(t[2]=t=>e.$parent.orderData.note=t),type:"textarea",synchro:!0,placeholder:e.$t("note")},null,8,["modelValue","placeholder"]),(0,r.createVNode)(T,{class:"mt-10"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(S,{name:"1",title:"   "+e.$t("billing")},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",h,[(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:16},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("lastAndFirstNames")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.name,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$parent.orderData.billing.name=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("lastAndFirstNames")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("enterprise")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.enterprise,"onUpdate:modelValue":t[4]||(t[4]=t=>e.$parent.orderData.billing.enterprise=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("enterprise")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("firstAddressLine")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.address1,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$parent.orderData.billing.address1=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("firstAddressLine")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("secondAddressLine")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.address2,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$parent.orderData.billing.address2=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("secondAddressLine")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("city")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.city,"onUpdate:modelValue":t[7]||(t[7]=t=>e.$parent.orderData.billing.city=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("city")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("postalCode")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.postalCode,"onUpdate:modelValue":t[8]||(t[8]=t=>e.$parent.orderData.billing.postalCode=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("postalCode")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("country")),1),(0,r.createVNode)(V,{modelValue:e.$parent.orderData.billing.country,"onUpdate:modelValue":t[9]||(t[9]=t=>e.$parent.orderData.billing.country=t),filterable:"",size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,r.createSlots)({default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.countries,(e=>((0,r.openBlock)(),(0,r.createBlock)(x,{key:e.code,value:e.code,label:e.name},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",u,[(0,r.createVNode)(P,{iso:e.code,mode:"rounded",class:"mr-5"},null,8,["iso"]),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(e.name),1)])])),_:2},1032,["value","label"])))),128))])),_:2},[e.$parent.orderData.billing.country?{name:"prefix",fn:(0,r.withCtx)((()=>[(0,r.createVNode)(P,{iso:e.$parent.orderData.billing.country,mode:"rounded",class:"ml-10 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("region")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.region,"onUpdate:modelValue":t[10]||(t[10]=t=>e.$parent.orderData.billing.region=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("region")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("email")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.email,"onUpdate:modelValue":t[11]||(t[11]=t=>e.$parent.orderData.billing.email=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("email")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("phone")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.billing.phone,"onUpdate:modelValue":t[12]||(t[12]=t=>e.$parent.orderData.billing.phone=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("phone")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("paymentMethod")),1),(0,r.createVNode)(V,{modelValue:e.$parent.orderData.billing.paymentMethod,"onUpdate:modelValue":t[13]||(t[13]=t=>e.$parent.orderData.billing.paymentMethod=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.paymentMethods,(e=>((0,r.openBlock)(),(0,r.createBlock)(x,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1})])),_:1})])])),_:1},8,["title"]),(0,r.createVNode)(S,{name:"2",title:"   "+e.$t("expedition")},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",m,[(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:16},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("lastAndFirstNames")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.name,"onUpdate:modelValue":t[14]||(t[14]=t=>e.$parent.orderData.expedition.name=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("lastAndFirstNames")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("enterprise")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.enterprise,"onUpdate:modelValue":t[15]||(t[15]=t=>e.$parent.orderData.expedition.enterprise=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("enterprise")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("firstAddressLine")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.address1,"onUpdate:modelValue":t[16]||(t[16]=t=>e.$parent.orderData.expedition.address1=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("firstAddressLine")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("secondAddressLine")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.address2,"onUpdate:modelValue":t[17]||(t[17]=t=>e.$parent.orderData.expedition.address2=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("secondAddressLine")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("city")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.city,"onUpdate:modelValue":t[18]||(t[18]=t=>e.$parent.orderData.expedition.city=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("city")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("postalCode")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.postalCode,"onUpdate:modelValue":t[19]||(t[19]=t=>e.$parent.orderData.expedition.postalCode=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("postalCode")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("country")),1),(0,r.createVNode)(V,{modelValue:e.$parent.orderData.expedition.country,"onUpdate:modelValue":t[20]||(t[20]=t=>e.$parent.orderData.expedition.country=t),filterable:"",size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},(0,r.createSlots)({default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.countries,(e=>((0,r.openBlock)(),(0,r.createBlock)(x,{key:e.code,value:e.code,label:e.name},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",g,[(0,r.createVNode)(P,{iso:e.code,mode:"rounded",class:"mr-5"},null,8,["iso"]),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(e.name),1)])])),_:2},1032,["value","label"])))),128))])),_:2},[e.$parent.orderData.expedition.country?{name:"prefix",fn:(0,r.withCtx)((()=>[(0,r.createVNode)(P,{iso:e.$parent.orderData.expedition.country,mode:"rounded",class:"ml-10 mr-5"},null,8,["iso"])])),key:"0"}:void 0]),1032,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("region")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.region,"onUpdate:modelValue":t[21]||(t[21]=t=>e.$parent.orderData.expedition.region=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("region")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,r.createVNode)(E,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(k,{span:16},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("customerNote")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.note,"onUpdate:modelValue":t[22]||(t[22]=t=>e.$parent.orderData.expedition.note=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("customerNote")},null,8,["modelValue","placeholder"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,(0,r.toDisplayString)(e.$t("phone")),1),(0,r.createVNode)(C,{modelValue:e.$parent.orderData.expedition.phone,"onUpdate:modelValue":t[23]||(t[23]=t=>e.$parent.orderData.expedition.phone=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("phone")},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])])),_:1},8,["title"])])),_:1}),p,(0,r.createVNode)(N,{fees:e.$parent.orderData.fees,"onUpdate:fees":t[24]||(t[24]=t=>e.$parent.orderData.fees=t),modelValue:e.$parent.orderData.products,"onUpdate:modelValue":t[25]||(t[25]=t=>e.$parent.orderData.products=t),title:e.$t("productsList")},null,8,["fees","modelValue","title"]),f,(0,r.createVNode)(I,{list:e.$parent.orderData.customFields,title:e.$t("customFields"),style:{width:"100%"}},null,8,["list","title"])])),_:1}),(0,r.createVNode)(k,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(R,{top:60},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",w,(0,r.toDisplayString)(e.$t("orderDate")),1),(0,r.createVNode)(D,{modelValue:e.$parent.orderData.date,"onUpdate:modelValue":t[26]||(t[26]=t=>e.$parent.orderData.date=t),size:"default",class:"mb-10",type:"datetime",style:{width:"100%"},format:e.$parent.dateFormat+" HH:mm","value-format":"YYYY-MM-DD HH:mm"},null,8,["modelValue","format"]),(0,r.createElementVNode)("span",b,(0,r.toDisplayString)(e.$t("orderStatus")),1),(0,r.createVNode)(V,{modelValue:e.$parent.orderData.status,"onUpdate:modelValue":t[27]||(t[27]=t=>e.$parent.orderData.status=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.orderStatus,(e=>((0,r.openBlock)(),(0,r.createBlock)(x,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,r.createElementVNode)("span",_,(0,r.toDisplayString)(e.$t("applyPromoCode")),1),(0,r.createVNode)(V,{modelValue:e.$parent.orderData.promoCode,"onUpdate:modelValue":t[28]||(t[28]=t=>e.$parent.orderData.promoCode=t),size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.$parent.promotions,(e=>((0,r.openBlock)(),(0,r.createBlock)(x,{key:e.id,value:e.id,label:e.code},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1})])),_:1})])),_:1})])),_:1})}var y=i(21276);const C={key:0},k={key:0},x={key:0},V={style:{display:"flex","justify-content":"center","align-items":"center"}},E={key:0},A={class:"dialog-footer"};function P(e,t,i,o,n,s){const a=(0,r.resolveComponent)("el-col"),l=(0,r.resolveComponent)("el-button"),c=(0,r.resolveComponent)("el-row"),d=(0,r.resolveComponent)("el-tag"),h=(0,r.resolveComponent)("el-input-number"),u=(0,r.resolveComponent)("el-scrollbar"),m=(0,r.resolveComponent)("el-divider"),g=(0,r.resolveComponent)("el-input"),p=(0,r.resolveComponent)("el-option"),f=(0,r.resolveComponent)("el-select"),w=(0,r.resolveComponent)("el-dialog");return(0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,null,[(0,r.createElementVNode)("div",{class:"list",style:(0,r.normalizeStyle)(`background: ${e.pickByTheme("whitesmoke","dimgray")}`)},[(0,r.createVNode)(c,{class:"list-header mb-10"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:16,style:{"justify-content":"left"}},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("small",null,[(0,r.createElementVNode)("b",null,(0,r.toDisplayString)(i.title),1)])])),_:1}),(0,r.createVNode)(a,{span:8,style:{"justify-content":"right"}},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(l,{size:"default",circle:"",plain:"",icon:"refresh"}),(0,r.createVNode)(l,{size:"default",type:"primary",disabled:i.disabled||i.addBtnDisabled,onClick:t[0]||(t[0]=e=>n.addDialog=!0)},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("add")),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),(0,r.createVNode)(c,{class:"mt-10"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:24},{default:(0,r.withCtx)((()=>[s.selectedProducts.length?((0,r.openBlock)(),(0,r.createBlock)(c,{key:0,gutter:5,class:"mb-10"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"success",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("name")),1)])),_:1})])),_:1}),(0,r.createVNode)(a,{span:4},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"success",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("amnt")),1)])),_:1})])),_:1}),(0,r.createVNode)(a,{span:4},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"success",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("price")),1)])),_:1})])),_:1}),(0,r.createVNode)(a,{span:5},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"success",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("total")),1)])),_:1})])),_:1}),(0,r.createVNode)(a,{span:3},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"danger",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("action")),1)])),_:1})])),_:1})])),_:1})):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(u,{"max-height":"300px"},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(s.selectedProducts,((t,o)=>((0,r.openBlock)(),(0,r.createBlock)(c,{key:"product_"+o,gutter:5,class:"mb-5"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:8},{default:(0,r.withCtx)((()=>["number"==typeof t.price&&"number"==typeof t.amount?((0,r.openBlock)(),(0,r.createBlock)(d,{key:0,type:"info",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.tr(t.name)),1)])),_:2},1024)):(0,r.createCommentVNode)("",!0)])),_:2},1024),(0,r.createVNode)(a,{span:4},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(h,{modelValue:t.amount,"onUpdate:modelValue":e=>t.amount=e,modelModifiers:{number:!0},min:1,size:"default",style:{width:"100%"},"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,r.createVNode)(a,{span:4},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(h,{modelValue:t.price,"onUpdate:modelValue":e=>t.price=e,modelModifiers:{number:!0},min:0,size:"default",style:{width:"100%"},"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,r.createVNode)(a,{span:5},{default:(0,r.withCtx)((()=>["number"==typeof t.price&&"number"==typeof t.amount?((0,r.openBlock)(),(0,r.createBlock)(d,{key:0,type:"info",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(t.price*t.amount),1),s.currencyCode?((0,r.openBlock)(),(0,r.createElementBlock)("span",C," "+(0,r.toDisplayString)(s.currencyCode),1)):(0,r.createCommentVNode)("",!0)])),_:2},1024)):(0,r.createCommentVNode)("",!0)])),_:2},1024),(0,r.createVNode)(a,{span:3},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(l,{type:"danger",size:"default",icon:"delete",disabled:i.disabled||i.deleteBtnDisabled,style:{width:"100%"},onClick:e=>s.removeProduct(o)},null,8,["disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),s.selectedProducts.length?((0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,{key:0},[s.selectedProductsSubTotal?((0,r.openBlock)(),(0,r.createBlock)(c,{key:0,gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:10}),(0,r.createVNode)(a,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"info",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("productsSubTotal"))+" : ",1)])),_:1})])),_:1}),(0,r.createVNode)(a,{span:6},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(s.selectedProductsSubTotal),1),s.currencyCode?((0,r.openBlock)(),(0,r.createElementBlock)("span",k," "+(0,r.toDisplayString)(s.currencyCode),1)):(0,r.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1})):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(c,{gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:24},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(m,{"content-position":"right"},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("fees"))+" ",1),(0,r.createVNode)(l,{size:"default",icon:"plus",class:"ml-5",plain:"",circle:"",onClick:t[1]||(t[1]=e=>s.addFee())})])),_:1})])),_:1})])),_:1}),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(i.fees,((e,t)=>((0,r.openBlock)(),(0,r.createBlock)(c,{key:t,gutter:5,class:"mb-5"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:5}),(0,r.createVNode)(a,{span:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(g,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,size:"default",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,r.createVNode)(a,{span:6},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(h,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,modelModifiers:{number:!0},min:0,size:"default",style:{width:"100%"},"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,r.createVNode)(a,{span:3},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(l,{type:"danger",size:"default",icon:"delete",disabled:i.disabled||i.deleteBtnDisabled,style:{width:"100%"},onClick:e=>s.removeFee(t)},null,8,["disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128)),s.feesSubTotal?((0,r.openBlock)(),(0,r.createBlock)(c,{key:1,gutter:10},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:10}),(0,r.createVNode)(a,{span:8},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{type:"info",size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("feesSubTotal"))+" : ",1)])),_:1})])),_:1}),(0,r.createVNode)(a,{span:6},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(d,{size:"default",color:"white",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(s.feesSubTotal),1),s.currencyCode?((0,r.openBlock)(),(0,r.createElementBlock)("span",x," "+(0,r.toDisplayString)(s.currencyCode),1)):(0,r.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1})):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(c,{gutter:10,class:"mt-10"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(a,{span:24},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(m,{"content-position":"right"},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",V,[(0,r.createElementVNode)("b",null,(0,r.toDisplayString)(e.$t("total")),1),(0,r.createVNode)(d,{type:"info",size:"default",color:"white",class:"ml-10",style:{width:"100%"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(s.total),1),s.currencyCode?((0,r.openBlock)(),(0,r.createElementBlock)("span",E," "+(0,r.toDisplayString)(s.currencyCode),1)):(0,r.createCommentVNode)("",!0)])),_:1})])])),_:1})])),_:1})])),_:1})],64)):(0,r.createCommentVNode)("",!0)],4),(0,r.createVNode)(w,{modelValue:n.addDialog,"onUpdate:modelValue":t[4]||(t[4]=e=>n.addDialog=e),title:e.$t("add"),width:"35%"},{footer:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",A,[(0,r.createVNode)(l,{onClick:t[3]||(t[3]=e=>n.addDialog=!1)},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("close")),1)])),_:1})])])),default:(0,r.withCtx)((()=>[(0,r.createVNode)(f,{modelValue:s.selectedProducts,"onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedProducts=e),multiple:"",filterable:"",size:"large",class:"mb-10","value-key":"id",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.products.map((e=>({id:e.id,name:e.name,price:parseFloat(e.selling_price)||0,amount:1}))),(t=>((0,r.openBlock)(),(0,r.createBlock)(p,{key:t.id,value:t,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1},8,["modelValue","title"])],64)}i(57658);var S=i(5867),T=i(98761),N=i(38855);const I={name:"List",mixins:[S.Z,T.Z,N.Z],props:{title:{type:String,default:""},modelValue:{type:Array,required:!0},fees:{type:Array,required:!0},disabled:{type:Boolean,default:!1},addBtnDisabled:{type:Boolean,default:!1},deleteBtnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","update:fees"],data(){return{addDialog:!1}},computed:{currencyCode(){return this.currencies.find((e=>e.id==this.currency))?.code||""},selectedProducts:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},selectedProductsSubTotal(){let e=0;return this.selectedProducts?.forEach((t=>{t.amount&&t.price&&(e+=parseFloat(t.amount)*parseFloat(t.price))})),e},feesSubTotal(){let e=0;return this.fees?.forEach((t=>{t.name&&t.value&&(e+=parseFloat(t.value))})),e},total(){return this.selectedProductsSubTotal+this.feesSubTotal},dividerBg(){return this.pickByTheme("whitesmoke","dimgray")}},methods:{removeProduct(e){this.selectedProducts.splice(e,1)},addFee(){const e=this.$_.cloneDeep(this.fees);e.push({name:"",value:0}),this.$emit("update:fees",e)},removeFee(e){const t=this.$_.cloneDeep(this.fees);t.splice(e,1),this.$emit("update:fees",t)}}},D=()=>{(0,r.useCssVars)((e=>({"5b1bb52e":e.dividerBg})))},R=I.setup;I.setup=R?(e,t)=>(D(),R(e,t)):D;var B=I,M=i(83744);const O=(0,M.Z)(B,[["render",P],["__scopeId","data-v-25a6ab67"]]);var L=O,$={name:"Form",components:{VueDraggableNext:y.VueDraggableNext,List:L}};const F=(0,M.Z)($,[["render",v],["__scopeId","data-v-95339c84"]]);var z=F},36230:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return m}});i(57658);var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}},s={class:"mb-5"},r={key:0},a={style:{"text-align":"center","margin-top":"20px",display:"flex"}};function l(e,t,i,l,c,d){const h=(0,o.resolveComponent)("el-col"),u=(0,o.resolveComponent)("el-button"),m=(0,o.resolveComponent)("el-row"),g=(0,o.resolveComponent)("el-card"),p=(0,o.resolveComponent)("el-table-column"),f=(0,o.resolveComponent)("el-input"),w=(0,o.resolveComponent)("el-table"),b=(0,o.resolveComponent)("el-pagination"),_=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(g,{class:"mb-5 header-card",shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("ordersManagement")),1)])),_:1}),(0,o.createVNode)(h,{span:12,class:"text-right"},{default:(0,o.withCtx)((()=>[c.multipleSelection.length?((0,o.openBlock)(),(0,o.createBlock)(u,{key:0,size:"default",type:"danger",icon:"delete",onClick:d.deleteMultipleItems},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("delete")),1)])),_:1},8,["onClick"])):((0,o.openBlock)(),(0,o.createBlock)(u,{key:1,size:"default",type:"primary",icon:"plus",onClick:t[0]||(t[0]=t=>e.$router.push(e.Routes.E_COMMERCE.PATH+"/add-order"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("addOrder")),1)])),_:1}))])),_:1})])),_:1})])),_:1}),(0,o.createVNode)(g,{shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("small",null,[c.multipleSelection.length?((0,o.openBlock)(),(0,o.createElementBlock)("b",r,(0,o.toDisplayString)(e.$t("xSelectedItems",[c.multipleSelection.length])),1)):(0,o.createCommentVNode)("",!0)])]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(w,{border:"",stripe:"",data:d.pagedTableData,"empty-text":e.$t("noData"),style:{width:"100%"},onSelectionChange:d.handleSelectionChange},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{width:"50",type:"selection",fixed:""}),(0,o.createVNode)(p,{sortable:"",label:e.$t("code"),prop:"code",width:"150",fixed:""},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("h4",null,(0,o.toDisplayString)(e.row.code),1)])),_:1},8,["label"]),(0,o.createVNode)(p,{sortable:"",label:e.$t("status"),prop:"status",width:"175",fixed:"","show-overflow-tooltip":""},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(e.orderStatus.find((e=>e.id==t.row.status))?.label),1)])),_:1},8,["label"]),(0,o.createVNode)(p,{sortable:"",label:e.$t("orderDate"),width:"200"},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.reformatDate(t.row.date,{inPattern:"YYYY-MM-DD HH:mm",outPattern:e.dateFormat+" HH:mm",locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,o.createVNode)(p,{sortable:"",label:e.$t("user"),prop:"user",width:"200"},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.accounts.find((e=>e.id==t.row.user))?.name),1)])),_:1},8,["label"]),(0,o.createVNode)(p,{sortable:"",label:e.$t("note"),prop:"note",width:"200"},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(e.row.note),1)])),_:1},8,["label"]),(0,o.createVNode)(p,{sortable:"",label:e.$t("addedOn"),width:"160"},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.reformatDate(t.row.insert_datetime,{inPattern:"YYYY-MM-DD HH:mm:ss",outPattern:e.dateFormat+" - HH:mm",locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,o.createVNode)(p,{align:"right",width:"200",fixed:"right"},{header:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{modelValue:c.search,"onUpdate:modelValue":t[1]||(t[1]=e=>c.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,o.withCtx)((t=>[(0,o.createVNode)(m,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{size:"small",type:"warning",icon:"edit",style:{width:"100%"},title:e.$t("edit"),disabled:!!c.multipleSelection.length,onClick:e=>d.editItem(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1024),(0,o.createVNode)(h,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{size:"small",type:"danger",icon:"delete",style:{width:"100%"},title:e.$t("delete"),disabled:!!c.multipleSelection.length,onClick:e=>d.deleteItem(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1024)])),_:2},1024)])),_:1})])),_:1},8,["data","empty-text","onSelectionChange"])),[[_,c.isLoading]]),(0,o.createElementVNode)("div",a,[(0,o.createVNode)(b,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":c.pageSize,total:c.total,onCurrentChange:d.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1})],64)}var c=i(5867),d={name:"Orders",mixins:[c.Z],data(){return{currentEditItem:null,multipleSelection:[],isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.code.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},created(){this.init()},methods:{setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},handleSelectionChange(e){this.multipleSelection=e},async init(){this.isLoading=!0;const e=await this.getAllOrders();e.data&&(this.tableData=e.data),e.failure&&this.$message.error(this.$t("unableToUpdateData")),this.isLoading=!1},async editItem(e,t){this.$router.push({name:"EditOrder"+this.Routes.E_COMMERCE.NAME,params:{order:t.id}})},deleteItem(e,t){this.$confirm(this.$t("deleteOrderQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteItemInDB({context:this.E_COMMERCE_ORDER_CONTEXT,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},deleteMultipleItems(){this.$confirm(1===this.multipleSelection.length?this.$t("deleteOrderQuestion"):this.$t("deleteMultipleItems",[this.multipleSelection.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.multipleSelection.length;t++)await this.deleteItemInDB({context:this.E_COMMERCE_ORDER_CONTEXT,id:this.multipleSelection[t].id});e.close(),this.$message.success(this.$t("success")),this.init()})).catch((()=>{}))}}},h=i(83744);const u=(0,h.Z)(d,[["render",l]]);var m=u},99663:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}};function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-button"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("Form");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("addProduct")),1)])),_:1}),(0,o.createVNode)(l,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,o.createElementVNode)("section",null,[(0,o.createVNode)(u)])],64)}var r=i(36833),a=i(12470),l={name:"AddProduct",components:{Form:a.Z},mixins:[r.Z],data(){return{products:[]}},async created(){const e=await this.$store.dispatch("eCommerceProduct/getAllProducts",{root:!0});e.success&&e.data&&(this.products=e.data),this.$store.dispatch("eCommerceShelf/getAllShelves",{root:!0}),this.$store.dispatch("user/getAllUsers",{root:!0}),this.loadCategories()},methods:{async save(){if(this.dataProvided){if(this.products.findIndex((e=>this.tr(e.name)==this.tr(this.productData.name)))>-1)return this.$message.error(this.$t("sameProductNameError")),!1;const e=await this.addItemInDB({context:this.E_COMMERCE_PRODUCT_CONTEXT,data:{previews:JSON.stringify(this.productData.previews),code:this.productData.code,name:this.productData.name,type:this.productData.type,categories:JSON.stringify(this.productData.categories),short_description:this.productData.shortDescription,long_description:this.productData.longDescription,display:this.productData.display,stock_status:this.productData.stockStatus,selling_price:this.productData.sellingPrice,promo_price:this.productData.promoPrice,amount_available:this.productData.amountAvailable,amount_total:this.productData.amountTotal,single_selling:this.productData.singleSelling,shipping:this.productData.shipping,features:JSON.stringify(this.productData.features),attached_document:this.productData.attachedDocument,shelf:this.productData.shelf||0}});e.success?this.redirectToList?this.$router.replace(this.Routes.E_COMMERCE.PATH+"/products"):(this.$message.success(this.$t("success")),this.keepFormData||(this.productData={previews:[],code:"",name:"",type:this.ProductTypes.SIMPLE.id,categories:[],shortDescription:"",longDescription:"",display:0,stockStatus:this.StockStatus.AVAILABLE.id,sellingPrice:0,promoPrice:0,amountAvailable:0,amountTotal:0,singleSelling:0,shipping:0,features:[],attachedDocument:"",shelf:""})):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",s]]);var h=d},58722:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}};function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-button"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("Form"),m=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("editProduct")),1)])),_:1}),(0,o.createVNode)(l,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("section",null,[(0,o.createVNode)(u)])),[[m,r.isLoading]])],64)}var r=i(36833),a=i(12470),l={name:"EditProduct",components:{Form:a.Z},mixins:[r.Z],data(){return{isLoading:!1,currentName:"",products:[]}},async created(){const e=await this.$store.dispatch("eCommerceProduct/getAllProducts",{root:!0});e.success&&e.data&&(this.products=e.data),this.$store.dispatch("eCommerceShelf/getAllShelves",{root:!0}),this.$store.dispatch("user/getAllUsers",{root:!0}),this.loadCategories(),this.init()},methods:{async init(){if(this.$route.params&&this.$route.params.product){this.isLoading=!0;const e=await this.getItemFromDB({context:this.E_COMMERCE_PRODUCT_CONTEXT,id:this.$route.params.product});e.data&&e.success?(this.productData={previews:JSON.parse(e.data.previews),code:e.data.code,name:e.data.name,type:parseInt(e.data.type),categories:JSON.parse(e.data.categories),shortDescription:e.data.short_description,longDescription:e.data.long_description,display:parseInt(e.data.display),stockStatus:parseInt(e.data.stock_status),sellingPrice:parseFloat(e.data.selling_price),promoPrice:parseFloat(e.data.promo_price),amountAvailable:parseFloat(e.data.amount_available),amountTotal:parseFloat(e.data.amount_total),singleSelling:parseInt(e.data.single_selling),shipping:parseInt(e.data.shipping),features:JSON.parse(e.data.features),attachedDocument:e.data.attached_document,shelf:parseInt(e.data.shelf)?e.data.shelf:""},this.currentName=e.data.name,this.isLoading=!1):this.$router.replace(this.Routes.E_COMMERCE.PATH+"/products")}else this.$router.replace(this.Routes.E_COMMERCE.PATH+"/products")},async save(){if(this.dataProvided){if(this.tr(this.currentName)!==this.tr(this.productData.name)&&this.products.findIndex((e=>this.tr(e.name)==this.tr(this.productData.name)))>-1)return this.$message.error(this.$t("sameProductNameError")),!1;const e=await this.updateItemInDB({context:this.E_COMMERCE_PRODUCT_CONTEXT,id:this.$route.params.product,data:{previews:JSON.stringify(this.productData.previews),code:this.productData.code,name:this.productData.name,type:this.productData.type,categories:JSON.stringify(this.productData.categories),short_description:this.productData.shortDescription,long_description:this.productData.longDescription,display:this.productData.display,stock_status:this.productData.stockStatus,selling_price:this.productData.sellingPrice,promo_price:this.productData.promoPrice,amount_available:this.productData.amountAvailable,amount_total:this.productData.amountTotal,single_selling:this.productData.singleSelling,shipping:this.productData.shipping,features:JSON.stringify(this.productData.features),attached_document:this.productData.attachedDocument,shelf:this.productData.shelf||0}});e.success?this.$router.replace(this.Routes.E_COMMERCE.PATH+"/products"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",s]]);var h=d},12470:function(e,t,i){"use strict";i.d(t,{Z:function(){return H}});var o=i(68716),n=i(97200),s=i(30780),r=i(12670),a=i(82234);const l=e=>((0,a.pushScopeId)("data-v-05fc046b"),e=e(),(0,a.popScopeId)(),e),c={class:"item-title"},d={class:"item-title"},h={key:0,style:{color:"#000"}},u={key:1},m=l((()=>(0,a.createElementVNode)("div",{class:"mb-10"},null,-1))),g={class:"item-title"},p={key:0},f={class:"item-title"},w={key:0},b=l((()=>(0,a.createElementVNode)("div",{class:"mb-10"},null,-1))),_={class:"item-title"},v={class:"item-title"},y=l((()=>(0,a.createElementVNode)("div",{class:"mb-10"},null,-1))),C={class:"item-title"},k={class:"item-title"},x={class:"item-title"},V=l((()=>(0,a.createElementVNode)("div",{class:"mb-10"},null,-1))),E={class:"item-title"},A={class:"card-header"},P={class:"text-center"},S={key:1},T={class:"card-header"},N={style:{color:"dimgray"}},I={class:"item-title"},D={class:"item-title"},R={class:"item-title"};function B(e,t,i,l,B,M){const O=r.Z,L=(0,a.resolveComponent)("el-option"),$=(0,a.resolveComponent)("el-select"),F=(0,a.resolveComponent)("el-input-number"),z=(0,a.resolveComponent)("el-col"),Z=(0,a.resolveComponent)("el-row"),H=(0,a.resolveComponent)("el-card"),U=(0,a.resolveComponent)("el-divider"),W=(0,a.resolveComponent)("el-button"),q=(0,a.resolveComponent)("el-image"),G=(0,a.resolveComponent)("vue-draggable-next"),j=s.Z,K=(0,a.resolveComponent)("Document"),J=(0,a.resolveComponent)("el-icon"),Y=(0,a.resolveComponent)("el-input"),Q=(0,a.resolveComponent)("el-radio-button"),X=(0,a.resolveComponent)("el-radio-group"),ee=(0,a.resolveComponent)("el-checkbox"),te=n.Z,ie=(0,a.resolveComponent)("el-image-viewer"),oe=o.Z,ne=(0,a.resolveComponent)("el-dialog");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createVNode)(H,{shadow:"never"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,{gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(z,{span:16},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",c,(0,a.toDisplayString)(e.$t("name")),1),(0,a.createVNode)(O,{modelValue:e.$parent.productData.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$parent.productData.name=t),class:"mb-10",synchro:!0,placeholder:e.$t("enterTheProductName"),type:"text"},null,8,["modelValue","placeholder"]),(0,a.createElementVNode)("span",d,(0,a.toDisplayString)(e.$t("categories")),1),(0,a.createVNode)($,{modelValue:e.$parent.productData.categories,"onUpdate:modelValue":t[1]||(t[1]=t=>e.$parent.productData.categories=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.$parent.categories,(t=>((0,a.openBlock)(),(0,a.createBlock)(L,{key:t.id,value:t.id,label:e.tr(t.name)},{default:(0,a.withCtx)((()=>[t.isParent?((0,a.openBlock)(),(0,a.createElementBlock)("b",h,(0,a.toDisplayString)(e.tr(t.name)),1)):((0,a.openBlock)(),(0,a.createElementBlock)("span",u,(0,a.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),m,(0,a.createVNode)(H,{shadow:"hover"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,{gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(z,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",g,[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("sellingPrice"))+" ",1),M.currencyCode?((0,a.openBlock)(),(0,a.createElementBlock)("span",p,"- "+(0,a.toDisplayString)(M.currencyCode),1)):(0,a.createCommentVNode)("",!0)]),(0,a.createVNode)(F,{modelValue:e.$parent.productData.sellingPrice,"onUpdate:modelValue":t[2]||(t[2]=t=>e.$parent.productData.sellingPrice=t),modelModifiers:{number:!0},size:"default",style:{width:"100%"},"controls-position":"right",label:e.$t("sellingPrice"),min:0},null,8,["modelValue","label"])])),_:1}),(0,a.createVNode)(z,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",f,[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("promoPrice"))+" ",1),M.currencyCode?((0,a.openBlock)(),(0,a.createElementBlock)("span",w,"- "+(0,a.toDisplayString)(M.currencyCode),1)):(0,a.createCommentVNode)("",!0)]),(0,a.createVNode)(F,{modelValue:e.$parent.productData.promoPrice,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$parent.productData.promoPrice=t),modelModifiers:{number:!0},size:"default",style:{width:"100%"},"controls-position":"right",label:e.$t("promoPrice"),min:0},null,8,["modelValue","label"])])),_:1})])),_:1}),b,(0,a.createVNode)(Z,{gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(z,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",_,(0,a.toDisplayString)(e.$t("amountTotal")),1),(0,a.createVNode)(F,{modelValue:e.$parent.productData.amountTotal,"onUpdate:modelValue":t[4]||(t[4]=t=>e.$parent.productData.amountTotal=t),modelModifiers:{number:!0},size:"default",style:{width:"100%"},"controls-position":"right",label:e.$t("amountTotal"),min:0},null,8,["modelValue","label"])])),_:1}),(0,a.createVNode)(z,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",v,(0,a.toDisplayString)(e.$t("amountAvailable")),1),(0,a.createVNode)(F,{modelValue:e.$parent.productData.amountAvailable,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$parent.productData.amountAvailable=t),modelModifiers:{number:!0},size:"default",style:{width:"100%"},"controls-position":"right",label:e.$t("amountAvailable"),min:0},null,8,["modelValue","label"])])),_:1})])),_:1})])),_:1}),y,(0,a.createVNode)(H,{shadow:"hover"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Z,{gutter:10},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(z,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",C,(0,a.toDisplayString)(e.$t("type")),1),(0,a.createVNode)($,{modelValue:e.$parent.productData.type,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$parent.productData.type=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.$parent.productTypes,(e=>((0,a.openBlock)(),(0,a.createBlock)(L,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1}),(0,a.createVNode)(z,{span:12},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",k,(0,a.toDisplayString)(e.$t("stockStatus")),1),(0,a.createVNode)($,{modelValue:e.$parent.productData.stockStatus,"onUpdate:modelValue":t[7]||(t[7]=t=>e.$parent.productData.stockStatus=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.$parent.stockStatus,(e=>((0,a.openBlock)(),(0,a.createBlock)(L,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"])])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(U),(0,a.createElementVNode)("span",x,(0,a.toDisplayString)(e.$t("shortDescription")),1),(0,a.createVNode)(O,{modelValue:e.$parent.productData.shortDescription,"onUpdate:modelValue":t[8]||(t[8]=t=>e.$parent.productData.shortDescription=t),type:"editor",synchro:!0,placeholder:e.$t("productShortDescription"),class:"product-content-editor"},null,8,["modelValue","placeholder"]),V,(0,a.createElementVNode)("span",E,(0,a.toDisplayString)(e.$t("longDescription")),1),(0,a.createVNode)(O,{modelValue:e.$parent.productData.longDescription,"onUpdate:modelValue":t[9]||(t[9]=t=>e.$parent.productData.longDescription=t),type:"editor",synchro:!0,placeholder:e.$t("productLongDescription"),class:"product-content-editor"},null,8,["modelValue","placeholder"]),(0,a.createVNode)(U),(0,a.createVNode)(H,{shadow:"hover",class:"previews-card mb-10"},{header:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",A,[(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(e.$t("productPreviews")),1),(0,a.createVNode)(W,{size:"default",type:"primary",onClick:t[10]||(t[10]=t=>e.$parent.pickerVisible=!0)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("add")),1)])),_:1})])])),default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",P,[e.$parent.productData.previews.length?((0,a.openBlock)(),(0,a.createBlock)(G,{key:0,list:e.$parent.productData.previews,class:"el-row mr-5 ml-5"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.$parent.productData.previews,((t,i)=>((0,a.openBlock)(),(0,a.createBlock)(z,{key:i,span:4,class:"preview-item mb-5 mt-5"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(q,{fit:"cover",class:"preview-item-img",src:e.resolveMediaLink(t),onClick:t=>e.$parent.openViewer(i)},null,8,["src","onClick"]),(0,a.createVNode)(W,{icon:"delete",class:"delete-btn",type:"danger",size:"default",circle:"",onClick:t=>e.$parent.removePreview(i)},null,8,["onClick"])])),_:2},1024)))),128))])),_:1},8,["list"])):((0,a.openBlock)(),(0,a.createElementBlock)("h5",S,(0,a.toDisplayString)(e.$t("noPreviewAdded")),1))])])),_:1}),(0,a.createVNode)(U),(0,a.createVNode)(j,{list:e.$parent.productData.features,title:e.$t("productFeatures"),style:{width:"100%"}},null,8,["list","title"]),(0,a.createVNode)(U),(0,a.createVNode)(H,{shadow:"hover",class:"document-card"},{header:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",T,[(0,a.createElementVNode)("h5",null,[(0,a.createVNode)(J,{class:"mr-5"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(K)])),_:1}),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(e.$t("attachedDocument")),1)]),(0,a.createElementVNode)("h5",N,(0,a.toDisplayString)(M.filenameFromUrl(e.$parent.productData.attachedDocument)),1),(0,a.createVNode)(W,{size:"default",type:"primary",onClick:t[11]||(t[11]=t=>e.$parent.docPickerVisible=!0)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("add")),1)])),_:1})])])),_:1})])),_:1}),(0,a.createVNode)(z,{span:8},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(te,{top:60},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",I,(0,a.toDisplayString)(e.$t("code")),1),(0,a.createVNode)(Y,{modelValue:e.$parent.productData.code,"onUpdate:modelValue":t[12]||(t[12]=t=>e.$parent.productData.code=t),class:"mb-10",style:{width:"100%"},placeholder:e.$t("code")},null,8,["modelValue","placeholder"]),(0,a.createElementVNode)("span",D,(0,a.toDisplayString)(e.$t("status")),1),(0,a.createVNode)(X,{modelValue:e.$parent.productData.display,"onUpdate:modelValue":t[13]||(t[13]=t=>e.$parent.productData.display=t),class:"mb-10 product-display"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(Q,{label:0},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("unpublished")),1)])),_:1}),(0,a.createVNode)(Q,{label:1},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.$t("published")),1)])),_:1})])),_:1},8,["modelValue"]),(0,a.createElementVNode)("span",R,(0,a.toDisplayString)(e.$t("shelf")),1),(0,a.createVNode)($,{modelValue:e.$parent.productData.shelf,"onUpdate:modelValue":t[14]||(t[14]=t=>e.$parent.productData.shelf=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.$parent.shelves,(t=>((0,a.openBlock)(),(0,a.createBlock)(L,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,a.createVNode)(H,{shadow:"hover",class:"options-card mb-10"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(ee,{modelValue:e.$parent.productData.singleSelling,"onUpdate:modelValue":t[15]||(t[15]=t=>e.$parent.productData.singleSelling=t),"true-label":1,"false-label":0,label:e.$t("sellIndividually"),size:"default"},null,8,["modelValue","label"])]),(0,a.createElementVNode)("div",null,[(0,a.createVNode)(ee,{modelValue:e.$parent.productData.shipping,"onUpdate:modelValue":t[16]||(t[16]=t=>e.$parent.productData.shipping=t),"true-label":1,"false-label":0,label:e.$t("shippingAvailable"),size:"default"},null,8,["modelValue","label"])])])),_:1}),e.$parent.isAddPage?((0,a.openBlock)(),(0,a.createBlock)(H,{key:0,shadow:"hover",class:"options-card mb-10"},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,[(0,a.createVNode)(ee,{modelValue:e.$parent.redirectToList,"onUpdate:modelValue":t[17]||(t[17]=t=>e.$parent.redirectToList=t),label:e.$t("redirectToProductsList"),size:"default"},null,8,["modelValue","label"])]),(0,a.createElementVNode)("div",null,[(0,a.createVNode)(ee,{modelValue:e.$parent.keepFormData,"onUpdate:modelValue":t[18]||(t[18]=t=>e.$parent.keepFormData=t),label:e.$t("keepFormData"),size:"default"},null,8,["modelValue","label"])])])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),e.$parent.showViewer?((0,a.openBlock)(),(0,a.createBlock)(ie,{key:0,"hide-on-click-modal":"","initial-index":e.$parent.currentPreviewIndex,"url-list":e.$parent.productData.previews.map((t=>e.resolveMediaLink(t))),onClose:t[19]||(t[19]=t=>e.$parent.showViewer=!1)},null,8,["initial-index","url-list"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(ne,{modelValue:e.$parent.pickerVisible,"onUpdate:modelValue":t[20]||(t[20]=t=>e.$parent.pickerVisible=t),title:e.$t("productPreviews"),"destroy-on-close":"",fullscreen:"",top:"1vh"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(oe,{multiple:!0,"display-videos":!1,"display-audios":!1,"display-documents":!1,"display-other-types":!1,"init-selected-medias":e.$parent.productData.previews,onSelected:e.$parent.onPreviewsSelected},null,8,["init-selected-medias","onSelected"])])),_:1},8,["modelValue","title"]),(0,a.createVNode)(ne,{modelValue:e.$parent.docPickerVisible,"onUpdate:modelValue":t[21]||(t[21]=t=>e.$parent.docPickerVisible=t),title:e.$t("attachedDocument"),"destroy-on-close":"",fullscreen:"",top:"1vh"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(oe,{"display-images":!1,"display-videos":!1,"display-audios":!1,"display-documents":!0,"display-other-types":!1,onSelected:e.$parent.onDocSelected},null,8,["onSelected"])])),_:1},8,["modelValue","title"])],64)}var M=i(92829),O=i(98761),L=i(38855),$=i(21276),F={components:{VueDraggableNext:$.VueDraggableNext},mixins:[O.Z,L.Z],computed:{currencyCode(){return this.currencies.find((e=>e.id==this.currency))?.code||""}},methods:{filenameFromUrl:M.v$}},z=i(83744);const Z=(0,z.Z)(F,[["render",B],["__scopeId","data-v-05fc046b"]]);var H=Z},86497:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return z}});var o=i(97200),n=(i(57658),i(82234));const s={key:0},r={key:0,class:"item-selector"},a={class:"item-actions"},l={class:"image-slot"},c={class:"text-center product-item-name"},d={class:"text-center"},h={key:1,class:"no-products-container mt-5"},u={class:"text-center"},m={class:"dialog-footer"};function g(e,t,i,g,p,f){const w=(0,n.resolveComponent)("el-page-header"),b=(0,n.resolveComponent)("el-col"),_=(0,n.resolveComponent)("el-checkbox"),v=(0,n.resolveComponent)("el-button"),y=(0,n.resolveComponent)("el-input"),C=(0,n.resolveComponent)("el-row"),k=(0,n.resolveComponent)("el-tab-pane"),x=(0,n.resolveComponent)("el-tabs"),V=o.Z,E=(0,n.resolveComponent)("font-awesome-icon"),A=(0,n.resolveComponent)("Picture"),P=(0,n.resolveComponent)("el-icon"),S=(0,n.resolveComponent)("el-image"),T=(0,n.resolveComponent)("text-clamp"),N=(0,n.resolveComponent)("loading"),I=(0,n.resolveComponent)("infinite-loading"),D=(0,n.resolveComponent)("el-card"),R=(0,n.resolveComponent)("el-image-viewer"),B=(0,n.resolveComponent)("Details"),M=(0,n.resolveComponent)("el-dialog"),O=(0,n.resolveComponent)("el-form-item"),L=(0,n.resolveComponent)("el-form"),$=(0,n.resolveDirective)("loading");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(V,{"z-index":1e3,top:50,"class-name":"sticky-header",style:{height:"auto"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(C,{gutter:5,class:"mb-5 mt-5",align:"middle"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(b,{span:3},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(w,{title:e.$t("back"),onBack:t[0]||(t[0]=t=>e.$router.back())},null,8,["title"])])),_:1}),(0,n.createVNode)(b,{span:12,style:{display:"flex","justify-content":"right","align-items":"center"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(_,{modelValue:p.enableMultiselect,"onUpdate:modelValue":t[1]||(t[1]=e=>p.enableMultiselect=e),border:"",size:"small",class:"multiselectToggler",disabled:!f.filteredProducts.length,onChange:t[2]||(t[2]=e=>p.selectedProducts=[])},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("groupedSelection"))+" ",1),p.selectedProducts&&p.selectedProducts.length?((0,n.openBlock)(),(0,n.createElementBlock)("span",s,"("+(0,n.toDisplayString)(p.selectedProducts.length)+")",1)):(0,n.createCommentVNode)("",!0)])),_:1},8,["modelValue","disabled"]),p.enableMultiselect&&f.filteredProducts.length?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)(_,{border:"",size:"small",class:"ml-5",indeterminate:p.isSelectAllIndeterminate,"model-value":p.selectedProducts.length==f.filteredProducts.length,label:e.$t("selectAll"),onChange:f.handleSelectAll},null,8,["indeterminate","model-value","label","onChange"]),(0,n.createVNode)(v,{size:"small",type:"danger",class:"ml-5 mr-5",icon:"delete",disabled:!p.selectedProducts.length,onClick:t[3]||(t[3]=e=>f.deleteMultipleItems())},null,8,["disabled"])],64)):(0,n.createCommentVNode)("",!0)])),_:1}),(0,n.createVNode)(b,{span:5},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(y,{modelValue:p.productSearch,"onUpdate:modelValue":t[4]||(t[4]=e=>p.productSearch=e),size:"small",placeholder:e.$t("search")},{append:(0,n.withCtx)((()=>[(0,n.createVNode)(v,{icon:"search",size:"small",style:{cursor:"auto"}})])),_:1},8,["modelValue","placeholder"])])),_:1}),(0,n.createVNode)(b,{span:4},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(v,{size:"small",type:"primary",icon:"box",style:{width:"100%"},onClick:t[5]||(t[5]=t=>e.$router.push(p.Routes.E_COMMERCE.PATH+"/add-product"))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("addProduct")),1)])),_:1})])),_:1})])),_:1}),(0,n.createVNode)(C,{gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(b,{span:24},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(x,{modelValue:p.currentShelf,"onUpdate:modelValue":t[6]||(t[6]=e=>p.currentShelf=e),addable:"",type:"card",class:"sub-header",onTabClick:f.changeShelf,onTabRemove:f.deleteShelf,onTabAdd:t[7]||(t[7]=e=>p.addShelfDialog=!0)},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(),(0,n.createBlock)(k,{key:0,label:e.$t("allProducts"),closable:!1,name:"all"},null,8,["label"])),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(p.shelves,(t=>((0,n.openBlock)(),(0,n.createBlock)(k,{key:t.id,closable:!0,name:t.id,label:e.tr(t.name)},null,8,["name","label"])))),128))])),_:1},8,["modelValue","onTabClick","onTabRemove"])])),_:1})])),_:1})])),_:1}),(0,n.createVNode)(D,{shadow:"never"},{default:(0,n.withCtx)((()=>[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",null,[f.filteredProducts&&f.filteredProducts.length>0?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)(C,{gutter:10,class:"mt-5"},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(f.filteredProducts,((t,i)=>((0,n.openBlock)(),(0,n.createBlock)(b,{key:i,span:6,class:"mb-10 item-container",onMouseover:e=>t.displayActions=!0,onMouseleave:e=>t.displayActions=!1},{default:(0,n.withCtx)((()=>[p.enableMultiselect?((0,n.openBlock)(),(0,n.createElementBlock)("div",r,[(0,n.createVNode)(_,{size:"default","model-value":p.selectedProducts.findIndex((e=>e.id==t.id))>-1,onChange:e=>f.updateSelectedProducts(t,i)},null,8,["model-value","onChange"])])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(n.Transition,{name:"el-fade-in"},{default:(0,n.withCtx)((()=>[(0,n.withDirectives)((0,n.createElementVNode)("div",a,[(0,n.createVNode)(E,{icon:"eye",class:"item-actions-btn",onClick:e=>f.showPreviews(t,i)},null,8,["onClick"]),(0,n.createVNode)(E,{icon:"info-circle",class:"item-actions-btn",onClick:e=>f.showDetails(t,i)},null,8,["onClick"]),(0,n.createVNode)(E,{icon:"edit",class:"item-actions-btn",onClick:e=>f.editItem(t,i)},null,8,["onClick"]),(0,n.createVNode)(E,{icon:"trash",class:"item-actions-btn",onClick:e=>f.deleteItem(t,i)},null,8,["onClick"])],512),[[n.vShow,t.displayActions||!1]])])),_:2},1024),(0,n.createVNode)(S,{class:"item-img",src:f.parsePreviews(t.previews)[0],fit:"cover"},{error:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",l,[(0,n.createVNode)(P,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(A)])),_:1})])])),_:2},1032,["src"]),(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("small",null,[(0,n.createElementVNode)("b",null,[(0,n.createVNode)(T,{text:e.tr(t.name),"max-lines":2},null,8,["text"])])])])])),_:2},1032,["onMouseover","onMouseleave"])))),128))])),_:1}),(0,n.createVNode)(I,{onInfinite:f.infiniteHandler},{"no-more":(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("noOtherProductFound")),1)])),"no-results":(0,n.withCtx)((()=>[(0,n.createTextVNode)(".")])),spinner:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",d,[(0,n.createVNode)(P,{class:"is-loading",color:e.appPrimaryColor,size:40},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(N)])),_:1},8,["color"])])])),error:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("somethingWrong"))+". ",1),(0,n.createElementVNode)("a",{href:"javascript:;",onClick:t[8]||(t[8]=t=>e.location.reload())},(0,n.toDisplayString)(e.$t("retry")),1)])),_:1},8,["onInfinite"])],64)):((0,n.openBlock)(),(0,n.createElementBlock)("div",h,[(0,n.createElementVNode)("div",u,[(0,n.createElementVNode)("span",null,(0,n.toDisplayString)(e.$t("noProductFound")),1)])]))])),[[$,p.isLoadingProduct]])])),_:1}),p.showViewer?((0,n.openBlock)(),(0,n.createBlock)(R,{key:0,infinite:!1,"url-list":p.previewsList,"hide-on-click-modal":!0,"initial-index":p.currentItemIndex,onClose:t[9]||(t[9]=e=>p.showViewer=!1)},null,8,["url-list","initial-index"])):(0,n.createCommentVNode)("",!0),(0,n.createVNode)(M,{modelValue:p.detailsDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>p.detailsDialog=e),title:e.$t("productDetails"),width:"70%",top:"5vh","destroy-on-close":""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(B,{product:p.currentItem},null,8,["product"])])),_:1},8,["modelValue","title"]),(0,n.createVNode)(M,{modelValue:p.addShelfDialog,"onUpdate:modelValue":t[14]||(t[14]=e=>p.addShelfDialog=e),title:e.$t("addShelf"),width:"35%","destroy-on-close":""},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("span",m,[(0,n.createVNode)(v,{onClick:t[12]||(t[12]=e=>f.cancelAddShelf())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("cancel")),1)])),_:1}),(0,n.createVNode)(v,{type:"primary",onClick:t[13]||(t[13]=e=>f.submitAddShelf())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("confirm")),1)])),_:1})])])),default:(0,n.withCtx)((()=>[(0,n.createVNode)(L,{ref:"addShelfForm",model:p.shelf,rules:e.rules,"label-width":"150px","label-position":"left","hide-required-asterisk":""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(O,{prop:"name",label:e.$t("shelfName")},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(y,{modelValue:p.shelf.name,"onUpdate:modelValue":t[11]||(t[11]=e=>p.shelf.name=e),placeholder:e.$t("shelfName")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}var p=i(39355),f=i(14340),w=i(31567),b=i(98761),_=i(38855),v=i(91152),y=i(16234);const C={class:"image-slot"},k={class:"title"},x={key:0},V=["innerHTML"],E=["innerHTML"];function A(e,t,i,o,s,r){const a=(0,n.resolveComponent)("Picture"),l=(0,n.resolveComponent)("el-icon"),c=(0,n.resolveComponent)("el-image"),d=(0,n.resolveComponent)("el-carousel-item"),h=(0,n.resolveComponent)("el-carousel"),u=(0,n.resolveComponent)("el-col"),m=(0,n.resolveComponent)("el-divider"),g=(0,n.resolveComponent)("el-table-column"),p=(0,n.resolveComponent)("el-table"),f=(0,n.resolveComponent)("el-row");return(0,n.openBlock)(),(0,n.createBlock)(f,{gutter:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(u,{span:10},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(h,null,{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(r.parsePreviews(i.product.previews),((e,t)=>((0,n.openBlock)(),(0,n.createBlock)(d,{key:t},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{fit:"cover",src:e,"append-to-body":"",class:"product-preview"},{error:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",C,[(0,n.createVNode)(l,null,{default:(0,n.withCtx)((()=>[(0,n.createVNode)(a)])),_:1})])])),_:2},1032,["src"])])),_:2},1024)))),128))])),_:1})])),_:1}),(0,n.createVNode)(u,{span:14},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("h3",k,[(0,n.createTextVNode)((0,n.toDisplayString)(e.tr(i.product.name)),1),i.product.code?((0,n.openBlock)(),(0,n.createElementBlock)("span",x," - "+(0,n.toDisplayString)(i.product.code),1)):(0,n.createCommentVNode)("",!0)]),(0,n.createElementVNode)("p",{class:"short-description",innerHTML:r.clip(e.tr(i.product.short_description),80,{html:!0,maxLines:2})},null,8,V),(0,n.createElementVNode)("p",{class:"long-description",innerHTML:r.clip(e.tr(i.product.long_description),100,{html:!0,maxLines:3})},null,8,E),(0,n.createVNode)(m),(0,n.createVNode)(p,{data:r.detailsData,"show-header":!1,stripe:"",size:"small",style:{width:"100%"}},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(g,{prop:"name",label:""}),(0,n.createVNode)(g,{prop:"value",label:""})])),_:1},8,["data"])])),_:1})])),_:1})}var P=i(36833),S=i(1030),T=i.n(S),N={mixins:[P.Z,b.Z,_.Z],props:{product:{type:Object,default:null}},computed:{currencyCode(){return this.currencies.find((e=>e.id==this.currency))?.code||""},detailsData(){return[{name:this.$t("categories"),value:this.showCategories()},{name:this.$t("type"),value:this.productTypes.find((e=>e?.id==this.product.type))?.label},{name:this.$t("status"),value:parseInt(this.product.display)?this.$t("published"):this.$t("unpublished")},{name:this.$t("stockStatus"),value:this.stockStatus.find((e=>e?.id==this.product.stock_status))?.label},{name:this.$t("sellingPrice"),value:this.product.selling_price+" "+this.currencyCode},{name:this.$t("promoPrice"),value:this.product.promo_price+" "+this.currencyCode},{name:this.$t("amountAvailable"),value:this.product.amount_available},{name:this.$t("amountTotal"),value:this.product.amount_total}]}},created(){this.loadCategories()},methods:{clip:T(),parsePreviews(e){let t;try{t=JSON.parse(e)}catch(i){t=[null]}return t.map((e=>this.resolveMediaLink(e)))},showCategories(){const e=[];let t;try{t=JSON.parse(this.product.categories)}catch(i){t=[]}return t.forEach((t=>{const i=this.categories.find((e=>e.id==t));i&&e.push(this.tr(i.name))})),e.length?e.join(" / "):""}}},I=i(83744);const D=(0,I.Z)(N,[["render",A],["__scopeId","data-v-16206d68"]]);var R=D,B=i(21101);const M={name:"Products",components:{Details:R},mixins:[_.Z,w.Z,b.Z],data(){return{currentShelf:"all",shelf:{name:""},Routes:f.Z5,shelves:[],products:[],detailsData:[],previewsList:[],selectedProducts:[],addShelfDialog:!1,isLoadingShelf:!1,isLoadingProduct:!1,enableMultiselect:!1,isSelectAllIndeterminate:!1,detailsDialog:!1,showViewer:!1,selectAll:!1,productSearch:"",currentItem:null,lastProductRowId:0,currentItemIndex:0}},computed:{filteredProducts(){let e=[];return e=this.productSearch?this.products.filter((e=>e.name.toLowerCase().includes(this.productSearch.toLowerCase()))):this.products,e.filter((e=>e.shelf==this.currentShelf||"all"==this.currentShelf))},stickyBgColor(){return this.pickByTheme("white","black")}},created(){this.isLoadingProduct=!0,this.init(),this.fetchShelves()},methods:{...(0,B.mapActions)("eCommerceShelf",["getAllShelves"]),...(0,B.mapActions)("eCommerceProduct",["getProductsPage"]),reformatDate:p.bK,async fetchShelves(){this.isLoadingShelf=!0;const e=await this.getAllShelves();e.data&&(this.shelves=e.data),this.isLoadingShelf=!1},async init(){let e=null;const t=await this.getProductsPage({offset:this.lastProductRowId,limit:12});return t.success&&t.data?(e=t.data,this.lastProductRowId+=e.length,this.products.push(...e)):this.$message.error(this.$t("anErrorOccured")),this.isLoadingProduct&&(this.isLoadingProduct=!1),e?e.length:0},async infiniteHandler(e){const t=await this.init();t>0?e.loaded():e.complete()},parsePreviews(e){let t;try{t=JSON.parse(e)}catch(i){t=[null]}return t.map((e=>this.resolveMediaLink(e)))},showPreviews(e,t){this.currentItem=e,this.currentItemIndex=t,this.previewsList=this.parsePreviews(e.previews),this.showViewer=!0},showDetails(e,t){this.currentItem=e,this.detailsDialog=!0},editItem(e,t){this.$router.push({name:"EditProduct"+f.Z5.E_COMMERCE.NAME,params:{product:e.id}})},deleteItem(e,t){this.$confirm(this.$t("deleteProductQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const t=await this.deleteItemInDB({context:v.x,id:e.id});t.success?(this.$message.success(this.$t("success")),this.reset()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},deleteMultipleItems(){this.$confirm(1===this.selectedProducts.length?this.$t("deleteProductQuestion"):this.$t("deleteMultipleItems",[this.selectedProducts.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.selectedProducts.length;t++)await this.deleteItemInDB({context:v.x,id:this.selectedProducts[t].id});e.close(),this.$message.success(this.$t("success")),this.reset()})).catch((()=>{}))},async reset(){this.isLoadingProduct=!0,this.products=[],this.selectedProducts=[],this.lastProductRowId=0,await this.init()},updateSelectedProducts(e,t){const i=this.selectedProducts.findIndex((t=>t.id===e.id));i>-1?(this.selectedProducts.length==this.filteredProducts.length&&(this.isSelectAllIndeterminate=!0),this.selectedProducts.splice(i,1)):this.selectedProducts.push(e)},handleSelectAll(){this.filteredProducts.length>this.selectedProducts.length?this.selectedProducts=this.$_.cloneDeep(this.filteredProducts):this.selectedProducts=[],this.isSelectAllIndeterminate=!1},changeShelf(e){this.init()},deleteShelf(e){this.$confirm(this.$t("deleteShelfQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const t=await this.deleteItemInDB({context:y.k,id:e});t.success?(e==this.currentShelf&&(this.currentShelf="all"),this.$message.success(this.$t("success")),this.fetchShelves()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},submitAddShelf(){this.$refs.addShelfForm.validate((async e=>{if(!e)return!1;{if(this.shelves.findIndex((e=>this.tr(e.name)==this.tr(this.shelf.name)))>-1)return this.$message.error(this.$t("sameShelfErrorMessage")),!1;const e=await this.addItemInDB({context:y.k,data:{name:this.shelf.name}});e.success?this.$message.success(this.$t("success")):this.$message.error(this.$t("anErrorOccured")),this.cancelAddShelf(),this.fetchShelves()}}))},cancelAddShelf(){this.$refs.addShelfForm.resetFields(),this.addShelfDialog=!1}}},O=()=>{(0,n.useCssVars)((e=>({"00f6cc30":e.stickyBgColor})))},L=M.setup;M.setup=L?(e,t)=>(O(),L(e,t)):O;var $=M;const F=(0,I.Z)($,[["render",g],["__scopeId","data-v-03f7fbcb"]]);var z=F},594:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}};function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-button"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("Form");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("addPromo")),1)])),_:1}),(0,o.createVNode)(l,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,o.createElementVNode)("section",null,[(0,o.createVNode)(u)])],64)}var r=i(86018),a=i(99640),l={name:"AddPromo",components:{Form:a.Z},mixins:[r.Z],data(){return{products:[]}},async created(){this.$store.dispatch("eCommercePromo/getAllPromotions",{root:!0});const e=await this.$store.dispatch("eCommerceProduct/getAllProducts",{root:!0});e.success&&e.data&&(this.products=e.data)},methods:{async save(){if(this.dataProvided){if(this.promotions.findIndex((e=>e.code==this.promoData.code))>-1)return this.$message.error(this.$t("samePromoCodeError")),!1;const e=await this.addItemInDB({context:this.E_COMMERCE_PROMO_CONTEXT,data:{code:this.promoData.code,description:this.promoData.description,type:this.promoData.type,value:this.promoData.value,allow_free_shipping:this.promoData.allowFreeShipping,expiration_date:this.promoData.expirationDate,min_expense:this.promoData.minExpense,max_expense:this.promoData.maxExpense,single_use:this.promoData.singleUse,products:JSON.stringify(this.promoData.products),excluded_products:JSON.stringify(this.promoData.excludedProducts),categories:JSON.stringify(this.promoData.categories),excluded_categories:JSON.stringify(this.promoData.excludedCategories),total_use_limit:this.promoData.totalUseLimit,user_use_limit:this.promoData.userUseLimit,use_by:JSON.stringify([])}});e.success?this.$router.replace(this.Routes.E_COMMERCE.PATH+"/promo"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",s]]);var h=d},81602:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}};function s(e,t,i,s,r,a){const l=(0,o.resolveComponent)("el-col"),c=(0,o.resolveComponent)("el-button"),d=(0,o.resolveComponent)("el-row"),h=(0,o.resolveComponent)("el-card"),u=(0,o.resolveComponent)("Form"),m=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{class:"mb-10 header-card",shadow:"never"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(l,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("editPromo")),1)])),_:1}),(0,o.createVNode)(l,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"primary",disabled:!e.dataProvided,onClick:t[0]||(t[0]=e=>a.save())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("save")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("section",null,[(0,o.createVNode)(u)])),[[m,r.isLoading]])],64)}var r=i(86018),a=i(99640),l={name:"EditPromo",components:{Form:a.Z},mixins:[r.Z],data(){return{isLoading:!1,currentCode:"",products:[]}},async created(){this.$store.dispatch("eCommercePromo/getAllPromotions",{root:!0});const e=await this.$store.dispatch("eCommerceProduct/getAllProducts",{root:!0});e.success&&e.data&&(this.products=e.data),this.init()},methods:{async init(){if(this.$route.params&&this.$route.params.promo){this.isLoading=!0;const e=await this.getItemFromDB({context:this.E_COMMERCE_PROMO_CONTEXT,id:this.$route.params.promo});e.data&&e.success?(this.promoData={code:e.data.code,description:e.data.description,type:parseInt(e.data.type),value:parseFloat(e.data.value),allowFreeShipping:parseInt(e.data.allow_free_shipping),expirationDate:e.data.expiration_date,minExpense:parseFloat(e.data.min_expense),maxExpense:parseFloat(e.data.max_expense),singleUse:parseInt(e.data.single_use),products:JSON.parse(e.data.products),excludedProducts:JSON.parse(e.data.excluded_products),categories:JSON.parse(e.data.categories),excludedCategories:JSON.parse(e.data.excluded_categories),totalUseLimit:parseInt(e.data.total_use_limit),userUseLimit:parseInt(e.data.user_use_limit)},this.currentCode=e.data.code,this.isLoading=!1):this.$router.replace(this.Routes.E_COMMERCE.PATH+"/promo")}else this.$router.replace(this.Routes.E_COMMERCE.PATH+"/promo")},async save(){if(this.dataProvided){if(this.currentCode!==this.promoData.code&&this.promotions.findIndex((e=>e.code==this.promoData.code))>-1)return this.$message.error(this.$t("samePromoCodeError")),!1;const e=await this.updateItemInDB({context:this.E_COMMERCE_PROMO_CONTEXT,id:this.$route.params.promo,data:{code:this.promoData.code,description:this.promoData.description,type:this.promoData.type,value:this.promoData.value,allow_free_shipping:this.promoData.allowFreeShipping,expiration_date:this.promoData.expirationDate,min_expense:this.promoData.minExpense,max_expense:this.promoData.maxExpense,single_use:this.promoData.singleUse,products:JSON.stringify(this.promoData.products),excluded_products:JSON.stringify(this.promoData.excludedProducts),categories:JSON.stringify(this.promoData.categories),excluded_categories:JSON.stringify(this.promoData.excludedCategories),total_use_limit:this.promoData.totalUseLimit,user_use_limit:this.promoData.userUseLimit}});e.success?this.$router.replace(this.Routes.E_COMMERCE.PATH+"/promo"):this.$message.error(this.$t("anErrorOccured"))}}}},c=i(83744);const d=(0,c.Z)(l,[["render",s]]);var h=d},99640:function(e,t,i){"use strict";i.d(t,{Z:function(){return P}});var o=i(97200),n=i(12670),s=i(82234);const r=e=>((0,s.pushScopeId)("data-v-c9ac6696"),e=e(),(0,s.popScopeId)(),e),a={class:"item-title"},l={class:"item-title mt-10"},c=r((()=>(0,s.createElementVNode)("br",null,null,-1))),d={class:"mt-10"},h={class:"mt-10"},u={class:"item-title"},m=r((()=>(0,s.createElementVNode)("br",null,null,-1))),g={class:"item-title"},p={class:"item-title"},f={key:0,style:{color:"#000"}},w={key:1},b=r((()=>(0,s.createElementVNode)("br",null,null,-1))),_={class:"item-title"},v={key:0,style:{color:"#000"}},y={key:1},C={class:"item-title"},k={class:"item-title mt-10"};function x(e,t,i,r,x,V){const E=(0,s.resolveComponent)("el-input"),A=(0,s.resolveComponent)("el-col"),P=(0,s.resolveComponent)("el-button"),S=(0,s.resolveComponent)("el-row"),T=n.Z,N=(0,s.resolveComponent)("el-input-number"),I=(0,s.resolveComponent)("el-card"),D=(0,s.resolveComponent)("el-option"),R=(0,s.resolveComponent)("el-select"),B=(0,s.resolveComponent)("el-date-picker"),M=(0,s.resolveComponent)("el-checkbox"),O=o.Z;return(0,s.openBlock)(),(0,s.createBlock)(I,{shadow:"never"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(S,{gutter:10},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{span:16},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",a,(0,s.toDisplayString)(e.$t("code")),1),(0,s.createVNode)(S,{gutter:10},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{span:18},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(E,{modelValue:e.$parent.promoData.code,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$parent.promoData.code=t),readonly:"",size:"default",class:"mb-10",style:{width:"100%"},placeholder:e.$t("code")},null,8,["modelValue","placeholder"])])),_:1}),(0,s.createVNode)(A,{span:6},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(P,{size:"default",type:"warning",style:{width:"100%"},icon:"magic-stick",onClick:t[1]||(t[1]=t=>e.$parent.genPromoCode())},{default:(0,s.withCtx)((()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.$t("generate")),1)])),_:1})])),_:1})])),_:1}),(0,s.createElementVNode)("span",l,(0,s.toDisplayString)(e.$t("description")),1),(0,s.createVNode)(T,{modelValue:e.$parent.promoData.description,"onUpdate:modelValue":t[2]||(t[2]=t=>e.$parent.promoData.description=t),type:"textarea",synchro:!0,placeholder:e.$t("description")},null,8,["modelValue","placeholder"]),(0,s.createVNode)(I,{shadow:"hover",class:"mt-10"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(S,{gutter:10,class:"mb-10"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{span:8},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("small",null,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("minExpense")),1)]),(0,s.createVNode)(N,{modelValue:e.$parent.promoData.minExpense,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$parent.promoData.minExpense=t),min:0,label:e.$t("minExpense"),"controls-position":"right",style:{width:"100%"},size:"default"},null,8,["modelValue","label"])])),_:1}),(0,s.createVNode)(A,{span:8},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("small",null,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("maxExpense")),1)]),(0,s.createVNode)(N,{modelValue:e.$parent.promoData.maxExpense,"onUpdate:modelValue":t[4]||(t[4]=t=>e.$parent.promoData.maxExpense=t),min:0,label:e.$t("maxExpense"),"controls-position":"right",style:{width:"100%"},size:"default"},null,8,["modelValue","label"])])),_:1}),(0,s.createVNode)(A,{span:8},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("small",null,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("value")),1)]),(0,s.createVNode)(N,{modelValue:e.$parent.promoData.value,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$parent.promoData.value=t),min:1,label:e.$t("value"),"controls-position":"right",max:e.$parent.promoData.type==e.$parent.DiscountTypes.PERCENTAGE.id?100:1/0,style:{width:"100%"},size:"default"},null,8,["modelValue","label","max"])])),_:1})])),_:1}),c,(0,s.createVNode)(S,{gutter:10,class:"mt-10"},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(A,{span:12},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("small",d,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("codeUseLimit"))+" "+(0,s.toDisplayString)(e.$parent.promoData.totalUseLimit?"":" - "+e.$t("unlimited")),1)]),(0,s.createVNode)(N,{modelValue:e.$parent.promoData.totalUseLimit,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$parent.promoData.totalUseLimit=t),min:0,label:e.$t("codeUseLimit"),"controls-position":"right",style:{width:"100%"},size:"default"},null,8,["modelValue","label"])])),_:1}),(0,s.createVNode)(A,{span:12},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("small",h,[(0,s.createElementVNode)("b",null,(0,s.toDisplayString)(e.$t("useLimitByUser"))+" "+(0,s.toDisplayString)(e.$parent.promoData.userUseLimit?"":" - "+e.$t("unlimited")),1)]),(0,s.createVNode)(N,{modelValue:e.$parent.promoData.userUseLimit,"onUpdate:modelValue":t[7]||(t[7]=t=>e.$parent.promoData.userUseLimit=t),min:0,label:e.$t("useLimitByUser"),"controls-position":"right",style:{width:"100%"},size:"default"},null,8,["modelValue","label"])])),_:1})])),_:1})])),_:1}),(0,s.createVNode)(I,{shadow:"hover",class:"mt-10"},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",u,(0,s.toDisplayString)(e.$t("includedProducts")),1),(0,s.createVNode)(R,{modelValue:e.$parent.promoData.products,"onUpdate:modelValue":t[8]||(t[8]=t=>e.$parent.promoData.products=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},disabled:!!e.$parent.promoData.excludedProducts.length,placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.$parent.products,(t=>((0,s.openBlock)(),(0,s.createBlock)(D,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","disabled","placeholder","no-data-text","no-match-text"]),m,(0,s.createElementVNode)("span",g,(0,s.toDisplayString)(e.$t("excludedProducts")),1),(0,s.createVNode)(R,{modelValue:e.$parent.promoData.excludedProducts,"onUpdate:modelValue":t[9]||(t[9]=t=>e.$parent.promoData.excludedProducts=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},disabled:!!e.$parent.promoData.products.length,placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.$parent.products,(t=>((0,s.openBlock)(),(0,s.createBlock)(D,{key:t.id,value:t.id,label:e.tr(t.name)},null,8,["value","label"])))),128))])),_:1},8,["modelValue","disabled","placeholder","no-data-text","no-match-text"])])),_:1}),(0,s.createVNode)(I,{shadow:"hover",class:"mt-10"},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",p,(0,s.toDisplayString)(e.$t("includedCategories")),1),(0,s.createVNode)(R,{modelValue:e.$parent.promoData.categories,"onUpdate:modelValue":t[10]||(t[10]=t=>e.$parent.promoData.categories=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},disabled:!!e.$parent.promoData.excludedCategories.length,placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.$parent.categories,(t=>((0,s.openBlock)(),(0,s.createBlock)(D,{key:t.id,value:t.id,label:e.tr(t.name)},{default:(0,s.withCtx)((()=>[t.isParent?((0,s.openBlock)(),(0,s.createElementBlock)("b",f,(0,s.toDisplayString)(e.tr(t.name)),1)):((0,s.openBlock)(),(0,s.createElementBlock)("span",w,(0,s.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue","disabled","placeholder","no-data-text","no-match-text"]),b,(0,s.createElementVNode)("span",_,(0,s.toDisplayString)(e.$t("excludedCategories")),1),(0,s.createVNode)(R,{modelValue:e.$parent.promoData.excludedCategories,"onUpdate:modelValue":t[11]||(t[11]=t=>e.$parent.promoData.excludedCategories=t),multiple:"",size:"large",class:"mb-10",style:{width:"100%"},disabled:!!e.$parent.promoData.categories.length,placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData")},{default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.$parent.categories,(t=>((0,s.openBlock)(),(0,s.createBlock)(D,{key:t.id,value:t.id,label:e.tr(t.name)},{default:(0,s.withCtx)((()=>[t.isParent?((0,s.openBlock)(),(0,s.createElementBlock)("b",v,(0,s.toDisplayString)(e.tr(t.name)),1)):((0,s.openBlock)(),(0,s.createElementBlock)("span",y,(0,s.toDisplayString)(e.tr(t.name)),1))])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue","disabled","placeholder","no-data-text","no-match-text"])])),_:1})])),_:1}),(0,s.createVNode)(A,{span:8},{default:(0,s.withCtx)((()=>[(0,s.createVNode)(O,{top:60},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("span",C,(0,s.toDisplayString)(e.$t("expirationDate")),1),(0,s.createVNode)(B,{modelValue:e.$parent.promoData.expirationDate,"onUpdate:modelValue":t[12]||(t[12]=t=>e.$parent.promoData.expirationDate=t),size:"default",class:"mb-10",style:{width:"100%"},format:e.$parent.dateFormat,"value-format":"YYYY-MM-DD"},null,8,["modelValue","format"]),(0,s.createElementVNode)("span",k,(0,s.toDisplayString)(e.$t("discountTypes")),1),(0,s.createVNode)(R,{modelValue:e.$parent.promoData.type,"onUpdate:modelValue":t[13]||(t[13]=t=>e.$parent.promoData.type=t),size:"large",class:"mb-10",style:{width:"100%"},placeholder:e.$t("select"),"no-data-text":e.$t("noData"),"no-match-text":e.$t("noMatchingData"),onChange:t[14]||(t[14]=t=>e.$parent.promoData.value=0)},{default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.$parent.discountTypes,(e=>((0,s.openBlock)(),(0,s.createBlock)(D,{key:e.id,value:e.id,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","placeholder","no-data-text","no-match-text"]),(0,s.createVNode)(I,{shadow:"hover",class:"options-card mt-10 mb-10"},{default:(0,s.withCtx)((()=>[(0,s.createElementVNode)("div",null,[(0,s.createVNode)(M,{modelValue:e.$parent.promoData.allowFreeShipping,"onUpdate:modelValue":t[15]||(t[15]=t=>e.$parent.promoData.allowFreeShipping=t),"true-label":1,"false-label":0,label:e.$t("allowFreeShipping"),size:"default"},null,8,["modelValue","label"])]),(0,s.createElementVNode)("div",null,[(0,s.createVNode)(M,{modelValue:e.$parent.promoData.singleUse,"onUpdate:modelValue":t[16]||(t[16]=t=>e.$parent.promoData.singleUse=t),"true-label":1,"false-label":0,label:e.$t("singleUseOnly"),size:"default"},null,8,["modelValue","label"])])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var V={},E=i(83744);const A=(0,E.Z)(V,[["render",x],["__scopeId","data-v-c9ac6696"]]);var P=A},32087:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return g}});i(57658);var o=i(82234);const n={style:{"line-height":"36px","font-size":"18px"}},s={class:"mb-5"},r={key:0},a={style:{"font-size":"16px"}},l={style:{"text-align":"center","margin-top":"20px",display:"flex"}};function c(e,t,i,c,d,h){const u=(0,o.resolveComponent)("el-col"),m=(0,o.resolveComponent)("el-button"),g=(0,o.resolveComponent)("el-row"),p=(0,o.resolveComponent)("el-card"),f=(0,o.resolveComponent)("el-table-column"),w=(0,o.resolveComponent)("el-input"),b=(0,o.resolveComponent)("el-table"),_=(0,o.resolveComponent)("el-pagination"),v=(0,o.resolveDirective)("loading");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(p,{class:"mb-5 header-card",shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{span:8},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("b",n,(0,o.toDisplayString)(e.$t("promoManagement")),1)])),_:1}),(0,o.createVNode)(u,{span:16,class:"text-right"},{default:(0,o.withCtx)((()=>[d.multipleSelection.length?((0,o.openBlock)(),(0,o.createBlock)(m,{key:0,size:"default",type:"danger",icon:"delete",onClick:h.deleteMultipleItems},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("delete")),1)])),_:1},8,["onClick"])):((0,o.openBlock)(),(0,o.createBlock)(m,{key:1,size:"default",type:"primary",icon:"plus",onClick:t[0]||(t[0]=t=>e.$router.push(e.Routes.E_COMMERCE.PATH+"/add-promo"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("addPromo")),1)])),_:1}))])),_:1})])),_:1})])),_:1}),(0,o.createVNode)(p,{shadow:"hover"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("small",null,[d.multipleSelection.length?((0,o.openBlock)(),(0,o.createElementBlock)("b",r,(0,o.toDisplayString)(e.$t("xSelectedItems",[d.multipleSelection.length])),1)):(0,o.createCommentVNode)("",!0)])]),(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createBlock)(b,{border:"",stripe:"",data:h.pagedTableData,"empty-text":e.$t("noData"),style:{width:"100%"},onSelectionChange:h.handleSelectionChange},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{width:"50",type:"selection",fixed:""}),(0,o.createVNode)(f,{sortable:"",label:e.$t("code"),prop:"code",width:"150",fixed:""},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("b",a,(0,o.toDisplayString)(e.row.code),1)])),_:1},8,["label"]),(0,o.createVNode)(f,{sortable:"",label:e.$t("description"),prop:"description",width:"200",fixed:"","show-overflow-tooltip":""},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("small",null,(0,o.toDisplayString)(t.row.description||e.$t("none")),1)])),_:1},8,["label"]),(0,o.createVNode)(f,{sortable:"",label:e.$t("value"),prop:"value",width:"200"},{default:(0,o.withCtx)((t=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(t.row.value)+" "+(0,o.toDisplayString)(t.row.type==e.DiscountTypes.PERCENTAGE.id?"%":""),1)])),_:1},8,["label"]),(0,o.createVNode)(f,{sortable:"",label:e.$t("expirationDate"),width:"160"},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.reformatDate(t.row.expiration_date,{inPattern:"YYYY-MM-DD",outPattern:e.dateFormat,locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,o.createVNode)(f,{sortable:"",label:e.$t("addedOn"),width:"160"},{default:(0,o.withCtx)((t=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.reformatDate(t.row.insert_datetime,{inPattern:"YYYY-MM-DD HH:mm:ss",outPattern:e.dateFormat+" - HH:mm",locale:e.$i18n.locale})),1)])),_:1},8,["label"]),(0,o.createVNode)(f,{align:"right",width:"200",fixed:"right"},{header:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{modelValue:d.search,"onUpdate:modelValue":t[1]||(t[1]=e=>d.search=e),size:"small",placeholder:e.$t("search")},null,8,["modelValue","placeholder"])])),default:(0,o.withCtx)((t=>[(0,o.createVNode)(g,{gutter:10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{size:"small",type:"warning",icon:"edit",style:{width:"100%"},title:e.$t("edit"),disabled:!!d.multipleSelection.length,onClick:e=>h.editItem(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1024),(0,o.createVNode)(u,{span:12},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{size:"small",type:"danger",icon:"delete",style:{width:"100%"},title:e.$t("delete"),disabled:!!d.multipleSelection.length,onClick:e=>h.deleteItem(t.$index,t.row)},null,8,["title","disabled","onClick"])])),_:2},1024)])),_:2},1024)])),_:1})])),_:1},8,["data","empty-text","onSelectionChange"])),[[v,d.isLoading]]),(0,o.createElementVNode)("div",l,[(0,o.createVNode)(_,{background:"",style:{margin:"0 auto"},layout:"prev, pager, next","hide-on-single-page":!0,"page-size":d.pageSize,total:d.total,onCurrentChange:h.setPage},null,8,["page-size","total","onCurrentChange"])])])),_:1})],64)}var d=i(86018),h={name:"Promo",mixins:[d.Z],data(){return{currentEditItem:null,multipleSelection:[],isLoading:!1,tableData:[],pageSize:6,search:"",total:0,page:1}},computed:{pagedTableData(){return this.total=this.searching.length,this.searching.slice(this.pageSize*this.page-this.pageSize,this.pageSize*this.page)},searching(){return this.search?(this.page=1,this.tableData.filter((e=>e.code.toLowerCase().includes(this.search.toLowerCase())||e.description.toLowerCase().includes(this.search.toLowerCase())))):(this.total=this.tableData.length,this.tableData)}},created(){this.init()},methods:{setPage(e){this.page=e},indexMethod(e){return e+(this.page-1)*this.pageSize+1},handleSelectionChange(e){this.multipleSelection=e},async init(){this.isLoading=!0;const e=await this.getAllPromotions();e.data&&(this.tableData=e.data),e.failure&&this.$message.error(this.$t("unableToUpdateData")),this.isLoading=!1},async editItem(e,t){this.$router.push({name:"EditPromo"+this.Routes.E_COMMERCE.NAME,params:{promo:t.id}})},deleteItem(e,t){this.$confirm(this.$t("deletePromoQuestion"),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=await this.deleteItemInDB({context:this.E_COMMERCE_PROMO_CONTEXT,id:t.id});e.success?(this.$message.success(this.$t("success")),this.init()):this.$message.error(this.$t("anErrorOccured"))})).catch((()=>{}))},deleteMultipleItems(){this.$confirm(1===this.multipleSelection.length?this.$t("deletePromoQuestion"):this.$t("deleteMultipleItems",[this.multipleSelection.length]),this.$t("delete"),{confirmButtonText:this.$t("yes"),cancelButtonText:this.$t("cancel"),type:"warning"}).then((async()=>{const e=this.$message({message:this.$t("pleaseWait"),duration:0});for(let t=0;t<this.multipleSelection.length;t++)await this.deleteItemInDB({context:this.E_COMMERCE_PROMO_CONTEXT,id:this.multipleSelection[t].id});e.close(),this.$message.success(this.$t("success")),this.init()})).catch((()=>{}))}}},u=i(83744);const m=(0,u.Z)(h,[["render",c]]);var g=m},31567:function(e,t,i){"use strict";var o=i(14340),n=i(21101);t["Z"]={created(){const e=-1===this.restrictedScopes.findIndex((e=>this.$route.name.includes(e.value)));e||this.$router.replace(o.Z5.LOGIN.PATH)},computed:{...(0,n.mapState)({userData:e=>e.session.userData,accessList:e=>e.access.accessList}),...(0,n.mapGetters)({userScopes:"access/getUserScopes",restrictedScopes:"access/getUserRestrictedScopes",disabledModuleScopes:"access/getDisabledModuleScopes",userPageScopes:"access/getUserPageScopes",userActionScopes:"access/getUserActionScopes",userSectionScopes:"access/getUserSectionScopes",userPageScope:"access/getUserPageScope",userActionScope:"access/getUserActionScope",userSectionScope:"access/getUserSectionScope"})},methods:{...(0,n.mapActions)("access",["getAllAccess"]),getAccessName(e){const t=this.accessList.find((t=>t.id==e));return t?t.name:""}}}},5867:function(e,t,i){"use strict";i.d(t,{Z:function(){return h}});i(57658);var o=JSON.parse('[{"name":"Afghanistan","dial_code":"+93","code":"AF","flag":"🇦🇫"},{"name":"Åland Islands","dial_code":"+358","code":"AX","flag":"🇦🇽"},{"name":"Albania","dial_code":"+355","code":"AL","flag":"🇦🇱"},{"name":"Algeria","dial_code":"+213","code":"DZ","flag":"🇩🇿"},{"name":"American Samoa","dial_code":"+1684","code":"AS","flag":"🇺🇸"},{"name":"Andorra","dial_code":"+376","code":"AD","flag":"🇦🇩"},{"name":"Angola","dial_code":"+244","code":"AO","flag":"🇦🇴"},{"name":"Anguilla","dial_code":"+1264","code":"AI","flag":"🇦🇮"},{"name":"Antarctica","dial_code":"+672","code":"AQ","flag":"🇦🇶"},{"name":"Antigua and Barbuda","dial_code":"+1268","code":"AG","flag":"🇦🇬"},{"name":"Argentina","dial_code":"+54","code":"AR","flag":"🇦🇷"},{"name":"Armenia","dial_code":"+374","code":"AM","flag":"🇦🇲"},{"name":"Aruba","dial_code":"+297","code":"AW","flag":"🇦🇼"},{"name":"Australia","dial_code":"+61","code":"AU","flag":"🇦🇺"},{"name":"Austria","dial_code":"+43","code":"AT","flag":"🇦🇹"},{"name":"Azerbaijan","dial_code":"+994","code":"AZ","flag":"🇦🇿"},{"name":"Bahamas","dial_code":"+1242","code":"BS","flag":"🇧🇸"},{"name":"Bahrain","dial_code":"+973","code":"BH","flag":"🇧🇸"},{"name":"Bangladesh","dial_code":"+880","code":"BD","flag":"🇧🇩"},{"name":"Barbados","dial_code":"+1246","code":"BB","flag":"🇧🇧"},{"name":"Belarus","dial_code":"+375","code":"BY","flag":"🇧🇾"},{"name":"Belgium","dial_code":"+32","code":"BE","flag":"🇧🇪"},{"name":"Belize","dial_code":"+501","code":"BZ","flag":"🇧🇿"},{"name":"Benin","dial_code":"+229","code":"BJ","flag":"🇧🇯"},{"name":"Bermuda","dial_code":"+1441","code":"BM","flag":"🇧🇲"},{"name":"Bhutan","dial_code":"+975","code":"BT","flag":"🇧🇹"},{"name":"Bolivia, Plurinational State of bolivia","dial_code":"+591","code":"BO","flag":"🇧🇴"},{"name":"Bosnia and Herzegovina","dial_code":"+387","code":"BA","flag":"🇧🇦"},{"name":"Botswana","dial_code":"+267","code":"BW","flag":"🇧🇼"},{"name":"Bouvet Island","dial_code":"+47","code":"BV","flag":"🏳"},{"name":"Brazil","dial_code":"+55","code":"BR","flag":"🇧🇷"},{"name":"British Indian Ocean Territory","dial_code":"+246","code":"IO","flag":"🇮🇴"},{"name":"Brunei Darussalam","dial_code":"+673","code":"BN","flag":"🇧🇳"},{"name":"Bulgaria","dial_code":"+359","code":"BG","flag":"🇧🇬"},{"name":"Burkina Faso","dial_code":"+226","code":"BF","flag":"🇧🇫"},{"name":"Burundi","dial_code":"+257","code":"BI","flag":"🇧🇮"},{"name":"Cambodia","dial_code":"+855","code":"KH","flag":"🇰🇭"},{"name":"Cameroon","dial_code":"+237","code":"CM","flag":"🇨🇲"},{"name":"Canada","dial_code":"+1","code":"CA","flag":"🇨🇦"},{"name":"Cape Verde","dial_code":"+238","code":"CV","flag":"🇨🇻"},{"name":"Cayman Islands","dial_code":"+ 345","code":"KY","flag":"🇰🇾"},{"name":"Central African Republic","dial_code":"+236","code":"CF","flag":"🇨🇫"},{"name":"Chad","dial_code":"+235","code":"TD","flag":"🇹🇩"},{"name":"Chile","dial_code":"+56","code":"CL","flag":"🇨🇱"},{"name":"China","dial_code":"+86","code":"CN","flag":"🇨🇳"},{"name":"Christmas Island","dial_code":"+61","code":"CX","flag":"🇨🇽"},{"name":"Cocos (Keeling) Islands","dial_code":"+61","code":"CC","flag":"🇨🇨"},{"name":"Colombia","dial_code":"+57","code":"CO","flag":"🇨🇴"},{"name":"Comoros","dial_code":"+269","code":"KM","flag":"🇰🇲"},{"name":"Congo","dial_code":"+242","code":"CG","flag":"🇨🇬"},{"name":"Congo, The Democratic Republic of the Congo","dial_code":"+243","code":"CD","flag":"🇨🇩"},{"name":"Cook Islands","dial_code":"+682","code":"CK","flag":"🇨🇰"},{"name":"Costa Rica","dial_code":"+506","code":"CR","flag":"🇨🇷"},{"name":"Cote d\'Ivoire","dial_code":"+225","code":"CI","flag":"🇨🇮"},{"name":"Croatia","dial_code":"+385","code":"HR","flag":"🇭🇷"},{"name":"Cuba","dial_code":"+53","code":"CU","flag":"🇨🇺"},{"name":"Cyprus","dial_code":"+357","code":"CY","flag":"🇨🇾"},{"name":"Czech Republic","dial_code":"+420","code":"CZ","flag":"🇨🇿"},{"name":"Denmark","dial_code":"+45","code":"DK","flag":"🇩🇰"},{"name":"Djibouti","dial_code":"+253","code":"DJ","flag":"🇩🇯"},{"name":"Dominica","dial_code":"+1767","code":"DM","flag":"🇩🇲"},{"name":"Dominican Republic","dial_code":"+1849","code":"DO","flag":"🇨🇩"},{"name":"Ecuador","dial_code":"+593","code":"EC","flag":"🇪🇨"},{"name":"Egypt","dial_code":"+20","code":"EG","flag":"🇪🇬"},{"name":"El Salvador","dial_code":"+503","code":"SV","flag":"🇸🇻"},{"name":"Equatorial Guinea","dial_code":"+240","code":"GQ","flag":"🇬🇶"},{"name":"Eritrea","dial_code":"+291","code":"ER","flag":"🇪🇷"},{"name":"Estonia","dial_code":"+372","code":"EE","flag":"🇪🇪"},{"name":"Ethiopia","dial_code":"+251","code":"ET","flag":"🇪🇹"},{"name":"Falkland Islands (Malvinas)","dial_code":"+500","code":"FK","flag":"🇫🇰"},{"name":"Faroe Islands","dial_code":"+298","code":"FO","flag":"🇫🇴"},{"name":"Fiji","dial_code":"+679","code":"FJ","flag":"🇫🇯"},{"name":"Finland","dial_code":"+358","code":"FI","flag":"🇫🇮"},{"name":"France","dial_code":"+33","code":"FR","flag":"🇫🇷"},{"name":"French Guiana","dial_code":"+594","code":"GF","flag":"🇬🇫"},{"name":"French Polynesia","dial_code":"+689","code":"PF","flag":"🇵🇫"},{"name":"French Southern Territories","dial_code":"+262","code":"TF","flag":"🇹🇫"},{"name":"Gabon","dial_code":"+241","code":"GA","flag":"🇬🇦"},{"name":"Gambia","dial_code":"+220","code":"GM","flag":"🇬🇲"},{"name":"Georgia","dial_code":"+995","code":"GE","flag":"🇬🇪"},{"name":"Germany","dial_code":"+49","code":"DE","flag":"🇩🇪"},{"name":"Ghana","dial_code":"+233","code":"GH","flag":"🇬🇭"},{"name":"Gibraltar","dial_code":"+350","code":"GI","flag":"🇬🇮"},{"name":"Greece","dial_code":"+30","code":"GR","flag":"🇬🇷"},{"name":"Greenland","dial_code":"+299","code":"GL","flag":"🇬🇱"},{"name":"Grenada","dial_code":"+1473","code":"GD","flag":"🇬🇩"},{"name":"Guadeloupe","dial_code":"+590","code":"GP","flag":"🇬🇵"},{"name":"Guam","dial_code":"+1671","code":"GU","flag":"🇬🇺"},{"name":"Guatemala","dial_code":"+502","code":"GT","flag":"🇬🇹"},{"name":"Guernsey","dial_code":"+44","code":"GG","flag":"🇬🇬"},{"name":"Guinea","dial_code":"+224","code":"GN","flag":"🇬🇳"},{"name":"Guinea-Bissau","dial_code":"+245","code":"GW","flag":"🇬🇼"},{"name":"Guyana","dial_code":"+592","code":"GY","flag":"🇬🇾"},{"name":"Haiti","dial_code":"+509","code":"HT","flag":"🇭🇹"},{"name":"Heard Island and Mcdonald Islands","dial_code":"+0","code":"HM","flag":"🏳"},{"name":"Holy See (Vatican City State)","dial_code":"+379","code":"VA","flag":"🇻🇦"},{"name":"Honduras","dial_code":"+504","code":"HN","flag":"🇭🇳"},{"name":"Hong Kong","dial_code":"+852","code":"HK","flag":"🇭🇰"},{"name":"Hungary","dial_code":"+36","code":"HU","flag":"🇭🇺"},{"name":"Iceland","dial_code":"+354","code":"IS","flag":"🇮🇸"},{"name":"India","dial_code":"+91","code":"IN","flag":"🇮🇳"},{"name":"Indonesia","dial_code":"+62","code":"ID","flag":"🇮🇩"},{"name":"Iran, Islamic Republic of Persian Gulf","dial_code":"+98","code":"IR","flag":"🇮🇷"},{"name":"Iraq","dial_code":"+964","code":"IQ","flag":"🇮🇶"},{"name":"Ireland","dial_code":"+353","code":"IE","flag":"🇮🇪"},{"name":"Isle of Man","dial_code":"+44","code":"IM","flag":"🇮🇲"},{"name":"Israel","dial_code":"+972","code":"IL","flag":"🇮🇱"},{"name":"Italy","dial_code":"+39","code":"IT","flag":"🇮🇹"},{"name":"Jamaica","dial_code":"+1876","code":"JM","flag":"🇯🇲"},{"name":"Japan","dial_code":"+81","code":"JP","flag":"🇯🇵"},{"name":"Jersey","dial_code":"+44","code":"JE","flag":"🇯🇪"},{"name":"Jordan","dial_code":"+962","code":"JO","flag":"🇯🇴"},{"name":"Kazakhstan","dial_code":"+7","code":"KZ","flag":"🇰🇿"},{"name":"Kenya","dial_code":"+254","code":"KE","flag":"🇰🇪"},{"name":"Kiribati","dial_code":"+686","code":"KI","flag":"🇰🇮"},{"name":"Korea, Democratic People\'s Republic of Korea","dial_code":"+850","code":"KP","flag":"🇰🇵"},{"name":"Korea, Republic of South Korea","dial_code":"+82","code":"KR","flag":"🇰🇷"},{"name":"Kosovo","dial_code":"+383","code":"XK","flag":"🇽🇰"},{"name":"Kuwait","dial_code":"+965","code":"KW","flag":"🇰🇼"},{"name":"Kyrgyzstan","dial_code":"+996","code":"KG","flag":"🇰🇬"},{"name":"Laos","dial_code":"+856","code":"LA","flag":"🇱🇦"},{"name":"Latvia","dial_code":"+371","code":"LV","flag":"🇱🇻"},{"name":"Lebanon","dial_code":"+961","code":"LB","flag":"🇱🇧"},{"name":"Lesotho","dial_code":"+266","code":"LS","flag":"🇱🇸"},{"name":"Liberia","dial_code":"+231","code":"LR","flag":"🇱🇷"},{"name":"Libyan Arab Jamahiriya","dial_code":"+218","code":"LY","flag":"🇱🇾"},{"name":"Liechtenstein","dial_code":"+423","code":"LI","flag":"🇱🇮"},{"name":"Lithuania","dial_code":"+370","code":"LT","flag":"🇱🇹"},{"name":"Luxembourg","dial_code":"+352","code":"LU","flag":"🇱🇺"},{"name":"Macao","dial_code":"+853","code":"MO","flag":"🇲🇴"},{"name":"Macedonia","dial_code":"+389","code":"MK","flag":"🇲🇰"},{"name":"Madagascar","dial_code":"+261","code":"MG","flag":"🇲🇬"},{"name":"Malawi","dial_code":"+265","code":"MW","flag":"🇲🇼"},{"name":"Malaysia","dial_code":"+60","code":"MY","flag":"🇲🇾"},{"name":"Maldives","dial_code":"+960","code":"MV","flag":"🇲🇻"},{"name":"Mali","dial_code":"+223","code":"ML","flag":"🇲🇱"},{"name":"Malta","dial_code":"+356","code":"MT","flag":"🇲🇹"},{"name":"Marshall Islands","dial_code":"+692","code":"MH","flag":"🇲🇭"},{"name":"Martinique","dial_code":"+596","code":"MQ","flag":"🇲🇶"},{"name":"Mauritania","dial_code":"+222","code":"MR","flag":"🇲🇷"},{"name":"Mauritius","dial_code":"+230","code":"MU","flag":"🇲🇺"},{"name":"Mayotte","dial_code":"+262","code":"YT","flag":"🇾🇹"},{"name":"Mexico","dial_code":"+52","code":"MX","flag":"🇲🇽"},{"name":"Micronesia, Federated States of Micronesia","dial_code":"+691","code":"FM","flag":"🇫🇲"},{"name":"Moldova","dial_code":"+373","code":"MD","flag":"🇲🇩"},{"name":"Monaco","dial_code":"+377","code":"MC","flag":"🇲🇨"},{"name":"Mongolia","dial_code":"+976","code":"MN","flag":"🇲🇳"},{"name":"Montenegro","dial_code":"+382","code":"ME","flag":"🇲🇪"},{"name":"Montserrat","dial_code":"+1664","code":"MS","flag":"🇲🇸"},{"name":"Morocco","dial_code":"+212","code":"MA","flag":"🇲🇦"},{"name":"Mozambique","dial_code":"+258","code":"MZ","flag":"🇲🇿"},{"name":"Myanmar","dial_code":"+95","code":"MM","flag":"🇲🇲"},{"name":"Namibia","dial_code":"+264","code":"NA","flag":"🇳🇦"},{"name":"Nauru","dial_code":"+674","code":"NR","flag":"🇳🇷"},{"name":"Nepal","dial_code":"+977","code":"NP","flag":"🇳🇵"},{"name":"Netherlands","dial_code":"+31","code":"NL","flag":"🇳🇱"},{"name":"Netherlands Antilles","dial_code":"+599","code":"AN","flag":"🇳🇱"},{"name":"New Caledonia","dial_code":"+687","code":"NC","flag":"🇳🇨"},{"name":"New Zealand","dial_code":"+64","code":"NZ","flag":"🇳🇿"},{"name":"Nicaragua","dial_code":"+505","code":"NI","flag":"🇳🇮"},{"name":"Niger","dial_code":"+227","code":"NE","flag":"🇳🇪"},{"name":"Nigeria","dial_code":"+234","code":"NG","flag":"🇳🇬"},{"name":"Niue","dial_code":"+683","code":"NU","flag":"🇳🇺"},{"name":"Norfolk Island","dial_code":"+672","code":"NF","flag":"🇳🇫"},{"name":"Northern Mariana Islands","dial_code":"+1670","code":"MP","flag":"🏳"},{"name":"Norway","dial_code":"+47","code":"NO","flag":"🇳🇴"},{"name":"Oman","dial_code":"+968","code":"OM","flag":"🇴🇲"},{"name":"Pakistan","dial_code":"+92","code":"PK","flag":"🇵🇰"},{"name":"Palau","dial_code":"+680","code":"PW","flag":"🇵🇼"},{"name":"Palestinian Territory, Occupied","dial_code":"+970","code":"PS","flag":"🇵🇸"},{"name":"Panama","dial_code":"+507","code":"PA","flag":"🇵🇦"},{"name":"Papua New Guinea","dial_code":"+675","code":"PG","flag":"🇵🇬"},{"name":"Paraguay","dial_code":"+595","code":"PY","flag":"🇵🇾"},{"name":"Peru","dial_code":"+51","code":"PE","flag":"🇵🇪"},{"name":"Philippines","dial_code":"+63","code":"PH","flag":"🇵🇭"},{"name":"Pitcairn","dial_code":"+64","code":"PN","flag":"🇵🇳"},{"name":"Poland","dial_code":"+48","code":"PL","flag":"🇵🇱"},{"name":"Portugal","dial_code":"+351","code":"PT","flag":"🇵🇹"},{"name":"Puerto Rico","dial_code":"+1939","code":"PR","flag":"🇵🇷"},{"name":"Qatar","dial_code":"+974","code":"QA","flag":"🇶🇦"},{"name":"Romania","dial_code":"+40","code":"RO","flag":"🇷🇴"},{"name":"Russia","dial_code":"+7","code":"RU","flag":"🇷🇺"},{"name":"Rwanda","dial_code":"+250","code":"RW","flag":"🇷🇼"},{"name":"Reunion","dial_code":"+262","code":"RE","flag":"🇫🇷"},{"name":"Saint Barthelemy","dial_code":"+590","code":"BL","flag":"🇧🇱"},{"name":"Saint Helena, Ascension and Tristan Da Cunha","dial_code":"+290","code":"SH","flag":"🇸🇭"},{"name":"Saint Kitts and Nevis","dial_code":"+1869","code":"KN","flag":"🇰🇳"},{"name":"Saint Lucia","dial_code":"+1758","code":"LC","flag":"🇱🇨"},{"name":"Saint Martin","dial_code":"+590","code":"MF","flag":"🏳"},{"name":"Saint Pierre and Miquelon","dial_code":"+508","code":"PM","flag":"🇵🇲"},{"name":"Saint Vincent and the Grenadines","dial_code":"+1784","code":"VC","flag":"🇻🇨"},{"name":"Samoa","dial_code":"+685","code":"WS","flag":"🇼🇸"},{"name":"San Marino","dial_code":"+378","code":"SM","flag":"🇸🇲"},{"name":"Sao Tome and Principe","dial_code":"+239","code":"ST","flag":"🇸🇹"},{"name":"Saudi Arabia","dial_code":"+966","code":"SA","flag":"🇸🇦"},{"name":"Senegal","dial_code":"+221","code":"SN","flag":"🇸🇳"},{"name":"Serbia","dial_code":"+381","code":"RS","flag":"🇷🇸"},{"name":"Seychelles","dial_code":"+248","code":"SC","flag":"🇸🇨"},{"name":"Sierra Leone","dial_code":"+232","code":"SL","flag":"🇸🇱"},{"name":"Singapore","dial_code":"+65","code":"SG","flag":"🇸🇬"},{"name":"Slovakia","dial_code":"+421","code":"SK","flag":"🇸🇰"},{"name":"Slovenia","dial_code":"+386","code":"SI","flag":"🇸🇮"},{"name":"Solomon Islands","dial_code":"+677","code":"SB","flag":"🇸🇧"},{"name":"Somalia","dial_code":"+252","code":"SO","flag":"🇸🇴"},{"name":"South Africa","dial_code":"+27","code":"ZA","flag":"🇿🇦"},{"name":"South Sudan","dial_code":"+211","code":"SS","flag":"🇸🇸"},{"name":"South Georgia and the South Sandwich Islands","dial_code":"+500","code":"GS","flag":"🇬🇸"},{"name":"Spain","dial_code":"+34","code":"ES","flag":"🇪🇸"},{"name":"Sri Lanka","dial_code":"+94","code":"LK","flag":"🇱🇰"},{"name":"Sudan","dial_code":"+249","code":"SD","flag":"🇸🇩"},{"name":"Suriname","dial_code":"+597","code":"SR","flag":"🇸🇷"},{"name":"Svalbard and Jan Mayen","dial_code":"+47","code":"SJ","flag":"🇩🇰"},{"name":"Swaziland","dial_code":"+268","code":"SZ","flag":"🇸🇿"},{"name":"Sweden","dial_code":"+46","code":"SE","flag":"🇸🇪"},{"name":"Switzerland","dial_code":"+41","code":"CH","flag":"🇨🇭"},{"name":"Syrian Arab Republic","dial_code":"+963","code":"SY","flag":"🇸🇾"},{"name":"Taiwan","dial_code":"+886","code":"TW","flag":"🇹🇼"},{"name":"Tajikistan","dial_code":"+992","code":"TJ","flag":"🇹🇯"},{"name":"Tanzania, United Republic of Tanzania","dial_code":"+255","code":"TZ","flag":"🇹🇿"},{"name":"Thailand","dial_code":"+66","code":"TH","flag":"🇹🇭"},{"name":"Timor-Leste","dial_code":"+670","code":"TL","flag":"🇹🇱"},{"name":"Togo","dial_code":"+228","code":"TG","flag":"🇹🇬"},{"name":"Tokelau","dial_code":"+690","code":"TK","flag":"🇹🇰"},{"name":"Tonga","dial_code":"+676","code":"TO","flag":"🇹🇴"},{"name":"Trinidad and Tobago","dial_code":"+1868","code":"TT","flag":"🇹🇹"},{"name":"Tunisia","dial_code":"+216","code":"TN","flag":"🇹🇳"},{"name":"Turkey","dial_code":"+90","code":"TR","flag":"🇹🇷"},{"name":"Turkmenistan","dial_code":"+993","code":"TM","flag":"🇹🇲"},{"name":"Turks and Caicos Islands","dial_code":"+1649","code":"TC","flag":"🇹🇨"},{"name":"Tuvalu","dial_code":"+688","code":"TV","flag":"🇹🇻"},{"name":"Uganda","dial_code":"+256","code":"UG","flag":"🇺🇬"},{"name":"Ukraine","dial_code":"+380","code":"UA","flag":"🇺🇦"},{"name":"United Arab Emirates","dial_code":"+971","code":"AE","flag":"🇦🇪"},{"name":"United Kingdom","dial_code":"+44","code":"GB","flag":"🇬🇧"},{"name":"United States","dial_code":"+1","code":"US","flag":"🇺🇸"},{"name":"Uruguay","dial_code":"+598","code":"UY","flag":"🇺🇾"},{"name":"Uzbekistan","dial_code":"+998","code":"UZ","flag":"🇺🇿"},{"name":"Vanuatu","dial_code":"+678","code":"VU","flag":"🇻🇺"},{"name":"Venezuela, Bolivarian Republic of Venezuela","dial_code":"+58","code":"VE","flag":"🇻🇪"},{"name":"Vietnam","dial_code":"+84","code":"VN","flag":"🇻🇳"},{"name":"Virgin Islands, British","dial_code":"+1284","code":"VG","flag":"🇻🇬"},{"name":"Virgin Islands, U.S.","dial_code":"+1340","code":"VI","flag":"🇻🇮"},{"name":"Wallis and Futuna","dial_code":"+681","code":"WF","flag":"🇼🇫"},{"name":"Yemen","dial_code":"+967","code":"YE","flag":"🇾🇪"},{"name":"Zambia","dial_code":"+260","code":"ZM","flag":"🇿🇲"},{"name":"Zimbabwe","dial_code":"+263","code":"ZW","flag":"🇿🇼"}]'),n=i(39355),s=i(14340),r=i(31567),a=i(98761),l=i(38855),c=i(83944),d=i(21101),h={mixins:[l.Z,r.Z,a.Z],data(){return{Routes:s.Z5,countries:o,orderStatus:[],paymentMethods:[],orderData:{code:"",date:"",status:s.iF.PENDING.id,user:"",billing:{},expedition:{},products:[],fees:[],customFields:[],promoCode:"",note:""},contentEditorItems:["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"],E_COMMERCE_ORDER_CONTEXT:c.n}},created(){this.$_.forIn(s.iF,((e,t)=>{this.orderStatus.push(e)})),this.$_.forIn(s.A6,((e,t)=>{this.paymentMethods.push(e)})),this.getAllAccounts()},computed:{...(0,d.mapState)({accounts:e=>e.subscription.accounts,promotions:e=>e.eCommercePromo.promotions,orders:e=>e.eCommerceOrder.orders,users:e=>e.user.users}),dataProvided(){return this.orderData.code&&this.orderData.date&&this.orderData.status&&this.orderData.products.length},isAddPage(){return this.$route.name==="AddOrder"+s.Z5.E_COMMERCE.NAME},isEditPage(){return this.$route.name==="EditOrder"+s.Z5.E_COMMERCE.NAME}},methods:{...(0,d.mapActions)("eCommerceOrder",["getAllOrders"]),...(0,d.mapActions)("subscription",["getAllAccounts"]),reformatDate:n.bK}}},36833:function(e,t,i){"use strict";i(57658);var o=i(39355),n=i(14340),s=i(31567),r=i(98761),a=i(38855),l=i(91152),c=i(21101);t["Z"]={mixins:[a.Z,s.Z,r.Z],data(){return{Routes:n.Z5,StockStatus:n.BQ,ProductTypes:n.V7,categories:[],stockStatus:[],productTypes:[],productData:{previews:[],code:"",name:"",type:n.V7.SIMPLE.id,categories:[],shortDescription:"",longDescription:"",display:0,stockStatus:n.BQ.AVAILABLE.id,sellingPrice:0,promoPrice:0,amountAvailable:0,amountTotal:0,singleSelling:0,shipping:0,features:[],attachedDocument:"",shelf:""},contentEditorItems:["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"],showViewer:!1,keepFormData:!1,pickerVisible:!1,docPickerVisible:!1,redirectToList:!0,currentPreviewIndex:0,E_COMMERCE_PRODUCT_CONTEXT:l.x}},created(){this.$_.forIn(n.BQ,((e,t)=>{this.stockStatus.push(e)})),this.$_.forIn(n.V7,((e,t)=>{this.productTypes.push(e)}))},computed:{...(0,c.mapState)({shelves:e=>e.eCommerceShelf.shelves,users:e=>e.user.users}),dataProvided(){return this.productData.name&&this.productData.previews.length&&this.productData.shortDescription},isAddPage(){return this.$route.name==="AddProduct"+n.Z5.E_COMMERCE.NAME},isEditPage(){return this.$route.name==="EditProduct"+n.Z5.E_COMMERCE.NAME}},methods:{...(0,c.mapActions)("eCommerceCategory",["getCategoriesByParent"]),...(0,c.mapActions)("eCommerceProduct",["getAllProducts"]),...(0,c.mapActions)("eCommerceShelf",["getAllShelves"]),reformatDate:o.bK,async loadCategories(){this.categories=[];const e=await this.getCategoriesByParent(0);if(e.success&&e.data){const t=e.data;for(let e=0;e<t.length;e++){const i=await this.getCategoriesByParent(t[e].id);t[e].isParent=!0,this.categories.push(t[e]),i.success&&i.data&&i.data.forEach((e=>{this.categories.push(e)}))}}},addPreviews(){this.pickerVisible=!0},removePreview(e){this.productData.previews.splice(e,1)},onPreviewsSelected(e){this.productData.previews&&this.$_.isArray(this.productData.previews)?e.forEach((e=>{this.productData.previews.includes(e)||this.productData.previews.push(e)})):this.productData.previews=e,this.pickerVisible=!1},onDocSelected(e){this.productData.attachedDocument=e,this.docPickerVisible=!1},openViewer(e){this.currentPreviewIndex=e,this.showViewer=!0}}}},86018:function(e,t,i){"use strict";i(57658);var o=i(39355),n=i(14340),s=i(31567),r=i(98761),a=i(38855),l=i(60854),c=i(21101);t["Z"]={mixins:[a.Z,s.Z,r.Z],data(){return{Routes:n.Z5,DiscountTypes:n.sC,discountTypes:[],promoData:{code:"",description:"",type:n.sC.PERCENTAGE.id,value:0,allowFreeShipping:0,expirationDate:"",minExpense:0,maxExpense:0,singleUse:0,products:[],excludedProducts:[],categories:[],excludedCategories:[],totalUseLimit:0,userUseLimit:0,useBy:[]},contentEditorItems:["fullScreen","|","addBreezeMedias","|","heading","|","bold","italic","underline","strikethrough","code","subscript","superscript","selectAll","|","fontSize","fontFamily","fontColor","fontBackgroundColor","|","horizontalLine","blockQuote","bulletedList","numberedList","alignment","|","outdent","indent","|","link","insertTable","mediaEmbed","|","undo","redo","|","sourceEditing"],E_COMMERCE_PROMO_CONTEXT:l.c}},created(){this.$_.forIn(n.sC,((e,t)=>{this.discountTypes.push(e)}))},computed:{...(0,c.mapState)({categories:e=>e.eCommerceCategory.categories,promotions:e=>e.eCommercePromo.promotions,users:e=>e.user.users}),dataProvided(){return this.promoData.code&&this.promoData.value&&this.promoData.expirationDate&&(this.promoData.products||this.promoData.excludedProducts)&&(this.promoData.categories||this.promoData.excludedCategories)},isAddPage(){return this.$route.name==="AddPromo"+n.Z5.E_COMMERCE.NAME},isEditPage(){return this.$route.name==="EditPromo"+n.Z5.E_COMMERCE.NAME}},methods:{...(0,c.mapActions)("eCommercePromo",["getAllPromotions"]),reformatDate:o.bK,genPromoCode(){this.promoData.code=this.$uuidv4().split("-")[0].toUpperCase()}}}},38855:function(e,t,i){"use strict";i(57658);var o=i(39355),n=i(14340),s=i(20747),r=i(21101);t["Z"]={data(){return{Routes:n.Z5,Currencies:n.Kt,WebsiteInfo:n.a,currencies:[]}},async created(){this.$_.forIn(n.Kt,((e,t)=>{this.currencies.push(e)})),this.$store.commit("global/updateCurrentPanelPath",this.$route.path,{root:!0});const e=await this.getItemFromDB({context:s.A,id:this.userData?.id});e.success&&e.data&&e.data.status==n.dp.DISABLED&&(this.destroySession(),this.$router.replace(n.Z5.LOGIN.PATH))},computed:{...(0,r.mapState)({userData:e=>e.session.userData}),...(0,r.mapGetters)({isUserConnected:"session/isUserConnected",getSettingValue:"setting/getSettingValue"})},methods:{formatDate:o.p6,reformatDate:o.bK,...(0,r.mapMutations)({destroySession:"session/destroySession"})}}}}]);
//# sourceMappingURL=group-e-commerce.fcb39d23.js.map